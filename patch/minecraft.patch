From 3bda92b9f3f297a6a47a6721295d118e2fd3c905 Mon Sep 17 00:00:00 2001
From: Alexander01998 <contact.wurstimperium@gmail.com>
Date: Thu, 23 Apr 2015 20:24:50 +0200
Subject: [PATCH] Wurst

---
 src/net/minecraft/block/Block.java                 | 3031 ++++-----
 src/net/minecraft/block/BlockLiquid.java           |  846 +--
 src/net/minecraft/block/BlockSlab.java             |  376 +-
 src/net/minecraft/block/BlockSoulSand.java         |   74 +-
 .../minecraft/client/LoadingScreenRenderer.java    |   10 +-
 src/net/minecraft/client/Minecraft.java            | 6852 ++++++++++----------
 src/net/minecraft/client/audio/SoundManager.java   | 1188 ++--
 .../client/entity/AbstractClientPlayer.java        |  267 +-
 .../minecraft/client/entity/EntityPlayerSP.java    | 1771 ++---
 src/net/minecraft/client/gui/FontRenderer.java     | 1994 +++---
 src/net/minecraft/client/gui/Gui.java              |    8 +-
 src/net/minecraft/client/gui/GuiButton.java        |  298 +-
 .../minecraft/client/gui/GuiButtonLanguage.java    |    1 +
 .../minecraft/client/gui/GuiButtonRealmsProxy.java |    1 +
 src/net/minecraft/client/gui/GuiChat.java          |    2 +-
 src/net/minecraft/client/gui/GuiCommandBlock.java  |    4 +
 .../minecraft/client/gui/GuiConfirmOpenLink.java   |    2 +
 src/net/minecraft/client/gui/GuiControls.java      |    2 +
 .../minecraft/client/gui/GuiCreateFlatWorld.java   |    4 +-
 src/net/minecraft/client/gui/GuiCreateWorld.java   |    3 +
 src/net/minecraft/client/gui/GuiCustomizeSkin.java |    2 +
 .../client/gui/GuiCustomizeWorldScreen.java        |    5 +-
 src/net/minecraft/client/gui/GuiDisconnected.java  |  224 +-
 src/net/minecraft/client/gui/GuiEnchantment.java   |    2 +-
 src/net/minecraft/client/gui/GuiErrorScreen.java   |    2 +
 src/net/minecraft/client/gui/GuiFlatPresets.java   |    6 +-
 src/net/minecraft/client/gui/GuiGameOver.java      |  285 +-
 src/net/minecraft/client/gui/GuiIngame.java        | 2478 +++----
 src/net/minecraft/client/gui/GuiIngameMenu.java    |  237 +-
 .../minecraft/client/gui/GuiKeyBindingList.java    |    3 +
 src/net/minecraft/client/gui/GuiLanguage.java      |    3 +
 src/net/minecraft/client/gui/GuiListButton.java    |    1 +
 .../minecraft/client/gui/GuiLockIconButton.java    |    1 +
 src/net/minecraft/client/gui/GuiMainMenu.java      | 1334 ++--
 .../minecraft/client/gui/GuiMemoryErrorScreen.java |    2 +
 src/net/minecraft/client/gui/GuiMerchant.java      |    4 +
 src/net/minecraft/client/gui/GuiMultiplayer.java   | 1117 ++--
 src/net/minecraft/client/gui/GuiNewChat.java       |  785 +--
 src/net/minecraft/client/gui/GuiOptionButton.java  |    1 +
 src/net/minecraft/client/gui/GuiOptionSlider.java  |    1 +
 src/net/minecraft/client/gui/GuiOptions.java       |    2 +
 .../minecraft/client/gui/GuiOptionsRowList.java    |    3 +
 src/net/minecraft/client/gui/GuiOverlayDebug.java  |    8 +-
 .../minecraft/client/gui/GuiPageButtonList.java    |    3 +
 .../minecraft/client/gui/GuiPlayerTabOverlay.java  |   32 +-
 src/net/minecraft/client/gui/GuiRenameWorld.java   |    3 +
 src/net/minecraft/client/gui/GuiScreen.java        |   12 +-
 .../minecraft/client/gui/GuiScreenAddServer.java   |    3 +
 src/net/minecraft/client/gui/GuiScreenBook.java    | 1427 ++--
 .../client/gui/GuiScreenCustomizePresets.java      |    4 +
 src/net/minecraft/client/gui/GuiScreenDemo.java    |    3 +
 .../client/gui/GuiScreenOptionsSounds.java         |    2 +
 .../minecraft/client/gui/GuiScreenRealmsProxy.java |    5 +-
 .../client/gui/GuiScreenResourcePacks.java         |    4 +
 .../minecraft/client/gui/GuiScreenServerList.java  |  225 +-
 src/net/minecraft/client/gui/GuiSelectWorld.java   |  660 +-
 src/net/minecraft/client/gui/GuiShareToLan.java    |  231 +-
 .../gui/GuiSimpleScrolledSelectionListProxy.java   |    6 +-
 src/net/minecraft/client/gui/GuiSleepMP.java       |    2 +
 src/net/minecraft/client/gui/GuiSlider.java        |    1 +
 src/net/minecraft/client/gui/GuiSlot.java          |   26 +-
 src/net/minecraft/client/gui/GuiSnooper.java       |    3 +
 src/net/minecraft/client/gui/GuiSpectator.java     |    4 +-
 src/net/minecraft/client/gui/GuiTextField.java     |    6 +-
 src/net/minecraft/client/gui/GuiVideoSettings.java |    2 +
 src/net/minecraft/client/gui/GuiWinGame.java       |   12 +-
 src/net/minecraft/client/gui/GuiYesNo.java         |    3 +
 .../minecraft/client/gui/ScreenChatOptions.java    |    2 +
 .../minecraft/client/gui/ServerSelectionList.java  |   13 +-
 .../client/gui/achievement/GuiAchievements.java    |    6 +-
 .../minecraft/client/gui/achievement/GuiStats.java |    9 +-
 .../minecraft/client/gui/inventory/GuiBeacon.java  |    3 +
 .../minecraft/client/gui/inventory/GuiChest.java   |  192 +-
 .../client/gui/inventory/GuiContainer.java         |   40 +-
 .../client/gui/inventory/GuiContainerCreative.java |    9 +-
 .../client/gui/inventory/GuiEditSign.java          |  376 +-
 .../client/gui/inventory/GuiInventory.java         |    1 +
 .../gui/spectator/categories/TeleportToPlayer.java |    6 +-
 .../gui/spectator/categories/TeleportToTeam.java   |    4 +-
 .../client/gui/stream/GuiIngestServers.java        |    1 +
 .../client/gui/stream/GuiStreamOptions.java        |    1 +
 .../client/gui/stream/GuiStreamUnavailable.java    |    4 +
 .../client/gui/stream/GuiTwitchUserMode.java       |    2 +
 src/net/minecraft/client/main/Main.java            |   19 +-
 .../client/multiplayer/GuiConnecting.java          |    2 +
 .../client/multiplayer/PlayerControllerMP.java     | 1256 ++--
 .../minecraft/client/multiplayer/ServerList.java   |   16 +-
 .../minecraft/client/multiplayer/WorldClient.java  |    2 +
 .../client/network/NetHandlerLoginClient.java      |    5 +
 .../client/network/NetHandlerPlayClient.java       |   20 +-
 .../client/network/NetworkPlayerInfo.java          |   53 +-
 .../minecraft/client/network/OldServerPinger.java  |    4 +
 src/net/minecraft/client/particle/Barrier.java     |    2 +-
 .../minecraft/client/particle/EffectRenderer.java  |    2 +
 .../client/particle/EntityBreakingFX.java          |    2 +-
 .../minecraft/client/particle/EntityDiggingFX.java |    2 +-
 src/net/minecraft/client/particle/EntityFX.java    |    2 +-
 .../client/particle/EntityFireworkOverlayFX.java   |    2 +-
 .../client/particle/EntityFootStepFX.java          |    2 +-
 .../client/particle/EntityLargeExplodeFX.java      |    2 +-
 .../client/renderer/BlockFluidRenderer.java        |    6 +-
 .../client/renderer/BlockModelRenderer.java        |    1 +
 .../minecraft/client/renderer/EntityRenderer.java  | 4147 ++++++------
 .../client/renderer/InventoryEffectRenderer.java   |    4 +-
 .../minecraft/client/renderer/ItemRenderer.java    |    2 +-
 .../minecraft/client/renderer/RenderGlobal.java    |   32 +-
 src/net/minecraft/client/renderer/Tessellator.java |    2 +
 .../client/renderer/ThreadDownloadImageData.java   |   40 +-
 .../minecraft/client/renderer/WorldRenderer.java   | 1238 ++--
 .../client/renderer/chunk/ChunkRenderWorker.java   |    3 +
 .../minecraft/client/renderer/entity/Render.java   |  810 +--
 .../client/renderer/entity/RenderDragon.java       |    4 +-
 .../client/renderer/entity/RenderFallingBlock.java |  189 +-
 .../client/renderer/entity/RenderFish.java         |    2 +-
 .../client/renderer/entity/RenderGuardian.java     |    2 +-
 .../client/renderer/entity/RenderItem.java         |   44 +-
 .../renderer/entity/RenderLightningBolt.java       |    2 +-
 .../client/renderer/entity/RenderLiving.java       |    8 +-
 .../client/renderer/entity/RenderManager.java      |   21 +-
 .../client/renderer/entity/RenderPlayer.java       |  539 +-
 .../client/renderer/entity/RenderXPOrb.java        |    2 +-
 .../renderer/entity/RendererLivingEntity.java      | 1363 ++--
 .../entity/layers/LayerEnderDragonDeath.java       |    4 +-
 .../renderer/texture/TextureAtlasSprite.java       |    2 +
 .../client/renderer/texture/TextureManager.java    |  313 +-
 .../client/renderer/texture/TextureMap.java        |    3 +
 .../renderer/tileentity/RenderItemFrame.java       |    2 +-
 .../tileentity/TileEntityBeaconRenderer.java       |    4 +-
 .../tileentity/TileEntityEndPortalRenderer.java    |    2 +-
 .../tileentity/TileEntityPistonRenderer.java       |    2 +-
 .../tileentity/TileEntityRendererDispatcher.java   |    2 +
 .../tileentity/TileEntitySkullRenderer.java        |    4 +-
 .../client/resources/DefaultPlayerSkin.java        |   21 +-
 .../client/resources/DefaultResourcePack.java      |    6 +-
 .../client/resources/FallbackResourceManager.java  |    7 +-
 .../client/resources/ResourcePackListEntry.java    |    4 +-
 .../client/resources/ResourcePackRepository.java   |    6 +-
 .../minecraft/client/resources/SkinManager.java    |  375 +-
 .../minecraft/client/settings/GameSettings.java    |    3 +-
 src/net/minecraft/client/settings/KeyBinding.java  |    8 +-
 src/net/minecraft/client/shader/Framebuffer.java   |    2 +-
 src/net/minecraft/client/shader/Shader.java        |    2 +-
 .../client/stream/BroadcastController.java         |    4 +
 src/net/minecraft/command/IEntitySelector.java     |    2 +-
 .../command/server/CommandBlockLogic.java          |    2 +
 src/net/minecraft/crash/CrashReport.java           |  839 +--
 src/net/minecraft/crash/CrashReportCategory.java   |    3 +
 src/net/minecraft/entity/DataWatcher.java          |   12 +-
 src/net/minecraft/entity/Entity.java               | 5550 ++++++++--------
 src/net/minecraft/entity/EntityLivingBase.java     | 4554 ++++++-------
 src/net/minecraft/entity/EntityTracker.java        |    3 +
 src/net/minecraft/entity/boss/EntityDragon.java    |    2 +-
 .../minecraft/entity/item/EntityArmorStand.java    |    2 +-
 src/net/minecraft/entity/item/EntityXPOrb.java     |    2 +-
 src/net/minecraft/entity/player/EntityPlayer.java  | 5079 +++++++--------
 .../minecraft/entity/player/EntityPlayerMP.java    |   12 +-
 .../minecraft/entity/player/InventoryPlayer.java   |    1 +
 .../minecraft/entity/projectile/EntityArrow.java   |    2 +-
 .../entity/projectile/EntitySmallFireball.java     |    2 +-
 .../entity/projectile/EntityThrowable.java         |    2 +-
 src/net/minecraft/inventory/ContainerPlayer.java   |    2 +-
 src/net/minecraft/inventory/Slot.java              |    7 +-
 src/net/minecraft/item/ItemBoat.java               |    2 +-
 src/net/minecraft/item/ItemBucket.java             |    8 +-
 src/net/minecraft/item/ItemEnderEye.java           |    2 +-
 src/net/minecraft/item/ItemGlassBottle.java        |    4 +-
 src/net/minecraft/item/ItemLilyPad.java            |    4 +-
 src/net/minecraft/item/ItemMonsterPlacer.java      |    4 +-
 src/net/minecraft/nbt/CompressedStreamTools.java   |    1 +
 src/net/minecraft/nbt/NBTTagCompound.java          |    3 +
 .../minecraft/network/NetHandlerPlayServer.java    |   17 +-
 src/net/minecraft/network/NetworkManager.java      |  943 ++-
 src/net/minecraft/network/NetworkSystem.java       |    5 +
 src/net/minecraft/network/PacketBuffer.java        |    6 +-
 src/net/minecraft/realms/RealmsConnect.java        |    2 +
 src/net/minecraft/realms/RealmsScreen.java         |    2 +-
 .../minecraft/realms/RealmsServerStatusPinger.java |    3 +
 src/net/minecraft/realms/Tezzelator.java           |   14 +-
 src/net/minecraft/server/MinecraftServer.java      |    5 +
 .../server/integrated/IntegratedServer.java        |    3 +
 .../server/management/LowerStringMap.java          |    4 +-
 .../server/management/PlayerProfileCache.java      |    4 +-
 .../management/ServerConfigurationManager.java     |    4 +
 .../server/network/NetHandlerLoginServer.java      |   12 +-
 src/net/minecraft/tileentity/TileEntityChest.java  |    4 +-
 src/net/minecraft/tileentity/TileEntitySign.java   |    3 +-
 src/net/minecraft/util/CryptManager.java           |   30 +-
 src/net/minecraft/util/JsonSerializableSet.java    |    6 +-
 src/net/minecraft/util/MessageDeserializer.java    |    3 +
 src/net/minecraft/util/MessageDeserializer2.java   |    6 +-
 src/net/minecraft/util/MessageSerializer.java      |    6 +-
 src/net/minecraft/util/MovingObjectPosition.java   |   20 +-
 src/net/minecraft/util/Timer.java                  |  227 +-
 src/net/minecraft/village/VillageSiege.java        |    2 +-
 src/net/minecraft/world/SpawnerAnimals.java        |   31 +-
 src/net/minecraft/world/World.java                 |    2 +
 src/net/minecraft/world/WorldServer.java           |    7 +-
 .../minecraft/world/biome/WorldChunkManager.java   |    2 +
 src/net/minecraft/world/chunk/Chunk.java           |    3 +
 .../minecraft/world/chunk/storage/RegionFile.java  |    6 +-
 .../minecraft/world/gen/ChunkProviderServer.java   |    3 +
 src/net/minecraft/world/gen/layer/GenLayer.java    |    1 +
 .../world/gen/structure/MapGenStructure.java       |    2 +
 203 files changed, 28203 insertions(+), 26509 deletions(-)

diff --git a/src/net/minecraft/block/Block.java b/src/net/minecraft/block/Block.java
index 5c07aa4..2655c9c 100644
--- a/src/net/minecraft/block/Block.java
+++ b/src/net/minecraft/block/Block.java
@@ -1,1511 +1,1520 @@
-package net.minecraft.block;
-
-import java.util.Iterator;
-import java.util.List;
-import java.util.Random;
-import net.minecraft.block.material.MapColor;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.properties.IProperty;
-import net.minecraft.block.state.BlockState;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.creativetab.CreativeTabs;
-import net.minecraft.enchantment.EnchantmentHelper;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.item.EntityItem;
-import net.minecraft.entity.item.EntityXPOrb;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemBlock;
-import net.minecraft.item.ItemStack;
-import net.minecraft.stats.StatList;
-import net.minecraft.tileentity.TileEntity;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumWorldBlockLayer;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ObjectIntIdentityMap;
-import net.minecraft.util.RegistryNamespacedDefaultedByKey;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.StatCollector;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.Explosion;
-import net.minecraft.world.IBlockAccess;
-import net.minecraft.world.World;
-
-public class Block
-{
-    /** ResourceLocation for the Air block */
-    private static final ResourceLocation AIR_ID = new ResourceLocation("air");
-    public static final RegistryNamespacedDefaultedByKey blockRegistry = new RegistryNamespacedDefaultedByKey(AIR_ID);
-    public static final ObjectIntIdentityMap BLOCK_STATE_IDS = new ObjectIntIdentityMap();
-    private CreativeTabs displayOnCreativeTab;
-    public static final Block.SoundType soundTypeStone = new Block.SoundType("stone", 1.0F, 1.0F);
-
-    /** the wood sound type */
-    public static final Block.SoundType soundTypeWood = new Block.SoundType("wood", 1.0F, 1.0F);
-
-    /** the gravel sound type */
-    public static final Block.SoundType soundTypeGravel = new Block.SoundType("gravel", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypeGrass = new Block.SoundType("grass", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypePiston = new Block.SoundType("stone", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypeMetal = new Block.SoundType("stone", 1.0F, 1.5F);
-    public static final Block.SoundType soundTypeGlass = new Block.SoundType("stone", 1.0F, 1.0F)
-    {
-        private static final String __OBFID = "CL_00000200";
-        public String getBreakSound()
-        {
-            return "dig.glass";
-        }
-        public String getPlaceSound()
-        {
-            return "step.stone";
-        }
-    };
-    public static final Block.SoundType soundTypeCloth = new Block.SoundType("cloth", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypeSand = new Block.SoundType("sand", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypeSnow = new Block.SoundType("snow", 1.0F, 1.0F);
-    public static final Block.SoundType soundTypeLadder = new Block.SoundType("ladder", 1.0F, 1.0F)
-    {
-        private static final String __OBFID = "CL_00000201";
-        public String getBreakSound()
-        {
-            return "dig.wood";
-        }
-    };
-    public static final Block.SoundType soundTypeAnvil = new Block.SoundType("anvil", 0.3F, 1.0F)
-    {
-        private static final String __OBFID = "CL_00000202";
-        public String getBreakSound()
-        {
-            return "dig.stone";
-        }
-        public String getPlaceSound()
-        {
-            return "random.anvil_land";
-        }
-    };
-    public static final Block.SoundType SLIME_SOUND = new Block.SoundType("slime", 1.0F, 1.0F)
-    {
-        private static final String __OBFID = "CL_00002133";
-        public String getBreakSound()
-        {
-            return "mob.slime.big";
-        }
-        public String getPlaceSound()
-        {
-            return "mob.slime.big";
-        }
-        public String getStepSound()
-        {
-            return "mob.slime.small";
-        }
-    };
-    protected boolean fullBlock;
-
-    /** How much light is subtracted for going through this block */
-    protected int lightOpacity;
-    protected boolean translucent;
-
-    /** Amount of light emitted */
-    protected int lightValue;
-
-    /**
-     * Flag if block should use the brightest neighbor light value as its own
-     */
-    protected boolean useNeighborBrightness;
-
-    /** Indicates how many hits it takes to break a block. */
-    protected float blockHardness;
-    protected float blockResistance;
-    protected boolean enableStats = true;
-
-    /**
-     * Flags whether or not this block is of a type that needs random ticking. Ref-counted by ExtendedBlockStorage in
-     * order to broadly cull a chunk from the random chunk update list for efficiency's sake.
-     */
-    protected boolean needsRandomTick;
-
-    /** true if the Block contains a Tile Entity */
-    protected boolean isBlockContainer;
-    protected double minX;
-    protected double minY;
-    protected double minZ;
-    protected double maxX;
-    protected double maxY;
-    protected double maxZ;
-
-    /** Sound of stepping on the block */
-    public Block.SoundType stepSound;
-    public float blockParticleGravity;
-    protected final Material blockMaterial;
-
-    /**
-     * Determines how much velocity is maintained while moving on top of this block
-     */
-    public float slipperiness;
-    protected final BlockState blockState;
-    private IBlockState defaultBlockState;
-    private String unlocalizedName;
-    private static final String __OBFID = "CL_00000199";
-
-    public static int getIdFromBlock(Block blockIn)
-    {
-        return blockRegistry.getIDForObject(blockIn);
-    }
-
-    /**
-     * Get a unique ID for the given BlockState, containing both BlockID and metadata
-     */
-    public static int getStateId(IBlockState state)
-    {
-        return getIdFromBlock(state.getBlock()) + (state.getBlock().getMetaFromState(state) << 12);
-    }
-
-    public static Block getBlockById(int id)
-    {
-        return (Block)blockRegistry.getObjectById(id);
-    }
-
-    /**
-     * Get a BlockState by it's ID (see getStateId)
-     */
-    public static IBlockState getStateById(int id)
-    {
-        int var1 = id & 4095;
-        int var2 = id >> 12 & 15;
-        return getBlockById(var1).getStateFromMeta(var2);
-    }
-
-    public static Block getBlockFromItem(Item itemIn)
-    {
-        return itemIn instanceof ItemBlock ? ((ItemBlock)itemIn).getBlock() : null;
-    }
-
-    public static Block getBlockFromName(String name)
-    {
-        ResourceLocation var1 = new ResourceLocation(name);
-
-        if (blockRegistry.containsKey(var1))
-        {
-            return (Block)blockRegistry.getObject(var1);
-        }
-        else
-        {
-            try
-            {
-                return (Block)blockRegistry.getObjectById(Integer.parseInt(name));
-            }
-            catch (NumberFormatException var3)
-            {
-                return null;
-            }
-        }
-    }
-
-    public boolean isFullBlock()
-    {
-        return this.fullBlock;
-    }
-
-    public int getLightOpacity()
-    {
-        return this.lightOpacity;
-    }
-
-    public boolean isTranslucent()
-    {
-        return this.translucent;
-    }
-
-    public int getLightValue()
-    {
-        return this.lightValue;
-    }
-
-    /**
-     * Should block use the brightest neighbor light value as its own
-     */
-    public boolean getUseNeighborBrightness()
-    {
-        return this.useNeighborBrightness;
-    }
-
-    /**
-     * Get a material of block
-     */
-    public Material getMaterial()
-    {
-        return this.blockMaterial;
-    }
-
-    /**
-     * Get the MapColor for this Block and the given BlockState
-     */
-    public MapColor getMapColor(IBlockState state)
-    {
-        return this.getMaterial().getMaterialMapColor();
-    }
-
-    /**
-     * Convert the given metadata into a BlockState for this Block
-     */
-    public IBlockState getStateFromMeta(int meta)
-    {
-        return this.getDefaultState();
-    }
-
-    /**
-     * Convert the BlockState into the correct metadata value
-     */
-    public int getMetaFromState(IBlockState state)
-    {
-        if (state != null && !state.getPropertyNames().isEmpty())
-        {
-            throw new IllegalArgumentException("Don\'t know how to convert " + state + " back into data...");
-        }
-        else
-        {
-            return 0;
-        }
-    }
-
-    /**
-     * Get the actual Block state of this Block at the given position. This applies properties not visible in the
-     * metadata, such as fence connections.
-     */
-    public IBlockState getActualState(IBlockState state, IBlockAccess worldIn, BlockPos pos)
-    {
-        return state;
-    }
-
-    protected Block(Material materialIn)
-    {
-        this.stepSound = soundTypeStone;
-        this.blockParticleGravity = 1.0F;
-        this.slipperiness = 0.6F;
-        this.blockMaterial = materialIn;
-        this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
-        this.fullBlock = this.isOpaqueCube();
-        this.lightOpacity = this.isOpaqueCube() ? 255 : 0;
-        this.translucent = !materialIn.blocksLight();
-        this.blockState = this.createBlockState();
-        this.setDefaultState(this.blockState.getBaseState());
-    }
-
-    /**
-     * Sets the footstep sound for the block. Returns the object for convenience in constructing.
-     */
-    protected Block setStepSound(Block.SoundType sound)
-    {
-        this.stepSound = sound;
-        return this;
-    }
-
-    /**
-     * Sets how much light is blocked going through this block. Returns the object for convenience in constructing.
-     */
-    protected Block setLightOpacity(int opacity)
-    {
-        this.lightOpacity = opacity;
-        return this;
-    }
-
-    /**
-     * Sets the light value that the block emits. Returns resulting block instance for constructing convenience. Args:
-     * level
-     */
-    protected Block setLightLevel(float value)
-    {
-        this.lightValue = (int)(15.0F * value);
-        return this;
-    }
-
-    /**
-     * Sets the the blocks resistance to explosions. Returns the object for convenience in constructing.
-     */
-    protected Block setResistance(float resistance)
-    {
-        this.blockResistance = resistance * 3.0F;
-        return this;
-    }
-
-    /**
-     * Indicate if a material is a normal solid opaque cube
-     */
-    public boolean isSolidFullCube()
-    {
-        return this.blockMaterial.blocksMovement() && this.isFullCube();
-    }
-
-    public boolean isNormalCube()
-    {
-        return this.blockMaterial.isOpaque() && this.isFullCube() && !this.canProvidePower();
-    }
-
-    public boolean isVisuallyOpaque()
-    {
-        return this.blockMaterial.blocksMovement() && this.isFullCube();
-    }
-
-    public boolean isFullCube()
-    {
-        return true;
-    }
-
-    public boolean isPassable(IBlockAccess blockAccess, BlockPos pos)
-    {
-        return !this.blockMaterial.blocksMovement();
-    }
-
-    /**
-     * The type of render function that is called for this block
-     */
-    public int getRenderType()
-    {
-        return 3;
-    }
-
-    /**
-     * Whether this Block can be replaced directly by other blocks (true for e.g. tall grass)
-     */
-    public boolean isReplaceable(World worldIn, BlockPos pos)
-    {
-        return false;
-    }
-
-    /**
-     * Sets how many hits it takes to break a block.
-     */
-    protected Block setHardness(float hardness)
-    {
-        this.blockHardness = hardness;
-
-        if (this.blockResistance < hardness * 5.0F)
-        {
-            this.blockResistance = hardness * 5.0F;
-        }
-
-        return this;
-    }
-
-    protected Block setBlockUnbreakable()
-    {
-        this.setHardness(-1.0F);
-        return this;
-    }
-
-    public float getBlockHardness(World worldIn, BlockPos pos)
-    {
-        return this.blockHardness;
-    }
-
-    /**
-     * Sets whether this block type will receive random update ticks
-     */
-    protected Block setTickRandomly(boolean shouldTick)
-    {
-        this.needsRandomTick = shouldTick;
-        return this;
-    }
-
-    /**
-     * Returns whether or not this block is of a type that needs random ticking. Called for ref-counting purposes by
-     * ExtendedBlockStorage in order to broadly cull a chunk from the random chunk update list for efficiency's sake.
-     */
-    public boolean getTickRandomly()
-    {
-        return this.needsRandomTick;
-    }
-
-    public boolean hasTileEntity()
-    {
-        return this.isBlockContainer;
-    }
-
-    protected final void setBlockBounds(float minX, float minY, float minZ, float maxX, float maxY, float maxZ)
-    {
-        this.minX = (double)minX;
-        this.minY = (double)minY;
-        this.minZ = (double)minZ;
-        this.maxX = (double)maxX;
-        this.maxY = (double)maxY;
-        this.maxZ = (double)maxZ;
-    }
-
-    public int getMixedBrightnessForBlock(IBlockAccess worldIn, BlockPos pos)
-    {
-        Block var3 = worldIn.getBlockState(pos).getBlock();
-        int var4 = worldIn.getCombinedLight(pos, var3.getLightValue());
-
-        if (var4 == 0 && var3 instanceof BlockSlab)
-        {
-            pos = pos.offsetDown();
-            var3 = worldIn.getBlockState(pos).getBlock();
-            return worldIn.getCombinedLight(pos, var3.getLightValue());
-        }
-        else
-        {
-            return var4;
-        }
-    }
-
-    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
-    {
-        return side == EnumFacing.DOWN && this.minY > 0.0D ? true : (side == EnumFacing.UP && this.maxY < 1.0D ? true : (side == EnumFacing.NORTH && this.minZ > 0.0D ? true : (side == EnumFacing.SOUTH && this.maxZ < 1.0D ? true : (side == EnumFacing.WEST && this.minX > 0.0D ? true : (side == EnumFacing.EAST && this.maxX < 1.0D ? true : !worldIn.getBlockState(pos).getBlock().isOpaqueCube())))));
-    }
-
-    /**
-     * Whether this Block is solid on the given Side
-     */
-    public boolean isBlockSolid(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
-    {
-        return worldIn.getBlockState(pos).getBlock().getMaterial().isSolid();
-    }
-
-    public AxisAlignedBB getSelectedBoundingBox(World worldIn, BlockPos pos)
-    {
-        return new AxisAlignedBB((double)pos.getX() + this.minX, (double)pos.getY() + this.minY, (double)pos.getZ() + this.minZ, (double)pos.getX() + this.maxX, (double)pos.getY() + this.maxY, (double)pos.getZ() + this.maxZ);
-    }
-
-    /**
-     * Add all collision boxes of this Block to the list that intersect with the given mask.
-     *  
-     * @param collidingEntity the Entity colliding with this Block
-     */
-    public void addCollisionBoxesToList(World worldIn, BlockPos pos, IBlockState state, AxisAlignedBB mask, List list, Entity collidingEntity)
-    {
-        AxisAlignedBB var7 = this.getCollisionBoundingBox(worldIn, pos, state);
-
-        if (var7 != null && mask.intersectsWith(var7))
-        {
-            list.add(var7);
-        }
-    }
-
-    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
-    {
-        return new AxisAlignedBB((double)pos.getX() + this.minX, (double)pos.getY() + this.minY, (double)pos.getZ() + this.minZ, (double)pos.getX() + this.maxX, (double)pos.getY() + this.maxY, (double)pos.getZ() + this.maxZ);
-    }
-
-    public boolean isOpaqueCube()
-    {
-        return true;
-    }
-
-    public boolean canCollideCheck(IBlockState state, boolean p_176209_2_)
-    {
-        return this.isCollidable();
-    }
-
-    /**
-     * Returns if this block is collidable (only used by Fire). Args: x, y, z
-     */
-    public boolean isCollidable()
-    {
-        return true;
-    }
-
-    /**
-     * Called randomly when setTickRandomly is set to true (used by e.g. crops to grow, etc.)
-     */
-    public void randomTick(World worldIn, BlockPos pos, IBlockState state, Random random)
-    {
-        this.updateTick(worldIn, pos, state, random);
-    }
-
-    public void updateTick(World worldIn, BlockPos pos, IBlockState state, Random rand) {}
-
-    public void randomDisplayTick(World worldIn, BlockPos pos, IBlockState state, Random rand) {}
-
-    /**
-     * Called when a player destroys this Block
-     */
-    public void onBlockDestroyedByPlayer(World worldIn, BlockPos pos, IBlockState state) {}
-
-    public void onNeighborBlockChange(World worldIn, BlockPos pos, IBlockState state, Block neighborBlock) {}
-
-    /**
-     * How many world ticks before ticking
-     */
-    public int tickRate(World worldIn)
-    {
-        return 10;
-    }
-
-    public void onBlockAdded(World worldIn, BlockPos pos, IBlockState state) {}
-
-    public void breakBlock(World worldIn, BlockPos pos, IBlockState state) {}
-
-    /**
-     * Returns the quantity of items to drop on block destruction.
-     */
-    public int quantityDropped(Random random)
-    {
-        return 1;
-    }
-
-    /**
-     * Get the Item that this Block should drop when harvested.
-     *  
-     * @param fortune the level of the Fortune enchantment on the player's tool
-     */
-    public Item getItemDropped(IBlockState state, Random rand, int fortune)
-    {
-        return Item.getItemFromBlock(this);
-    }
-
-    /**
-     * Get the hardness of this Block relative to the ability of the given player
-     */
-    public float getPlayerRelativeBlockHardness(EntityPlayer playerIn, World worldIn, BlockPos pos)
-    {
-        float var4 = this.getBlockHardness(worldIn, pos);
-        return var4 < 0.0F ? 0.0F : (!playerIn.canHarvestBlock(this) ? playerIn.func_180471_a(this) / var4 / 100.0F : playerIn.func_180471_a(this) / var4 / 30.0F);
-    }
-
-    /**
-     * Spawn this Block's drops into the World as EntityItems
-     *  
-     * @param forture the level of the Fortune enchantment on the player's tool
-     */
-    public final void dropBlockAsItem(World worldIn, BlockPos pos, IBlockState state, int forture)
-    {
-        this.dropBlockAsItemWithChance(worldIn, pos, state, 1.0F, forture);
-    }
-
-    /**
-     * Spawns this Block's drops into the World as EntityItems.
-     *  
-     * @param chance The chance that each Item is actually spawned (1.0 = always, 0.0 = never)
-     * @param fortune The player's fortune level
-     */
-    public void dropBlockAsItemWithChance(World worldIn, BlockPos pos, IBlockState state, float chance, int fortune)
-    {
-        if (!worldIn.isRemote)
-        {
-            int var6 = this.quantityDroppedWithBonus(fortune, worldIn.rand);
-
-            for (int var7 = 0; var7 < var6; ++var7)
-            {
-                if (worldIn.rand.nextFloat() <= chance)
-                {
-                    Item var8 = this.getItemDropped(state, worldIn.rand, fortune);
-
-                    if (var8 != null)
-                    {
-                        spawnAsEntity(worldIn, pos, new ItemStack(var8, 1, this.damageDropped(state)));
-                    }
-                }
-            }
-        }
-    }
-
-    /**
-     * Spawns the given ItemStack as an EntityItem into the World at the given position
-     */
-    public static void spawnAsEntity(World worldIn, BlockPos pos, ItemStack stack)
-    {
-        if (!worldIn.isRemote && worldIn.getGameRules().getGameRuleBooleanValue("doTileDrops"))
-        {
-            float var3 = 0.5F;
-            double var4 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
-            double var6 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
-            double var8 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
-            EntityItem var10 = new EntityItem(worldIn, (double)pos.getX() + var4, (double)pos.getY() + var6, (double)pos.getZ() + var8, stack);
-            var10.setDefaultPickupDelay();
-            worldIn.spawnEntityInWorld(var10);
-        }
-    }
-
-    /**
-     * Spawns the given amount of experience into the World as XP orb entities
-     *  
-     * @param amount The amount of XP to spawn
-     */
-    protected void dropXpOnBlockBreak(World worldIn, BlockPos pos, int amount)
-    {
-        if (!worldIn.isRemote)
-        {
-            while (amount > 0)
-            {
-                int var4 = EntityXPOrb.getXPSplit(amount);
-                amount -= var4;
-                worldIn.spawnEntityInWorld(new EntityXPOrb(worldIn, (double)pos.getX() + 0.5D, (double)pos.getY() + 0.5D, (double)pos.getZ() + 0.5D, var4));
-            }
-        }
-    }
-
-    /**
-     * Get the damage value that this Block should drop
-     */
-    public int damageDropped(IBlockState state)
-    {
-        return 0;
-    }
-
-    /**
-     * Returns how much this block can resist explosions from the passed in entity.
-     */
-    public float getExplosionResistance(Entity exploder)
-    {
-        return this.blockResistance / 5.0F;
-    }
-
-    /**
-     * Ray traces through the blocks collision from start vector to end vector returning a ray trace hit.
-     *  
-     * @param start The start vector
-     * @param end The end vector
-     */
-    public MovingObjectPosition collisionRayTrace(World worldIn, BlockPos pos, Vec3 start, Vec3 end)
-    {
-        this.setBlockBoundsBasedOnState(worldIn, pos);
-        start = start.addVector((double)(-pos.getX()), (double)(-pos.getY()), (double)(-pos.getZ()));
-        end = end.addVector((double)(-pos.getX()), (double)(-pos.getY()), (double)(-pos.getZ()));
-        Vec3 var5 = start.getIntermediateWithXValue(end, this.minX);
-        Vec3 var6 = start.getIntermediateWithXValue(end, this.maxX);
-        Vec3 var7 = start.getIntermediateWithYValue(end, this.minY);
-        Vec3 var8 = start.getIntermediateWithYValue(end, this.maxY);
-        Vec3 var9 = start.getIntermediateWithZValue(end, this.minZ);
-        Vec3 var10 = start.getIntermediateWithZValue(end, this.maxZ);
-
-        if (!this.isVecInsideYZBounds(var5))
-        {
-            var5 = null;
-        }
-
-        if (!this.isVecInsideYZBounds(var6))
-        {
-            var6 = null;
-        }
-
-        if (!this.isVecInsideXZBounds(var7))
-        {
-            var7 = null;
-        }
-
-        if (!this.isVecInsideXZBounds(var8))
-        {
-            var8 = null;
-        }
-
-        if (!this.isVecInsideXYBounds(var9))
-        {
-            var9 = null;
-        }
-
-        if (!this.isVecInsideXYBounds(var10))
-        {
-            var10 = null;
-        }
-
-        Vec3 var11 = null;
-
-        if (var5 != null && (var11 == null || start.squareDistanceTo(var5) < start.squareDistanceTo(var11)))
-        {
-            var11 = var5;
-        }
-
-        if (var6 != null && (var11 == null || start.squareDistanceTo(var6) < start.squareDistanceTo(var11)))
-        {
-            var11 = var6;
-        }
-
-        if (var7 != null && (var11 == null || start.squareDistanceTo(var7) < start.squareDistanceTo(var11)))
-        {
-            var11 = var7;
-        }
-
-        if (var8 != null && (var11 == null || start.squareDistanceTo(var8) < start.squareDistanceTo(var11)))
-        {
-            var11 = var8;
-        }
-
-        if (var9 != null && (var11 == null || start.squareDistanceTo(var9) < start.squareDistanceTo(var11)))
-        {
-            var11 = var9;
-        }
-
-        if (var10 != null && (var11 == null || start.squareDistanceTo(var10) < start.squareDistanceTo(var11)))
-        {
-            var11 = var10;
-        }
-
-        if (var11 == null)
-        {
-            return null;
-        }
-        else
-        {
-            EnumFacing var12 = null;
-
-            if (var11 == var5)
-            {
-                var12 = EnumFacing.WEST;
-            }
-
-            if (var11 == var6)
-            {
-                var12 = EnumFacing.EAST;
-            }
-
-            if (var11 == var7)
-            {
-                var12 = EnumFacing.DOWN;
-            }
-
-            if (var11 == var8)
-            {
-                var12 = EnumFacing.UP;
-            }
-
-            if (var11 == var9)
-            {
-                var12 = EnumFacing.NORTH;
-            }
-
-            if (var11 == var10)
-            {
-                var12 = EnumFacing.SOUTH;
-            }
-
-            return new MovingObjectPosition(var11.addVector((double)pos.getX(), (double)pos.getY(), (double)pos.getZ()), var12, pos);
-        }
-    }
-
-    /**
-     * Checks if a vector is within the Y and Z bounds of the block.
-     */
-    private boolean isVecInsideYZBounds(Vec3 point)
-    {
-        return point == null ? false : point.yCoord >= this.minY && point.yCoord <= this.maxY && point.zCoord >= this.minZ && point.zCoord <= this.maxZ;
-    }
-
-    /**
-     * Checks if a vector is within the X and Z bounds of the block.
-     */
-    private boolean isVecInsideXZBounds(Vec3 point)
-    {
-        return point == null ? false : point.xCoord >= this.minX && point.xCoord <= this.maxX && point.zCoord >= this.minZ && point.zCoord <= this.maxZ;
-    }
-
-    /**
-     * Checks if a vector is within the X and Y bounds of the block.
-     */
-    private boolean isVecInsideXYBounds(Vec3 point)
-    {
-        return point == null ? false : point.xCoord >= this.minX && point.xCoord <= this.maxX && point.yCoord >= this.minY && point.yCoord <= this.maxY;
-    }
-
-    /**
-     * Called when this Block is destroyed by an Explosion
-     */
-    public void onBlockDestroyedByExplosion(World worldIn, BlockPos pos, Explosion explosionIn) {}
-
-    public EnumWorldBlockLayer getBlockLayer()
-    {
-        return EnumWorldBlockLayer.SOLID;
-    }
-
-    public boolean canReplace(World worldIn, BlockPos pos, EnumFacing side, ItemStack stack)
-    {
-        return this.canPlaceBlockOnSide(worldIn, pos, side);
-    }
-
-    /**
-     * Check whether this Block can be placed on the given side
-     */
-    public boolean canPlaceBlockOnSide(World worldIn, BlockPos pos, EnumFacing side)
-    {
-        return this.canPlaceBlockAt(worldIn, pos);
-    }
-
-    public boolean canPlaceBlockAt(World worldIn, BlockPos pos)
-    {
-        return worldIn.getBlockState(pos).getBlock().blockMaterial.isReplaceable();
-    }
-
-    public boolean onBlockActivated(World worldIn, BlockPos pos, IBlockState state, EntityPlayer playerIn, EnumFacing side, float hitX, float hitY, float hitZ)
-    {
-        return false;
-    }
-
-    /**
-     * Triggered whenever an entity collides with this block (enters into the block)
-     */
-    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, Entity entityIn) {}
-
-    public IBlockState onBlockPlaced(World worldIn, BlockPos pos, EnumFacing facing, float hitX, float hitY, float hitZ, int meta, EntityLivingBase placer)
-    {
-        return this.getStateFromMeta(meta);
-    }
-
-    public void onBlockClicked(World worldIn, BlockPos pos, EntityPlayer playerIn) {}
-
-    public Vec3 modifyAcceleration(World worldIn, BlockPos pos, Entity entityIn, Vec3 motion)
-    {
-        return motion;
-    }
-
-    public void setBlockBoundsBasedOnState(IBlockAccess access, BlockPos pos) {}
-
-    /**
-     * returns the block bounderies minX value
-     */
-    public final double getBlockBoundsMinX()
-    {
-        return this.minX;
-    }
-
-    /**
-     * returns the block bounderies maxX value
-     */
-    public final double getBlockBoundsMaxX()
-    {
-        return this.maxX;
-    }
-
-    /**
-     * returns the block bounderies minY value
-     */
-    public final double getBlockBoundsMinY()
-    {
-        return this.minY;
-    }
-
-    /**
-     * returns the block bounderies maxY value
-     */
-    public final double getBlockBoundsMaxY()
-    {
-        return this.maxY;
-    }
-
-    /**
-     * returns the block bounderies minZ value
-     */
-    public final double getBlockBoundsMinZ()
-    {
-        return this.minZ;
-    }
-
-    /**
-     * returns the block bounderies maxZ value
-     */
-    public final double getBlockBoundsMaxZ()
-    {
-        return this.maxZ;
-    }
-
-    public int getBlockColor()
-    {
-        return 16777215;
-    }
-
-    public int getRenderColor(IBlockState state)
-    {
-        return 16777215;
-    }
-
-    public int colorMultiplier(IBlockAccess worldIn, BlockPos pos, int renderPass)
-    {
-        return 16777215;
-    }
-
-    public final int colorMultiplier(IBlockAccess worldIn, BlockPos pos)
-    {
-        return this.colorMultiplier(worldIn, pos, 0);
-    }
-
-    public int isProvidingWeakPower(IBlockAccess worldIn, BlockPos pos, IBlockState state, EnumFacing side)
-    {
-        return 0;
-    }
-
-    /**
-     * Can this block provide power. Only wire currently seems to have this change based on its state.
-     */
-    public boolean canProvidePower()
-    {
-        return false;
-    }
-
-    /**
-     * Called When an Entity Collided with the Block
-     */
-    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, IBlockState state, Entity entityIn) {}
-
-    public int isProvidingStrongPower(IBlockAccess worldIn, BlockPos pos, IBlockState state, EnumFacing side)
-    {
-        return 0;
-    }
-
-    /**
-     * Sets the block's bounds for rendering it as an item
-     */
-    public void setBlockBoundsForItemRender() {}
-
-    public void harvestBlock(World worldIn, EntityPlayer playerIn, BlockPos pos, IBlockState state, TileEntity te)
-    {
-        playerIn.triggerAchievement(StatList.mineBlockStatArray[getIdFromBlock(this)]);
-        playerIn.addExhaustion(0.025F);
-
-        if (this.canSilkHarvest() && EnchantmentHelper.getSilkTouchModifier(playerIn))
-        {
-            ItemStack var7 = this.createStackedBlock(state);
-
-            if (var7 != null)
-            {
-                spawnAsEntity(worldIn, pos, var7);
-            }
-        }
-        else
-        {
-            int var6 = EnchantmentHelper.getFortuneModifier(playerIn);
-            this.dropBlockAsItem(worldIn, pos, state, var6);
-        }
-    }
-
-    protected boolean canSilkHarvest()
-    {
-        return this.isFullCube() && !this.isBlockContainer;
-    }
-
-    protected ItemStack createStackedBlock(IBlockState state)
-    {
-        int var2 = 0;
-        Item var3 = Item.getItemFromBlock(this);
-
-        if (var3 != null && var3.getHasSubtypes())
-        {
-            var2 = this.getMetaFromState(state);
-        }
-
-        return new ItemStack(var3, 1, var2);
-    }
-
-    /**
-     * Get the quantity dropped based on the given fortune level
-     */
-    public int quantityDroppedWithBonus(int fortune, Random random)
-    {
-        return this.quantityDropped(random);
-    }
-
-    public void onBlockPlacedBy(World worldIn, BlockPos pos, IBlockState state, EntityLivingBase placer, ItemStack stack) {}
-
-    public Block setUnlocalizedName(String name)
-    {
-        this.unlocalizedName = name;
-        return this;
-    }
-
-    /**
-     * Gets the localized name of this block. Used for the statistics page.
-     */
-    public String getLocalizedName()
-    {
-        return StatCollector.translateToLocal(this.getUnlocalizedName() + ".name");
-    }
-
-    /**
-     * Returns the unlocalized name of the block with "tile." appended to the front.
-     */
-    public String getUnlocalizedName()
-    {
-        return "tile." + this.unlocalizedName;
-    }
-
-    /**
-     * Called on both Client and Server when World#addBlockEvent is called
-     */
-    public boolean onBlockEventReceived(World worldIn, BlockPos pos, IBlockState state, int eventID, int eventParam)
-    {
-        return false;
-    }
-
-    /**
-     * Return the state of blocks statistics flags - if the block is counted for mined and placed.
-     */
-    public boolean getEnableStats()
-    {
-        return this.enableStats;
-    }
-
-    protected Block disableStats()
-    {
-        this.enableStats = false;
-        return this;
-    }
-
-    public int getMobilityFlag()
-    {
-        return this.blockMaterial.getMaterialMobility();
-    }
-
-    /**
-     * Returns the default ambient occlusion value based on block opacity
-     */
-    public float getAmbientOcclusionLightValue()
-    {
-        return this.isSolidFullCube() ? 0.2F : 1.0F;
-    }
-
-    /**
-     * Block's chance to react to a living entity falling on it.
-     *  
-     * @param fallDistance The distance the entity has fallen before landing
-     */
-    public void onFallenUpon(World worldIn, BlockPos pos, Entity entityIn, float fallDistance)
-    {
-        entityIn.fall(fallDistance, 1.0F);
-    }
-
-    /**
-     * Called when an Entity lands on this Block. This method *must* update motionY because the entity will not do that
-     * on its own
-     */
-    public void onLanded(World worldIn, Entity entityIn)
-    {
-        entityIn.motionY = 0.0D;
-    }
-
-    public Item getItem(World worldIn, BlockPos pos)
-    {
-        return Item.getItemFromBlock(this);
-    }
-
-    public int getDamageValue(World worldIn, BlockPos pos)
-    {
-        return this.damageDropped(worldIn.getBlockState(pos));
-    }
-
-    /**
-     * returns a list of blocks with the same ID, but different meta (eg: wood returns 4 blocks)
-     */
-    public void getSubBlocks(Item itemIn, CreativeTabs tab, List list)
-    {
-        list.add(new ItemStack(itemIn, 1, 0));
-    }
-
-    /**
-     * Returns the CreativeTab to display the given block on.
-     */
-    public CreativeTabs getCreativeTabToDisplayOn()
-    {
-        return this.displayOnCreativeTab;
-    }
-
-    public Block setCreativeTab(CreativeTabs tab)
-    {
-        this.displayOnCreativeTab = tab;
-        return this;
-    }
-
-    public void onBlockHarvested(World worldIn, BlockPos pos, IBlockState state, EntityPlayer playerIn) {}
-
-    /**
-     * Called similar to random ticks, but only when it is raining.
-     */
-    public void fillWithRain(World worldIn, BlockPos pos) {}
-
-    /**
-     * Returns true only if block is flowerPot
-     */
-    public boolean isFlowerPot()
-    {
-        return false;
-    }
-
-    public boolean requiresUpdates()
-    {
-        return true;
-    }
-
-    /**
-     * Return whether this block can drop from an explosion.
-     */
-    public boolean canDropFromExplosion(Explosion explosionIn)
-    {
-        return true;
-    }
-
-    public boolean isAssociatedBlock(Block other)
-    {
-        return this == other;
-    }
-
-    public static boolean isEqualTo(Block blockIn, Block other)
-    {
-        return blockIn != null && other != null ? (blockIn == other ? true : blockIn.isAssociatedBlock(other)) : false;
-    }
-
-    public boolean hasComparatorInputOverride()
-    {
-        return false;
-    }
-
-    public int getComparatorInputOverride(World worldIn, BlockPos pos)
-    {
-        return 0;
-    }
-
-    /**
-     * Possibly modify the given BlockState before rendering it on an Entity (Minecarts, Endermen, ...)
-     */
-    public IBlockState getStateForEntityRender(IBlockState state)
-    {
-        return state;
-    }
-
-    protected BlockState createBlockState()
-    {
-        return new BlockState(this, new IProperty[0]);
-    }
-
-    public BlockState getBlockState()
-    {
-        return this.blockState;
-    }
-
-    protected final void setDefaultState(IBlockState state)
-    {
-        this.defaultBlockState = state;
-    }
-
-    public final IBlockState getDefaultState()
-    {
-        return this.defaultBlockState;
-    }
-
-    /**
-     * Get the OffsetType for this Block. Determines if the model is rendered slightly offset.
-     */
-    public Block.EnumOffsetType getOffsetType()
-    {
-        return Block.EnumOffsetType.NONE;
-    }
-
-    public static void registerBlocks()
-    {
-        registerBlock(0, AIR_ID, (new BlockAir()).setUnlocalizedName("air"));
-        registerBlock(1, "stone", (new BlockStone()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stone"));
-        registerBlock(2, "grass", (new BlockGrass()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("grass"));
-        registerBlock(3, "dirt", (new BlockDirt()).setHardness(0.5F).setStepSound(soundTypeGravel).setUnlocalizedName("dirt"));
-        Block var0 = (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stonebrick").setCreativeTab(CreativeTabs.tabBlock);
-        registerBlock(4, "cobblestone", var0);
-        Block var1 = (new BlockPlanks()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("wood");
-        registerBlock(5, "planks", var1);
-        registerBlock(6, "sapling", (new BlockSapling()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("sapling"));
-        registerBlock(7, "bedrock", (new Block(Material.rock)).setBlockUnbreakable().setResistance(6000000.0F).setStepSound(soundTypePiston).setUnlocalizedName("bedrock").disableStats().setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(8, "flowing_water", (new BlockDynamicLiquid(Material.water)).setHardness(100.0F).setLightOpacity(3).setUnlocalizedName("water").disableStats());
-        registerBlock(9, "water", (new BlockStaticLiquid(Material.water)).setHardness(100.0F).setLightOpacity(3).setUnlocalizedName("water").disableStats());
-        registerBlock(10, "flowing_lava", (new BlockDynamicLiquid(Material.lava)).setHardness(100.0F).setLightLevel(1.0F).setUnlocalizedName("lava").disableStats());
-        registerBlock(11, "lava", (new BlockStaticLiquid(Material.lava)).setHardness(100.0F).setLightLevel(1.0F).setUnlocalizedName("lava").disableStats());
-        registerBlock(12, "sand", (new BlockSand()).setHardness(0.5F).setStepSound(soundTypeSand).setUnlocalizedName("sand"));
-        registerBlock(13, "gravel", (new BlockGravel()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("gravel"));
-        registerBlock(14, "gold_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreGold"));
-        registerBlock(15, "iron_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreIron"));
-        registerBlock(16, "coal_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreCoal"));
-        registerBlock(17, "log", (new BlockOldLog()).setUnlocalizedName("log"));
-        registerBlock(18, "leaves", (new BlockOldLeaf()).setUnlocalizedName("leaves"));
-        registerBlock(19, "sponge", (new BlockSponge()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("sponge"));
-        registerBlock(20, "glass", (new BlockGlass(Material.glass, false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("glass"));
-        registerBlock(21, "lapis_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreLapis"));
-        registerBlock(22, "lapis_block", (new BlockCompressed(MapColor.lapisColor)).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("blockLapis").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(23, "dispenser", (new BlockDispenser()).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("dispenser"));
-        Block var2 = (new BlockSandStone()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("sandStone");
-        registerBlock(24, "sandstone", var2);
-        registerBlock(25, "noteblock", (new BlockNote()).setHardness(0.8F).setUnlocalizedName("musicBlock"));
-        registerBlock(26, "bed", (new BlockBed()).setStepSound(soundTypeWood).setHardness(0.2F).setUnlocalizedName("bed").disableStats());
-        registerBlock(27, "golden_rail", (new BlockRailPowered()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("goldenRail"));
-        registerBlock(28, "detector_rail", (new BlockRailDetector()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("detectorRail"));
-        registerBlock(29, "sticky_piston", (new BlockPistonBase(true)).setUnlocalizedName("pistonStickyBase"));
-        registerBlock(30, "web", (new BlockWeb()).setLightOpacity(1).setHardness(4.0F).setUnlocalizedName("web"));
-        registerBlock(31, "tallgrass", (new BlockTallGrass()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("tallgrass"));
-        registerBlock(32, "deadbush", (new BlockDeadBush()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("deadbush"));
-        registerBlock(33, "piston", (new BlockPistonBase(false)).setUnlocalizedName("pistonBase"));
-        registerBlock(34, "piston_head", new BlockPistonExtension());
-        registerBlock(35, "wool", (new BlockColored(Material.cloth)).setHardness(0.8F).setStepSound(soundTypeCloth).setUnlocalizedName("cloth"));
-        registerBlock(36, "piston_extension", new BlockPistonMoving());
-        registerBlock(37, "yellow_flower", (new BlockYellowFlower()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("flower1"));
-        registerBlock(38, "red_flower", (new BlockRedFlower()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("flower2"));
-        Block var3 = (new BlockMushroom()).setHardness(0.0F).setStepSound(soundTypeGrass).setLightLevel(0.125F).setUnlocalizedName("mushroom");
-        registerBlock(39, "brown_mushroom", var3);
-        Block var4 = (new BlockMushroom()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("mushroom");
-        registerBlock(40, "red_mushroom", var4);
-        registerBlock(41, "gold_block", (new BlockCompressed(MapColor.goldColor)).setHardness(3.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockGold"));
-        registerBlock(42, "iron_block", (new BlockCompressed(MapColor.ironColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockIron"));
-        registerBlock(43, "double_stone_slab", (new BlockDoubleStoneSlab()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab"));
-        registerBlock(44, "stone_slab", (new BlockHalfStoneSlab()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab"));
-        Block var5 = (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("brick").setCreativeTab(CreativeTabs.tabBlock);
-        registerBlock(45, "brick_block", var5);
-        registerBlock(46, "tnt", (new BlockTNT()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("tnt"));
-        registerBlock(47, "bookshelf", (new BlockBookshelf()).setHardness(1.5F).setStepSound(soundTypeWood).setUnlocalizedName("bookshelf"));
-        registerBlock(48, "mossy_cobblestone", (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneMoss").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(49, "obsidian", (new BlockObsidian()).setHardness(50.0F).setResistance(2000.0F).setStepSound(soundTypePiston).setUnlocalizedName("obsidian"));
-        registerBlock(50, "torch", (new BlockTorch()).setHardness(0.0F).setLightLevel(0.9375F).setStepSound(soundTypeWood).setUnlocalizedName("torch"));
-        registerBlock(51, "fire", (new BlockFire()).setHardness(0.0F).setLightLevel(1.0F).setStepSound(soundTypeCloth).setUnlocalizedName("fire").disableStats());
-        registerBlock(52, "mob_spawner", (new BlockMobSpawner()).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("mobSpawner").disableStats());
-        registerBlock(53, "oak_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.OAK))).setUnlocalizedName("stairsWood"));
-        registerBlock(54, "chest", (new BlockChest(0)).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("chest"));
-        registerBlock(55, "redstone_wire", (new BlockRedstoneWire()).setHardness(0.0F).setStepSound(soundTypeStone).setUnlocalizedName("redstoneDust").disableStats());
-        registerBlock(56, "diamond_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreDiamond"));
-        registerBlock(57, "diamond_block", (new BlockCompressed(MapColor.diamondColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockDiamond"));
-        registerBlock(58, "crafting_table", (new BlockWorkbench()).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("workbench"));
-        registerBlock(59, "wheat", (new BlockCrops()).setUnlocalizedName("crops"));
-        Block var6 = (new BlockFarmland()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("farmland");
-        registerBlock(60, "farmland", var6);
-        registerBlock(61, "furnace", (new BlockFurnace(false)).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("furnace").setCreativeTab(CreativeTabs.tabDecorations));
-        registerBlock(62, "lit_furnace", (new BlockFurnace(true)).setHardness(3.5F).setStepSound(soundTypePiston).setLightLevel(0.875F).setUnlocalizedName("furnace"));
-        registerBlock(63, "standing_sign", (new BlockStandingSign()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("sign").disableStats());
-        registerBlock(64, "wooden_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorOak").disableStats());
-        registerBlock(65, "ladder", (new BlockLadder()).setHardness(0.4F).setStepSound(soundTypeLadder).setUnlocalizedName("ladder"));
-        registerBlock(66, "rail", (new BlockRail()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("rail"));
-        registerBlock(67, "stone_stairs", (new BlockStairs(var0.getDefaultState())).setUnlocalizedName("stairsStone"));
-        registerBlock(68, "wall_sign", (new BlockWallSign()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("sign").disableStats());
-        registerBlock(69, "lever", (new BlockLever()).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("lever"));
-        registerBlock(70, "stone_pressure_plate", (new BlockPressurePlate(Material.rock, BlockPressurePlate.Sensitivity.MOBS)).setHardness(0.5F).setStepSound(soundTypePiston).setUnlocalizedName("pressurePlateStone"));
-        registerBlock(71, "iron_door", (new BlockDoor(Material.iron)).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("doorIron").disableStats());
-        registerBlock(72, "wooden_pressure_plate", (new BlockPressurePlate(Material.wood, BlockPressurePlate.Sensitivity.EVERYTHING)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("pressurePlateWood"));
-        registerBlock(73, "redstone_ore", (new BlockRedstoneOre(false)).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreRedstone").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(74, "lit_redstone_ore", (new BlockRedstoneOre(true)).setLightLevel(0.625F).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreRedstone"));
-        registerBlock(75, "unlit_redstone_torch", (new BlockRedstoneTorch(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("notGate"));
-        registerBlock(76, "redstone_torch", (new BlockRedstoneTorch(true)).setHardness(0.0F).setLightLevel(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("notGate").setCreativeTab(CreativeTabs.tabRedstone));
-        registerBlock(77, "stone_button", (new BlockButtonStone()).setHardness(0.5F).setStepSound(soundTypePiston).setUnlocalizedName("button"));
-        registerBlock(78, "snow_layer", (new BlockSnow()).setHardness(0.1F).setStepSound(soundTypeSnow).setUnlocalizedName("snow").setLightOpacity(0));
-        registerBlock(79, "ice", (new BlockIce()).setHardness(0.5F).setLightOpacity(3).setStepSound(soundTypeGlass).setUnlocalizedName("ice"));
-        registerBlock(80, "snow", (new BlockSnowBlock()).setHardness(0.2F).setStepSound(soundTypeSnow).setUnlocalizedName("snow"));
-        registerBlock(81, "cactus", (new BlockCactus()).setHardness(0.4F).setStepSound(soundTypeCloth).setUnlocalizedName("cactus"));
-        registerBlock(82, "clay", (new BlockClay()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("clay"));
-        registerBlock(83, "reeds", (new BlockReed()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("reeds").disableStats());
-        registerBlock(84, "jukebox", (new BlockJukebox()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("jukebox"));
-        registerBlock(85, "fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("fence"));
-        Block var7 = (new BlockPumpkin()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkin");
-        registerBlock(86, "pumpkin", var7);
-        registerBlock(87, "netherrack", (new BlockNetherrack()).setHardness(0.4F).setStepSound(soundTypePiston).setUnlocalizedName("hellrock"));
-        registerBlock(88, "soul_sand", (new BlockSoulSand()).setHardness(0.5F).setStepSound(soundTypeSand).setUnlocalizedName("hellsand"));
-        registerBlock(89, "glowstone", (new BlockGlowstone(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setLightLevel(1.0F).setUnlocalizedName("lightgem"));
-        registerBlock(90, "portal", (new BlockPortal()).setHardness(-1.0F).setStepSound(soundTypeGlass).setLightLevel(0.75F).setUnlocalizedName("portal"));
-        registerBlock(91, "lit_pumpkin", (new BlockPumpkin()).setHardness(1.0F).setStepSound(soundTypeWood).setLightLevel(1.0F).setUnlocalizedName("litpumpkin"));
-        registerBlock(92, "cake", (new BlockCake()).setHardness(0.5F).setStepSound(soundTypeCloth).setUnlocalizedName("cake").disableStats());
-        registerBlock(93, "unpowered_repeater", (new BlockRedstoneRepeater(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("diode").disableStats());
-        registerBlock(94, "powered_repeater", (new BlockRedstoneRepeater(true)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("diode").disableStats());
-        registerBlock(95, "stained_glass", (new BlockStainedGlass(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("stainedGlass"));
-        registerBlock(96, "trapdoor", (new BlockTrapDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("trapdoor").disableStats());
-        registerBlock(97, "monster_egg", (new BlockSilverfish()).setHardness(0.75F).setUnlocalizedName("monsterStoneEgg"));
-        Block var8 = (new BlockStoneBrick()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stonebricksmooth");
-        registerBlock(98, "stonebrick", var8);
-        registerBlock(99, "brown_mushroom_block", (new BlockHugeMushroom(Material.wood, var3)).setHardness(0.2F).setStepSound(soundTypeWood).setUnlocalizedName("mushroom"));
-        registerBlock(100, "red_mushroom_block", (new BlockHugeMushroom(Material.wood, var4)).setHardness(0.2F).setStepSound(soundTypeWood).setUnlocalizedName("mushroom"));
-        registerBlock(101, "iron_bars", (new BlockPane(Material.iron, true)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("fenceIron"));
-        registerBlock(102, "glass_pane", (new BlockPane(Material.glass, false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("thinGlass"));
-        Block var9 = (new BlockMelon()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("melon");
-        registerBlock(103, "melon_block", var9);
-        registerBlock(104, "pumpkin_stem", (new BlockStem(var7)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkinStem"));
-        registerBlock(105, "melon_stem", (new BlockStem(var9)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkinStem"));
-        registerBlock(106, "vine", (new BlockVine()).setHardness(0.2F).setStepSound(soundTypeGrass).setUnlocalizedName("vine"));
-        registerBlock(107, "fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("fenceGate"));
-        registerBlock(108, "brick_stairs", (new BlockStairs(var5.getDefaultState())).setUnlocalizedName("stairsBrick"));
-        registerBlock(109, "stone_brick_stairs", (new BlockStairs(var8.getDefaultState().withProperty(BlockStoneBrick.VARIANT_PROP, BlockStoneBrick.EnumType.DEFAULT))).setUnlocalizedName("stairsStoneBrickSmooth"));
-        registerBlock(110, "mycelium", (new BlockMycelium()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("mycel"));
-        registerBlock(111, "waterlily", (new BlockLilyPad()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("waterlily"));
-        Block var10 = (new BlockNetherBrick()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherBrick").setCreativeTab(CreativeTabs.tabBlock);
-        registerBlock(112, "nether_brick", var10);
-        registerBlock(113, "nether_brick_fence", (new BlockFence(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherFence"));
-        registerBlock(114, "nether_brick_stairs", (new BlockStairs(var10.getDefaultState())).setUnlocalizedName("stairsNetherBrick"));
-        registerBlock(115, "nether_wart", (new BlockNetherWart()).setUnlocalizedName("netherStalk"));
-        registerBlock(116, "enchanting_table", (new BlockEnchantmentTable()).setHardness(5.0F).setResistance(2000.0F).setUnlocalizedName("enchantmentTable"));
-        registerBlock(117, "brewing_stand", (new BlockBrewingStand()).setHardness(0.5F).setLightLevel(0.125F).setUnlocalizedName("brewingStand"));
-        registerBlock(118, "cauldron", (new BlockCauldron()).setHardness(2.0F).setUnlocalizedName("cauldron"));
-        registerBlock(119, "end_portal", (new BlockEndPortal(Material.portal)).setHardness(-1.0F).setResistance(6000000.0F));
-        registerBlock(120, "end_portal_frame", (new BlockEndPortalFrame()).setStepSound(soundTypeGlass).setLightLevel(0.125F).setHardness(-1.0F).setUnlocalizedName("endPortalFrame").setResistance(6000000.0F).setCreativeTab(CreativeTabs.tabDecorations));
-        registerBlock(121, "end_stone", (new Block(Material.rock)).setHardness(3.0F).setResistance(15.0F).setStepSound(soundTypePiston).setUnlocalizedName("whiteStone").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(122, "dragon_egg", (new BlockDragonEgg()).setHardness(3.0F).setResistance(15.0F).setStepSound(soundTypePiston).setLightLevel(0.125F).setUnlocalizedName("dragonEgg"));
-        registerBlock(123, "redstone_lamp", (new BlockRedstoneLight(false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("redstoneLight").setCreativeTab(CreativeTabs.tabRedstone));
-        registerBlock(124, "lit_redstone_lamp", (new BlockRedstoneLight(true)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("redstoneLight"));
-        registerBlock(125, "double_wooden_slab", (new BlockDoubleWoodSlab()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("woodSlab"));
-        registerBlock(126, "wooden_slab", (new BlockHalfWoodSlab()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("woodSlab"));
-        registerBlock(127, "cocoa", (new BlockCocoa()).setHardness(0.2F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("cocoa"));
-        registerBlock(128, "sandstone_stairs", (new BlockStairs(var2.getDefaultState().withProperty(BlockSandStone.field_176297_a, BlockSandStone.EnumType.SMOOTH))).setUnlocalizedName("stairsSandStone"));
-        registerBlock(129, "emerald_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreEmerald"));
-        registerBlock(130, "ender_chest", (new BlockEnderChest()).setHardness(22.5F).setResistance(1000.0F).setStepSound(soundTypePiston).setUnlocalizedName("enderChest").setLightLevel(0.5F));
-        registerBlock(131, "tripwire_hook", (new BlockTripWireHook()).setUnlocalizedName("tripWireSource"));
-        registerBlock(132, "tripwire", (new BlockTripWire()).setUnlocalizedName("tripWire"));
-        registerBlock(133, "emerald_block", (new BlockCompressed(MapColor.emeraldColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockEmerald"));
-        registerBlock(134, "spruce_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.SPRUCE))).setUnlocalizedName("stairsWoodSpruce"));
-        registerBlock(135, "birch_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.BIRCH))).setUnlocalizedName("stairsWoodBirch"));
-        registerBlock(136, "jungle_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.JUNGLE))).setUnlocalizedName("stairsWoodJungle"));
-        registerBlock(137, "command_block", (new BlockCommandBlock()).setBlockUnbreakable().setResistance(6000000.0F).setUnlocalizedName("commandBlock"));
-        registerBlock(138, "beacon", (new BlockBeacon()).setUnlocalizedName("beacon").setLightLevel(1.0F));
-        registerBlock(139, "cobblestone_wall", (new BlockWall(var0)).setUnlocalizedName("cobbleWall"));
-        registerBlock(140, "flower_pot", (new BlockFlowerPot()).setHardness(0.0F).setStepSound(soundTypeStone).setUnlocalizedName("flowerPot"));
-        registerBlock(141, "carrots", (new BlockCarrot()).setUnlocalizedName("carrots"));
-        registerBlock(142, "potatoes", (new BlockPotato()).setUnlocalizedName("potatoes"));
-        registerBlock(143, "wooden_button", (new BlockButtonWood()).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("button"));
-        registerBlock(144, "skull", (new BlockSkull()).setHardness(1.0F).setStepSound(soundTypePiston).setUnlocalizedName("skull"));
-        registerBlock(145, "anvil", (new BlockAnvil()).setHardness(5.0F).setStepSound(soundTypeAnvil).setResistance(2000.0F).setUnlocalizedName("anvil"));
-        registerBlock(146, "trapped_chest", (new BlockChest(1)).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("chestTrap"));
-        registerBlock(147, "light_weighted_pressure_plate", (new BlockPressurePlateWeighted("gold_block", Material.iron, 15)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("weightedPlate_light"));
-        registerBlock(148, "heavy_weighted_pressure_plate", (new BlockPressurePlateWeighted("iron_block", Material.iron, 150)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("weightedPlate_heavy"));
-        registerBlock(149, "unpowered_comparator", (new BlockRedstoneComparator(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("comparator").disableStats());
-        registerBlock(150, "powered_comparator", (new BlockRedstoneComparator(true)).setHardness(0.0F).setLightLevel(0.625F).setStepSound(soundTypeWood).setUnlocalizedName("comparator").disableStats());
-        registerBlock(151, "daylight_detector", new BlockDaylightDetector(false));
-        registerBlock(152, "redstone_block", (new BlockCompressedPowered(MapColor.tntColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockRedstone"));
-        registerBlock(153, "quartz_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherquartz"));
-        registerBlock(154, "hopper", (new BlockHopper()).setHardness(3.0F).setResistance(8.0F).setStepSound(soundTypeMetal).setUnlocalizedName("hopper"));
-        Block var11 = (new BlockQuartz()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("quartzBlock");
-        registerBlock(155, "quartz_block", var11);
-        registerBlock(156, "quartz_stairs", (new BlockStairs(var11.getDefaultState().withProperty(BlockQuartz.VARIANT_PROP, BlockQuartz.EnumType.DEFAULT))).setUnlocalizedName("stairsQuartz"));
-        registerBlock(157, "activator_rail", (new BlockRailPowered()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("activatorRail"));
-        registerBlock(158, "dropper", (new BlockDropper()).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("dropper"));
-        registerBlock(159, "stained_hardened_clay", (new BlockColored(Material.rock)).setHardness(1.25F).setResistance(7.0F).setStepSound(soundTypePiston).setUnlocalizedName("clayHardenedStained"));
-        registerBlock(160, "stained_glass_pane", (new BlockStainedGlassPane()).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("thinStainedGlass"));
-        registerBlock(161, "leaves2", (new BlockNewLeaf()).setUnlocalizedName("leaves"));
-        registerBlock(162, "log2", (new BlockNewLog()).setUnlocalizedName("log"));
-        registerBlock(163, "acacia_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.ACACIA))).setUnlocalizedName("stairsWoodAcacia"));
-        registerBlock(164, "dark_oak_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.DARK_OAK))).setUnlocalizedName("stairsWoodDarkOak"));
-        registerBlock(165, "slime", (new BlockSlime()).setUnlocalizedName("slime").setStepSound(SLIME_SOUND));
-        registerBlock(166, "barrier", (new BlockBarrier()).setUnlocalizedName("barrier"));
-        registerBlock(167, "iron_trapdoor", (new BlockTrapDoor(Material.iron)).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("ironTrapdoor").disableStats());
-        registerBlock(168, "prismarine", (new BlockPrismarine()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("prismarine"));
-        registerBlock(169, "sea_lantern", (new BlockSeaLantern(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setLightLevel(1.0F).setUnlocalizedName("seaLantern"));
-        registerBlock(170, "hay_block", (new BlockHay()).setHardness(0.5F).setStepSound(soundTypeGrass).setUnlocalizedName("hayBlock").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(171, "carpet", (new BlockCarpet()).setHardness(0.1F).setStepSound(soundTypeCloth).setUnlocalizedName("woolCarpet").setLightOpacity(0));
-        registerBlock(172, "hardened_clay", (new BlockHardenedClay()).setHardness(1.25F).setResistance(7.0F).setStepSound(soundTypePiston).setUnlocalizedName("clayHardened"));
-        registerBlock(173, "coal_block", (new Block(Material.rock)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("blockCoal").setCreativeTab(CreativeTabs.tabBlock));
-        registerBlock(174, "packed_ice", (new BlockPackedIce()).setHardness(0.5F).setStepSound(soundTypeGlass).setUnlocalizedName("icePacked"));
-        registerBlock(175, "double_plant", new BlockDoublePlant());
-        registerBlock(176, "standing_banner", (new BlockBanner.BlockBannerStanding()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("banner").disableStats());
-        registerBlock(177, "wall_banner", (new BlockBanner.BlockBannerHanging()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("banner").disableStats());
-        registerBlock(178, "daylight_detector_inverted", new BlockDaylightDetector(true));
-        Block var12 = (new BlockRedSandstone()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("redSandStone");
-        registerBlock(179, "red_sandstone", var12);
-        registerBlock(180, "red_sandstone_stairs", (new BlockStairs(var12.getDefaultState().withProperty(BlockRedSandstone.TYPE, BlockRedSandstone.EnumType.SMOOTH))).setUnlocalizedName("stairsRedSandStone"));
-        registerBlock(181, "double_stone_slab2", (new BlockDoubleStoneSlabNew()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab2"));
-        registerBlock(182, "stone_slab2", (new BlockHalfStoneSlabNew()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab2"));
-        registerBlock(183, "spruce_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("spruceFenceGate"));
-        registerBlock(184, "birch_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("birchFenceGate"));
-        registerBlock(185, "jungle_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("jungleFenceGate"));
-        registerBlock(186, "dark_oak_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("darkOakFenceGate"));
-        registerBlock(187, "acacia_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("acaciaFenceGate"));
-        registerBlock(188, "spruce_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("spruceFence"));
-        registerBlock(189, "birch_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("birchFence"));
-        registerBlock(190, "jungle_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("jungleFence"));
-        registerBlock(191, "dark_oak_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("darkOakFence"));
-        registerBlock(192, "acacia_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("acaciaFence"));
-        registerBlock(193, "spruce_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorSpruce").disableStats());
-        registerBlock(194, "birch_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorBirch").disableStats());
-        registerBlock(195, "jungle_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorJungle").disableStats());
-        registerBlock(196, "acacia_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorAcacia").disableStats());
-        registerBlock(197, "dark_oak_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorDarkOak").disableStats());
-        blockRegistry.validateKey();
-        Iterator var13 = blockRegistry.iterator();
-        Block var14;
-
-        while (var13.hasNext())
-        {
-            var14 = (Block)var13.next();
-
-            if (var14.blockMaterial == Material.air)
-            {
-                var14.useNeighborBrightness = false;
-            }
-            else
-            {
-                boolean var15 = false;
-                boolean var16 = var14 instanceof BlockStairs;
-                boolean var17 = var14 instanceof BlockSlab;
-                boolean var18 = var14 == var6;
-                boolean var19 = var14.translucent;
-                boolean var20 = var14.lightOpacity == 0;
-
-                if (var16 || var17 || var18 || var19 || var20)
-                {
-                    var15 = true;
-                }
-
-                var14.useNeighborBrightness = var15;
-            }
-        }
-
-        var13 = blockRegistry.iterator();
-
-        while (var13.hasNext())
-        {
-            var14 = (Block)var13.next();
-            Iterator var21 = var14.getBlockState().getValidStates().iterator();
-
-            while (var21.hasNext())
-            {
-                IBlockState var22 = (IBlockState)var21.next();
-                int var23 = blockRegistry.getIDForObject(var14) << 4 | var14.getMetaFromState(var22);
-                BLOCK_STATE_IDS.put(var22, var23);
-            }
-        }
-    }
-
-    private static void registerBlock(int id, ResourceLocation textualID, Block block_)
-    {
-        blockRegistry.register(id, textualID, block_);
-    }
-
-    private static void registerBlock(int id, String textualID, Block block_)
-    {
-        registerBlock(id, new ResourceLocation(textualID), block_);
-    }
-
-    public static enum EnumOffsetType
-    {
-        NONE("NONE", 0),
-        XZ("XZ", 1),
-        XYZ("XYZ", 2);
-
-        private static final Block.EnumOffsetType[] $VALUES = new Block.EnumOffsetType[]{NONE, XZ, XYZ};
-        private static final String __OBFID = "CL_00002132";
-
-        private EnumOffsetType(String p_i45733_1_, int p_i45733_2_) {}
-    }
-
-    public static class SoundType
-    {
-        public final String soundName;
-        public final float volume;
-        public final float frequency;
-        private static final String __OBFID = "CL_00000203";
-
-        public SoundType(String name, float volume, float frequency)
-        {
-            this.soundName = name;
-            this.volume = volume;
-            this.frequency = frequency;
-        }
-
-        public float getVolume()
-        {
-            return this.volume;
-        }
-
-        public float getFrequency()
-        {
-            return this.frequency;
-        }
-
-        public String getBreakSound()
-        {
-            return "dig." + this.soundName;
-        }
-
-        public String getStepSound()
-        {
-            return "step." + this.soundName;
-        }
-
-        public String getPlaceSound()
-        {
-            return this.getBreakSound();
-        }
-    }
-}
+package net.minecraft.block;
+
+import java.util.Iterator;
+import java.util.List;
+import java.util.Random;
+
+import net.minecraft.block.material.MapColor;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.properties.IProperty;
+import net.minecraft.block.state.BlockState;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.creativetab.CreativeTabs;
+import net.minecraft.enchantment.EnchantmentHelper;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.item.EntityItem;
+import net.minecraft.entity.item.EntityXPOrb;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemBlock;
+import net.minecraft.item.ItemStack;
+import net.minecraft.stats.StatList;
+import net.minecraft.tileentity.TileEntity;
+import net.minecraft.util.*;
+import net.minecraft.world.Explosion;
+import net.minecraft.world.IBlockAccess;
+import net.minecraft.world.World;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.FreecamMod;
+import tk.wurst_client.mods.XRayMod;
+import tk.wurst_client.utils.XRayUtils;
+
+public class Block
+{
+    /** ResourceLocation for the Air block */
+    private static final ResourceLocation AIR_ID = new ResourceLocation("air");
+    public static final RegistryNamespacedDefaultedByKey blockRegistry = new RegistryNamespacedDefaultedByKey(AIR_ID);
+    public static final ObjectIntIdentityMap BLOCK_STATE_IDS = new ObjectIntIdentityMap();
+    private CreativeTabs displayOnCreativeTab;
+    public static final Block.SoundType soundTypeStone = new Block.SoundType("stone", 1.0F, 1.0F);
+
+    /** the wood sound type */
+    public static final Block.SoundType soundTypeWood = new Block.SoundType("wood", 1.0F, 1.0F);
+
+    /** the gravel sound type */
+    public static final Block.SoundType soundTypeGravel = new Block.SoundType("gravel", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypeGrass = new Block.SoundType("grass", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypePiston = new Block.SoundType("stone", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypeMetal = new Block.SoundType("stone", 1.0F, 1.5F);
+    public static final Block.SoundType soundTypeGlass = new Block.SoundType("stone", 1.0F, 1.0F)
+    {
+        private static final String __OBFID = "CL_00000200";
+        public String getBreakSound()
+        {
+            return "dig.glass";
+        }
+        public String getPlaceSound()
+        {
+            return "step.stone";
+        }
+    };
+    public static final Block.SoundType soundTypeCloth = new Block.SoundType("cloth", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypeSand = new Block.SoundType("sand", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypeSnow = new Block.SoundType("snow", 1.0F, 1.0F);
+    public static final Block.SoundType soundTypeLadder = new Block.SoundType("ladder", 1.0F, 1.0F)
+    {
+        private static final String __OBFID = "CL_00000201";
+        public String getBreakSound()
+        {
+            return "dig.wood";
+        }
+    };
+    public static final Block.SoundType soundTypeAnvil = new Block.SoundType("anvil", 0.3F, 1.0F)
+    {
+        private static final String __OBFID = "CL_00000202";
+        public String getBreakSound()
+        {
+            return "dig.stone";
+        }
+        public String getPlaceSound()
+        {
+            return "random.anvil_land";
+        }
+    };
+    public static final Block.SoundType SLIME_SOUND = new Block.SoundType("slime", 1.0F, 1.0F)
+    {
+        private static final String __OBFID = "CL_00002133";
+        public String getBreakSound()
+        {
+            return "mob.slime.big";
+        }
+        public String getPlaceSound()
+        {
+            return "mob.slime.big";
+        }
+        public String getStepSound()
+        {
+            return "mob.slime.small";
+        }
+    };
+    protected boolean fullBlock;
+
+    /** How much light is subtracted for going through this block */
+    protected int lightOpacity;
+    protected boolean translucent;
+
+    /** Amount of light emitted */
+    protected int lightValue;
+
+    /**
+     * Flag if block should use the brightest neighbor light value as its own
+     */
+    protected boolean useNeighborBrightness;
+
+    /** Indicates how many hits it takes to break a block. */
+    protected float blockHardness;
+    protected float blockResistance;
+    protected boolean enableStats = true;
+
+    /**
+     * Flags whether or not this block is of a type that needs random ticking. Ref-counted by ExtendedBlockStorage in
+     * order to broadly cull a chunk from the random chunk update list for efficiency's sake.
+     */
+    protected boolean needsRandomTick;
+
+    /** true if the Block contains a Tile Entity */
+    protected boolean isBlockContainer;
+    protected double minX;
+    protected double minY;
+    protected double minZ;
+    protected double maxX;
+    protected double maxY;
+    protected double maxZ;
+
+    /** Sound of stepping on the block */
+    public Block.SoundType stepSound;
+    public float blockParticleGravity;
+    protected final Material blockMaterial;
+
+    /**
+     * Determines how much velocity is maintained while moving on top of this block
+     */
+    public float slipperiness;
+    protected final BlockState blockState;
+    private IBlockState defaultBlockState;
+    private String unlocalizedName;
+    //TODO: Client
+    private XRayMod xray;
+    private static final String __OBFID = "CL_00000199";
+
+    public static int getIdFromBlock(Block blockIn)
+    {
+        return blockRegistry.getIDForObject(blockIn);
+    }
+
+    /**
+     * Get a unique ID for the given BlockState, containing both BlockID and metadata
+     */
+    public static int getStateId(IBlockState state)
+    {
+        return getIdFromBlock(state.getBlock()) + (state.getBlock().getMetaFromState(state) << 12);
+    }
+
+    public static Block getBlockById(int id)
+    {
+        return (Block)blockRegistry.getObjectById(id);
+    }
+
+    /**
+     * Get a BlockState by it's ID (see getStateId)
+     */
+    public static IBlockState getStateById(int id)
+    {
+        int var1 = id & 4095;
+        int var2 = id >> 12 & 15;
+        return getBlockById(var1).getStateFromMeta(var2);
+    }
+
+    public static Block getBlockFromItem(Item itemIn)
+    {
+        return itemIn instanceof ItemBlock ? ((ItemBlock)itemIn).getBlock() : null;
+    }
+
+    public static Block getBlockFromName(String name)
+    {
+        ResourceLocation var1 = new ResourceLocation(name);
+
+        if (blockRegistry.containsKey(var1))
+        {
+            return (Block)blockRegistry.getObject(var1);
+        }
+        else
+        {
+            try
+            {
+                return (Block)blockRegistry.getObjectById(Integer.parseInt(name));
+            }
+            catch (NumberFormatException var3)
+            {
+                return null;
+            }
+        }
+    }
+
+    public boolean isFullBlock()
+    {
+        return this.fullBlock;
+    }
+
+    public int getLightOpacity()
+    {
+        return this.lightOpacity;
+    }
+
+    public boolean isTranslucent()
+    {
+        return this.translucent;
+    }
+
+    public int getLightValue()
+    {
+        return this.lightValue;
+    }
+
+    /**
+     * Should block use the brightest neighbor light value as its own
+     */
+    public boolean getUseNeighborBrightness()
+    {
+        return this.useNeighborBrightness;
+    }
+
+    /**
+     * Get a material of block
+     */
+    public Material getMaterial()
+    {
+        return this.blockMaterial;
+    }
+
+    /**
+     * Get the MapColor for this Block and the given BlockState
+     */
+    public MapColor getMapColor(IBlockState state)
+    {
+        return this.getMaterial().getMaterialMapColor();
+    }
+
+    /**
+     * Convert the given metadata into a BlockState for this Block
+     */
+    public IBlockState getStateFromMeta(int meta)
+    {
+        return this.getDefaultState();
+    }
+
+    /**
+     * Convert the BlockState into the correct metadata value
+     */
+    public int getMetaFromState(IBlockState state)
+    {
+        if (state != null && !state.getPropertyNames().isEmpty())
+        {
+            throw new IllegalArgumentException("Don\'t know how to convert " + state + " back into data...");
+        }
+        else
+        {
+            return 0;
+        }
+    }
+
+    /**
+     * Get the actual Block state of this Block at the given position. This applies properties not visible in the
+     * metadata, such as fence connections.
+     */
+    public IBlockState getActualState(IBlockState state, IBlockAccess worldIn, BlockPos pos)
+    {
+        return state;
+    }
+
+    protected Block(Material materialIn)
+    {
+        this.stepSound = soundTypeStone;
+        this.blockParticleGravity = 1.0F;
+        this.slipperiness = 0.6F;
+        this.blockMaterial = materialIn;
+        this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
+        this.fullBlock = this.isOpaqueCube();
+        this.lightOpacity = this.isOpaqueCube() ? 255 : 0;
+        this.translucent = !materialIn.blocksLight();
+        this.blockState = this.createBlockState();
+        this.setDefaultState(this.blockState.getBaseState());
+    }
+
+    /**
+     * Sets the footstep sound for the block. Returns the object for convenience in constructing.
+     */
+    protected Block setStepSound(Block.SoundType sound)
+    {
+        this.stepSound = sound;
+        return this;
+    }
+
+    /**
+     * Sets how much light is blocked going through this block. Returns the object for convenience in constructing.
+     */
+    protected Block setLightOpacity(int opacity)
+    {
+        this.lightOpacity = opacity;
+        return this;
+    }
+
+    /**
+     * Sets the light value that the block emits. Returns resulting block instance for constructing convenience. Args:
+     * level
+     */
+    protected Block setLightLevel(float value)
+    {
+        this.lightValue = (int)(15.0F * value);
+        return this;
+    }
+
+    /**
+     * Sets the the blocks resistance to explosions. Returns the object for convenience in constructing.
+     */
+    protected Block setResistance(float resistance)
+    {
+        this.blockResistance = resistance * 3.0F;
+        return this;
+    }
+
+    /**
+     * Indicate if a material is a normal solid opaque cube
+     */
+    public boolean isSolidFullCube()
+    {
+        return this.blockMaterial.blocksMovement() && this.isFullCube();
+    }
+
+    public boolean isNormalCube()
+    {
+        return this.blockMaterial.isOpaque() && this.isFullCube() && !this.canProvidePower();
+    }
+
+    public boolean isVisuallyOpaque()
+    {
+        return this.blockMaterial.blocksMovement() && this.isFullCube();
+    }
+
+    public boolean isFullCube()
+    {
+    	//TODO: Client
+        return !WurstClient.INSTANCE.modManager.getModByClass(XRayMod.class).isEnabled() && !WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled();
+    }
+
+    public boolean isPassable(IBlockAccess blockAccess, BlockPos pos)
+    {
+        return !this.blockMaterial.blocksMovement();
+    }
+
+    /**
+     * The type of render function that is called for this block
+     */
+    public int getRenderType()
+    {
+        return 3;
+    }
+
+    /**
+     * Whether this Block can be replaced directly by other blocks (true for e.g. tall grass)
+     */
+    public boolean isReplaceable(World worldIn, BlockPos pos)
+    {
+        return false;
+    }
+
+    /**
+     * Sets how many hits it takes to break a block.
+     */
+    protected Block setHardness(float hardness)
+    {
+        this.blockHardness = hardness;
+
+        if (this.blockResistance < hardness * 5.0F)
+        {
+            this.blockResistance = hardness * 5.0F;
+        }
+
+        return this;
+    }
+
+    protected Block setBlockUnbreakable()
+    {
+        this.setHardness(-1.0F);
+        return this;
+    }
+
+    public float getBlockHardness(World worldIn, BlockPos pos)
+    {
+        return this.blockHardness;
+    }
+
+    /**
+     * Sets whether this block type will receive random update ticks
+     */
+    protected Block setTickRandomly(boolean shouldTick)
+    {
+        this.needsRandomTick = shouldTick;
+        return this;
+    }
+
+    /**
+     * Returns whether or not this block is of a type that needs random ticking. Called for ref-counting purposes by
+     * ExtendedBlockStorage in order to broadly cull a chunk from the random chunk update list for efficiency's sake.
+     */
+    public boolean getTickRandomly()
+    {
+        return this.needsRandomTick;
+    }
+
+    public boolean hasTileEntity()
+    {
+        return this.isBlockContainer;
+    }
+
+    protected final void setBlockBounds(float minX, float minY, float minZ, float maxX, float maxY, float maxZ)
+    {
+        this.minX = (double)minX;
+        this.minY = (double)minY;
+        this.minZ = (double)minZ;
+        this.maxX = (double)maxX;
+        this.maxY = (double)maxY;
+        this.maxZ = (double)maxZ;
+    }
+
+    public int getMixedBrightnessForBlock(IBlockAccess worldIn, BlockPos pos)
+    {
+        Block var3 = worldIn.getBlockState(pos).getBlock();
+        int var4 = worldIn.getCombinedLight(pos, var3.getLightValue());
+
+        if (var4 == 0 && var3 instanceof BlockSlab)
+        {
+            pos = pos.offsetDown();
+            var3 = worldIn.getBlockState(pos).getBlock();
+            return worldIn.getCombinedLight(pos, var3.getLightValue());
+        }
+        else
+        {
+            return var4;
+        }
+    }
+
+    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
+    {
+    	//TODO: Client
+    	if(xray == null)
+			xray = (XRayMod)WurstClient.INSTANCE.modManager.getModByClass(XRayMod.class);
+    	if(xray.isEnabled())
+    	{
+    		if(XRayUtils.isXRayBlock(this))
+    			return true;
+    		else
+    			return false;
+    	}
+        return side == EnumFacing.DOWN && this.minY > 0.0D ? true : (side == EnumFacing.UP && this.maxY < 1.0D ? true : (side == EnumFacing.NORTH && this.minZ > 0.0D ? true : (side == EnumFacing.SOUTH && this.maxZ < 1.0D ? true : (side == EnumFacing.WEST && this.minX > 0.0D ? true : (side == EnumFacing.EAST && this.maxX < 1.0D ? true : !worldIn.getBlockState(pos).getBlock().isOpaqueCube())))));
+    }
+
+    /**
+     * Whether this Block is solid on the given Side
+     */
+    public boolean isBlockSolid(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
+    {
+        return worldIn.getBlockState(pos).getBlock().getMaterial().isSolid();
+    }
+
+    public AxisAlignedBB getSelectedBoundingBox(World worldIn, BlockPos pos)
+    {
+        return new AxisAlignedBB((double)pos.getX() + this.minX, (double)pos.getY() + this.minY, (double)pos.getZ() + this.minZ, (double)pos.getX() + this.maxX, (double)pos.getY() + this.maxY, (double)pos.getZ() + this.maxZ);
+    }
+
+    /**
+     * Add all collision boxes of this Block to the list that intersect with the given mask.
+     *  
+     * @param collidingEntity the Entity colliding with this Block
+     */
+    public void addCollisionBoxesToList(World worldIn, BlockPos pos, IBlockState state, AxisAlignedBB mask, List list, Entity collidingEntity)
+    {
+        AxisAlignedBB var7 = this.getCollisionBoundingBox(worldIn, pos, state);
+
+        if (var7 != null && mask.intersectsWith(var7))
+        {
+            list.add(var7);
+        }
+    }
+
+    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
+    {
+        return new AxisAlignedBB((double)pos.getX() + this.minX, (double)pos.getY() + this.minY, (double)pos.getZ() + this.minZ, (double)pos.getX() + this.maxX, (double)pos.getY() + this.maxY, (double)pos.getZ() + this.maxZ);
+    }
+
+    public boolean isOpaqueCube()
+    {
+        return true;
+    }
+
+    public boolean canCollideCheck(IBlockState state, boolean p_176209_2_)
+    {
+        return this.isCollidable();
+    }
+
+    /**
+     * Returns if this block is collidable (only used by Fire). Args: x, y, z
+     */
+    public boolean isCollidable()
+    {
+        return true;
+    }
+
+    /**
+     * Called randomly when setTickRandomly is set to true (used by e.g. crops to grow, etc.)
+     */
+    public void randomTick(World worldIn, BlockPos pos, IBlockState state, Random random)
+    {
+        this.updateTick(worldIn, pos, state, random);
+    }
+
+    public void updateTick(World worldIn, BlockPos pos, IBlockState state, Random rand) {}
+
+    public void randomDisplayTick(World worldIn, BlockPos pos, IBlockState state, Random rand) {}
+
+    /**
+     * Called when a player destroys this Block
+     */
+    public void onBlockDestroyedByPlayer(World worldIn, BlockPos pos, IBlockState state) {}
+
+    public void onNeighborBlockChange(World worldIn, BlockPos pos, IBlockState state, Block neighborBlock) {}
+
+    /**
+     * How many world ticks before ticking
+     */
+    public int tickRate(World worldIn)
+    {
+        return 10;
+    }
+
+    public void onBlockAdded(World worldIn, BlockPos pos, IBlockState state) {}
+
+    public void breakBlock(World worldIn, BlockPos pos, IBlockState state) {}
+
+    /**
+     * Returns the quantity of items to drop on block destruction.
+     */
+    public int quantityDropped(Random random)
+    {
+        return 1;
+    }
+
+    /**
+     * Get the Item that this Block should drop when harvested.
+     *  
+     * @param fortune the level of the Fortune enchantment on the player's tool
+     */
+    public Item getItemDropped(IBlockState state, Random rand, int fortune)
+    {
+        return Item.getItemFromBlock(this);
+    }
+
+    /**
+     * Get the hardness of this Block relative to the ability of the given player
+     */
+    public float getPlayerRelativeBlockHardness(EntityPlayer playerIn, World worldIn, BlockPos pos)
+    {
+        float var4 = this.getBlockHardness(worldIn, pos);
+        return var4 < 0.0F ? 0.0F : (!playerIn.canHarvestBlock(this) ? playerIn.func_180471_a(this) / var4 / 100.0F : playerIn.func_180471_a(this) / var4 / 30.0F);
+    }
+
+    /**
+     * Spawn this Block's drops into the World as EntityItems
+     *  
+     * @param forture the level of the Fortune enchantment on the player's tool
+     */
+    public final void dropBlockAsItem(World worldIn, BlockPos pos, IBlockState state, int forture)
+    {
+        this.dropBlockAsItemWithChance(worldIn, pos, state, 1.0F, forture);
+    }
+
+    /**
+     * Spawns this Block's drops into the World as EntityItems.
+     *  
+     * @param chance The chance that each Item is actually spawned (1.0 = always, 0.0 = never)
+     * @param fortune The player's fortune level
+     */
+    public void dropBlockAsItemWithChance(World worldIn, BlockPos pos, IBlockState state, float chance, int fortune)
+    {
+        if (!worldIn.isRemote)
+        {
+            int var6 = this.quantityDroppedWithBonus(fortune, worldIn.rand);
+
+            for (int var7 = 0; var7 < var6; ++var7)
+            {
+                if (worldIn.rand.nextFloat() <= chance)
+                {
+                    Item var8 = this.getItemDropped(state, worldIn.rand, fortune);
+
+                    if (var8 != null)
+                    {
+                        spawnAsEntity(worldIn, pos, new ItemStack(var8, 1, this.damageDropped(state)));
+                    }
+                }
+            }
+        }
+    }
+
+    /**
+     * Spawns the given ItemStack as an EntityItem into the World at the given position
+     */
+    public static void spawnAsEntity(World worldIn, BlockPos pos, ItemStack stack)
+    {
+        if (!worldIn.isRemote && worldIn.getGameRules().getGameRuleBooleanValue("doTileDrops"))
+        {
+            float var3 = 0.5F;
+            double var4 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
+            double var6 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
+            double var8 = (double)(worldIn.rand.nextFloat() * var3) + (double)(1.0F - var3) * 0.5D;
+            EntityItem var10 = new EntityItem(worldIn, (double)pos.getX() + var4, (double)pos.getY() + var6, (double)pos.getZ() + var8, stack);
+            var10.setDefaultPickupDelay();
+            worldIn.spawnEntityInWorld(var10);
+        }
+    }
+
+    /**
+     * Spawns the given amount of experience into the World as XP orb entities
+     *  
+     * @param amount The amount of XP to spawn
+     */
+    protected void dropXpOnBlockBreak(World worldIn, BlockPos pos, int amount)
+    {
+        if (!worldIn.isRemote)
+        {
+            while (amount > 0)
+            {
+                int var4 = EntityXPOrb.getXPSplit(amount);
+                amount -= var4;
+                worldIn.spawnEntityInWorld(new EntityXPOrb(worldIn, (double)pos.getX() + 0.5D, (double)pos.getY() + 0.5D, (double)pos.getZ() + 0.5D, var4));
+            }
+        }
+    }
+
+    /**
+     * Get the damage value that this Block should drop
+     */
+    public int damageDropped(IBlockState state)
+    {
+        return 0;
+    }
+
+    /**
+     * Returns how much this block can resist explosions from the passed in entity.
+     */
+    public float getExplosionResistance(Entity exploder)
+    {
+        return this.blockResistance / 5.0F;
+    }
+
+    /**
+     * Ray traces through the blocks collision from start vector to end vector returning a ray trace hit.
+     *  
+     * @param start The start vector
+     * @param end The end vector
+     */
+    public MovingObjectPosition collisionRayTrace(World worldIn, BlockPos pos, Vec3 start, Vec3 end)
+    {
+        this.setBlockBoundsBasedOnState(worldIn, pos);
+        start = start.addVector((double)(-pos.getX()), (double)(-pos.getY()), (double)(-pos.getZ()));
+        end = end.addVector((double)(-pos.getX()), (double)(-pos.getY()), (double)(-pos.getZ()));
+        Vec3 var5 = start.getIntermediateWithXValue(end, this.minX);
+        Vec3 var6 = start.getIntermediateWithXValue(end, this.maxX);
+        Vec3 var7 = start.getIntermediateWithYValue(end, this.minY);
+        Vec3 var8 = start.getIntermediateWithYValue(end, this.maxY);
+        Vec3 var9 = start.getIntermediateWithZValue(end, this.minZ);
+        Vec3 var10 = start.getIntermediateWithZValue(end, this.maxZ);
+
+        if (!this.isVecInsideYZBounds(var5))
+        {
+            var5 = null;
+        }
+
+        if (!this.isVecInsideYZBounds(var6))
+        {
+            var6 = null;
+        }
+
+        if (!this.isVecInsideXZBounds(var7))
+        {
+            var7 = null;
+        }
+
+        if (!this.isVecInsideXZBounds(var8))
+        {
+            var8 = null;
+        }
+
+        if (!this.isVecInsideXYBounds(var9))
+        {
+            var9 = null;
+        }
+
+        if (!this.isVecInsideXYBounds(var10))
+        {
+            var10 = null;
+        }
+
+        Vec3 var11 = null;
+
+        if (var5 != null && (var11 == null || start.squareDistanceTo(var5) < start.squareDistanceTo(var11)))
+        {
+            var11 = var5;
+        }
+
+        if (var6 != null && (var11 == null || start.squareDistanceTo(var6) < start.squareDistanceTo(var11)))
+        {
+            var11 = var6;
+        }
+
+        if (var7 != null && (var11 == null || start.squareDistanceTo(var7) < start.squareDistanceTo(var11)))
+        {
+            var11 = var7;
+        }
+
+        if (var8 != null && (var11 == null || start.squareDistanceTo(var8) < start.squareDistanceTo(var11)))
+        {
+            var11 = var8;
+        }
+
+        if (var9 != null && (var11 == null || start.squareDistanceTo(var9) < start.squareDistanceTo(var11)))
+        {
+            var11 = var9;
+        }
+
+        if (var10 != null && (var11 == null || start.squareDistanceTo(var10) < start.squareDistanceTo(var11)))
+        {
+            var11 = var10;
+        }
+
+        if (var11 == null)
+        {
+            return null;
+        }
+        else
+        {
+            EnumFacing var12 = null;
+
+            if (var11 == var5)
+            {
+                var12 = EnumFacing.WEST;
+            }
+
+            if (var11 == var6)
+            {
+                var12 = EnumFacing.EAST;
+            }
+
+            if (var11 == var7)
+            {
+                var12 = EnumFacing.DOWN;
+            }
+
+            if (var11 == var8)
+            {
+                var12 = EnumFacing.UP;
+            }
+
+            if (var11 == var9)
+            {
+                var12 = EnumFacing.NORTH;
+            }
+
+            if (var11 == var10)
+            {
+                var12 = EnumFacing.SOUTH;
+            }
+
+            return new MovingObjectPosition(var11.addVector((double)pos.getX(), (double)pos.getY(), (double)pos.getZ()), var12, pos);
+        }
+    }
+
+    /**
+     * Checks if a vector is within the Y and Z bounds of the block.
+     */
+    private boolean isVecInsideYZBounds(Vec3 point)
+    {
+        return point == null ? false : point.yCoord >= this.minY && point.yCoord <= this.maxY && point.zCoord >= this.minZ && point.zCoord <= this.maxZ;
+    }
+
+    /**
+     * Checks if a vector is within the X and Z bounds of the block.
+     */
+    private boolean isVecInsideXZBounds(Vec3 point)
+    {
+        return point == null ? false : point.xCoord >= this.minX && point.xCoord <= this.maxX && point.zCoord >= this.minZ && point.zCoord <= this.maxZ;
+    }
+
+    /**
+     * Checks if a vector is within the X and Y bounds of the block.
+     */
+    private boolean isVecInsideXYBounds(Vec3 point)
+    {
+        return point == null ? false : point.xCoord >= this.minX && point.xCoord <= this.maxX && point.yCoord >= this.minY && point.yCoord <= this.maxY;
+    }
+
+    /**
+     * Called when this Block is destroyed by an Explosion
+     */
+    public void onBlockDestroyedByExplosion(World worldIn, BlockPos pos, Explosion explosionIn) {}
+
+    public EnumWorldBlockLayer getBlockLayer()
+    {
+        return EnumWorldBlockLayer.SOLID;
+    }
+
+    public boolean canReplace(World worldIn, BlockPos pos, EnumFacing side, ItemStack stack)
+    {
+        return this.canPlaceBlockOnSide(worldIn, pos, side);
+    }
+
+    /**
+     * Check whether this Block can be placed on the given side
+     */
+    public boolean canPlaceBlockOnSide(World worldIn, BlockPos pos, EnumFacing side)
+    {
+        return this.canPlaceBlockAt(worldIn, pos);
+    }
+
+    public boolean canPlaceBlockAt(World worldIn, BlockPos pos)
+    {
+        return worldIn.getBlockState(pos).getBlock().blockMaterial.isReplaceable();
+    }
+
+    public boolean onBlockActivated(World worldIn, BlockPos pos, IBlockState state, EntityPlayer playerIn, EnumFacing side, float hitX, float hitY, float hitZ)
+    {
+        return false;
+    }
+
+    /**
+     * Triggered whenever an entity collides with this block (enters into the block)
+     */
+    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, Entity entityIn) {}
+
+    public IBlockState onBlockPlaced(World worldIn, BlockPos pos, EnumFacing facing, float hitX, float hitY, float hitZ, int meta, EntityLivingBase placer)
+    {
+        return this.getStateFromMeta(meta);
+    }
+
+    public void onBlockClicked(World worldIn, BlockPos pos, EntityPlayer playerIn) {}
+
+    public Vec3 modifyAcceleration(World worldIn, BlockPos pos, Entity entityIn, Vec3 motion)
+    {
+        return motion;
+    }
+
+    public void setBlockBoundsBasedOnState(IBlockAccess access, BlockPos pos) {}
+
+    /**
+     * returns the block bounderies minX value
+     */
+    public final double getBlockBoundsMinX()
+    {
+        return this.minX;
+    }
+
+    /**
+     * returns the block bounderies maxX value
+     */
+    public final double getBlockBoundsMaxX()
+    {
+        return this.maxX;
+    }
+
+    /**
+     * returns the block bounderies minY value
+     */
+    public final double getBlockBoundsMinY()
+    {
+        return this.minY;
+    }
+
+    /**
+     * returns the block bounderies maxY value
+     */
+    public final double getBlockBoundsMaxY()
+    {
+        return this.maxY;
+    }
+
+    /**
+     * returns the block bounderies minZ value
+     */
+    public final double getBlockBoundsMinZ()
+    {
+        return this.minZ;
+    }
+
+    /**
+     * returns the block bounderies maxZ value
+     */
+    public final double getBlockBoundsMaxZ()
+    {
+        return this.maxZ;
+    }
+
+    public int getBlockColor()
+    {
+        return 16777215;
+    }
+
+    public int getRenderColor(IBlockState state)
+    {
+        return 16777215;
+    }
+
+    public int colorMultiplier(IBlockAccess worldIn, BlockPos pos, int renderPass)
+    {
+        return 16777215;
+    }
+
+    public final int colorMultiplier(IBlockAccess worldIn, BlockPos pos)
+    {
+        return this.colorMultiplier(worldIn, pos, 0);
+    }
+
+    public int isProvidingWeakPower(IBlockAccess worldIn, BlockPos pos, IBlockState state, EnumFacing side)
+    {
+        return 0;
+    }
+
+    /**
+     * Can this block provide power. Only wire currently seems to have this change based on its state.
+     */
+    public boolean canProvidePower()
+    {
+        return false;
+    }
+
+    /**
+     * Called When an Entity Collided with the Block
+     */
+    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, IBlockState state, Entity entityIn) {}
+
+    public int isProvidingStrongPower(IBlockAccess worldIn, BlockPos pos, IBlockState state, EnumFacing side)
+    {
+        return 0;
+    }
+
+    /**
+     * Sets the block's bounds for rendering it as an item
+     */
+    public void setBlockBoundsForItemRender() {}
+
+    public void harvestBlock(World worldIn, EntityPlayer playerIn, BlockPos pos, IBlockState state, TileEntity te)
+    {
+        playerIn.triggerAchievement(StatList.mineBlockStatArray[getIdFromBlock(this)]);
+        playerIn.addExhaustion(0.025F);
+
+        if (this.canSilkHarvest() && EnchantmentHelper.getSilkTouchModifier(playerIn))
+        {
+            ItemStack var7 = this.createStackedBlock(state);
+
+            if (var7 != null)
+            {
+                spawnAsEntity(worldIn, pos, var7);
+            }
+        }
+        else
+        {
+            int var6 = EnchantmentHelper.getFortuneModifier(playerIn);
+            this.dropBlockAsItem(worldIn, pos, state, var6);
+        }
+    }
+
+    protected boolean canSilkHarvest()
+    {
+        return this.isFullCube() && !this.isBlockContainer;
+    }
+
+    protected ItemStack createStackedBlock(IBlockState state)
+    {
+        int var2 = 0;
+        Item var3 = Item.getItemFromBlock(this);
+
+        if (var3 != null && var3.getHasSubtypes())
+        {
+            var2 = this.getMetaFromState(state);
+        }
+
+        return new ItemStack(var3, 1, var2);
+    }
+
+    /**
+     * Get the quantity dropped based on the given fortune level
+     */
+    public int quantityDroppedWithBonus(int fortune, Random random)
+    {
+        return this.quantityDropped(random);
+    }
+
+    public void onBlockPlacedBy(World worldIn, BlockPos pos, IBlockState state, EntityLivingBase placer, ItemStack stack) {}
+
+    public Block setUnlocalizedName(String name)
+    {
+        this.unlocalizedName = name;
+        return this;
+    }
+
+    /**
+     * Gets the localized name of this block. Used for the statistics page.
+     */
+    public String getLocalizedName()
+    {
+        return StatCollector.translateToLocal(this.getUnlocalizedName() + ".name");
+    }
+
+    /**
+     * Returns the unlocalized name of the block with "tile." appended to the front.
+     */
+    public String getUnlocalizedName()
+    {
+        return "tile." + this.unlocalizedName;
+    }
+
+    /**
+     * Called on both Client and Server when World#addBlockEvent is called
+     */
+    public boolean onBlockEventReceived(World worldIn, BlockPos pos, IBlockState state, int eventID, int eventParam)
+    {
+        return false;
+    }
+
+    /**
+     * Return the state of blocks statistics flags - if the block is counted for mined and placed.
+     */
+    public boolean getEnableStats()
+    {
+        return this.enableStats;
+    }
+
+    protected Block disableStats()
+    {
+        this.enableStats = false;
+        return this;
+    }
+
+    public int getMobilityFlag()
+    {
+        return this.blockMaterial.getMaterialMobility();
+    }
+
+    /**
+     * Returns the default ambient occlusion value based on block opacity
+     */
+    public float getAmbientOcclusionLightValue()
+    {
+        return this.isSolidFullCube() ? 0.2F : 1.0F;
+    }
+
+    /**
+     * Block's chance to react to a living entity falling on it.
+     *  
+     * @param fallDistance The distance the entity has fallen before landing
+     */
+    public void onFallenUpon(World worldIn, BlockPos pos, Entity entityIn, float fallDistance)
+    {
+        entityIn.fall(fallDistance, 1.0F);
+    }
+
+    /**
+     * Called when an Entity lands on this Block. This method *must* update motionY because the entity will not do that
+     * on its own
+     */
+    public void onLanded(World worldIn, Entity entityIn)
+    {
+        entityIn.motionY = 0.0D;
+    }
+
+    public Item getItem(World worldIn, BlockPos pos)
+    {
+        return Item.getItemFromBlock(this);
+    }
+
+    public int getDamageValue(World worldIn, BlockPos pos)
+    {
+        return this.damageDropped(worldIn.getBlockState(pos));
+    }
+
+    /**
+     * returns a list of blocks with the same ID, but different meta (eg: wood returns 4 blocks)
+     */
+    public void getSubBlocks(Item itemIn, CreativeTabs tab, List list)
+    {
+        list.add(new ItemStack(itemIn, 1, 0));
+    }
+
+    /**
+     * Returns the CreativeTab to display the given block on.
+     */
+    public CreativeTabs getCreativeTabToDisplayOn()
+    {
+        return this.displayOnCreativeTab;
+    }
+
+    public Block setCreativeTab(CreativeTabs tab)
+    {
+        this.displayOnCreativeTab = tab;
+        return this;
+    }
+
+    public void onBlockHarvested(World worldIn, BlockPos pos, IBlockState state, EntityPlayer playerIn) {}
+
+    /**
+     * Called similar to random ticks, but only when it is raining.
+     */
+    public void fillWithRain(World worldIn, BlockPos pos) {}
+
+    /**
+     * Returns true only if block is flowerPot
+     */
+    public boolean isFlowerPot()
+    {
+        return false;
+    }
+
+    public boolean requiresUpdates()
+    {
+        return true;
+    }
+
+    /**
+     * Return whether this block can drop from an explosion.
+     */
+    public boolean canDropFromExplosion(Explosion explosionIn)
+    {
+        return true;
+    }
+
+    public boolean isAssociatedBlock(Block other)
+    {
+        return this == other;
+    }
+
+    public static boolean isEqualTo(Block blockIn, Block other)
+    {
+        return blockIn != null && other != null ? (blockIn == other ? true : blockIn.isAssociatedBlock(other)) : false;
+    }
+
+    public boolean hasComparatorInputOverride()
+    {
+        return false;
+    }
+
+    public int getComparatorInputOverride(World worldIn, BlockPos pos)
+    {
+        return 0;
+    }
+
+    /**
+     * Possibly modify the given BlockState before rendering it on an Entity (Minecarts, Endermen, ...)
+     */
+    public IBlockState getStateForEntityRender(IBlockState state)
+    {
+        return state;
+    }
+
+    protected BlockState createBlockState()
+    {
+        return new BlockState(this, new IProperty[0]);
+    }
+
+    public BlockState getBlockState()
+    {
+        return this.blockState;
+    }
+
+    protected final void setDefaultState(IBlockState state)
+    {
+        this.defaultBlockState = state;
+    }
+
+    public final IBlockState getDefaultState()
+    {
+        return this.defaultBlockState;
+    }
+
+    /**
+     * Get the OffsetType for this Block. Determines if the model is rendered slightly offset.
+     */
+    public Block.EnumOffsetType getOffsetType()
+    {
+        return Block.EnumOffsetType.NONE;
+    }
+
+    public static void registerBlocks()
+    {
+        registerBlock(0, AIR_ID, (new BlockAir()).setUnlocalizedName("air"));
+        registerBlock(1, "stone", (new BlockStone()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stone"));
+        registerBlock(2, "grass", (new BlockGrass()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("grass"));
+        registerBlock(3, "dirt", (new BlockDirt()).setHardness(0.5F).setStepSound(soundTypeGravel).setUnlocalizedName("dirt"));
+        Block var0 = (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stonebrick").setCreativeTab(CreativeTabs.tabBlock);
+        registerBlock(4, "cobblestone", var0);
+        Block var1 = (new BlockPlanks()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("wood");
+        registerBlock(5, "planks", var1);
+        registerBlock(6, "sapling", (new BlockSapling()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("sapling"));
+        registerBlock(7, "bedrock", (new Block(Material.rock)).setBlockUnbreakable().setResistance(6000000.0F).setStepSound(soundTypePiston).setUnlocalizedName("bedrock").disableStats().setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(8, "flowing_water", (new BlockDynamicLiquid(Material.water)).setHardness(100.0F).setLightOpacity(3).setUnlocalizedName("water").disableStats());
+        registerBlock(9, "water", (new BlockStaticLiquid(Material.water)).setHardness(100.0F).setLightOpacity(3).setUnlocalizedName("water").disableStats());
+        registerBlock(10, "flowing_lava", (new BlockDynamicLiquid(Material.lava)).setHardness(100.0F).setLightLevel(1.0F).setUnlocalizedName("lava").disableStats());
+        registerBlock(11, "lava", (new BlockStaticLiquid(Material.lava)).setHardness(100.0F).setLightLevel(1.0F).setUnlocalizedName("lava").disableStats());
+        registerBlock(12, "sand", (new BlockSand()).setHardness(0.5F).setStepSound(soundTypeSand).setUnlocalizedName("sand"));
+        registerBlock(13, "gravel", (new BlockGravel()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("gravel"));
+        registerBlock(14, "gold_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreGold"));
+        registerBlock(15, "iron_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreIron"));
+        registerBlock(16, "coal_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreCoal"));
+        registerBlock(17, "log", (new BlockOldLog()).setUnlocalizedName("log"));
+        registerBlock(18, "leaves", (new BlockOldLeaf()).setUnlocalizedName("leaves"));
+        registerBlock(19, "sponge", (new BlockSponge()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("sponge"));
+        registerBlock(20, "glass", (new BlockGlass(Material.glass, false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("glass"));
+        registerBlock(21, "lapis_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreLapis"));
+        registerBlock(22, "lapis_block", (new BlockCompressed(MapColor.lapisColor)).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("blockLapis").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(23, "dispenser", (new BlockDispenser()).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("dispenser"));
+        Block var2 = (new BlockSandStone()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("sandStone");
+        registerBlock(24, "sandstone", var2);
+        registerBlock(25, "noteblock", (new BlockNote()).setHardness(0.8F).setUnlocalizedName("musicBlock"));
+        registerBlock(26, "bed", (new BlockBed()).setStepSound(soundTypeWood).setHardness(0.2F).setUnlocalizedName("bed").disableStats());
+        registerBlock(27, "golden_rail", (new BlockRailPowered()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("goldenRail"));
+        registerBlock(28, "detector_rail", (new BlockRailDetector()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("detectorRail"));
+        registerBlock(29, "sticky_piston", (new BlockPistonBase(true)).setUnlocalizedName("pistonStickyBase"));
+        registerBlock(30, "web", (new BlockWeb()).setLightOpacity(1).setHardness(4.0F).setUnlocalizedName("web"));
+        registerBlock(31, "tallgrass", (new BlockTallGrass()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("tallgrass"));
+        registerBlock(32, "deadbush", (new BlockDeadBush()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("deadbush"));
+        registerBlock(33, "piston", (new BlockPistonBase(false)).setUnlocalizedName("pistonBase"));
+        registerBlock(34, "piston_head", new BlockPistonExtension());
+        registerBlock(35, "wool", (new BlockColored(Material.cloth)).setHardness(0.8F).setStepSound(soundTypeCloth).setUnlocalizedName("cloth"));
+        registerBlock(36, "piston_extension", new BlockPistonMoving());
+        registerBlock(37, "yellow_flower", (new BlockYellowFlower()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("flower1"));
+        registerBlock(38, "red_flower", (new BlockRedFlower()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("flower2"));
+        Block var3 = (new BlockMushroom()).setHardness(0.0F).setStepSound(soundTypeGrass).setLightLevel(0.125F).setUnlocalizedName("mushroom");
+        registerBlock(39, "brown_mushroom", var3);
+        Block var4 = (new BlockMushroom()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("mushroom");
+        registerBlock(40, "red_mushroom", var4);
+        registerBlock(41, "gold_block", (new BlockCompressed(MapColor.goldColor)).setHardness(3.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockGold"));
+        registerBlock(42, "iron_block", (new BlockCompressed(MapColor.ironColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockIron"));
+        registerBlock(43, "double_stone_slab", (new BlockDoubleStoneSlab()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab"));
+        registerBlock(44, "stone_slab", (new BlockHalfStoneSlab()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab"));
+        Block var5 = (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("brick").setCreativeTab(CreativeTabs.tabBlock);
+        registerBlock(45, "brick_block", var5);
+        registerBlock(46, "tnt", (new BlockTNT()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("tnt"));
+        registerBlock(47, "bookshelf", (new BlockBookshelf()).setHardness(1.5F).setStepSound(soundTypeWood).setUnlocalizedName("bookshelf"));
+        registerBlock(48, "mossy_cobblestone", (new Block(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneMoss").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(49, "obsidian", (new BlockObsidian()).setHardness(50.0F).setResistance(2000.0F).setStepSound(soundTypePiston).setUnlocalizedName("obsidian"));
+        registerBlock(50, "torch", (new BlockTorch()).setHardness(0.0F).setLightLevel(0.9375F).setStepSound(soundTypeWood).setUnlocalizedName("torch"));
+        registerBlock(51, "fire", (new BlockFire()).setHardness(0.0F).setLightLevel(1.0F).setStepSound(soundTypeCloth).setUnlocalizedName("fire").disableStats());
+        registerBlock(52, "mob_spawner", (new BlockMobSpawner()).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("mobSpawner").disableStats());
+        registerBlock(53, "oak_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.OAK))).setUnlocalizedName("stairsWood"));
+        registerBlock(54, "chest", (new BlockChest(0)).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("chest"));
+        registerBlock(55, "redstone_wire", (new BlockRedstoneWire()).setHardness(0.0F).setStepSound(soundTypeStone).setUnlocalizedName("redstoneDust").disableStats());
+        registerBlock(56, "diamond_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreDiamond"));
+        registerBlock(57, "diamond_block", (new BlockCompressed(MapColor.diamondColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockDiamond"));
+        registerBlock(58, "crafting_table", (new BlockWorkbench()).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("workbench"));
+        registerBlock(59, "wheat", (new BlockCrops()).setUnlocalizedName("crops"));
+        Block var6 = (new BlockFarmland()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("farmland");
+        registerBlock(60, "farmland", var6);
+        registerBlock(61, "furnace", (new BlockFurnace(false)).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("furnace").setCreativeTab(CreativeTabs.tabDecorations));
+        registerBlock(62, "lit_furnace", (new BlockFurnace(true)).setHardness(3.5F).setStepSound(soundTypePiston).setLightLevel(0.875F).setUnlocalizedName("furnace"));
+        registerBlock(63, "standing_sign", (new BlockStandingSign()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("sign").disableStats());
+        registerBlock(64, "wooden_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorOak").disableStats());
+        registerBlock(65, "ladder", (new BlockLadder()).setHardness(0.4F).setStepSound(soundTypeLadder).setUnlocalizedName("ladder"));
+        registerBlock(66, "rail", (new BlockRail()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("rail"));
+        registerBlock(67, "stone_stairs", (new BlockStairs(var0.getDefaultState())).setUnlocalizedName("stairsStone"));
+        registerBlock(68, "wall_sign", (new BlockWallSign()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("sign").disableStats());
+        registerBlock(69, "lever", (new BlockLever()).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("lever"));
+        registerBlock(70, "stone_pressure_plate", (new BlockPressurePlate(Material.rock, BlockPressurePlate.Sensitivity.MOBS)).setHardness(0.5F).setStepSound(soundTypePiston).setUnlocalizedName("pressurePlateStone"));
+        registerBlock(71, "iron_door", (new BlockDoor(Material.iron)).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("doorIron").disableStats());
+        registerBlock(72, "wooden_pressure_plate", (new BlockPressurePlate(Material.wood, BlockPressurePlate.Sensitivity.EVERYTHING)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("pressurePlateWood"));
+        registerBlock(73, "redstone_ore", (new BlockRedstoneOre(false)).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreRedstone").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(74, "lit_redstone_ore", (new BlockRedstoneOre(true)).setLightLevel(0.625F).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreRedstone"));
+        registerBlock(75, "unlit_redstone_torch", (new BlockRedstoneTorch(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("notGate"));
+        registerBlock(76, "redstone_torch", (new BlockRedstoneTorch(true)).setHardness(0.0F).setLightLevel(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("notGate").setCreativeTab(CreativeTabs.tabRedstone));
+        registerBlock(77, "stone_button", (new BlockButtonStone()).setHardness(0.5F).setStepSound(soundTypePiston).setUnlocalizedName("button"));
+        registerBlock(78, "snow_layer", (new BlockSnow()).setHardness(0.1F).setStepSound(soundTypeSnow).setUnlocalizedName("snow").setLightOpacity(0));
+        registerBlock(79, "ice", (new BlockIce()).setHardness(0.5F).setLightOpacity(3).setStepSound(soundTypeGlass).setUnlocalizedName("ice"));
+        registerBlock(80, "snow", (new BlockSnowBlock()).setHardness(0.2F).setStepSound(soundTypeSnow).setUnlocalizedName("snow"));
+        registerBlock(81, "cactus", (new BlockCactus()).setHardness(0.4F).setStepSound(soundTypeCloth).setUnlocalizedName("cactus"));
+        registerBlock(82, "clay", (new BlockClay()).setHardness(0.6F).setStepSound(soundTypeGravel).setUnlocalizedName("clay"));
+        registerBlock(83, "reeds", (new BlockReed()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("reeds").disableStats());
+        registerBlock(84, "jukebox", (new BlockJukebox()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("jukebox"));
+        registerBlock(85, "fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("fence"));
+        Block var7 = (new BlockPumpkin()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkin");
+        registerBlock(86, "pumpkin", var7);
+        registerBlock(87, "netherrack", (new BlockNetherrack()).setHardness(0.4F).setStepSound(soundTypePiston).setUnlocalizedName("hellrock"));
+        registerBlock(88, "soul_sand", (new BlockSoulSand()).setHardness(0.5F).setStepSound(soundTypeSand).setUnlocalizedName("hellsand"));
+        registerBlock(89, "glowstone", (new BlockGlowstone(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setLightLevel(1.0F).setUnlocalizedName("lightgem"));
+        registerBlock(90, "portal", (new BlockPortal()).setHardness(-1.0F).setStepSound(soundTypeGlass).setLightLevel(0.75F).setUnlocalizedName("portal"));
+        registerBlock(91, "lit_pumpkin", (new BlockPumpkin()).setHardness(1.0F).setStepSound(soundTypeWood).setLightLevel(1.0F).setUnlocalizedName("litpumpkin"));
+        registerBlock(92, "cake", (new BlockCake()).setHardness(0.5F).setStepSound(soundTypeCloth).setUnlocalizedName("cake").disableStats());
+        registerBlock(93, "unpowered_repeater", (new BlockRedstoneRepeater(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("diode").disableStats());
+        registerBlock(94, "powered_repeater", (new BlockRedstoneRepeater(true)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("diode").disableStats());
+        registerBlock(95, "stained_glass", (new BlockStainedGlass(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("stainedGlass"));
+        registerBlock(96, "trapdoor", (new BlockTrapDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("trapdoor").disableStats());
+        registerBlock(97, "monster_egg", (new BlockSilverfish()).setHardness(0.75F).setUnlocalizedName("monsterStoneEgg"));
+        Block var8 = (new BlockStoneBrick()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stonebricksmooth");
+        registerBlock(98, "stonebrick", var8);
+        registerBlock(99, "brown_mushroom_block", (new BlockHugeMushroom(Material.wood, var3)).setHardness(0.2F).setStepSound(soundTypeWood).setUnlocalizedName("mushroom"));
+        registerBlock(100, "red_mushroom_block", (new BlockHugeMushroom(Material.wood, var4)).setHardness(0.2F).setStepSound(soundTypeWood).setUnlocalizedName("mushroom"));
+        registerBlock(101, "iron_bars", (new BlockPane(Material.iron, true)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("fenceIron"));
+        registerBlock(102, "glass_pane", (new BlockPane(Material.glass, false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("thinGlass"));
+        Block var9 = (new BlockMelon()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("melon");
+        registerBlock(103, "melon_block", var9);
+        registerBlock(104, "pumpkin_stem", (new BlockStem(var7)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkinStem"));
+        registerBlock(105, "melon_stem", (new BlockStem(var9)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("pumpkinStem"));
+        registerBlock(106, "vine", (new BlockVine()).setHardness(0.2F).setStepSound(soundTypeGrass).setUnlocalizedName("vine"));
+        registerBlock(107, "fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("fenceGate"));
+        registerBlock(108, "brick_stairs", (new BlockStairs(var5.getDefaultState())).setUnlocalizedName("stairsBrick"));
+        registerBlock(109, "stone_brick_stairs", (new BlockStairs(var8.getDefaultState().withProperty(BlockStoneBrick.VARIANT_PROP, BlockStoneBrick.EnumType.DEFAULT))).setUnlocalizedName("stairsStoneBrickSmooth"));
+        registerBlock(110, "mycelium", (new BlockMycelium()).setHardness(0.6F).setStepSound(soundTypeGrass).setUnlocalizedName("mycel"));
+        registerBlock(111, "waterlily", (new BlockLilyPad()).setHardness(0.0F).setStepSound(soundTypeGrass).setUnlocalizedName("waterlily"));
+        Block var10 = (new BlockNetherBrick()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherBrick").setCreativeTab(CreativeTabs.tabBlock);
+        registerBlock(112, "nether_brick", var10);
+        registerBlock(113, "nether_brick_fence", (new BlockFence(Material.rock)).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherFence"));
+        registerBlock(114, "nether_brick_stairs", (new BlockStairs(var10.getDefaultState())).setUnlocalizedName("stairsNetherBrick"));
+        registerBlock(115, "nether_wart", (new BlockNetherWart()).setUnlocalizedName("netherStalk"));
+        registerBlock(116, "enchanting_table", (new BlockEnchantmentTable()).setHardness(5.0F).setResistance(2000.0F).setUnlocalizedName("enchantmentTable"));
+        registerBlock(117, "brewing_stand", (new BlockBrewingStand()).setHardness(0.5F).setLightLevel(0.125F).setUnlocalizedName("brewingStand"));
+        registerBlock(118, "cauldron", (new BlockCauldron()).setHardness(2.0F).setUnlocalizedName("cauldron"));
+        registerBlock(119, "end_portal", (new BlockEndPortal(Material.portal)).setHardness(-1.0F).setResistance(6000000.0F));
+        registerBlock(120, "end_portal_frame", (new BlockEndPortalFrame()).setStepSound(soundTypeGlass).setLightLevel(0.125F).setHardness(-1.0F).setUnlocalizedName("endPortalFrame").setResistance(6000000.0F).setCreativeTab(CreativeTabs.tabDecorations));
+        registerBlock(121, "end_stone", (new Block(Material.rock)).setHardness(3.0F).setResistance(15.0F).setStepSound(soundTypePiston).setUnlocalizedName("whiteStone").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(122, "dragon_egg", (new BlockDragonEgg()).setHardness(3.0F).setResistance(15.0F).setStepSound(soundTypePiston).setLightLevel(0.125F).setUnlocalizedName("dragonEgg"));
+        registerBlock(123, "redstone_lamp", (new BlockRedstoneLight(false)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("redstoneLight").setCreativeTab(CreativeTabs.tabRedstone));
+        registerBlock(124, "lit_redstone_lamp", (new BlockRedstoneLight(true)).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("redstoneLight"));
+        registerBlock(125, "double_wooden_slab", (new BlockDoubleWoodSlab()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("woodSlab"));
+        registerBlock(126, "wooden_slab", (new BlockHalfWoodSlab()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("woodSlab"));
+        registerBlock(127, "cocoa", (new BlockCocoa()).setHardness(0.2F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("cocoa"));
+        registerBlock(128, "sandstone_stairs", (new BlockStairs(var2.getDefaultState().withProperty(BlockSandStone.field_176297_a, BlockSandStone.EnumType.SMOOTH))).setUnlocalizedName("stairsSandStone"));
+        registerBlock(129, "emerald_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("oreEmerald"));
+        registerBlock(130, "ender_chest", (new BlockEnderChest()).setHardness(22.5F).setResistance(1000.0F).setStepSound(soundTypePiston).setUnlocalizedName("enderChest").setLightLevel(0.5F));
+        registerBlock(131, "tripwire_hook", (new BlockTripWireHook()).setUnlocalizedName("tripWireSource"));
+        registerBlock(132, "tripwire", (new BlockTripWire()).setUnlocalizedName("tripWire"));
+        registerBlock(133, "emerald_block", (new BlockCompressed(MapColor.emeraldColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockEmerald"));
+        registerBlock(134, "spruce_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.SPRUCE))).setUnlocalizedName("stairsWoodSpruce"));
+        registerBlock(135, "birch_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.BIRCH))).setUnlocalizedName("stairsWoodBirch"));
+        registerBlock(136, "jungle_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.JUNGLE))).setUnlocalizedName("stairsWoodJungle"));
+        registerBlock(137, "command_block", (new BlockCommandBlock()).setBlockUnbreakable().setResistance(6000000.0F).setUnlocalizedName("commandBlock"));
+        registerBlock(138, "beacon", (new BlockBeacon()).setUnlocalizedName("beacon").setLightLevel(1.0F));
+        registerBlock(139, "cobblestone_wall", (new BlockWall(var0)).setUnlocalizedName("cobbleWall"));
+        registerBlock(140, "flower_pot", (new BlockFlowerPot()).setHardness(0.0F).setStepSound(soundTypeStone).setUnlocalizedName("flowerPot"));
+        registerBlock(141, "carrots", (new BlockCarrot()).setUnlocalizedName("carrots"));
+        registerBlock(142, "potatoes", (new BlockPotato()).setUnlocalizedName("potatoes"));
+        registerBlock(143, "wooden_button", (new BlockButtonWood()).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("button"));
+        registerBlock(144, "skull", (new BlockSkull()).setHardness(1.0F).setStepSound(soundTypePiston).setUnlocalizedName("skull"));
+        registerBlock(145, "anvil", (new BlockAnvil()).setHardness(5.0F).setStepSound(soundTypeAnvil).setResistance(2000.0F).setUnlocalizedName("anvil"));
+        registerBlock(146, "trapped_chest", (new BlockChest(1)).setHardness(2.5F).setStepSound(soundTypeWood).setUnlocalizedName("chestTrap"));
+        registerBlock(147, "light_weighted_pressure_plate", (new BlockPressurePlateWeighted("gold_block", Material.iron, 15)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("weightedPlate_light"));
+        registerBlock(148, "heavy_weighted_pressure_plate", (new BlockPressurePlateWeighted("iron_block", Material.iron, 150)).setHardness(0.5F).setStepSound(soundTypeWood).setUnlocalizedName("weightedPlate_heavy"));
+        registerBlock(149, "unpowered_comparator", (new BlockRedstoneComparator(false)).setHardness(0.0F).setStepSound(soundTypeWood).setUnlocalizedName("comparator").disableStats());
+        registerBlock(150, "powered_comparator", (new BlockRedstoneComparator(true)).setHardness(0.0F).setLightLevel(0.625F).setStepSound(soundTypeWood).setUnlocalizedName("comparator").disableStats());
+        registerBlock(151, "daylight_detector", new BlockDaylightDetector(false));
+        registerBlock(152, "redstone_block", (new BlockCompressedPowered(MapColor.tntColor)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypeMetal).setUnlocalizedName("blockRedstone"));
+        registerBlock(153, "quartz_ore", (new BlockOre()).setHardness(3.0F).setResistance(5.0F).setStepSound(soundTypePiston).setUnlocalizedName("netherquartz"));
+        registerBlock(154, "hopper", (new BlockHopper()).setHardness(3.0F).setResistance(8.0F).setStepSound(soundTypeMetal).setUnlocalizedName("hopper"));
+        Block var11 = (new BlockQuartz()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("quartzBlock");
+        registerBlock(155, "quartz_block", var11);
+        registerBlock(156, "quartz_stairs", (new BlockStairs(var11.getDefaultState().withProperty(BlockQuartz.VARIANT_PROP, BlockQuartz.EnumType.DEFAULT))).setUnlocalizedName("stairsQuartz"));
+        registerBlock(157, "activator_rail", (new BlockRailPowered()).setHardness(0.7F).setStepSound(soundTypeMetal).setUnlocalizedName("activatorRail"));
+        registerBlock(158, "dropper", (new BlockDropper()).setHardness(3.5F).setStepSound(soundTypePiston).setUnlocalizedName("dropper"));
+        registerBlock(159, "stained_hardened_clay", (new BlockColored(Material.rock)).setHardness(1.25F).setResistance(7.0F).setStepSound(soundTypePiston).setUnlocalizedName("clayHardenedStained"));
+        registerBlock(160, "stained_glass_pane", (new BlockStainedGlassPane()).setHardness(0.3F).setStepSound(soundTypeGlass).setUnlocalizedName("thinStainedGlass"));
+        registerBlock(161, "leaves2", (new BlockNewLeaf()).setUnlocalizedName("leaves"));
+        registerBlock(162, "log2", (new BlockNewLog()).setUnlocalizedName("log"));
+        registerBlock(163, "acacia_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.ACACIA))).setUnlocalizedName("stairsWoodAcacia"));
+        registerBlock(164, "dark_oak_stairs", (new BlockStairs(var1.getDefaultState().withProperty(BlockPlanks.VARIANT_PROP, BlockPlanks.EnumType.DARK_OAK))).setUnlocalizedName("stairsWoodDarkOak"));
+        registerBlock(165, "slime", (new BlockSlime()).setUnlocalizedName("slime").setStepSound(SLIME_SOUND));
+        registerBlock(166, "barrier", (new BlockBarrier()).setUnlocalizedName("barrier"));
+        registerBlock(167, "iron_trapdoor", (new BlockTrapDoor(Material.iron)).setHardness(5.0F).setStepSound(soundTypeMetal).setUnlocalizedName("ironTrapdoor").disableStats());
+        registerBlock(168, "prismarine", (new BlockPrismarine()).setHardness(1.5F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("prismarine"));
+        registerBlock(169, "sea_lantern", (new BlockSeaLantern(Material.glass)).setHardness(0.3F).setStepSound(soundTypeGlass).setLightLevel(1.0F).setUnlocalizedName("seaLantern"));
+        registerBlock(170, "hay_block", (new BlockHay()).setHardness(0.5F).setStepSound(soundTypeGrass).setUnlocalizedName("hayBlock").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(171, "carpet", (new BlockCarpet()).setHardness(0.1F).setStepSound(soundTypeCloth).setUnlocalizedName("woolCarpet").setLightOpacity(0));
+        registerBlock(172, "hardened_clay", (new BlockHardenedClay()).setHardness(1.25F).setResistance(7.0F).setStepSound(soundTypePiston).setUnlocalizedName("clayHardened"));
+        registerBlock(173, "coal_block", (new Block(Material.rock)).setHardness(5.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("blockCoal").setCreativeTab(CreativeTabs.tabBlock));
+        registerBlock(174, "packed_ice", (new BlockPackedIce()).setHardness(0.5F).setStepSound(soundTypeGlass).setUnlocalizedName("icePacked"));
+        registerBlock(175, "double_plant", new BlockDoublePlant());
+        registerBlock(176, "standing_banner", (new BlockBanner.BlockBannerStanding()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("banner").disableStats());
+        registerBlock(177, "wall_banner", (new BlockBanner.BlockBannerHanging()).setHardness(1.0F).setStepSound(soundTypeWood).setUnlocalizedName("banner").disableStats());
+        registerBlock(178, "daylight_detector_inverted", new BlockDaylightDetector(true));
+        Block var12 = (new BlockRedSandstone()).setStepSound(soundTypePiston).setHardness(0.8F).setUnlocalizedName("redSandStone");
+        registerBlock(179, "red_sandstone", var12);
+        registerBlock(180, "red_sandstone_stairs", (new BlockStairs(var12.getDefaultState().withProperty(BlockRedSandstone.TYPE, BlockRedSandstone.EnumType.SMOOTH))).setUnlocalizedName("stairsRedSandStone"));
+        registerBlock(181, "double_stone_slab2", (new BlockDoubleStoneSlabNew()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab2"));
+        registerBlock(182, "stone_slab2", (new BlockHalfStoneSlabNew()).setHardness(2.0F).setResistance(10.0F).setStepSound(soundTypePiston).setUnlocalizedName("stoneSlab2"));
+        registerBlock(183, "spruce_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("spruceFenceGate"));
+        registerBlock(184, "birch_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("birchFenceGate"));
+        registerBlock(185, "jungle_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("jungleFenceGate"));
+        registerBlock(186, "dark_oak_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("darkOakFenceGate"));
+        registerBlock(187, "acacia_fence_gate", (new BlockFenceGate()).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("acaciaFenceGate"));
+        registerBlock(188, "spruce_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("spruceFence"));
+        registerBlock(189, "birch_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("birchFence"));
+        registerBlock(190, "jungle_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("jungleFence"));
+        registerBlock(191, "dark_oak_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("darkOakFence"));
+        registerBlock(192, "acacia_fence", (new BlockFence(Material.wood)).setHardness(2.0F).setResistance(5.0F).setStepSound(soundTypeWood).setUnlocalizedName("acaciaFence"));
+        registerBlock(193, "spruce_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorSpruce").disableStats());
+        registerBlock(194, "birch_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorBirch").disableStats());
+        registerBlock(195, "jungle_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorJungle").disableStats());
+        registerBlock(196, "acacia_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorAcacia").disableStats());
+        registerBlock(197, "dark_oak_door", (new BlockDoor(Material.wood)).setHardness(3.0F).setStepSound(soundTypeWood).setUnlocalizedName("doorDarkOak").disableStats());
+        blockRegistry.validateKey();
+        Iterator var13 = blockRegistry.iterator();
+        Block var14;
+
+        while (var13.hasNext())
+        {
+            var14 = (Block)var13.next();
+
+            if (var14.blockMaterial == Material.air)
+            {
+                var14.useNeighborBrightness = false;
+            }
+            else
+            {
+                boolean var15 = false;
+                boolean var16 = var14 instanceof BlockStairs;
+                boolean var17 = var14 instanceof BlockSlab;
+                boolean var18 = var14 == var6;
+                boolean var19 = var14.translucent;
+                boolean var20 = var14.lightOpacity == 0;
+
+                if (var16 || var17 || var18 || var19 || var20)
+                {
+                    var15 = true;
+                }
+
+                var14.useNeighborBrightness = var15;
+            }
+        }
+
+        var13 = blockRegistry.iterator();
+
+        while (var13.hasNext())
+        {
+            var14 = (Block)var13.next();
+            Iterator var21 = var14.getBlockState().getValidStates().iterator();
+
+            while (var21.hasNext())
+            {
+                IBlockState var22 = (IBlockState)var21.next();
+                int var23 = blockRegistry.getIDForObject(var14) << 4 | var14.getMetaFromState(var22);
+                BLOCK_STATE_IDS.put(var22, var23);
+            }
+        }
+    }
+
+    private static void registerBlock(int id, ResourceLocation textualID, Block block_)
+    {
+        blockRegistry.register(id, textualID, block_);
+    }
+
+    private static void registerBlock(int id, String textualID, Block block_)
+    {
+        registerBlock(id, new ResourceLocation(textualID), block_);
+    }
+
+    public static enum EnumOffsetType
+    {
+        NONE("NONE", 0),
+        XZ("XZ", 1),
+        XYZ("XYZ", 2);
+
+        private static final Block.EnumOffsetType[] $VALUES = new Block.EnumOffsetType[]{NONE, XZ, XYZ};
+        private static final String __OBFID = "CL_00002132";
+
+        private EnumOffsetType(String p_i45733_1_, int p_i45733_2_) {}
+    }
+
+    public static class SoundType
+    {
+        public final String soundName;
+        public final float volume;
+        public final float frequency;
+        private static final String __OBFID = "CL_00000203";
+
+        public SoundType(String name, float volume, float frequency)
+        {
+            this.soundName = name;
+            this.volume = volume;
+            this.frequency = frequency;
+        }
+
+        public float getVolume()
+        {
+            return this.volume;
+        }
+
+        public float getFrequency()
+        {
+            return this.frequency;
+        }
+
+        public String getBreakSound()
+        {
+            return "dig." + this.soundName;
+        }
+
+        public String getStepSound()
+        {
+            return "step." + this.soundName;
+        }
+
+        public String getPlaceSound()
+        {
+            return this.getBreakSound();
+        }
+    }
+}
diff --git a/src/net/minecraft/block/BlockLiquid.java b/src/net/minecraft/block/BlockLiquid.java
index 4689151..2cb91c5 100644
--- a/src/net/minecraft/block/BlockLiquid.java
+++ b/src/net/minecraft/block/BlockLiquid.java
@@ -1,419 +1,427 @@
-package net.minecraft.block;
-
-import java.util.Iterator;
-import java.util.Random;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.properties.IProperty;
-import net.minecraft.block.properties.PropertyInteger;
-import net.minecraft.block.state.BlockState;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.entity.Entity;
-import net.minecraft.init.Blocks;
-import net.minecraft.item.Item;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.EnumWorldBlockLayer;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.IBlockAccess;
-import net.minecraft.world.World;
-import net.minecraft.world.biome.BiomeColorHelper;
-
-public abstract class BlockLiquid extends Block
-{
-    public static final PropertyInteger LEVEL = PropertyInteger.create("level", 0, 15);
-    private static final String __OBFID = "CL_00000265";
-
-    protected BlockLiquid(Material p_i45413_1_)
-    {
-        super(p_i45413_1_);
-        this.setDefaultState(this.blockState.getBaseState().withProperty(LEVEL, Integer.valueOf(0)));
-        this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
-        this.setTickRandomly(true);
-    }
-
-    public boolean isPassable(IBlockAccess blockAccess, BlockPos pos)
-    {
-        return this.blockMaterial != Material.lava;
-    }
-
-    public int colorMultiplier(IBlockAccess worldIn, BlockPos pos, int renderPass)
-    {
-        return this.blockMaterial == Material.water ? BiomeColorHelper.func_180288_c(worldIn, pos) : 16777215;
-    }
-
-    /**
-     * Returns the percentage of the liquid block that is air, based on the given flow decay of the liquid
-     */
-    public static float getLiquidHeightPercent(int p_149801_0_)
-    {
-        if (p_149801_0_ >= 8)
-        {
-            p_149801_0_ = 0;
-        }
-
-        return (float)(p_149801_0_ + 1) / 9.0F;
-    }
-
-    protected int func_176362_e(IBlockAccess p_176362_1_, BlockPos p_176362_2_)
-    {
-        return p_176362_1_.getBlockState(p_176362_2_).getBlock().getMaterial() == this.blockMaterial ? ((Integer)p_176362_1_.getBlockState(p_176362_2_).getValue(LEVEL)).intValue() : -1;
-    }
-
-    protected int func_176366_f(IBlockAccess p_176366_1_, BlockPos p_176366_2_)
-    {
-        int var3 = this.func_176362_e(p_176366_1_, p_176366_2_);
-        return var3 >= 8 ? 0 : var3;
-    }
-
-    public boolean isFullCube()
-    {
-        return false;
-    }
-
-    public boolean isOpaqueCube()
-    {
-        return false;
-    }
-
-    public boolean canCollideCheck(IBlockState state, boolean p_176209_2_)
-    {
-        return p_176209_2_ && ((Integer)state.getValue(LEVEL)).intValue() == 0;
-    }
-
-    /**
-     * Whether this Block is solid on the given Side
-     */
-    public boolean isBlockSolid(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
-    {
-        Material var4 = worldIn.getBlockState(pos).getBlock().getMaterial();
-        return var4 == this.blockMaterial ? false : (side == EnumFacing.UP ? true : (var4 == Material.ice ? false : super.isBlockSolid(worldIn, pos, side)));
-    }
-
-    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
-    {
-        return worldIn.getBlockState(pos).getBlock().getMaterial() == this.blockMaterial ? false : (side == EnumFacing.UP ? true : super.shouldSideBeRendered(worldIn, pos, side));
-    }
-
-    public boolean func_176364_g(IBlockAccess p_176364_1_, BlockPos p_176364_2_)
-    {
-        for (int var3 = -1; var3 <= 1; ++var3)
-        {
-            for (int var4 = -1; var4 <= 1; ++var4)
-            {
-                IBlockState var5 = p_176364_1_.getBlockState(p_176364_2_.add(var3, 0, var4));
-                Block var6 = var5.getBlock();
-                Material var7 = var6.getMaterial();
-
-                if (var7 != this.blockMaterial && !var6.isFullBlock())
-                {
-                    return true;
-                }
-            }
-        }
-
-        return false;
-    }
-
-    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
-    {
-        return null;
-    }
-
-    /**
-     * The type of render function that is called for this block
-     */
-    public int getRenderType()
-    {
-        return 1;
-    }
-
-    /**
-     * Get the Item that this Block should drop when harvested.
-     *  
-     * @param fortune the level of the Fortune enchantment on the player's tool
-     */
-    public Item getItemDropped(IBlockState state, Random rand, int fortune)
-    {
-        return null;
-    }
-
-    /**
-     * Returns the quantity of items to drop on block destruction.
-     */
-    public int quantityDropped(Random random)
-    {
-        return 0;
-    }
-
-    protected Vec3 func_180687_h(IBlockAccess p_180687_1_, BlockPos p_180687_2_)
-    {
-        Vec3 var3 = new Vec3(0.0D, 0.0D, 0.0D);
-        int var4 = this.func_176366_f(p_180687_1_, p_180687_2_);
-        Iterator var5 = EnumFacing.Plane.HORIZONTAL.iterator();
-        EnumFacing var6;
-        BlockPos var7;
-
-        while (var5.hasNext())
-        {
-            var6 = (EnumFacing)var5.next();
-            var7 = p_180687_2_.offset(var6);
-            int var8 = this.func_176366_f(p_180687_1_, var7);
-            int var9;
-
-            if (var8 < 0)
-            {
-                if (!p_180687_1_.getBlockState(var7).getBlock().getMaterial().blocksMovement())
-                {
-                    var8 = this.func_176366_f(p_180687_1_, var7.offsetDown());
-
-                    if (var8 >= 0)
-                    {
-                        var9 = var8 - (var4 - 8);
-                        var3 = var3.addVector((double)((var7.getX() - p_180687_2_.getX()) * var9), (double)((var7.getY() - p_180687_2_.getY()) * var9), (double)((var7.getZ() - p_180687_2_.getZ()) * var9));
-                    }
-                }
-            }
-            else if (var8 >= 0)
-            {
-                var9 = var8 - var4;
-                var3 = var3.addVector((double)((var7.getX() - p_180687_2_.getX()) * var9), (double)((var7.getY() - p_180687_2_.getY()) * var9), (double)((var7.getZ() - p_180687_2_.getZ()) * var9));
-            }
-        }
-
-        if (((Integer)p_180687_1_.getBlockState(p_180687_2_).getValue(LEVEL)).intValue() >= 8)
-        {
-            var5 = EnumFacing.Plane.HORIZONTAL.iterator();
-
-            while (var5.hasNext())
-            {
-                var6 = (EnumFacing)var5.next();
-                var7 = p_180687_2_.offset(var6);
-
-                if (this.isBlockSolid(p_180687_1_, var7, var6) || this.isBlockSolid(p_180687_1_, var7.offsetUp(), var6))
-                {
-                    var3 = var3.normalize().addVector(0.0D, -6.0D, 0.0D);
-                    break;
-                }
-            }
-        }
-
-        return var3.normalize();
-    }
-
-    public Vec3 modifyAcceleration(World worldIn, BlockPos pos, Entity entityIn, Vec3 motion)
-    {
-        return motion.add(this.func_180687_h(worldIn, pos));
-    }
-
-    /**
-     * How many world ticks before ticking
-     */
-    public int tickRate(World worldIn)
-    {
-        return this.blockMaterial == Material.water ? 5 : (this.blockMaterial == Material.lava ? (worldIn.provider.getHasNoSky() ? 10 : 30) : 0);
-    }
-
-    public int getMixedBrightnessForBlock(IBlockAccess worldIn, BlockPos pos)
-    {
-        int var3 = worldIn.getCombinedLight(pos, 0);
-        int var4 = worldIn.getCombinedLight(pos.offsetUp(), 0);
-        int var5 = var3 & 255;
-        int var6 = var4 & 255;
-        int var7 = var3 >> 16 & 255;
-        int var8 = var4 >> 16 & 255;
-        return (var5 > var6 ? var5 : var6) | (var7 > var8 ? var7 : var8) << 16;
-    }
-
-    public EnumWorldBlockLayer getBlockLayer()
-    {
-        return this.blockMaterial == Material.water ? EnumWorldBlockLayer.TRANSLUCENT : EnumWorldBlockLayer.SOLID;
-    }
-
-    public void randomDisplayTick(World worldIn, BlockPos pos, IBlockState state, Random rand)
-    {
-        double var5 = (double)pos.getX();
-        double var7 = (double)pos.getY();
-        double var9 = (double)pos.getZ();
-
-        if (this.blockMaterial == Material.water)
-        {
-            int var11 = ((Integer)state.getValue(LEVEL)).intValue();
-
-            if (var11 > 0 && var11 < 8)
-            {
-                if (rand.nextInt(64) == 0)
-                {
-                    worldIn.playSound(var5 + 0.5D, var7 + 0.5D, var9 + 0.5D, "liquid.water", rand.nextFloat() * 0.25F + 0.75F, rand.nextFloat() * 1.0F + 0.5F, false);
-                }
-            }
-            else if (rand.nextInt(10) == 0)
-            {
-                worldIn.spawnParticle(EnumParticleTypes.SUSPENDED, var5 + (double)rand.nextFloat(), var7 + (double)rand.nextFloat(), var9 + (double)rand.nextFloat(), 0.0D, 0.0D, 0.0D, new int[0]);
-            }
-        }
-
-        if (this.blockMaterial == Material.lava && worldIn.getBlockState(pos.offsetUp()).getBlock().getMaterial() == Material.air && !worldIn.getBlockState(pos.offsetUp()).getBlock().isOpaqueCube())
-        {
-            if (rand.nextInt(100) == 0)
-            {
-                double var18 = var5 + (double)rand.nextFloat();
-                double var13 = var7 + this.maxY;
-                double var15 = var9 + (double)rand.nextFloat();
-                worldIn.spawnParticle(EnumParticleTypes.LAVA, var18, var13, var15, 0.0D, 0.0D, 0.0D, new int[0]);
-                worldIn.playSound(var18, var13, var15, "liquid.lavapop", 0.2F + rand.nextFloat() * 0.2F, 0.9F + rand.nextFloat() * 0.15F, false);
-            }
-
-            if (rand.nextInt(200) == 0)
-            {
-                worldIn.playSound(var5, var7, var9, "liquid.lava", 0.2F + rand.nextFloat() * 0.2F, 0.9F + rand.nextFloat() * 0.15F, false);
-            }
-        }
-
-        if (rand.nextInt(10) == 0 && World.doesBlockHaveSolidTopSurface(worldIn, pos.offsetDown()))
-        {
-            Material var19 = worldIn.getBlockState(pos.offsetDown(2)).getBlock().getMaterial();
-
-            if (!var19.blocksMovement() && !var19.isLiquid())
-            {
-                double var12 = var5 + (double)rand.nextFloat();
-                double var14 = var7 - 1.05D;
-                double var16 = var9 + (double)rand.nextFloat();
-
-                if (this.blockMaterial == Material.water)
-                {
-                    worldIn.spawnParticle(EnumParticleTypes.DRIP_WATER, var12, var14, var16, 0.0D, 0.0D, 0.0D, new int[0]);
-                }
-                else
-                {
-                    worldIn.spawnParticle(EnumParticleTypes.DRIP_LAVA, var12, var14, var16, 0.0D, 0.0D, 0.0D, new int[0]);
-                }
-            }
-        }
-    }
-
-    public static double func_180689_a(IBlockAccess p_180689_0_, BlockPos p_180689_1_, Material p_180689_2_)
-    {
-        Vec3 var3 = getDynamicLiquidForMaterial(p_180689_2_).func_180687_h(p_180689_0_, p_180689_1_);
-        return var3.xCoord == 0.0D && var3.zCoord == 0.0D ? -1000.0D : Math.atan2(var3.zCoord, var3.xCoord) - (Math.PI / 2D);
-    }
-
-    public void onBlockAdded(World worldIn, BlockPos pos, IBlockState state)
-    {
-        this.func_176365_e(worldIn, pos, state);
-    }
-
-    public void onNeighborBlockChange(World worldIn, BlockPos pos, IBlockState state, Block neighborBlock)
-    {
-        this.func_176365_e(worldIn, pos, state);
-    }
-
-    public boolean func_176365_e(World worldIn, BlockPos p_176365_2_, IBlockState p_176365_3_)
-    {
-        if (this.blockMaterial == Material.lava)
-        {
-            boolean var4 = false;
-            EnumFacing[] var5 = EnumFacing.values();
-            int var6 = var5.length;
-
-            for (int var7 = 0; var7 < var6; ++var7)
-            {
-                EnumFacing var8 = var5[var7];
-
-                if (var8 != EnumFacing.DOWN && worldIn.getBlockState(p_176365_2_.offset(var8)).getBlock().getMaterial() == Material.water)
-                {
-                    var4 = true;
-                    break;
-                }
-            }
-
-            if (var4)
-            {
-                Integer var9 = (Integer)p_176365_3_.getValue(LEVEL);
-
-                if (var9.intValue() == 0)
-                {
-                    worldIn.setBlockState(p_176365_2_, Blocks.obsidian.getDefaultState());
-                    this.func_180688_d(worldIn, p_176365_2_);
-                    return true;
-                }
-
-                if (var9.intValue() <= 4)
-                {
-                    worldIn.setBlockState(p_176365_2_, Blocks.cobblestone.getDefaultState());
-                    this.func_180688_d(worldIn, p_176365_2_);
-                    return true;
-                }
-            }
-        }
-
-        return false;
-    }
-
-    protected void func_180688_d(World worldIn, BlockPos p_180688_2_)
-    {
-        double var3 = (double)p_180688_2_.getX();
-        double var5 = (double)p_180688_2_.getY();
-        double var7 = (double)p_180688_2_.getZ();
-        worldIn.playSoundEffect(var3 + 0.5D, var5 + 0.5D, var7 + 0.5D, "random.fizz", 0.5F, 2.6F + (worldIn.rand.nextFloat() - worldIn.rand.nextFloat()) * 0.8F);
-
-        for (int var9 = 0; var9 < 8; ++var9)
-        {
-            worldIn.spawnParticle(EnumParticleTypes.SMOKE_LARGE, var3 + Math.random(), var5 + 1.2D, var7 + Math.random(), 0.0D, 0.0D, 0.0D, new int[0]);
-        }
-    }
-
-    /**
-     * Convert the given metadata into a BlockState for this Block
-     */
-    public IBlockState getStateFromMeta(int meta)
-    {
-        return this.getDefaultState().withProperty(LEVEL, Integer.valueOf(meta));
-    }
-
-    /**
-     * Convert the BlockState into the correct metadata value
-     */
-    public int getMetaFromState(IBlockState state)
-    {
-        return ((Integer)state.getValue(LEVEL)).intValue();
-    }
-
-    protected BlockState createBlockState()
-    {
-        return new BlockState(this, new IProperty[] {LEVEL});
-    }
-
-    public static BlockDynamicLiquid getDynamicLiquidForMaterial(Material p_176361_0_)
-    {
-        if (p_176361_0_ == Material.water)
-        {
-            return Blocks.flowing_water;
-        }
-        else if (p_176361_0_ == Material.lava)
-        {
-            return Blocks.flowing_lava;
-        }
-        else
-        {
-            throw new IllegalArgumentException("Invalid material");
-        }
-    }
-
-    public static BlockStaticLiquid getStaticLiquidForMaterial(Material p_176363_0_)
-    {
-        if (p_176363_0_ == Material.water)
-        {
-            return Blocks.water;
-        }
-        else if (p_176363_0_ == Material.lava)
-        {
-            return Blocks.lava;
-        }
-        else
-        {
-            throw new IllegalArgumentException("Invalid material");
-        }
-    }
-}
+package net.minecraft.block;
+
+import java.util.Iterator;
+import java.util.Random;
+
+import net.minecraft.block.material.Material;
+import net.minecraft.block.properties.IProperty;
+import net.minecraft.block.properties.PropertyInteger;
+import net.minecraft.block.state.BlockState;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.entity.Entity;
+import net.minecraft.init.Blocks;
+import net.minecraft.item.Item;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.EnumParticleTypes;
+import net.minecraft.util.EnumWorldBlockLayer;
+import net.minecraft.util.Vec3;
+import net.minecraft.world.IBlockAccess;
+import net.minecraft.world.World;
+import net.minecraft.world.biome.BiomeColorHelper;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.JesusMod;
+import tk.wurst_client.mods.LiquidsMod;
+import tk.wurst_client.mods.XRayMod;
+
+public abstract class BlockLiquid extends Block
+{
+    public static final PropertyInteger LEVEL = PropertyInteger.create("level", 0, 15);
+    private static final String __OBFID = "CL_00000265";
+
+    protected BlockLiquid(Material p_i45413_1_)
+    {
+        super(p_i45413_1_);
+        this.setDefaultState(this.blockState.getBaseState().withProperty(LEVEL, Integer.valueOf(0)));
+        this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
+        this.setTickRandomly(true);
+    }
+
+    public boolean isPassable(IBlockAccess blockAccess, BlockPos pos)
+    {
+    	//TODO: Client
+        return WurstClient.INSTANCE.modManager.getModByClass(XRayMod.class).isEnabled() ? true : this.blockMaterial != Material.lava;
+    }
+
+    public int colorMultiplier(IBlockAccess worldIn, BlockPos pos, int renderPass)
+    {
+        return this.blockMaterial == Material.water ? BiomeColorHelper.func_180288_c(worldIn, pos) : 16777215;
+    }
+
+    /**
+     * Returns the percentage of the liquid block that is air, based on the given flow decay of the liquid
+     */
+    public static float getLiquidHeightPercent(int p_149801_0_)
+    {
+        if (p_149801_0_ >= 8)
+        {
+            p_149801_0_ = 0;
+        }
+
+        return (float)(p_149801_0_ + 1) / 9.0F;
+    }
+
+    protected int func_176362_e(IBlockAccess p_176362_1_, BlockPos p_176362_2_)
+    {
+        return p_176362_1_.getBlockState(p_176362_2_).getBlock().getMaterial() == this.blockMaterial ? ((Integer)p_176362_1_.getBlockState(p_176362_2_).getValue(LEVEL)).intValue() : -1;
+    }
+
+    protected int func_176366_f(IBlockAccess p_176366_1_, BlockPos p_176366_2_)
+    {
+        int var3 = this.func_176362_e(p_176366_1_, p_176366_2_);
+        return var3 >= 8 ? 0 : var3;
+    }
+
+    public boolean isFullCube()
+    {
+        return false;
+    }
+
+    public boolean isOpaqueCube()
+    {
+        return false;
+    }
+
+    public boolean canCollideCheck(IBlockState state, boolean p_176209_2_)
+    {
+    	//TODO: Client
+        return (p_176209_2_ && ((Integer)state.getValue(LEVEL)).intValue() == 0) || WurstClient.INSTANCE.modManager.getModByClass(LiquidsMod.class).isEnabled();
+    }
+
+    /**
+     * Whether this Block is solid on the given Side
+     */
+    public boolean isBlockSolid(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
+    {
+        Material var4 = worldIn.getBlockState(pos).getBlock().getMaterial();
+        return var4 == this.blockMaterial ? false : (side == EnumFacing.UP ? true : (var4 == Material.ice ? false : super.isBlockSolid(worldIn, pos, side)));
+    }
+
+    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
+    {
+        return worldIn.getBlockState(pos).getBlock().getMaterial() == this.blockMaterial ? false : (side == EnumFacing.UP ? true : super.shouldSideBeRendered(worldIn, pos, side));
+    }
+
+    public boolean func_176364_g(IBlockAccess p_176364_1_, BlockPos p_176364_2_)
+    {
+        for (int var3 = -1; var3 <= 1; ++var3)
+        {
+            for (int var4 = -1; var4 <= 1; ++var4)
+            {
+                IBlockState var5 = p_176364_1_.getBlockState(p_176364_2_.add(var3, 0, var4));
+                Block var6 = var5.getBlock();
+                Material var7 = var6.getMaterial();
+
+                if (var7 != this.blockMaterial && !var6.isFullBlock())
+                {
+                    return true;
+                }
+            }
+        }
+
+        return false;
+    }
+
+    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
+    {
+    	//TODO: Client
+    	return WurstClient.INSTANCE.modManager.getModByClass(JesusMod.class).isEnabled() ? AxisAlignedBB.fromBounds(pos.getX() + minX, pos.getY() + minY, pos.getZ() + minZ, pos.getX() + maxX, pos.getY() + maxY, pos.getZ() + maxZ) : null;
+    }
+
+    /**
+     * The type of render function that is called for this block
+     */
+    public int getRenderType()
+    {
+        return 1;
+    }
+
+    /**
+     * Get the Item that this Block should drop when harvested.
+     *  
+     * @param fortune the level of the Fortune enchantment on the player's tool
+     */
+    public Item getItemDropped(IBlockState state, Random rand, int fortune)
+    {
+        return null;
+    }
+
+    /**
+     * Returns the quantity of items to drop on block destruction.
+     */
+    public int quantityDropped(Random random)
+    {
+        return 0;
+    }
+
+    protected Vec3 func_180687_h(IBlockAccess p_180687_1_, BlockPos p_180687_2_)
+    {
+        Vec3 var3 = new Vec3(0.0D, 0.0D, 0.0D);
+        int var4 = this.func_176366_f(p_180687_1_, p_180687_2_);
+        Iterator var5 = EnumFacing.Plane.HORIZONTAL.iterator();
+        EnumFacing var6;
+        BlockPos var7;
+
+        while (var5.hasNext())
+        {
+            var6 = (EnumFacing)var5.next();
+            var7 = p_180687_2_.offset(var6);
+            int var8 = this.func_176366_f(p_180687_1_, var7);
+            int var9;
+
+            if (var8 < 0)
+            {
+                if (!p_180687_1_.getBlockState(var7).getBlock().getMaterial().blocksMovement())
+                {
+                    var8 = this.func_176366_f(p_180687_1_, var7.offsetDown());
+
+                    if (var8 >= 0)
+                    {
+                        var9 = var8 - (var4 - 8);
+                        var3 = var3.addVector((double)((var7.getX() - p_180687_2_.getX()) * var9), (double)((var7.getY() - p_180687_2_.getY()) * var9), (double)((var7.getZ() - p_180687_2_.getZ()) * var9));
+                    }
+                }
+            }
+            else if (var8 >= 0)
+            {
+                var9 = var8 - var4;
+                var3 = var3.addVector((double)((var7.getX() - p_180687_2_.getX()) * var9), (double)((var7.getY() - p_180687_2_.getY()) * var9), (double)((var7.getZ() - p_180687_2_.getZ()) * var9));
+            }
+        }
+
+        if (((Integer)p_180687_1_.getBlockState(p_180687_2_).getValue(LEVEL)).intValue() >= 8)
+        {
+            var5 = EnumFacing.Plane.HORIZONTAL.iterator();
+
+            while (var5.hasNext())
+            {
+                var6 = (EnumFacing)var5.next();
+                var7 = p_180687_2_.offset(var6);
+
+                if (this.isBlockSolid(p_180687_1_, var7, var6) || this.isBlockSolid(p_180687_1_, var7.offsetUp(), var6))
+                {
+                    var3 = var3.normalize().addVector(0.0D, -6.0D, 0.0D);
+                    break;
+                }
+            }
+        }
+
+        return var3.normalize();
+    }
+
+    public Vec3 modifyAcceleration(World worldIn, BlockPos pos, Entity entityIn, Vec3 motion)
+    {
+        return motion.add(this.func_180687_h(worldIn, pos));
+    }
+
+    /**
+     * How many world ticks before ticking
+     */
+    public int tickRate(World worldIn)
+    {
+        return this.blockMaterial == Material.water ? 5 : (this.blockMaterial == Material.lava ? (worldIn.provider.getHasNoSky() ? 10 : 30) : 0);
+    }
+
+    public int getMixedBrightnessForBlock(IBlockAccess worldIn, BlockPos pos)
+    {
+        int var3 = worldIn.getCombinedLight(pos, 0);
+        int var4 = worldIn.getCombinedLight(pos.offsetUp(), 0);
+        int var5 = var3 & 255;
+        int var6 = var4 & 255;
+        int var7 = var3 >> 16 & 255;
+        int var8 = var4 >> 16 & 255;
+        return (var5 > var6 ? var5 : var6) | (var7 > var8 ? var7 : var8) << 16;
+    }
+
+    public EnumWorldBlockLayer getBlockLayer()
+    {
+        return this.blockMaterial == Material.water ? EnumWorldBlockLayer.TRANSLUCENT : EnumWorldBlockLayer.SOLID;
+    }
+
+    public void randomDisplayTick(World worldIn, BlockPos pos, IBlockState state, Random rand)
+    {
+        double var5 = (double)pos.getX();
+        double var7 = (double)pos.getY();
+        double var9 = (double)pos.getZ();
+
+        if (this.blockMaterial == Material.water)
+        {
+            int var11 = ((Integer)state.getValue(LEVEL)).intValue();
+
+            if (var11 > 0 && var11 < 8)
+            {
+                if (rand.nextInt(64) == 0)
+                {
+                    worldIn.playSound(var5 + 0.5D, var7 + 0.5D, var9 + 0.5D, "liquid.water", rand.nextFloat() * 0.25F + 0.75F, rand.nextFloat() * 1.0F + 0.5F, false);
+                }
+            }
+            else if (rand.nextInt(10) == 0)
+            {
+                worldIn.spawnParticle(EnumParticleTypes.SUSPENDED, var5 + (double)rand.nextFloat(), var7 + (double)rand.nextFloat(), var9 + (double)rand.nextFloat(), 0.0D, 0.0D, 0.0D, new int[0]);
+            }
+        }
+
+        if (this.blockMaterial == Material.lava && worldIn.getBlockState(pos.offsetUp()).getBlock().getMaterial() == Material.air && !worldIn.getBlockState(pos.offsetUp()).getBlock().isOpaqueCube())
+        {
+            if (rand.nextInt(100) == 0)
+            {
+                double var18 = var5 + (double)rand.nextFloat();
+                double var13 = var7 + this.maxY;
+                double var15 = var9 + (double)rand.nextFloat();
+                worldIn.spawnParticle(EnumParticleTypes.LAVA, var18, var13, var15, 0.0D, 0.0D, 0.0D, new int[0]);
+                worldIn.playSound(var18, var13, var15, "liquid.lavapop", 0.2F + rand.nextFloat() * 0.2F, 0.9F + rand.nextFloat() * 0.15F, false);
+            }
+
+            if (rand.nextInt(200) == 0)
+            {
+                worldIn.playSound(var5, var7, var9, "liquid.lava", 0.2F + rand.nextFloat() * 0.2F, 0.9F + rand.nextFloat() * 0.15F, false);
+            }
+        }
+
+        if (rand.nextInt(10) == 0 && World.doesBlockHaveSolidTopSurface(worldIn, pos.offsetDown()))
+        {
+            Material var19 = worldIn.getBlockState(pos.offsetDown(2)).getBlock().getMaterial();
+
+            if (!var19.blocksMovement() && !var19.isLiquid())
+            {
+                double var12 = var5 + (double)rand.nextFloat();
+                double var14 = var7 - 1.05D;
+                double var16 = var9 + (double)rand.nextFloat();
+
+                if (this.blockMaterial == Material.water)
+                {
+                    worldIn.spawnParticle(EnumParticleTypes.DRIP_WATER, var12, var14, var16, 0.0D, 0.0D, 0.0D, new int[0]);
+                }
+                else
+                {
+                    worldIn.spawnParticle(EnumParticleTypes.DRIP_LAVA, var12, var14, var16, 0.0D, 0.0D, 0.0D, new int[0]);
+                }
+            }
+        }
+    }
+
+    public static double func_180689_a(IBlockAccess p_180689_0_, BlockPos p_180689_1_, Material p_180689_2_)
+    {
+        Vec3 var3 = getDynamicLiquidForMaterial(p_180689_2_).func_180687_h(p_180689_0_, p_180689_1_);
+        return var3.xCoord == 0.0D && var3.zCoord == 0.0D ? -1000.0D : Math.atan2(var3.zCoord, var3.xCoord) - (Math.PI / 2D);
+    }
+
+    public void onBlockAdded(World worldIn, BlockPos pos, IBlockState state)
+    {
+        this.func_176365_e(worldIn, pos, state);
+    }
+
+    public void onNeighborBlockChange(World worldIn, BlockPos pos, IBlockState state, Block neighborBlock)
+    {
+        this.func_176365_e(worldIn, pos, state);
+    }
+
+    public boolean func_176365_e(World worldIn, BlockPos p_176365_2_, IBlockState p_176365_3_)
+    {
+        if (this.blockMaterial == Material.lava)
+        {
+            boolean var4 = false;
+            EnumFacing[] var5 = EnumFacing.values();
+            int var6 = var5.length;
+
+            for (int var7 = 0; var7 < var6; ++var7)
+            {
+                EnumFacing var8 = var5[var7];
+
+                if (var8 != EnumFacing.DOWN && worldIn.getBlockState(p_176365_2_.offset(var8)).getBlock().getMaterial() == Material.water)
+                {
+                    var4 = true;
+                    break;
+                }
+            }
+
+            if (var4)
+            {
+                Integer var9 = (Integer)p_176365_3_.getValue(LEVEL);
+
+                if (var9.intValue() == 0)
+                {
+                    worldIn.setBlockState(p_176365_2_, Blocks.obsidian.getDefaultState());
+                    this.func_180688_d(worldIn, p_176365_2_);
+                    return true;
+                }
+
+                if (var9.intValue() <= 4)
+                {
+                    worldIn.setBlockState(p_176365_2_, Blocks.cobblestone.getDefaultState());
+                    this.func_180688_d(worldIn, p_176365_2_);
+                    return true;
+                }
+            }
+        }
+
+        return false;
+    }
+
+    protected void func_180688_d(World worldIn, BlockPos p_180688_2_)
+    {
+        double var3 = (double)p_180688_2_.getX();
+        double var5 = (double)p_180688_2_.getY();
+        double var7 = (double)p_180688_2_.getZ();
+        worldIn.playSoundEffect(var3 + 0.5D, var5 + 0.5D, var7 + 0.5D, "random.fizz", 0.5F, 2.6F + (worldIn.rand.nextFloat() - worldIn.rand.nextFloat()) * 0.8F);
+
+        for (int var9 = 0; var9 < 8; ++var9)
+        {
+            worldIn.spawnParticle(EnumParticleTypes.SMOKE_LARGE, var3 + Math.random(), var5 + 1.2D, var7 + Math.random(), 0.0D, 0.0D, 0.0D, new int[0]);
+        }
+    }
+
+    /**
+     * Convert the given metadata into a BlockState for this Block
+     */
+    public IBlockState getStateFromMeta(int meta)
+    {
+        return this.getDefaultState().withProperty(LEVEL, Integer.valueOf(meta));
+    }
+
+    /**
+     * Convert the BlockState into the correct metadata value
+     */
+    public int getMetaFromState(IBlockState state)
+    {
+        return ((Integer)state.getValue(LEVEL)).intValue();
+    }
+
+    protected BlockState createBlockState()
+    {
+        return new BlockState(this, new IProperty[] {LEVEL});
+    }
+
+    public static BlockDynamicLiquid getDynamicLiquidForMaterial(Material p_176361_0_)
+    {
+        if (p_176361_0_ == Material.water)
+        {
+            return Blocks.flowing_water;
+        }
+        else if (p_176361_0_ == Material.lava)
+        {
+            return Blocks.flowing_lava;
+        }
+        else
+        {
+            throw new IllegalArgumentException("Invalid material");
+        }
+    }
+
+    public static BlockStaticLiquid getStaticLiquidForMaterial(Material p_176363_0_)
+    {
+        if (p_176363_0_ == Material.water)
+        {
+            return Blocks.water;
+        }
+        else if (p_176363_0_ == Material.lava)
+        {
+            return Blocks.lava;
+        }
+        else
+        {
+            throw new IllegalArgumentException("Invalid material");
+        }
+    }
+}
diff --git a/src/net/minecraft/block/BlockSlab.java b/src/net/minecraft/block/BlockSlab.java
index 0c52e06..2318f36 100644
--- a/src/net/minecraft/block/BlockSlab.java
+++ b/src/net/minecraft/block/BlockSlab.java
@@ -1,186 +1,190 @@
-package net.minecraft.block;
-
-import java.util.List;
-import java.util.Random;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.properties.IProperty;
-import net.minecraft.block.properties.PropertyEnum;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.init.Blocks;
-import net.minecraft.item.ItemStack;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.IStringSerializable;
-import net.minecraft.world.IBlockAccess;
-import net.minecraft.world.World;
-
-public abstract class BlockSlab extends Block
-{
-    public static final PropertyEnum HALF_PROP = PropertyEnum.create("half", BlockSlab.EnumBlockHalf.class);
-    private static final String __OBFID = "CL_00000253";
-
-    public BlockSlab(Material p_i45714_1_)
-    {
-        super(p_i45714_1_);
-
-        if (this.isDouble())
-        {
-            this.fullBlock = true;
-        }
-        else
-        {
-            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
-        }
-
-        this.setLightOpacity(255);
-    }
-
-    protected boolean canSilkHarvest()
-    {
-        return false;
-    }
-
-    public void setBlockBoundsBasedOnState(IBlockAccess access, BlockPos pos)
-    {
-        if (this.isDouble())
-        {
-            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
-        }
-        else
-        {
-            IBlockState var3 = access.getBlockState(pos);
-
-            if (var3.getBlock() == this)
-            {
-                if (var3.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP)
-                {
-                    this.setBlockBounds(0.0F, 0.5F, 0.0F, 1.0F, 1.0F, 1.0F);
-                }
-                else
-                {
-                    this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
-                }
-            }
-        }
-    }
-
-    /**
-     * Sets the block's bounds for rendering it as an item
-     */
-    public void setBlockBoundsForItemRender()
-    {
-        if (this.isDouble())
-        {
-            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
-        }
-        else
-        {
-            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
-        }
-    }
-
-    /**
-     * Add all collision boxes of this Block to the list that intersect with the given mask.
-     *  
-     * @param collidingEntity the Entity colliding with this Block
-     */
-    public void addCollisionBoxesToList(World worldIn, BlockPos pos, IBlockState state, AxisAlignedBB mask, List list, Entity collidingEntity)
-    {
-        this.setBlockBoundsBasedOnState(worldIn, pos);
-        super.addCollisionBoxesToList(worldIn, pos, state, mask, list, collidingEntity);
-    }
-
-    public boolean isOpaqueCube()
-    {
-        return this.isDouble();
-    }
-
-    public IBlockState onBlockPlaced(World worldIn, BlockPos pos, EnumFacing facing, float hitX, float hitY, float hitZ, int meta, EntityLivingBase placer)
-    {
-        IBlockState var9 = super.onBlockPlaced(worldIn, pos, facing, hitX, hitY, hitZ, meta, placer).withProperty(HALF_PROP, BlockSlab.EnumBlockHalf.BOTTOM);
-        return this.isDouble() ? var9 : (facing != EnumFacing.DOWN && (facing == EnumFacing.UP || (double)hitY <= 0.5D) ? var9 : var9.withProperty(HALF_PROP, BlockSlab.EnumBlockHalf.TOP));
-    }
-
-    /**
-     * Returns the quantity of items to drop on block destruction.
-     */
-    public int quantityDropped(Random random)
-    {
-        return this.isDouble() ? 2 : 1;
-    }
-
-    public boolean isFullCube()
-    {
-        return this.isDouble();
-    }
-
-    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
-    {
-        if (this.isDouble())
-        {
-            return super.shouldSideBeRendered(worldIn, pos, side);
-        }
-        else if (side != EnumFacing.UP && side != EnumFacing.DOWN && !super.shouldSideBeRendered(worldIn, pos, side))
-        {
-            return false;
-        }
-        else
-        {
-            BlockPos var4 = pos.offset(side.getOpposite());
-            IBlockState var5 = worldIn.getBlockState(pos);
-            IBlockState var6 = worldIn.getBlockState(var4);
-            boolean var7 = func_150003_a(var5.getBlock()) && var5.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP;
-            boolean var8 = func_150003_a(var6.getBlock()) && var6.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP;
-            return var8 ? (side == EnumFacing.DOWN ? true : (side == EnumFacing.UP && super.shouldSideBeRendered(worldIn, pos, side) ? true : !func_150003_a(var5.getBlock()) || !var7)) : (side == EnumFacing.UP ? true : (side == EnumFacing.DOWN && super.shouldSideBeRendered(worldIn, pos, side) ? true : !func_150003_a(var5.getBlock()) || var7));
-        }
-    }
-
-    protected static boolean func_150003_a(Block p_150003_0_)
-    {
-        return p_150003_0_ == Blocks.stone_slab || p_150003_0_ == Blocks.wooden_slab || p_150003_0_ == Blocks.stone_slab2;
-    }
-
-    /**
-     * Returns the slab block name with the type associated with it
-     */
-    public abstract String getFullSlabName(int p_150002_1_);
-
-    public int getDamageValue(World worldIn, BlockPos pos)
-    {
-        return super.getDamageValue(worldIn, pos) & 7;
-    }
-
-    public abstract boolean isDouble();
-
-    public abstract IProperty func_176551_l();
-
-    public abstract Object func_176553_a(ItemStack p_176553_1_);
-
-    public static enum EnumBlockHalf implements IStringSerializable
-    {
-        TOP("TOP", 0, "top"),
-        BOTTOM("BOTTOM", 1, "bottom");
-        private final String halfName;
-
-        private static final BlockSlab.EnumBlockHalf[] $VALUES = new BlockSlab.EnumBlockHalf[]{TOP, BOTTOM};
-        private static final String __OBFID = "CL_00002109";
-
-        private EnumBlockHalf(String p_i45713_1_, int p_i45713_2_, String p_i45713_3_)
-        {
-            this.halfName = p_i45713_3_;
-        }
-
-        public String toString()
-        {
-            return this.halfName;
-        }
-
-        public String getName()
-        {
-            return this.halfName;
-        }
-    }
-}
+package net.minecraft.block;
+
+import java.util.List;
+import java.util.Random;
+
+import net.minecraft.block.material.Material;
+import net.minecraft.block.properties.IProperty;
+import net.minecraft.block.properties.PropertyEnum;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.init.Blocks;
+import net.minecraft.item.ItemStack;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.IStringSerializable;
+import net.minecraft.world.IBlockAccess;
+import net.minecraft.world.World;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.FreecamMod;
+
+public abstract class BlockSlab extends Block
+{
+    public static final PropertyEnum HALF_PROP = PropertyEnum.create("half", BlockSlab.EnumBlockHalf.class);
+    private static final String __OBFID = "CL_00000253";
+
+    public BlockSlab(Material p_i45714_1_)
+    {
+        super(p_i45714_1_);
+
+        if (this.isDouble())
+        {
+            this.fullBlock = true;
+        }
+        else
+        {
+            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
+        }
+
+        this.setLightOpacity(255);
+    }
+
+    protected boolean canSilkHarvest()
+    {
+        return false;
+    }
+
+    public void setBlockBoundsBasedOnState(IBlockAccess access, BlockPos pos)
+    {
+        if (this.isDouble())
+        {
+            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
+        }
+        else
+        {
+            IBlockState var3 = access.getBlockState(pos);
+
+            if (var3.getBlock() == this)
+            {
+                if (var3.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP)
+                {
+                    this.setBlockBounds(0.0F, 0.5F, 0.0F, 1.0F, 1.0F, 1.0F);
+                }
+                else
+                {
+                    this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
+                }
+            }
+        }
+    }
+
+    /**
+     * Sets the block's bounds for rendering it as an item
+     */
+    public void setBlockBoundsForItemRender()
+    {
+        if (this.isDouble())
+        {
+            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 1.0F, 1.0F);
+        }
+        else
+        {
+            this.setBlockBounds(0.0F, 0.0F, 0.0F, 1.0F, 0.5F, 1.0F);
+        }
+    }
+
+    /**
+     * Add all collision boxes of this Block to the list that intersect with the given mask.
+     *  
+     * @param collidingEntity the Entity colliding with this Block
+     */
+    public void addCollisionBoxesToList(World worldIn, BlockPos pos, IBlockState state, AxisAlignedBB mask, List list, Entity collidingEntity)
+    {
+        this.setBlockBoundsBasedOnState(worldIn, pos);
+        super.addCollisionBoxesToList(worldIn, pos, state, mask, list, collidingEntity);
+    }
+
+    public boolean isOpaqueCube()
+    {
+    	return this.isDouble();
+    }
+
+    public IBlockState onBlockPlaced(World worldIn, BlockPos pos, EnumFacing facing, float hitX, float hitY, float hitZ, int meta, EntityLivingBase placer)
+    {
+        IBlockState var9 = super.onBlockPlaced(worldIn, pos, facing, hitX, hitY, hitZ, meta, placer).withProperty(HALF_PROP, BlockSlab.EnumBlockHalf.BOTTOM);
+        return this.isDouble() ? var9 : (facing != EnumFacing.DOWN && (facing == EnumFacing.UP || (double)hitY <= 0.5D) ? var9 : var9.withProperty(HALF_PROP, BlockSlab.EnumBlockHalf.TOP));
+    }
+
+    /**
+     * Returns the quantity of items to drop on block destruction.
+     */
+    public int quantityDropped(Random random)
+    {
+        return this.isDouble() ? 2 : 1;
+    }
+
+    public boolean isFullCube()
+    {
+    	//TODO: Client
+    	return WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled() ? false : this.isDouble();
+    }
+
+    public boolean shouldSideBeRendered(IBlockAccess worldIn, BlockPos pos, EnumFacing side)
+    {
+        if (this.isDouble())
+        {
+            return super.shouldSideBeRendered(worldIn, pos, side);
+        }
+        else if (side != EnumFacing.UP && side != EnumFacing.DOWN && !super.shouldSideBeRendered(worldIn, pos, side))
+        {
+            return false;
+        }
+        else
+        {
+            BlockPos var4 = pos.offset(side.getOpposite());
+            IBlockState var5 = worldIn.getBlockState(pos);
+            IBlockState var6 = worldIn.getBlockState(var4);
+            boolean var7 = func_150003_a(var5.getBlock()) && var5.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP;
+            boolean var8 = func_150003_a(var6.getBlock()) && var6.getValue(HALF_PROP) == BlockSlab.EnumBlockHalf.TOP;
+            return var8 ? (side == EnumFacing.DOWN ? true : (side == EnumFacing.UP && super.shouldSideBeRendered(worldIn, pos, side) ? true : !func_150003_a(var5.getBlock()) || !var7)) : (side == EnumFacing.UP ? true : (side == EnumFacing.DOWN && super.shouldSideBeRendered(worldIn, pos, side) ? true : !func_150003_a(var5.getBlock()) || var7));
+        }
+    }
+
+    protected static boolean func_150003_a(Block p_150003_0_)
+    {
+        return p_150003_0_ == Blocks.stone_slab || p_150003_0_ == Blocks.wooden_slab || p_150003_0_ == Blocks.stone_slab2;
+    }
+
+    /**
+     * Returns the slab block name with the type associated with it
+     */
+    public abstract String getFullSlabName(int p_150002_1_);
+
+    public int getDamageValue(World worldIn, BlockPos pos)
+    {
+        return super.getDamageValue(worldIn, pos) & 7;
+    }
+
+    public abstract boolean isDouble();
+
+    public abstract IProperty func_176551_l();
+
+    public abstract Object func_176553_a(ItemStack p_176553_1_);
+
+    public static enum EnumBlockHalf implements IStringSerializable
+    {
+        TOP("TOP", 0, "top"),
+        BOTTOM("BOTTOM", 1, "bottom");
+        private final String halfName;
+
+        private static final BlockSlab.EnumBlockHalf[] $VALUES = new BlockSlab.EnumBlockHalf[]{TOP, BOTTOM};
+        private static final String __OBFID = "CL_00002109";
+
+        private EnumBlockHalf(String p_i45713_1_, int p_i45713_2_, String p_i45713_3_)
+        {
+            this.halfName = p_i45713_3_;
+        }
+
+        public String toString()
+        {
+            return this.halfName;
+        }
+
+        public String getName()
+        {
+            return this.halfName;
+        }
+    }
+}
diff --git a/src/net/minecraft/block/BlockSoulSand.java b/src/net/minecraft/block/BlockSoulSand.java
index 6520f1d..9aa788d 100644
--- a/src/net/minecraft/block/BlockSoulSand.java
+++ b/src/net/minecraft/block/BlockSoulSand.java
@@ -1,35 +1,39 @@
-package net.minecraft.block;
-
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.creativetab.CreativeTabs;
-import net.minecraft.entity.Entity;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.world.World;
-
-public class BlockSoulSand extends Block
-{
-    private static final String __OBFID = "CL_00000310";
-
-    public BlockSoulSand()
-    {
-        super(Material.sand);
-        this.setCreativeTab(CreativeTabs.tabBlock);
-    }
-
-    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
-    {
-        float var4 = 0.125F;
-        return new AxisAlignedBB((double)pos.getX(), (double)pos.getY(), (double)pos.getZ(), (double)(pos.getX() + 1), (double)((float)(pos.getY() + 1) - var4), (double)(pos.getZ() + 1));
-    }
-
-    /**
-     * Called When an Entity Collided with the Block
-     */
-    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, IBlockState state, Entity entityIn)
-    {
-        entityIn.motionX *= 0.4D;
-        entityIn.motionZ *= 0.4D;
-    }
-}
+package net.minecraft.block;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.NoSlowdownMod;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.creativetab.CreativeTabs;
+import net.minecraft.entity.Entity;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.world.World;
+
+public class BlockSoulSand extends Block
+{
+    private static final String __OBFID = "CL_00000310";
+
+    public BlockSoulSand()
+    {
+        super(Material.sand);
+        this.setCreativeTab(CreativeTabs.tabBlock);
+    }
+
+    public AxisAlignedBB getCollisionBoundingBox(World worldIn, BlockPos pos, IBlockState state)
+    {
+        float var4 = 0.125F;
+        return new AxisAlignedBB((double)pos.getX(), (double)pos.getY(), (double)pos.getZ(), (double)(pos.getX() + 1), (double)((float)(pos.getY() + 1) - var4), (double)(pos.getZ() + 1));
+    }
+
+    /**
+     * Called When an Entity Collided with the Block
+     */
+    public void onEntityCollidedWithBlock(World worldIn, BlockPos pos, IBlockState state, Entity entityIn)
+    {
+    	if(WurstClient.INSTANCE.modManager.getModByClass(NoSlowdownMod.class).isEnabled())
+    		return;
+        entityIn.motionX *= 0.4D;
+        entityIn.motionZ *= 0.4D;
+    }
+}
diff --git a/src/net/minecraft/client/LoadingScreenRenderer.java b/src/net/minecraft/client/LoadingScreenRenderer.java
index 555f15e..0f81893 100644
--- a/src/net/minecraft/client/LoadingScreenRenderer.java
+++ b/src/net/minecraft/client/LoadingScreenRenderer.java
@@ -160,7 +160,7 @@ public class LoadingScreenRenderer implements IProgressUpdate
                 this.mc.getTextureManager().bindTexture(Gui.optionsBackground);
                 float var10 = 32.0F;
                 var9.startDrawingQuads();
-                var9.func_178991_c(4210752);
+                var9.setColorOpaque_I(4210752);
                 var9.addVertexWithUV(0.0D, (double)var7, 0.0D, 0.0D, (double)((float)var7 / var10));
                 var9.addVertexWithUV((double)var6, (double)var7, 0.0D, (double)((float)var6 / var10), (double)((float)var7 / var10));
                 var9.addVertexWithUV((double)var6, 0.0D, 0.0D, (double)((float)var6 / var10), 0.0D);
@@ -175,12 +175,12 @@ public class LoadingScreenRenderer implements IProgressUpdate
                     int var14 = var7 / 2 + 16;
                     GlStateManager.func_179090_x();
                     var9.startDrawingQuads();
-                    var9.func_178991_c(8421504);
+                    var9.setColorOpaque_I(8421504);
                     var9.addVertex((double)var13, (double)var14, 0.0D);
                     var9.addVertex((double)var13, (double)(var14 + var12), 0.0D);
                     var9.addVertex((double)(var13 + var11), (double)(var14 + var12), 0.0D);
                     var9.addVertex((double)(var13 + var11), (double)var14, 0.0D);
-                    var9.func_178991_c(8454016);
+                    var9.setColorOpaque_I(8454016);
                     var9.addVertex((double)var13, (double)var14, 0.0D);
                     var9.addVertex((double)var13, (double)(var14 + var12), 0.0D);
                     var9.addVertex((double)(var13 + progress), (double)(var14 + var12), 0.0D);
@@ -191,8 +191,8 @@ public class LoadingScreenRenderer implements IProgressUpdate
 
                 GlStateManager.enableBlend();
                 GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                this.mc.fontRendererObj.func_175063_a(this.currentlyDisplayedText, (float)((var6 - this.mc.fontRendererObj.getStringWidth(this.currentlyDisplayedText)) / 2), (float)(var7 / 2 - 4 - 16), 16777215);
-                this.mc.fontRendererObj.func_175063_a(this.field_73727_a, (float)((var6 - this.mc.fontRendererObj.getStringWidth(this.field_73727_a)) / 2), (float)(var7 / 2 - 4 + 8), 16777215);
+                this.mc.fontRendererObj.drawStringWithShadow(this.currentlyDisplayedText, (float)((var6 - this.mc.fontRendererObj.getStringWidth(this.currentlyDisplayedText)) / 2), (float)(var7 / 2 - 4 - 16), 16777215);
+                this.mc.fontRendererObj.drawStringWithShadow(this.field_73727_a, (float)((var6 - this.mc.fontRendererObj.getStringWidth(this.field_73727_a)) / 2), (float)(var7 / 2 - 4 + 8), 16777215);
                 this.field_146588_g.unbindFramebuffer();
 
                 if (OpenGlHelper.isFramebufferEnabled())
diff --git a/src/net/minecraft/client/Minecraft.java b/src/net/minecraft/client/Minecraft.java
index f503b64..3794d1b 100644
--- a/src/net/minecraft/client/Minecraft.java
+++ b/src/net/minecraft/client/Minecraft.java
@@ -1,3306 +1,3546 @@
-package net.minecraft.client;
-
-import com.google.common.collect.Iterables;
-import com.google.common.collect.Lists;
-import com.google.common.collect.Maps;
-import com.google.common.collect.Queues;
-import com.google.common.collect.Sets;
-import com.google.common.util.concurrent.Futures;
-import com.google.common.util.concurrent.ListenableFuture;
-import com.google.common.util.concurrent.ListenableFutureTask;
-import com.mojang.authlib.minecraft.MinecraftSessionService;
-import com.mojang.authlib.properties.Property;
-import com.mojang.authlib.properties.PropertyMap;
-import com.mojang.authlib.yggdrasil.YggdrasilAuthenticationService;
-import java.awt.image.BufferedImage;
-import java.io.File;
-import java.io.IOException;
-import java.io.InputStream;
-import java.net.Proxy;
-import java.net.SocketAddress;
-import java.nio.ByteBuffer;
-import java.nio.ByteOrder;
-import java.text.DecimalFormat;
-import java.text.SimpleDateFormat;
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.Date;
-import java.util.HashMap;
-import java.util.HashSet;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Queue;
-import java.util.UUID;
-import java.util.concurrent.Callable;
-import java.util.concurrent.Executors;
-import java.util.concurrent.FutureTask;
-import javax.imageio.ImageIO;
-import net.minecraft.block.Block;
-import net.minecraft.block.material.Material;
-import net.minecraft.client.audio.MusicTicker;
-import net.minecraft.client.audio.SoundHandler;
-import net.minecraft.client.entity.EntityPlayerSP;
-import net.minecraft.client.gui.FontRenderer;
-import net.minecraft.client.gui.GuiChat;
-import net.minecraft.client.gui.GuiControls;
-import net.minecraft.client.gui.GuiGameOver;
-import net.minecraft.client.gui.GuiIngame;
-import net.minecraft.client.gui.GuiIngameMenu;
-import net.minecraft.client.gui.GuiMainMenu;
-import net.minecraft.client.gui.GuiMemoryErrorScreen;
-import net.minecraft.client.gui.GuiScreen;
-import net.minecraft.client.gui.GuiSleepMP;
-import net.minecraft.client.gui.GuiWinGame;
-import net.minecraft.client.gui.GuiYesNo;
-import net.minecraft.client.gui.GuiYesNoCallback;
-import net.minecraft.client.gui.ScaledResolution;
-import net.minecraft.client.gui.achievement.GuiAchievement;
-import net.minecraft.client.gui.inventory.GuiInventory;
-import net.minecraft.client.gui.stream.GuiStreamUnavailable;
-import net.minecraft.client.main.GameConfiguration;
-import net.minecraft.client.multiplayer.GuiConnecting;
-import net.minecraft.client.multiplayer.PlayerControllerMP;
-import net.minecraft.client.multiplayer.ServerData;
-import net.minecraft.client.multiplayer.WorldClient;
-import net.minecraft.client.network.NetHandlerLoginClient;
-import net.minecraft.client.network.NetHandlerPlayClient;
-import net.minecraft.client.particle.EffectRenderer;
-import net.minecraft.client.renderer.BlockRendererDispatcher;
-import net.minecraft.client.renderer.EntityRenderer;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.ItemRenderer;
-import net.minecraft.client.renderer.OpenGlHelper;
-import net.minecraft.client.renderer.RenderGlobal;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.chunk.RenderChunk;
-import net.minecraft.client.renderer.entity.RenderItem;
-import net.minecraft.client.renderer.entity.RenderManager;
-import net.minecraft.client.renderer.texture.DynamicTexture;
-import net.minecraft.client.renderer.texture.TextureManager;
-import net.minecraft.client.renderer.texture.TextureMap;
-import net.minecraft.client.resources.DefaultResourcePack;
-import net.minecraft.client.resources.FoliageColorReloadListener;
-import net.minecraft.client.resources.GrassColorReloadListener;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.client.resources.IReloadableResourceManager;
-import net.minecraft.client.resources.IResourceManager;
-import net.minecraft.client.resources.LanguageManager;
-import net.minecraft.client.resources.ResourceIndex;
-import net.minecraft.client.resources.ResourcePackRepository;
-import net.minecraft.client.resources.SimpleReloadableResourceManager;
-import net.minecraft.client.resources.SkinManager;
-import net.minecraft.client.resources.data.AnimationMetadataSection;
-import net.minecraft.client.resources.data.AnimationMetadataSectionSerializer;
-import net.minecraft.client.resources.data.FontMetadataSection;
-import net.minecraft.client.resources.data.FontMetadataSectionSerializer;
-import net.minecraft.client.resources.data.IMetadataSerializer;
-import net.minecraft.client.resources.data.LanguageMetadataSection;
-import net.minecraft.client.resources.data.LanguageMetadataSectionSerializer;
-import net.minecraft.client.resources.data.PackMetadataSection;
-import net.minecraft.client.resources.data.PackMetadataSectionSerializer;
-import net.minecraft.client.resources.data.TextureMetadataSection;
-import net.minecraft.client.resources.data.TextureMetadataSectionSerializer;
-import net.minecraft.client.resources.model.ModelManager;
-import net.minecraft.client.settings.GameSettings;
-import net.minecraft.client.settings.KeyBinding;
-import net.minecraft.client.shader.Framebuffer;
-import net.minecraft.client.stream.IStream;
-import net.minecraft.client.stream.NullStream;
-import net.minecraft.client.stream.TwitchStream;
-import net.minecraft.crash.CrashReport;
-import net.minecraft.crash.CrashReportCategory;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLeashKnot;
-import net.minecraft.entity.EntityList;
-import net.minecraft.entity.boss.BossStatus;
-import net.minecraft.entity.item.EntityArmorStand;
-import net.minecraft.entity.item.EntityBoat;
-import net.minecraft.entity.item.EntityItemFrame;
-import net.minecraft.entity.item.EntityMinecart;
-import net.minecraft.entity.item.EntityPainting;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.entity.player.InventoryPlayer;
-import net.minecraft.init.Bootstrap;
-import net.minecraft.init.Items;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemBlock;
-import net.minecraft.item.ItemStack;
-import net.minecraft.nbt.NBTTagCompound;
-import net.minecraft.nbt.NBTTagList;
-import net.minecraft.nbt.NBTTagString;
-import net.minecraft.network.EnumConnectionState;
-import net.minecraft.network.NetworkManager;
-import net.minecraft.network.handshake.client.C00Handshake;
-import net.minecraft.network.login.client.C00PacketLoginStart;
-import net.minecraft.network.play.client.C16PacketClientStatus;
-import net.minecraft.profiler.IPlayerUsage;
-import net.minecraft.profiler.PlayerUsageSnooper;
-import net.minecraft.profiler.Profiler;
-import net.minecraft.server.MinecraftServer;
-import net.minecraft.server.integrated.IntegratedServer;
-import net.minecraft.stats.AchievementList;
-import net.minecraft.stats.IStatStringFormat;
-import net.minecraft.stats.StatFileWriter;
-import net.minecraft.tileentity.TileEntity;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.IThreadListener;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.MinecraftError;
-import net.minecraft.util.MouseHelper;
-import net.minecraft.util.MovementInputFromOptions;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ReportedException;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.ScreenShotHelper;
-import net.minecraft.util.Session;
-import net.minecraft.util.Timer;
-import net.minecraft.util.Util;
-import net.minecraft.world.EnumDifficulty;
-import net.minecraft.world.WorldProviderEnd;
-import net.minecraft.world.WorldProviderHell;
-import net.minecraft.world.WorldSettings;
-import net.minecraft.world.chunk.storage.AnvilSaveConverter;
-import net.minecraft.world.storage.ISaveFormat;
-import net.minecraft.world.storage.ISaveHandler;
-import net.minecraft.world.storage.WorldInfo;
-import org.apache.commons.io.IOUtils;
-import org.apache.commons.lang3.Validate;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.LWJGLException;
-import org.lwjgl.Sys;
-import org.lwjgl.input.Keyboard;
-import org.lwjgl.input.Mouse;
-import org.lwjgl.opengl.ContextCapabilities;
-import org.lwjgl.opengl.Display;
-import org.lwjgl.opengl.DisplayMode;
-import org.lwjgl.opengl.GL11;
-import org.lwjgl.opengl.GL20;
-import org.lwjgl.opengl.GLContext;
-import org.lwjgl.opengl.OpenGLException;
-import org.lwjgl.opengl.PixelFormat;
-import org.lwjgl.util.glu.GLU;
-
-public class Minecraft implements IThreadListener, IPlayerUsage
-{
-    private static final Logger logger = LogManager.getLogger();
-    private static final ResourceLocation locationMojangPng = new ResourceLocation("textures/gui/title/mojang.png");
-    public static final boolean isRunningOnMac = Util.getOSType() == Util.EnumOS.OSX;
-
-    /** A 10MiB preallocation to ensure the heap is reasonably sized. */
-    public static byte[] memoryReserve = new byte[10485760];
-    private static final List macDisplayModes = Lists.newArrayList(new DisplayMode[] {new DisplayMode(2560, 1600), new DisplayMode(2880, 1800)});
-    private final File fileResourcepacks;
-    private final PropertyMap twitchDetails;
-    private ServerData currentServerData;
-
-    /** The RenderEngine instance used by Minecraft */
-    private TextureManager renderEngine;
-
-    /**
-     * Set to 'this' in Minecraft constructor; used by some settings get methods
-     */
-    private static Minecraft theMinecraft;
-    public PlayerControllerMP playerController;
-    private boolean fullscreen;
-    private boolean field_175619_R = true;
-    private boolean hasCrashed;
-
-    /** Instance of CrashReport. */
-    private CrashReport crashReporter;
-    public int displayWidth;
-    public int displayHeight;
-    private Timer timer = new Timer(20.0F);
-
-    /** Instance of PlayerUsageSnooper. */
-    private PlayerUsageSnooper usageSnooper = new PlayerUsageSnooper("client", this, MinecraftServer.getCurrentTimeMillis());
-    public WorldClient theWorld;
-    public RenderGlobal renderGlobal;
-    private RenderManager renderManager;
-    private RenderItem renderItem;
-    private ItemRenderer itemRenderer;
-    public EntityPlayerSP thePlayer;
-    private Entity field_175622_Z;
-    public Entity pointedEntity;
-    public EffectRenderer effectRenderer;
-    private final Session session;
-    private boolean isGamePaused;
-
-    /** The font renderer used for displaying and measuring text */
-    public FontRenderer fontRendererObj;
-    public FontRenderer standardGalacticFontRenderer;
-
-    /** The GuiScreen that's being displayed at the moment. */
-    public GuiScreen currentScreen;
-    public LoadingScreenRenderer loadingScreen;
-    public EntityRenderer entityRenderer;
-
-    /** Mouse left click counter */
-    private int leftClickCounter;
-
-    /** Display width */
-    private int tempDisplayWidth;
-
-    /** Display height */
-    private int tempDisplayHeight;
-
-    /** Instance of IntegratedServer. */
-    private IntegratedServer theIntegratedServer;
-
-    /** Gui achievement */
-    public GuiAchievement guiAchievement;
-    public GuiIngame ingameGUI;
-
-    /** Skip render world */
-    public boolean skipRenderWorld;
-
-    /** The ray trace hit that the mouse is over. */
-    public MovingObjectPosition objectMouseOver;
-
-    /** The game settings that currently hold effect. */
-    public GameSettings gameSettings;
-
-    /** Mouse helper instance. */
-    public MouseHelper mouseHelper;
-    public final File mcDataDir;
-    private final File fileAssets;
-    private final String launchedVersion;
-    private final Proxy proxy;
-    private ISaveFormat saveLoader;
-
-    /**
-     * This is set to fpsCounter every debug screen update, and is shown on the debug screen. It's also sent as part of
-     * the usage snooping.
-     */
-    private static int debugFPS;
-
-    /**
-     * When you place a block, it's set to 6, decremented once per tick, when it's 0, you can place another block.
-     */
-    private int rightClickDelayTimer;
-    private String serverName;
-    private int serverPort;
-
-    /**
-     * Does the actual gameplay have focus. If so then mouse and keys will effect the player instead of menus.
-     */
-    public boolean inGameHasFocus;
-    long systemTime = getSystemTime();
-
-    /** Join player counter */
-    private int joinPlayerCounter;
-    private final boolean jvm64bit;
-    private final boolean isDemo;
-    private NetworkManager myNetworkManager;
-    private boolean integratedServerIsRunning;
-
-    /** The profiler instance */
-    public final Profiler mcProfiler = new Profiler();
-
-    /**
-     * Keeps track of how long the debug crash keycombo (F3+C) has been pressed for, in order to crash after 10 seconds.
-     */
-    private long debugCrashKeyPressTime = -1L;
-    private IReloadableResourceManager mcResourceManager;
-    private final IMetadataSerializer metadataSerializer_ = new IMetadataSerializer();
-    private final List defaultResourcePacks = Lists.newArrayList();
-    private final DefaultResourcePack mcDefaultResourcePack;
-    private ResourcePackRepository mcResourcePackRepository;
-    private LanguageManager mcLanguageManager;
-    private IStream stream;
-    private Framebuffer framebufferMc;
-    private TextureMap textureMapBlocks;
-    private SoundHandler mcSoundHandler;
-    private MusicTicker mcMusicTicker;
-    private ResourceLocation mojangLogo;
-    private final MinecraftSessionService sessionService;
-    private SkinManager skinManager;
-    private final Queue scheduledTasks = Queues.newArrayDeque();
-    private long field_175615_aJ = 0L;
-    private final Thread mcThread = Thread.currentThread();
-    private ModelManager modelManager;
-    private BlockRendererDispatcher field_175618_aM;
-
-    /**
-     * Set to true to keep the game loop running. Set to false by shutdown() to allow the game loop to exit cleanly.
-     */
-    volatile boolean running = true;
-
-    /** String that shows the debug information */
-    public String debug = "";
-    public boolean field_175613_B = false;
-    public boolean field_175614_C = false;
-    public boolean field_175611_D = false;
-    public boolean field_175612_E = true;
-
-    /** Approximate time (in ms) of last update to debug string */
-    long debugUpdateTime = getSystemTime();
-
-    /** holds the current fps */
-    int fpsCounter;
-    long prevFrameTime = -1L;
-
-    /** Profiler currently displayed in the debug screen pie chart */
-    private String debugProfilerName = "root";
-    private static final String __OBFID = "CL_00000631";
-
-    public Minecraft(GameConfiguration p_i45547_1_)
-    {
-        theMinecraft = this;
-        this.mcDataDir = p_i45547_1_.field_178744_c.field_178760_a;
-        this.fileAssets = p_i45547_1_.field_178744_c.field_178759_c;
-        this.fileResourcepacks = p_i45547_1_.field_178744_c.field_178758_b;
-        this.launchedVersion = p_i45547_1_.field_178741_d.field_178755_b;
-        this.twitchDetails = p_i45547_1_.field_178745_a.field_178750_b;
-        this.mcDefaultResourcePack = new DefaultResourcePack((new ResourceIndex(p_i45547_1_.field_178744_c.field_178759_c, p_i45547_1_.field_178744_c.field_178757_d)).func_152782_a());
-        this.proxy = p_i45547_1_.field_178745_a.field_178751_c == null ? Proxy.NO_PROXY : p_i45547_1_.field_178745_a.field_178751_c;
-        this.sessionService = (new YggdrasilAuthenticationService(p_i45547_1_.field_178745_a.field_178751_c, UUID.randomUUID().toString())).createMinecraftSessionService();
-        this.session = p_i45547_1_.field_178745_a.field_178752_a;
-        logger.info("Setting user: " + this.session.getUsername());
-        logger.info("(Session ID is " + this.session.getSessionID() + ")");
-        this.isDemo = p_i45547_1_.field_178741_d.field_178756_a;
-        this.displayWidth = p_i45547_1_.field_178743_b.field_178764_a > 0 ? p_i45547_1_.field_178743_b.field_178764_a : 1;
-        this.displayHeight = p_i45547_1_.field_178743_b.field_178762_b > 0 ? p_i45547_1_.field_178743_b.field_178762_b : 1;
-        this.tempDisplayWidth = p_i45547_1_.field_178743_b.field_178764_a;
-        this.tempDisplayHeight = p_i45547_1_.field_178743_b.field_178762_b;
-        this.fullscreen = p_i45547_1_.field_178743_b.field_178763_c;
-        this.jvm64bit = isJvm64bit();
-        this.theIntegratedServer = new IntegratedServer(this);
-
-        if (p_i45547_1_.field_178742_e.field_178754_a != null)
-        {
-            this.serverName = p_i45547_1_.field_178742_e.field_178754_a;
-            this.serverPort = p_i45547_1_.field_178742_e.field_178753_b;
-        }
-
-        ImageIO.setUseCache(false);
-        Bootstrap.register();
-    }
-
-    public void run()
-    {
-        this.running = true;
-        CrashReport var2;
-
-        try
-        {
-            this.startGame();
-        }
-        catch (Throwable var11)
-        {
-            var2 = CrashReport.makeCrashReport(var11, "Initializing game");
-            var2.makeCategory("Initialization");
-            this.displayCrashReport(this.addGraphicsAndWorldToCrashReport(var2));
-            return;
-        }
-
-        while (true)
-        {
-            try
-            {
-                while (this.running)
-                {
-                    if (!this.hasCrashed || this.crashReporter == null)
-                    {
-                        try
-                        {
-                            this.runGameLoop();
-                        }
-                        catch (OutOfMemoryError var10)
-                        {
-                            this.freeMemory();
-                            this.displayGuiScreen(new GuiMemoryErrorScreen());
-                            System.gc();
-                        }
-
-                        continue;
-                    }
-
-                    this.displayCrashReport(this.crashReporter);
-                    return;
-                }
-            }
-            catch (MinecraftError var12)
-            {
-                ;
-            }
-            catch (ReportedException var13)
-            {
-                this.addGraphicsAndWorldToCrashReport(var13.getCrashReport());
-                this.freeMemory();
-                logger.fatal("Reported exception thrown!", var13);
-                this.displayCrashReport(var13.getCrashReport());
-            }
-            catch (Throwable var14)
-            {
-                var2 = this.addGraphicsAndWorldToCrashReport(new CrashReport("Unexpected error", var14));
-                this.freeMemory();
-                logger.fatal("Unreported exception thrown!", var14);
-                this.displayCrashReport(var2);
-            }
-            finally
-            {
-                this.shutdownMinecraftApplet();
-            }
-
-            return;
-        }
-    }
-
-    /**
-     * Starts the game: initializes the canvas, the title, the settings, etcetera.
-     */
-    private void startGame() throws LWJGLException
-    {
-        this.gameSettings = new GameSettings(this, this.mcDataDir);
-        this.defaultResourcePacks.add(this.mcDefaultResourcePack);
-        this.startTimerHackThread();
-
-        if (this.gameSettings.overrideHeight > 0 && this.gameSettings.overrideWidth > 0)
-        {
-            this.displayWidth = this.gameSettings.overrideWidth;
-            this.displayHeight = this.gameSettings.overrideHeight;
-        }
-
-        logger.info("LWJGL Version: " + Sys.getVersion());
-        this.func_175594_ao();
-        this.func_175605_an();
-        this.func_175609_am();
-        OpenGlHelper.initializeTextures();
-        this.framebufferMc = new Framebuffer(this.displayWidth, this.displayHeight, true);
-        this.framebufferMc.setFramebufferColor(0.0F, 0.0F, 0.0F, 0.0F);
-        this.func_175608_ak();
-        this.mcResourcePackRepository = new ResourcePackRepository(this.fileResourcepacks, new File(this.mcDataDir, "server-resource-packs"), this.mcDefaultResourcePack, this.metadataSerializer_, this.gameSettings);
-        this.mcResourceManager = new SimpleReloadableResourceManager(this.metadataSerializer_);
-        this.mcLanguageManager = new LanguageManager(this.metadataSerializer_, this.gameSettings.language);
-        this.mcResourceManager.registerReloadListener(this.mcLanguageManager);
-        this.refreshResources();
-        this.renderEngine = new TextureManager(this.mcResourceManager);
-        this.mcResourceManager.registerReloadListener(this.renderEngine);
-        this.func_180510_a(this.renderEngine);
-        this.func_175595_al();
-        this.skinManager = new SkinManager(this.renderEngine, new File(this.fileAssets, "skins"), this.sessionService);
-        this.saveLoader = new AnvilSaveConverter(new File(this.mcDataDir, "saves"));
-        this.mcSoundHandler = new SoundHandler(this.mcResourceManager, this.gameSettings);
-        this.mcResourceManager.registerReloadListener(this.mcSoundHandler);
-        this.mcMusicTicker = new MusicTicker(this);
-        this.fontRendererObj = new FontRenderer(this.gameSettings, new ResourceLocation("textures/font/ascii.png"), this.renderEngine, false);
-
-        if (this.gameSettings.language != null)
-        {
-            this.fontRendererObj.setUnicodeFlag(this.isUnicode());
-            this.fontRendererObj.setBidiFlag(this.mcLanguageManager.isCurrentLanguageBidirectional());
-        }
-
-        this.standardGalacticFontRenderer = new FontRenderer(this.gameSettings, new ResourceLocation("textures/font/ascii_sga.png"), this.renderEngine, false);
-        this.mcResourceManager.registerReloadListener(this.fontRendererObj);
-        this.mcResourceManager.registerReloadListener(this.standardGalacticFontRenderer);
-        this.mcResourceManager.registerReloadListener(new GrassColorReloadListener());
-        this.mcResourceManager.registerReloadListener(new FoliageColorReloadListener());
-        AchievementList.openInventory.setStatStringFormatter(new IStatStringFormat()
-        {
-            private static final String __OBFID = "CL_00000632";
-            public String formatString(String p_74535_1_)
-            {
-                try
-                {
-                    return String.format(p_74535_1_, new Object[] {GameSettings.getKeyDisplayString(Minecraft.this.gameSettings.keyBindInventory.getKeyCode())});
-                }
-                catch (Exception var3)
-                {
-                    return "Error: " + var3.getLocalizedMessage();
-                }
-            }
-        });
-        this.mouseHelper = new MouseHelper();
-        this.checkGLError("Pre startup");
-        GlStateManager.func_179098_w();
-        GlStateManager.shadeModel(7425);
-        GlStateManager.clearDepth(1.0D);
-        GlStateManager.enableDepth();
-        GlStateManager.depthFunc(515);
-        GlStateManager.enableAlpha();
-        GlStateManager.alphaFunc(516, 0.1F);
-        GlStateManager.cullFace(1029);
-        GlStateManager.matrixMode(5889);
-        GlStateManager.loadIdentity();
-        GlStateManager.matrixMode(5888);
-        this.checkGLError("Startup");
-        this.textureMapBlocks = new TextureMap("textures");
-        this.textureMapBlocks.setMipmapLevels(this.gameSettings.mipmapLevels);
-        this.renderEngine.loadTickableTexture(TextureMap.locationBlocksTexture, this.textureMapBlocks);
-        this.renderEngine.bindTexture(TextureMap.locationBlocksTexture);
-        this.textureMapBlocks.func_174937_a(false, this.gameSettings.mipmapLevels > 0);
-        this.modelManager = new ModelManager(this.textureMapBlocks);
-        this.mcResourceManager.registerReloadListener(this.modelManager);
-        this.renderItem = new RenderItem(this.renderEngine, this.modelManager);
-        this.renderManager = new RenderManager(this.renderEngine, this.renderItem);
-        this.itemRenderer = new ItemRenderer(this);
-        this.mcResourceManager.registerReloadListener(this.renderItem);
-        this.entityRenderer = new EntityRenderer(this, this.mcResourceManager);
-        this.mcResourceManager.registerReloadListener(this.entityRenderer);
-        this.field_175618_aM = new BlockRendererDispatcher(this.modelManager.getBlockModelShapes(), this.gameSettings);
-        this.mcResourceManager.registerReloadListener(this.field_175618_aM);
-        this.renderGlobal = new RenderGlobal(this);
-        this.mcResourceManager.registerReloadListener(this.renderGlobal);
-        this.guiAchievement = new GuiAchievement(this);
-        GlStateManager.viewport(0, 0, this.displayWidth, this.displayHeight);
-        this.effectRenderer = new EffectRenderer(this.theWorld, this.renderEngine);
-        this.checkGLError("Post startup");
-        this.ingameGUI = new GuiIngame(this);
-
-        if (this.serverName != null)
-        {
-            this.displayGuiScreen(new GuiConnecting(new GuiMainMenu(), this, this.serverName, this.serverPort));
-        }
-        else
-        {
-            this.displayGuiScreen(new GuiMainMenu());
-        }
-
-        this.renderEngine.deleteTexture(this.mojangLogo);
-        this.mojangLogo = null;
-        this.loadingScreen = new LoadingScreenRenderer(this);
-
-        if (this.gameSettings.fullScreen && !this.fullscreen)
-        {
-            this.toggleFullscreen();
-        }
-
-        try
-        {
-            Display.setVSyncEnabled(this.gameSettings.enableVsync);
-        }
-        catch (OpenGLException var2)
-        {
-            this.gameSettings.enableVsync = false;
-            this.gameSettings.saveOptions();
-        }
-
-        this.renderGlobal.func_174966_b();
-    }
-
-    private void func_175608_ak()
-    {
-        this.metadataSerializer_.registerMetadataSectionType(new TextureMetadataSectionSerializer(), TextureMetadataSection.class);
-        this.metadataSerializer_.registerMetadataSectionType(new FontMetadataSectionSerializer(), FontMetadataSection.class);
-        this.metadataSerializer_.registerMetadataSectionType(new AnimationMetadataSectionSerializer(), AnimationMetadataSection.class);
-        this.metadataSerializer_.registerMetadataSectionType(new PackMetadataSectionSerializer(), PackMetadataSection.class);
-        this.metadataSerializer_.registerMetadataSectionType(new LanguageMetadataSectionSerializer(), LanguageMetadataSection.class);
-    }
-
-    private void func_175595_al()
-    {
-        try
-        {
-            this.stream = new TwitchStream(this, (Property)Iterables.getFirst(this.twitchDetails.get("twitch_access_token"), (Object)null));
-        }
-        catch (Throwable var2)
-        {
-            this.stream = new NullStream(var2);
-            logger.error("Couldn\'t initialize twitch stream");
-        }
-    }
-
-    private void func_175609_am() throws LWJGLException
-    {
-        Display.setResizable(true);
-        Display.setTitle("Minecraft 1.8");
-
-        try
-        {
-            Display.create((new PixelFormat()).withDepthBits(24));
-        }
-        catch (LWJGLException var4)
-        {
-            logger.error("Couldn\'t set pixel format", var4);
-
-            try
-            {
-                Thread.sleep(1000L);
-            }
-            catch (InterruptedException var3)
-            {
-                ;
-            }
-
-            if (this.fullscreen)
-            {
-                this.updateDisplayMode();
-            }
-
-            Display.create();
-        }
-    }
-
-    private void func_175605_an() throws LWJGLException
-    {
-        if (this.fullscreen)
-        {
-            Display.setFullscreen(true);
-            DisplayMode var1 = Display.getDisplayMode();
-            this.displayWidth = Math.max(1, var1.getWidth());
-            this.displayHeight = Math.max(1, var1.getHeight());
-        }
-        else
-        {
-            Display.setDisplayMode(new DisplayMode(this.displayWidth, this.displayHeight));
-        }
-    }
-
-    private void func_175594_ao()
-    {
-        Util.EnumOS var1 = Util.getOSType();
-
-        if (var1 != Util.EnumOS.OSX)
-        {
-            InputStream var2 = null;
-            InputStream var3 = null;
-
-            try
-            {
-                var2 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_16x16.png"));
-                var3 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_32x32.png"));
-
-                if (var2 != null && var3 != null)
-                {
-                    Display.setIcon(new ByteBuffer[] {this.readImageToBuffer(var2), this.readImageToBuffer(var3)});
-                }
-            }
-            catch (IOException var8)
-            {
-                logger.error("Couldn\'t set icon", var8);
-            }
-            finally
-            {
-                IOUtils.closeQuietly(var2);
-                IOUtils.closeQuietly(var3);
-            }
-        }
-    }
-
-    private static boolean isJvm64bit()
-    {
-        String[] var0 = new String[] {"sun.arch.data.model", "com.ibm.vm.bitmode", "os.arch"};
-        String[] var1 = var0;
-        int var2 = var0.length;
-
-        for (int var3 = 0; var3 < var2; ++var3)
-        {
-            String var4 = var1[var3];
-            String var5 = System.getProperty(var4);
-
-            if (var5 != null && var5.contains("64"))
-            {
-                return true;
-            }
-        }
-
-        return false;
-    }
-
-    public Framebuffer getFramebuffer()
-    {
-        return this.framebufferMc;
-    }
-
-    public String func_175600_c()
-    {
-        return this.launchedVersion;
-    }
-
-    private void startTimerHackThread()
-    {
-        Thread var1 = new Thread("Timer hack thread")
-        {
-            private static final String __OBFID = "CL_00000639";
-            public void run()
-            {
-                while (Minecraft.this.running)
-                {
-                    try
-                    {
-                        Thread.sleep(2147483647L);
-                    }
-                    catch (InterruptedException var2)
-                    {
-                        ;
-                    }
-                }
-            }
-        };
-        var1.setDaemon(true);
-        var1.start();
-    }
-
-    public void crashed(CrashReport crash)
-    {
-        this.hasCrashed = true;
-        this.crashReporter = crash;
-    }
-
-    /**
-     * Wrapper around displayCrashReportInternal
-     */
-    public void displayCrashReport(CrashReport crashReportIn)
-    {
-        File var2 = new File(getMinecraft().mcDataDir, "crash-reports");
-        File var3 = new File(var2, "crash-" + (new SimpleDateFormat("yyyy-MM-dd_HH.mm.ss")).format(new Date()) + "-client.txt");
-        Bootstrap.func_179870_a(crashReportIn.getCompleteReport());
-
-        if (crashReportIn.getFile() != null)
-        {
-            Bootstrap.func_179870_a("#@!@# Game crashed! Crash report saved to: #@!@# " + crashReportIn.getFile());
-            System.exit(-1);
-        }
-        else if (crashReportIn.saveToFile(var3))
-        {
-            Bootstrap.func_179870_a("#@!@# Game crashed! Crash report saved to: #@!@# " + var3.getAbsolutePath());
-            System.exit(-1);
-        }
-        else
-        {
-            Bootstrap.func_179870_a("#@?@# Game crashed! Crash report could not be saved. #@?@#");
-            System.exit(-2);
-        }
-    }
-
-    public boolean isUnicode()
-    {
-        return this.mcLanguageManager.isCurrentLocaleUnicode() || this.gameSettings.forceUnicodeFont;
-    }
-
-    public void refreshResources()
-    {
-        ArrayList var1 = Lists.newArrayList(this.defaultResourcePacks);
-        Iterator var2 = this.mcResourcePackRepository.getRepositoryEntries().iterator();
-
-        while (var2.hasNext())
-        {
-            ResourcePackRepository.Entry var3 = (ResourcePackRepository.Entry)var2.next();
-            var1.add(var3.getResourcePack());
-        }
-
-        if (this.mcResourcePackRepository.getResourcePackInstance() != null)
-        {
-            var1.add(this.mcResourcePackRepository.getResourcePackInstance());
-        }
-
-        try
-        {
-            this.mcResourceManager.reloadResources(var1);
-        }
-        catch (RuntimeException var4)
-        {
-            logger.info("Caught error stitching, removing all assigned resourcepacks", var4);
-            var1.clear();
-            var1.addAll(this.defaultResourcePacks);
-            this.mcResourcePackRepository.func_148527_a(Collections.emptyList());
-            this.mcResourceManager.reloadResources(var1);
-            this.gameSettings.resourcePacks.clear();
-            this.gameSettings.saveOptions();
-        }
-
-        this.mcLanguageManager.parseLanguageMetadata(var1);
-
-        if (this.renderGlobal != null)
-        {
-            this.renderGlobal.loadRenderers();
-        }
-    }
-
-    private ByteBuffer readImageToBuffer(InputStream imageStream) throws IOException
-    {
-        BufferedImage var2 = ImageIO.read(imageStream);
-        int[] var3 = var2.getRGB(0, 0, var2.getWidth(), var2.getHeight(), (int[])null, 0, var2.getWidth());
-        ByteBuffer var4 = ByteBuffer.allocate(4 * var3.length);
-        int[] var5 = var3;
-        int var6 = var3.length;
-
-        for (int var7 = 0; var7 < var6; ++var7)
-        {
-            int var8 = var5[var7];
-            var4.putInt(var8 << 8 | var8 >> 24 & 255);
-        }
-
-        var4.flip();
-        return var4;
-    }
-
-    private void updateDisplayMode() throws LWJGLException
-    {
-        HashSet var1 = Sets.newHashSet();
-        Collections.addAll(var1, Display.getAvailableDisplayModes());
-        DisplayMode var2 = Display.getDesktopDisplayMode();
-
-        if (!var1.contains(var2) && Util.getOSType() == Util.EnumOS.OSX)
-        {
-            Iterator var3 = macDisplayModes.iterator();
-
-            while (var3.hasNext())
-            {
-                DisplayMode var4 = (DisplayMode)var3.next();
-                boolean var5 = true;
-                Iterator var6 = var1.iterator();
-                DisplayMode var7;
-
-                while (var6.hasNext())
-                {
-                    var7 = (DisplayMode)var6.next();
-
-                    if (var7.getBitsPerPixel() == 32 && var7.getWidth() == var4.getWidth() && var7.getHeight() == var4.getHeight())
-                    {
-                        var5 = false;
-                        break;
-                    }
-                }
-
-                if (!var5)
-                {
-                    var6 = var1.iterator();
-
-                    while (var6.hasNext())
-                    {
-                        var7 = (DisplayMode)var6.next();
-
-                        if (var7.getBitsPerPixel() == 32 && var7.getWidth() == var4.getWidth() / 2 && var7.getHeight() == var4.getHeight() / 2)
-                        {
-                            var2 = var7;
-                            break;
-                        }
-                    }
-                }
-            }
-        }
-
-        Display.setDisplayMode(var2);
-        this.displayWidth = var2.getWidth();
-        this.displayHeight = var2.getHeight();
-    }
-
-    private void func_180510_a(TextureManager p_180510_1_)
-    {
-        ScaledResolution var2 = new ScaledResolution(this, this.displayWidth, this.displayHeight);
-        int var3 = var2.getScaleFactor();
-        Framebuffer var4 = new Framebuffer(var2.getScaledWidth() * var3, var2.getScaledHeight() * var3, true);
-        var4.bindFramebuffer(false);
-        GlStateManager.matrixMode(5889);
-        GlStateManager.loadIdentity();
-        GlStateManager.ortho(0.0D, (double)var2.getScaledWidth(), (double)var2.getScaledHeight(), 0.0D, 1000.0D, 3000.0D);
-        GlStateManager.matrixMode(5888);
-        GlStateManager.loadIdentity();
-        GlStateManager.translate(0.0F, 0.0F, -2000.0F);
-        GlStateManager.disableLighting();
-        GlStateManager.disableFog();
-        GlStateManager.disableDepth();
-        GlStateManager.func_179098_w();
-        InputStream var5 = null;
-
-        try
-        {
-            var5 = this.mcDefaultResourcePack.getInputStream(locationMojangPng);
-            this.mojangLogo = p_180510_1_.getDynamicTextureLocation("logo", new DynamicTexture(ImageIO.read(var5)));
-            p_180510_1_.bindTexture(this.mojangLogo);
-        }
-        catch (IOException var12)
-        {
-            logger.error("Unable to load logo: " + locationMojangPng, var12);
-        }
-        finally
-        {
-            IOUtils.closeQuietly(var5);
-        }
-
-        Tessellator var6 = Tessellator.getInstance();
-        WorldRenderer var7 = var6.getWorldRenderer();
-        var7.startDrawingQuads();
-        var7.func_178991_c(16777215);
-        var7.addVertexWithUV(0.0D, (double)this.displayHeight, 0.0D, 0.0D, 0.0D);
-        var7.addVertexWithUV((double)this.displayWidth, (double)this.displayHeight, 0.0D, 0.0D, 0.0D);
-        var7.addVertexWithUV((double)this.displayWidth, 0.0D, 0.0D, 0.0D, 0.0D);
-        var7.addVertexWithUV(0.0D, 0.0D, 0.0D, 0.0D, 0.0D);
-        var6.draw();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        var7.func_178991_c(16777215);
-        short var8 = 256;
-        short var9 = 256;
-        this.scaledTessellator((var2.getScaledWidth() - var8) / 2, (var2.getScaledHeight() - var9) / 2, 0, 0, var8, var9);
-        GlStateManager.disableLighting();
-        GlStateManager.disableFog();
-        var4.unbindFramebuffer();
-        var4.framebufferRender(var2.getScaledWidth() * var3, var2.getScaledHeight() * var3);
-        GlStateManager.enableAlpha();
-        GlStateManager.alphaFunc(516, 0.1F);
-        this.func_175601_h();
-    }
-
-    /**
-     * Loads Tessellator with a scaled resolution
-     */
-    public void scaledTessellator(int width, int height, int width2, int height2, int stdTextureWidth, int stdTextureHeight)
-    {
-        float var7 = 0.00390625F;
-        float var8 = 0.00390625F;
-        WorldRenderer var9 = Tessellator.getInstance().getWorldRenderer();
-        var9.startDrawingQuads();
-        var9.addVertexWithUV((double)(width + 0), (double)(height + stdTextureHeight), 0.0D, (double)((float)(width2 + 0) * var7), (double)((float)(height2 + stdTextureHeight) * var8));
-        var9.addVertexWithUV((double)(width + stdTextureWidth), (double)(height + stdTextureHeight), 0.0D, (double)((float)(width2 + stdTextureWidth) * var7), (double)((float)(height2 + stdTextureHeight) * var8));
-        var9.addVertexWithUV((double)(width + stdTextureWidth), (double)(height + 0), 0.0D, (double)((float)(width2 + stdTextureWidth) * var7), (double)((float)(height2 + 0) * var8));
-        var9.addVertexWithUV((double)(width + 0), (double)(height + 0), 0.0D, (double)((float)(width2 + 0) * var7), (double)((float)(height2 + 0) * var8));
-        Tessellator.getInstance().draw();
-    }
-
-    /**
-     * Returns the save loader that is currently being used
-     */
-    public ISaveFormat getSaveLoader()
-    {
-        return this.saveLoader;
-    }
-
-    /**
-     * Sets the argument GuiScreen as the main (topmost visible) screen.
-     */
-    public void displayGuiScreen(GuiScreen guiScreenIn)
-    {
-        if (this.currentScreen != null)
-        {
-            this.currentScreen.onGuiClosed();
-        }
-
-        if (guiScreenIn == null && this.theWorld == null)
-        {
-            guiScreenIn = new GuiMainMenu();
-        }
-        else if (guiScreenIn == null && this.thePlayer.getHealth() <= 0.0F)
-        {
-            guiScreenIn = new GuiGameOver();
-        }
-
-        if (guiScreenIn instanceof GuiMainMenu)
-        {
-            this.gameSettings.showDebugInfo = false;
-            this.ingameGUI.getChatGUI().clearChatMessages();
-        }
-
-        this.currentScreen = (GuiScreen)guiScreenIn;
-
-        if (guiScreenIn != null)
-        {
-            this.setIngameNotInFocus();
-            ScaledResolution var2 = new ScaledResolution(this, this.displayWidth, this.displayHeight);
-            int var3 = var2.getScaledWidth();
-            int var4 = var2.getScaledHeight();
-            ((GuiScreen)guiScreenIn).setWorldAndResolution(this, var3, var4);
-            this.skipRenderWorld = false;
-        }
-        else
-        {
-            this.mcSoundHandler.resumeSounds();
-            this.setIngameFocus();
-        }
-    }
-
-    /**
-     * Checks for an OpenGL error. If there is one, prints the error ID and error string.
-     */
-    private void checkGLError(String message)
-    {
-        if (this.field_175619_R)
-        {
-            int var2 = GL11.glGetError();
-
-            if (var2 != 0)
-            {
-                String var3 = GLU.gluErrorString(var2);
-                logger.error("########## GL ERROR ##########");
-                logger.error("@ " + message);
-                logger.error(var2 + ": " + var3);
-            }
-        }
-    }
-
-    /**
-     * Shuts down the minecraft applet by stopping the resource downloads, and clearing up GL stuff; called when the
-     * application (or web page) is exited.
-     */
-    public void shutdownMinecraftApplet()
-    {
-        try
-        {
-            this.stream.shutdownStream();
-            logger.info("Stopping!");
-
-            try
-            {
-                this.loadWorld((WorldClient)null);
-            }
-            catch (Throwable var5)
-            {
-                ;
-            }
-
-            this.mcSoundHandler.unloadSounds();
-        }
-        finally
-        {
-            Display.destroy();
-
-            if (!this.hasCrashed)
-            {
-                System.exit(0);
-            }
-        }
-
-        System.gc();
-    }
-
-    /**
-     * Called repeatedly from run()
-     */
-    private void runGameLoop() throws IOException
-    {
-        this.mcProfiler.startSection("root");
-
-        if (Display.isCreated() && Display.isCloseRequested())
-        {
-            this.shutdown();
-        }
-
-        if (this.isGamePaused && this.theWorld != null)
-        {
-            float var1 = this.timer.renderPartialTicks;
-            this.timer.updateTimer();
-            this.timer.renderPartialTicks = var1;
-        }
-        else
-        {
-            this.timer.updateTimer();
-        }
-
-        this.mcProfiler.startSection("scheduledExecutables");
-        Queue var6 = this.scheduledTasks;
-
-        synchronized (this.scheduledTasks)
-        {
-            while (!this.scheduledTasks.isEmpty())
-            {
-                ((FutureTask)this.scheduledTasks.poll()).run();
-            }
-        }
-
-        this.mcProfiler.endSection();
-        long var7 = System.nanoTime();
-        this.mcProfiler.startSection("tick");
-
-        for (int var3 = 0; var3 < this.timer.elapsedTicks; ++var3)
-        {
-            this.runTick();
-        }
-
-        this.mcProfiler.endStartSection("preRenderErrors");
-        long var8 = System.nanoTime() - var7;
-        this.checkGLError("Pre render");
-        this.mcProfiler.endStartSection("sound");
-        this.mcSoundHandler.setListener(this.thePlayer, this.timer.renderPartialTicks);
-        this.mcProfiler.endSection();
-        this.mcProfiler.startSection("render");
-        GlStateManager.pushMatrix();
-        GlStateManager.clear(16640);
-        this.framebufferMc.bindFramebuffer(true);
-        this.mcProfiler.startSection("display");
-        GlStateManager.func_179098_w();
-
-        if (this.thePlayer != null && this.thePlayer.isEntityInsideOpaqueBlock())
-        {
-            this.gameSettings.thirdPersonView = 0;
-        }
-
-        this.mcProfiler.endSection();
-
-        if (!this.skipRenderWorld)
-        {
-            this.mcProfiler.endStartSection("gameRenderer");
-            this.entityRenderer.updateCameraAndRender(this.timer.renderPartialTicks);
-            this.mcProfiler.endSection();
-        }
-
-        this.mcProfiler.endSection();
-
-        if (this.gameSettings.showDebugInfo && this.gameSettings.showDebugProfilerChart && !this.gameSettings.hideGUI)
-        {
-            if (!this.mcProfiler.profilingEnabled)
-            {
-                this.mcProfiler.clearProfiling();
-            }
-
-            this.mcProfiler.profilingEnabled = true;
-            this.displayDebugInfo(var8);
-        }
-        else
-        {
-            this.mcProfiler.profilingEnabled = false;
-            this.prevFrameTime = System.nanoTime();
-        }
-
-        this.guiAchievement.updateAchievementWindow();
-        this.framebufferMc.unbindFramebuffer();
-        GlStateManager.popMatrix();
-        GlStateManager.pushMatrix();
-        this.framebufferMc.framebufferRender(this.displayWidth, this.displayHeight);
-        GlStateManager.popMatrix();
-        GlStateManager.pushMatrix();
-        this.entityRenderer.func_152430_c(this.timer.renderPartialTicks);
-        GlStateManager.popMatrix();
-        this.mcProfiler.startSection("root");
-        this.func_175601_h();
-        Thread.yield();
-        this.mcProfiler.startSection("stream");
-        this.mcProfiler.startSection("update");
-        this.stream.func_152935_j();
-        this.mcProfiler.endStartSection("submit");
-        this.stream.func_152922_k();
-        this.mcProfiler.endSection();
-        this.mcProfiler.endSection();
-        this.checkGLError("Post render");
-        ++this.fpsCounter;
-        this.isGamePaused = this.isSingleplayer() && this.currentScreen != null && this.currentScreen.doesGuiPauseGame() && !this.theIntegratedServer.getPublic();
-
-        while (getSystemTime() >= this.debugUpdateTime + 1000L)
-        {
-            debugFPS = this.fpsCounter;
-            this.debug = String.format("%d fps (%d chunk update%s) T: %s%s%s%s%s", new Object[] {Integer.valueOf(debugFPS), Integer.valueOf(RenderChunk.field_178592_a), RenderChunk.field_178592_a != 1 ? "s" : "", (float)this.gameSettings.limitFramerate == GameSettings.Options.FRAMERATE_LIMIT.getValueMax() ? "inf" : Integer.valueOf(this.gameSettings.limitFramerate), this.gameSettings.enableVsync ? " vsync" : "", this.gameSettings.fancyGraphics ? "" : " fast", this.gameSettings.clouds ? " clouds" : "", OpenGlHelper.func_176075_f() ? " vbo" : ""});
-            RenderChunk.field_178592_a = 0;
-            this.debugUpdateTime += 1000L;
-            this.fpsCounter = 0;
-            this.usageSnooper.addMemoryStatsToSnooper();
-
-            if (!this.usageSnooper.isSnooperRunning())
-            {
-                this.usageSnooper.startSnooper();
-            }
-        }
-
-        if (this.isFramerateLimitBelowMax())
-        {
-            this.mcProfiler.startSection("fpslimit_wait");
-            Display.sync(this.getLimitFramerate());
-            this.mcProfiler.endSection();
-        }
-
-        this.mcProfiler.endSection();
-    }
-
-    public void func_175601_h()
-    {
-        this.mcProfiler.startSection("display_update");
-        Display.update();
-        this.mcProfiler.endSection();
-        this.func_175604_i();
-    }
-
-    protected void func_175604_i()
-    {
-        if (!this.fullscreen && Display.wasResized())
-        {
-            int var1 = this.displayWidth;
-            int var2 = this.displayHeight;
-            this.displayWidth = Display.getWidth();
-            this.displayHeight = Display.getHeight();
-
-            if (this.displayWidth != var1 || this.displayHeight != var2)
-            {
-                if (this.displayWidth <= 0)
-                {
-                    this.displayWidth = 1;
-                }
-
-                if (this.displayHeight <= 0)
-                {
-                    this.displayHeight = 1;
-                }
-
-                this.resize(this.displayWidth, this.displayHeight);
-            }
-        }
-    }
-
-    public int getLimitFramerate()
-    {
-        return this.theWorld == null && this.currentScreen != null ? 30 : this.gameSettings.limitFramerate;
-    }
-
-    public boolean isFramerateLimitBelowMax()
-    {
-        return (float)this.getLimitFramerate() < GameSettings.Options.FRAMERATE_LIMIT.getValueMax();
-    }
-
-    public void freeMemory()
-    {
-        try
-        {
-            memoryReserve = new byte[0];
-            this.renderGlobal.deleteAllDisplayLists();
-        }
-        catch (Throwable var3)
-        {
-            ;
-        }
-
-        try
-        {
-            System.gc();
-            this.loadWorld((WorldClient)null);
-        }
-        catch (Throwable var2)
-        {
-            ;
-        }
-
-        System.gc();
-    }
-
-    /**
-     * Update debugProfilerName in response to number keys in debug screen
-     */
-    private void updateDebugProfilerName(int keyCount)
-    {
-        List var2 = this.mcProfiler.getProfilingData(this.debugProfilerName);
-
-        if (var2 != null && !var2.isEmpty())
-        {
-            Profiler.Result var3 = (Profiler.Result)var2.remove(0);
-
-            if (keyCount == 0)
-            {
-                if (var3.field_76331_c.length() > 0)
-                {
-                    int var4 = this.debugProfilerName.lastIndexOf(".");
-
-                    if (var4 >= 0)
-                    {
-                        this.debugProfilerName = this.debugProfilerName.substring(0, var4);
-                    }
-                }
-            }
-            else
-            {
-                --keyCount;
-
-                if (keyCount < var2.size() && !((Profiler.Result)var2.get(keyCount)).field_76331_c.equals("unspecified"))
-                {
-                    if (this.debugProfilerName.length() > 0)
-                    {
-                        this.debugProfilerName = this.debugProfilerName + ".";
-                    }
-
-                    this.debugProfilerName = this.debugProfilerName + ((Profiler.Result)var2.get(keyCount)).field_76331_c;
-                }
-            }
-        }
-    }
-
-    /**
-     * Parameter appears to be unused
-     */
-    private void displayDebugInfo(long elapsedTicksTime)
-    {
-        if (this.mcProfiler.profilingEnabled)
-        {
-            List var3 = this.mcProfiler.getProfilingData(this.debugProfilerName);
-            Profiler.Result var4 = (Profiler.Result)var3.remove(0);
-            GlStateManager.clear(256);
-            GlStateManager.matrixMode(5889);
-            GlStateManager.enableColorMaterial();
-            GlStateManager.loadIdentity();
-            GlStateManager.ortho(0.0D, (double)this.displayWidth, (double)this.displayHeight, 0.0D, 1000.0D, 3000.0D);
-            GlStateManager.matrixMode(5888);
-            GlStateManager.loadIdentity();
-            GlStateManager.translate(0.0F, 0.0F, -2000.0F);
-            GL11.glLineWidth(1.0F);
-            GlStateManager.func_179090_x();
-            Tessellator var5 = Tessellator.getInstance();
-            WorldRenderer var6 = var5.getWorldRenderer();
-            short var7 = 160;
-            int var8 = this.displayWidth - var7 - 10;
-            int var9 = this.displayHeight - var7 * 2;
-            GlStateManager.enableBlend();
-            var6.startDrawingQuads();
-            var6.func_178974_a(0, 200);
-            var6.addVertex((double)((float)var8 - (float)var7 * 1.1F), (double)((float)var9 - (float)var7 * 0.6F - 16.0F), 0.0D);
-            var6.addVertex((double)((float)var8 - (float)var7 * 1.1F), (double)(var9 + var7 * 2), 0.0D);
-            var6.addVertex((double)((float)var8 + (float)var7 * 1.1F), (double)(var9 + var7 * 2), 0.0D);
-            var6.addVertex((double)((float)var8 + (float)var7 * 1.1F), (double)((float)var9 - (float)var7 * 0.6F - 16.0F), 0.0D);
-            var5.draw();
-            GlStateManager.disableBlend();
-            double var10 = 0.0D;
-            int var14;
-
-            for (int var12 = 0; var12 < var3.size(); ++var12)
-            {
-                Profiler.Result var13 = (Profiler.Result)var3.get(var12);
-                var14 = MathHelper.floor_double(var13.field_76332_a / 4.0D) + 1;
-                var6.startDrawing(6);
-                var6.func_178991_c(var13.func_76329_a());
-                var6.addVertex((double)var8, (double)var9, 0.0D);
-                int var15;
-                float var16;
-                float var17;
-                float var18;
-
-                for (var15 = var14; var15 >= 0; --var15)
-                {
-                    var16 = (float)((var10 + var13.field_76332_a * (double)var15 / (double)var14) * Math.PI * 2.0D / 100.0D);
-                    var17 = MathHelper.sin(var16) * (float)var7;
-                    var18 = MathHelper.cos(var16) * (float)var7 * 0.5F;
-                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18), 0.0D);
-                }
-
-                var5.draw();
-                var6.startDrawing(5);
-                var6.func_178991_c((var13.func_76329_a() & 16711422) >> 1);
-
-                for (var15 = var14; var15 >= 0; --var15)
-                {
-                    var16 = (float)((var10 + var13.field_76332_a * (double)var15 / (double)var14) * Math.PI * 2.0D / 100.0D);
-                    var17 = MathHelper.sin(var16) * (float)var7;
-                    var18 = MathHelper.cos(var16) * (float)var7 * 0.5F;
-                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18), 0.0D);
-                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18 + 10.0F), 0.0D);
-                }
-
-                var5.draw();
-                var10 += var13.field_76332_a;
-            }
-
-            DecimalFormat var19 = new DecimalFormat("##0.00");
-            GlStateManager.func_179098_w();
-            String var20 = "";
-
-            if (!var4.field_76331_c.equals("unspecified"))
-            {
-                var20 = var20 + "[0] ";
-            }
-
-            if (var4.field_76331_c.length() == 0)
-            {
-                var20 = var20 + "ROOT ";
-            }
-            else
-            {
-                var20 = var20 + var4.field_76331_c + " ";
-            }
-
-            var14 = 16777215;
-            this.fontRendererObj.func_175063_a(var20, (float)(var8 - var7), (float)(var9 - var7 / 2 - 16), var14);
-            this.fontRendererObj.func_175063_a(var20 = var19.format(var4.field_76330_b) + "%", (float)(var8 + var7 - this.fontRendererObj.getStringWidth(var20)), (float)(var9 - var7 / 2 - 16), var14);
-
-            for (int var21 = 0; var21 < var3.size(); ++var21)
-            {
-                Profiler.Result var22 = (Profiler.Result)var3.get(var21);
-                String var23 = "";
-
-                if (var22.field_76331_c.equals("unspecified"))
-                {
-                    var23 = var23 + "[?] ";
-                }
-                else
-                {
-                    var23 = var23 + "[" + (var21 + 1) + "] ";
-                }
-
-                var23 = var23 + var22.field_76331_c;
-                this.fontRendererObj.func_175063_a(var23, (float)(var8 - var7), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
-                this.fontRendererObj.func_175063_a(var23 = var19.format(var22.field_76332_a) + "%", (float)(var8 + var7 - 50 - this.fontRendererObj.getStringWidth(var23)), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
-                this.fontRendererObj.func_175063_a(var23 = var19.format(var22.field_76330_b) + "%", (float)(var8 + var7 - this.fontRendererObj.getStringWidth(var23)), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
-            }
-        }
-    }
-
-    /**
-     * Called when the window is closing. Sets 'running' to false which allows the game loop to exit cleanly.
-     */
-    public void shutdown()
-    {
-        this.running = false;
-    }
-
-    /**
-     * Will set the focus to ingame if the Minecraft window is the active with focus. Also clears any GUI screen
-     * currently displayed
-     */
-    public void setIngameFocus()
-    {
-        if (Display.isActive())
-        {
-            if (!this.inGameHasFocus)
-            {
-                this.inGameHasFocus = true;
-                this.mouseHelper.grabMouseCursor();
-                this.displayGuiScreen((GuiScreen)null);
-                this.leftClickCounter = 10000;
-            }
-        }
-    }
-
-    /**
-     * Resets the player keystate, disables the ingame focus, and ungrabs the mouse cursor.
-     */
-    public void setIngameNotInFocus()
-    {
-        if (this.inGameHasFocus)
-        {
-            KeyBinding.unPressAllKeys();
-            this.inGameHasFocus = false;
-            this.mouseHelper.ungrabMouseCursor();
-        }
-    }
-
-    /**
-     * Displays the ingame menu
-     */
-    public void displayInGameMenu()
-    {
-        if (this.currentScreen == null)
-        {
-            this.displayGuiScreen(new GuiIngameMenu());
-
-            if (this.isSingleplayer() && !this.theIntegratedServer.getPublic())
-            {
-                this.mcSoundHandler.pauseSounds();
-            }
-        }
-    }
-
-    private void sendClickBlockToController(boolean leftClick)
-    {
-        if (!leftClick)
-        {
-            this.leftClickCounter = 0;
-        }
-
-        if (this.leftClickCounter <= 0 && !this.thePlayer.isUsingItem())
-        {
-            if (leftClick && this.objectMouseOver != null && this.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
-            {
-                BlockPos var2 = this.objectMouseOver.func_178782_a();
-
-                if (this.theWorld.getBlockState(var2).getBlock().getMaterial() != Material.air && this.playerController.func_180512_c(var2, this.objectMouseOver.field_178784_b))
-                {
-                    this.effectRenderer.func_180532_a(var2, this.objectMouseOver.field_178784_b);
-                    this.thePlayer.swingItem();
-                }
-            }
-            else
-            {
-                this.playerController.resetBlockRemoving();
-            }
-        }
-    }
-
-    private void clickMouse()
-    {
-        if (this.leftClickCounter <= 0)
-        {
-            this.thePlayer.swingItem();
-
-            if (this.objectMouseOver == null)
-            {
-                logger.error("Null returned as \'hitResult\', this shouldn\'t happen!");
-
-                if (this.playerController.isNotCreative())
-                {
-                    this.leftClickCounter = 10;
-                }
-            }
-            else
-            {
-                switch (Minecraft.SwitchEnumMinecartType.field_152390_a[this.objectMouseOver.typeOfHit.ordinal()])
-                {
-                    case 1:
-                        this.playerController.attackEntity(this.thePlayer, this.objectMouseOver.entityHit);
-                        break;
-
-                    case 2:
-                        BlockPos var1 = this.objectMouseOver.func_178782_a();
-
-                        if (this.theWorld.getBlockState(var1).getBlock().getMaterial() != Material.air)
-                        {
-                            this.playerController.func_180511_b(var1, this.objectMouseOver.field_178784_b);
-                            break;
-                        }
-
-                    case 3:
-                    default:
-                        if (this.playerController.isNotCreative())
-                        {
-                            this.leftClickCounter = 10;
-                        }
-                }
-            }
-        }
-    }
-
-    /**
-     * Called when user clicked he's mouse right button (place)
-     */
-    private void rightClickMouse()
-    {
-        this.rightClickDelayTimer = 4;
-        boolean var1 = true;
-        ItemStack var2 = this.thePlayer.inventory.getCurrentItem();
-
-        if (this.objectMouseOver == null)
-        {
-            logger.warn("Null returned as \'hitResult\', this shouldn\'t happen!");
-        }
-        else
-        {
-            switch (Minecraft.SwitchEnumMinecartType.field_152390_a[this.objectMouseOver.typeOfHit.ordinal()])
-            {
-                case 1:
-                    if (this.playerController.func_178894_a(this.thePlayer, this.objectMouseOver.entityHit, this.objectMouseOver))
-                    {
-                        var1 = false;
-                    }
-                    else if (this.playerController.interactWithEntitySendPacket(this.thePlayer, this.objectMouseOver.entityHit))
-                    {
-                        var1 = false;
-                    }
-
-                    break;
-
-                case 2:
-                    BlockPos var3 = this.objectMouseOver.func_178782_a();
-
-                    if (this.theWorld.getBlockState(var3).getBlock().getMaterial() != Material.air)
-                    {
-                        int var4 = var2 != null ? var2.stackSize : 0;
-
-                        if (this.playerController.func_178890_a(this.thePlayer, this.theWorld, var2, var3, this.objectMouseOver.field_178784_b, this.objectMouseOver.hitVec))
-                        {
-                            var1 = false;
-                            this.thePlayer.swingItem();
-                        }
-
-                        if (var2 == null)
-                        {
-                            return;
-                        }
-
-                        if (var2.stackSize == 0)
-                        {
-                            this.thePlayer.inventory.mainInventory[this.thePlayer.inventory.currentItem] = null;
-                        }
-                        else if (var2.stackSize != var4 || this.playerController.isInCreativeMode())
-                        {
-                            this.entityRenderer.itemRenderer.resetEquippedProgress();
-                        }
-                    }
-            }
-        }
-
-        if (var1)
-        {
-            ItemStack var5 = this.thePlayer.inventory.getCurrentItem();
-
-            if (var5 != null && this.playerController.sendUseItem(this.thePlayer, this.theWorld, var5))
-            {
-                this.entityRenderer.itemRenderer.resetEquippedProgress2();
-            }
-        }
-    }
-
-    /**
-     * Toggles fullscreen mode.
-     */
-    public void toggleFullscreen()
-    {
-        try
-        {
-            this.fullscreen = !this.fullscreen;
-            this.gameSettings.fullScreen = this.fullscreen;
-
-            if (this.fullscreen)
-            {
-                this.updateDisplayMode();
-                this.displayWidth = Display.getDisplayMode().getWidth();
-                this.displayHeight = Display.getDisplayMode().getHeight();
-
-                if (this.displayWidth <= 0)
-                {
-                    this.displayWidth = 1;
-                }
-
-                if (this.displayHeight <= 0)
-                {
-                    this.displayHeight = 1;
-                }
-            }
-            else
-            {
-                Display.setDisplayMode(new DisplayMode(this.tempDisplayWidth, this.tempDisplayHeight));
-                this.displayWidth = this.tempDisplayWidth;
-                this.displayHeight = this.tempDisplayHeight;
-
-                if (this.displayWidth <= 0)
-                {
-                    this.displayWidth = 1;
-                }
-
-                if (this.displayHeight <= 0)
-                {
-                    this.displayHeight = 1;
-                }
-            }
-
-            if (this.currentScreen != null)
-            {
-                this.resize(this.displayWidth, this.displayHeight);
-            }
-            else
-            {
-                this.updateFramebufferSize();
-            }
-
-            Display.setFullscreen(this.fullscreen);
-            Display.setVSyncEnabled(this.gameSettings.enableVsync);
-            this.func_175601_h();
-        }
-        catch (Exception var2)
-        {
-            logger.error("Couldn\'t toggle fullscreen", var2);
-        }
-    }
-
-    /**
-     * Called to resize the current screen.
-     */
-    private void resize(int width, int height)
-    {
-        this.displayWidth = Math.max(1, width);
-        this.displayHeight = Math.max(1, height);
-
-        if (this.currentScreen != null)
-        {
-            ScaledResolution var3 = new ScaledResolution(this, width, height);
-            this.currentScreen.func_175273_b(this, var3.getScaledWidth(), var3.getScaledHeight());
-        }
-
-        this.loadingScreen = new LoadingScreenRenderer(this);
-        this.updateFramebufferSize();
-    }
-
-    private void updateFramebufferSize()
-    {
-        this.framebufferMc.createBindFramebuffer(this.displayWidth, this.displayHeight);
-
-        if (this.entityRenderer != null)
-        {
-            this.entityRenderer.updateShaderGroupSize(this.displayWidth, this.displayHeight);
-        }
-    }
-
-    /**
-     * Runs the current tick.
-     */
-    public void runTick() throws IOException
-    {
-        if (this.rightClickDelayTimer > 0)
-        {
-            --this.rightClickDelayTimer;
-        }
-
-        this.mcProfiler.startSection("gui");
-
-        if (!this.isGamePaused)
-        {
-            this.ingameGUI.updateTick();
-        }
-
-        this.mcProfiler.endSection();
-        this.entityRenderer.getMouseOver(1.0F);
-        this.mcProfiler.startSection("gameMode");
-
-        if (!this.isGamePaused && this.theWorld != null)
-        {
-            this.playerController.updateController();
-        }
-
-        this.mcProfiler.endStartSection("textures");
-
-        if (!this.isGamePaused)
-        {
-            this.renderEngine.tick();
-        }
-
-        if (this.currentScreen == null && this.thePlayer != null)
-        {
-            if (this.thePlayer.getHealth() <= 0.0F)
-            {
-                this.displayGuiScreen((GuiScreen)null);
-            }
-            else if (this.thePlayer.isPlayerSleeping() && this.theWorld != null)
-            {
-                this.displayGuiScreen(new GuiSleepMP());
-            }
-        }
-        else if (this.currentScreen != null && this.currentScreen instanceof GuiSleepMP && !this.thePlayer.isPlayerSleeping())
-        {
-            this.displayGuiScreen((GuiScreen)null);
-        }
-
-        if (this.currentScreen != null)
-        {
-            this.leftClickCounter = 10000;
-        }
-
-        CrashReport var2;
-        CrashReportCategory var3;
-
-        if (this.currentScreen != null)
-        {
-            try
-            {
-                this.currentScreen.handleInput();
-            }
-            catch (Throwable var7)
-            {
-                var2 = CrashReport.makeCrashReport(var7, "Updating screen events");
-                var3 = var2.makeCategory("Affected screen");
-                var3.addCrashSectionCallable("Screen name", new Callable()
-                {
-                    private static final String __OBFID = "CL_00000640";
-                    public String call()
-                    {
-                        return Minecraft.this.currentScreen.getClass().getCanonicalName();
-                    }
-                });
-                throw new ReportedException(var2);
-            }
-
-            if (this.currentScreen != null)
-            {
-                try
-                {
-                    this.currentScreen.updateScreen();
-                }
-                catch (Throwable var6)
-                {
-                    var2 = CrashReport.makeCrashReport(var6, "Ticking screen");
-                    var3 = var2.makeCategory("Affected screen");
-                    var3.addCrashSectionCallable("Screen name", new Callable()
-                    {
-                        private static final String __OBFID = "CL_00000642";
-                        public String call()
-                        {
-                            return Minecraft.this.currentScreen.getClass().getCanonicalName();
-                        }
-                    });
-                    throw new ReportedException(var2);
-                }
-            }
-        }
-
-        if (this.currentScreen == null || this.currentScreen.allowUserInput)
-        {
-            this.mcProfiler.endStartSection("mouse");
-            int var1;
-
-            while (Mouse.next())
-            {
-                var1 = Mouse.getEventButton();
-                KeyBinding.setKeyBindState(var1 - 100, Mouse.getEventButtonState());
-
-                if (Mouse.getEventButtonState())
-                {
-                    if (this.thePlayer.func_175149_v() && var1 == 2)
-                    {
-                        this.ingameGUI.func_175187_g().func_175261_b();
-                    }
-                    else
-                    {
-                        KeyBinding.onTick(var1 - 100);
-                    }
-                }
-
-                long var10 = getSystemTime() - this.systemTime;
-
-                if (var10 <= 200L)
-                {
-                    int var4 = Mouse.getEventDWheel();
-
-                    if (var4 != 0)
-                    {
-                        if (this.thePlayer.func_175149_v())
-                        {
-                            var4 = var4 < 0 ? -1 : 1;
-
-                            if (this.ingameGUI.func_175187_g().func_175262_a())
-                            {
-                                this.ingameGUI.func_175187_g().func_175259_b(-var4);
-                            }
-                            else
-                            {
-                                float var5 = MathHelper.clamp_float(this.thePlayer.capabilities.getFlySpeed() + (float)var4 * 0.005F, 0.0F, 0.2F);
-                                this.thePlayer.capabilities.setFlySpeed(var5);
-                            }
-                        }
-                        else
-                        {
-                            this.thePlayer.inventory.changeCurrentItem(var4);
-                        }
-                    }
-
-                    if (this.currentScreen == null)
-                    {
-                        if (!this.inGameHasFocus && Mouse.getEventButtonState())
-                        {
-                            this.setIngameFocus();
-                        }
-                    }
-                    else if (this.currentScreen != null)
-                    {
-                        this.currentScreen.handleMouseInput();
-                    }
-                }
-            }
-
-            if (this.leftClickCounter > 0)
-            {
-                --this.leftClickCounter;
-            }
-
-            this.mcProfiler.endStartSection("keyboard");
-
-            while (Keyboard.next())
-            {
-                var1 = Keyboard.getEventKey() == 0 ? Keyboard.getEventCharacter() + 256 : Keyboard.getEventKey();
-                KeyBinding.setKeyBindState(var1, Keyboard.getEventKeyState());
-
-                if (Keyboard.getEventKeyState())
-                {
-                    KeyBinding.onTick(var1);
-                }
-
-                if (this.debugCrashKeyPressTime > 0L)
-                {
-                    if (getSystemTime() - this.debugCrashKeyPressTime >= 6000L)
-                    {
-                        throw new ReportedException(new CrashReport("Manually triggered debug crash", new Throwable()));
-                    }
-
-                    if (!Keyboard.isKeyDown(46) || !Keyboard.isKeyDown(61))
-                    {
-                        this.debugCrashKeyPressTime = -1L;
-                    }
-                }
-                else if (Keyboard.isKeyDown(46) && Keyboard.isKeyDown(61))
-                {
-                    this.debugCrashKeyPressTime = getSystemTime();
-                }
-
-                this.dispatchKeypresses();
-
-                if (Keyboard.getEventKeyState())
-                {
-                    if (var1 == 62 && this.entityRenderer != null)
-                    {
-                        this.entityRenderer.func_175071_c();
-                    }
-
-                    if (this.currentScreen != null)
-                    {
-                        this.currentScreen.handleKeyboardInput();
-                    }
-                    else
-                    {
-                        if (var1 == 1)
-                        {
-                            this.displayInGameMenu();
-                        }
-
-                        if (var1 == 32 && Keyboard.isKeyDown(61) && this.ingameGUI != null)
-                        {
-                            this.ingameGUI.getChatGUI().clearChatMessages();
-                        }
-
-                        if (var1 == 31 && Keyboard.isKeyDown(61))
-                        {
-                            this.refreshResources();
-                        }
-
-                        if (var1 == 17 && Keyboard.isKeyDown(61))
-                        {
-                            ;
-                        }
-
-                        if (var1 == 18 && Keyboard.isKeyDown(61))
-                        {
-                            ;
-                        }
-
-                        if (var1 == 47 && Keyboard.isKeyDown(61))
-                        {
-                            ;
-                        }
-
-                        if (var1 == 38 && Keyboard.isKeyDown(61))
-                        {
-                            ;
-                        }
-
-                        if (var1 == 22 && Keyboard.isKeyDown(61))
-                        {
-                            ;
-                        }
-
-                        if (var1 == 20 && Keyboard.isKeyDown(61))
-                        {
-                            this.refreshResources();
-                        }
-
-                        if (var1 == 33 && Keyboard.isKeyDown(61))
-                        {
-                            boolean var11 = Keyboard.isKeyDown(42) | Keyboard.isKeyDown(54);
-                            this.gameSettings.setOptionValue(GameSettings.Options.RENDER_DISTANCE, var11 ? -1 : 1);
-                        }
-
-                        if (var1 == 30 && Keyboard.isKeyDown(61))
-                        {
-                            this.renderGlobal.loadRenderers();
-                        }
-
-                        if (var1 == 35 && Keyboard.isKeyDown(61))
-                        {
-                            this.gameSettings.advancedItemTooltips = !this.gameSettings.advancedItemTooltips;
-                            this.gameSettings.saveOptions();
-                        }
-
-                        if (var1 == 48 && Keyboard.isKeyDown(61))
-                        {
-                            this.renderManager.func_178629_b(!this.renderManager.func_178634_b());
-                        }
-
-                        if (var1 == 25 && Keyboard.isKeyDown(61))
-                        {
-                            this.gameSettings.pauseOnLostFocus = !this.gameSettings.pauseOnLostFocus;
-                            this.gameSettings.saveOptions();
-                        }
-
-                        if (var1 == 59)
-                        {
-                            this.gameSettings.hideGUI = !this.gameSettings.hideGUI;
-                        }
-
-                        if (var1 == 61)
-                        {
-                            this.gameSettings.showDebugInfo = !this.gameSettings.showDebugInfo;
-                            this.gameSettings.showDebugProfilerChart = GuiScreen.isShiftKeyDown();
-                        }
-
-                        if (this.gameSettings.keyBindTogglePerspective.isPressed())
-                        {
-                            ++this.gameSettings.thirdPersonView;
-
-                            if (this.gameSettings.thirdPersonView > 2)
-                            {
-                                this.gameSettings.thirdPersonView = 0;
-                            }
-
-                            if (this.gameSettings.thirdPersonView == 0)
-                            {
-                                this.entityRenderer.func_175066_a(this.func_175606_aa());
-                            }
-                            else if (this.gameSettings.thirdPersonView == 1)
-                            {
-                                this.entityRenderer.func_175066_a((Entity)null);
-                            }
-                        }
-
-                        if (this.gameSettings.keyBindSmoothCamera.isPressed())
-                        {
-                            this.gameSettings.smoothCamera = !this.gameSettings.smoothCamera;
-                        }
-                    }
-
-                    if (this.gameSettings.showDebugInfo && this.gameSettings.showDebugProfilerChart)
-                    {
-                        if (var1 == 11)
-                        {
-                            this.updateDebugProfilerName(0);
-                        }
-
-                        for (int var12 = 0; var12 < 9; ++var12)
-                        {
-                            if (var1 == 2 + var12)
-                            {
-                                this.updateDebugProfilerName(var12 + 1);
-                            }
-                        }
-                    }
-                }
-            }
-
-            for (var1 = 0; var1 < 9; ++var1)
-            {
-                if (this.gameSettings.keyBindsHotbar[var1].isPressed())
-                {
-                    if (this.thePlayer.func_175149_v())
-                    {
-                        this.ingameGUI.func_175187_g().func_175260_a(var1);
-                    }
-                    else
-                    {
-                        this.thePlayer.inventory.currentItem = var1;
-                    }
-                }
-            }
-
-            boolean var9 = this.gameSettings.chatVisibility != EntityPlayer.EnumChatVisibility.HIDDEN;
-
-            while (this.gameSettings.keyBindInventory.isPressed())
-            {
-                if (this.playerController.isRidingHorse())
-                {
-                    this.thePlayer.func_175163_u();
-                }
-                else
-                {
-                    this.getNetHandler().addToSendQueue(new C16PacketClientStatus(C16PacketClientStatus.EnumState.OPEN_INVENTORY_ACHIEVEMENT));
-                    this.displayGuiScreen(new GuiInventory(this.thePlayer));
-                }
-            }
-
-            while (this.gameSettings.keyBindDrop.isPressed())
-            {
-                if (!this.thePlayer.func_175149_v())
-                {
-                    this.thePlayer.dropOneItem(GuiScreen.isCtrlKeyDown());
-                }
-            }
-
-            while (this.gameSettings.keyBindChat.isPressed() && var9)
-            {
-                this.displayGuiScreen(new GuiChat());
-            }
-
-            if (this.currentScreen == null && this.gameSettings.keyBindCommand.isPressed() && var9)
-            {
-                this.displayGuiScreen(new GuiChat("/"));
-            }
-
-            if (this.thePlayer.isUsingItem())
-            {
-                if (!this.gameSettings.keyBindUseItem.getIsKeyPressed())
-                {
-                    this.playerController.onStoppedUsingItem(this.thePlayer);
-                }
-
-                label435:
-
-                while (true)
-                {
-                    if (!this.gameSettings.keyBindAttack.isPressed())
-                    {
-                        while (this.gameSettings.keyBindUseItem.isPressed())
-                        {
-                            ;
-                        }
-
-                        while (true)
-                        {
-                            if (this.gameSettings.keyBindPickBlock.isPressed())
-                            {
-                                continue;
-                            }
-
-                            break label435;
-                        }
-                    }
-                }
-            }
-            else
-            {
-                while (this.gameSettings.keyBindAttack.isPressed())
-                {
-                    this.clickMouse();
-                }
-
-                while (this.gameSettings.keyBindUseItem.isPressed())
-                {
-                    this.rightClickMouse();
-                }
-
-                while (this.gameSettings.keyBindPickBlock.isPressed())
-                {
-                    this.middleClickMouse();
-                }
-            }
-
-            if (this.gameSettings.keyBindUseItem.getIsKeyPressed() && this.rightClickDelayTimer == 0 && !this.thePlayer.isUsingItem())
-            {
-                this.rightClickMouse();
-            }
-
-            this.sendClickBlockToController(this.currentScreen == null && this.gameSettings.keyBindAttack.getIsKeyPressed() && this.inGameHasFocus);
-        }
-
-        if (this.theWorld != null)
-        {
-            if (this.thePlayer != null)
-            {
-                ++this.joinPlayerCounter;
-
-                if (this.joinPlayerCounter == 30)
-                {
-                    this.joinPlayerCounter = 0;
-                    this.theWorld.joinEntityInSurroundings(this.thePlayer);
-                }
-            }
-
-            this.mcProfiler.endStartSection("gameRenderer");
-
-            if (!this.isGamePaused)
-            {
-                this.entityRenderer.updateRenderer();
-            }
-
-            this.mcProfiler.endStartSection("levelRenderer");
-
-            if (!this.isGamePaused)
-            {
-                this.renderGlobal.updateClouds();
-            }
-
-            this.mcProfiler.endStartSection("level");
-
-            if (!this.isGamePaused)
-            {
-                if (this.theWorld.func_175658_ac() > 0)
-                {
-                    this.theWorld.setLastLightningBolt(this.theWorld.func_175658_ac() - 1);
-                }
-
-                this.theWorld.updateEntities();
-            }
-        }
-
-        if (!this.isGamePaused)
-        {
-            this.mcMusicTicker.update();
-            this.mcSoundHandler.update();
-        }
-
-        if (this.theWorld != null)
-        {
-            if (!this.isGamePaused)
-            {
-                this.theWorld.setAllowedSpawnTypes(this.theWorld.getDifficulty() != EnumDifficulty.PEACEFUL, true);
-
-                try
-                {
-                    this.theWorld.tick();
-                }
-                catch (Throwable var8)
-                {
-                    var2 = CrashReport.makeCrashReport(var8, "Exception in world tick");
-
-                    if (this.theWorld == null)
-                    {
-                        var3 = var2.makeCategory("Affected level");
-                        var3.addCrashSection("Problem", "Level is null!");
-                    }
-                    else
-                    {
-                        this.theWorld.addWorldInfoToCrashReport(var2);
-                    }
-
-                    throw new ReportedException(var2);
-                }
-            }
-
-            this.mcProfiler.endStartSection("animateTick");
-
-            if (!this.isGamePaused && this.theWorld != null)
-            {
-                this.theWorld.doVoidFogParticles(MathHelper.floor_double(this.thePlayer.posX), MathHelper.floor_double(this.thePlayer.posY), MathHelper.floor_double(this.thePlayer.posZ));
-            }
-
-            this.mcProfiler.endStartSection("particles");
-
-            if (!this.isGamePaused)
-            {
-                this.effectRenderer.updateEffects();
-            }
-        }
-        else if (this.myNetworkManager != null)
-        {
-            this.mcProfiler.endStartSection("pendingConnection");
-            this.myNetworkManager.processReceivedPackets();
-        }
-
-        this.mcProfiler.endSection();
-        this.systemTime = getSystemTime();
-    }
-
-    /**
-     * Arguments: World foldername,  World ingame name, WorldSettings
-     */
-    public void launchIntegratedServer(String folderName, String worldName, WorldSettings worldSettingsIn)
-    {
-        this.loadWorld((WorldClient)null);
-        System.gc();
-        ISaveHandler var4 = this.saveLoader.getSaveLoader(folderName, false);
-        WorldInfo var5 = var4.loadWorldInfo();
-
-        if (var5 == null && worldSettingsIn != null)
-        {
-            var5 = new WorldInfo(worldSettingsIn, folderName);
-            var4.saveWorldInfo(var5);
-        }
-
-        if (worldSettingsIn == null)
-        {
-            worldSettingsIn = new WorldSettings(var5);
-        }
-
-        try
-        {
-            this.theIntegratedServer = new IntegratedServer(this, folderName, worldName, worldSettingsIn);
-            this.theIntegratedServer.startServerThread();
-            this.integratedServerIsRunning = true;
-        }
-        catch (Throwable var10)
-        {
-            CrashReport var7 = CrashReport.makeCrashReport(var10, "Starting integrated server");
-            CrashReportCategory var8 = var7.makeCategory("Starting integrated server");
-            var8.addCrashSection("Level ID", folderName);
-            var8.addCrashSection("Level Name", worldName);
-            throw new ReportedException(var7);
-        }
-
-        this.loadingScreen.displaySavingString(I18n.format("menu.loadingLevel", new Object[0]));
-
-        while (!this.theIntegratedServer.serverIsInRunLoop())
-        {
-            String var6 = this.theIntegratedServer.getUserMessage();
-
-            if (var6 != null)
-            {
-                this.loadingScreen.displayLoadingString(I18n.format(var6, new Object[0]));
-            }
-            else
-            {
-                this.loadingScreen.displayLoadingString("");
-            }
-
-            try
-            {
-                Thread.sleep(200L);
-            }
-            catch (InterruptedException var9)
-            {
-                ;
-            }
-        }
-
-        this.displayGuiScreen((GuiScreen)null);
-        SocketAddress var11 = this.theIntegratedServer.getNetworkSystem().addLocalEndpoint();
-        NetworkManager var12 = NetworkManager.provideLocalClient(var11);
-        var12.setNetHandler(new NetHandlerLoginClient(var12, this, (GuiScreen)null));
-        var12.sendPacket(new C00Handshake(47, var11.toString(), 0, EnumConnectionState.LOGIN));
-        var12.sendPacket(new C00PacketLoginStart(this.getSession().getProfile()));
-        this.myNetworkManager = var12;
-    }
-
-    /**
-     * unloads the current world first
-     */
-    public void loadWorld(WorldClient worldClientIn)
-    {
-        this.loadWorld(worldClientIn, "");
-    }
-
-    /**
-     * par2Str is displayed on the loading screen to the user unloads the current world first
-     */
-    public void loadWorld(WorldClient worldClientIn, String loadingMessage)
-    {
-        if (worldClientIn == null)
-        {
-            NetHandlerPlayClient var3 = this.getNetHandler();
-
-            if (var3 != null)
-            {
-                var3.cleanup();
-            }
-
-            if (this.theIntegratedServer != null && this.theIntegratedServer.func_175578_N())
-            {
-                this.theIntegratedServer.initiateShutdown();
-                this.theIntegratedServer.func_175592_a();
-            }
-
-            this.theIntegratedServer = null;
-            this.guiAchievement.clearAchievements();
-            this.entityRenderer.getMapItemRenderer().func_148249_a();
-        }
-
-        this.field_175622_Z = null;
-        this.myNetworkManager = null;
-
-        if (this.loadingScreen != null)
-        {
-            this.loadingScreen.resetProgressAndMessage(loadingMessage);
-            this.loadingScreen.displayLoadingString("");
-        }
-
-        if (worldClientIn == null && this.theWorld != null)
-        {
-            if (this.mcResourcePackRepository.getResourcePackInstance() != null)
-            {
-                this.mcResourcePackRepository.func_148529_f();
-                this.func_175603_A();
-            }
-
-            this.setServerData((ServerData)null);
-            this.integratedServerIsRunning = false;
-        }
-
-        this.mcSoundHandler.stopSounds();
-        this.theWorld = worldClientIn;
-
-        if (worldClientIn != null)
-        {
-            if (this.renderGlobal != null)
-            {
-                this.renderGlobal.setWorldAndLoadRenderers(worldClientIn);
-            }
-
-            if (this.effectRenderer != null)
-            {
-                this.effectRenderer.clearEffects(worldClientIn);
-            }
-
-            if (this.thePlayer == null)
-            {
-                this.thePlayer = this.playerController.func_178892_a(worldClientIn, new StatFileWriter());
-                this.playerController.flipPlayer(this.thePlayer);
-            }
-
-            this.thePlayer.preparePlayerToSpawn();
-            worldClientIn.spawnEntityInWorld(this.thePlayer);
-            this.thePlayer.movementInput = new MovementInputFromOptions(this.gameSettings);
-            this.playerController.setPlayerCapabilities(this.thePlayer);
-            this.field_175622_Z = this.thePlayer;
-        }
-        else
-        {
-            this.saveLoader.flushCache();
-            this.thePlayer = null;
-        }
-
-        System.gc();
-        this.systemTime = 0L;
-    }
-
-    public void setDimensionAndSpawnPlayer(int dimension)
-    {
-        this.theWorld.setInitialSpawnLocation();
-        this.theWorld.removeAllEntities();
-        int var2 = 0;
-        String var3 = null;
-
-        if (this.thePlayer != null)
-        {
-            var2 = this.thePlayer.getEntityId();
-            this.theWorld.removeEntity(this.thePlayer);
-            var3 = this.thePlayer.getClientBrand();
-        }
-
-        this.field_175622_Z = null;
-        EntityPlayerSP var4 = this.thePlayer;
-        this.thePlayer = this.playerController.func_178892_a(this.theWorld, this.thePlayer == null ? new StatFileWriter() : this.thePlayer.getStatFileWriter());
-        this.thePlayer.getDataWatcher().updateWatchedObjectsFromList(var4.getDataWatcher().getAllWatched());
-        this.thePlayer.dimension = dimension;
-        this.field_175622_Z = this.thePlayer;
-        this.thePlayer.preparePlayerToSpawn();
-        this.thePlayer.func_175158_f(var3);
-        this.theWorld.spawnEntityInWorld(this.thePlayer);
-        this.playerController.flipPlayer(this.thePlayer);
-        this.thePlayer.movementInput = new MovementInputFromOptions(this.gameSettings);
-        this.thePlayer.setEntityId(var2);
-        this.playerController.setPlayerCapabilities(this.thePlayer);
-        this.thePlayer.func_175150_k(var4.func_175140_cp());
-
-        if (this.currentScreen instanceof GuiGameOver)
-        {
-            this.displayGuiScreen((GuiScreen)null);
-        }
-    }
-
-    /**
-     * Gets whether this is a demo or not.
-     */
-    public final boolean isDemo()
-    {
-        return this.isDemo;
-    }
-
-    public NetHandlerPlayClient getNetHandler()
-    {
-        return this.thePlayer != null ? this.thePlayer.sendQueue : null;
-    }
-
-    public static boolean isGuiEnabled()
-    {
-        return theMinecraft == null || !theMinecraft.gameSettings.hideGUI;
-    }
-
-    public static boolean isFancyGraphicsEnabled()
-    {
-        return theMinecraft != null && theMinecraft.gameSettings.fancyGraphics;
-    }
-
-    /**
-     * Returns if ambient occlusion is enabled
-     */
-    public static boolean isAmbientOcclusionEnabled()
-    {
-        return theMinecraft != null && theMinecraft.gameSettings.ambientOcclusion != 0;
-    }
-
-    /**
-     * Called when user clicked he's mouse middle button (pick block)
-     */
-    private void middleClickMouse()
-    {
-        if (this.objectMouseOver != null)
-        {
-            boolean var1 = this.thePlayer.capabilities.isCreativeMode;
-            int var3 = 0;
-            boolean var4 = false;
-            TileEntity var5 = null;
-            Object var2;
-
-            if (this.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
-            {
-                BlockPos var6 = this.objectMouseOver.func_178782_a();
-                Block var7 = this.theWorld.getBlockState(var6).getBlock();
-
-                if (var7.getMaterial() == Material.air)
-                {
-                    return;
-                }
-
-                var2 = var7.getItem(this.theWorld, var6);
-
-                if (var2 == null)
-                {
-                    return;
-                }
-
-                if (var1 && GuiScreen.isCtrlKeyDown())
-                {
-                    var5 = this.theWorld.getTileEntity(var6);
-                }
-
-                Block var8 = var2 instanceof ItemBlock && !var7.isFlowerPot() ? Block.getBlockFromItem((Item)var2) : var7;
-                var3 = var8.getDamageValue(this.theWorld, var6);
-                var4 = ((Item)var2).getHasSubtypes();
-            }
-            else
-            {
-                if (this.objectMouseOver.typeOfHit != MovingObjectPosition.MovingObjectType.ENTITY || this.objectMouseOver.entityHit == null || !var1)
-                {
-                    return;
-                }
-
-                if (this.objectMouseOver.entityHit instanceof EntityPainting)
-                {
-                    var2 = Items.painting;
-                }
-                else if (this.objectMouseOver.entityHit instanceof EntityLeashKnot)
-                {
-                    var2 = Items.lead;
-                }
-                else if (this.objectMouseOver.entityHit instanceof EntityItemFrame)
-                {
-                    EntityItemFrame var11 = (EntityItemFrame)this.objectMouseOver.entityHit;
-                    ItemStack var14 = var11.getDisplayedItem();
-
-                    if (var14 == null)
-                    {
-                        var2 = Items.item_frame;
-                    }
-                    else
-                    {
-                        var2 = var14.getItem();
-                        var3 = var14.getMetadata();
-                        var4 = true;
-                    }
-                }
-                else if (this.objectMouseOver.entityHit instanceof EntityMinecart)
-                {
-                    EntityMinecart var12 = (EntityMinecart)this.objectMouseOver.entityHit;
-
-                    switch (Minecraft.SwitchEnumMinecartType.field_178901_b[var12.func_180456_s().ordinal()])
-                    {
-                        case 1:
-                            var2 = Items.furnace_minecart;
-                            break;
-
-                        case 2:
-                            var2 = Items.chest_minecart;
-                            break;
-
-                        case 3:
-                            var2 = Items.tnt_minecart;
-                            break;
-
-                        case 4:
-                            var2 = Items.hopper_minecart;
-                            break;
-
-                        case 5:
-                            var2 = Items.command_block_minecart;
-                            break;
-
-                        default:
-                            var2 = Items.minecart;
-                    }
-                }
-                else if (this.objectMouseOver.entityHit instanceof EntityBoat)
-                {
-                    var2 = Items.boat;
-                }
-                else if (this.objectMouseOver.entityHit instanceof EntityArmorStand)
-                {
-                    var2 = Items.armor_stand;
-                }
-                else
-                {
-                    var2 = Items.spawn_egg;
-                    var3 = EntityList.getEntityID(this.objectMouseOver.entityHit);
-                    var4 = true;
-
-                    if (!EntityList.entityEggs.containsKey(Integer.valueOf(var3)))
-                    {
-                        return;
-                    }
-                }
-            }
-
-            InventoryPlayer var13 = this.thePlayer.inventory;
-
-            if (var5 == null)
-            {
-                var13.setCurrentItem((Item)var2, var3, var4, var1);
-            }
-            else
-            {
-                NBTTagCompound var15 = new NBTTagCompound();
-                var5.writeToNBT(var15);
-                ItemStack var17 = new ItemStack((Item)var2, 1, var3);
-                var17.setTagInfo("BlockEntityTag", var15);
-                NBTTagCompound var9 = new NBTTagCompound();
-                NBTTagList var10 = new NBTTagList();
-                var10.appendTag(new NBTTagString("(+NBT)"));
-                var9.setTag("Lore", var10);
-                var17.setTagInfo("display", var9);
-                var13.setInventorySlotContents(var13.currentItem, var17);
-            }
-
-            if (var1)
-            {
-                int var16 = this.thePlayer.inventoryContainer.inventorySlots.size() - 9 + var13.currentItem;
-                this.playerController.sendSlotPacket(var13.getStackInSlot(var13.currentItem), var16);
-            }
-        }
-    }
-
-    /**
-     * adds core server Info (GL version , Texture pack, isModded, type), and the worldInfo to the crash report
-     */
-    public CrashReport addGraphicsAndWorldToCrashReport(CrashReport theCrash)
-    {
-        theCrash.getCategory().addCrashSectionCallable("Launched Version", new Callable()
-        {
-            private static final String __OBFID = "CL_00000643";
-            public String call()
-            {
-                return Minecraft.this.launchedVersion;
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("LWJGL", new Callable()
-        {
-            private static final String __OBFID = "CL_00000644";
-            public String call()
-            {
-                return Sys.getVersion();
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("OpenGL", new Callable()
-        {
-            private static final String __OBFID = "CL_00000645";
-            public String call()
-            {
-                return GL11.glGetString(GL11.GL_RENDERER) + " GL version " + GL11.glGetString(GL11.GL_VERSION) + ", " + GL11.glGetString(GL11.GL_VENDOR);
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("GL Caps", new Callable()
-        {
-            private static final String __OBFID = "CL_00000646";
-            public String call()
-            {
-                return OpenGlHelper.func_153172_c();
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Using VBOs", new Callable()
-        {
-            private static final String __OBFID = "CL_00000647";
-            public String call()
-            {
-                return Minecraft.this.gameSettings.field_178881_t ? "Yes" : "No";
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Is Modded", new Callable()
-        {
-            private static final String __OBFID = "CL_00000633";
-            public String call()
-            {
-                String var1 = ClientBrandRetriever.getClientModName();
-                return !var1.equals("vanilla") ? "Definitely; Client brand changed to \'" + var1 + "\'" : (Minecraft.class.getSigners() == null ? "Very likely; Jar signature invalidated" : "Probably not. Jar signature remains and client brand is untouched.");
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Type", new Callable()
-        {
-            private static final String __OBFID = "CL_00000634";
-            public String call()
-            {
-                return "Client (map_client.txt)";
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Resource Packs", new Callable()
-        {
-            private static final String __OBFID = "CL_00000635";
-            public String call()
-            {
-                return Minecraft.this.gameSettings.resourcePacks.toString();
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Current Language", new Callable()
-        {
-            private static final String __OBFID = "CL_00000636";
-            public String call()
-            {
-                return Minecraft.this.mcLanguageManager.getCurrentLanguage().toString();
-            }
-        });
-        theCrash.getCategory().addCrashSectionCallable("Profiler Position", new Callable()
-        {
-            private static final String __OBFID = "CL_00000637";
-            public String call()
-            {
-                return Minecraft.this.mcProfiler.profilingEnabled ? Minecraft.this.mcProfiler.getNameOfLastSection() : "N/A (disabled)";
-            }
-        });
-
-        if (this.theWorld != null)
-        {
-            this.theWorld.addWorldInfoToCrashReport(theCrash);
-        }
-
-        return theCrash;
-    }
-
-    /**
-     * Return the singleton Minecraft instance for the game
-     */
-    public static Minecraft getMinecraft()
-    {
-        return theMinecraft;
-    }
-
-    public ListenableFuture func_175603_A()
-    {
-        return this.addScheduledTask(new Runnable()
-        {
-            private static final String __OBFID = "CL_00001853";
-            public void run()
-            {
-                Minecraft.this.refreshResources();
-            }
-        });
-    }
-
-    public void addServerStatsToSnooper(PlayerUsageSnooper playerSnooper)
-    {
-        playerSnooper.addClientStat("fps", Integer.valueOf(debugFPS));
-        playerSnooper.addClientStat("vsync_enabled", Boolean.valueOf(this.gameSettings.enableVsync));
-        playerSnooper.addClientStat("display_frequency", Integer.valueOf(Display.getDisplayMode().getFrequency()));
-        playerSnooper.addClientStat("display_type", this.fullscreen ? "fullscreen" : "windowed");
-        playerSnooper.addClientStat("run_time", Long.valueOf((MinecraftServer.getCurrentTimeMillis() - playerSnooper.getMinecraftStartTimeMillis()) / 60L * 1000L));
-        String var2 = ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN ? "little" : "big";
-        playerSnooper.addClientStat("endianness", var2);
-        playerSnooper.addClientStat("resource_packs", Integer.valueOf(this.mcResourcePackRepository.getRepositoryEntries().size()));
-        int var3 = 0;
-        Iterator var4 = this.mcResourcePackRepository.getRepositoryEntries().iterator();
-
-        while (var4.hasNext())
-        {
-            ResourcePackRepository.Entry var5 = (ResourcePackRepository.Entry)var4.next();
-            playerSnooper.addClientStat("resource_pack[" + var3++ + "]", var5.getResourcePackName());
-        }
-
-        if (this.theIntegratedServer != null && this.theIntegratedServer.getPlayerUsageSnooper() != null)
-        {
-            playerSnooper.addClientStat("snooper_partner", this.theIntegratedServer.getPlayerUsageSnooper().getUniqueID());
-        }
-    }
-
-    public void addServerTypeToSnooper(PlayerUsageSnooper playerSnooper)
-    {
-        playerSnooper.addStatToSnooper("opengl_version", GL11.glGetString(GL11.GL_VERSION));
-        playerSnooper.addStatToSnooper("opengl_vendor", GL11.glGetString(GL11.GL_VENDOR));
-        playerSnooper.addStatToSnooper("client_brand", ClientBrandRetriever.getClientModName());
-        playerSnooper.addStatToSnooper("launched_version", this.launchedVersion);
-        ContextCapabilities var2 = GLContext.getCapabilities();
-        playerSnooper.addStatToSnooper("gl_caps[ARB_arrays_of_arrays]", Boolean.valueOf(var2.GL_ARB_arrays_of_arrays));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_base_instance]", Boolean.valueOf(var2.GL_ARB_base_instance));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_blend_func_extended]", Boolean.valueOf(var2.GL_ARB_blend_func_extended));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_clear_buffer_object]", Boolean.valueOf(var2.GL_ARB_clear_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_color_buffer_float]", Boolean.valueOf(var2.GL_ARB_color_buffer_float));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_compatibility]", Boolean.valueOf(var2.GL_ARB_compatibility));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_compressed_texture_pixel_storage]", Boolean.valueOf(var2.GL_ARB_compressed_texture_pixel_storage));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_compute_shader]", Boolean.valueOf(var2.GL_ARB_compute_shader));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_buffer]", Boolean.valueOf(var2.GL_ARB_copy_buffer));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_image]", Boolean.valueOf(var2.GL_ARB_copy_image));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_buffer_float]", Boolean.valueOf(var2.GL_ARB_depth_buffer_float));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_compute_shader]", Boolean.valueOf(var2.GL_ARB_compute_shader));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_buffer]", Boolean.valueOf(var2.GL_ARB_copy_buffer));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_image]", Boolean.valueOf(var2.GL_ARB_copy_image));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_buffer_float]", Boolean.valueOf(var2.GL_ARB_depth_buffer_float));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_clamp]", Boolean.valueOf(var2.GL_ARB_depth_clamp));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_texture]", Boolean.valueOf(var2.GL_ARB_depth_texture));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_buffers]", Boolean.valueOf(var2.GL_ARB_draw_buffers));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_buffers_blend]", Boolean.valueOf(var2.GL_ARB_draw_buffers_blend));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_elements_base_vertex]", Boolean.valueOf(var2.GL_ARB_draw_elements_base_vertex));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_indirect]", Boolean.valueOf(var2.GL_ARB_draw_indirect));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_instanced]", Boolean.valueOf(var2.GL_ARB_draw_instanced));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_explicit_attrib_location]", Boolean.valueOf(var2.GL_ARB_explicit_attrib_location));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_explicit_uniform_location]", Boolean.valueOf(var2.GL_ARB_explicit_uniform_location));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_layer_viewport]", Boolean.valueOf(var2.GL_ARB_fragment_layer_viewport));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_program]", Boolean.valueOf(var2.GL_ARB_fragment_program));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_shader]", Boolean.valueOf(var2.GL_ARB_fragment_shader));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_program_shadow]", Boolean.valueOf(var2.GL_ARB_fragment_program_shadow));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_framebuffer_object]", Boolean.valueOf(var2.GL_ARB_framebuffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_framebuffer_sRGB]", Boolean.valueOf(var2.GL_ARB_framebuffer_sRGB));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_geometry_shader4]", Boolean.valueOf(var2.GL_ARB_geometry_shader4));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_gpu_shader5]", Boolean.valueOf(var2.GL_ARB_gpu_shader5));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_half_float_pixel]", Boolean.valueOf(var2.GL_ARB_half_float_pixel));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_half_float_vertex]", Boolean.valueOf(var2.GL_ARB_half_float_vertex));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_instanced_arrays]", Boolean.valueOf(var2.GL_ARB_instanced_arrays));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_map_buffer_alignment]", Boolean.valueOf(var2.GL_ARB_map_buffer_alignment));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_map_buffer_range]", Boolean.valueOf(var2.GL_ARB_map_buffer_range));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_multisample]", Boolean.valueOf(var2.GL_ARB_multisample));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_multitexture]", Boolean.valueOf(var2.GL_ARB_multitexture));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_occlusion_query2]", Boolean.valueOf(var2.GL_ARB_occlusion_query2));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_pixel_buffer_object]", Boolean.valueOf(var2.GL_ARB_pixel_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_seamless_cube_map]", Boolean.valueOf(var2.GL_ARB_seamless_cube_map));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_objects]", Boolean.valueOf(var2.GL_ARB_shader_objects));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_stencil_export]", Boolean.valueOf(var2.GL_ARB_shader_stencil_export));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_texture_lod]", Boolean.valueOf(var2.GL_ARB_shader_texture_lod));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_shadow]", Boolean.valueOf(var2.GL_ARB_shadow));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_shadow_ambient]", Boolean.valueOf(var2.GL_ARB_shadow_ambient));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_stencil_texturing]", Boolean.valueOf(var2.GL_ARB_stencil_texturing));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_sync]", Boolean.valueOf(var2.GL_ARB_sync));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_tessellation_shader]", Boolean.valueOf(var2.GL_ARB_tessellation_shader));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_border_clamp]", Boolean.valueOf(var2.GL_ARB_texture_border_clamp));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_buffer_object]", Boolean.valueOf(var2.GL_ARB_texture_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_cube_map]", Boolean.valueOf(var2.GL_ARB_texture_cube_map));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_cube_map_array]", Boolean.valueOf(var2.GL_ARB_texture_cube_map_array));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_non_power_of_two]", Boolean.valueOf(var2.GL_ARB_texture_non_power_of_two));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_uniform_buffer_object]", Boolean.valueOf(var2.GL_ARB_uniform_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_blend]", Boolean.valueOf(var2.GL_ARB_vertex_blend));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_buffer_object]", Boolean.valueOf(var2.GL_ARB_vertex_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_program]", Boolean.valueOf(var2.GL_ARB_vertex_program));
-        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_shader]", Boolean.valueOf(var2.GL_ARB_vertex_shader));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_bindable_uniform]", Boolean.valueOf(var2.GL_EXT_bindable_uniform));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_equation_separate]", Boolean.valueOf(var2.GL_EXT_blend_equation_separate));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_func_separate]", Boolean.valueOf(var2.GL_EXT_blend_func_separate));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_minmax]", Boolean.valueOf(var2.GL_EXT_blend_minmax));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_subtract]", Boolean.valueOf(var2.GL_EXT_blend_subtract));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_draw_instanced]", Boolean.valueOf(var2.GL_EXT_draw_instanced));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_multisample]", Boolean.valueOf(var2.GL_EXT_framebuffer_multisample));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_object]", Boolean.valueOf(var2.GL_EXT_framebuffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_sRGB]", Boolean.valueOf(var2.GL_EXT_framebuffer_sRGB));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_geometry_shader4]", Boolean.valueOf(var2.GL_EXT_geometry_shader4));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_gpu_program_parameters]", Boolean.valueOf(var2.GL_EXT_gpu_program_parameters));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_gpu_shader4]", Boolean.valueOf(var2.GL_EXT_gpu_shader4));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_multi_draw_arrays]", Boolean.valueOf(var2.GL_EXT_multi_draw_arrays));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_packed_depth_stencil]", Boolean.valueOf(var2.GL_EXT_packed_depth_stencil));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_paletted_texture]", Boolean.valueOf(var2.GL_EXT_paletted_texture));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_rescale_normal]", Boolean.valueOf(var2.GL_EXT_rescale_normal));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_separate_shader_objects]", Boolean.valueOf(var2.GL_EXT_separate_shader_objects));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_shader_image_load_store]", Boolean.valueOf(var2.GL_EXT_shader_image_load_store));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_shadow_funcs]", Boolean.valueOf(var2.GL_EXT_shadow_funcs));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_shared_texture_palette]", Boolean.valueOf(var2.GL_EXT_shared_texture_palette));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_clear_tag]", Boolean.valueOf(var2.GL_EXT_stencil_clear_tag));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_two_side]", Boolean.valueOf(var2.GL_EXT_stencil_two_side));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_wrap]", Boolean.valueOf(var2.GL_EXT_stencil_wrap));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_3d]", Boolean.valueOf(var2.GL_EXT_texture_3d));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_array]", Boolean.valueOf(var2.GL_EXT_texture_array));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_buffer_object]", Boolean.valueOf(var2.GL_EXT_texture_buffer_object));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_integer]", Boolean.valueOf(var2.GL_EXT_texture_integer));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_lod_bias]", Boolean.valueOf(var2.GL_EXT_texture_lod_bias));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_sRGB]", Boolean.valueOf(var2.GL_EXT_texture_sRGB));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_vertex_shader]", Boolean.valueOf(var2.GL_EXT_vertex_shader));
-        playerSnooper.addStatToSnooper("gl_caps[EXT_vertex_weighting]", Boolean.valueOf(var2.GL_EXT_vertex_weighting));
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_uniforms]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_UNIFORM_COMPONENTS)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_fragment_uniforms]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_FRAGMENT_UNIFORM_COMPONENTS)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_attribs]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_ATTRIBS)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_texture_image_units]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_texture_image_units]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_TEXTURE_IMAGE_UNITS)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_caps[gl_max_texture_image_units]", Integer.valueOf(GL11.glGetInteger(35071)));
-        GL11.glGetError();
-        playerSnooper.addStatToSnooper("gl_max_texture_size", Integer.valueOf(getGLMaximumTextureSize()));
-    }
-
-    /**
-     * Used in the usage snooper.
-     */
-    public static int getGLMaximumTextureSize()
-    {
-        for (int var0 = 16384; var0 > 0; var0 >>= 1)
-        {
-            GL11.glTexImage2D(GL11.GL_PROXY_TEXTURE_2D, 0, GL11.GL_RGBA, var0, var0, 0, GL11.GL_RGBA, GL11.GL_UNSIGNED_BYTE, (ByteBuffer)null);
-            int var1 = GL11.glGetTexLevelParameteri(GL11.GL_PROXY_TEXTURE_2D, 0, GL11.GL_TEXTURE_WIDTH);
-
-            if (var1 != 0)
-            {
-                return var0;
-            }
-        }
-
-        return -1;
-    }
-
-    /**
-     * Returns whether snooping is enabled or not.
-     */
-    public boolean isSnooperEnabled()
-    {
-        return this.gameSettings.snooperEnabled;
-    }
-
-    /**
-     * Set the current ServerData instance.
-     */
-    public void setServerData(ServerData serverDataIn)
-    {
-        this.currentServerData = serverDataIn;
-    }
-
-    public ServerData getCurrentServerData()
-    {
-        return this.currentServerData;
-    }
-
-    public boolean isIntegratedServerRunning()
-    {
-        return this.integratedServerIsRunning;
-    }
-
-    /**
-     * Returns true if there is only one player playing, and the current server is the integrated one.
-     */
-    public boolean isSingleplayer()
-    {
-        return this.integratedServerIsRunning && this.theIntegratedServer != null;
-    }
-
-    /**
-     * Returns the currently running integrated server
-     */
-    public IntegratedServer getIntegratedServer()
-    {
-        return this.theIntegratedServer;
-    }
-
-    public static void stopIntegratedServer()
-    {
-        if (theMinecraft != null)
-        {
-            IntegratedServer var0 = theMinecraft.getIntegratedServer();
-
-            if (var0 != null)
-            {
-                var0.stopServer();
-            }
-        }
-    }
-
-    /**
-     * Returns the PlayerUsageSnooper instance.
-     */
-    public PlayerUsageSnooper getPlayerUsageSnooper()
-    {
-        return this.usageSnooper;
-    }
-
-    /**
-     * Gets the system time in milliseconds.
-     */
-    public static long getSystemTime()
-    {
-        return Sys.getTime() * 1000L / Sys.getTimerResolution();
-    }
-
-    /**
-     * Returns whether we're in full screen or not.
-     */
-    public boolean isFullScreen()
-    {
-        return this.fullscreen;
-    }
-
-    public Session getSession()
-    {
-        return this.session;
-    }
-
-    public PropertyMap func_180509_L()
-    {
-        return this.twitchDetails;
-    }
-
-    public Proxy getProxy()
-    {
-        return this.proxy;
-    }
-
-    public TextureManager getTextureManager()
-    {
-        return this.renderEngine;
-    }
-
-    public IResourceManager getResourceManager()
-    {
-        return this.mcResourceManager;
-    }
-
-    public ResourcePackRepository getResourcePackRepository()
-    {
-        return this.mcResourcePackRepository;
-    }
-
-    public LanguageManager getLanguageManager()
-    {
-        return this.mcLanguageManager;
-    }
-
-    public TextureMap getTextureMapBlocks()
-    {
-        return this.textureMapBlocks;
-    }
-
-    public boolean isJava64bit()
-    {
-        return this.jvm64bit;
-    }
-
-    public boolean isGamePaused()
-    {
-        return this.isGamePaused;
-    }
-
-    public SoundHandler getSoundHandler()
-    {
-        return this.mcSoundHandler;
-    }
-
-    public MusicTicker.MusicType getAmbientMusicType()
-    {
-        return this.currentScreen instanceof GuiWinGame ? MusicTicker.MusicType.CREDITS : (this.thePlayer != null ? (this.thePlayer.worldObj.provider instanceof WorldProviderHell ? MusicTicker.MusicType.NETHER : (this.thePlayer.worldObj.provider instanceof WorldProviderEnd ? (BossStatus.bossName != null && BossStatus.statusBarTime > 0 ? MusicTicker.MusicType.END_BOSS : MusicTicker.MusicType.END) : (this.thePlayer.capabilities.isCreativeMode && this.thePlayer.capabilities.allowFlying ? MusicTicker.MusicType.CREATIVE : MusicTicker.MusicType.GAME))) : MusicTicker.MusicType.MENU);
-    }
-
-    public IStream getTwitchStream()
-    {
-        return this.stream;
-    }
-
-    public void dispatchKeypresses()
-    {
-        int var1 = Keyboard.getEventKey() == 0 ? Keyboard.getEventCharacter() : Keyboard.getEventKey();
-
-        if (var1 != 0 && !Keyboard.isRepeatEvent())
-        {
-            if (!(this.currentScreen instanceof GuiControls) || ((GuiControls)this.currentScreen).time <= getSystemTime() - 20L)
-            {
-                if (Keyboard.getEventKeyState())
-                {
-                    if (var1 == this.gameSettings.keyBindStreamStartStop.getKeyCode())
-                    {
-                        if (this.getTwitchStream().func_152934_n())
-                        {
-                            this.getTwitchStream().func_152914_u();
-                        }
-                        else if (this.getTwitchStream().func_152924_m())
-                        {
-                            this.displayGuiScreen(new GuiYesNo(new GuiYesNoCallback()
-                            {
-                                private static final String __OBFID = "CL_00001852";
-                                public void confirmClicked(boolean result, int id)
-                                {
-                                    if (result)
-                                    {
-                                        Minecraft.this.getTwitchStream().func_152930_t();
-                                    }
-
-                                    Minecraft.this.displayGuiScreen((GuiScreen)null);
-                                }
-                            }, I18n.format("stream.confirm_start", new Object[0]), "", 0));
-                        }
-                        else if (this.getTwitchStream().func_152928_D() && this.getTwitchStream().func_152936_l())
-                        {
-                            if (this.theWorld != null)
-                            {
-                                this.ingameGUI.getChatGUI().printChatMessage(new ChatComponentText("Not ready to start streaming yet!"));
-                            }
-                        }
-                        else
-                        {
-                            GuiStreamUnavailable.func_152321_a(this.currentScreen);
-                        }
-                    }
-                    else if (var1 == this.gameSettings.keyBindStreamPauseUnpause.getKeyCode())
-                    {
-                        if (this.getTwitchStream().func_152934_n())
-                        {
-                            if (this.getTwitchStream().isPaused())
-                            {
-                                this.getTwitchStream().func_152933_r();
-                            }
-                            else
-                            {
-                                this.getTwitchStream().func_152916_q();
-                            }
-                        }
-                    }
-                    else if (var1 == this.gameSettings.keyBindStreamCommercials.getKeyCode())
-                    {
-                        if (this.getTwitchStream().func_152934_n())
-                        {
-                            this.getTwitchStream().func_152931_p();
-                        }
-                    }
-                    else if (var1 == this.gameSettings.keyBindStreamToggleMic.getKeyCode())
-                    {
-                        this.stream.func_152910_a(true);
-                    }
-                    else if (var1 == this.gameSettings.keyBindFullscreen.getKeyCode())
-                    {
-                        this.toggleFullscreen();
-                    }
-                    else if (var1 == this.gameSettings.keyBindScreenshot.getKeyCode())
-                    {
-                        this.ingameGUI.getChatGUI().printChatMessage(ScreenShotHelper.saveScreenshot(this.mcDataDir, this.displayWidth, this.displayHeight, this.framebufferMc));
-                    }
-                }
-                else if (var1 == this.gameSettings.keyBindStreamToggleMic.getKeyCode())
-                {
-                    this.stream.func_152910_a(false);
-                }
-            }
-        }
-    }
-
-    public MinecraftSessionService getSessionService()
-    {
-        return this.sessionService;
-    }
-
-    public SkinManager getSkinManager()
-    {
-        return this.skinManager;
-    }
-
-    public Entity func_175606_aa()
-    {
-        return this.field_175622_Z;
-    }
-
-    public void func_175607_a(Entity p_175607_1_)
-    {
-        this.field_175622_Z = p_175607_1_;
-        this.entityRenderer.func_175066_a(p_175607_1_);
-    }
-
-    public ListenableFuture addScheduledTask(Callable callableToSchedule)
-    {
-        Validate.notNull(callableToSchedule);
-
-        if (!this.isCallingFromMinecraftThread())
-        {
-            ListenableFutureTask var2 = ListenableFutureTask.create(callableToSchedule);
-            Queue var3 = this.scheduledTasks;
-
-            synchronized (this.scheduledTasks)
-            {
-                this.scheduledTasks.add(var2);
-                return var2;
-            }
-        }
-        else
-        {
-            try
-            {
-                return Futures.immediateFuture(callableToSchedule.call());
-            }
-            catch (Exception var6)
-            {
-                return Futures.immediateFailedCheckedFuture(var6);
-            }
-        }
-    }
-
-    public ListenableFuture addScheduledTask(Runnable runnableToSchedule)
-    {
-        Validate.notNull(runnableToSchedule);
-        return this.addScheduledTask(Executors.callable(runnableToSchedule));
-    }
-
-    public boolean isCallingFromMinecraftThread()
-    {
-        return Thread.currentThread() == this.mcThread;
-    }
-
-    public BlockRendererDispatcher getBlockRendererDispatcher()
-    {
-        return this.field_175618_aM;
-    }
-
-    public RenderManager getRenderManager()
-    {
-        return this.renderManager;
-    }
-
-    public RenderItem getRenderItem()
-    {
-        return this.renderItem;
-    }
-
-    public ItemRenderer getItemRenderer()
-    {
-        return this.itemRenderer;
-    }
-
-    public static int func_175610_ah()
-    {
-        return debugFPS;
-    }
-
-    public static Map func_175596_ai()
-    {
-        HashMap var0 = Maps.newHashMap();
-        var0.put("X-Minecraft-Username", getMinecraft().getSession().getUsername());
-        var0.put("X-Minecraft-UUID", getMinecraft().getSession().getPlayerID());
-        var0.put("X-Minecraft-Version", "1.8");
-        return var0;
-    }
-
-    static final class SwitchEnumMinecartType
-    {
-        static final int[] field_152390_a;
-
-        static final int[] field_178901_b = new int[EntityMinecart.EnumMinecartType.values().length];
-        private static final String __OBFID = "CL_00001959";
-
-        static
-        {
-            try
-            {
-                field_178901_b[EntityMinecart.EnumMinecartType.FURNACE.ordinal()] = 1;
-            }
-            catch (NoSuchFieldError var8)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178901_b[EntityMinecart.EnumMinecartType.CHEST.ordinal()] = 2;
-            }
-            catch (NoSuchFieldError var7)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178901_b[EntityMinecart.EnumMinecartType.TNT.ordinal()] = 3;
-            }
-            catch (NoSuchFieldError var6)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178901_b[EntityMinecart.EnumMinecartType.HOPPER.ordinal()] = 4;
-            }
-            catch (NoSuchFieldError var5)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178901_b[EntityMinecart.EnumMinecartType.COMMAND_BLOCK.ordinal()] = 5;
-            }
-            catch (NoSuchFieldError var4)
-            {
-                ;
-            }
-
-            field_152390_a = new int[MovingObjectPosition.MovingObjectType.values().length];
-
-            try
-            {
-                field_152390_a[MovingObjectPosition.MovingObjectType.ENTITY.ordinal()] = 1;
-            }
-            catch (NoSuchFieldError var3)
-            {
-                ;
-            }
-
-            try
-            {
-                field_152390_a[MovingObjectPosition.MovingObjectType.BLOCK.ordinal()] = 2;
-            }
-            catch (NoSuchFieldError var2)
-            {
-                ;
-            }
-
-            try
-            {
-                field_152390_a[MovingObjectPosition.MovingObjectType.MISS.ordinal()] = 3;
-            }
-            catch (NoSuchFieldError var1)
-            {
-                ;
-            }
-        }
-    }
-}
+package net.minecraft.client;
+
+import java.awt.Canvas;
+import java.awt.Color;
+import java.awt.Component;
+import java.awt.Desktop;
+import java.awt.Dimension;
+import java.awt.FlowLayout;
+import java.awt.Toolkit;
+import java.awt.datatransfer.StringSelection;
+import java.awt.event.ActionEvent;
+import java.awt.event.ActionListener;
+import java.awt.event.WindowAdapter;
+import java.awt.event.WindowEvent;
+import java.awt.image.BufferedImage;
+import java.io.BufferedReader;
+import java.io.File;
+import java.io.FileReader;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.io.InputStream;
+import java.io.PrintWriter;
+import java.net.Proxy;
+import java.net.SocketAddress;
+import java.net.URI;
+import java.nio.ByteBuffer;
+import java.nio.ByteOrder;
+import java.text.DecimalFormat;
+import java.text.SimpleDateFormat;
+import java.util.*;
+import java.util.concurrent.Callable;
+import java.util.concurrent.Executors;
+import java.util.concurrent.FutureTask;
+
+import javax.imageio.ImageIO;
+import javax.swing.*;
+
+import net.minecraft.block.Block;
+import net.minecraft.block.material.Material;
+import net.minecraft.client.audio.MusicTicker;
+import net.minecraft.client.audio.SoundHandler;
+import net.minecraft.client.entity.EntityPlayerSP;
+import net.minecraft.client.gui.*;
+import net.minecraft.client.gui.achievement.GuiAchievement;
+import net.minecraft.client.gui.inventory.GuiInventory;
+import net.minecraft.client.gui.stream.GuiStreamUnavailable;
+import net.minecraft.client.main.GameConfiguration;
+import net.minecraft.client.multiplayer.GuiConnecting;
+import net.minecraft.client.multiplayer.PlayerControllerMP;
+import net.minecraft.client.multiplayer.ServerData;
+import net.minecraft.client.multiplayer.WorldClient;
+import net.minecraft.client.network.NetHandlerLoginClient;
+import net.minecraft.client.network.NetHandlerPlayClient;
+import net.minecraft.client.particle.EffectRenderer;
+import net.minecraft.client.renderer.*;
+import net.minecraft.client.renderer.chunk.RenderChunk;
+import net.minecraft.client.renderer.entity.RenderItem;
+import net.minecraft.client.renderer.entity.RenderManager;
+import net.minecraft.client.renderer.texture.DynamicTexture;
+import net.minecraft.client.renderer.texture.TextureManager;
+import net.minecraft.client.renderer.texture.TextureMap;
+import net.minecraft.client.resources.*;
+import net.minecraft.client.resources.data.*;
+import net.minecraft.client.resources.model.ModelManager;
+import net.minecraft.client.settings.GameSettings;
+import net.minecraft.client.settings.KeyBinding;
+import net.minecraft.client.shader.Framebuffer;
+import net.minecraft.client.stream.IStream;
+import net.minecraft.client.stream.NullStream;
+import net.minecraft.client.stream.TwitchStream;
+import net.minecraft.crash.CrashReport;
+import net.minecraft.crash.CrashReportCategory;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLeashKnot;
+import net.minecraft.entity.EntityList;
+import net.minecraft.entity.boss.BossStatus;
+import net.minecraft.entity.item.EntityArmorStand;
+import net.minecraft.entity.item.EntityBoat;
+import net.minecraft.entity.item.EntityItemFrame;
+import net.minecraft.entity.item.EntityMinecart;
+import net.minecraft.entity.item.EntityPainting;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.InventoryPlayer;
+import net.minecraft.init.Bootstrap;
+import net.minecraft.init.Items;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemBlock;
+import net.minecraft.item.ItemStack;
+import net.minecraft.nbt.NBTTagCompound;
+import net.minecraft.nbt.NBTTagList;
+import net.minecraft.nbt.NBTTagString;
+import net.minecraft.network.EnumConnectionState;
+import net.minecraft.network.NetworkManager;
+import net.minecraft.network.handshake.client.C00Handshake;
+import net.minecraft.network.login.client.C00PacketLoginStart;
+import net.minecraft.network.play.client.C16PacketClientStatus;
+import net.minecraft.profiler.IPlayerUsage;
+import net.minecraft.profiler.PlayerUsageSnooper;
+import net.minecraft.profiler.Profiler;
+import net.minecraft.server.MinecraftServer;
+import net.minecraft.server.integrated.IntegratedServer;
+import net.minecraft.stats.AchievementList;
+import net.minecraft.stats.IStatStringFormat;
+import net.minecraft.stats.StatFileWriter;
+import net.minecraft.tileentity.TileEntity;
+import net.minecraft.util.*;
+import net.minecraft.util.Timer;
+import net.minecraft.util.Util;
+import net.minecraft.world.EnumDifficulty;
+import net.minecraft.world.WorldProviderEnd;
+import net.minecraft.world.WorldProviderHell;
+import net.minecraft.world.WorldSettings;
+import net.minecraft.world.chunk.storage.AnvilSaveConverter;
+import net.minecraft.world.storage.ISaveFormat;
+import net.minecraft.world.storage.ISaveHandler;
+import net.minecraft.world.storage.WorldInfo;
+
+import org.apache.commons.io.IOUtils;
+import org.apache.commons.lang3.Validate;
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.LWJGLException;
+import org.lwjgl.Sys;
+import org.lwjgl.input.Keyboard;
+import org.lwjgl.input.Mouse;
+import org.lwjgl.opengl.*;
+import org.lwjgl.util.glu.GLU;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.bot.WurstBot;
+import tk.wurst_client.events.LeftClickEvent;
+import tk.wurst_client.font.Fonts;
+import tk.wurst_client.spam.SpamProcessor;
+import tk.wurst_client.utils.MiscUtils;
+
+import com.google.common.collect.Iterables;
+import com.google.common.collect.Lists;
+import com.google.common.collect.Maps;
+import com.google.common.collect.Queues;
+import com.google.common.collect.Sets;
+import com.google.common.util.concurrent.Futures;
+import com.google.common.util.concurrent.ListenableFuture;
+import com.google.common.util.concurrent.ListenableFutureTask;
+import com.mojang.authlib.minecraft.MinecraftSessionService;
+import com.mojang.authlib.properties.Property;
+import com.mojang.authlib.properties.PropertyMap;
+import com.mojang.authlib.yggdrasil.YggdrasilAuthenticationService;
+
+public class Minecraft implements IThreadListener, IPlayerUsage
+{
+    private static final Logger logger = LogManager.getLogger();
+    //TODO: Client
+    private static final ResourceLocation locationMojangPng = new ResourceLocation("wurst/wurst_loading.png");
+    public static final boolean isRunningOnMac = Util.getOSType() == Util.EnumOS.OSX;
+
+    /** A 10MiB preallocation to ensure the heap is reasonably sized. */
+    public static byte[] memoryReserve = new byte[10485760];
+    private static final List macDisplayModes = Lists.newArrayList(new DisplayMode[] {new DisplayMode(2560, 1600), new DisplayMode(2880, 1800)});
+    private final File fileResourcepacks;
+    private final PropertyMap twitchDetails;
+    private ServerData currentServerData;
+
+    /** The RenderEngine instance used by Minecraft */
+    private TextureManager renderEngine;
+
+    /**
+     * Set to 'this' in Minecraft constructor; used by some settings get methods
+     */
+    private static Minecraft theMinecraft;
+    public PlayerControllerMP playerController;
+    private boolean fullscreen;
+    private boolean field_175619_R = true;
+    private boolean hasCrashed;
+
+    /** Instance of CrashReport. */
+    private CrashReport crashReporter;
+    public int displayWidth;
+    public int displayHeight;
+    private Timer timer = new Timer(20.0F);
+
+    /** Instance of PlayerUsageSnooper. */
+    private PlayerUsageSnooper usageSnooper = new PlayerUsageSnooper("client", this, MinecraftServer.getCurrentTimeMillis());
+    public WorldClient theWorld;
+    public RenderGlobal renderGlobal;
+    private RenderManager renderManager;
+    private RenderItem renderItem;
+    private ItemRenderer itemRenderer;
+    public EntityPlayerSP thePlayer;
+    private Entity field_175622_Z;
+    public Entity pointedEntity;
+    public EffectRenderer effectRenderer;
+    //TODO: Client
+    public Session session;
+    private boolean isGamePaused;
+
+    /** The font renderer used for displaying and measuring text */
+    public FontRenderer fontRendererObj;
+    public FontRenderer standardGalacticFontRenderer;
+
+    /** The GuiScreen that's being displayed at the moment. */
+    public GuiScreen currentScreen;
+    public LoadingScreenRenderer loadingScreen;
+    public EntityRenderer entityRenderer;
+
+    /** Mouse left click counter */
+    private int leftClickCounter;
+
+    /** Display width */
+    private int tempDisplayWidth;
+
+    /** Display height */
+    private int tempDisplayHeight;
+
+    /** Instance of IntegratedServer. */
+    private IntegratedServer theIntegratedServer;
+
+    /** Gui achievement */
+    public GuiAchievement guiAchievement;
+    public GuiIngame ingameGUI;
+
+    /** Skip render world */
+    public boolean skipRenderWorld;
+
+    /** The ray trace hit that the mouse is over. */
+    public MovingObjectPosition objectMouseOver;
+
+    /** The game settings that currently hold effect. */
+    public GameSettings gameSettings;
+
+    /** Mouse helper instance. */
+    public MouseHelper mouseHelper;
+    public final File mcDataDir;
+    private final File fileAssets;
+    private final String launchedVersion;
+    private final Proxy proxy;
+    private ISaveFormat saveLoader;
+
+    /**
+     * This is set to fpsCounter every debug screen update, and is shown on the debug screen. It's also sent as part of
+     * the usage snooping.
+     */
+    private static int debugFPS;
+
+    /**
+     * When you place a block, it's set to 6, decremented once per tick, when it's 0, you can place another block.
+     */
+    //TODO: Client
+    public int rightClickDelayTimer;
+    private String serverName;
+    private int serverPort;
+
+    /**
+     * Does the actual gameplay have focus. If so then mouse and keys will effect the player instead of menus.
+     */
+    public boolean inGameHasFocus;
+    long systemTime = getSystemTime();
+
+    /** Join player counter */
+    private int joinPlayerCounter;
+    private final boolean jvm64bit;
+    private final boolean isDemo;
+    private NetworkManager myNetworkManager;
+    private boolean integratedServerIsRunning;
+
+    /** The profiler instance */
+    public final Profiler mcProfiler = new Profiler();
+
+    /**
+     * Keeps track of how long the debug crash keycombo (F3+C) has been pressed for, in order to crash after 10 seconds.
+     */
+    private long debugCrashKeyPressTime = -1L;
+    private IReloadableResourceManager mcResourceManager;
+    private final IMetadataSerializer metadataSerializer_ = new IMetadataSerializer();
+    private final List defaultResourcePacks = Lists.newArrayList();
+    private final DefaultResourcePack mcDefaultResourcePack;
+    private ResourcePackRepository mcResourcePackRepository;
+    private LanguageManager mcLanguageManager;
+    private IStream stream;
+    private Framebuffer framebufferMc;
+    private TextureMap textureMapBlocks;
+    private SoundHandler mcSoundHandler;
+    private MusicTicker mcMusicTicker;
+    private ResourceLocation mojangLogo;
+    private final MinecraftSessionService sessionService;
+    private SkinManager skinManager;
+    private final Queue scheduledTasks = Queues.newArrayDeque();
+    private long field_175615_aJ = 0L;
+    private final Thread mcThread = Thread.currentThread();
+    private ModelManager modelManager;
+    private BlockRendererDispatcher field_175618_aM;
+
+    /**
+     * Set to true to keep the game loop running. Set to false by shutdown() to allow the game loop to exit cleanly.
+     */
+    volatile boolean running = true;
+
+    /** String that shows the debug information */
+    public String debug = "";
+    public boolean field_175613_B = false;
+    public boolean field_175614_C = false;
+    public boolean field_175611_D = false;
+    public boolean field_175612_E = true;
+
+    /** Approximate time (in ms) of last update to debug string */
+    long debugUpdateTime = getSystemTime();
+
+    /** holds the current fps */
+    int fpsCounter;
+    long prevFrameTime = -1L;
+
+    /** Profiler currently displayed in the debug screen pie chart */
+    private String debugProfilerName = "root";
+    //TODO: Client
+	private JFrame frame;
+	
+    private static final String __OBFID = "CL_00000631";
+
+    public Minecraft(GameConfiguration p_i45547_1_)
+    {
+        theMinecraft = this;
+        this.mcDataDir = p_i45547_1_.field_178744_c.field_178760_a;
+        this.fileAssets = p_i45547_1_.field_178744_c.field_178759_c;
+        this.fileResourcepacks = p_i45547_1_.field_178744_c.field_178758_b;
+        this.launchedVersion = p_i45547_1_.field_178741_d.field_178755_b;
+        this.twitchDetails = p_i45547_1_.field_178745_a.field_178750_b;
+        this.mcDefaultResourcePack = new DefaultResourcePack((new ResourceIndex(p_i45547_1_.field_178744_c.field_178759_c, p_i45547_1_.field_178744_c.field_178757_d)).func_152782_a());
+        this.proxy = p_i45547_1_.field_178745_a.field_178751_c == null ? Proxy.NO_PROXY : p_i45547_1_.field_178745_a.field_178751_c;
+        this.sessionService = (new YggdrasilAuthenticationService(p_i45547_1_.field_178745_a.field_178751_c, UUID.randomUUID().toString())).createMinecraftSessionService();
+        this.session = p_i45547_1_.field_178745_a.field_178752_a;
+        logger.info("Setting user: " + this.session.getUsername());
+        logger.info("(Session ID is " + this.session.getSessionID() + ")");
+        this.isDemo = p_i45547_1_.field_178741_d.field_178756_a;
+        this.displayWidth = p_i45547_1_.field_178743_b.field_178764_a > 0 ? p_i45547_1_.field_178743_b.field_178764_a : 1;
+        this.displayHeight = p_i45547_1_.field_178743_b.field_178762_b > 0 ? p_i45547_1_.field_178743_b.field_178762_b : 1;
+        this.tempDisplayWidth = p_i45547_1_.field_178743_b.field_178764_a;
+        this.tempDisplayHeight = p_i45547_1_.field_178743_b.field_178762_b;
+        this.fullscreen = p_i45547_1_.field_178743_b.field_178763_c;
+        this.jvm64bit = isJvm64bit();
+        this.theIntegratedServer = new IntegratedServer(this);
+
+        if (p_i45547_1_.field_178742_e.field_178754_a != null)
+        {
+            this.serverName = p_i45547_1_.field_178742_e.field_178754_a;
+            this.serverPort = p_i45547_1_.field_178742_e.field_178753_b;
+        }
+
+        ImageIO.setUseCache(false);
+        Bootstrap.register();
+    }
+
+    public void run()
+    {
+    	//TODO: Client
+    	String javaVersion = System.getProperty("java.version");
+		if(javaVersion.startsWith("1.6")
+			|| javaVersion.startsWith("1.7"))
+		{
+			Toolkit.getDefaultToolkit().beep();
+			int button =
+				JOptionPane.showOptionDialog(null, "<html><body width=320>"
+					+ "<h1>You are using an outdated Java version.</h1>"
+					+ "<p>You are currently using Java " + javaVersion + ".</p>"
+					+ "<p>To use the Wurst Client, Java 1.8.0 or higher is required.</p>",
+					"Outdated Java",
+					JOptionPane.DEFAULT_OPTION, JOptionPane.ERROR_MESSAGE,
+					null,
+					new String[]{"Download Java 8", "Help Me"}, 0);
+			String link;
+			if(button == 1)
+				link =
+					"https://www.wurst-client.tk/redirect/outdated-java-help/";
+			else
+				link = "http://www.java.com/download";
+			try
+			{
+				Desktop.getDesktop().browse(
+					new URI(link));
+			}catch(Exception e)
+			{
+				e.printStackTrace();
+			}
+			System.exit(-1);
+			return;
+		}
+		
+        this.running = true;
+        CrashReport var2;
+
+        try
+        {
+            this.startGame();
+        }
+        catch (Throwable var11)
+        {
+            var2 = CrashReport.makeCrashReport(var11, "Initializing game");
+            var2.makeCategory("Initialization");
+            this.displayCrashReport(this.addGraphicsAndWorldToCrashReport(var2));
+            return;
+        }
+
+        while (true)
+        {
+            try
+            {
+                while (this.running)
+                {
+                    if (!this.hasCrashed || this.crashReporter == null)
+                    {
+                        try
+                        {
+                            this.runGameLoop();
+                        }
+                        catch (OutOfMemoryError var10)
+                        {
+                            this.freeMemory();
+                            this.displayGuiScreen(new GuiMemoryErrorScreen());
+                            System.gc();
+                        }
+
+                        continue;
+                    }
+
+                    this.displayCrashReport(this.crashReporter);
+                    return;
+                }
+            }
+            catch (MinecraftError var12)
+            {
+                ;
+            }
+            catch (ReportedException var13)
+            {
+                this.addGraphicsAndWorldToCrashReport(var13.getCrashReport());
+                this.freeMemory();
+                logger.fatal("Reported exception thrown!", var13);
+                this.displayCrashReport(var13.getCrashReport());
+            }
+            catch (Throwable var14)
+            {
+                var2 = this.addGraphicsAndWorldToCrashReport(new CrashReport("Unexpected error", var14));
+                this.freeMemory();
+                logger.fatal("Unreported exception thrown!", var14);
+                this.displayCrashReport(var2);
+            }
+            finally
+            {
+                this.shutdownMinecraftApplet();
+            }
+
+            return;
+        }
+    }
+
+    /**
+     * Starts the game: initializes the canvas, the title, the settings, etcetera.
+     */
+    private void startGame() throws LWJGLException
+    {
+        this.gameSettings = new GameSettings(this, this.mcDataDir);
+        this.defaultResourcePacks.add(this.mcDefaultResourcePack);
+        this.startTimerHackThread();
+
+        if (this.gameSettings.overrideHeight > 0 && this.gameSettings.overrideWidth > 0)
+        {
+            this.displayWidth = this.gameSettings.overrideWidth;
+            this.displayHeight = this.gameSettings.overrideHeight;
+        }
+
+        logger.info("LWJGL Version: " + Sys.getVersion());
+        this.startLWJGL_1();
+        this.startLWJGL_2();
+        this.startLWJGL_3();
+        OpenGlHelper.initializeTextures();
+        this.framebufferMc = new Framebuffer(this.displayWidth, this.displayHeight, true);
+        this.framebufferMc.setFramebufferColor(0.0F, 0.0F, 0.0F, 0.0F);
+        this.func_175608_ak();
+        this.mcResourcePackRepository = new ResourcePackRepository(this.fileResourcepacks, new File(this.mcDataDir, "server-resource-packs"), this.mcDefaultResourcePack, this.metadataSerializer_, this.gameSettings);
+        this.mcResourceManager = new SimpleReloadableResourceManager(this.metadataSerializer_);
+        this.mcLanguageManager = new LanguageManager(this.metadataSerializer_, this.gameSettings.language);
+        this.mcResourceManager.registerReloadListener(this.mcLanguageManager);
+        this.refreshResources();
+        this.renderEngine = new TextureManager(this.mcResourceManager);
+        this.mcResourceManager.registerReloadListener(this.renderEngine);
+        this.func_180510_a(this.renderEngine);
+        this.func_175595_al();
+        this.skinManager = new SkinManager(this.renderEngine, new File(this.fileAssets, "skins"), this.sessionService);
+        this.saveLoader = new AnvilSaveConverter(new File(this.mcDataDir, "saves"));
+        this.mcSoundHandler = new SoundHandler(this.mcResourceManager, this.gameSettings);
+        this.mcResourceManager.registerReloadListener(this.mcSoundHandler);
+        this.mcMusicTicker = new MusicTicker(this);
+        this.fontRendererObj = new FontRenderer(this.gameSettings, new ResourceLocation("textures/font/ascii.png"), this.renderEngine, false);
+
+        //TODO: Client
+        Fonts.loadFonts();
+        
+        if (this.gameSettings.language != null)
+        {
+            this.fontRendererObj.setUnicodeFlag(this.isUnicode());
+            this.fontRendererObj.setBidiFlag(this.mcLanguageManager.isCurrentLanguageBidirectional());
+        }
+
+        this.standardGalacticFontRenderer = new FontRenderer(this.gameSettings, new ResourceLocation("textures/font/ascii_sga.png"), this.renderEngine, false);
+        this.mcResourceManager.registerReloadListener(this.fontRendererObj);
+        this.mcResourceManager.registerReloadListener(this.standardGalacticFontRenderer);
+        this.mcResourceManager.registerReloadListener(new GrassColorReloadListener());
+        this.mcResourceManager.registerReloadListener(new FoliageColorReloadListener());
+        AchievementList.openInventory.setStatStringFormatter(new IStatStringFormat()
+        {
+            private static final String __OBFID = "CL_00000632";
+            public String formatString(String p_74535_1_)
+            {
+                try
+                {
+                    return String.format(p_74535_1_, new Object[] {GameSettings.getKeyDisplayString(Minecraft.this.gameSettings.keyBindInventory.getKeyCode())});
+                }
+                catch (Exception var3)
+                {
+                    return "Error: " + var3.getLocalizedMessage();
+                }
+            }
+        });
+        this.mouseHelper = new MouseHelper();
+        this.checkGLError("Pre startup");
+        GlStateManager.func_179098_w();
+        GlStateManager.shadeModel(7425);
+        GlStateManager.clearDepth(1.0D);
+        GlStateManager.enableDepth();
+        GlStateManager.depthFunc(515);
+        GlStateManager.enableAlpha();
+        GlStateManager.alphaFunc(516, 0.1F);
+        GlStateManager.cullFace(1029);
+        GlStateManager.matrixMode(5889);
+        GlStateManager.loadIdentity();
+        GlStateManager.matrixMode(5888);
+        this.checkGLError("Startup");
+        this.textureMapBlocks = new TextureMap("textures");
+        this.textureMapBlocks.setMipmapLevels(this.gameSettings.mipmapLevels);
+        this.renderEngine.loadTickableTexture(TextureMap.locationBlocksTexture, this.textureMapBlocks);
+        this.renderEngine.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureMapBlocks.func_174937_a(false, this.gameSettings.mipmapLevels > 0);
+        this.modelManager = new ModelManager(this.textureMapBlocks);
+        this.mcResourceManager.registerReloadListener(this.modelManager);
+        this.renderItem = new RenderItem(this.renderEngine, this.modelManager);
+        this.renderManager = new RenderManager(this.renderEngine, this.renderItem);
+        this.itemRenderer = new ItemRenderer(this);
+        this.mcResourceManager.registerReloadListener(this.renderItem);
+        this.entityRenderer = new EntityRenderer(this, this.mcResourceManager);
+        this.mcResourceManager.registerReloadListener(this.entityRenderer);
+        this.field_175618_aM = new BlockRendererDispatcher(this.modelManager.getBlockModelShapes(), this.gameSettings);
+        this.mcResourceManager.registerReloadListener(this.field_175618_aM);
+        this.renderGlobal = new RenderGlobal(this);
+        this.mcResourceManager.registerReloadListener(this.renderGlobal);
+        this.guiAchievement = new GuiAchievement(this);
+        GlStateManager.viewport(0, 0, this.displayWidth, this.displayHeight);
+        this.effectRenderer = new EffectRenderer(this.theWorld, this.renderEngine);
+        this.checkGLError("Post startup");
+        this.ingameGUI = new GuiIngame(this);
+
+        //TODO: Client
+        WurstClient.INSTANCE.startClient();
+        if(frame != null)
+        	frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
+
+        if (this.serverName != null)
+        {
+            this.displayGuiScreen(new GuiConnecting(new GuiMainMenu(), this, this.serverName, this.serverPort));
+        }
+        else
+        {
+            this.displayGuiScreen(new GuiMainMenu());
+        }
+
+        this.renderEngine.deleteTexture(this.mojangLogo);
+        this.mojangLogo = null;
+        this.loadingScreen = new LoadingScreenRenderer(this);
+
+        if (this.gameSettings.fullScreen && !this.fullscreen)
+        {
+            this.toggleFullscreen();
+        }
+
+        try
+        {
+            Display.setVSyncEnabled(this.gameSettings.enableVsync);
+        }
+        catch (OpenGLException var2)
+        {
+            this.gameSettings.enableVsync = false;
+            this.gameSettings.saveOptions();
+        }
+
+        this.renderGlobal.func_174966_b();
+        if(WurstBot.isEnabled())
+        	WurstBot.getBot().start();
+    }
+
+    private void func_175608_ak()
+    {
+        this.metadataSerializer_.registerMetadataSectionType(new TextureMetadataSectionSerializer(), TextureMetadataSection.class);
+        this.metadataSerializer_.registerMetadataSectionType(new FontMetadataSectionSerializer(), FontMetadataSection.class);
+        this.metadataSerializer_.registerMetadataSectionType(new AnimationMetadataSectionSerializer(), AnimationMetadataSection.class);
+        this.metadataSerializer_.registerMetadataSectionType(new PackMetadataSectionSerializer(), PackMetadataSection.class);
+        this.metadataSerializer_.registerMetadataSectionType(new LanguageMetadataSectionSerializer(), LanguageMetadataSection.class);
+    }
+
+    private void func_175595_al()
+    {
+        try
+        {
+            this.stream = new TwitchStream(this, (Property)Iterables.getFirst(this.twitchDetails.get("twitch_access_token"), (Object)null));
+        }
+        catch (Throwable var2)
+        {
+            this.stream = new NullStream(var2);
+            logger.error("Couldn\'t initialize twitch stream");
+        }
+    }
+
+    private void startLWJGL_3() throws LWJGLException
+    {
+        Display.setResizable(true);
+        Display.setTitle("Minecraft 1.8");
+
+        try
+        {
+            Display.create((new PixelFormat()).withDepthBits(24));
+        }
+        catch (LWJGLException var4)
+        {
+            logger.error("Couldn\'t set pixel format", var4);
+
+            try
+            {
+                Thread.sleep(1000L);
+            }
+            catch (InterruptedException var3)
+            {
+                ;
+            }
+
+            if (this.fullscreen)
+            {
+                this.updateDisplayMode();
+            }
+
+            Display.create();
+        }
+    }
+
+    private void startLWJGL_2() throws LWJGLException
+    {
+        if(this.fullscreen)
+        {
+            Display.setFullscreen(true);
+            DisplayMode var1 = Display.getDisplayMode();
+            this.displayWidth = Math.max(1, var1.getWidth());
+            this.displayHeight = Math.max(1, var1.getHeight());
+        }else
+        {
+            Display.setDisplayMode(new DisplayMode(this.displayWidth, this.displayHeight));
+            if(!isAutoMaximize() && !WurstBot.isEnabled())
+            	return;
+        	frame = new JFrame("Minecraft 1.8");
+        	frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
+    		Canvas canvas = new Canvas();
+    		canvas.setBackground(new Color(16, 16, 16));
+    		Display.setParent(canvas);
+    		canvas.setSize(displayWidth, displayHeight);
+    		frame.add(canvas);
+    		frame.pack();
+        	frame.setLocationRelativeTo(null);
+    		InputStream var2 = null;
+            InputStream var3 = null;
+            try
+            {
+                var2 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_16x16.png"));
+                var3 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_32x32.png"));
+                List icons = Lists.newArrayList();
+                icons.add(ImageIO.read(var2));
+                icons.add(ImageIO.read(var3));
+                frame.setIconImages(icons);
+            }catch(Exception var8)
+            {
+                logger.error("Couldn't set icon", var8);
+            }finally
+            {
+                IOUtils.closeQuietly(var2);
+                IOUtils.closeQuietly(var3);
+            }
+            if(!WurstBot.isEnabled())
+            	frame.setVisible(true);
+        }
+    }
+
+    private void startLWJGL_1()
+    {
+        Util.EnumOS var1 = Util.getOSType();
+
+        if (var1 != Util.EnumOS.OSX)
+        {
+            InputStream var2 = null;
+            InputStream var3 = null;
+
+            try
+            {
+                var2 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_16x16.png"));
+                var3 = this.mcDefaultResourcePack.func_152780_c(new ResourceLocation("icons/icon_32x32.png"));
+
+                if (var2 != null && var3 != null)
+                {
+                    Display.setIcon(new ByteBuffer[] {this.readImageToBuffer(var2), this.readImageToBuffer(var3)});
+                }
+            }
+            catch (IOException var8)
+            {
+                logger.error("Couldn\'t set icon", var8);
+            }
+            finally
+            {
+                IOUtils.closeQuietly(var2);
+                IOUtils.closeQuietly(var3);
+            }
+        }
+    }
+    
+    //TODO: Client
+    private boolean isAutoMaximize()
+	{
+    	File autoMaximizeFile = new File(mcDataDir + "/wurst/automaximize.json");
+    	boolean autoMaximizeEnabled = false;
+        if(!autoMaximizeFile.exists())
+        	createAutoMaximizeFile(autoMaximizeFile);
+        try
+    	{
+    		BufferedReader load = new BufferedReader(new FileReader(autoMaximizeFile));
+    		String line = load.readLine();
+    		load.close();
+    		autoMaximizeEnabled = line.equals("true") && !isRunningOnMac;
+    	}catch(IOException e)
+    	{
+    		e.printStackTrace();
+    	}
+		return autoMaximizeEnabled;
+	}
+    
+    //TODO: Client
+    private void createAutoMaximizeFile(File autoMaximizeFile)
+	{
+    	try
+		{
+    		if(!autoMaximizeFile.getParentFile().exists())
+    			autoMaximizeFile.getParentFile().mkdirs();
+			PrintWriter save = new PrintWriter(new FileWriter(autoMaximizeFile));
+			save.println(Boolean.toString(!isRunningOnMac));
+			save.close();
+		}catch(IOException e)
+		{
+			e.printStackTrace();
+		}
+	}
+
+    private static boolean isJvm64bit()
+    {
+        String[] var0 = new String[] {"sun.arch.data.model", "com.ibm.vm.bitmode", "os.arch"};
+        String[] var1 = var0;
+        int var2 = var0.length;
+
+        for (int var3 = 0; var3 < var2; ++var3)
+        {
+            String var4 = var1[var3];
+            String var5 = System.getProperty(var4);
+
+            if (var5 != null && var5.contains("64"))
+            {
+                return true;
+            }
+        }
+
+        return false;
+    }
+
+    public Framebuffer getFramebuffer()
+    {
+        return this.framebufferMc;
+    }
+
+    public String func_175600_c()
+    {
+        return this.launchedVersion;
+    }
+
+    private void startTimerHackThread()
+    {
+        Thread var1 = new Thread("Timer hack thread")
+        {
+            private static final String __OBFID = "CL_00000639";
+            public void run()
+            {
+                while (Minecraft.this.running)
+                {
+                    try
+                    {
+                        Thread.sleep(2147483647L);
+                    }
+                    catch (InterruptedException var2)
+                    {
+                        ;
+                    }
+                }
+            }
+        };
+        var1.setDaemon(true);
+        var1.start();
+    }
+
+    public void crashed(CrashReport crash)
+    {
+        this.hasCrashed = true;
+        this.crashReporter = crash;
+    }
+
+    /**
+     * Wrapper around displayCrashReportInternal
+     */
+    public void displayCrashReport(CrashReport crashReportIn)
+    {
+    	File var2 = new File(getMinecraft().mcDataDir, "crash-reports");
+    	File var3 = new File(var2, "crash-" + (new SimpleDateFormat("yyyy-MM-dd_HH.mm.ss")).format(new Date()) + "-client.txt");
+    	Bootstrap.func_179870_a(crashReportIn.getCompleteReport());
+    	
+		//MiscUtils.openLink("http://www.wurst-client.tk/bugs");
+    	//doWurstCrash(crashReportIn, var3.getAbsolutePath());
+    	//while(true);
+    	//TODO: Client
+    	if(crashReportIn.getFile() != null)
+    	{
+    		Bootstrap.func_179870_a("#@!@# Game crashed! Crash report saved to: #@!@# " + crashReportIn.getFile());
+    		System.exit(-1);
+    	}else if(crashReportIn.saveToFile(var3))
+    	{
+    		Bootstrap.func_179870_a("#@!@# Game crashed! Crash report saved to: #@!@# " + var3.getAbsolutePath());
+    		System.exit(-1);
+    	}else
+    	{
+    		Bootstrap.func_179870_a("#@?@# Game crashed! Crash report could not be saved. #@?@#");
+    		System.exit(-2);
+    	}
+    }
+    
+    //TODO: Client
+    private void doWurstCrash(final CrashReport crashReportIn, final String reportPath)
+    {
+    	this.hasCrashed = true;
+		JFrame crashFrame = new JFrame();
+		crashFrame.setTitle("Error");
+		crashFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
+		crashFrame.addWindowListener(new WindowAdapter()
+		{
+			@SuppressWarnings("deprecation")
+			@Override
+			public void windowClosing(WindowEvent e)
+			{
+				System.exit(-1);
+				Minecraft.this.mcThread.stop();
+				System.gc();
+				Minecraft.this.shutdownMinecraftApplet();
+			}
+		});
+		crashFrame.setAlwaysOnTop(true);
+		JPanel crashPanel = new JPanel();
+		crashPanel.setLayout(new BoxLayout(crashPanel, BoxLayout.Y_AXIS));
+		
+		JLabel header1 = new JLabel();
+		header1.setText
+		(
+			"<html><div align=\"center\"><h1>Wurst has crashed!</h1>"
+			+ "<font size=\"4\">The following crash report has been saved to:"
+		);
+		header1.setHorizontalAlignment(SwingConstants.CENTER);
+		header1.setAlignmentX(Component.CENTER_ALIGNMENT);
+		crashPanel.add(header1);
+
+		final JButton fileButton = new JButton("<html><u>" + reportPath);
+		fileButton.setForeground(new Color(0x0000ff));
+		fileButton.setAlignmentX(Component.CENTER_ALIGNMENT);
+		fileButton.setBorder(null);
+		fileButton.setContentAreaFilled(false);
+		fileButton.setFocusPainted(false);
+		fileButton.addActionListener(new ActionListener()
+		{
+			@Override
+			public void actionPerformed(ActionEvent e)
+			{
+				try
+				{
+					MiscUtils.openFile(reportPath);
+					fileButton.setForeground(new Color(0x551A8B));
+				}catch(Exception e1)
+				{
+					e1.printStackTrace();
+				}
+			}
+		});
+		JPanel fileButtonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER));
+		fileButtonPanel.add(fileButton);
+		crashPanel.add(fileButtonPanel);
+		
+		JLabel header2 = new JLabel();
+		header2.setText
+		(
+			"<html><div align=\"center\"><font size=\"4\">Please report this crash at:"
+		);
+		header2.setHorizontalAlignment(SwingConstants.CENTER);
+		header2.setAlignmentX(Component.CENTER_ALIGNMENT);
+		crashPanel.add(header2);
+		
+		final JButton linkButton = new JButton("<html><u>http://www.wurst-client.tk/bugs");
+		linkButton.setForeground(new Color(0x0000ff));
+		linkButton.setAlignmentX(Component.CENTER_ALIGNMENT);
+		linkButton.setBorder(null);
+		linkButton.setContentAreaFilled(false);
+		linkButton.setFocusPainted(false);
+		linkButton.addActionListener(new ActionListener()
+		{
+			@Override
+			public void actionPerformed(ActionEvent e)
+			{
+				try
+				{
+					MiscUtils.openLink("http://www.wurst-client.tk/bugs");
+					linkButton.setForeground(new Color(0x551A8B));
+				}catch(Exception e1)
+				{
+					e1.printStackTrace();
+				}
+			}
+		});
+		JPanel linkButtonPanel = new JPanel(new FlowLayout(FlowLayout.CENTER));
+		linkButtonPanel.add(linkButton);
+		crashPanel.add(linkButtonPanel);
+		
+		JTextArea message = new JTextArea();
+		message.setEditable(false);
+		message.setText(crashReportIn.getCompleteReport());
+		JScrollPane scrollpane = new JScrollPane(message);
+		scrollpane.setPreferredSize(new Dimension(600, 300));
+		crashPanel.add(scrollpane);
+		
+
+		JPanel buttons = new JPanel();
+		buttons.setLayout(new FlowLayout(FlowLayout.CENTER, 32, 5));
+		JButton copyButton = new JButton("Copy to clipboard");
+		copyButton.addActionListener(new ActionListener()
+		{
+			@Override
+			public void actionPerformed(ActionEvent e)
+			{
+				Toolkit.getDefaultToolkit().getSystemClipboard().setContents(new StringSelection(crashReportIn.getCompleteReport()), null);
+			}
+		});
+		buttons.add(copyButton);
+		crashPanel.add(buttons);
+		
+		crashFrame.setContentPane(crashPanel);
+		crashFrame.pack();
+		crashFrame.setLocationRelativeTo(null);
+		crashFrame.setVisible(true);
+    }
+
+    public boolean isUnicode()
+    {
+        return this.mcLanguageManager.isCurrentLocaleUnicode() || this.gameSettings.forceUnicodeFont;
+    }
+
+    public void refreshResources()
+    {
+        ArrayList var1 = Lists.newArrayList(this.defaultResourcePacks);
+        Iterator var2 = this.mcResourcePackRepository.getRepositoryEntries().iterator();
+
+        while (var2.hasNext())
+        {
+            ResourcePackRepository.Entry var3 = (ResourcePackRepository.Entry)var2.next();
+            var1.add(var3.getResourcePack());
+        }
+
+        if (this.mcResourcePackRepository.getResourcePackInstance() != null)
+        {
+            var1.add(this.mcResourcePackRepository.getResourcePackInstance());
+        }
+
+        try
+        {
+            this.mcResourceManager.reloadResources(var1);
+        }
+        catch (RuntimeException var4)
+        {
+            logger.info("Caught error stitching, removing all assigned resourcepacks", var4);
+            var1.clear();
+            var1.addAll(this.defaultResourcePacks);
+            this.mcResourcePackRepository.func_148527_a(Collections.emptyList());
+            this.mcResourceManager.reloadResources(var1);
+            this.gameSettings.resourcePacks.clear();
+            this.gameSettings.saveOptions();
+        }
+
+        this.mcLanguageManager.parseLanguageMetadata(var1);
+
+        if (this.renderGlobal != null)
+        {
+            this.renderGlobal.loadRenderers();
+        }
+    }
+
+    private ByteBuffer readImageToBuffer(InputStream imageStream) throws IOException
+    {
+        BufferedImage var2 = ImageIO.read(imageStream);
+        int[] var3 = var2.getRGB(0, 0, var2.getWidth(), var2.getHeight(), (int[])null, 0, var2.getWidth());
+        ByteBuffer var4 = ByteBuffer.allocate(4 * var3.length);
+        int[] var5 = var3;
+        int var6 = var3.length;
+
+        for (int var7 = 0; var7 < var6; ++var7)
+        {
+            int var8 = var5[var7];
+            var4.putInt(var8 << 8 | var8 >> 24 & 255);
+        }
+
+        var4.flip();
+        return var4;
+    }
+
+    private void updateDisplayMode() throws LWJGLException
+    {
+        HashSet var1 = Sets.newHashSet();
+        Collections.addAll(var1, Display.getAvailableDisplayModes());
+        DisplayMode var2 = Display.getDesktopDisplayMode();
+
+        if (!var1.contains(var2) && Util.getOSType() == Util.EnumOS.OSX)
+        {
+            Iterator var3 = macDisplayModes.iterator();
+
+            while (var3.hasNext())
+            {
+                DisplayMode var4 = (DisplayMode)var3.next();
+                boolean var5 = true;
+                Iterator var6 = var1.iterator();
+                DisplayMode var7;
+
+                while (var6.hasNext())
+                {
+                    var7 = (DisplayMode)var6.next();
+
+                    if (var7.getBitsPerPixel() == 32 && var7.getWidth() == var4.getWidth() && var7.getHeight() == var4.getHeight())
+                    {
+                        var5 = false;
+                        break;
+                    }
+                }
+
+                if (!var5)
+                {
+                    var6 = var1.iterator();
+
+                    while (var6.hasNext())
+                    {
+                        var7 = (DisplayMode)var6.next();
+
+                        if (var7.getBitsPerPixel() == 32 && var7.getWidth() == var4.getWidth() / 2 && var7.getHeight() == var4.getHeight() / 2)
+                        {
+                            var2 = var7;
+                            break;
+                        }
+                    }
+                }
+            }
+        }
+
+        Display.setDisplayMode(var2);
+        this.displayWidth = var2.getWidth();
+        this.displayHeight = var2.getHeight();
+    }
+
+    private void func_180510_a(TextureManager p_180510_1_)
+    {
+        ScaledResolution var2 = new ScaledResolution(this, this.displayWidth, this.displayHeight);
+        int var3 = var2.getScaleFactor();
+        Framebuffer var4 = new Framebuffer(var2.getScaledWidth() * var3, var2.getScaledHeight() * var3, true);
+        var4.bindFramebuffer(false);
+        GlStateManager.matrixMode(5889);
+        GlStateManager.loadIdentity();
+        GlStateManager.ortho(0.0D, (double)var2.getScaledWidth(), (double)var2.getScaledHeight(), 0.0D, 1000.0D, 3000.0D);
+        GlStateManager.matrixMode(5888);
+        GlStateManager.loadIdentity();
+        GlStateManager.translate(0.0F, 0.0F, -2000.0F);
+        GlStateManager.disableLighting();
+        GlStateManager.disableFog();
+        GlStateManager.disableDepth();
+        GlStateManager.func_179098_w();
+        InputStream var5 = null;
+
+        try
+        {
+            var5 = this.mcDefaultResourcePack.getInputStream(locationMojangPng);
+            this.mojangLogo = p_180510_1_.getDynamicTextureLocation("logo", new DynamicTexture(ImageIO.read(var5)));
+            p_180510_1_.bindTexture(this.mojangLogo);
+        }
+        catch (IOException var12)
+        {
+            logger.error("Unable to load logo: " + locationMojangPng, var12);
+        }
+        finally
+        {
+            IOUtils.closeQuietly(var5);
+        }
+
+        Tessellator var6 = Tessellator.getInstance();
+        WorldRenderer var7 = var6.getWorldRenderer();
+        var7.startDrawingQuads();
+        var7.setColorOpaque_I(16777215);
+        var7.addVertexWithUV(0.0D, (double)this.displayHeight, 0.0D, 0.0D, 0.0D);
+        var7.addVertexWithUV((double)this.displayWidth, (double)this.displayHeight, 0.0D, 0.0D, 0.0D);
+        var7.addVertexWithUV((double)this.displayWidth, 0.0D, 0.0D, 0.0D, 0.0D);
+        var7.addVertexWithUV(0.0D, 0.0D, 0.0D, 0.0D, 0.0D);
+        var6.draw();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        var7.setColorOpaque_I(16777215);
+        short var8 = 256;
+        short var9 = 256;
+        this.scaledTessellator((var2.getScaledWidth() - var8) / 2, (var2.getScaledHeight() - var9) / 2, 0, 0, var8, var9);
+        GlStateManager.disableLighting();
+        GlStateManager.disableFog();
+        var4.unbindFramebuffer();
+        var4.framebufferRender(var2.getScaledWidth() * var3, var2.getScaledHeight() * var3);
+        GlStateManager.enableAlpha();
+        GlStateManager.alphaFunc(516, 0.1F);
+        this.func_175601_h();
+    }
+
+    /**
+     * Loads Tessellator with a scaled resolution
+     */
+    public void scaledTessellator(int width, int height, int width2, int height2, int stdTextureWidth, int stdTextureHeight)
+    {
+        float var7 = 0.00390625F;
+        float var8 = 0.00390625F;
+        WorldRenderer var9 = Tessellator.getInstance().getWorldRenderer();
+        var9.startDrawingQuads();
+        var9.addVertexWithUV((double)(width + 0), (double)(height + stdTextureHeight), 0.0D, (double)((float)(width2 + 0) * var7), (double)((float)(height2 + stdTextureHeight) * var8));
+        var9.addVertexWithUV((double)(width + stdTextureWidth), (double)(height + stdTextureHeight), 0.0D, (double)((float)(width2 + stdTextureWidth) * var7), (double)((float)(height2 + stdTextureHeight) * var8));
+        var9.addVertexWithUV((double)(width + stdTextureWidth), (double)(height + 0), 0.0D, (double)((float)(width2 + stdTextureWidth) * var7), (double)((float)(height2 + 0) * var8));
+        var9.addVertexWithUV((double)(width + 0), (double)(height + 0), 0.0D, (double)((float)(width2 + 0) * var7), (double)((float)(height2 + 0) * var8));
+        Tessellator.getInstance().draw();
+    }
+
+    /**
+     * Returns the save loader that is currently being used
+     */
+    public ISaveFormat getSaveLoader()
+    {
+        return this.saveLoader;
+    }
+
+    /**
+     * Sets the argument GuiScreen as the main (topmost visible) screen.
+     */
+    public void displayGuiScreen(GuiScreen guiScreenIn)
+    {
+        if (this.currentScreen != null)
+        {
+            this.currentScreen.onGuiClosed();
+        }
+
+        if (guiScreenIn == null && this.theWorld == null)
+        {
+            guiScreenIn = new GuiMainMenu();
+        }
+        else if (guiScreenIn == null && this.thePlayer.getHealth() <= 0.0F)
+        {
+            guiScreenIn = new GuiGameOver();
+        }
+
+        if (guiScreenIn instanceof GuiMainMenu)
+        {
+            this.gameSettings.showDebugInfo = false;
+            this.ingameGUI.getChatGUI().clearChatMessages();
+        }
+
+        this.currentScreen = (GuiScreen)guiScreenIn;
+
+        if (guiScreenIn != null)
+        {
+            this.setIngameNotInFocus();
+            ScaledResolution var2 = new ScaledResolution(this, this.displayWidth, this.displayHeight);
+            int var3 = var2.getScaledWidth();
+            int var4 = var2.getScaledHeight();
+            ((GuiScreen)guiScreenIn).setWorldAndResolution(this, var3, var4);
+            this.skipRenderWorld = false;
+        }
+        else
+        {
+            this.mcSoundHandler.resumeSounds();
+            this.setIngameFocus();
+        }
+    }
+
+    /**
+     * Checks for an OpenGL error. If there is one, prints the error ID and error string.
+     */
+    private void checkGLError(String message)
+    {
+        if (this.field_175619_R)
+        {
+            int var2 = GL11.glGetError();
+
+            if (var2 != 0)
+            {
+                String var3 = GLU.gluErrorString(var2);
+                logger.error("########## GL ERROR ##########");
+                logger.error("@ " + message);
+                logger.error(var2 + ": " + var3);
+            }
+        }
+    }
+
+    /**
+     * Shuts down the minecraft applet by stopping the resource downloads, and clearing up GL stuff; called when the
+     * application (or web page) is exited.
+     */
+    public void shutdownMinecraftApplet()
+    {
+        try
+        {
+            this.stream.shutdownStream();
+            logger.info("Stopping!");
+
+            try
+            {
+                this.loadWorld((WorldClient)null);
+            }
+            catch (Throwable var5)
+            {
+                ;
+            }
+
+            this.mcSoundHandler.unloadSounds();
+        }
+        finally
+        {
+            Display.destroy();
+
+            if (!this.hasCrashed)
+            {
+                System.exit(0);
+            }
+        }
+
+        System.gc();
+    }
+
+    /**
+     * Called repeatedly from run()
+     */
+    private void runGameLoop() throws IOException
+    {
+        this.mcProfiler.startSection("root");
+
+        if (Display.isCreated() && Display.isCloseRequested())
+        {
+            this.shutdown();
+        }
+
+        if (this.isGamePaused && this.theWorld != null)
+        {
+            float var1 = this.timer.renderPartialTicks;
+            this.timer.updateTimer();
+            this.timer.renderPartialTicks = var1;
+        }
+        else
+        {
+            this.timer.updateTimer();
+        }
+
+        this.mcProfiler.startSection("scheduledExecutables");
+        Queue var6 = this.scheduledTasks;
+
+        synchronized (this.scheduledTasks)
+        {
+            while (!this.scheduledTasks.isEmpty())
+            {
+                ((FutureTask)this.scheduledTasks.poll()).run();
+            }
+        }
+
+        this.mcProfiler.endSection();
+        long var7 = System.nanoTime();
+        this.mcProfiler.startSection("tick");
+
+        for (int var3 = 0; var3 < this.timer.elapsedTicks; ++var3)
+        {
+            this.runTick();
+        }
+
+        this.mcProfiler.endStartSection("preRenderErrors");
+        long var8 = System.nanoTime() - var7;
+        this.checkGLError("Pre render");
+        this.mcProfiler.endStartSection("sound");
+        this.mcSoundHandler.setListener(this.thePlayer, this.timer.renderPartialTicks);
+        this.mcProfiler.endSection();
+        this.mcProfiler.startSection("render");
+        GlStateManager.pushMatrix();
+        GlStateManager.clear(16640);
+        this.framebufferMc.bindFramebuffer(true);
+        this.mcProfiler.startSection("display");
+        GlStateManager.func_179098_w();
+
+        if (this.thePlayer != null && this.thePlayer.isEntityInsideOpaqueBlock())
+        {
+            this.gameSettings.thirdPersonView = 0;
+        }
+
+        this.mcProfiler.endSection();
+
+        if (!this.skipRenderWorld)
+        {
+            this.mcProfiler.endStartSection("gameRenderer");
+            this.entityRenderer.updateCameraAndRender(this.timer.renderPartialTicks);
+            this.mcProfiler.endSection();
+        }
+
+        this.mcProfiler.endSection();
+
+        if (this.gameSettings.showDebugInfo && this.gameSettings.showDebugProfilerChart && !this.gameSettings.hideGUI)
+        {
+            if (!this.mcProfiler.profilingEnabled)
+            {
+                this.mcProfiler.clearProfiling();
+            }
+
+            this.mcProfiler.profilingEnabled = true;
+            this.displayDebugInfo(var8);
+        }
+        else
+        {
+            this.mcProfiler.profilingEnabled = false;
+            this.prevFrameTime = System.nanoTime();
+        }
+
+        this.guiAchievement.updateAchievementWindow();
+        this.framebufferMc.unbindFramebuffer();
+        GlStateManager.popMatrix();
+        GlStateManager.pushMatrix();
+        this.framebufferMc.framebufferRender(this.displayWidth, this.displayHeight);
+        GlStateManager.popMatrix();
+        GlStateManager.pushMatrix();
+        this.entityRenderer.func_152430_c(this.timer.renderPartialTicks);
+        GlStateManager.popMatrix();
+        this.mcProfiler.startSection("root");
+        this.func_175601_h();
+        Thread.yield();
+        this.mcProfiler.startSection("stream");
+        this.mcProfiler.startSection("update");
+        this.stream.func_152935_j();
+        this.mcProfiler.endStartSection("submit");
+        this.stream.func_152922_k();
+        this.mcProfiler.endSection();
+        this.mcProfiler.endSection();
+        this.checkGLError("Post render");
+        ++this.fpsCounter;
+        this.isGamePaused = this.isSingleplayer() && this.currentScreen != null && this.currentScreen.doesGuiPauseGame() && !this.theIntegratedServer.getPublic();
+
+        while (getSystemTime() >= this.debugUpdateTime + 1000L)
+        {
+            debugFPS = this.fpsCounter;
+            this.debug = String.format("%d fps (%d chunk update%s) T: %s%s%s%s%s", new Object[] {Integer.valueOf(debugFPS), Integer.valueOf(RenderChunk.field_178592_a), RenderChunk.field_178592_a != 1 ? "s" : "", (float)this.gameSettings.limitFramerate == GameSettings.Options.FRAMERATE_LIMIT.getValueMax() ? "inf" : Integer.valueOf(this.gameSettings.limitFramerate), this.gameSettings.enableVsync ? " vsync" : "", this.gameSettings.fancyGraphics ? "" : " fast", this.gameSettings.clouds ? " clouds" : "", OpenGlHelper.func_176075_f() ? " vbo" : ""});
+            RenderChunk.field_178592_a = 0;
+            this.debugUpdateTime += 1000L;
+            this.fpsCounter = 0;
+            this.usageSnooper.addMemoryStatsToSnooper();
+
+            if (!this.usageSnooper.isSnooperRunning())
+            {
+                this.usageSnooper.startSnooper();
+            }
+        }
+
+        if (this.isFramerateLimitBelowMax())
+        {
+            this.mcProfiler.startSection("fpslimit_wait");
+            Display.sync(this.getLimitFramerate());
+            this.mcProfiler.endSection();
+        }
+
+        this.mcProfiler.endSection();
+    }
+
+    public void func_175601_h()
+    {
+        this.mcProfiler.startSection("display_update");
+        Display.update();
+        this.mcProfiler.endSection();
+        this.func_175604_i();
+    }
+
+    protected void func_175604_i()
+    {
+        if (!this.fullscreen && Display.wasResized())
+        {
+            int var1 = this.displayWidth;
+            int var2 = this.displayHeight;
+            this.displayWidth = Display.getWidth();
+            this.displayHeight = Display.getHeight();
+
+            if (this.displayWidth != var1 || this.displayHeight != var2)
+            {
+                if (this.displayWidth <= 0)
+                {
+                    this.displayWidth = 1;
+                }
+
+                if (this.displayHeight <= 0)
+                {
+                    this.displayHeight = 1;
+                }
+
+                this.resize(this.displayWidth, this.displayHeight);
+            }
+        }
+    }
+
+    public int getLimitFramerate()
+    {
+        return this.theWorld == null && this.currentScreen != null ? 30 : this.gameSettings.limitFramerate;
+    }
+
+    public boolean isFramerateLimitBelowMax()
+    {
+        return (float)this.getLimitFramerate() < GameSettings.Options.FRAMERATE_LIMIT.getValueMax();
+    }
+
+    public void freeMemory()
+    {
+        try
+        {
+            memoryReserve = new byte[0];
+            this.renderGlobal.deleteAllDisplayLists();
+        }
+        catch (Throwable var3)
+        {
+            ;
+        }
+
+        try
+        {
+            System.gc();
+            this.loadWorld((WorldClient)null);
+        }
+        catch (Throwable var2)
+        {
+            ;
+        }
+
+        System.gc();
+    }
+
+    /**
+     * Update debugProfilerName in response to number keys in debug screen
+     */
+    private void updateDebugProfilerName(int keyCount)
+    {
+        List var2 = this.mcProfiler.getProfilingData(this.debugProfilerName);
+
+        if (var2 != null && !var2.isEmpty())
+        {
+            Profiler.Result var3 = (Profiler.Result)var2.remove(0);
+
+            if (keyCount == 0)
+            {
+                if (var3.field_76331_c.length() > 0)
+                {
+                    int var4 = this.debugProfilerName.lastIndexOf(".");
+
+                    if (var4 >= 0)
+                    {
+                        this.debugProfilerName = this.debugProfilerName.substring(0, var4);
+                    }
+                }
+            }
+            else
+            {
+                --keyCount;
+
+                if (keyCount < var2.size() && !((Profiler.Result)var2.get(keyCount)).field_76331_c.equals("unspecified"))
+                {
+                    if (this.debugProfilerName.length() > 0)
+                    {
+                        this.debugProfilerName = this.debugProfilerName + ".";
+                    }
+
+                    this.debugProfilerName = this.debugProfilerName + ((Profiler.Result)var2.get(keyCount)).field_76331_c;
+                }
+            }
+        }
+    }
+
+    /**
+     * Parameter appears to be unused
+     */
+    private void displayDebugInfo(long elapsedTicksTime)
+    {
+        if (this.mcProfiler.profilingEnabled)
+        {
+            List var3 = this.mcProfiler.getProfilingData(this.debugProfilerName);
+            Profiler.Result var4 = (Profiler.Result)var3.remove(0);
+            GlStateManager.clear(256);
+            GlStateManager.matrixMode(5889);
+            GlStateManager.enableColorMaterial();
+            GlStateManager.loadIdentity();
+            GlStateManager.ortho(0.0D, (double)this.displayWidth, (double)this.displayHeight, 0.0D, 1000.0D, 3000.0D);
+            GlStateManager.matrixMode(5888);
+            GlStateManager.loadIdentity();
+            GlStateManager.translate(0.0F, 0.0F, -2000.0F);
+            GL11.glLineWidth(1.0F);
+            GlStateManager.func_179090_x();
+            Tessellator var5 = Tessellator.getInstance();
+            WorldRenderer var6 = var5.getWorldRenderer();
+            short var7 = 160;
+            int var8 = this.displayWidth - var7 - 10;
+            int var9 = this.displayHeight - var7 * 2;
+            GlStateManager.enableBlend();
+            var6.startDrawingQuads();
+            var6.setColorRGBA_I(0, 200);
+            var6.addVertex((double)((float)var8 - (float)var7 * 1.1F), (double)((float)var9 - (float)var7 * 0.6F - 16.0F), 0.0D);
+            var6.addVertex((double)((float)var8 - (float)var7 * 1.1F), (double)(var9 + var7 * 2), 0.0D);
+            var6.addVertex((double)((float)var8 + (float)var7 * 1.1F), (double)(var9 + var7 * 2), 0.0D);
+            var6.addVertex((double)((float)var8 + (float)var7 * 1.1F), (double)((float)var9 - (float)var7 * 0.6F - 16.0F), 0.0D);
+            var5.draw();
+            GlStateManager.disableBlend();
+            double var10 = 0.0D;
+            int var14;
+
+            for (int var12 = 0; var12 < var3.size(); ++var12)
+            {
+                Profiler.Result var13 = (Profiler.Result)var3.get(var12);
+                var14 = MathHelper.floor_double(var13.field_76332_a / 4.0D) + 1;
+                var6.startDrawing(6);
+                var6.setColorOpaque_I(var13.func_76329_a());
+                var6.addVertex((double)var8, (double)var9, 0.0D);
+                int var15;
+                float var16;
+                float var17;
+                float var18;
+
+                for (var15 = var14; var15 >= 0; --var15)
+                {
+                    var16 = (float)((var10 + var13.field_76332_a * (double)var15 / (double)var14) * Math.PI * 2.0D / 100.0D);
+                    var17 = MathHelper.sin(var16) * (float)var7;
+                    var18 = MathHelper.cos(var16) * (float)var7 * 0.5F;
+                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18), 0.0D);
+                }
+
+                var5.draw();
+                var6.startDrawing(5);
+                var6.setColorOpaque_I((var13.func_76329_a() & 16711422) >> 1);
+
+                for (var15 = var14; var15 >= 0; --var15)
+                {
+                    var16 = (float)((var10 + var13.field_76332_a * (double)var15 / (double)var14) * Math.PI * 2.0D / 100.0D);
+                    var17 = MathHelper.sin(var16) * (float)var7;
+                    var18 = MathHelper.cos(var16) * (float)var7 * 0.5F;
+                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18), 0.0D);
+                    var6.addVertex((double)((float)var8 + var17), (double)((float)var9 - var18 + 10.0F), 0.0D);
+                }
+
+                var5.draw();
+                var10 += var13.field_76332_a;
+            }
+
+            DecimalFormat var19 = new DecimalFormat("##0.00");
+            GlStateManager.func_179098_w();
+            String var20 = "";
+
+            if (!var4.field_76331_c.equals("unspecified"))
+            {
+                var20 = var20 + "[0] ";
+            }
+
+            if (var4.field_76331_c.length() == 0)
+            {
+                var20 = var20 + "ROOT ";
+            }
+            else
+            {
+                var20 = var20 + var4.field_76331_c + " ";
+            }
+
+            var14 = 16777215;
+            this.fontRendererObj.drawStringWithShadow(var20, (float)(var8 - var7), (float)(var9 - var7 / 2 - 16), var14);
+            this.fontRendererObj.drawStringWithShadow(var20 = var19.format(var4.field_76330_b) + "%", (float)(var8 + var7 - this.fontRendererObj.getStringWidth(var20)), (float)(var9 - var7 / 2 - 16), var14);
+
+            for (int var21 = 0; var21 < var3.size(); ++var21)
+            {
+                Profiler.Result var22 = (Profiler.Result)var3.get(var21);
+                String var23 = "";
+
+                if (var22.field_76331_c.equals("unspecified"))
+                {
+                    var23 = var23 + "[?] ";
+                }
+                else
+                {
+                    var23 = var23 + "[" + (var21 + 1) + "] ";
+                }
+
+                var23 = var23 + var22.field_76331_c;
+                this.fontRendererObj.drawStringWithShadow(var23, (float)(var8 - var7), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
+                this.fontRendererObj.drawStringWithShadow(var23 = var19.format(var22.field_76332_a) + "%", (float)(var8 + var7 - 50 - this.fontRendererObj.getStringWidth(var23)), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
+                this.fontRendererObj.drawStringWithShadow(var23 = var19.format(var22.field_76330_b) + "%", (float)(var8 + var7 - this.fontRendererObj.getStringWidth(var23)), (float)(var9 + var7 / 2 + var21 * 8 + 20), var22.func_76329_a());
+            }
+        }
+    }
+
+    /**
+     * Called when the window is closing. Sets 'running' to false which allows the game loop to exit cleanly.
+     */
+    public void shutdown()
+    {
+        this.running = false;
+    }
+
+    /**
+     * Will set the focus to ingame if the Minecraft window is the active with focus. Also clears any GUI screen
+     * currently displayed
+     */
+    public void setIngameFocus()
+    {
+        if (Display.isActive())
+        {
+            if (!this.inGameHasFocus)
+            {
+                this.inGameHasFocus = true;
+                this.mouseHelper.grabMouseCursor();
+                this.displayGuiScreen((GuiScreen)null);
+                this.leftClickCounter = 10000;
+            }
+        }
+    }
+
+    /**
+     * Resets the player keystate, disables the ingame focus, and ungrabs the mouse cursor.
+     */
+    public void setIngameNotInFocus()
+    {
+        if (this.inGameHasFocus)
+        {
+            KeyBinding.unPressAllKeys();
+            this.inGameHasFocus = false;
+            this.mouseHelper.ungrabMouseCursor();
+        }
+    }
+
+    /**
+     * Displays the ingame menu
+     */
+    public void displayInGameMenu()
+    {
+        if (this.currentScreen == null)
+        {
+            this.displayGuiScreen(new GuiIngameMenu());
+
+            if (this.isSingleplayer() && !this.theIntegratedServer.getPublic())
+            {
+                this.mcSoundHandler.pauseSounds();
+            }
+        }
+    }
+
+    private void sendClickBlockToController(boolean leftClick)
+    {
+        if (!leftClick)
+        {
+            this.leftClickCounter = 0;
+        }
+
+        if (this.leftClickCounter <= 0 && !this.thePlayer.isUsingItem())
+        {
+            if (leftClick && this.objectMouseOver != null && this.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
+            {
+                BlockPos var2 = this.objectMouseOver.getBlockPos();
+
+                if (this.theWorld.getBlockState(var2).getBlock().getMaterial() != Material.air && this.playerController.onPlayerDamageBlock(var2, this.objectMouseOver.sideHit))
+                {
+                    this.effectRenderer.func_180532_a(var2, this.objectMouseOver.sideHit);
+                    this.thePlayer.swingItem();
+                }
+            }
+            else
+            {
+                this.playerController.resetBlockRemoving();
+            }
+        }
+    }
+
+    private void clickMouse()
+    {
+        if (this.leftClickCounter <= 0)
+        {
+            //TODO: Client
+        	WurstClient.INSTANCE.eventManager.fireEvent(LeftClickEvent.class, new LeftClickEvent());
+            this.thePlayer.swingItem();
+
+            if (this.objectMouseOver == null)
+            {
+                logger.error("Null returned as \'hitResult\', this shouldn\'t happen!");
+
+                if (this.playerController.isNotCreative())
+                {
+                    this.leftClickCounter = 10;
+                }
+            }
+            else
+            {
+                switch (Minecraft.SwitchEnumMinecartType.field_152390_a[this.objectMouseOver.typeOfHit.ordinal()])
+                {
+                    case 1:
+                        this.playerController.attackEntity(this.thePlayer, this.objectMouseOver.entityHit);
+                        break;
+
+                    case 2:
+                        BlockPos var1 = this.objectMouseOver.getBlockPos();
+
+                        if (this.theWorld.getBlockState(var1).getBlock().getMaterial() != Material.air)
+                        {
+                            this.playerController.clickBlock(var1, this.objectMouseOver.sideHit);
+                            break;
+                        }
+
+                    case 3:
+                    default:
+                        if (this.playerController.isNotCreative())
+                        {
+                            this.leftClickCounter = 10;
+                        }
+                }
+            }
+        }
+    }
+
+    /**
+     * Called when user clicked he's mouse right button (place)
+     */
+    //TODO: Client
+    public void rightClickMouse()
+    {
+        this.rightClickDelayTimer = 4;
+        boolean var1 = true;
+        ItemStack var2 = this.thePlayer.inventory.getCurrentItem();
+
+        if (this.objectMouseOver == null)
+        {
+            logger.warn("Null returned as \'hitResult\', this shouldn\'t happen!");
+        }
+        else
+        {
+            switch (Minecraft.SwitchEnumMinecartType.field_152390_a[this.objectMouseOver.typeOfHit.ordinal()])
+            {
+                case 1:
+                    if (this.playerController.func_178894_a(this.thePlayer, this.objectMouseOver.entityHit, this.objectMouseOver))
+                    {
+                        var1 = false;
+                    }
+                    else if (this.playerController.interactWithEntitySendPacket(this.thePlayer, this.objectMouseOver.entityHit))
+                    {
+                        var1 = false;
+                    }
+
+                    break;
+
+                case 2:
+                    BlockPos var3 = this.objectMouseOver.getBlockPos();
+
+                    if (this.theWorld.getBlockState(var3).getBlock().getMaterial() != Material.air)
+                    {
+                        int var4 = var2 != null ? var2.stackSize : 0;
+
+                        if (this.playerController.func_178890_a(this.thePlayer, this.theWorld, var2, var3, this.objectMouseOver.sideHit, this.objectMouseOver.hitVec))
+                        {
+                            var1 = false;
+                            this.thePlayer.swingItem();
+                        }
+
+                        if (var2 == null)
+                        {
+                            return;
+                        }
+
+                        if (var2.stackSize == 0)
+                        {
+                            this.thePlayer.inventory.mainInventory[this.thePlayer.inventory.currentItem] = null;
+                        }
+                        else if (var2.stackSize != var4 || this.playerController.isInCreativeMode())
+                        {
+                            this.entityRenderer.itemRenderer.resetEquippedProgress();
+                        }
+                    }
+            }
+        }
+
+        if (var1)
+        {
+            ItemStack var5 = this.thePlayer.inventory.getCurrentItem();
+
+            if (var5 != null && this.playerController.sendUseItem(this.thePlayer, this.theWorld, var5))
+            {
+                this.entityRenderer.itemRenderer.resetEquippedProgress2();
+            }
+        }
+    }
+
+    /**
+     * Toggles fullscreen mode.
+     */
+    public void toggleFullscreen()
+    {
+        try
+        {
+            this.fullscreen = !this.fullscreen;
+            this.gameSettings.fullScreen = this.fullscreen;
+
+            if (this.fullscreen)
+            {
+                this.updateDisplayMode();
+                this.displayWidth = Display.getDisplayMode().getWidth();
+                this.displayHeight = Display.getDisplayMode().getHeight();
+
+                if (this.displayWidth <= 0)
+                {
+                    this.displayWidth = 1;
+                }
+
+                if (this.displayHeight <= 0)
+                {
+                    this.displayHeight = 1;
+                }
+            }
+            else
+            {
+                Display.setDisplayMode(new DisplayMode(this.tempDisplayWidth, this.tempDisplayHeight));
+                this.displayWidth = this.tempDisplayWidth;
+                this.displayHeight = this.tempDisplayHeight;
+
+                if (this.displayWidth <= 0)
+                {
+                    this.displayWidth = 1;
+                }
+
+                if (this.displayHeight <= 0)
+                {
+                    this.displayHeight = 1;
+                }
+            }
+
+            if (this.currentScreen != null)
+            {
+                this.resize(this.displayWidth, this.displayHeight);
+            }
+            else
+            {
+                this.updateFramebufferSize();
+            }
+
+            Display.setFullscreen(this.fullscreen);
+            Display.setVSyncEnabled(this.gameSettings.enableVsync);
+            this.func_175601_h();
+        }
+        catch (Exception var2)
+        {
+            logger.error("Couldn\'t toggle fullscreen", var2);
+        }
+    }
+
+    /**
+     * Called to resize the current screen.
+     */
+    private void resize(int width, int height)
+    {
+        this.displayWidth = Math.max(1, width);
+        this.displayHeight = Math.max(1, height);
+
+        if (this.currentScreen != null)
+        {
+            ScaledResolution var3 = new ScaledResolution(this, width, height);
+            this.currentScreen.func_175273_b(this, var3.getScaledWidth(), var3.getScaledHeight());
+        }
+
+        this.loadingScreen = new LoadingScreenRenderer(this);
+        this.updateFramebufferSize();
+    }
+
+    private void updateFramebufferSize()
+    {
+        this.framebufferMc.createBindFramebuffer(this.displayWidth, this.displayHeight);
+
+        if (this.entityRenderer != null)
+        {
+            this.entityRenderer.updateShaderGroupSize(this.displayWidth, this.displayHeight);
+        }
+    }
+
+    /**
+     * Runs the current tick.
+     */
+    public void runTick() throws IOException
+    {
+        if (this.rightClickDelayTimer > 0)
+        {
+            --this.rightClickDelayTimer;
+        }
+
+        this.mcProfiler.startSection("gui");
+
+        if (!this.isGamePaused)
+        {
+            this.ingameGUI.updateTick();
+        }
+
+        this.mcProfiler.endSection();
+        this.entityRenderer.getMouseOver(1.0F);
+        this.mcProfiler.startSection("gameMode");
+
+        if (!this.isGamePaused && this.theWorld != null)
+        {
+            this.playerController.updateController();
+        }
+
+        this.mcProfiler.endStartSection("textures");
+
+        if (!this.isGamePaused)
+        {
+            this.renderEngine.tick();
+        }
+
+        if (this.currentScreen == null && this.thePlayer != null)
+        {
+            if (this.thePlayer.getHealth() <= 0.0F)
+            {
+                this.displayGuiScreen((GuiScreen)null);
+            }
+            else if (this.thePlayer.isPlayerSleeping() && this.theWorld != null)
+            {
+                this.displayGuiScreen(new GuiSleepMP());
+            }
+        }
+        else if (this.currentScreen != null && this.currentScreen instanceof GuiSleepMP && !this.thePlayer.isPlayerSleeping())
+        {
+            this.displayGuiScreen((GuiScreen)null);
+        }
+
+        if (this.currentScreen != null)
+        {
+            this.leftClickCounter = 10000;
+        }
+
+        CrashReport var2;
+        CrashReportCategory var3;
+
+        if (this.currentScreen != null)
+        {
+            try
+            {
+                this.currentScreen.handleInput();
+            }
+            catch (Throwable var7)
+            {
+                var2 = CrashReport.makeCrashReport(var7, "Updating screen events");
+                var3 = var2.makeCategory("Affected screen");
+                var3.addCrashSectionCallable("Screen name", new Callable()
+                {
+                    private static final String __OBFID = "CL_00000640";
+                    public String call()
+                    {
+                        return Minecraft.this.currentScreen.getClass().getCanonicalName();
+                    }
+                });
+                throw new ReportedException(var2);
+            }
+
+            if (this.currentScreen != null)
+            {
+                try
+                {
+                    this.currentScreen.updateScreen();
+                }
+                catch (Throwable var6)
+                {
+                    var2 = CrashReport.makeCrashReport(var6, "Ticking screen");
+                    var3 = var2.makeCategory("Affected screen");
+                    var3.addCrashSectionCallable("Screen name", new Callable()
+                    {
+                        private static final String __OBFID = "CL_00000642";
+                        public String call()
+                        {
+                            return Minecraft.this.currentScreen.getClass().getCanonicalName();
+                        }
+                    });
+                    throw new ReportedException(var2);
+                }
+            }
+        }
+
+        if (this.currentScreen == null || this.currentScreen.allowUserInput)
+        {
+            this.mcProfiler.endStartSection("mouse");
+            int var1;
+
+            while (Mouse.next())
+            {
+                var1 = Mouse.getEventButton();
+                KeyBinding.setKeyBindState(var1 - 100, Mouse.getEventButtonState());
+
+                if (Mouse.getEventButtonState())
+                {
+                    if (this.thePlayer.isSpectator() && var1 == 2)
+                    {
+                        this.ingameGUI.func_175187_g().func_175261_b();
+                    }
+                    else
+                    {
+                        KeyBinding.onTick(var1 - 100);
+                    }
+                }
+
+                long var10 = getSystemTime() - this.systemTime;
+
+                if (var10 <= 200L)
+                {
+                    int var4 = Mouse.getEventDWheel();
+
+                    if (var4 != 0)
+                    {
+                        if (this.thePlayer.isSpectator())
+                        {
+                            var4 = var4 < 0 ? -1 : 1;
+
+                            if (this.ingameGUI.func_175187_g().func_175262_a())
+                            {
+                                this.ingameGUI.func_175187_g().func_175259_b(-var4);
+                            }
+                            else
+                            {
+                                float var5 = MathHelper.clamp_float(this.thePlayer.capabilities.getFlySpeed() + (float)var4 * 0.005F, 0.0F, 0.2F);
+                                this.thePlayer.capabilities.setFlySpeed(var5);
+                            }
+                        }
+                        else
+                        {
+                            this.thePlayer.inventory.changeCurrentItem(var4);
+                        }
+                    }
+
+                    if (this.currentScreen == null)
+                    {
+                        if (!this.inGameHasFocus && Mouse.getEventButtonState())
+                        {
+                            this.setIngameFocus();
+                        }
+                    }
+                    else if (this.currentScreen != null)
+                    {
+                        this.currentScreen.handleMouseInput();
+                    }
+                }
+            }
+
+            if (this.leftClickCounter > 0)
+            {
+                --this.leftClickCounter;
+            }
+
+            this.mcProfiler.endStartSection("keyboard");
+
+            while (Keyboard.next())
+            {
+                var1 = Keyboard.getEventKey() == 0 ? Keyboard.getEventCharacter() + 256 : Keyboard.getEventKey();
+                KeyBinding.setKeyBindState(var1, Keyboard.getEventKeyState());
+
+                if (Keyboard.getEventKeyState())
+                {
+                    KeyBinding.onTick(var1);
+                }
+
+                if (this.debugCrashKeyPressTime > 0L)
+                {
+                    if (getSystemTime() - this.debugCrashKeyPressTime >= 6000L)
+                    {
+                        throw new ReportedException(new CrashReport("Manually triggered debug crash", new Throwable()));
+                    }
+
+                    if (!Keyboard.isKeyDown(46) || !Keyboard.isKeyDown(61))
+                    {
+                        this.debugCrashKeyPressTime = -1L;
+                    }
+                }
+                else if (Keyboard.isKeyDown(46) && Keyboard.isKeyDown(61))
+                {
+                    this.debugCrashKeyPressTime = getSystemTime();
+                }
+
+                this.dispatchKeypresses();
+
+                if (Keyboard.getEventKeyState())
+                {
+                    if (var1 == 62 && this.entityRenderer != null)
+                    {
+                        this.entityRenderer.func_175071_c();
+                    }
+
+                    if (this.currentScreen != null)
+                    {
+                        this.currentScreen.handleKeyboardInput();
+                    }
+                    else
+                    {
+                    	//TODO: Client
+            			if(Keyboard.getEventKey() != 0)
+            			{
+            				String eventCommand = WurstClient.INSTANCE.keybinds.get(Keyboard.getKeyName(Keyboard.getEventKey()));
+            				if(eventCommand != null)
+            					thePlayer.sendAutomaticChatMessage(eventCommand);
+            			}
+                    	
+                        if (var1 == 1)
+                        {
+                            this.displayInGameMenu();
+                        }
+
+                        if (var1 == 32 && Keyboard.isKeyDown(61) && this.ingameGUI != null)
+                        {
+                            this.ingameGUI.getChatGUI().clearChatMessages();
+                        }
+
+                        if (var1 == 31 && Keyboard.isKeyDown(61))
+                        {
+                            this.refreshResources();
+                        }
+
+                        if (var1 == 17 && Keyboard.isKeyDown(61))
+                        {
+                            ;
+                        }
+
+                        if (var1 == 18 && Keyboard.isKeyDown(61))
+                        {
+                            ;
+                        }
+
+                        if (var1 == 47 && Keyboard.isKeyDown(61))
+                        {
+                            ;
+                        }
+
+                        if (var1 == 38 && Keyboard.isKeyDown(61))
+                        {
+                            ;
+                        }
+
+                        if (var1 == 22 && Keyboard.isKeyDown(61))
+                        {
+                            ;
+                        }
+
+                        if (var1 == 20 && Keyboard.isKeyDown(61))
+                        {
+                            this.refreshResources();
+                        }
+
+                        if (var1 == 33 && Keyboard.isKeyDown(61))
+                        {
+                            boolean var11 = Keyboard.isKeyDown(42) | Keyboard.isKeyDown(54);
+                            this.gameSettings.setOptionValue(GameSettings.Options.RENDER_DISTANCE, var11 ? -1 : 1);
+                        }
+
+                        if (var1 == 30 && Keyboard.isKeyDown(61))
+                        {
+                            this.renderGlobal.loadRenderers();
+                        }
+
+                        if (var1 == 35 && Keyboard.isKeyDown(61))
+                        {
+                            this.gameSettings.advancedItemTooltips = !this.gameSettings.advancedItemTooltips;
+                            this.gameSettings.saveOptions();
+                        }
+
+                        if (var1 == 48 && Keyboard.isKeyDown(61))
+                        {
+                            this.renderManager.func_178629_b(!this.renderManager.func_178634_b());
+                        }
+
+                        if (var1 == 25 && Keyboard.isKeyDown(61))
+                        {
+                            this.gameSettings.pauseOnLostFocus = !this.gameSettings.pauseOnLostFocus;
+                            this.gameSettings.saveOptions();
+                        }
+
+                        if (var1 == 59)
+                        {
+                            this.gameSettings.hideGUI = !this.gameSettings.hideGUI;
+                        }
+
+                        if (var1 == 61)
+                        {
+                            this.gameSettings.showDebugInfo = !this.gameSettings.showDebugInfo;
+                            this.gameSettings.showDebugProfilerChart = GuiScreen.isShiftKeyDown();
+                        }
+
+                        if (this.gameSettings.keyBindTogglePerspective.isPressed())
+                        {
+                            ++this.gameSettings.thirdPersonView;
+
+                            if (this.gameSettings.thirdPersonView > 2)
+                            {
+                                this.gameSettings.thirdPersonView = 0;
+                            }
+
+                            if (this.gameSettings.thirdPersonView == 0)
+                            {
+                                this.entityRenderer.func_175066_a(this.func_175606_aa());
+                            }
+                            else if (this.gameSettings.thirdPersonView == 1)
+                            {
+                                this.entityRenderer.func_175066_a((Entity)null);
+                            }
+                        }
+
+                        if (this.gameSettings.keyBindSmoothCamera.isPressed())
+                        {
+                            this.gameSettings.smoothCamera = !this.gameSettings.smoothCamera;
+                        }
+                    }
+
+                    if (this.gameSettings.showDebugInfo && this.gameSettings.showDebugProfilerChart)
+                    {
+                        if (var1 == 11)
+                        {
+                            this.updateDebugProfilerName(0);
+                        }
+
+                        for (int var12 = 0; var12 < 9; ++var12)
+                        {
+                            if (var1 == 2 + var12)
+                            {
+                                this.updateDebugProfilerName(var12 + 1);
+                            }
+                        }
+                    }
+                }
+            }
+
+            for (var1 = 0; var1 < 9; ++var1)
+            {
+                if (this.gameSettings.keyBindsHotbar[var1].isPressed())
+                {
+                    if (this.thePlayer.isSpectator())
+                    {
+                        this.ingameGUI.func_175187_g().func_175260_a(var1);
+                    }
+                    else
+                    {
+                        this.thePlayer.inventory.currentItem = var1;
+                    }
+                }
+            }
+
+            boolean var9 = this.gameSettings.chatVisibility != EntityPlayer.EnumChatVisibility.HIDDEN;
+
+            while (this.gameSettings.keyBindInventory.isPressed())
+            {
+                if (this.playerController.isRidingHorse())
+                {
+                    this.thePlayer.func_175163_u();
+                }
+                else
+                {
+                    this.getNetHandler().addToSendQueue(new C16PacketClientStatus(C16PacketClientStatus.EnumState.OPEN_INVENTORY_ACHIEVEMENT));
+                    this.displayGuiScreen(new GuiInventory(this.thePlayer));
+                }
+            }
+
+            while (this.gameSettings.keyBindDrop.isPressed())
+            {
+                if (!this.thePlayer.isSpectator())
+                {
+                    this.thePlayer.dropOneItem(GuiScreen.isCtrlKeyDown());
+                }
+            }
+
+            while (this.gameSettings.keyBindChat.isPressed() && var9)
+            {
+                this.displayGuiScreen(new GuiChat());
+            }
+
+            if (this.currentScreen == null && this.gameSettings.keyBindCommand.isPressed() && var9)
+            {
+                this.displayGuiScreen(new GuiChat("/"));
+            }
+
+            if (this.thePlayer.isUsingItem())
+            {
+                if (!this.gameSettings.keyBindUseItem.getIsKeyPressed())
+                {
+                    this.playerController.onStoppedUsingItem(this.thePlayer);
+                }
+
+                label435:
+
+                while (true)
+                {
+                    if (!this.gameSettings.keyBindAttack.isPressed())
+                    {
+                        while (this.gameSettings.keyBindUseItem.isPressed())
+                        {
+                            ;
+                        }
+
+                        while (true)
+                        {
+                            if (this.gameSettings.keyBindPickBlock.isPressed())
+                            {
+                                continue;
+                            }
+
+                            break label435;
+                        }
+                    }
+                }
+            }
+            else
+            {
+                while (this.gameSettings.keyBindAttack.isPressed())
+                {
+                    this.clickMouse();
+                }
+
+                while (this.gameSettings.keyBindUseItem.isPressed())
+                {
+                    this.rightClickMouse();
+                }
+
+                while (this.gameSettings.keyBindPickBlock.isPressed())
+                {
+                    this.middleClickMouse();
+                }
+            }
+
+            if (this.gameSettings.keyBindUseItem.getIsKeyPressed() && this.rightClickDelayTimer == 0 && !this.thePlayer.isUsingItem())
+            {
+                this.rightClickMouse();
+            }
+
+            this.sendClickBlockToController(this.currentScreen == null && this.gameSettings.keyBindAttack.getIsKeyPressed() && this.inGameHasFocus);
+        }
+
+        if (this.theWorld != null)
+        {
+            if (this.thePlayer != null)
+            {
+                ++this.joinPlayerCounter;
+
+                if (this.joinPlayerCounter == 30)
+                {
+                    this.joinPlayerCounter = 0;
+                    this.theWorld.joinEntityInSurroundings(this.thePlayer);
+                }
+            }
+
+            this.mcProfiler.endStartSection("gameRenderer");
+
+            if (!this.isGamePaused)
+            {
+                this.entityRenderer.updateRenderer();
+            }
+
+            this.mcProfiler.endStartSection("levelRenderer");
+
+            if (!this.isGamePaused)
+            {
+                this.renderGlobal.updateClouds();
+            }
+
+            this.mcProfiler.endStartSection("level");
+
+            if (!this.isGamePaused)
+            {
+                if (this.theWorld.func_175658_ac() > 0)
+                {
+                    this.theWorld.setLastLightningBolt(this.theWorld.func_175658_ac() - 1);
+                }
+
+                this.theWorld.updateEntities();
+            }
+        }
+
+        if (!this.isGamePaused)
+        {
+            this.mcMusicTicker.update();
+            this.mcSoundHandler.update();
+        }
+
+        if (this.theWorld != null)
+        {
+            if (!this.isGamePaused)
+            {
+                this.theWorld.setAllowedSpawnTypes(this.theWorld.getDifficulty() != EnumDifficulty.PEACEFUL, true);
+
+                try
+                {
+                    this.theWorld.tick();
+                }
+                catch (Throwable var8)
+                {
+                    var2 = CrashReport.makeCrashReport(var8, "Exception in world tick");
+
+                    if (this.theWorld == null)
+                    {
+                        var3 = var2.makeCategory("Affected level");
+                        var3.addCrashSection("Problem", "Level is null!");
+                    }
+                    else
+                    {
+                        this.theWorld.addWorldInfoToCrashReport(var2);
+                    }
+
+                    throw new ReportedException(var2);
+                }
+            }
+
+            this.mcProfiler.endStartSection("animateTick");
+
+            if (!this.isGamePaused && this.theWorld != null)
+            {
+                this.theWorld.doVoidFogParticles(MathHelper.floor_double(this.thePlayer.posX), MathHelper.floor_double(this.thePlayer.posY), MathHelper.floor_double(this.thePlayer.posZ));
+            }
+
+            this.mcProfiler.endStartSection("particles");
+
+            if (!this.isGamePaused)
+            {
+                this.effectRenderer.updateEffects();
+            }
+        }
+        else if (this.myNetworkManager != null)
+        {
+            this.mcProfiler.endStartSection("pendingConnection");
+            this.myNetworkManager.processReceivedPackets();
+        }
+
+        this.mcProfiler.endSection();
+        this.systemTime = getSystemTime();
+    }
+
+    /**
+     * Arguments: World foldername,  World ingame name, WorldSettings
+     */
+    public void launchIntegratedServer(String folderName, String worldName, WorldSettings worldSettingsIn)
+    {
+        this.loadWorld((WorldClient)null);
+        System.gc();
+        ISaveHandler var4 = this.saveLoader.getSaveLoader(folderName, false);
+        WorldInfo var5 = var4.loadWorldInfo();
+
+        if (var5 == null && worldSettingsIn != null)
+        {
+            var5 = new WorldInfo(worldSettingsIn, folderName);
+            var4.saveWorldInfo(var5);
+        }
+
+        if (worldSettingsIn == null)
+        {
+            worldSettingsIn = new WorldSettings(var5);
+        }
+
+        try
+        {
+            this.theIntegratedServer = new IntegratedServer(this, folderName, worldName, worldSettingsIn);
+            this.theIntegratedServer.startServerThread();
+            this.integratedServerIsRunning = true;
+        }
+        catch (Throwable var10)
+        {
+            CrashReport var7 = CrashReport.makeCrashReport(var10, "Starting integrated server");
+            CrashReportCategory var8 = var7.makeCategory("Starting integrated server");
+            var8.addCrashSection("Level ID", folderName);
+            var8.addCrashSection("Level Name", worldName);
+            throw new ReportedException(var7);
+        }
+
+        this.loadingScreen.displaySavingString(I18n.format("menu.loadingLevel", new Object[0]));
+
+        while (!this.theIntegratedServer.serverIsInRunLoop())
+        {
+            String var6 = this.theIntegratedServer.getUserMessage();
+
+            if (var6 != null)
+            {
+                this.loadingScreen.displayLoadingString(I18n.format(var6, new Object[0]));
+            }
+            else
+            {
+                this.loadingScreen.displayLoadingString("");
+            }
+
+            try
+            {
+                Thread.sleep(200L);
+            }
+            catch (InterruptedException var9)
+            {
+                ;
+            }
+        }
+
+        this.displayGuiScreen((GuiScreen)null);
+        SocketAddress var11 = this.theIntegratedServer.getNetworkSystem().addLocalEndpoint();
+        NetworkManager var12 = NetworkManager.provideLocalClient(var11);
+        var12.setNetHandler(new NetHandlerLoginClient(var12, this, (GuiScreen)null));
+        var12.sendPacket(new C00Handshake(47, var11.toString(), 0, EnumConnectionState.LOGIN));
+        var12.sendPacket(new C00PacketLoginStart(this.getSession().getProfile()));
+        this.myNetworkManager = var12;
+        
+        //TODO: Client
+        SpamProcessor.runScript("joinworld", "Runs whenever you join a singleplayer world.");
+		WurstClient.INSTANCE.analytics.trackPageView("/play/singleplayer", "Singleplayer");
+    }
+
+    /**
+     * unloads the current world first
+     */
+    public void loadWorld(WorldClient worldClientIn)
+    {
+        this.loadWorld(worldClientIn, "");
+    }
+
+    /**
+     * par2Str is displayed on the loading screen to the user unloads the current world first
+     */
+    public void loadWorld(WorldClient worldClientIn, String loadingMessage)
+    {
+        if (worldClientIn == null)
+        {
+            NetHandlerPlayClient var3 = this.getNetHandler();
+
+            if (var3 != null)
+            {
+                var3.cleanup();
+            }
+
+            if (this.theIntegratedServer != null && this.theIntegratedServer.func_175578_N())
+            {
+                this.theIntegratedServer.initiateShutdown();
+                this.theIntegratedServer.func_175592_a();
+            }
+
+            this.theIntegratedServer = null;
+            this.guiAchievement.clearAchievements();
+            this.entityRenderer.getMapItemRenderer().func_148249_a();
+        }
+
+        this.field_175622_Z = null;
+        this.myNetworkManager = null;
+
+        if (this.loadingScreen != null)
+        {
+            this.loadingScreen.resetProgressAndMessage(loadingMessage);
+            this.loadingScreen.displayLoadingString("");
+        }
+
+        if (worldClientIn == null && this.theWorld != null)
+        {
+            if (this.mcResourcePackRepository.getResourcePackInstance() != null)
+            {
+                this.mcResourcePackRepository.func_148529_f();
+                this.func_175603_A();
+            }
+
+            this.setServerData((ServerData)null);
+            this.integratedServerIsRunning = false;
+        }
+
+        this.mcSoundHandler.stopSounds();
+        this.theWorld = worldClientIn;
+
+        if (worldClientIn != null)
+        {
+            if (this.renderGlobal != null)
+            {
+                this.renderGlobal.setWorldAndLoadRenderers(worldClientIn);
+            }
+
+            if (this.effectRenderer != null)
+            {
+                this.effectRenderer.clearEffects(worldClientIn);
+            }
+
+            if (this.thePlayer == null)
+            {
+                this.thePlayer = this.playerController.func_178892_a(worldClientIn, new StatFileWriter());
+                this.playerController.flipPlayer(this.thePlayer);
+            }
+
+            this.thePlayer.preparePlayerToSpawn();
+            worldClientIn.spawnEntityInWorld(this.thePlayer);
+            this.thePlayer.movementInput = new MovementInputFromOptions(this.gameSettings);
+            this.playerController.setPlayerCapabilities(this.thePlayer);
+            this.field_175622_Z = this.thePlayer;
+        }
+        else
+        {
+            this.saveLoader.flushCache();
+            this.thePlayer = null;
+        }
+
+        System.gc();
+        this.systemTime = 0L;
+    }
+
+    public void setDimensionAndSpawnPlayer(int dimension)
+    {
+        this.theWorld.setInitialSpawnLocation();
+        this.theWorld.removeAllEntities();
+        int var2 = 0;
+        String var3 = null;
+
+        if (this.thePlayer != null)
+        {
+            var2 = this.thePlayer.getEntityId();
+            this.theWorld.removeEntity(this.thePlayer);
+            var3 = this.thePlayer.getClientBrand();
+        }
+
+        this.field_175622_Z = null;
+        EntityPlayerSP var4 = this.thePlayer;
+        this.thePlayer = this.playerController.func_178892_a(this.theWorld, this.thePlayer == null ? new StatFileWriter() : this.thePlayer.getStatFileWriter());
+        this.thePlayer.getDataWatcher().updateWatchedObjectsFromList(var4.getDataWatcher().getAllWatched());
+        this.thePlayer.dimension = dimension;
+        this.field_175622_Z = this.thePlayer;
+        this.thePlayer.preparePlayerToSpawn();
+        this.thePlayer.func_175158_f(var3);
+        this.theWorld.spawnEntityInWorld(this.thePlayer);
+        this.playerController.flipPlayer(this.thePlayer);
+        this.thePlayer.movementInput = new MovementInputFromOptions(this.gameSettings);
+        this.thePlayer.setEntityId(var2);
+        this.playerController.setPlayerCapabilities(this.thePlayer);
+        this.thePlayer.func_175150_k(var4.func_175140_cp());
+
+        if (this.currentScreen instanceof GuiGameOver)
+        {
+            this.displayGuiScreen((GuiScreen)null);
+        }
+    }
+
+    /**
+     * Gets whether this is a demo or not.
+     */
+    public final boolean isDemo()
+    {
+        return this.isDemo;
+    }
+
+    public NetHandlerPlayClient getNetHandler()
+    {
+        return this.thePlayer != null ? this.thePlayer.sendQueue : null;
+    }
+
+    public static boolean isGuiEnabled()
+    {
+        return theMinecraft == null || !theMinecraft.gameSettings.hideGUI;
+    }
+
+    public static boolean isFancyGraphicsEnabled()
+    {
+        return theMinecraft != null && theMinecraft.gameSettings.fancyGraphics;
+    }
+
+    /**
+     * Returns if ambient occlusion is enabled
+     */
+    public static boolean isAmbientOcclusionEnabled()
+    {
+        return theMinecraft != null && theMinecraft.gameSettings.ambientOcclusion != 0;
+    }
+
+    /**
+     * Called when user clicked he's mouse middle button (pick block)
+     */
+    private void middleClickMouse()
+    {
+        if (this.objectMouseOver != null)
+        {
+            boolean var1 = this.thePlayer.capabilities.isCreativeMode;
+            int var3 = 0;
+            boolean var4 = false;
+            TileEntity var5 = null;
+            Object var2;
+
+            if (this.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
+            {
+                BlockPos var6 = this.objectMouseOver.getBlockPos();
+                Block var7 = this.theWorld.getBlockState(var6).getBlock();
+
+                if (var7.getMaterial() == Material.air)
+                {
+                    return;
+                }
+
+                var2 = var7.getItem(this.theWorld, var6);
+
+                if (var2 == null)
+                {
+                    return;
+                }
+
+                if (var1 && GuiScreen.isCtrlKeyDown())
+                {
+                    var5 = this.theWorld.getTileEntity(var6);
+                }
+
+                Block var8 = var2 instanceof ItemBlock && !var7.isFlowerPot() ? Block.getBlockFromItem((Item)var2) : var7;
+                var3 = var8.getDamageValue(this.theWorld, var6);
+                var4 = ((Item)var2).getHasSubtypes();
+            }
+            else
+            {
+				// TODO: Client
+				if(this.objectMouseOver.entityHit != null
+					&& this.objectMouseOver.entityHit instanceof EntityPlayer)
+				{
+					if(WurstClient.INSTANCE.options.middleClickFriends)
+					{
+						if(WurstClient.INSTANCE.friends
+							.contains(objectMouseOver.entityHit.getName()))
+						{
+							WurstClient.INSTANCE.friends
+								.remove(objectMouseOver.entityHit.getName());
+						}else
+						{
+							WurstClient.INSTANCE.friends
+								.add(this.objectMouseOver.entityHit.getName());
+						}
+						WurstClient.INSTANCE.fileManager.saveFriends();
+					}
+				}
+                
+                if (this.objectMouseOver.typeOfHit != MovingObjectPosition.MovingObjectType.ENTITY || this.objectMouseOver.entityHit == null || !var1)
+                {
+                    return;
+                }
+
+                if (this.objectMouseOver.entityHit instanceof EntityPainting)
+                {
+                    var2 = Items.painting;
+                }
+                else if (this.objectMouseOver.entityHit instanceof EntityLeashKnot)
+                {
+                    var2 = Items.lead;
+                }
+                else if (this.objectMouseOver.entityHit instanceof EntityItemFrame)
+                {
+                    EntityItemFrame var11 = (EntityItemFrame)this.objectMouseOver.entityHit;
+                    ItemStack var14 = var11.getDisplayedItem();
+
+                    if (var14 == null)
+                    {
+                        var2 = Items.item_frame;
+                    }
+                    else
+                    {
+                        var2 = var14.getItem();
+                        var3 = var14.getMetadata();
+                        var4 = true;
+                    }
+                }
+                else if (this.objectMouseOver.entityHit instanceof EntityMinecart)
+                {
+                    EntityMinecart var12 = (EntityMinecart)this.objectMouseOver.entityHit;
+
+                    switch (Minecraft.SwitchEnumMinecartType.field_178901_b[var12.func_180456_s().ordinal()])
+                    {
+                        case 1:
+                            var2 = Items.furnace_minecart;
+                            break;
+
+                        case 2:
+                            var2 = Items.chest_minecart;
+                            break;
+
+                        case 3:
+                            var2 = Items.tnt_minecart;
+                            break;
+
+                        case 4:
+                            var2 = Items.hopper_minecart;
+                            break;
+
+                        case 5:
+                            var2 = Items.command_block_minecart;
+                            break;
+
+                        default:
+                            var2 = Items.minecart;
+                    }
+                }
+                else if (this.objectMouseOver.entityHit instanceof EntityBoat)
+                {
+                    var2 = Items.boat;
+                }
+                else if (this.objectMouseOver.entityHit instanceof EntityArmorStand)
+                {
+                    var2 = Items.armor_stand;
+                }
+                else
+                {
+                    var2 = Items.spawn_egg;
+                    var3 = EntityList.getEntityID(this.objectMouseOver.entityHit);
+                    var4 = true;
+
+                    if (!EntityList.entityEggs.containsKey(Integer.valueOf(var3)))
+                    {
+                        return;
+                    }
+                }
+            }
+
+            InventoryPlayer var13 = this.thePlayer.inventory;
+
+            if (var5 == null)
+            {
+                var13.setCurrentItem((Item)var2, var3, var4, var1);
+            }
+            else
+            {
+                NBTTagCompound var15 = new NBTTagCompound();
+                var5.writeToNBT(var15);
+                ItemStack var17 = new ItemStack((Item)var2, 1, var3);
+                var17.setTagInfo("BlockEntityTag", var15);
+                NBTTagCompound var9 = new NBTTagCompound();
+                NBTTagList var10 = new NBTTagList();
+                var10.appendTag(new NBTTagString("(+NBT)"));
+                var9.setTag("Lore", var10);
+                var17.setTagInfo("display", var9);
+                var13.setInventorySlotContents(var13.currentItem, var17);
+            }
+
+            if (var1)
+            {
+                int var16 = this.thePlayer.inventoryContainer.inventorySlots.size() - 9 + var13.currentItem;
+                this.playerController.sendSlotPacket(var13.getStackInSlot(var13.currentItem), var16);
+            }
+        }
+    }
+
+    /**
+     * adds core server Info (GL version , Texture pack, isModded, type), and the worldInfo to the crash report
+     */
+    public CrashReport addGraphicsAndWorldToCrashReport(CrashReport theCrash)
+    {
+        theCrash.getCategory().addCrashSectionCallable("Launched Version", new Callable()
+        {
+            private static final String __OBFID = "CL_00000643";
+            public String call()
+            {
+                return Minecraft.this.launchedVersion;
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("LWJGL", new Callable()
+        {
+            private static final String __OBFID = "CL_00000644";
+            public String call()
+            {
+                return Sys.getVersion();
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("OpenGL", new Callable()
+        {
+            private static final String __OBFID = "CL_00000645";
+            public String call()
+            {
+                return GL11.glGetString(GL11.GL_RENDERER) + " GL version " + GL11.glGetString(GL11.GL_VERSION) + ", " + GL11.glGetString(GL11.GL_VENDOR);
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("GL Caps", new Callable()
+        {
+            private static final String __OBFID = "CL_00000646";
+            public String call()
+            {
+                return OpenGlHelper.func_153172_c();
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Using VBOs", new Callable()
+        {
+            private static final String __OBFID = "CL_00000647";
+            public String call()
+            {
+                return Minecraft.this.gameSettings.field_178881_t ? "Yes" : "No";
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Is Modded", new Callable()
+        {
+            private static final String __OBFID = "CL_00000633";
+            public String call()
+            {
+                String var1 = ClientBrandRetriever.getClientModName();
+                return !var1.equals("vanilla") ? "Definitely; Client brand changed to \'" + var1 + "\'" : (Minecraft.class.getSigners() == null ? "Very likely; Jar signature invalidated" : "Probably not. Jar signature remains and client brand is untouched.");
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Type", new Callable()
+        {
+            private static final String __OBFID = "CL_00000634";
+            public String call()
+            {
+                return "Client (map_client.txt)";
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Resource Packs", new Callable()
+        {
+            private static final String __OBFID = "CL_00000635";
+            public String call()
+            {
+                return Minecraft.this.gameSettings.resourcePacks.toString();
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Current Language", new Callable()
+        {
+            private static final String __OBFID = "CL_00000636";
+            public String call()
+            {
+                return Minecraft.this.mcLanguageManager.getCurrentLanguage().toString();
+            }
+        });
+        theCrash.getCategory().addCrashSectionCallable("Profiler Position", new Callable()
+        {
+            private static final String __OBFID = "CL_00000637";
+            public String call()
+            {
+                return Minecraft.this.mcProfiler.profilingEnabled ? Minecraft.this.mcProfiler.getNameOfLastSection() : "N/A (disabled)";
+            }
+        });
+
+        if (this.theWorld != null)
+        {
+            this.theWorld.addWorldInfoToCrashReport(theCrash);
+        }
+
+        return theCrash;
+    }
+
+    /**
+     * Return the singleton Minecraft instance for the game
+     */
+    public static Minecraft getMinecraft()
+    {
+        return theMinecraft;
+    }
+
+    public ListenableFuture func_175603_A()
+    {
+        return this.addScheduledTask(new Runnable()
+        {
+            private static final String __OBFID = "CL_00001853";
+            public void run()
+            {
+                Minecraft.this.refreshResources();
+            }
+        });
+    }
+
+    public void addServerStatsToSnooper(PlayerUsageSnooper playerSnooper)
+    {
+        playerSnooper.addClientStat("fps", Integer.valueOf(debugFPS));
+        playerSnooper.addClientStat("vsync_enabled", Boolean.valueOf(this.gameSettings.enableVsync));
+        playerSnooper.addClientStat("display_frequency", Integer.valueOf(Display.getDisplayMode().getFrequency()));
+        playerSnooper.addClientStat("display_type", this.fullscreen ? "fullscreen" : "windowed");
+        playerSnooper.addClientStat("run_time", Long.valueOf((MinecraftServer.getCurrentTimeMillis() - playerSnooper.getMinecraftStartTimeMillis()) / 60L * 1000L));
+        String var2 = ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN ? "little" : "big";
+        playerSnooper.addClientStat("endianness", var2);
+        playerSnooper.addClientStat("resource_packs", Integer.valueOf(this.mcResourcePackRepository.getRepositoryEntries().size()));
+        int var3 = 0;
+        Iterator var4 = this.mcResourcePackRepository.getRepositoryEntries().iterator();
+
+        while (var4.hasNext())
+        {
+            ResourcePackRepository.Entry var5 = (ResourcePackRepository.Entry)var4.next();
+            playerSnooper.addClientStat("resource_pack[" + var3++ + "]", var5.getResourcePackName());
+        }
+
+        if (this.theIntegratedServer != null && this.theIntegratedServer.getPlayerUsageSnooper() != null)
+        {
+            playerSnooper.addClientStat("snooper_partner", this.theIntegratedServer.getPlayerUsageSnooper().getUniqueID());
+        }
+    }
+
+    public void addServerTypeToSnooper(PlayerUsageSnooper playerSnooper)
+    {
+        playerSnooper.addStatToSnooper("opengl_version", GL11.glGetString(GL11.GL_VERSION));
+        playerSnooper.addStatToSnooper("opengl_vendor", GL11.glGetString(GL11.GL_VENDOR));
+        playerSnooper.addStatToSnooper("client_brand", ClientBrandRetriever.getClientModName());
+        playerSnooper.addStatToSnooper("launched_version", this.launchedVersion);
+        ContextCapabilities var2 = GLContext.getCapabilities();
+        playerSnooper.addStatToSnooper("gl_caps[ARB_arrays_of_arrays]", Boolean.valueOf(var2.GL_ARB_arrays_of_arrays));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_base_instance]", Boolean.valueOf(var2.GL_ARB_base_instance));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_blend_func_extended]", Boolean.valueOf(var2.GL_ARB_blend_func_extended));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_clear_buffer_object]", Boolean.valueOf(var2.GL_ARB_clear_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_color_buffer_float]", Boolean.valueOf(var2.GL_ARB_color_buffer_float));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_compatibility]", Boolean.valueOf(var2.GL_ARB_compatibility));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_compressed_texture_pixel_storage]", Boolean.valueOf(var2.GL_ARB_compressed_texture_pixel_storage));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_compute_shader]", Boolean.valueOf(var2.GL_ARB_compute_shader));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_buffer]", Boolean.valueOf(var2.GL_ARB_copy_buffer));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_image]", Boolean.valueOf(var2.GL_ARB_copy_image));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_buffer_float]", Boolean.valueOf(var2.GL_ARB_depth_buffer_float));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_compute_shader]", Boolean.valueOf(var2.GL_ARB_compute_shader));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_buffer]", Boolean.valueOf(var2.GL_ARB_copy_buffer));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_copy_image]", Boolean.valueOf(var2.GL_ARB_copy_image));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_buffer_float]", Boolean.valueOf(var2.GL_ARB_depth_buffer_float));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_clamp]", Boolean.valueOf(var2.GL_ARB_depth_clamp));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_depth_texture]", Boolean.valueOf(var2.GL_ARB_depth_texture));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_buffers]", Boolean.valueOf(var2.GL_ARB_draw_buffers));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_buffers_blend]", Boolean.valueOf(var2.GL_ARB_draw_buffers_blend));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_elements_base_vertex]", Boolean.valueOf(var2.GL_ARB_draw_elements_base_vertex));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_indirect]", Boolean.valueOf(var2.GL_ARB_draw_indirect));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_draw_instanced]", Boolean.valueOf(var2.GL_ARB_draw_instanced));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_explicit_attrib_location]", Boolean.valueOf(var2.GL_ARB_explicit_attrib_location));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_explicit_uniform_location]", Boolean.valueOf(var2.GL_ARB_explicit_uniform_location));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_layer_viewport]", Boolean.valueOf(var2.GL_ARB_fragment_layer_viewport));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_program]", Boolean.valueOf(var2.GL_ARB_fragment_program));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_shader]", Boolean.valueOf(var2.GL_ARB_fragment_shader));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_fragment_program_shadow]", Boolean.valueOf(var2.GL_ARB_fragment_program_shadow));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_framebuffer_object]", Boolean.valueOf(var2.GL_ARB_framebuffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_framebuffer_sRGB]", Boolean.valueOf(var2.GL_ARB_framebuffer_sRGB));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_geometry_shader4]", Boolean.valueOf(var2.GL_ARB_geometry_shader4));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_gpu_shader5]", Boolean.valueOf(var2.GL_ARB_gpu_shader5));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_half_float_pixel]", Boolean.valueOf(var2.GL_ARB_half_float_pixel));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_half_float_vertex]", Boolean.valueOf(var2.GL_ARB_half_float_vertex));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_instanced_arrays]", Boolean.valueOf(var2.GL_ARB_instanced_arrays));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_map_buffer_alignment]", Boolean.valueOf(var2.GL_ARB_map_buffer_alignment));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_map_buffer_range]", Boolean.valueOf(var2.GL_ARB_map_buffer_range));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_multisample]", Boolean.valueOf(var2.GL_ARB_multisample));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_multitexture]", Boolean.valueOf(var2.GL_ARB_multitexture));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_occlusion_query2]", Boolean.valueOf(var2.GL_ARB_occlusion_query2));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_pixel_buffer_object]", Boolean.valueOf(var2.GL_ARB_pixel_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_seamless_cube_map]", Boolean.valueOf(var2.GL_ARB_seamless_cube_map));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_objects]", Boolean.valueOf(var2.GL_ARB_shader_objects));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_stencil_export]", Boolean.valueOf(var2.GL_ARB_shader_stencil_export));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_shader_texture_lod]", Boolean.valueOf(var2.GL_ARB_shader_texture_lod));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_shadow]", Boolean.valueOf(var2.GL_ARB_shadow));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_shadow_ambient]", Boolean.valueOf(var2.GL_ARB_shadow_ambient));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_stencil_texturing]", Boolean.valueOf(var2.GL_ARB_stencil_texturing));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_sync]", Boolean.valueOf(var2.GL_ARB_sync));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_tessellation_shader]", Boolean.valueOf(var2.GL_ARB_tessellation_shader));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_border_clamp]", Boolean.valueOf(var2.GL_ARB_texture_border_clamp));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_buffer_object]", Boolean.valueOf(var2.GL_ARB_texture_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_cube_map]", Boolean.valueOf(var2.GL_ARB_texture_cube_map));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_cube_map_array]", Boolean.valueOf(var2.GL_ARB_texture_cube_map_array));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_texture_non_power_of_two]", Boolean.valueOf(var2.GL_ARB_texture_non_power_of_two));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_uniform_buffer_object]", Boolean.valueOf(var2.GL_ARB_uniform_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_blend]", Boolean.valueOf(var2.GL_ARB_vertex_blend));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_buffer_object]", Boolean.valueOf(var2.GL_ARB_vertex_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_program]", Boolean.valueOf(var2.GL_ARB_vertex_program));
+        playerSnooper.addStatToSnooper("gl_caps[ARB_vertex_shader]", Boolean.valueOf(var2.GL_ARB_vertex_shader));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_bindable_uniform]", Boolean.valueOf(var2.GL_EXT_bindable_uniform));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_equation_separate]", Boolean.valueOf(var2.GL_EXT_blend_equation_separate));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_func_separate]", Boolean.valueOf(var2.GL_EXT_blend_func_separate));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_minmax]", Boolean.valueOf(var2.GL_EXT_blend_minmax));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_blend_subtract]", Boolean.valueOf(var2.GL_EXT_blend_subtract));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_draw_instanced]", Boolean.valueOf(var2.GL_EXT_draw_instanced));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_multisample]", Boolean.valueOf(var2.GL_EXT_framebuffer_multisample));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_object]", Boolean.valueOf(var2.GL_EXT_framebuffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_framebuffer_sRGB]", Boolean.valueOf(var2.GL_EXT_framebuffer_sRGB));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_geometry_shader4]", Boolean.valueOf(var2.GL_EXT_geometry_shader4));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_gpu_program_parameters]", Boolean.valueOf(var2.GL_EXT_gpu_program_parameters));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_gpu_shader4]", Boolean.valueOf(var2.GL_EXT_gpu_shader4));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_multi_draw_arrays]", Boolean.valueOf(var2.GL_EXT_multi_draw_arrays));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_packed_depth_stencil]", Boolean.valueOf(var2.GL_EXT_packed_depth_stencil));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_paletted_texture]", Boolean.valueOf(var2.GL_EXT_paletted_texture));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_rescale_normal]", Boolean.valueOf(var2.GL_EXT_rescale_normal));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_separate_shader_objects]", Boolean.valueOf(var2.GL_EXT_separate_shader_objects));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_shader_image_load_store]", Boolean.valueOf(var2.GL_EXT_shader_image_load_store));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_shadow_funcs]", Boolean.valueOf(var2.GL_EXT_shadow_funcs));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_shared_texture_palette]", Boolean.valueOf(var2.GL_EXT_shared_texture_palette));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_clear_tag]", Boolean.valueOf(var2.GL_EXT_stencil_clear_tag));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_two_side]", Boolean.valueOf(var2.GL_EXT_stencil_two_side));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_stencil_wrap]", Boolean.valueOf(var2.GL_EXT_stencil_wrap));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_3d]", Boolean.valueOf(var2.GL_EXT_texture_3d));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_array]", Boolean.valueOf(var2.GL_EXT_texture_array));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_buffer_object]", Boolean.valueOf(var2.GL_EXT_texture_buffer_object));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_integer]", Boolean.valueOf(var2.GL_EXT_texture_integer));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_lod_bias]", Boolean.valueOf(var2.GL_EXT_texture_lod_bias));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_texture_sRGB]", Boolean.valueOf(var2.GL_EXT_texture_sRGB));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_vertex_shader]", Boolean.valueOf(var2.GL_EXT_vertex_shader));
+        playerSnooper.addStatToSnooper("gl_caps[EXT_vertex_weighting]", Boolean.valueOf(var2.GL_EXT_vertex_weighting));
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_uniforms]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_UNIFORM_COMPONENTS)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_fragment_uniforms]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_FRAGMENT_UNIFORM_COMPONENTS)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_attribs]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_ATTRIBS)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_vertex_texture_image_units]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_texture_image_units]", Integer.valueOf(GL11.glGetInteger(GL20.GL_MAX_TEXTURE_IMAGE_UNITS)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_caps[gl_max_texture_image_units]", Integer.valueOf(GL11.glGetInteger(35071)));
+        GL11.glGetError();
+        playerSnooper.addStatToSnooper("gl_max_texture_size", Integer.valueOf(getGLMaximumTextureSize()));
+    }
+
+    /**
+     * Used in the usage snooper.
+     */
+    public static int getGLMaximumTextureSize()
+    {
+        for (int var0 = 16384; var0 > 0; var0 >>= 1)
+        {
+            GL11.glTexImage2D(GL11.GL_PROXY_TEXTURE_2D, 0, GL11.GL_RGBA, var0, var0, 0, GL11.GL_RGBA, GL11.GL_UNSIGNED_BYTE, (ByteBuffer)null);
+            int var1 = GL11.glGetTexLevelParameteri(GL11.GL_PROXY_TEXTURE_2D, 0, GL11.GL_TEXTURE_WIDTH);
+
+            if (var1 != 0)
+            {
+                return var0;
+            }
+        }
+
+        return -1;
+    }
+
+    /**
+     * Returns whether snooping is enabled or not.
+     */
+    public boolean isSnooperEnabled()
+    {
+        return this.gameSettings.snooperEnabled;
+    }
+
+    /**
+     * Set the current ServerData instance.
+     */
+    public void setServerData(ServerData serverDataIn)
+    {
+        this.currentServerData = serverDataIn;
+    }
+
+    public ServerData getCurrentServerData()
+    {
+        return this.currentServerData;
+    }
+
+    public boolean isIntegratedServerRunning()
+    {
+        return this.integratedServerIsRunning;
+    }
+
+    /**
+     * Returns true if there is only one player playing, and the current server is the integrated one.
+     */
+    public boolean isSingleplayer()
+    {
+        return this.integratedServerIsRunning && this.theIntegratedServer != null;
+    }
+
+    /**
+     * Returns the currently running integrated server
+     */
+    public IntegratedServer getIntegratedServer()
+    {
+        return this.theIntegratedServer;
+    }
+
+    public static void stopIntegratedServer()
+    {
+        if (theMinecraft != null)
+        {
+            IntegratedServer var0 = theMinecraft.getIntegratedServer();
+
+            if (var0 != null)
+            {
+                var0.stopServer();
+            }
+        }
+    }
+
+    /**
+     * Returns the PlayerUsageSnooper instance.
+     */
+    public PlayerUsageSnooper getPlayerUsageSnooper()
+    {
+        return this.usageSnooper;
+    }
+
+    /**
+     * Gets the system time in milliseconds.
+     */
+    public static long getSystemTime()
+    {
+        return Sys.getTime() * 1000L / Sys.getTimerResolution();
+    }
+
+    /**
+     * Returns whether we're in full screen or not.
+     */
+    public boolean isFullScreen()
+    {
+        return this.fullscreen;
+    }
+
+    public Session getSession()
+    {
+        return this.session;
+    }
+
+    public PropertyMap func_180509_L()
+    {
+        return this.twitchDetails;
+    }
+
+    public Proxy getProxy()
+    {
+        return this.proxy;
+    }
+
+    public TextureManager getTextureManager()
+    {
+        return this.renderEngine;
+    }
+
+    public IResourceManager getResourceManager()
+    {
+        return this.mcResourceManager;
+    }
+
+    public ResourcePackRepository getResourcePackRepository()
+    {
+        return this.mcResourcePackRepository;
+    }
+
+    public LanguageManager getLanguageManager()
+    {
+        return this.mcLanguageManager;
+    }
+
+    public TextureMap getTextureMapBlocks()
+    {
+        return this.textureMapBlocks;
+    }
+
+    public boolean isJava64bit()
+    {
+        return this.jvm64bit;
+    }
+
+    public boolean isGamePaused()
+    {
+        return this.isGamePaused;
+    }
+
+    public SoundHandler getSoundHandler()
+    {
+        return this.mcSoundHandler;
+    }
+
+    public MusicTicker.MusicType getAmbientMusicType()
+    {
+        return this.currentScreen instanceof GuiWinGame ? MusicTicker.MusicType.CREDITS : (this.thePlayer != null ? (this.thePlayer.worldObj.provider instanceof WorldProviderHell ? MusicTicker.MusicType.NETHER : (this.thePlayer.worldObj.provider instanceof WorldProviderEnd ? (BossStatus.bossName != null && BossStatus.statusBarTime > 0 ? MusicTicker.MusicType.END_BOSS : MusicTicker.MusicType.END) : (this.thePlayer.capabilities.isCreativeMode && this.thePlayer.capabilities.allowFlying ? MusicTicker.MusicType.CREATIVE : MusicTicker.MusicType.GAME))) : MusicTicker.MusicType.MENU);
+    }
+
+    public IStream getTwitchStream()
+    {
+        return this.stream;
+    }
+
+    public void dispatchKeypresses()
+    {
+        int var1 = Keyboard.getEventKey() == 0 ? Keyboard.getEventCharacter() : Keyboard.getEventKey();
+
+        if (var1 != 0 && !Keyboard.isRepeatEvent())
+        {
+            if (!(this.currentScreen instanceof GuiControls) || ((GuiControls)this.currentScreen).time <= getSystemTime() - 20L)
+            {
+                if (Keyboard.getEventKeyState())
+                {
+                    if (var1 == this.gameSettings.keyBindStreamStartStop.getKeyCode())
+                    {
+                        if (this.getTwitchStream().func_152934_n())
+                        {
+                            this.getTwitchStream().func_152914_u();
+                        }
+                        else if (this.getTwitchStream().func_152924_m())
+                        {
+                            this.displayGuiScreen(new GuiYesNo(new GuiYesNoCallback()
+                            {
+                                private static final String __OBFID = "CL_00001852";
+                                public void confirmClicked(boolean result, int id)
+                                {
+                                    if (result)
+                                    {
+                                        Minecraft.this.getTwitchStream().func_152930_t();
+                                    }
+
+                                    Minecraft.this.displayGuiScreen((GuiScreen)null);
+                                }
+                            }, I18n.format("stream.confirm_start", new Object[0]), "", 0));
+                        }
+                        else if (this.getTwitchStream().func_152928_D() && this.getTwitchStream().func_152936_l())
+                        {
+                            if (this.theWorld != null)
+                            {
+                                this.ingameGUI.getChatGUI().printChatMessage(new ChatComponentText("Not ready to start streaming yet!"));
+                            }
+                        }
+                        else
+                        {
+                            GuiStreamUnavailable.func_152321_a(this.currentScreen);
+                        }
+                    }
+                    else if (var1 == this.gameSettings.keyBindStreamPauseUnpause.getKeyCode())
+                    {
+                        if (this.getTwitchStream().func_152934_n())
+                        {
+                            if (this.getTwitchStream().isPaused())
+                            {
+                                this.getTwitchStream().func_152933_r();
+                            }
+                            else
+                            {
+                                this.getTwitchStream().func_152916_q();
+                            }
+                        }
+                    }
+                    else if (var1 == this.gameSettings.keyBindStreamCommercials.getKeyCode())
+                    {
+                        if (this.getTwitchStream().func_152934_n())
+                        {
+                            this.getTwitchStream().func_152931_p();
+                        }
+                    }
+                    else if (var1 == this.gameSettings.keyBindStreamToggleMic.getKeyCode())
+                    {
+                        this.stream.func_152910_a(true);
+                    }
+                    else if (var1 == this.gameSettings.keyBindFullscreen.getKeyCode())
+                    {
+                        this.toggleFullscreen();
+                    }
+                    else if (var1 == this.gameSettings.keyBindScreenshot.getKeyCode())
+                    {
+                        this.ingameGUI.getChatGUI().printChatMessage(ScreenShotHelper.saveScreenshot(this.mcDataDir, this.displayWidth, this.displayHeight, this.framebufferMc));
+                    }
+                }
+                else if (var1 == this.gameSettings.keyBindStreamToggleMic.getKeyCode())
+                {
+                    this.stream.func_152910_a(false);
+                }
+            }
+        }
+    }
+
+    public MinecraftSessionService getSessionService()
+    {
+        return this.sessionService;
+    }
+
+    public SkinManager getSkinManager()
+    {
+        return this.skinManager;
+    }
+
+    public Entity func_175606_aa()
+    {
+        return this.field_175622_Z;
+    }
+
+    public void func_175607_a(Entity p_175607_1_)
+    {
+        this.field_175622_Z = p_175607_1_;
+        this.entityRenderer.func_175066_a(p_175607_1_);
+    }
+
+    public ListenableFuture addScheduledTask(Callable callableToSchedule)
+    {
+        Validate.notNull(callableToSchedule);
+
+        if (!this.isCallingFromMinecraftThread())
+        {
+            ListenableFutureTask var2 = ListenableFutureTask.create(callableToSchedule);
+            Queue var3 = this.scheduledTasks;
+
+            synchronized (this.scheduledTasks)
+            {
+                this.scheduledTasks.add(var2);
+                return var2;
+            }
+        }
+        else
+        {
+            try
+            {
+                return Futures.immediateFuture(callableToSchedule.call());
+            }
+            catch (Exception var6)
+            {
+                return Futures.immediateFailedCheckedFuture(var6);
+            }
+        }
+    }
+
+    public ListenableFuture addScheduledTask(Runnable runnableToSchedule)
+    {
+        Validate.notNull(runnableToSchedule);
+        return this.addScheduledTask(Executors.callable(runnableToSchedule));
+    }
+
+    public boolean isCallingFromMinecraftThread()
+    {
+        return Thread.currentThread() == this.mcThread;
+    }
+
+    public BlockRendererDispatcher getBlockRendererDispatcher()
+    {
+        return this.field_175618_aM;
+    }
+
+    public RenderManager getRenderManager()
+    {
+        return this.renderManager;
+    }
+
+    public RenderItem getRenderItem()
+    {
+        return this.renderItem;
+    }
+
+    public ItemRenderer getItemRenderer()
+    {
+        return this.itemRenderer;
+    }
+
+    public static int func_175610_ah()
+    {
+        return debugFPS;
+    }
+
+    public static Map func_175596_ai()
+    {
+        HashMap var0 = Maps.newHashMap();
+        var0.put("X-Minecraft-Username", getMinecraft().getSession().getUsername());
+        var0.put("X-Minecraft-UUID", getMinecraft().getSession().getPlayerID());
+        var0.put("X-Minecraft-Version", "1.8");
+        return var0;
+    }
+
+    static final class SwitchEnumMinecartType
+    {
+        static final int[] field_152390_a;
+
+        static final int[] field_178901_b = new int[EntityMinecart.EnumMinecartType.values().length];
+        private static final String __OBFID = "CL_00001959";
+
+        static
+        {
+            try
+            {
+                field_178901_b[EntityMinecart.EnumMinecartType.FURNACE.ordinal()] = 1;
+            }
+            catch (NoSuchFieldError var8)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178901_b[EntityMinecart.EnumMinecartType.CHEST.ordinal()] = 2;
+            }
+            catch (NoSuchFieldError var7)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178901_b[EntityMinecart.EnumMinecartType.TNT.ordinal()] = 3;
+            }
+            catch (NoSuchFieldError var6)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178901_b[EntityMinecart.EnumMinecartType.HOPPER.ordinal()] = 4;
+            }
+            catch (NoSuchFieldError var5)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178901_b[EntityMinecart.EnumMinecartType.COMMAND_BLOCK.ordinal()] = 5;
+            }
+            catch (NoSuchFieldError var4)
+            {
+                ;
+            }
+
+            field_152390_a = new int[MovingObjectPosition.MovingObjectType.values().length];
+
+            try
+            {
+                field_152390_a[MovingObjectPosition.MovingObjectType.ENTITY.ordinal()] = 1;
+            }
+            catch (NoSuchFieldError var3)
+            {
+                ;
+            }
+
+            try
+            {
+                field_152390_a[MovingObjectPosition.MovingObjectType.BLOCK.ordinal()] = 2;
+            }
+            catch (NoSuchFieldError var2)
+            {
+                ;
+            }
+
+            try
+            {
+                field_152390_a[MovingObjectPosition.MovingObjectType.MISS.ordinal()] = 3;
+            }
+            catch (NoSuchFieldError var1)
+            {
+                ;
+            }
+        }
+    }
+
+    //TODO: Client
+	public JFrame getFrame()
+	{
+		return frame;
+	}
+}
diff --git a/src/net/minecraft/client/audio/SoundManager.java b/src/net/minecraft/client/audio/SoundManager.java
index 9397e9d..4bd9472 100644
--- a/src/net/minecraft/client/audio/SoundManager.java
+++ b/src/net/minecraft/client/audio/SoundManager.java
@@ -1,591 +1,597 @@
-package net.minecraft.client.audio;
-
-import com.google.common.collect.BiMap;
-import com.google.common.collect.HashBiMap;
-import com.google.common.collect.HashMultimap;
-import com.google.common.collect.Lists;
-import com.google.common.collect.Maps;
-import com.google.common.collect.Multimap;
-import io.netty.util.internal.ThreadLocalRandom;
-import java.io.IOException;
-import java.io.InputStream;
-import java.net.MalformedURLException;
-import java.net.URL;
-import java.net.URLConnection;
-import java.net.URLStreamHandler;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Map.Entry;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.settings.GameSettings;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.ResourceLocation;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.apache.logging.log4j.Marker;
-import org.apache.logging.log4j.MarkerManager;
-import paulscode.sound.SoundSystem;
-import paulscode.sound.SoundSystemConfig;
-import paulscode.sound.SoundSystemException;
-import paulscode.sound.SoundSystemLogger;
-import paulscode.sound.Source;
-import paulscode.sound.codecs.CodecJOrbis;
-import paulscode.sound.libraries.LibraryLWJGLOpenAL;
-
-public class SoundManager
-{
-    /** The marker used for logging */
-    private static final Marker LOG_MARKER = MarkerManager.getMarker("SOUNDS");
-    private static final Logger logger = LogManager.getLogger();
-
-    /** A reference to the sound handler. */
-    private final SoundHandler sndHandler;
-
-    /** Reference to the GameSettings object. */
-    private final GameSettings options;
-
-    /** A reference to the sound system. */
-    private SoundManager.SoundSystemStarterThread sndSystem;
-
-    /** Set to true when the SoundManager has been initialised. */
-    private boolean loaded;
-
-    /** A counter for how long the sound manager has been running */
-    private int playTime = 0;
-
-    /**
-     * Identifiers of all currently playing sounds. Type: HashBiMap<String, ISound>
-     */
-    private final Map playingSounds = HashBiMap.create();
-
-    /**
-     * Inverse map of currently playing sounds, automatically mirroring changes in original map
-     */
-    private final Map invPlayingSounds;
-
-    /** A HashMap<String, SoundPoolEntry> of the playing sounds. */
-    private Map playingSoundPoolEntries;
-
-    /**
-     * Contains sounds mapped by category. Type: Multimap<SoundCategory, String>
-     */
-    private final Multimap categorySounds;
-
-    /** A subset of playingSounds, this contains only ITickableSounds */
-    private final List tickableSounds;
-
-    /** Contains sounds to play in n ticks.  Type: HashMap<ISound, Integer> */
-    private final Map delayedSounds;
-
-    /**
-     * The future time in which to stop this sound.  Type: HashMap<String, Integer>
-     */
-    private final Map playingSoundsStopTime;
-    private static final String __OBFID = "CL_00001141";
-
-    public SoundManager(SoundHandler p_i45119_1_, GameSettings p_i45119_2_)
-    {
-        this.invPlayingSounds = ((BiMap)this.playingSounds).inverse();
-        this.playingSoundPoolEntries = Maps.newHashMap();
-        this.categorySounds = HashMultimap.create();
-        this.tickableSounds = Lists.newArrayList();
-        this.delayedSounds = Maps.newHashMap();
-        this.playingSoundsStopTime = Maps.newHashMap();
-        this.sndHandler = p_i45119_1_;
-        this.options = p_i45119_2_;
-
-        try
-        {
-            SoundSystemConfig.addLibrary(LibraryLWJGLOpenAL.class);
-            SoundSystemConfig.setCodec("ogg", CodecJOrbis.class);
-        }
-        catch (SoundSystemException var4)
-        {
-            logger.error(LOG_MARKER, "Error linking with the LibraryJavaSound plug-in", var4);
-        }
-    }
-
-    public void reloadSoundSystem()
-    {
-        this.unloadSoundSystem();
-        this.loadSoundSystem();
-    }
-
-    /**
-     * Tries to add the paulscode library and the relevant codecs. If it fails, the master volume  will be set to zero.
-     */
-    private synchronized void loadSoundSystem()
-    {
-        if (!this.loaded)
-        {
-            try
-            {
-                (new Thread(new Runnable()
-                {
-                    private static final String __OBFID = "CL_00001142";
-                    public void run()
-                    {
-                        SoundSystemConfig.setLogger(new SoundSystemLogger()
-                        {
-                            private static final String __OBFID = "CL_00002378";
-                            public void message(String p_message_1_, int p_message_2_)
-                            {
-                                if (!p_message_1_.isEmpty())
-                                {
-                                    SoundManager.logger.info(p_message_1_);
-                                }
-                            }
-                            public void importantMessage(String p_importantMessage_1_, int p_importantMessage_2_)
-                            {
-                                if (!p_importantMessage_1_.isEmpty())
-                                {
-                                    SoundManager.logger.warn(p_importantMessage_1_);
-                                }
-                            }
-                            public void errorMessage(String p_errorMessage_1_, String p_errorMessage_2_, int p_errorMessage_3_)
-                            {
-                                if (!p_errorMessage_2_.isEmpty())
-                                {
-                                    SoundManager.logger.error("Error in class \'" + p_errorMessage_1_ + "\'");
-                                    SoundManager.logger.error(p_errorMessage_2_);
-                                }
-                            }
-                        });
-                        SoundManager.this.sndSystem = SoundManager.this.new SoundSystemStarterThread(null);
-                        SoundManager.this.loaded = true;
-                        SoundManager.this.sndSystem.setMasterVolume(SoundManager.this.options.getSoundLevel(SoundCategory.MASTER));
-                        SoundManager.logger.info(SoundManager.LOG_MARKER, "Sound engine started");
-                    }
-                }, "Sound Library Loader")).start();
-            }
-            catch (RuntimeException var2)
-            {
-                logger.error(LOG_MARKER, "Error starting SoundSystem. Turning off sounds & music", var2);
-                this.options.setSoundLevel(SoundCategory.MASTER, 0.0F);
-                this.options.saveOptions();
-            }
-        }
-    }
-
-    /**
-     * Returns the sound level (between 0.0 and 1.0) for a category, but 1.0 for the master sound category
-     */
-    private float getSoundCategoryVolume(SoundCategory p_148595_1_)
-    {
-        return p_148595_1_ != null && p_148595_1_ != SoundCategory.MASTER ? this.options.getSoundLevel(p_148595_1_) : 1.0F;
-    }
-
-    /**
-     * Adjusts volume for currently playing sounds in this category
-     */
-    public void setSoundCategoryVolume(SoundCategory p_148601_1_, float p_148601_2_)
-    {
-        if (this.loaded)
-        {
-            if (p_148601_1_ == SoundCategory.MASTER)
-            {
-                this.sndSystem.setMasterVolume(p_148601_2_);
-            }
-            else
-            {
-                Iterator var3 = this.categorySounds.get(p_148601_1_).iterator();
-
-                while (var3.hasNext())
-                {
-                    String var4 = (String)var3.next();
-                    ISound var5 = (ISound)this.playingSounds.get(var4);
-                    float var6 = this.getNormalizedVolume(var5, (SoundPoolEntry)this.playingSoundPoolEntries.get(var5), p_148601_1_);
-
-                    if (var6 <= 0.0F)
-                    {
-                        this.stopSound(var5);
-                    }
-                    else
-                    {
-                        this.sndSystem.setVolume(var4, var6);
-                    }
-                }
-            }
-        }
-    }
-
-    /**
-     * Cleans up the Sound System
-     */
-    public void unloadSoundSystem()
-    {
-        if (this.loaded)
-        {
-            this.stopAllSounds();
-            this.sndSystem.cleanup();
-            this.loaded = false;
-        }
-    }
-
-    /**
-     * Stops all currently playing sounds
-     */
-    public void stopAllSounds()
-    {
-        if (this.loaded)
-        {
-            Iterator var1 = this.playingSounds.keySet().iterator();
-
-            while (var1.hasNext())
-            {
-                String var2 = (String)var1.next();
-                this.sndSystem.stop(var2);
-            }
-
-            this.playingSounds.clear();
-            this.delayedSounds.clear();
-            this.tickableSounds.clear();
-            this.categorySounds.clear();
-            this.playingSoundPoolEntries.clear();
-            this.playingSoundsStopTime.clear();
-        }
-    }
-
-    public void updateAllSounds()
-    {
-        ++this.playTime;
-        Iterator var1 = this.tickableSounds.iterator();
-        String var3;
-
-        while (var1.hasNext())
-        {
-            ITickableSound var2 = (ITickableSound)var1.next();
-            var2.update();
-
-            if (var2.isDonePlaying())
-            {
-                this.stopSound(var2);
-            }
-            else
-            {
-                var3 = (String)this.invPlayingSounds.get(var2);
-                this.sndSystem.setVolume(var3, this.getNormalizedVolume(var2, (SoundPoolEntry)this.playingSoundPoolEntries.get(var2), this.sndHandler.getSound(var2.getSoundLocation()).getSoundCategory()));
-                this.sndSystem.setPitch(var3, this.getNormalizedPitch(var2, (SoundPoolEntry)this.playingSoundPoolEntries.get(var2)));
-                this.sndSystem.setPosition(var3, var2.getXPosF(), var2.getYPosF(), var2.getZPosF());
-            }
-        }
-
-        var1 = this.playingSounds.entrySet().iterator();
-        ISound var4;
-
-        while (var1.hasNext())
-        {
-            Entry var9 = (Entry)var1.next();
-            var3 = (String)var9.getKey();
-            var4 = (ISound)var9.getValue();
-
-            if (!this.sndSystem.playing(var3))
-            {
-                int var5 = ((Integer)this.playingSoundsStopTime.get(var3)).intValue();
-
-                if (var5 <= this.playTime)
-                {
-                    int var6 = var4.getRepeatDelay();
-
-                    if (var4.canRepeat() && var6 > 0)
-                    {
-                        this.delayedSounds.put(var4, Integer.valueOf(this.playTime + var6));
-                    }
-
-                    var1.remove();
-                    logger.debug(LOG_MARKER, "Removed channel {} because it\'s not playing anymore", new Object[] {var3});
-                    this.sndSystem.removeSource(var3);
-                    this.playingSoundsStopTime.remove(var3);
-                    this.playingSoundPoolEntries.remove(var4);
-
-                    try
-                    {
-                        this.categorySounds.remove(this.sndHandler.getSound(var4.getSoundLocation()).getSoundCategory(), var3);
-                    }
-                    catch (RuntimeException var8)
-                    {
-                        ;
-                    }
-
-                    if (var4 instanceof ITickableSound)
-                    {
-                        this.tickableSounds.remove(var4);
-                    }
-                }
-            }
-        }
-
-        Iterator var10 = this.delayedSounds.entrySet().iterator();
-
-        while (var10.hasNext())
-        {
-            Entry var11 = (Entry)var10.next();
-
-            if (this.playTime >= ((Integer)var11.getValue()).intValue())
-            {
-                var4 = (ISound)var11.getKey();
-
-                if (var4 instanceof ITickableSound)
-                {
-                    ((ITickableSound)var4).update();
-                }
-
-                this.playSound(var4);
-                var10.remove();
-            }
-        }
-    }
-
-    /**
-     * Returns true if the sound is playing or still within time
-     */
-    public boolean isSoundPlaying(ISound p_148597_1_)
-    {
-        if (!this.loaded)
-        {
-            return false;
-        }
-        else
-        {
-            String var2 = (String)this.invPlayingSounds.get(p_148597_1_);
-            return var2 == null ? false : this.sndSystem.playing(var2) || this.playingSoundsStopTime.containsKey(var2) && ((Integer)this.playingSoundsStopTime.get(var2)).intValue() <= this.playTime;
-        }
-    }
-
-    public void stopSound(ISound p_148602_1_)
-    {
-        if (this.loaded)
-        {
-            String var2 = (String)this.invPlayingSounds.get(p_148602_1_);
-
-            if (var2 != null)
-            {
-                this.sndSystem.stop(var2);
-            }
-        }
-    }
-
-    public void playSound(ISound p_148611_1_)
-    {
-        if (this.loaded)
-        {
-            if (this.sndSystem.getMasterVolume() <= 0.0F)
-            {
-                logger.debug(LOG_MARKER, "Skipped playing soundEvent: {}, master volume was zero", new Object[] {p_148611_1_.getSoundLocation()});
-            }
-            else
-            {
-                SoundEventAccessorComposite var2 = this.sndHandler.getSound(p_148611_1_.getSoundLocation());
-
-                if (var2 == null)
-                {
-                    logger.warn(LOG_MARKER, "Unable to play unknown soundEvent: {}", new Object[] {p_148611_1_.getSoundLocation()});
-                }
-                else
-                {
-                    SoundPoolEntry var3 = var2.cloneEntry();
-
-                    if (var3 == SoundHandler.missing_sound)
-                    {
-                        logger.warn(LOG_MARKER, "Unable to play empty soundEvent: {}", new Object[] {var2.getSoundEventLocation()});
-                    }
-                    else
-                    {
-                        float var4 = p_148611_1_.getVolume();
-                        float var5 = 16.0F;
-
-                        if (var4 > 1.0F)
-                        {
-                            var5 *= var4;
-                        }
-
-                        SoundCategory var6 = var2.getSoundCategory();
-                        float var7 = this.getNormalizedVolume(p_148611_1_, var3, var6);
-                        double var8 = (double)this.getNormalizedPitch(p_148611_1_, var3);
-                        ResourceLocation var10 = var3.getSoundPoolEntryLocation();
-
-                        if (var7 == 0.0F)
-                        {
-                            logger.debug(LOG_MARKER, "Skipped playing sound {}, volume was zero.", new Object[] {var10});
-                        }
-                        else
-                        {
-                            boolean var11 = p_148611_1_.canRepeat() && p_148611_1_.getRepeatDelay() == 0;
-                            String var12 = MathHelper.func_180182_a(ThreadLocalRandom.current()).toString();
-
-                            if (var3.isStreamingSound())
-                            {
-                                this.sndSystem.newStreamingSource(false, var12, getURLForSoundResource(var10), var10.toString(), var11, p_148611_1_.getXPosF(), p_148611_1_.getYPosF(), p_148611_1_.getZPosF(), p_148611_1_.getAttenuationType().getTypeInt(), var5);
-                            }
-                            else
-                            {
-                                this.sndSystem.newSource(false, var12, getURLForSoundResource(var10), var10.toString(), var11, p_148611_1_.getXPosF(), p_148611_1_.getYPosF(), p_148611_1_.getZPosF(), p_148611_1_.getAttenuationType().getTypeInt(), var5);
-                            }
-
-                            logger.debug(LOG_MARKER, "Playing sound {} for event {} as channel {}", new Object[] {var3.getSoundPoolEntryLocation(), var2.getSoundEventLocation(), var12});
-                            this.sndSystem.setPitch(var12, (float)var8);
-                            this.sndSystem.setVolume(var12, var7);
-                            this.sndSystem.play(var12);
-                            this.playingSoundsStopTime.put(var12, Integer.valueOf(this.playTime + 20));
-                            this.playingSounds.put(var12, p_148611_1_);
-                            this.playingSoundPoolEntries.put(p_148611_1_, var3);
-
-                            if (var6 != SoundCategory.MASTER)
-                            {
-                                this.categorySounds.put(var6, var12);
-                            }
-
-                            if (p_148611_1_ instanceof ITickableSound)
-                            {
-                                this.tickableSounds.add((ITickableSound)p_148611_1_);
-                            }
-                        }
-                    }
-                }
-            }
-        }
-    }
-
-    /**
-     * Normalizes pitch from parameters and clamps to [0.5, 2.0]
-     */
-    private float getNormalizedPitch(ISound p_148606_1_, SoundPoolEntry p_148606_2_)
-    {
-        return (float)MathHelper.clamp_double((double)p_148606_1_.getPitch() * p_148606_2_.getPitch(), 0.5D, 2.0D);
-    }
-
-    /**
-     * Normalizes volume level from parameters.  Range [0.0, 1.0]
-     */
-    private float getNormalizedVolume(ISound p_148594_1_, SoundPoolEntry p_148594_2_, SoundCategory p_148594_3_)
-    {
-        return (float)MathHelper.clamp_double((double)p_148594_1_.getVolume() * p_148594_2_.getVolume(), 0.0D, 1.0D) * this.getSoundCategoryVolume(p_148594_3_);
-    }
-
-    /**
-     * Pauses all currently playing sounds
-     */
-    public void pauseAllSounds()
-    {
-        Iterator var1 = this.playingSounds.keySet().iterator();
-
-        while (var1.hasNext())
-        {
-            String var2 = (String)var1.next();
-            logger.debug(LOG_MARKER, "Pausing channel {}", new Object[] {var2});
-            this.sndSystem.pause(var2);
-        }
-    }
-
-    /**
-     * Resumes playing all currently playing sounds (after pauseAllSounds)
-     */
-    public void resumeAllSounds()
-    {
-        Iterator var1 = this.playingSounds.keySet().iterator();
-
-        while (var1.hasNext())
-        {
-            String var2 = (String)var1.next();
-            logger.debug(LOG_MARKER, "Resuming channel {}", new Object[] {var2});
-            this.sndSystem.play(var2);
-        }
-    }
-
-    /**
-     * Adds a sound to play in n tick
-     */
-    public void playDelayedSound(ISound p_148599_1_, int p_148599_2_)
-    {
-        this.delayedSounds.put(p_148599_1_, Integer.valueOf(this.playTime + p_148599_2_));
-    }
-
-    private static URL getURLForSoundResource(final ResourceLocation p_148612_0_)
-    {
-        String var1 = String.format("%s:%s:%s", new Object[] {"mcsounddomain", p_148612_0_.getResourceDomain(), p_148612_0_.getResourcePath()});
-        URLStreamHandler var2 = new URLStreamHandler()
-        {
-            private static final String __OBFID = "CL_00001143";
-            protected URLConnection openConnection(final URL p_openConnection_1_)
-            {
-                return new URLConnection(p_openConnection_1_)
-                {
-                    private static final String __OBFID = "CL_00001144";
-                    public void connect() {}
-                    public InputStream getInputStream() throws IOException
-                    {
-                        return Minecraft.getMinecraft().getResourceManager().getResource(p_148612_0_).getInputStream();
-                    }
-                };
-            }
-        };
-
-        try
-        {
-            return new URL((URL)null, var1, var2);
-        }
-        catch (MalformedURLException var4)
-        {
-            throw new Error("TODO: Sanely handle url exception! :D");
-        }
-    }
-
-    /**
-     * Sets the listener of sounds
-     */
-    public void setListener(EntityPlayer p_148615_1_, float p_148615_2_)
-    {
-        if (this.loaded && p_148615_1_ != null)
-        {
-            float var3 = p_148615_1_.prevRotationPitch + (p_148615_1_.rotationPitch - p_148615_1_.prevRotationPitch) * p_148615_2_;
-            float var4 = p_148615_1_.prevRotationYaw + (p_148615_1_.rotationYaw - p_148615_1_.prevRotationYaw) * p_148615_2_;
-            double var5 = p_148615_1_.prevPosX + (p_148615_1_.posX - p_148615_1_.prevPosX) * (double)p_148615_2_;
-            double var7 = p_148615_1_.prevPosY + (p_148615_1_.posY - p_148615_1_.prevPosY) * (double)p_148615_2_ + (double)p_148615_1_.getEyeHeight();
-            double var9 = p_148615_1_.prevPosZ + (p_148615_1_.posZ - p_148615_1_.prevPosZ) * (double)p_148615_2_;
-            float var11 = MathHelper.cos((var4 + 90.0F) * 0.017453292F);
-            float var12 = MathHelper.sin((var4 + 90.0F) * 0.017453292F);
-            float var13 = MathHelper.cos(-var3 * 0.017453292F);
-            float var14 = MathHelper.sin(-var3 * 0.017453292F);
-            float var15 = MathHelper.cos((-var3 + 90.0F) * 0.017453292F);
-            float var16 = MathHelper.sin((-var3 + 90.0F) * 0.017453292F);
-            float var17 = var11 * var13;
-            float var19 = var12 * var13;
-            float var20 = var11 * var15;
-            float var22 = var12 * var15;
-            this.sndSystem.setListenerPosition((float)var5, (float)var7, (float)var9);
-            this.sndSystem.setListenerOrientation(var17, var14, var19, var20, var16, var22);
-        }
-    }
-
-    class SoundSystemStarterThread extends SoundSystem
-    {
-        private static final String __OBFID = "CL_00001145";
-
-        private SoundSystemStarterThread() {}
-
-        public boolean playing(String p_playing_1_)
-        {
-            Object var2 = SoundSystemConfig.THREAD_SYNC;
-
-            synchronized (SoundSystemConfig.THREAD_SYNC)
-            {
-                if (this.soundLibrary == null)
-                {
-                    return false;
-                }
-                else
-                {
-                    Source var3 = (Source)this.soundLibrary.getSources().get(p_playing_1_);
-                    return var3 == null ? false : var3.playing() || var3.paused() || var3.preLoad;
-                }
-            }
-        }
-
-        SoundSystemStarterThread(Object p_i45118_2_)
-        {
-            this();
-        }
-    }
-}
+package net.minecraft.client.audio;
+
+import com.google.common.collect.BiMap;
+import com.google.common.collect.HashBiMap;
+import com.google.common.collect.HashMultimap;
+import com.google.common.collect.Lists;
+import com.google.common.collect.Maps;
+import com.google.common.collect.Multimap;
+
+import io.netty.util.internal.ThreadLocalRandom;
+
+import java.io.IOException;
+import java.io.InputStream;
+import java.net.MalformedURLException;
+import java.net.URL;
+import java.net.URLConnection;
+import java.net.URLStreamHandler;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.Map.Entry;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.settings.GameSettings;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.ResourceLocation;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.apache.logging.log4j.Marker;
+import org.apache.logging.log4j.MarkerManager;
+
+import paulscode.sound.SoundSystem;
+import paulscode.sound.SoundSystemConfig;
+import paulscode.sound.SoundSystemException;
+import paulscode.sound.SoundSystemLogger;
+import paulscode.sound.Source;
+import paulscode.sound.codecs.CodecJOrbis;
+import paulscode.sound.libraries.LibraryLWJGLOpenAL;
+import tk.wurst_client.bot.WurstBot;
+
+public class SoundManager
+{
+    /** The marker used for logging */
+    private static final Marker LOG_MARKER = MarkerManager.getMarker("SOUNDS");
+    private static final Logger logger = LogManager.getLogger();
+
+    /** A reference to the sound handler. */
+    private final SoundHandler sndHandler;
+
+    /** Reference to the GameSettings object. */
+    private final GameSettings options;
+
+    /** A reference to the sound system. */
+    private SoundManager.SoundSystemStarterThread sndSystem;
+
+    /** Set to true when the SoundManager has been initialised. */
+    private boolean loaded;
+
+    /** A counter for how long the sound manager has been running */
+    private int playTime = 0;
+
+    /**
+     * Identifiers of all currently playing sounds. Type: HashBiMap<String, ISound>
+     */
+    private final Map playingSounds = HashBiMap.create();
+
+    /**
+     * Inverse map of currently playing sounds, automatically mirroring changes in original map
+     */
+    private final Map invPlayingSounds;
+
+    /** A HashMap<String, SoundPoolEntry> of the playing sounds. */
+    private Map playingSoundPoolEntries;
+
+    /**
+     * Contains sounds mapped by category. Type: Multimap<SoundCategory, String>
+     */
+    private final Multimap categorySounds;
+
+    /** A subset of playingSounds, this contains only ITickableSounds */
+    private final List tickableSounds;
+
+    /** Contains sounds to play in n ticks.  Type: HashMap<ISound, Integer> */
+    private final Map delayedSounds;
+
+    /**
+     * The future time in which to stop this sound.  Type: HashMap<String, Integer>
+     */
+    private final Map playingSoundsStopTime;
+    private static final String __OBFID = "CL_00001141";
+
+    public SoundManager(SoundHandler p_i45119_1_, GameSettings p_i45119_2_)
+    {
+        this.invPlayingSounds = ((BiMap)this.playingSounds).inverse();
+        this.playingSoundPoolEntries = Maps.newHashMap();
+        this.categorySounds = HashMultimap.create();
+        this.tickableSounds = Lists.newArrayList();
+        this.delayedSounds = Maps.newHashMap();
+        this.playingSoundsStopTime = Maps.newHashMap();
+        this.sndHandler = p_i45119_1_;
+        this.options = p_i45119_2_;
+
+        try
+        {
+            SoundSystemConfig.addLibrary(LibraryLWJGLOpenAL.class);
+            SoundSystemConfig.setCodec("ogg", CodecJOrbis.class);
+        }
+        catch (SoundSystemException var4)
+        {
+            logger.error(LOG_MARKER, "Error linking with the LibraryJavaSound plug-in", var4);
+        }
+    }
+
+    public void reloadSoundSystem()
+    {
+        this.unloadSoundSystem();
+        this.loadSoundSystem();
+    }
+
+    /**
+     * Tries to add the paulscode library and the relevant codecs. If it fails, the master volume  will be set to zero.
+     */
+    private synchronized void loadSoundSystem()
+    {
+        if (!this.loaded && !WurstBot.isEnabled())
+        {
+            try
+            {
+                (new Thread(new Runnable()
+                {
+                    private static final String __OBFID = "CL_00001142";
+                    public void run()
+                    {
+                        SoundSystemConfig.setLogger(new SoundSystemLogger()
+                        {
+                            private static final String __OBFID = "CL_00002378";
+                            public void message(String p_message_1_, int p_message_2_)
+                            {
+                                if (!p_message_1_.isEmpty())
+                                {
+                                    SoundManager.logger.info(p_message_1_);
+                                }
+                            }
+                            public void importantMessage(String p_importantMessage_1_, int p_importantMessage_2_)
+                            {
+                                if (!p_importantMessage_1_.isEmpty())
+                                {
+                                    SoundManager.logger.warn(p_importantMessage_1_);
+                                }
+                            }
+                            public void errorMessage(String p_errorMessage_1_, String p_errorMessage_2_, int p_errorMessage_3_)
+                            {
+                                if (!p_errorMessage_2_.isEmpty())
+                                {
+                                    SoundManager.logger.error("Error in class \'" + p_errorMessage_1_ + "\'");
+                                    SoundManager.logger.error(p_errorMessage_2_);
+                                }
+                            }
+                        });
+                        SoundManager.this.sndSystem = SoundManager.this.new SoundSystemStarterThread(null);
+                        SoundManager.this.loaded = true;
+                        SoundManager.this.sndSystem.setMasterVolume(SoundManager.this.options.getSoundLevel(SoundCategory.MASTER));
+                        SoundManager.logger.info(SoundManager.LOG_MARKER, "Sound engine started");
+                    }
+                }, "Sound Library Loader")).start();
+            }
+            catch (RuntimeException var2)
+            {
+                logger.error(LOG_MARKER, "Error starting SoundSystem. Turning off sounds & music", var2);
+                this.options.setSoundLevel(SoundCategory.MASTER, 0.0F);
+                this.options.saveOptions();
+            }
+        }
+    }
+
+    /**
+     * Returns the sound level (between 0.0 and 1.0) for a category, but 1.0 for the master sound category
+     */
+    private float getSoundCategoryVolume(SoundCategory p_148595_1_)
+    {
+        return p_148595_1_ != null && p_148595_1_ != SoundCategory.MASTER ? this.options.getSoundLevel(p_148595_1_) : 1.0F;
+    }
+
+    /**
+     * Adjusts volume for currently playing sounds in this category
+     */
+    public void setSoundCategoryVolume(SoundCategory p_148601_1_, float p_148601_2_)
+    {
+        if (this.loaded)
+        {
+            if (p_148601_1_ == SoundCategory.MASTER)
+            {
+                this.sndSystem.setMasterVolume(p_148601_2_);
+            }
+            else
+            {
+                Iterator var3 = this.categorySounds.get(p_148601_1_).iterator();
+
+                while (var3.hasNext())
+                {
+                    String var4 = (String)var3.next();
+                    ISound var5 = (ISound)this.playingSounds.get(var4);
+                    float var6 = this.getNormalizedVolume(var5, (SoundPoolEntry)this.playingSoundPoolEntries.get(var5), p_148601_1_);
+
+                    if (var6 <= 0.0F)
+                    {
+                        this.stopSound(var5);
+                    }
+                    else
+                    {
+                        this.sndSystem.setVolume(var4, var6);
+                    }
+                }
+            }
+        }
+    }
+
+    /**
+     * Cleans up the Sound System
+     */
+    public void unloadSoundSystem()
+    {
+        if (this.loaded)
+        {
+            this.stopAllSounds();
+            this.sndSystem.cleanup();
+            this.loaded = false;
+        }
+    }
+
+    /**
+     * Stops all currently playing sounds
+     */
+    public void stopAllSounds()
+    {
+        if (this.loaded)
+        {
+            Iterator var1 = this.playingSounds.keySet().iterator();
+
+            while (var1.hasNext())
+            {
+                String var2 = (String)var1.next();
+                this.sndSystem.stop(var2);
+            }
+
+            this.playingSounds.clear();
+            this.delayedSounds.clear();
+            this.tickableSounds.clear();
+            this.categorySounds.clear();
+            this.playingSoundPoolEntries.clear();
+            this.playingSoundsStopTime.clear();
+        }
+    }
+
+    public void updateAllSounds()
+    {
+        ++this.playTime;
+        Iterator var1 = this.tickableSounds.iterator();
+        String var3;
+
+        while (var1.hasNext())
+        {
+            ITickableSound var2 = (ITickableSound)var1.next();
+            var2.update();
+
+            if (var2.isDonePlaying())
+            {
+                this.stopSound(var2);
+            }
+            else
+            {
+                var3 = (String)this.invPlayingSounds.get(var2);
+                this.sndSystem.setVolume(var3, this.getNormalizedVolume(var2, (SoundPoolEntry)this.playingSoundPoolEntries.get(var2), this.sndHandler.getSound(var2.getSoundLocation()).getSoundCategory()));
+                this.sndSystem.setPitch(var3, this.getNormalizedPitch(var2, (SoundPoolEntry)this.playingSoundPoolEntries.get(var2)));
+                this.sndSystem.setPosition(var3, var2.getXPosF(), var2.getYPosF(), var2.getZPosF());
+            }
+        }
+
+        var1 = this.playingSounds.entrySet().iterator();
+        ISound var4;
+
+        while (var1.hasNext())
+        {
+            Entry var9 = (Entry)var1.next();
+            var3 = (String)var9.getKey();
+            var4 = (ISound)var9.getValue();
+
+            if (!this.sndSystem.playing(var3))
+            {
+                int var5 = ((Integer)this.playingSoundsStopTime.get(var3)).intValue();
+
+                if (var5 <= this.playTime)
+                {
+                    int var6 = var4.getRepeatDelay();
+
+                    if (var4.canRepeat() && var6 > 0)
+                    {
+                        this.delayedSounds.put(var4, Integer.valueOf(this.playTime + var6));
+                    }
+
+                    var1.remove();
+                    logger.debug(LOG_MARKER, "Removed channel {} because it\'s not playing anymore", new Object[] {var3});
+                    this.sndSystem.removeSource(var3);
+                    this.playingSoundsStopTime.remove(var3);
+                    this.playingSoundPoolEntries.remove(var4);
+
+                    try
+                    {
+                        this.categorySounds.remove(this.sndHandler.getSound(var4.getSoundLocation()).getSoundCategory(), var3);
+                    }
+                    catch (RuntimeException var8)
+                    {
+                        ;
+                    }
+
+                    if (var4 instanceof ITickableSound)
+                    {
+                        this.tickableSounds.remove(var4);
+                    }
+                }
+            }
+        }
+
+        Iterator var10 = this.delayedSounds.entrySet().iterator();
+
+        while (var10.hasNext())
+        {
+            Entry var11 = (Entry)var10.next();
+
+            if (this.playTime >= ((Integer)var11.getValue()).intValue())
+            {
+                var4 = (ISound)var11.getKey();
+
+                if (var4 instanceof ITickableSound)
+                {
+                    ((ITickableSound)var4).update();
+                }
+
+                this.playSound(var4);
+                var10.remove();
+            }
+        }
+    }
+
+    /**
+     * Returns true if the sound is playing or still within time
+     */
+    public boolean isSoundPlaying(ISound p_148597_1_)
+    {
+        if (!this.loaded)
+        {
+            return false;
+        }
+        else
+        {
+            String var2 = (String)this.invPlayingSounds.get(p_148597_1_);
+            return var2 == null ? false : this.sndSystem.playing(var2) || this.playingSoundsStopTime.containsKey(var2) && ((Integer)this.playingSoundsStopTime.get(var2)).intValue() <= this.playTime;
+        }
+    }
+
+    public void stopSound(ISound p_148602_1_)
+    {
+        if (this.loaded)
+        {
+            String var2 = (String)this.invPlayingSounds.get(p_148602_1_);
+
+            if (var2 != null)
+            {
+                this.sndSystem.stop(var2);
+            }
+        }
+    }
+
+    public void playSound(ISound p_148611_1_)
+    {
+        if (this.loaded)
+        {
+            if (this.sndSystem.getMasterVolume() <= 0.0F)
+            {
+                logger.debug(LOG_MARKER, "Skipped playing soundEvent: {}, master volume was zero", new Object[] {p_148611_1_.getSoundLocation()});
+            }
+            else
+            {
+                SoundEventAccessorComposite var2 = this.sndHandler.getSound(p_148611_1_.getSoundLocation());
+
+                if (var2 == null)
+                {
+                    logger.warn(LOG_MARKER, "Unable to play unknown soundEvent: {}", new Object[] {p_148611_1_.getSoundLocation()});
+                }
+                else
+                {
+                    SoundPoolEntry var3 = var2.cloneEntry();
+
+                    if (var3 == SoundHandler.missing_sound)
+                    {
+                        logger.warn(LOG_MARKER, "Unable to play empty soundEvent: {}", new Object[] {var2.getSoundEventLocation()});
+                    }
+                    else
+                    {
+                        float var4 = p_148611_1_.getVolume();
+                        float var5 = 16.0F;
+
+                        if (var4 > 1.0F)
+                        {
+                            var5 *= var4;
+                        }
+
+                        SoundCategory var6 = var2.getSoundCategory();
+                        float var7 = this.getNormalizedVolume(p_148611_1_, var3, var6);
+                        double var8 = (double)this.getNormalizedPitch(p_148611_1_, var3);
+                        ResourceLocation var10 = var3.getSoundPoolEntryLocation();
+
+                        if (var7 == 0.0F)
+                        {
+                            logger.debug(LOG_MARKER, "Skipped playing sound {}, volume was zero.", new Object[] {var10});
+                        }
+                        else
+                        {
+                            boolean var11 = p_148611_1_.canRepeat() && p_148611_1_.getRepeatDelay() == 0;
+                            String var12 = MathHelper.func_180182_a(ThreadLocalRandom.current()).toString();
+
+                            if (var3.isStreamingSound())
+                            {
+                                this.sndSystem.newStreamingSource(false, var12, getURLForSoundResource(var10), var10.toString(), var11, p_148611_1_.getXPosF(), p_148611_1_.getYPosF(), p_148611_1_.getZPosF(), p_148611_1_.getAttenuationType().getTypeInt(), var5);
+                            }
+                            else
+                            {
+                                this.sndSystem.newSource(false, var12, getURLForSoundResource(var10), var10.toString(), var11, p_148611_1_.getXPosF(), p_148611_1_.getYPosF(), p_148611_1_.getZPosF(), p_148611_1_.getAttenuationType().getTypeInt(), var5);
+                            }
+
+                            logger.debug(LOG_MARKER, "Playing sound {} for event {} as channel {}", new Object[] {var3.getSoundPoolEntryLocation(), var2.getSoundEventLocation(), var12});
+                            this.sndSystem.setPitch(var12, (float)var8);
+                            this.sndSystem.setVolume(var12, var7);
+                            this.sndSystem.play(var12);
+                            this.playingSoundsStopTime.put(var12, Integer.valueOf(this.playTime + 20));
+                            this.playingSounds.put(var12, p_148611_1_);
+                            this.playingSoundPoolEntries.put(p_148611_1_, var3);
+
+                            if (var6 != SoundCategory.MASTER)
+                            {
+                                this.categorySounds.put(var6, var12);
+                            }
+
+                            if (p_148611_1_ instanceof ITickableSound)
+                            {
+                                this.tickableSounds.add((ITickableSound)p_148611_1_);
+                            }
+                        }
+                    }
+                }
+            }
+        }
+    }
+
+    /**
+     * Normalizes pitch from parameters and clamps to [0.5, 2.0]
+     */
+    private float getNormalizedPitch(ISound p_148606_1_, SoundPoolEntry p_148606_2_)
+    {
+        return (float)MathHelper.clamp_double((double)p_148606_1_.getPitch() * p_148606_2_.getPitch(), 0.5D, 2.0D);
+    }
+
+    /**
+     * Normalizes volume level from parameters.  Range [0.0, 1.0]
+     */
+    private float getNormalizedVolume(ISound p_148594_1_, SoundPoolEntry p_148594_2_, SoundCategory p_148594_3_)
+    {
+        return (float)MathHelper.clamp_double((double)p_148594_1_.getVolume() * p_148594_2_.getVolume(), 0.0D, 1.0D) * this.getSoundCategoryVolume(p_148594_3_);
+    }
+
+    /**
+     * Pauses all currently playing sounds
+     */
+    public void pauseAllSounds()
+    {
+        Iterator var1 = this.playingSounds.keySet().iterator();
+
+        while (var1.hasNext())
+        {
+            String var2 = (String)var1.next();
+            logger.debug(LOG_MARKER, "Pausing channel {}", new Object[] {var2});
+            this.sndSystem.pause(var2);
+        }
+    }
+
+    /**
+     * Resumes playing all currently playing sounds (after pauseAllSounds)
+     */
+    public void resumeAllSounds()
+    {
+        Iterator var1 = this.playingSounds.keySet().iterator();
+
+        while (var1.hasNext())
+        {
+            String var2 = (String)var1.next();
+            logger.debug(LOG_MARKER, "Resuming channel {}", new Object[] {var2});
+            this.sndSystem.play(var2);
+        }
+    }
+
+    /**
+     * Adds a sound to play in n tick
+     */
+    public void playDelayedSound(ISound p_148599_1_, int p_148599_2_)
+    {
+        this.delayedSounds.put(p_148599_1_, Integer.valueOf(this.playTime + p_148599_2_));
+    }
+
+    private static URL getURLForSoundResource(final ResourceLocation p_148612_0_)
+    {
+        String var1 = String.format("%s:%s:%s", new Object[] {"mcsounddomain", p_148612_0_.getResourceDomain(), p_148612_0_.getResourcePath()});
+        URLStreamHandler var2 = new URLStreamHandler()
+        {
+            private static final String __OBFID = "CL_00001143";
+            protected URLConnection openConnection(final URL p_openConnection_1_)
+            {
+                return new URLConnection(p_openConnection_1_)
+                {
+                    private static final String __OBFID = "CL_00001144";
+                    public void connect() {}
+                    public InputStream getInputStream() throws IOException
+                    {
+                        return Minecraft.getMinecraft().getResourceManager().getResource(p_148612_0_).getInputStream();
+                    }
+                };
+            }
+        };
+
+        try
+        {
+            return new URL((URL)null, var1, var2);
+        }
+        catch (MalformedURLException var4)
+        {
+            throw new Error("TODO: Sanely handle url exception! :D");
+        }
+    }
+
+    /**
+     * Sets the listener of sounds
+     */
+    public void setListener(EntityPlayer p_148615_1_, float p_148615_2_)
+    {
+        if (this.loaded && p_148615_1_ != null)
+        {
+            float var3 = p_148615_1_.prevRotationPitch + (p_148615_1_.rotationPitch - p_148615_1_.prevRotationPitch) * p_148615_2_;
+            float var4 = p_148615_1_.prevRotationYaw + (p_148615_1_.rotationYaw - p_148615_1_.prevRotationYaw) * p_148615_2_;
+            double var5 = p_148615_1_.prevPosX + (p_148615_1_.posX - p_148615_1_.prevPosX) * (double)p_148615_2_;
+            double var7 = p_148615_1_.prevPosY + (p_148615_1_.posY - p_148615_1_.prevPosY) * (double)p_148615_2_ + (double)p_148615_1_.getEyeHeight();
+            double var9 = p_148615_1_.prevPosZ + (p_148615_1_.posZ - p_148615_1_.prevPosZ) * (double)p_148615_2_;
+            float var11 = MathHelper.cos((var4 + 90.0F) * 0.017453292F);
+            float var12 = MathHelper.sin((var4 + 90.0F) * 0.017453292F);
+            float var13 = MathHelper.cos(-var3 * 0.017453292F);
+            float var14 = MathHelper.sin(-var3 * 0.017453292F);
+            float var15 = MathHelper.cos((-var3 + 90.0F) * 0.017453292F);
+            float var16 = MathHelper.sin((-var3 + 90.0F) * 0.017453292F);
+            float var17 = var11 * var13;
+            float var19 = var12 * var13;
+            float var20 = var11 * var15;
+            float var22 = var12 * var15;
+            this.sndSystem.setListenerPosition((float)var5, (float)var7, (float)var9);
+            this.sndSystem.setListenerOrientation(var17, var14, var19, var20, var16, var22);
+        }
+    }
+
+    class SoundSystemStarterThread extends SoundSystem
+    {
+        private static final String __OBFID = "CL_00001145";
+
+        private SoundSystemStarterThread() {}
+
+        public boolean playing(String p_playing_1_)
+        {
+            Object var2 = SoundSystemConfig.THREAD_SYNC;
+
+            synchronized (SoundSystemConfig.THREAD_SYNC)
+            {
+                if (this.soundLibrary == null)
+                {
+                    return false;
+                }
+                else
+                {
+                    Source var3 = (Source)this.soundLibrary.getSources().get(p_playing_1_);
+                    return var3 == null ? false : var3.playing() || var3.paused() || var3.preLoad;
+                }
+            }
+        }
+
+        SoundSystemStarterThread(Object p_i45118_2_)
+        {
+            this();
+        }
+    }
+}
diff --git a/src/net/minecraft/client/entity/AbstractClientPlayer.java b/src/net/minecraft/client/entity/AbstractClientPlayer.java
index de9ca57..3833cae 100644
--- a/src/net/minecraft/client/entity/AbstractClientPlayer.java
+++ b/src/net/minecraft/client/entity/AbstractClientPlayer.java
@@ -1,131 +1,136 @@
-package net.minecraft.client.entity;
-
-import com.mojang.authlib.GameProfile;
-import java.io.File;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.network.NetworkPlayerInfo;
-import net.minecraft.client.renderer.ImageBufferDownload;
-import net.minecraft.client.renderer.ThreadDownloadImageData;
-import net.minecraft.client.renderer.texture.ITextureObject;
-import net.minecraft.client.renderer.texture.TextureManager;
-import net.minecraft.client.resources.DefaultPlayerSkin;
-import net.minecraft.entity.SharedMonsterAttributes;
-import net.minecraft.entity.ai.attributes.IAttributeInstance;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.init.Items;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.StringUtils;
-import net.minecraft.world.World;
-import net.minecraft.world.WorldSettings;
-
-public abstract class AbstractClientPlayer extends EntityPlayer
-{
-    private NetworkPlayerInfo field_175157_a;
-    private static final String __OBFID = "CL_00000935";
-
-    public AbstractClientPlayer(World worldIn, GameProfile p_i45074_2_)
-    {
-        super(worldIn, p_i45074_2_);
-    }
-
-    public boolean func_175149_v()
-    {
-        NetworkPlayerInfo var1 = Minecraft.getMinecraft().getNetHandler().func_175102_a(this.getGameProfile().getId());
-        return var1 != null && var1.getGameType() == WorldSettings.GameType.SPECTATOR;
-    }
-
-    public boolean hasCape()
-    {
-        return this.func_175155_b() != null;
-    }
-
-    protected NetworkPlayerInfo func_175155_b()
-    {
-        if (this.field_175157_a == null)
-        {
-            this.field_175157_a = Minecraft.getMinecraft().getNetHandler().func_175102_a(this.getUniqueID());
-        }
-
-        return this.field_175157_a;
-    }
-
-    public boolean hasSkin()
-    {
-        NetworkPlayerInfo var1 = this.func_175155_b();
-        return var1 != null && var1.func_178856_e();
-    }
-
-    public ResourceLocation getLocationSkin()
-    {
-        NetworkPlayerInfo var1 = this.func_175155_b();
-        return var1 == null ? DefaultPlayerSkin.func_177334_a(this.getUniqueID()) : var1.func_178837_g();
-    }
-
-    public ResourceLocation getLocationCape()
-    {
-        NetworkPlayerInfo var1 = this.func_175155_b();
-        return var1 == null ? null : var1.func_178861_h();
-    }
-
-    public static ThreadDownloadImageData getDownloadImageSkin(ResourceLocation resourceLocationIn, String username)
-    {
-        TextureManager var2 = Minecraft.getMinecraft().getTextureManager();
-        Object var3 = var2.getTexture(resourceLocationIn);
-
-        if (var3 == null)
-        {
-            var3 = new ThreadDownloadImageData((File)null, String.format("http://skins.minecraft.net/MinecraftSkins/%s.png", new Object[] {StringUtils.stripControlCodes(username)}), DefaultPlayerSkin.func_177334_a(func_175147_b(username)), new ImageBufferDownload());
-            var2.loadTexture(resourceLocationIn, (ITextureObject)var3);
-        }
-
-        return (ThreadDownloadImageData)var3;
-    }
-
-    public static ResourceLocation getLocationSkin(String username)
-    {
-        return new ResourceLocation("skins/" + StringUtils.stripControlCodes(username));
-    }
-
-    public String func_175154_l()
-    {
-        NetworkPlayerInfo var1 = this.func_175155_b();
-        return var1 == null ? DefaultPlayerSkin.func_177332_b(this.getUniqueID()) : var1.func_178851_f();
-    }
-
-    public float func_175156_o()
-    {
-        float var1 = 1.0F;
-
-        if (this.capabilities.isFlying)
-        {
-            var1 *= 1.1F;
-        }
-
-        IAttributeInstance var2 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
-        var1 = (float)((double)var1 * ((var2.getAttributeValue() / (double)this.capabilities.getWalkSpeed() + 1.0D) / 2.0D));
-
-        if (this.capabilities.getWalkSpeed() == 0.0F || Float.isNaN(var1) || Float.isInfinite(var1))
-        {
-            var1 = 1.0F;
-        }
-
-        if (this.isUsingItem() && this.getItemInUse().getItem() == Items.bow)
-        {
-            int var3 = this.getItemInUseDuration();
-            float var4 = (float)var3 / 20.0F;
-
-            if (var4 > 1.0F)
-            {
-                var4 = 1.0F;
-            }
-            else
-            {
-                var4 *= var4;
-            }
-
-            var1 *= 1.0F - var4 * 0.15F;
-        }
-
-        return var1;
-    }
-}
+package net.minecraft.client.entity;
+
+import java.io.File;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.network.NetworkPlayerInfo;
+import net.minecraft.client.renderer.ImageBufferDownload;
+import net.minecraft.client.renderer.ThreadDownloadImageData;
+import net.minecraft.client.renderer.texture.ITextureObject;
+import net.minecraft.client.renderer.texture.TextureManager;
+import net.minecraft.client.resources.DefaultPlayerSkin;
+import net.minecraft.entity.SharedMonsterAttributes;
+import net.minecraft.entity.ai.attributes.IAttributeInstance;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.init.Items;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.util.StringUtils;
+import net.minecraft.world.World;
+import net.minecraft.world.WorldSettings;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.FreecamMod;
+
+import com.mojang.authlib.GameProfile;
+
+public abstract class AbstractClientPlayer extends EntityPlayer
+{
+    private NetworkPlayerInfo field_175157_a;
+    private static final String __OBFID = "CL_00000935";
+
+    public AbstractClientPlayer(World worldIn, GameProfile p_i45074_2_)
+    {
+        super(worldIn, p_i45074_2_);
+    }
+
+    public boolean isSpectator()
+    {
+        NetworkPlayerInfo var1 = Minecraft.getMinecraft().getNetHandler().func_175102_a(this.getGameProfile().getId());
+        //TODO: Client
+        return WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled() ? true : var1 != null && var1.getGameType() == WorldSettings.GameType.SPECTATOR;
+    }
+
+    public boolean hasCape()
+    {
+        return this.func_175155_b() != null;
+    }
+
+    protected NetworkPlayerInfo func_175155_b()
+    {
+        if (this.field_175157_a == null)
+        {
+            this.field_175157_a = Minecraft.getMinecraft().getNetHandler().func_175102_a(this.getUniqueID());
+        }
+
+        return this.field_175157_a;
+    }
+
+    public boolean hasSkin()
+    {
+        NetworkPlayerInfo var1 = this.func_175155_b();
+        return var1 != null && var1.func_178856_e();
+    }
+
+    public ResourceLocation getLocationSkin()
+    {
+        NetworkPlayerInfo var1 = this.func_175155_b();
+        return var1 == null ? DefaultPlayerSkin.getLocationFromUUID(this.getUniqueID()) : var1.func_178837_g();
+    }
+
+    public ResourceLocation getLocationCape()
+    {
+        NetworkPlayerInfo var1 = this.func_175155_b();
+        return var1 == null ? null : var1.func_178861_h();
+    }
+
+    public static ThreadDownloadImageData getDownloadImageSkin(ResourceLocation resourceLocationIn, String username)
+    {
+        TextureManager var2 = Minecraft.getMinecraft().getTextureManager();
+        Object var3 = var2.getTexture(resourceLocationIn);
+
+        if (var3 == null)
+        {
+            var3 = new ThreadDownloadImageData((File)null, String.format("http://skins.minecraft.net/MinecraftSkins/%s.png", new Object[] {StringUtils.stripControlCodes(username)}), DefaultPlayerSkin.getLocationFromUUID(getUUIDFromPlayerName(username)), new ImageBufferDownload());
+            var2.loadTexture(resourceLocationIn, (ITextureObject)var3);
+        }
+
+        return (ThreadDownloadImageData)var3;
+    }
+
+    public static ResourceLocation getLocationSkin(String username)
+    {
+        return new ResourceLocation("skins/" + StringUtils.stripControlCodes(username));
+    }
+
+    public String func_175154_l()
+    {
+        NetworkPlayerInfo var1 = this.func_175155_b();
+        return var1 == null ? DefaultPlayerSkin.getModelNameFromUUID(this.getUniqueID()) : var1.getModelName();
+    }
+
+    public float func_175156_o()
+    {
+        float var1 = 1.0F;
+
+        if (this.capabilities.isFlying)
+        {
+            var1 *= 1.1F;
+        }
+
+        IAttributeInstance var2 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
+        var1 = (float)((double)var1 * ((var2.getAttributeValue() / (double)this.capabilities.getWalkSpeed() + 1.0D) / 2.0D));
+
+        if (this.capabilities.getWalkSpeed() == 0.0F || Float.isNaN(var1) || Float.isInfinite(var1))
+        {
+            var1 = 1.0F;
+        }
+
+        if (this.isUsingItem() && this.getItemInUse().getItem() == Items.bow)
+        {
+            int var3 = this.getItemInUseDuration();
+            float var4 = (float)var3 / 20.0F;
+
+            if (var4 > 1.0F)
+            {
+                var4 = 1.0F;
+            }
+            else
+            {
+                var4 *= var4;
+            }
+
+            var1 *= 1.0F - var4 * 0.15F;
+        }
+
+        return var1;
+    }
+}
diff --git a/src/net/minecraft/client/entity/EntityPlayerSP.java b/src/net/minecraft/client/entity/EntityPlayerSP.java
index eefe303..9432d55 100644
--- a/src/net/minecraft/client/entity/EntityPlayerSP.java
+++ b/src/net/minecraft/client/entity/EntityPlayerSP.java
@@ -1,863 +1,908 @@
-package net.minecraft.client.entity;
-
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.audio.MovingSoundMinecartRiding;
-import net.minecraft.client.audio.PositionedSoundRecord;
-import net.minecraft.client.gui.GuiCommandBlock;
-import net.minecraft.client.gui.GuiEnchantment;
-import net.minecraft.client.gui.GuiHopper;
-import net.minecraft.client.gui.GuiMerchant;
-import net.minecraft.client.gui.GuiRepair;
-import net.minecraft.client.gui.GuiScreen;
-import net.minecraft.client.gui.GuiScreenBook;
-import net.minecraft.client.gui.inventory.GuiBeacon;
-import net.minecraft.client.gui.inventory.GuiBrewingStand;
-import net.minecraft.client.gui.inventory.GuiChest;
-import net.minecraft.client.gui.inventory.GuiCrafting;
-import net.minecraft.client.gui.inventory.GuiDispenser;
-import net.minecraft.client.gui.inventory.GuiEditSign;
-import net.minecraft.client.gui.inventory.GuiFurnace;
-import net.minecraft.client.gui.inventory.GuiScreenHorseInventory;
-import net.minecraft.client.network.NetHandlerPlayClient;
-import net.minecraft.command.server.CommandBlockLogic;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.IMerchant;
-import net.minecraft.entity.item.EntityItem;
-import net.minecraft.entity.item.EntityMinecart;
-import net.minecraft.entity.passive.EntityHorse;
-import net.minecraft.init.Items;
-import net.minecraft.inventory.IInventory;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemStack;
-import net.minecraft.network.play.client.C01PacketChatMessage;
-import net.minecraft.network.play.client.C03PacketPlayer;
-import net.minecraft.network.play.client.C07PacketPlayerDigging;
-import net.minecraft.network.play.client.C0APacketAnimation;
-import net.minecraft.network.play.client.C0BPacketEntityAction;
-import net.minecraft.network.play.client.C0CPacketInput;
-import net.minecraft.network.play.client.C0DPacketCloseWindow;
-import net.minecraft.network.play.client.C13PacketPlayerAbilities;
-import net.minecraft.network.play.client.C16PacketClientStatus;
-import net.minecraft.potion.Potion;
-import net.minecraft.stats.StatBase;
-import net.minecraft.stats.StatFileWriter;
-import net.minecraft.tileentity.TileEntitySign;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.DamageSource;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.MovementInput;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.world.IInteractionObject;
-import net.minecraft.world.World;
-
-public class EntityPlayerSP extends AbstractClientPlayer
-{
-    public final NetHandlerPlayClient sendQueue;
-    private final StatFileWriter field_146108_bO;
-    private double field_175172_bI;
-    private double field_175166_bJ;
-    private double field_175167_bK;
-    private float field_175164_bL;
-    private float field_175165_bM;
-    private boolean field_175170_bN;
-    private boolean field_175171_bO;
-    private int field_175168_bP;
-    private boolean field_175169_bQ;
-    private String clientBrand;
-    public MovementInput movementInput;
-    protected Minecraft mc;
-
-    /**
-     * Used to tell if the player pressed forward twice. If this is at 0 and it's pressed (And they are allowed to
-     * sprint, aka enough food on the ground etc) it sets this to 7. If it's pressed and it's greater than 0 enable
-     * sprinting.
-     */
-    protected int sprintToggleTimer;
-
-    /** Ticks left before sprinting is disabled. */
-    public int sprintingTicksLeft;
-    public float renderArmYaw;
-    public float renderArmPitch;
-    public float prevRenderArmYaw;
-    public float prevRenderArmPitch;
-    private int horseJumpPowerCounter;
-    private float horseJumpPower;
-
-    /** The amount of time an entity has been in a Portal */
-    public float timeInPortal;
-
-    /** The amount of time an entity has been in a Portal the previous tick */
-    public float prevTimeInPortal;
-    private static final String __OBFID = "CL_00000938";
-
-    public EntityPlayerSP(Minecraft mcIn, World worldIn, NetHandlerPlayClient p_i46278_3_, StatFileWriter p_i46278_4_)
-    {
-        super(worldIn, p_i46278_3_.func_175105_e());
-        this.sendQueue = p_i46278_3_;
-        this.field_146108_bO = p_i46278_4_;
-        this.mc = mcIn;
-        this.dimension = 0;
-    }
-
-    /**
-     * Called when the entity is attacked.
-     */
-    public boolean attackEntityFrom(DamageSource source, float amount)
-    {
-        return false;
-    }
-
-    /**
-     * Heal living entity (param: amount of half-hearts)
-     */
-    public void heal(float p_70691_1_) {}
-
-    /**
-     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
-     */
-    public void mountEntity(Entity entityIn)
-    {
-        super.mountEntity(entityIn);
-
-        if (entityIn instanceof EntityMinecart)
-        {
-            this.mc.getSoundHandler().playSound(new MovingSoundMinecartRiding(this, (EntityMinecart)entityIn));
-        }
-    }
-
-    /**
-     * Called to update the entity's position/logic.
-     */
-    public void onUpdate()
-    {
-        if (this.worldObj.isBlockLoaded(new BlockPos(this.posX, 0.0D, this.posZ)))
-        {
-            super.onUpdate();
-
-            if (this.isRiding())
-            {
-                this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(this.rotationYaw, this.rotationPitch, this.onGround));
-                this.sendQueue.addToSendQueue(new C0CPacketInput(this.moveStrafing, this.moveForward, this.movementInput.jump, this.movementInput.sneak));
-            }
-            else
-            {
-                this.func_175161_p();
-            }
-        }
-    }
-
-    public void func_175161_p()
-    {
-        boolean var1 = this.isSprinting();
-
-        if (var1 != this.field_175171_bO)
-        {
-            if (var1)
-            {
-                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SPRINTING));
-            }
-            else
-            {
-                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SPRINTING));
-            }
-
-            this.field_175171_bO = var1;
-        }
-
-        boolean var2 = this.isSneaking();
-
-        if (var2 != this.field_175170_bN)
-        {
-            if (var2)
-            {
-                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SNEAKING));
-            }
-            else
-            {
-                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SNEAKING));
-            }
-
-            this.field_175170_bN = var2;
-        }
-
-        if (this.func_175160_A())
-        {
-            double var3 = this.posX - this.field_175172_bI;
-            double var5 = this.getEntityBoundingBox().minY - this.field_175166_bJ;
-            double var7 = this.posZ - this.field_175167_bK;
-            double var9 = (double)(this.rotationYaw - this.field_175164_bL);
-            double var11 = (double)(this.rotationPitch - this.field_175165_bM);
-            boolean var13 = var3 * var3 + var5 * var5 + var7 * var7 > 9.0E-4D || this.field_175168_bP >= 20;
-            boolean var14 = var9 != 0.0D || var11 != 0.0D;
-
-            if (this.ridingEntity == null)
-            {
-                if (var13 && var14)
-                {
-                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.rotationYaw, this.rotationPitch, this.onGround));
-                }
-                else if (var13)
-                {
-                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.onGround));
-                }
-                else if (var14)
-                {
-                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(this.rotationYaw, this.rotationPitch, this.onGround));
-                }
-                else
-                {
-                    this.sendQueue.addToSendQueue(new C03PacketPlayer(this.onGround));
-                }
-            }
-            else
-            {
-                this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.motionX, -999.0D, this.motionZ, this.rotationYaw, this.rotationPitch, this.onGround));
-                var13 = false;
-            }
-
-            ++this.field_175168_bP;
-
-            if (var13)
-            {
-                this.field_175172_bI = this.posX;
-                this.field_175166_bJ = this.getEntityBoundingBox().minY;
-                this.field_175167_bK = this.posZ;
-                this.field_175168_bP = 0;
-            }
-
-            if (var14)
-            {
-                this.field_175164_bL = this.rotationYaw;
-                this.field_175165_bM = this.rotationPitch;
-            }
-        }
-    }
-
-    /**
-     * Called when player presses the drop item key
-     */
-    public EntityItem dropOneItem(boolean p_71040_1_)
-    {
-        C07PacketPlayerDigging.Action var2 = p_71040_1_ ? C07PacketPlayerDigging.Action.DROP_ALL_ITEMS : C07PacketPlayerDigging.Action.DROP_ITEM;
-        this.sendQueue.addToSendQueue(new C07PacketPlayerDigging(var2, BlockPos.ORIGIN, EnumFacing.DOWN));
-        return null;
-    }
-
-    /**
-     * Joins the passed in entity item with the world. Args: entityItem
-     */
-    protected void joinEntityItemWithWorld(EntityItem p_71012_1_) {}
-
-    /**
-     * Sends a chat message from the player. Args: chatMessage
-     */
-    public void sendChatMessage(String p_71165_1_)
-    {
-        this.sendQueue.addToSendQueue(new C01PacketChatMessage(p_71165_1_));
-    }
-
-    /**
-     * Swings the item the player is holding.
-     */
-    public void swingItem()
-    {
-        super.swingItem();
-        this.sendQueue.addToSendQueue(new C0APacketAnimation());
-    }
-
-    public void respawnPlayer()
-    {
-        this.sendQueue.addToSendQueue(new C16PacketClientStatus(C16PacketClientStatus.EnumState.PERFORM_RESPAWN));
-    }
-
-    /**
-     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
-     * second with the reduced value. Args: damageAmount
-     */
-    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
-    {
-        if (!this.func_180431_b(p_70665_1_))
-        {
-            this.setHealth(this.getHealth() - p_70665_2_);
-        }
-    }
-
-    /**
-     * set current crafting inventory back to the 2x2 square
-     */
-    public void closeScreen()
-    {
-        this.sendQueue.addToSendQueue(new C0DPacketCloseWindow(this.openContainer.windowId));
-        this.func_175159_q();
-    }
-
-    public void func_175159_q()
-    {
-        this.inventory.setItemStack((ItemStack)null);
-        super.closeScreen();
-        this.mc.displayGuiScreen((GuiScreen)null);
-    }
-
-    /**
-     * Updates health locally.
-     */
-    public void setPlayerSPHealth(float p_71150_1_)
-    {
-        if (this.field_175169_bQ)
-        {
-            float var2 = this.getHealth() - p_71150_1_;
-
-            if (var2 <= 0.0F)
-            {
-                this.setHealth(p_71150_1_);
-
-                if (var2 < 0.0F)
-                {
-                    this.hurtResistantTime = this.maxHurtResistantTime / 2;
-                }
-            }
-            else
-            {
-                this.lastDamage = var2;
-                this.setHealth(this.getHealth());
-                this.hurtResistantTime = this.maxHurtResistantTime;
-                this.damageEntity(DamageSource.generic, var2);
-                this.hurtTime = this.maxHurtTime = 10;
-            }
-        }
-        else
-        {
-            this.setHealth(p_71150_1_);
-            this.field_175169_bQ = true;
-        }
-    }
-
-    /**
-     * Adds a value to a statistic field.
-     */
-    public void addStat(StatBase p_71064_1_, int p_71064_2_)
-    {
-        if (p_71064_1_ != null)
-        {
-            if (p_71064_1_.isIndependent)
-            {
-                super.addStat(p_71064_1_, p_71064_2_);
-            }
-        }
-    }
-
-    /**
-     * Sends the player's abilities to the server (if there is one).
-     */
-    public void sendPlayerAbilities()
-    {
-        this.sendQueue.addToSendQueue(new C13PacketPlayerAbilities(this.capabilities));
-    }
-
-    public boolean func_175144_cb()
-    {
-        return true;
-    }
-
-    protected void sendHorseJump()
-    {
-        this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.RIDING_JUMP, (int)(this.getHorseJumpPower() * 100.0F)));
-    }
-
-    public void func_175163_u()
-    {
-        this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.OPEN_INVENTORY));
-    }
-
-    public void func_175158_f(String p_175158_1_)
-    {
-        this.clientBrand = p_175158_1_;
-    }
-
-    public String getClientBrand()
-    {
-        return this.clientBrand;
-    }
-
-    public StatFileWriter getStatFileWriter()
-    {
-        return this.field_146108_bO;
-    }
-
-    public void addChatComponentMessage(IChatComponent p_146105_1_)
-    {
-        this.mc.ingameGUI.getChatGUI().printChatMessage(p_146105_1_);
-    }
-
-    protected boolean pushOutOfBlocks(double x, double y, double z)
-    {
-        if (this.noClip)
-        {
-            return false;
-        }
-        else
-        {
-            BlockPos var7 = new BlockPos(x, y, z);
-            double var8 = x - (double)var7.getX();
-            double var10 = z - (double)var7.getZ();
-
-            if (!this.func_175162_d(var7))
-            {
-                byte var12 = -1;
-                double var13 = 9999.0D;
-
-                if (this.func_175162_d(var7.offsetWest()) && var8 < var13)
-                {
-                    var13 = var8;
-                    var12 = 0;
-                }
-
-                if (this.func_175162_d(var7.offsetEast()) && 1.0D - var8 < var13)
-                {
-                    var13 = 1.0D - var8;
-                    var12 = 1;
-                }
-
-                if (this.func_175162_d(var7.offsetNorth()) && var10 < var13)
-                {
-                    var13 = var10;
-                    var12 = 4;
-                }
-
-                if (this.func_175162_d(var7.offsetSouth()) && 1.0D - var10 < var13)
-                {
-                    var13 = 1.0D - var10;
-                    var12 = 5;
-                }
-
-                float var15 = 0.1F;
-
-                if (var12 == 0)
-                {
-                    this.motionX = (double)(-var15);
-                }
-
-                if (var12 == 1)
-                {
-                    this.motionX = (double)var15;
-                }
-
-                if (var12 == 4)
-                {
-                    this.motionZ = (double)(-var15);
-                }
-
-                if (var12 == 5)
-                {
-                    this.motionZ = (double)var15;
-                }
-            }
-
-            return false;
-        }
-    }
-
-    private boolean func_175162_d(BlockPos p_175162_1_)
-    {
-        return !this.worldObj.getBlockState(p_175162_1_).getBlock().isNormalCube() && !this.worldObj.getBlockState(p_175162_1_.offsetUp()).getBlock().isNormalCube();
-    }
-
-    /**
-     * Set sprinting switch for Entity.
-     */
-    public void setSprinting(boolean sprinting)
-    {
-        super.setSprinting(sprinting);
-        this.sprintingTicksLeft = sprinting ? 600 : 0;
-    }
-
-    /**
-     * Sets the current XP, total XP, and level number.
-     */
-    public void setXPStats(float p_71152_1_, int p_71152_2_, int p_71152_3_)
-    {
-        this.experience = p_71152_1_;
-        this.experienceTotal = p_71152_2_;
-        this.experienceLevel = p_71152_3_;
-    }
-
-    /**
-     * Notifies this sender of some sort of information.  This is for messages intended to display to the user.  Used
-     * for typical output (like "you asked for whether or not this game rule is set, so here's your answer"), warnings
-     * (like "I fetched this block for you by ID, but I'd like you to know that every time you do this, I die a little
-     * inside"), and errors (like "it's not called iron_pixacke, silly").
-     */
-    public void addChatMessage(IChatComponent message)
-    {
-        this.mc.ingameGUI.getChatGUI().printChatMessage(message);
-    }
-
-    /**
-     * Returns true if the command sender is allowed to use the given command.
-     */
-    public boolean canCommandSenderUseCommand(int permissionLevel, String command)
-    {
-        return permissionLevel <= 0;
-    }
-
-    public BlockPos getPosition()
-    {
-        return new BlockPos(this.posX + 0.5D, this.posY + 0.5D, this.posZ + 0.5D);
-    }
-
-    public void playSound(String name, float volume, float pitch)
-    {
-        this.worldObj.playSound(this.posX, this.posY, this.posZ, name, volume, pitch, false);
-    }
-
-    /**
-     * Returns whether the entity is in a server world
-     */
-    public boolean isServerWorld()
-    {
-        return true;
-    }
-
-    public boolean isRidingHorse()
-    {
-        return this.ridingEntity != null && this.ridingEntity instanceof EntityHorse && ((EntityHorse)this.ridingEntity).isHorseSaddled();
-    }
-
-    public float getHorseJumpPower()
-    {
-        return this.horseJumpPower;
-    }
-
-    public void func_175141_a(TileEntitySign p_175141_1_)
-    {
-        this.mc.displayGuiScreen(new GuiEditSign(p_175141_1_));
-    }
-
-    public void func_146095_a(CommandBlockLogic p_146095_1_)
-    {
-        this.mc.displayGuiScreen(new GuiCommandBlock(p_146095_1_));
-    }
-
-    /**
-     * Displays the GUI for interacting with a book.
-     */
-    public void displayGUIBook(ItemStack bookStack)
-    {
-        Item var2 = bookStack.getItem();
-
-        if (var2 == Items.writable_book)
-        {
-            this.mc.displayGuiScreen(new GuiScreenBook(this, bookStack, true));
-        }
-    }
-
-    /**
-     * Displays the GUI for interacting with a chest inventory. Args: chestInventory
-     */
-    public void displayGUIChest(IInventory chestInventory)
-    {
-        String var2 = chestInventory instanceof IInteractionObject ? ((IInteractionObject)chestInventory).getGuiID() : "minecraft:container";
-
-        if ("minecraft:chest".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiChest(this.inventory, chestInventory));
-        }
-        else if ("minecraft:hopper".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiHopper(this.inventory, chestInventory));
-        }
-        else if ("minecraft:furnace".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiFurnace(this.inventory, chestInventory));
-        }
-        else if ("minecraft:brewing_stand".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiBrewingStand(this.inventory, chestInventory));
-        }
-        else if ("minecraft:beacon".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiBeacon(this.inventory, chestInventory));
-        }
-        else if (!"minecraft:dispenser".equals(var2) && !"minecraft:dropper".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiChest(this.inventory, chestInventory));
-        }
-        else
-        {
-            this.mc.displayGuiScreen(new GuiDispenser(this.inventory, chestInventory));
-        }
-    }
-
-    public void displayGUIHorse(EntityHorse p_110298_1_, IInventory p_110298_2_)
-    {
-        this.mc.displayGuiScreen(new GuiScreenHorseInventory(this.inventory, p_110298_2_, p_110298_1_));
-    }
-
-    public void displayGui(IInteractionObject guiOwner)
-    {
-        String var2 = guiOwner.getGuiID();
-
-        if ("minecraft:crafting_table".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiCrafting(this.inventory, this.worldObj));
-        }
-        else if ("minecraft:enchanting_table".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiEnchantment(this.inventory, this.worldObj, guiOwner));
-        }
-        else if ("minecraft:anvil".equals(var2))
-        {
-            this.mc.displayGuiScreen(new GuiRepair(this.inventory, this.worldObj));
-        }
-    }
-
-    public void displayVillagerTradeGui(IMerchant villager)
-    {
-        this.mc.displayGuiScreen(new GuiMerchant(this.inventory, villager, this.worldObj));
-    }
-
-    /**
-     * Called when the player performs a critical hit on the Entity. Args: entity that was hit critically
-     */
-    public void onCriticalHit(Entity p_71009_1_)
-    {
-        this.mc.effectRenderer.func_178926_a(p_71009_1_, EnumParticleTypes.CRIT);
-    }
-
-    public void onEnchantmentCritical(Entity p_71047_1_)
-    {
-        this.mc.effectRenderer.func_178926_a(p_71047_1_, EnumParticleTypes.CRIT_MAGIC);
-    }
-
-    /**
-     * Returns if this entity is sneaking.
-     */
-    public boolean isSneaking()
-    {
-        boolean var1 = this.movementInput != null ? this.movementInput.sneak : false;
-        return var1 && !this.sleeping;
-    }
-
-    public void updateEntityActionState()
-    {
-        super.updateEntityActionState();
-
-        if (this.func_175160_A())
-        {
-            this.moveStrafing = this.movementInput.moveStrafe;
-            this.moveForward = this.movementInput.moveForward;
-            this.isJumping = this.movementInput.jump;
-            this.prevRenderArmYaw = this.renderArmYaw;
-            this.prevRenderArmPitch = this.renderArmPitch;
-            this.renderArmPitch = (float)((double)this.renderArmPitch + (double)(this.rotationPitch - this.renderArmPitch) * 0.5D);
-            this.renderArmYaw = (float)((double)this.renderArmYaw + (double)(this.rotationYaw - this.renderArmYaw) * 0.5D);
-        }
-    }
-
-    protected boolean func_175160_A()
-    {
-        return this.mc.func_175606_aa() == this;
-    }
-
-    /**
-     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
-     * use this to react to sunlight and start to burn.
-     */
-    public void onLivingUpdate()
-    {
-        if (this.sprintingTicksLeft > 0)
-        {
-            --this.sprintingTicksLeft;
-
-            if (this.sprintingTicksLeft == 0)
-            {
-                this.setSprinting(false);
-            }
-        }
-
-        if (this.sprintToggleTimer > 0)
-        {
-            --this.sprintToggleTimer;
-        }
-
-        this.prevTimeInPortal = this.timeInPortal;
-
-        if (this.inPortal)
-        {
-            if (this.mc.currentScreen != null && !this.mc.currentScreen.doesGuiPauseGame())
-            {
-                this.mc.displayGuiScreen((GuiScreen)null);
-            }
-
-            if (this.timeInPortal == 0.0F)
-            {
-                this.mc.getSoundHandler().playSound(PositionedSoundRecord.createPositionedSoundRecord(new ResourceLocation("portal.trigger"), this.rand.nextFloat() * 0.4F + 0.8F));
-            }
-
-            this.timeInPortal += 0.0125F;
-
-            if (this.timeInPortal >= 1.0F)
-            {
-                this.timeInPortal = 1.0F;
-            }
-
-            this.inPortal = false;
-        }
-        else if (this.isPotionActive(Potion.confusion) && this.getActivePotionEffect(Potion.confusion).getDuration() > 60)
-        {
-            this.timeInPortal += 0.006666667F;
-
-            if (this.timeInPortal > 1.0F)
-            {
-                this.timeInPortal = 1.0F;
-            }
-        }
-        else
-        {
-            if (this.timeInPortal > 0.0F)
-            {
-                this.timeInPortal -= 0.05F;
-            }
-
-            if (this.timeInPortal < 0.0F)
-            {
-                this.timeInPortal = 0.0F;
-            }
-        }
-
-        if (this.timeUntilPortal > 0)
-        {
-            --this.timeUntilPortal;
-        }
-
-        boolean var1 = this.movementInput.jump;
-        boolean var2 = this.movementInput.sneak;
-        float var3 = 0.8F;
-        boolean var4 = this.movementInput.moveForward >= var3;
-        this.movementInput.updatePlayerMoveState();
-
-        if (this.isUsingItem() && !this.isRiding())
-        {
-            this.movementInput.moveStrafe *= 0.2F;
-            this.movementInput.moveForward *= 0.2F;
-            this.sprintToggleTimer = 0;
-        }
-
-        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
-        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
-        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
-        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
-        boolean var5 = (float)this.getFoodStats().getFoodLevel() > 6.0F || this.capabilities.allowFlying;
-
-        if (this.onGround && !var2 && !var4 && this.movementInput.moveForward >= var3 && !this.isSprinting() && var5 && !this.isUsingItem() && !this.isPotionActive(Potion.blindness))
-        {
-            if (this.sprintToggleTimer <= 0 && !this.mc.gameSettings.keyBindSprint.getIsKeyPressed())
-            {
-                this.sprintToggleTimer = 7;
-            }
-            else
-            {
-                this.setSprinting(true);
-            }
-        }
-
-        if (!this.isSprinting() && this.movementInput.moveForward >= var3 && var5 && !this.isUsingItem() && !this.isPotionActive(Potion.blindness) && this.mc.gameSettings.keyBindSprint.getIsKeyPressed())
-        {
-            this.setSprinting(true);
-        }
-
-        if (this.isSprinting() && (this.movementInput.moveForward < var3 || this.isCollidedHorizontally || !var5))
-        {
-            this.setSprinting(false);
-        }
-
-        if (this.capabilities.allowFlying)
-        {
-            if (this.mc.playerController.isSpectatorMode())
-            {
-                if (!this.capabilities.isFlying)
-                {
-                    this.capabilities.isFlying = true;
-                    this.sendPlayerAbilities();
-                }
-            }
-            else if (!var1 && this.movementInput.jump)
-            {
-                if (this.flyToggleTimer == 0)
-                {
-                    this.flyToggleTimer = 7;
-                }
-                else
-                {
-                    this.capabilities.isFlying = !this.capabilities.isFlying;
-                    this.sendPlayerAbilities();
-                    this.flyToggleTimer = 0;
-                }
-            }
-        }
-
-        if (this.capabilities.isFlying && this.func_175160_A())
-        {
-            if (this.movementInput.sneak)
-            {
-                this.motionY -= (double)(this.capabilities.getFlySpeed() * 3.0F);
-            }
-
-            if (this.movementInput.jump)
-            {
-                this.motionY += (double)(this.capabilities.getFlySpeed() * 3.0F);
-            }
-        }
-
-        if (this.isRidingHorse())
-        {
-            if (this.horseJumpPowerCounter < 0)
-            {
-                ++this.horseJumpPowerCounter;
-
-                if (this.horseJumpPowerCounter == 0)
-                {
-                    this.horseJumpPower = 0.0F;
-                }
-            }
-
-            if (var1 && !this.movementInput.jump)
-            {
-                this.horseJumpPowerCounter = -10;
-                this.sendHorseJump();
-            }
-            else if (!var1 && this.movementInput.jump)
-            {
-                this.horseJumpPowerCounter = 0;
-                this.horseJumpPower = 0.0F;
-            }
-            else if (var1)
-            {
-                ++this.horseJumpPowerCounter;
-
-                if (this.horseJumpPowerCounter < 10)
-                {
-                    this.horseJumpPower = (float)this.horseJumpPowerCounter * 0.1F;
-                }
-                else
-                {
-                    this.horseJumpPower = 0.8F + 2.0F / (float)(this.horseJumpPowerCounter - 9) * 0.1F;
-                }
-            }
-        }
-        else
-        {
-            this.horseJumpPower = 0.0F;
-        }
-
-        super.onLivingUpdate();
-
-        if (this.onGround && this.capabilities.isFlying && !this.mc.playerController.isSpectatorMode())
-        {
-            this.capabilities.isFlying = false;
-            this.sendPlayerAbilities();
-        }
-    }
-}
+package net.minecraft.client.entity;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.audio.MovingSoundMinecartRiding;
+import net.minecraft.client.audio.PositionedSoundRecord;
+import net.minecraft.client.gui.GuiCommandBlock;
+import net.minecraft.client.gui.GuiEnchantment;
+import net.minecraft.client.gui.GuiHopper;
+import net.minecraft.client.gui.GuiMerchant;
+import net.minecraft.client.gui.GuiRepair;
+import net.minecraft.client.gui.GuiScreen;
+import net.minecraft.client.gui.GuiScreenBook;
+import net.minecraft.client.gui.inventory.*;
+import net.minecraft.client.network.NetHandlerPlayClient;
+import net.minecraft.command.server.CommandBlockLogic;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.IMerchant;
+import net.minecraft.entity.item.EntityItem;
+import net.minecraft.entity.item.EntityMinecart;
+import net.minecraft.entity.passive.EntityHorse;
+import net.minecraft.init.Items;
+import net.minecraft.inventory.IInventory;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemStack;
+import net.minecraft.network.play.client.*;
+import net.minecraft.potion.Potion;
+import net.minecraft.stats.StatBase;
+import net.minecraft.stats.StatFileWriter;
+import net.minecraft.tileentity.TileEntitySign;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.DamageSource;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.EnumParticleTypes;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.MovementInput;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.world.IInteractionObject;
+import net.minecraft.world.World;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.ChatOutputEvent;
+import tk.wurst_client.events.UpdateEvent;
+import tk.wurst_client.mods.BlinkMod;
+import tk.wurst_client.mods.FreecamMod;
+import tk.wurst_client.mods.NoSlowdownMod;
+import tk.wurst_client.mods.RemoteViewMod;
+
+public class EntityPlayerSP extends AbstractClientPlayer
+{
+    public final NetHandlerPlayClient sendQueue;
+    private final StatFileWriter field_146108_bO;
+    private double field_175172_bI;
+    private double field_175166_bJ;
+    private double field_175167_bK;
+    private float field_175164_bL;
+    private float field_175165_bM;
+    private boolean field_175170_bN;
+    private boolean field_175171_bO;
+    private int field_175168_bP;
+    private boolean field_175169_bQ;
+    private String clientBrand;
+    public MovementInput movementInput;
+    protected Minecraft mc;
+
+    /**
+     * Used to tell if the player pressed forward twice. If this is at 0 and it's pressed (And they are allowed to
+     * sprint, aka enough food on the ground etc) it sets this to 7. If it's pressed and it's greater than 0 enable
+     * sprinting.
+     */
+    protected int sprintToggleTimer;
+
+    /** Ticks left before sprinting is disabled. */
+    public int sprintingTicksLeft;
+    public float renderArmYaw;
+    public float renderArmPitch;
+    public float prevRenderArmYaw;
+    public float prevRenderArmPitch;
+    private int horseJumpPowerCounter;
+    private float horseJumpPower;
+
+    /** The amount of time an entity has been in a Portal */
+    public float timeInPortal;
+
+    /** The amount of time an entity has been in a Portal the previous tick */
+    public float prevTimeInPortal;
+    private static final String __OBFID = "CL_00000938";
+
+    public EntityPlayerSP(Minecraft mcIn, World worldIn, NetHandlerPlayClient p_i46278_3_, StatFileWriter p_i46278_4_)
+    {
+        super(worldIn, p_i46278_3_.func_175105_e());
+        this.sendQueue = p_i46278_3_;
+        this.field_146108_bO = p_i46278_4_;
+        this.mc = mcIn;
+        this.dimension = 0;
+    }
+
+    /**
+     * Called when the entity is attacked.
+     */
+    public boolean attackEntityFrom(DamageSource source, float amount)
+    {
+        return false;
+    }
+
+    /**
+     * Heal living entity (param: amount of half-hearts)
+     */
+    public void heal(float p_70691_1_) {}
+
+    /**
+     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
+     */
+    public void mountEntity(Entity entityIn)
+    {
+        super.mountEntity(entityIn);
+
+        if (entityIn instanceof EntityMinecart)
+        {
+            this.mc.getSoundHandler().playSound(new MovingSoundMinecartRiding(this, (EntityMinecart)entityIn));
+        }
+    }
+
+    /**
+     * Called to update the entity's position/logic.
+     */
+    public void onUpdate()
+    {
+        if (this.worldObj.isBlockLoaded(new BlockPos(this.posX, 0.0D, this.posZ)))
+        {
+        	//TODO: Client
+        	WurstClient.INSTANCE.eventManager.fireEvent(UpdateEvent.class, new UpdateEvent());
+        	
+            super.onUpdate();
+
+            if (this.isRiding())
+            {
+                this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(this.rotationYaw, this.rotationPitch, this.onGround));
+                this.sendQueue.addToSendQueue(new C0CPacketInput(this.moveStrafing, this.moveForward, this.movementInput.jump, this.movementInput.sneak));
+            }
+            else
+            {
+                this.sendMotionUpdates();
+            }
+        }
+    }
+
+    public void sendMotionUpdates()
+    {
+        boolean var1 = this.isSprinting();
+
+        if (var1 != this.field_175171_bO)
+        {
+            if (var1)
+            {
+                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SPRINTING));
+            }
+            else
+            {
+                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SPRINTING));
+            }
+
+            this.field_175171_bO = var1;
+        }
+
+        boolean var2 = this.isSneaking();
+
+        if (var2 != this.field_175170_bN)
+        {
+            if (var2)
+            {
+                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SNEAKING));
+            }
+            else
+            {
+                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SNEAKING));
+            }
+
+            this.field_175170_bN = var2;
+        }
+
+        if (this.func_175160_A())
+        {
+            double var3 = this.posX - this.field_175172_bI;
+            double var5 = this.getEntityBoundingBox().minY - this.field_175166_bJ;
+            double var7 = this.posZ - this.field_175167_bK;
+            double var9 = (double)(this.rotationYaw - this.field_175164_bL);
+            double var11 = (double)(this.rotationPitch - this.field_175165_bM);
+            boolean var13 = var3 * var3 + var5 * var5 + var7 * var7 > 9.0E-4D || this.field_175168_bP >= 20;
+            boolean var14 = var9 != 0.0D || var11 != 0.0D;
+
+            //TODO: Client
+            //Stops motion updates
+            if
+            (
+            	WurstClient.INSTANCE.modManager.getModByClass(RemoteViewMod.class).isEnabled()
+            	|| WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled()
+            )
+            {
+            	
+            }else if (WurstClient.INSTANCE.modManager.getModByClass(BlinkMod.class).isEnabled())
+            {//Redirects motion updates to the Blink queue
+            	if (var13 && var14)
+                {
+                    BlinkMod.addToBlinkQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.rotationYaw, this.rotationPitch, this.onGround));
+                }
+                else if (var13)
+                {
+                	BlinkMod.addToBlinkQueue(new C03PacketPlayer.C04PacketPlayerPosition(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.onGround));
+                }
+                else if (var14)
+                {
+                	BlinkMod.addToBlinkQueue(new C03PacketPlayer.C05PacketPlayerLook(this.rotationYaw, this.rotationPitch, this.onGround));
+                }
+                else
+                {
+                	BlinkMod.addToBlinkQueue(new C03PacketPlayer(this.onGround));
+                }
+			}else if(this.ridingEntity == null)
+            {
+                if (var13 && var14)
+                {
+                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.rotationYaw, this.rotationPitch, this.onGround));
+                }
+                else if (var13)
+                {
+                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.onGround));
+                }
+                else if (var14)
+                {
+                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(this.rotationYaw, this.rotationPitch, this.onGround));
+                }
+                else
+                {
+                    this.sendQueue.addToSendQueue(new C03PacketPlayer(this.onGround));
+                }
+            }else
+            {
+                this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.motionX, -999.0D, this.motionZ, this.rotationYaw, this.rotationPitch, this.onGround));
+                var13 = false;
+            }
+
+            ++this.field_175168_bP;
+
+            if (var13)
+            {
+                this.field_175172_bI = this.posX;
+                this.field_175166_bJ = this.getEntityBoundingBox().minY;
+                this.field_175167_bK = this.posZ;
+                this.field_175168_bP = 0;
+            }
+
+            if (var14)
+            {
+                this.field_175164_bL = this.rotationYaw;
+                this.field_175165_bM = this.rotationPitch;
+            }
+        }
+    }
+
+    /**
+     * Called when player presses the drop item key
+     */
+    public EntityItem dropOneItem(boolean p_71040_1_)
+    {
+        C07PacketPlayerDigging.Action var2 = p_71040_1_ ? C07PacketPlayerDigging.Action.DROP_ALL_ITEMS : C07PacketPlayerDigging.Action.DROP_ITEM;
+        this.sendQueue.addToSendQueue(new C07PacketPlayerDigging(var2, BlockPos.ORIGIN, EnumFacing.DOWN));
+        return null;
+    }
+
+    /**
+     * Joins the passed in entity item with the world. Args: entityItem
+     */
+    protected void joinEntityItemWithWorld(EntityItem p_71012_1_) {}
+
+    /**
+     * Sends a chat message from the player. Args: chatMessage
+     */
+    public void sendChatMessage(String p_71165_1_)
+    {
+        //TODO: Client
+      	ChatOutputEvent event = new ChatOutputEvent(p_71165_1_, false);
+      	WurstClient.INSTANCE.cmdManager.onSentMessage(event);
+      	WurstClient.INSTANCE.eventManager.fireEvent(ChatOutputEvent.class, event);
+      	if(event.isCancelled())
+      		return;
+      	
+        this.sendQueue.addToSendQueue(new C01PacketChatMessage(p_71165_1_));
+    }
+
+    /**
+     * Sends a chat message from the player. Args: chatMessage
+     */
+    public void sendAutomaticChatMessage(String message)
+    {
+        //TODO: Client
+      	ChatOutputEvent event = new ChatOutputEvent(message, true);
+      	WurstClient.INSTANCE.cmdManager.onSentMessage(event);
+      	WurstClient.INSTANCE.eventManager.fireEvent(ChatOutputEvent.class, event);
+      	if(event.isCancelled())
+      		return;
+      	
+        this.sendQueue.addToSendQueue(new C01PacketChatMessage(message));
+    }
+
+    /**
+     * Swings the item the player is holding.
+     */
+    public void swingItem()
+    {
+        super.swingItem();
+        this.sendQueue.addToSendQueue(new C0APacketAnimation());
+    }
+
+    public void respawnPlayer()
+    {
+        this.sendQueue.addToSendQueue(new C16PacketClientStatus(C16PacketClientStatus.EnumState.PERFORM_RESPAWN));
+    }
+
+    /**
+     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
+     * second with the reduced value. Args: damageAmount
+     */
+    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
+    {
+        if (!this.func_180431_b(p_70665_1_))
+        {
+            this.setHealth(this.getHealth() - p_70665_2_);
+        }
+    }
+
+    /**
+     * set current crafting inventory back to the 2x2 square
+     */
+    public void closeScreen()
+    {
+        this.sendQueue.addToSendQueue(new C0DPacketCloseWindow(this.openContainer.windowId));
+        this.func_175159_q();
+    }
+
+    public void func_175159_q()
+    {
+        this.inventory.setItemStack((ItemStack)null);
+        super.closeScreen();
+        this.mc.displayGuiScreen((GuiScreen)null);
+    }
+
+    /**
+     * Updates health locally.
+     */
+    public void setPlayerSPHealth(float p_71150_1_)
+    {
+        if (this.field_175169_bQ)
+        {
+            float var2 = this.getHealth() - p_71150_1_;
+
+            if (var2 <= 0.0F)
+            {
+                this.setHealth(p_71150_1_);
+
+                if (var2 < 0.0F)
+                {
+                    this.hurtResistantTime = this.maxHurtResistantTime / 2;
+                }
+            }
+            else
+            {
+                this.lastDamage = var2;
+                this.setHealth(this.getHealth());
+                this.hurtResistantTime = this.maxHurtResistantTime;
+                this.damageEntity(DamageSource.generic, var2);
+                this.hurtTime = this.maxHurtTime = 10;
+            }
+        }
+        else
+        {
+            this.setHealth(p_71150_1_);
+            this.field_175169_bQ = true;
+        }
+    }
+
+    /**
+     * Adds a value to a statistic field.
+     */
+    public void addStat(StatBase p_71064_1_, int p_71064_2_)
+    {
+        if (p_71064_1_ != null)
+        {
+            if (p_71064_1_.isIndependent)
+            {
+                super.addStat(p_71064_1_, p_71064_2_);
+            }
+        }
+    }
+
+    /**
+     * Sends the player's abilities to the server (if there is one).
+     */
+    public void sendPlayerAbilities()
+    {
+        this.sendQueue.addToSendQueue(new C13PacketPlayerAbilities(this.capabilities));
+    }
+
+    public boolean func_175144_cb()
+    {
+        return true;
+    }
+
+    protected void sendHorseJump()
+    {
+        this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.RIDING_JUMP, (int)(this.getHorseJumpPower() * 100.0F)));
+    }
+
+    public void func_175163_u()
+    {
+        this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.OPEN_INVENTORY));
+    }
+
+    public void func_175158_f(String p_175158_1_)
+    {
+        this.clientBrand = p_175158_1_;
+    }
+
+    public String getClientBrand()
+    {
+        return this.clientBrand;
+    }
+
+    public StatFileWriter getStatFileWriter()
+    {
+        return this.field_146108_bO;
+    }
+
+    public void addChatComponentMessage(IChatComponent p_146105_1_)
+    {
+        this.mc.ingameGUI.getChatGUI().printChatMessage(p_146105_1_);
+    }
+
+    protected boolean pushOutOfBlocks(double x, double y, double z)
+    {
+        if (this.noClip)
+        {
+            return false;
+        }
+        else
+        {
+            BlockPos var7 = new BlockPos(x, y, z);
+            double var8 = x - (double)var7.getX();
+            double var10 = z - (double)var7.getZ();
+
+            if (!this.func_175162_d(var7))
+            {
+                byte var12 = -1;
+                double var13 = 9999.0D;
+
+                if (this.func_175162_d(var7.offsetWest()) && var8 < var13)
+                {
+                    var13 = var8;
+                    var12 = 0;
+                }
+
+                if (this.func_175162_d(var7.offsetEast()) && 1.0D - var8 < var13)
+                {
+                    var13 = 1.0D - var8;
+                    var12 = 1;
+                }
+
+                if (this.func_175162_d(var7.offsetNorth()) && var10 < var13)
+                {
+                    var13 = var10;
+                    var12 = 4;
+                }
+
+                if (this.func_175162_d(var7.offsetSouth()) && 1.0D - var10 < var13)
+                {
+                    var13 = 1.0D - var10;
+                    var12 = 5;
+                }
+
+                float var15 = 0.1F;
+
+                if (var12 == 0)
+                {
+                    this.motionX = (double)(-var15);
+                }
+
+                if (var12 == 1)
+                {
+                    this.motionX = (double)var15;
+                }
+
+                if (var12 == 4)
+                {
+                    this.motionZ = (double)(-var15);
+                }
+
+                if (var12 == 5)
+                {
+                    this.motionZ = (double)var15;
+                }
+            }
+
+            return false;
+        }
+    }
+
+    private boolean func_175162_d(BlockPos p_175162_1_)
+    {
+        return !this.worldObj.getBlockState(p_175162_1_).getBlock().isNormalCube() && !this.worldObj.getBlockState(p_175162_1_.offsetUp()).getBlock().isNormalCube();
+    }
+
+    /**
+     * Set sprinting switch for Entity.
+     */
+    public void setSprinting(boolean sprinting)
+    {
+        super.setSprinting(sprinting);
+        this.sprintingTicksLeft = sprinting ? 600 : 0;
+    }
+
+    /**
+     * Sets the current XP, total XP, and level number.
+     */
+    public void setXPStats(float p_71152_1_, int p_71152_2_, int p_71152_3_)
+    {
+        this.experience = p_71152_1_;
+        this.experienceTotal = p_71152_2_;
+        this.experienceLevel = p_71152_3_;
+    }
+
+    /**
+     * Notifies this sender of some sort of information.  This is for messages intended to display to the user.  Used
+     * for typical output (like "you asked for whether or not this game rule is set, so here's your answer"), warnings
+     * (like "I fetched this block for you by ID, but I'd like you to know that every time you do this, I die a little
+     * inside"), and errors (like "it's not called iron_pixacke, silly").
+     */
+    public void addChatMessage(IChatComponent message)
+    {
+        this.mc.ingameGUI.getChatGUI().printChatMessage(message);
+    }
+
+    /**
+     * Returns true if the command sender is allowed to use the given command.
+     */
+    public boolean canCommandSenderUseCommand(int permissionLevel, String command)
+    {
+        return permissionLevel <= 0;
+    }
+
+    public BlockPos getPosition()
+    {
+        return new BlockPos(this.posX + 0.5D, this.posY + 0.5D, this.posZ + 0.5D);
+    }
+
+    public void playSound(String name, float volume, float pitch)
+    {
+        this.worldObj.playSound(this.posX, this.posY, this.posZ, name, volume, pitch, false);
+    }
+
+    /**
+     * Returns whether the entity is in a server world
+     */
+    public boolean isServerWorld()
+    {
+        return true;
+    }
+
+    public boolean isRidingHorse()
+    {
+        return this.ridingEntity != null && this.ridingEntity instanceof EntityHorse && ((EntityHorse)this.ridingEntity).isHorseSaddled();
+    }
+
+    public float getHorseJumpPower()
+    {
+        return this.horseJumpPower;
+    }
+
+    public void func_175141_a(TileEntitySign p_175141_1_)
+    {
+        this.mc.displayGuiScreen(new GuiEditSign(p_175141_1_));
+    }
+
+    public void func_146095_a(CommandBlockLogic p_146095_1_)
+    {
+        this.mc.displayGuiScreen(new GuiCommandBlock(p_146095_1_));
+    }
+
+    /**
+     * Displays the GUI for interacting with a book.
+     */
+    public void displayGUIBook(ItemStack bookStack)
+    {
+        Item var2 = bookStack.getItem();
+
+        if (var2 == Items.writable_book)
+        {
+            this.mc.displayGuiScreen(new GuiScreenBook(this, bookStack, true));
+        }
+    }
+
+    /**
+     * Displays the GUI for interacting with a chest inventory. Args: chestInventory
+     */
+    public void displayGUIChest(IInventory chestInventory)
+    {
+        String var2 = chestInventory instanceof IInteractionObject ? ((IInteractionObject)chestInventory).getGuiID() : "minecraft:container";
+
+        if ("minecraft:chest".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiChest(this.inventory, chestInventory));
+        }
+        else if ("minecraft:hopper".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiHopper(this.inventory, chestInventory));
+        }
+        else if ("minecraft:furnace".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiFurnace(this.inventory, chestInventory));
+        }
+        else if ("minecraft:brewing_stand".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiBrewingStand(this.inventory, chestInventory));
+        }
+        else if ("minecraft:beacon".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiBeacon(this.inventory, chestInventory));
+        }
+        else if (!"minecraft:dispenser".equals(var2) && !"minecraft:dropper".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiChest(this.inventory, chestInventory));
+        }
+        else
+        {
+            this.mc.displayGuiScreen(new GuiDispenser(this.inventory, chestInventory));
+        }
+    }
+
+    public void displayGUIHorse(EntityHorse p_110298_1_, IInventory p_110298_2_)
+    {
+        this.mc.displayGuiScreen(new GuiScreenHorseInventory(this.inventory, p_110298_2_, p_110298_1_));
+    }
+
+    public void displayGui(IInteractionObject guiOwner)
+    {
+        String var2 = guiOwner.getGuiID();
+
+        if ("minecraft:crafting_table".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiCrafting(this.inventory, this.worldObj));
+        }
+        else if ("minecraft:enchanting_table".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiEnchantment(this.inventory, this.worldObj, guiOwner));
+        }
+        else if ("minecraft:anvil".equals(var2))
+        {
+            this.mc.displayGuiScreen(new GuiRepair(this.inventory, this.worldObj));
+        }
+    }
+
+    public void displayVillagerTradeGui(IMerchant villager)
+    {
+        this.mc.displayGuiScreen(new GuiMerchant(this.inventory, villager, this.worldObj));
+    }
+
+    /**
+     * Called when the player performs a critical hit on the Entity. Args: entity that was hit critically
+     */
+    public void onCriticalHit(Entity p_71009_1_)
+    {
+        this.mc.effectRenderer.func_178926_a(p_71009_1_, EnumParticleTypes.CRIT);
+    }
+
+    public void onEnchantmentCritical(Entity p_71047_1_)
+    {
+        this.mc.effectRenderer.func_178926_a(p_71047_1_, EnumParticleTypes.CRIT_MAGIC);
+    }
+
+    /**
+     * Returns if this entity is sneaking.
+     */
+    public boolean isSneaking()
+    {
+        boolean var1 = this.movementInput != null ? this.movementInput.sneak : false;
+        return var1 && !this.sleeping;
+    }
+
+    public void updateEntityActionState()
+    {
+        super.updateEntityActionState();
+
+        if (this.func_175160_A())
+        {
+            this.moveStrafing = this.movementInput.moveStrafe;
+            this.moveForward = this.movementInput.moveForward;
+            this.isJumping = this.movementInput.jump;
+            this.prevRenderArmYaw = this.renderArmYaw;
+            this.prevRenderArmPitch = this.renderArmPitch;
+            this.renderArmPitch = (float)((double)this.renderArmPitch + (double)(this.rotationPitch - this.renderArmPitch) * 0.5D);
+            this.renderArmYaw = (float)((double)this.renderArmYaw + (double)(this.rotationYaw - this.renderArmYaw) * 0.5D);
+        }
+    }
+
+    protected boolean func_175160_A()
+    {
+        return this.mc.func_175606_aa() == this;
+    }
+
+    /**
+     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
+     * use this to react to sunlight and start to burn.
+     */
+    public void onLivingUpdate()
+    {
+        if (this.sprintingTicksLeft > 0)
+        {
+            --this.sprintingTicksLeft;
+
+            if (this.sprintingTicksLeft == 0)
+            {
+                this.setSprinting(false);
+            }
+        }
+
+        if (this.sprintToggleTimer > 0)
+        {
+            --this.sprintToggleTimer;
+        }
+
+        this.prevTimeInPortal = this.timeInPortal;
+
+        if (this.inPortal)
+        {
+            if (this.mc.currentScreen != null && !this.mc.currentScreen.doesGuiPauseGame())
+            {
+                this.mc.displayGuiScreen((GuiScreen)null);
+            }
+
+            if (this.timeInPortal == 0.0F)
+            {
+                this.mc.getSoundHandler().playSound(PositionedSoundRecord.createPositionedSoundRecord(new ResourceLocation("portal.trigger"), this.rand.nextFloat() * 0.4F + 0.8F));
+            }
+
+            this.timeInPortal += 0.0125F;
+
+            if (this.timeInPortal >= 1.0F)
+            {
+                this.timeInPortal = 1.0F;
+            }
+
+            this.inPortal = false;
+        }
+        else if (this.isPotionActive(Potion.confusion) && this.getActivePotionEffect(Potion.confusion).getDuration() > 60)
+        {
+            this.timeInPortal += 0.006666667F;
+
+            if (this.timeInPortal > 1.0F)
+            {
+                this.timeInPortal = 1.0F;
+            }
+        }
+        else
+        {
+            if (this.timeInPortal > 0.0F)
+            {
+                this.timeInPortal -= 0.05F;
+            }
+
+            if (this.timeInPortal < 0.0F)
+            {
+                this.timeInPortal = 0.0F;
+            }
+        }
+
+        if (this.timeUntilPortal > 0)
+        {
+            --this.timeUntilPortal;
+        }
+
+        boolean var1 = this.movementInput.jump;
+        boolean var2 = this.movementInput.sneak;
+        float var3 = 0.8F;
+        boolean var4 = this.movementInput.moveForward >= var3;
+        this.movementInput.updatePlayerMoveState();
+
+        //TODO: Client
+        if (this.isUsingItem() && !this.isRiding()
+        	&& !WurstClient.INSTANCE.modManager.getModByClass(NoSlowdownMod.class).isEnabled())
+        {
+            this.movementInput.moveStrafe *= 0.2F;
+            this.movementInput.moveForward *= 0.2F;
+            this.sprintToggleTimer = 0;
+        }
+
+        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
+        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
+        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
+        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
+        boolean var5 = (float)this.getFoodStats().getFoodLevel() > 6.0F || this.capabilities.allowFlying;
+
+        if (this.onGround && !var2 && !var4 && this.movementInput.moveForward >= var3 && !this.isSprinting() && var5 && !this.isUsingItem() && !this.isPotionActive(Potion.blindness))
+        {
+            if (this.sprintToggleTimer <= 0 && !this.mc.gameSettings.keyBindSprint.getIsKeyPressed())
+            {
+                this.sprintToggleTimer = 7;
+            }
+            else
+            {
+                this.setSprinting(true);
+            }
+        }
+
+        if (!this.isSprinting() && this.movementInput.moveForward >= var3 && var5 && !this.isUsingItem() && !this.isPotionActive(Potion.blindness) && this.mc.gameSettings.keyBindSprint.getIsKeyPressed())
+        {
+            this.setSprinting(true);
+        }
+
+        if (this.isSprinting() && (this.movementInput.moveForward < var3 || this.isCollidedHorizontally || !var5))
+        {
+            this.setSprinting(false);
+        }
+
+        if (this.capabilities.allowFlying)
+        {
+            if (this.mc.playerController.isSpectatorMode())
+            {
+                if (!this.capabilities.isFlying)
+                {
+                    this.capabilities.isFlying = true;
+                    this.sendPlayerAbilities();
+                }
+            }
+            else if (!var1 && this.movementInput.jump)
+            {
+                if (this.flyToggleTimer == 0)
+                {
+                    this.flyToggleTimer = 7;
+                }
+                else
+                {
+                    this.capabilities.isFlying = !this.capabilities.isFlying;
+                    this.sendPlayerAbilities();
+                    this.flyToggleTimer = 0;
+                }
+            }
+        }
+
+        if (this.capabilities.isFlying && this.func_175160_A())
+        {
+            if (this.movementInput.sneak)
+            {
+                this.motionY -= (double)(this.capabilities.getFlySpeed() * 3.0F);
+            }
+
+            if (this.movementInput.jump)
+            {
+                this.motionY += (double)(this.capabilities.getFlySpeed() * 3.0F);
+            }
+        }
+
+        if (this.isRidingHorse())
+        {
+            if (this.horseJumpPowerCounter < 0)
+            {
+                ++this.horseJumpPowerCounter;
+
+                if (this.horseJumpPowerCounter == 0)
+                {
+                    this.horseJumpPower = 0.0F;
+                }
+            }
+
+            if (var1 && !this.movementInput.jump)
+            {
+                this.horseJumpPowerCounter = -10;
+                this.sendHorseJump();
+            }
+            else if (!var1 && this.movementInput.jump)
+            {
+                this.horseJumpPowerCounter = 0;
+                this.horseJumpPower = 0.0F;
+            }
+            else if (var1)
+            {
+                ++this.horseJumpPowerCounter;
+
+                if (this.horseJumpPowerCounter < 10)
+                {
+                    this.horseJumpPower = (float)this.horseJumpPowerCounter * 0.1F;
+                }
+                else
+                {
+                    this.horseJumpPower = 0.8F + 2.0F / (float)(this.horseJumpPowerCounter - 9) * 0.1F;
+                }
+            }
+        }
+        else
+        {
+            this.horseJumpPower = 0.0F;
+        }
+
+        super.onLivingUpdate();
+
+        if (this.onGround && this.capabilities.isFlying && !this.mc.playerController.isSpectatorMode())
+        {
+            this.capabilities.isFlying = false;
+            this.sendPlayerAbilities();
+        }
+    }
+}
diff --git a/src/net/minecraft/client/gui/FontRenderer.java b/src/net/minecraft/client/gui/FontRenderer.java
index 2d4215d..35063da 100644
--- a/src/net/minecraft/client/gui/FontRenderer.java
+++ b/src/net/minecraft/client/gui/FontRenderer.java
@@ -1,984 +1,1010 @@
-package net.minecraft.client.gui;
-
-import com.ibm.icu.text.ArabicShaping;
-import com.ibm.icu.text.ArabicShapingException;
-import com.ibm.icu.text.Bidi;
-import java.awt.image.BufferedImage;
-import java.io.IOException;
-import java.io.InputStream;
-import java.util.Arrays;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Random;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.texture.TextureManager;
-import net.minecraft.client.renderer.texture.TextureUtil;
-import net.minecraft.client.resources.IResourceManager;
-import net.minecraft.client.resources.IResourceManagerReloadListener;
-import net.minecraft.client.settings.GameSettings;
-import net.minecraft.util.ResourceLocation;
-import org.apache.commons.io.IOUtils;
-import org.lwjgl.opengl.GL11;
-
-public class FontRenderer implements IResourceManagerReloadListener
-{
-    private static final ResourceLocation[] unicodePageLocations = new ResourceLocation[256];
-
-    /** Array of width of all the characters in default.png */
-    private int[] charWidth = new int[256];
-
-    /** the height in pixels of default text */
-    public int FONT_HEIGHT = 9;
-    public Random fontRandom = new Random();
-
-    /**
-     * Array of the start/end column (in upper/lower nibble) for every glyph in the /font directory.
-     */
-    private byte[] glyphWidth = new byte[65536];
-
-    /**
-     * Array of RGB triplets defining the 16 standard chat colors followed by 16 darker version of the same colors for
-     * drop shadows.
-     */
-    private int[] colorCode = new int[32];
-    private final ResourceLocation locationFontTexture;
-
-    /** The RenderEngine used to load and setup glyph textures. */
-    private final TextureManager renderEngine;
-
-    /** Current X coordinate at which to draw the next character. */
-    private float posX;
-
-    /** Current Y coordinate at which to draw the next character. */
-    private float posY;
-
-    /**
-     * If true, strings should be rendered with Unicode fonts instead of the default.png font
-     */
-    private boolean unicodeFlag;
-
-    /**
-     * If true, the Unicode Bidirectional Algorithm should be run before rendering any string.
-     */
-    private boolean bidiFlag;
-
-    /** Used to specify new red value for the current color. */
-    private float red;
-
-    /** Used to specify new blue value for the current color. */
-    private float blue;
-
-    /** Used to specify new green value for the current color. */
-    private float green;
-
-    /** Used to speify new alpha value for the current color. */
-    private float alpha;
-
-    /** Text color of the currently rendering string. */
-    private int textColor;
-
-    /** Set if the "k" style (random) is active in currently rendering string */
-    private boolean randomStyle;
-
-    /** Set if the "l" style (bold) is active in currently rendering string */
-    private boolean boldStyle;
-
-    /** Set if the "o" style (italic) is active in currently rendering string */
-    private boolean italicStyle;
-
-    /**
-     * Set if the "n" style (underlined) is active in currently rendering string
-     */
-    private boolean underlineStyle;
-
-    /**
-     * Set if the "m" style (strikethrough) is active in currently rendering string
-     */
-    private boolean strikethroughStyle;
-    private static final String __OBFID = "CL_00000660";
-
-    public FontRenderer(GameSettings p_i1035_1_, ResourceLocation p_i1035_2_, TextureManager p_i1035_3_, boolean p_i1035_4_)
-    {
-        this.locationFontTexture = p_i1035_2_;
-        this.renderEngine = p_i1035_3_;
-        this.unicodeFlag = p_i1035_4_;
-        p_i1035_3_.bindTexture(this.locationFontTexture);
-
-        for (int var5 = 0; var5 < 32; ++var5)
-        {
-            int var6 = (var5 >> 3 & 1) * 85;
-            int var7 = (var5 >> 2 & 1) * 170 + var6;
-            int var8 = (var5 >> 1 & 1) * 170 + var6;
-            int var9 = (var5 >> 0 & 1) * 170 + var6;
-
-            if (var5 == 6)
-            {
-                var7 += 85;
-            }
-
-            if (p_i1035_1_.anaglyph)
-            {
-                int var10 = (var7 * 30 + var8 * 59 + var9 * 11) / 100;
-                int var11 = (var7 * 30 + var8 * 70) / 100;
-                int var12 = (var7 * 30 + var9 * 70) / 100;
-                var7 = var10;
-                var8 = var11;
-                var9 = var12;
-            }
-
-            if (var5 >= 16)
-            {
-                var7 /= 4;
-                var8 /= 4;
-                var9 /= 4;
-            }
-
-            this.colorCode[var5] = (var7 & 255) << 16 | (var8 & 255) << 8 | var9 & 255;
-        }
-
-        this.readGlyphSizes();
-    }
-
-    public void onResourceManagerReload(IResourceManager p_110549_1_)
-    {
-        this.readFontTexture();
-    }
-
-    private void readFontTexture()
-    {
-        BufferedImage var1;
-
-        try
-        {
-            var1 = TextureUtil.func_177053_a(Minecraft.getMinecraft().getResourceManager().getResource(this.locationFontTexture).getInputStream());
-        }
-        catch (IOException var17)
-        {
-            throw new RuntimeException(var17);
-        }
-
-        int var2 = var1.getWidth();
-        int var3 = var1.getHeight();
-        int[] var4 = new int[var2 * var3];
-        var1.getRGB(0, 0, var2, var3, var4, 0, var2);
-        int var5 = var3 / 16;
-        int var6 = var2 / 16;
-        byte var7 = 1;
-        float var8 = 8.0F / (float)var6;
-        int var9 = 0;
-
-        while (var9 < 256)
-        {
-            int var10 = var9 % 16;
-            int var11 = var9 / 16;
-
-            if (var9 == 32)
-            {
-                this.charWidth[var9] = 3 + var7;
-            }
-
-            int var12 = var6 - 1;
-
-            while (true)
-            {
-                if (var12 >= 0)
-                {
-                    int var13 = var10 * var6 + var12;
-                    boolean var14 = true;
-
-                    for (int var15 = 0; var15 < var5 && var14; ++var15)
-                    {
-                        int var16 = (var11 * var6 + var15) * var2;
-
-                        if ((var4[var13 + var16] >> 24 & 255) != 0)
-                        {
-                            var14 = false;
-                        }
-                    }
-
-                    if (var14)
-                    {
-                        --var12;
-                        continue;
-                    }
-                }
-
-                ++var12;
-                this.charWidth[var9] = (int)(0.5D + (double)((float)var12 * var8)) + var7;
-                ++var9;
-                break;
-            }
-        }
-    }
-
-    private void readGlyphSizes()
-    {
-        InputStream var1 = null;
-
-        try
-        {
-            var1 = Minecraft.getMinecraft().getResourceManager().getResource(new ResourceLocation("font/glyph_sizes.bin")).getInputStream();
-            var1.read(this.glyphWidth);
-        }
-        catch (IOException var6)
-        {
-            throw new RuntimeException(var6);
-        }
-        finally
-        {
-            IOUtils.closeQuietly(var1);
-        }
-    }
-
-    /**
-     * Pick how to render a single character and return the width used.
-     */
-    private float renderCharAtPos(int p_78278_1_, char p_78278_2_, boolean p_78278_3_)
-    {
-        return p_78278_2_ == 32 ? 4.0F : ("\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(p_78278_2_) != -1 && !this.unicodeFlag ? this.renderDefaultChar(p_78278_1_, p_78278_3_) : this.renderUnicodeChar(p_78278_2_, p_78278_3_));
-    }
-
-    /**
-     * Render a single character with the default.png font at current (posX,posY) location...
-     */
-    private float renderDefaultChar(int p_78266_1_, boolean p_78266_2_)
-    {
-        float var3 = (float)(p_78266_1_ % 16 * 8);
-        float var4 = (float)(p_78266_1_ / 16 * 8);
-        float var5 = p_78266_2_ ? 1.0F : 0.0F;
-        this.renderEngine.bindTexture(this.locationFontTexture);
-        float var6 = (float)this.charWidth[p_78266_1_] - 0.01F;
-        GL11.glBegin(GL11.GL_TRIANGLE_STRIP);
-        GL11.glTexCoord2f(var3 / 128.0F, var4 / 128.0F);
-        GL11.glVertex3f(this.posX + var5, this.posY, 0.0F);
-        GL11.glTexCoord2f(var3 / 128.0F, (var4 + 7.99F) / 128.0F);
-        GL11.glVertex3f(this.posX - var5, this.posY + 7.99F, 0.0F);
-        GL11.glTexCoord2f((var3 + var6 - 1.0F) / 128.0F, var4 / 128.0F);
-        GL11.glVertex3f(this.posX + var6 - 1.0F + var5, this.posY, 0.0F);
-        GL11.glTexCoord2f((var3 + var6 - 1.0F) / 128.0F, (var4 + 7.99F) / 128.0F);
-        GL11.glVertex3f(this.posX + var6 - 1.0F - var5, this.posY + 7.99F, 0.0F);
-        GL11.glEnd();
-        return (float)this.charWidth[p_78266_1_];
-    }
-
-    private ResourceLocation getUnicodePageLocation(int p_111271_1_)
-    {
-        if (unicodePageLocations[p_111271_1_] == null)
-        {
-            unicodePageLocations[p_111271_1_] = new ResourceLocation(String.format("textures/font/unicode_page_%02x.png", new Object[] {Integer.valueOf(p_111271_1_)}));
-        }
-
-        return unicodePageLocations[p_111271_1_];
-    }
-
-    /**
-     * Load one of the /font/glyph_XX.png into a new GL texture and store the texture ID in glyphTextureName array.
-     */
-    private void loadGlyphTexture(int p_78257_1_)
-    {
-        this.renderEngine.bindTexture(this.getUnicodePageLocation(p_78257_1_));
-    }
-
-    /**
-     * Render a single Unicode character at current (posX,posY) location using one of the /font/glyph_XX.png files...
-     */
-    private float renderUnicodeChar(char p_78277_1_, boolean p_78277_2_)
-    {
-        if (this.glyphWidth[p_78277_1_] == 0)
-        {
-            return 0.0F;
-        }
-        else
-        {
-            int var3 = p_78277_1_ / 256;
-            this.loadGlyphTexture(var3);
-            int var4 = this.glyphWidth[p_78277_1_] >>> 4;
-            int var5 = this.glyphWidth[p_78277_1_] & 15;
-            float var6 = (float)var4;
-            float var7 = (float)(var5 + 1);
-            float var8 = (float)(p_78277_1_ % 16 * 16) + var6;
-            float var9 = (float)((p_78277_1_ & 255) / 16 * 16);
-            float var10 = var7 - var6 - 0.02F;
-            float var11 = p_78277_2_ ? 1.0F : 0.0F;
-            GL11.glBegin(GL11.GL_TRIANGLE_STRIP);
-            GL11.glTexCoord2f(var8 / 256.0F, var9 / 256.0F);
-            GL11.glVertex3f(this.posX + var11, this.posY, 0.0F);
-            GL11.glTexCoord2f(var8 / 256.0F, (var9 + 15.98F) / 256.0F);
-            GL11.glVertex3f(this.posX - var11, this.posY + 7.99F, 0.0F);
-            GL11.glTexCoord2f((var8 + var10) / 256.0F, var9 / 256.0F);
-            GL11.glVertex3f(this.posX + var10 / 2.0F + var11, this.posY, 0.0F);
-            GL11.glTexCoord2f((var8 + var10) / 256.0F, (var9 + 15.98F) / 256.0F);
-            GL11.glVertex3f(this.posX + var10 / 2.0F - var11, this.posY + 7.99F, 0.0F);
-            GL11.glEnd();
-            return (var7 - var6) / 2.0F + 1.0F;
-        }
-    }
-
-    public int func_175063_a(String p_175063_1_, float p_175063_2_, float p_175063_3_, int p_175063_4_)
-    {
-        return this.func_175065_a(p_175063_1_, p_175063_2_, p_175063_3_, p_175063_4_, true);
-    }
-
-    /**
-     * Draws the specified string.
-     */
-    public int drawString(String text, int x, int y, int color)
-    {
-        return this.func_175065_a(text, (float)x, (float)y, color, false);
-    }
-
-    public int func_175065_a(String p_175065_1_, float p_175065_2_, float p_175065_3_, int p_175065_4_, boolean p_175065_5_)
-    {
-        GlStateManager.enableAlpha();
-        this.resetStyles();
-        int var6;
-
-        if (p_175065_5_)
-        {
-            var6 = this.func_180455_b(p_175065_1_, p_175065_2_ + 1.0F, p_175065_3_ + 1.0F, p_175065_4_, true);
-            var6 = Math.max(var6, this.func_180455_b(p_175065_1_, p_175065_2_, p_175065_3_, p_175065_4_, false));
-        }
-        else
-        {
-            var6 = this.func_180455_b(p_175065_1_, p_175065_2_, p_175065_3_, p_175065_4_, false);
-        }
-
-        return var6;
-    }
-
-    /**
-     * Apply Unicode Bidirectional Algorithm to string and return a new possibly reordered string for visual rendering.
-     */
-    private String bidiReorder(String p_147647_1_)
-    {
-        try
-        {
-            Bidi var2 = new Bidi((new ArabicShaping(8)).shape(p_147647_1_), 127);
-            var2.setReorderingMode(0);
-            return var2.writeReordered(2);
-        }
-        catch (ArabicShapingException var3)
-        {
-            return p_147647_1_;
-        }
-    }
-
-    /**
-     * Reset all style flag fields in the class to false; called at the start of string rendering
-     */
-    private void resetStyles()
-    {
-        this.randomStyle = false;
-        this.boldStyle = false;
-        this.italicStyle = false;
-        this.underlineStyle = false;
-        this.strikethroughStyle = false;
-    }
-
-    /**
-     * Render a single line string at the current (posX,posY) and update posX
-     */
-    private void renderStringAtPos(String p_78255_1_, boolean p_78255_2_)
-    {
-        for (int var3 = 0; var3 < p_78255_1_.length(); ++var3)
-        {
-            char var4 = p_78255_1_.charAt(var3);
-            int var5;
-            int var6;
-
-            if (var4 == 167 && var3 + 1 < p_78255_1_.length())
-            {
-                var5 = "0123456789abcdefklmnor".indexOf(p_78255_1_.toLowerCase().charAt(var3 + 1));
-
-                if (var5 < 16)
-                {
-                    this.randomStyle = false;
-                    this.boldStyle = false;
-                    this.strikethroughStyle = false;
-                    this.underlineStyle = false;
-                    this.italicStyle = false;
-
-                    if (var5 < 0 || var5 > 15)
-                    {
-                        var5 = 15;
-                    }
-
-                    if (p_78255_2_)
-                    {
-                        var5 += 16;
-                    }
-
-                    var6 = this.colorCode[var5];
-                    this.textColor = var6;
-                    GlStateManager.color((float)(var6 >> 16) / 255.0F, (float)(var6 >> 8 & 255) / 255.0F, (float)(var6 & 255) / 255.0F, this.alpha);
-                }
-                else if (var5 == 16)
-                {
-                    this.randomStyle = true;
-                }
-                else if (var5 == 17)
-                {
-                    this.boldStyle = true;
-                }
-                else if (var5 == 18)
-                {
-                    this.strikethroughStyle = true;
-                }
-                else if (var5 == 19)
-                {
-                    this.underlineStyle = true;
-                }
-                else if (var5 == 20)
-                {
-                    this.italicStyle = true;
-                }
-                else if (var5 == 21)
-                {
-                    this.randomStyle = false;
-                    this.boldStyle = false;
-                    this.strikethroughStyle = false;
-                    this.underlineStyle = false;
-                    this.italicStyle = false;
-                    GlStateManager.color(this.red, this.blue, this.green, this.alpha);
-                }
-
-                ++var3;
-            }
-            else
-            {
-                var5 = "\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(var4);
-
-                if (this.randomStyle && var5 != -1)
-                {
-                    do
-                    {
-                        var6 = this.fontRandom.nextInt(this.charWidth.length);
-                    }
-                    while (this.charWidth[var5] != this.charWidth[var6]);
-
-                    var5 = var6;
-                }
-
-                float var12 = this.unicodeFlag ? 0.5F : 1.0F;
-                boolean var7 = (var4 == 0 || var5 == -1 || this.unicodeFlag) && p_78255_2_;
-
-                if (var7)
-                {
-                    this.posX -= var12;
-                    this.posY -= var12;
-                }
-
-                float var8 = this.renderCharAtPos(var5, var4, this.italicStyle);
-
-                if (var7)
-                {
-                    this.posX += var12;
-                    this.posY += var12;
-                }
-
-                if (this.boldStyle)
-                {
-                    this.posX += var12;
-
-                    if (var7)
-                    {
-                        this.posX -= var12;
-                        this.posY -= var12;
-                    }
-
-                    this.renderCharAtPos(var5, var4, this.italicStyle);
-                    this.posX -= var12;
-
-                    if (var7)
-                    {
-                        this.posX += var12;
-                        this.posY += var12;
-                    }
-
-                    ++var8;
-                }
-
-                Tessellator var9;
-                WorldRenderer var10;
-
-                if (this.strikethroughStyle)
-                {
-                    var9 = Tessellator.getInstance();
-                    var10 = var9.getWorldRenderer();
-                    GlStateManager.func_179090_x();
-                    var10.startDrawingQuads();
-                    var10.addVertex((double)this.posX, (double)(this.posY + (float)(this.FONT_HEIGHT / 2)), 0.0D);
-                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)(this.FONT_HEIGHT / 2)), 0.0D);
-                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)(this.FONT_HEIGHT / 2) - 1.0F), 0.0D);
-                    var10.addVertex((double)this.posX, (double)(this.posY + (float)(this.FONT_HEIGHT / 2) - 1.0F), 0.0D);
-                    var9.draw();
-                    GlStateManager.func_179098_w();
-                }
-
-                if (this.underlineStyle)
-                {
-                    var9 = Tessellator.getInstance();
-                    var10 = var9.getWorldRenderer();
-                    GlStateManager.func_179090_x();
-                    var10.startDrawingQuads();
-                    int var11 = this.underlineStyle ? -1 : 0;
-                    var10.addVertex((double)(this.posX + (float)var11), (double)(this.posY + (float)this.FONT_HEIGHT), 0.0D);
-                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)this.FONT_HEIGHT), 0.0D);
-                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)this.FONT_HEIGHT - 1.0F), 0.0D);
-                    var10.addVertex((double)(this.posX + (float)var11), (double)(this.posY + (float)this.FONT_HEIGHT - 1.0F), 0.0D);
-                    var9.draw();
-                    GlStateManager.func_179098_w();
-                }
-
-                this.posX += (float)((int)var8);
-            }
-        }
-    }
-
-    /**
-     * Render string either left or right aligned depending on bidiFlag
-     */
-    private int renderStringAligned(String p_78274_1_, int p_78274_2_, int p_78274_3_, int p_78274_4_, int p_78274_5_, boolean p_78274_6_)
-    {
-        if (this.bidiFlag)
-        {
-            int var7 = this.getStringWidth(this.bidiReorder(p_78274_1_));
-            p_78274_2_ = p_78274_2_ + p_78274_4_ - var7;
-        }
-
-        return this.func_180455_b(p_78274_1_, (float)p_78274_2_, (float)p_78274_3_, p_78274_5_, p_78274_6_);
-    }
-
-    private int func_180455_b(String p_180455_1_, float p_180455_2_, float p_180455_3_, int p_180455_4_, boolean p_180455_5_)
-    {
-        if (p_180455_1_ == null)
-        {
-            return 0;
-        }
-        else
-        {
-            if (this.bidiFlag)
-            {
-                p_180455_1_ = this.bidiReorder(p_180455_1_);
-            }
-
-            if ((p_180455_4_ & -67108864) == 0)
-            {
-                p_180455_4_ |= -16777216;
-            }
-
-            if (p_180455_5_)
-            {
-                p_180455_4_ = (p_180455_4_ & 16579836) >> 2 | p_180455_4_ & -16777216;
-            }
-
-            this.red = (float)(p_180455_4_ >> 16 & 255) / 255.0F;
-            this.blue = (float)(p_180455_4_ >> 8 & 255) / 255.0F;
-            this.green = (float)(p_180455_4_ & 255) / 255.0F;
-            this.alpha = (float)(p_180455_4_ >> 24 & 255) / 255.0F;
-            GlStateManager.color(this.red, this.blue, this.green, this.alpha);
-            this.posX = p_180455_2_;
-            this.posY = p_180455_3_;
-            this.renderStringAtPos(p_180455_1_, p_180455_5_);
-            return (int)this.posX;
-        }
-    }
-
-    /**
-     * Returns the width of this string. Equivalent of FontMetrics.stringWidth(String s).
-     */
-    public int getStringWidth(String p_78256_1_)
-    {
-        if (p_78256_1_ == null)
-        {
-            return 0;
-        }
-        else
-        {
-            int var2 = 0;
-            boolean var3 = false;
-
-            for (int var4 = 0; var4 < p_78256_1_.length(); ++var4)
-            {
-                char var5 = p_78256_1_.charAt(var4);
-                int var6 = this.getCharWidth(var5);
-
-                if (var6 < 0 && var4 < p_78256_1_.length() - 1)
-                {
-                    ++var4;
-                    var5 = p_78256_1_.charAt(var4);
-
-                    if (var5 != 108 && var5 != 76)
-                    {
-                        if (var5 == 114 || var5 == 82)
-                        {
-                            var3 = false;
-                        }
-                    }
-                    else
-                    {
-                        var3 = true;
-                    }
-
-                    var6 = 0;
-                }
-
-                var2 += var6;
-
-                if (var3 && var6 > 0)
-                {
-                    ++var2;
-                }
-            }
-
-            return var2;
-        }
-    }
-
-    /**
-     * Returns the width of this character as rendered.
-     */
-    public int getCharWidth(char p_78263_1_)
-    {
-        if (p_78263_1_ == 167)
-        {
-            return -1;
-        }
-        else if (p_78263_1_ == 32)
-        {
-            return 4;
-        }
-        else
-        {
-            int var2 = "\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(p_78263_1_);
-
-            if (p_78263_1_ > 0 && var2 != -1 && !this.unicodeFlag)
-            {
-                return this.charWidth[var2];
-            }
-            else if (this.glyphWidth[p_78263_1_] != 0)
-            {
-                int var3 = this.glyphWidth[p_78263_1_] >>> 4;
-                int var4 = this.glyphWidth[p_78263_1_] & 15;
-
-                if (var4 > 7)
-                {
-                    var4 = 15;
-                    var3 = 0;
-                }
-
-                ++var4;
-                return (var4 - var3) / 2 + 1;
-            }
-            else
-            {
-                return 0;
-            }
-        }
-    }
-
-    /**
-     * Trims a string to fit a specified Width.
-     */
-    public String trimStringToWidth(String p_78269_1_, int p_78269_2_)
-    {
-        return this.trimStringToWidth(p_78269_1_, p_78269_2_, false);
-    }
-
-    /**
-     * Trims a string to a specified width, and will reverse it if par3 is set.
-     */
-    public String trimStringToWidth(String p_78262_1_, int p_78262_2_, boolean p_78262_3_)
-    {
-        StringBuilder var4 = new StringBuilder();
-        int var5 = 0;
-        int var6 = p_78262_3_ ? p_78262_1_.length() - 1 : 0;
-        int var7 = p_78262_3_ ? -1 : 1;
-        boolean var8 = false;
-        boolean var9 = false;
-
-        for (int var10 = var6; var10 >= 0 && var10 < p_78262_1_.length() && var5 < p_78262_2_; var10 += var7)
-        {
-            char var11 = p_78262_1_.charAt(var10);
-            int var12 = this.getCharWidth(var11);
-
-            if (var8)
-            {
-                var8 = false;
-
-                if (var11 != 108 && var11 != 76)
-                {
-                    if (var11 == 114 || var11 == 82)
-                    {
-                        var9 = false;
-                    }
-                }
-                else
-                {
-                    var9 = true;
-                }
-            }
-            else if (var12 < 0)
-            {
-                var8 = true;
-            }
-            else
-            {
-                var5 += var12;
-
-                if (var9)
-                {
-                    ++var5;
-                }
-            }
-
-            if (var5 > p_78262_2_)
-            {
-                break;
-            }
-
-            if (p_78262_3_)
-            {
-                var4.insert(0, var11);
-            }
-            else
-            {
-                var4.append(var11);
-            }
-        }
-
-        return var4.toString();
-    }
-
-    /**
-     * Remove all newline characters from the end of the string
-     */
-    private String trimStringNewline(String p_78273_1_)
-    {
-        while (p_78273_1_ != null && p_78273_1_.endsWith("\n"))
-        {
-            p_78273_1_ = p_78273_1_.substring(0, p_78273_1_.length() - 1);
-        }
-
-        return p_78273_1_;
-    }
-
-    /**
-     * Splits and draws a String with wordwrap (maximum length is parameter k)
-     */
-    public void drawSplitString(String str, int x, int y, int wrapWidth, int textColor)
-    {
-        this.resetStyles();
-        this.textColor = textColor;
-        str = this.trimStringNewline(str);
-        this.renderSplitString(str, x, y, wrapWidth, false);
-    }
-
-    /**
-     * Perform actual work of rendering a multi-line string with wordwrap and with darker drop shadow color if flag is
-     * set
-     */
-    private void renderSplitString(String str, int x, int y, int wrapWidth, boolean addShadow)
-    {
-        List var6 = this.listFormattedStringToWidth(str, wrapWidth);
-
-        for (Iterator var7 = var6.iterator(); var7.hasNext(); y += this.FONT_HEIGHT)
-        {
-            String var8 = (String)var7.next();
-            this.renderStringAligned(var8, x, y, wrapWidth, this.textColor, addShadow);
-        }
-    }
-
-    /**
-     * Returns the width of the wordwrapped String (maximum length is parameter k)
-     */
-    public int splitStringWidth(String p_78267_1_, int p_78267_2_)
-    {
-        return this.FONT_HEIGHT * this.listFormattedStringToWidth(p_78267_1_, p_78267_2_).size();
-    }
-
-    /**
-     * Set unicodeFlag controlling whether strings should be rendered with Unicode fonts instead of the default.png
-     * font.
-     */
-    public void setUnicodeFlag(boolean p_78264_1_)
-    {
-        this.unicodeFlag = p_78264_1_;
-    }
-
-    /**
-     * Get unicodeFlag controlling whether strings should be rendered with Unicode fonts instead of the default.png
-     * font.
-     */
-    public boolean getUnicodeFlag()
-    {
-        return this.unicodeFlag;
-    }
-
-    /**
-     * Set bidiFlag to control if the Unicode Bidirectional Algorithm should be run before rendering any string.
-     */
-    public void setBidiFlag(boolean p_78275_1_)
-    {
-        this.bidiFlag = p_78275_1_;
-    }
-
-    /**
-     * Breaks a string into a list of pieces that will fit a specified width.
-     */
-    public List listFormattedStringToWidth(String str, int wrapWidth)
-    {
-        return Arrays.asList(this.wrapFormattedStringToWidth(str, wrapWidth).split("\n"));
-    }
-
-    /**
-     * Inserts newline and formatting into a string to wrap it within the specified width.
-     */
-    String wrapFormattedStringToWidth(String str, int wrapWidth)
-    {
-        int var3 = this.sizeStringToWidth(str, wrapWidth);
-
-        if (str.length() <= var3)
-        {
-            return str;
-        }
-        else
-        {
-            String var4 = str.substring(0, var3);
-            char var5 = str.charAt(var3);
-            boolean var6 = var5 == 32 || var5 == 10;
-            String var7 = getFormatFromString(var4) + str.substring(var3 + (var6 ? 1 : 0));
-            return var4 + "\n" + this.wrapFormattedStringToWidth(var7, wrapWidth);
-        }
-    }
-
-    /**
-     * Determines how many characters from the string will fit into the specified width.
-     */
-    private int sizeStringToWidth(String str, int wrapWidth)
-    {
-        int var3 = str.length();
-        int var4 = 0;
-        int var5 = 0;
-        int var6 = -1;
-
-        for (boolean var7 = false; var5 < var3; ++var5)
-        {
-            char var8 = str.charAt(var5);
-
-            switch (var8)
-            {
-                case 10:
-                    --var5;
-                    break;
-
-                case 167:
-                    if (var5 < var3 - 1)
-                    {
-                        ++var5;
-                        char var9 = str.charAt(var5);
-
-                        if (var9 != 108 && var9 != 76)
-                        {
-                            if (var9 == 114 || var9 == 82 || isFormatColor(var9))
-                            {
-                                var7 = false;
-                            }
-                        }
-                        else
-                        {
-                            var7 = true;
-                        }
-                    }
-
-                    break;
-
-                case 32:
-                    var6 = var5;
-
-                default:
-                    var4 += this.getCharWidth(var8);
-
-                    if (var7)
-                    {
-                        ++var4;
-                    }
-            }
-
-            if (var8 == 10)
-            {
-                ++var5;
-                var6 = var5;
-                break;
-            }
-
-            if (var4 > wrapWidth)
-            {
-                break;
-            }
-        }
-
-        return var5 != var3 && var6 != -1 && var6 < var5 ? var6 : var5;
-    }
-
-    /**
-     * Checks if the char code is a hexadecimal character, used to set colour.
-     */
-    private static boolean isFormatColor(char colorChar)
-    {
-        return colorChar >= 48 && colorChar <= 57 || colorChar >= 97 && colorChar <= 102 || colorChar >= 65 && colorChar <= 70;
-    }
-
-    /**
-     * Checks if the char code is O-K...lLrRk-o... used to set special formatting.
-     */
-    private static boolean isFormatSpecial(char formatChar)
-    {
-        return formatChar >= 107 && formatChar <= 111 || formatChar >= 75 && formatChar <= 79 || formatChar == 114 || formatChar == 82;
-    }
-
-    /**
-     * Digests a string for nonprinting formatting characters then returns a string containing only that formatting.
-     */
-    public static String getFormatFromString(String p_78282_0_)
-    {
-        String var1 = "";
-        int var2 = -1;
-        int var3 = p_78282_0_.length();
-
-        while ((var2 = p_78282_0_.indexOf(167, var2 + 1)) != -1)
-        {
-            if (var2 < var3 - 1)
-            {
-                char var4 = p_78282_0_.charAt(var2 + 1);
-
-                if (isFormatColor(var4))
-                {
-                    var1 = "\u00a7" + var4;
-                }
-                else if (isFormatSpecial(var4))
-                {
-                    var1 = var1 + "\u00a7" + var4;
-                }
-            }
-        }
-
-        return var1;
-    }
-
-    /**
-     * Get bidiFlag that controls if the Unicode Bidirectional Algorithm should be run before rendering any string
-     */
-    public boolean getBidiFlag()
-    {
-        return this.bidiFlag;
-    }
-
-    public int func_175064_b(char p_175064_1_)
-    {
-        return this.colorCode["0123456789abcdef".indexOf(p_175064_1_)];
-    }
-}
+package net.minecraft.client.gui;
+
+import java.awt.image.BufferedImage;
+import java.io.IOException;
+import java.io.InputStream;
+import java.util.Arrays;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Random;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.network.NetworkPlayerInfo;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.texture.TextureManager;
+import net.minecraft.client.renderer.texture.TextureUtil;
+import net.minecraft.client.resources.IResourceManager;
+import net.minecraft.client.resources.IResourceManagerReloadListener;
+import net.minecraft.client.settings.GameSettings;
+import net.minecraft.util.ResourceLocation;
+
+import org.apache.commons.io.IOUtils;
+import org.lwjgl.opengl.GL11;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.NameProtectMod;
+
+import com.ibm.icu.text.ArabicShaping;
+import com.ibm.icu.text.ArabicShapingException;
+import com.ibm.icu.text.Bidi;
+
+public class FontRenderer implements IResourceManagerReloadListener
+{
+    private static final ResourceLocation[] unicodePageLocations = new ResourceLocation[256];
+
+    /** Array of width of all the characters in default.png */
+    private int[] charWidth = new int[256];
+
+    /** the height in pixels of default text */
+    public int FONT_HEIGHT = 9;
+    public Random fontRandom = new Random();
+
+    /**
+     * Array of the start/end column (in upper/lower nibble) for every glyph in the /font directory.
+     */
+    private byte[] glyphWidth = new byte[65536];
+
+    /**
+     * Array of RGB triplets defining the 16 standard chat colors followed by 16 darker version of the same colors for
+     * drop shadows.
+     */
+    private int[] colorCode = new int[32];
+    private final ResourceLocation locationFontTexture;
+
+    /** The RenderEngine used to load and setup glyph textures. */
+    private final TextureManager renderEngine;
+
+    /** Current X coordinate at which to draw the next character. */
+    private float posX;
+
+    /** Current Y coordinate at which to draw the next character. */
+    private float posY;
+
+    /**
+     * If true, strings should be rendered with Unicode fonts instead of the default.png font
+     */
+    private boolean unicodeFlag;
+
+    /**
+     * If true, the Unicode Bidirectional Algorithm should be run before rendering any string.
+     */
+    private boolean bidiFlag;
+
+    /** Used to specify new red value for the current color. */
+    private float red;
+
+    /** Used to specify new blue value for the current color. */
+    private float blue;
+
+    /** Used to specify new green value for the current color. */
+    private float green;
+
+    /** Used to speify new alpha value for the current color. */
+    private float alpha;
+
+    /** Text color of the currently rendering string. */
+    private int textColor;
+
+    /** Set if the "k" style (random) is active in currently rendering string */
+    private boolean randomStyle;
+
+    /** Set if the "l" style (bold) is active in currently rendering string */
+    private boolean boldStyle;
+
+    /** Set if the "o" style (italic) is active in currently rendering string */
+    private boolean italicStyle;
+
+    /**
+     * Set if the "n" style (underlined) is active in currently rendering string
+     */
+    private boolean underlineStyle;
+
+    /**
+     * Set if the "m" style (strikethrough) is active in currently rendering string
+     */
+    private boolean strikethroughStyle;
+    private static final String __OBFID = "CL_00000660";
+
+    public FontRenderer(GameSettings p_i1035_1_, ResourceLocation p_i1035_2_, TextureManager p_i1035_3_, boolean p_i1035_4_)
+    {
+        this.locationFontTexture = p_i1035_2_;
+        this.renderEngine = p_i1035_3_;
+        this.unicodeFlag = p_i1035_4_;
+        p_i1035_3_.bindTexture(this.locationFontTexture);
+
+        for (int var5 = 0; var5 < 32; ++var5)
+        {
+            int var6 = (var5 >> 3 & 1) * 85;
+            int var7 = (var5 >> 2 & 1) * 170 + var6;
+            int var8 = (var5 >> 1 & 1) * 170 + var6;
+            int var9 = (var5 >> 0 & 1) * 170 + var6;
+
+            if (var5 == 6)
+            {
+                var7 += 85;
+            }
+
+            if (p_i1035_1_.anaglyph)
+            {
+                int var10 = (var7 * 30 + var8 * 59 + var9 * 11) / 100;
+                int var11 = (var7 * 30 + var8 * 70) / 100;
+                int var12 = (var7 * 30 + var9 * 70) / 100;
+                var7 = var10;
+                var8 = var11;
+                var9 = var12;
+            }
+
+            if (var5 >= 16)
+            {
+                var7 /= 4;
+                var8 /= 4;
+                var9 /= 4;
+            }
+
+            this.colorCode[var5] = (var7 & 255) << 16 | (var8 & 255) << 8 | var9 & 255;
+        }
+
+        this.readGlyphSizes();
+    }
+
+    public void onResourceManagerReload(IResourceManager p_110549_1_)
+    {
+        this.readFontTexture();
+    }
+
+    private void readFontTexture()
+    {
+        BufferedImage var1;
+
+        try
+        {
+            var1 = TextureUtil.func_177053_a(Minecraft.getMinecraft().getResourceManager().getResource(this.locationFontTexture).getInputStream());
+        }
+        catch (IOException var17)
+        {
+            throw new RuntimeException(var17);
+        }
+
+        int var2 = var1.getWidth();
+        int var3 = var1.getHeight();
+        int[] var4 = new int[var2 * var3];
+        var1.getRGB(0, 0, var2, var3, var4, 0, var2);
+        int var5 = var3 / 16;
+        int var6 = var2 / 16;
+        byte var7 = 1;
+        float var8 = 8.0F / (float)var6;
+        int var9 = 0;
+
+        while (var9 < 256)
+        {
+            int var10 = var9 % 16;
+            int var11 = var9 / 16;
+
+            if (var9 == 32)
+            {
+                this.charWidth[var9] = 3 + var7;
+            }
+
+            int var12 = var6 - 1;
+
+            while (true)
+            {
+                if (var12 >= 0)
+                {
+                    int var13 = var10 * var6 + var12;
+                    boolean var14 = true;
+
+                    for (int var15 = 0; var15 < var5 && var14; ++var15)
+                    {
+                        int var16 = (var11 * var6 + var15) * var2;
+
+                        if ((var4[var13 + var16] >> 24 & 255) != 0)
+                        {
+                            var14 = false;
+                        }
+                    }
+
+                    if (var14)
+                    {
+                        --var12;
+                        continue;
+                    }
+                }
+
+                ++var12;
+                this.charWidth[var9] = (int)(0.5D + (double)((float)var12 * var8)) + var7;
+                ++var9;
+                break;
+            }
+        }
+    }
+
+    private void readGlyphSizes()
+    {
+        InputStream var1 = null;
+
+        try
+        {
+            var1 = Minecraft.getMinecraft().getResourceManager().getResource(new ResourceLocation("font/glyph_sizes.bin")).getInputStream();
+            var1.read(this.glyphWidth);
+        }
+        catch (IOException var6)
+        {
+            throw new RuntimeException(var6);
+        }
+        finally
+        {
+            IOUtils.closeQuietly(var1);
+        }
+    }
+
+    /**
+     * Pick how to render a single character and return the width used.
+     */
+    private float renderCharAtPos(int p_78278_1_, char p_78278_2_, boolean p_78278_3_)
+    {
+        return p_78278_2_ == 32 ? 4.0F : ("\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(p_78278_2_) != -1 && !this.unicodeFlag ? this.renderDefaultChar(p_78278_1_, p_78278_3_) : this.renderUnicodeChar(p_78278_2_, p_78278_3_));
+    }
+
+    /**
+     * Render a single character with the default.png font at current (posX,posY) location...
+     */
+    private float renderDefaultChar(int p_78266_1_, boolean p_78266_2_)
+    {
+        float var3 = (float)(p_78266_1_ % 16 * 8);
+        float var4 = (float)(p_78266_1_ / 16 * 8);
+        float var5 = p_78266_2_ ? 1.0F : 0.0F;
+        this.renderEngine.bindTexture(this.locationFontTexture);
+        float var6 = (float)this.charWidth[p_78266_1_] - 0.01F;
+        GL11.glBegin(GL11.GL_TRIANGLE_STRIP);
+        GL11.glTexCoord2f(var3 / 128.0F, var4 / 128.0F);
+        GL11.glVertex3f(this.posX + var5, this.posY, 0.0F);
+        GL11.glTexCoord2f(var3 / 128.0F, (var4 + 7.99F) / 128.0F);
+        GL11.glVertex3f(this.posX - var5, this.posY + 7.99F, 0.0F);
+        GL11.glTexCoord2f((var3 + var6 - 1.0F) / 128.0F, var4 / 128.0F);
+        GL11.glVertex3f(this.posX + var6 - 1.0F + var5, this.posY, 0.0F);
+        GL11.glTexCoord2f((var3 + var6 - 1.0F) / 128.0F, (var4 + 7.99F) / 128.0F);
+        GL11.glVertex3f(this.posX + var6 - 1.0F - var5, this.posY + 7.99F, 0.0F);
+        GL11.glEnd();
+        return (float)this.charWidth[p_78266_1_];
+    }
+
+    private ResourceLocation getUnicodePageLocation(int p_111271_1_)
+    {
+        if (unicodePageLocations[p_111271_1_] == null)
+        {
+            unicodePageLocations[p_111271_1_] = new ResourceLocation(String.format("textures/font/unicode_page_%02x.png", new Object[] {Integer.valueOf(p_111271_1_)}));
+        }
+
+        return unicodePageLocations[p_111271_1_];
+    }
+
+    /**
+     * Load one of the /font/glyph_XX.png into a new GL texture and store the texture ID in glyphTextureName array.
+     */
+    private void loadGlyphTexture(int p_78257_1_)
+    {
+        this.renderEngine.bindTexture(this.getUnicodePageLocation(p_78257_1_));
+    }
+
+    /**
+     * Render a single Unicode character at current (posX,posY) location using one of the /font/glyph_XX.png files...
+     */
+    private float renderUnicodeChar(char p_78277_1_, boolean p_78277_2_)
+    {
+        if (this.glyphWidth[p_78277_1_] == 0)
+        {
+            return 0.0F;
+        }
+        else
+        {
+            int var3 = p_78277_1_ / 256;
+            this.loadGlyphTexture(var3);
+            int var4 = this.glyphWidth[p_78277_1_] >>> 4;
+            int var5 = this.glyphWidth[p_78277_1_] & 15;
+            float var6 = (float)var4;
+            float var7 = (float)(var5 + 1);
+            float var8 = (float)(p_78277_1_ % 16 * 16) + var6;
+            float var9 = (float)((p_78277_1_ & 255) / 16 * 16);
+            float var10 = var7 - var6 - 0.02F;
+            float var11 = p_78277_2_ ? 1.0F : 0.0F;
+            GL11.glBegin(GL11.GL_TRIANGLE_STRIP);
+            GL11.glTexCoord2f(var8 / 256.0F, var9 / 256.0F);
+            GL11.glVertex3f(this.posX + var11, this.posY, 0.0F);
+            GL11.glTexCoord2f(var8 / 256.0F, (var9 + 15.98F) / 256.0F);
+            GL11.glVertex3f(this.posX - var11, this.posY + 7.99F, 0.0F);
+            GL11.glTexCoord2f((var8 + var10) / 256.0F, var9 / 256.0F);
+            GL11.glVertex3f(this.posX + var10 / 2.0F + var11, this.posY, 0.0F);
+            GL11.glTexCoord2f((var8 + var10) / 256.0F, (var9 + 15.98F) / 256.0F);
+            GL11.glVertex3f(this.posX + var10 / 2.0F - var11, this.posY + 7.99F, 0.0F);
+            GL11.glEnd();
+            return (var7 - var6) / 2.0F + 1.0F;
+        }
+    }
+
+    public int drawStringWithShadow(String p_175063_1_, float p_175063_2_, float p_175063_3_, int p_175063_4_)
+    {
+        return this.drawString(p_175063_1_, p_175063_2_, p_175063_3_, p_175063_4_, true);
+    }
+
+    /**
+     * Draws the specified string.
+     */
+    public int drawString(String text, int x, int y, int color)
+    {
+        return this.drawString(text, (float)x, (float)y, color, false);
+    }
+
+    public int drawString(String p_175065_1_, float p_175065_2_, float p_175065_3_, int p_175065_4_, boolean p_175065_5_)
+    {
+    	//TODO: Client
+    	if(Minecraft.getMinecraft().getNetHandler() != null && WurstClient.INSTANCE.modManager.getModByClass(NameProtectMod.class).isEnabled())
+    	{
+    		Iterator itr = Minecraft.getMinecraft().getNetHandler().getPlayerInfo().iterator();
+    		int i = 0;
+    		while(itr.hasNext())
+        	{
+    			NetworkPlayerInfo info = (NetworkPlayerInfo)itr.next();
+        		String name = info.getPlayerNameForReal();
+        		i++;
+        		if(p_175065_1_.contains(Minecraft.getMinecraft().session.getUsername()))
+        		{
+        			p_175065_1_ = p_175065_1_.replace(Minecraft.getMinecraft().session.getUsername(), "oMer");
+        		}else if(p_175065_1_.contains(name))
+        		{
+        			p_175065_1_ = p_175065_1_.replace(name, "oPlayer" + i + "r");
+        		}
+        	}
+    	}
+        GlStateManager.enableAlpha();
+        this.resetStyles();
+        int var6;
+
+        if (p_175065_5_)
+        {
+            var6 = this.func_180455_b(p_175065_1_, p_175065_2_ + 1.0F, p_175065_3_ + 1.0F, p_175065_4_, true);
+            var6 = Math.max(var6, this.func_180455_b(p_175065_1_, p_175065_2_, p_175065_3_, p_175065_4_, false));
+        }
+        else
+        {
+            var6 = this.func_180455_b(p_175065_1_, p_175065_2_, p_175065_3_, p_175065_4_, false);
+        }
+
+        return var6;
+    }
+
+    /**
+     * Apply Unicode Bidirectional Algorithm to string and return a new possibly reordered string for visual rendering.
+     */
+    private String bidiReorder(String p_147647_1_)
+    {
+        try
+        {
+            Bidi var2 = new Bidi((new ArabicShaping(8)).shape(p_147647_1_), 127);
+            var2.setReorderingMode(0);
+            return var2.writeReordered(2);
+        }
+        catch (ArabicShapingException var3)
+        {
+            return p_147647_1_;
+        }
+    }
+
+    /**
+     * Reset all style flag fields in the class to false; called at the start of string rendering
+     */
+    private void resetStyles()
+    {
+        this.randomStyle = false;
+        this.boldStyle = false;
+        this.italicStyle = false;
+        this.underlineStyle = false;
+        this.strikethroughStyle = false;
+    }
+
+    /**
+     * Render a single line string at the current (posX,posY) and update posX
+     */
+    private void renderStringAtPos(String p_78255_1_, boolean p_78255_2_)
+    {
+        for (int var3 = 0; var3 < p_78255_1_.length(); ++var3)
+        {
+            char var4 = p_78255_1_.charAt(var3);
+            int var5;
+            int var6;
+
+            if (var4 == 167 && var3 + 1 < p_78255_1_.length())
+            {
+                var5 = "0123456789abcdefklmnor".indexOf(p_78255_1_.toLowerCase().charAt(var3 + 1));
+
+                if (var5 < 16)
+                {
+                    this.randomStyle = false;
+                    this.boldStyle = false;
+                    this.strikethroughStyle = false;
+                    this.underlineStyle = false;
+                    this.italicStyle = false;
+
+                    if (var5 < 0 || var5 > 15)
+                    {
+                        var5 = 15;
+                    }
+
+                    if (p_78255_2_)
+                    {
+                        var5 += 16;
+                    }
+
+                    var6 = this.colorCode[var5];
+                    this.textColor = var6;
+                    GlStateManager.color((float)(var6 >> 16) / 255.0F, (float)(var6 >> 8 & 255) / 255.0F, (float)(var6 & 255) / 255.0F, this.alpha);
+                }
+                else if (var5 == 16)
+                {
+                    this.randomStyle = true;
+                }
+                else if (var5 == 17)
+                {
+                    this.boldStyle = true;
+                }
+                else if (var5 == 18)
+                {
+                    this.strikethroughStyle = true;
+                }
+                else if (var5 == 19)
+                {
+                    this.underlineStyle = true;
+                }
+                else if (var5 == 20)
+                {
+                    this.italicStyle = true;
+                }
+                else if (var5 == 21)
+                {
+                    this.randomStyle = false;
+                    this.boldStyle = false;
+                    this.strikethroughStyle = false;
+                    this.underlineStyle = false;
+                    this.italicStyle = false;
+                    GlStateManager.color(this.red, this.blue, this.green, this.alpha);
+                }
+
+                ++var3;
+            }
+            else
+            {
+                var5 = "\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(var4);
+
+                if (this.randomStyle && var5 != -1)
+                {
+                    do
+                    {
+                        var6 = this.fontRandom.nextInt(this.charWidth.length);
+                    }
+                    while (this.charWidth[var5] != this.charWidth[var6]);
+
+                    var5 = var6;
+                }
+
+                float var12 = this.unicodeFlag ? 0.5F : 1.0F;
+                boolean var7 = (var4 == 0 || var5 == -1 || this.unicodeFlag) && p_78255_2_;
+
+                if (var7)
+                {
+                    this.posX -= var12;
+                    this.posY -= var12;
+                }
+
+                float var8 = this.renderCharAtPos(var5, var4, this.italicStyle);
+
+                if (var7)
+                {
+                    this.posX += var12;
+                    this.posY += var12;
+                }
+
+                if (this.boldStyle)
+                {
+                    this.posX += var12;
+
+                    if (var7)
+                    {
+                        this.posX -= var12;
+                        this.posY -= var12;
+                    }
+
+                    this.renderCharAtPos(var5, var4, this.italicStyle);
+                    this.posX -= var12;
+
+                    if (var7)
+                    {
+                        this.posX += var12;
+                        this.posY += var12;
+                    }
+
+                    ++var8;
+                }
+
+                Tessellator var9;
+                WorldRenderer var10;
+
+                if (this.strikethroughStyle)
+                {
+                    var9 = Tessellator.getInstance();
+                    var10 = var9.getWorldRenderer();
+                    GlStateManager.func_179090_x();
+                    var10.startDrawingQuads();
+                    var10.addVertex((double)this.posX, (double)(this.posY + (float)(this.FONT_HEIGHT / 2)), 0.0D);
+                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)(this.FONT_HEIGHT / 2)), 0.0D);
+                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)(this.FONT_HEIGHT / 2) - 1.0F), 0.0D);
+                    var10.addVertex((double)this.posX, (double)(this.posY + (float)(this.FONT_HEIGHT / 2) - 1.0F), 0.0D);
+                    var9.draw();
+                    GlStateManager.func_179098_w();
+                }
+
+                if (this.underlineStyle)
+                {
+                    var9 = Tessellator.getInstance();
+                    var10 = var9.getWorldRenderer();
+                    GlStateManager.func_179090_x();
+                    var10.startDrawingQuads();
+                    int var11 = this.underlineStyle ? -1 : 0;
+                    var10.addVertex((double)(this.posX + (float)var11), (double)(this.posY + (float)this.FONT_HEIGHT), 0.0D);
+                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)this.FONT_HEIGHT), 0.0D);
+                    var10.addVertex((double)(this.posX + var8), (double)(this.posY + (float)this.FONT_HEIGHT - 1.0F), 0.0D);
+                    var10.addVertex((double)(this.posX + (float)var11), (double)(this.posY + (float)this.FONT_HEIGHT - 1.0F), 0.0D);
+                    var9.draw();
+                    GlStateManager.func_179098_w();
+                }
+
+                this.posX += (float)((int)var8);
+            }
+        }
+    }
+
+    /**
+     * Render string either left or right aligned depending on bidiFlag
+     */
+    private int renderStringAligned(String p_78274_1_, int p_78274_2_, int p_78274_3_, int p_78274_4_, int p_78274_5_, boolean p_78274_6_)
+    {
+        if (this.bidiFlag)
+        {
+            int var7 = this.getStringWidth(this.bidiReorder(p_78274_1_));
+            p_78274_2_ = p_78274_2_ + p_78274_4_ - var7;
+        }
+
+        return this.func_180455_b(p_78274_1_, (float)p_78274_2_, (float)p_78274_3_, p_78274_5_, p_78274_6_);
+    }
+
+    private int func_180455_b(String p_180455_1_, float p_180455_2_, float p_180455_3_, int p_180455_4_, boolean p_180455_5_)
+    {
+        if (p_180455_1_ == null)
+        {
+            return 0;
+        }
+        else
+        {
+            if (this.bidiFlag)
+            {
+                p_180455_1_ = this.bidiReorder(p_180455_1_);
+            }
+
+            if ((p_180455_4_ & -67108864) == 0)
+            {
+                p_180455_4_ |= -16777216;
+            }
+
+            if (p_180455_5_)
+            {
+                p_180455_4_ = (p_180455_4_ & 16579836) >> 2 | p_180455_4_ & -16777216;
+            }
+
+            this.red = (float)(p_180455_4_ >> 16 & 255) / 255.0F;
+            this.blue = (float)(p_180455_4_ >> 8 & 255) / 255.0F;
+            this.green = (float)(p_180455_4_ & 255) / 255.0F;
+            this.alpha = (float)(p_180455_4_ >> 24 & 255) / 255.0F;
+            GlStateManager.color(this.red, this.blue, this.green, this.alpha);
+            this.posX = p_180455_2_;
+            this.posY = p_180455_3_;
+            this.renderStringAtPos(p_180455_1_, p_180455_5_);
+            return (int)this.posX;
+        }
+    }
+
+    /**
+     * Returns the width of this string. Equivalent of FontMetrics.stringWidth(String s).
+     */
+    public int getStringWidth(String p_78256_1_)
+    {
+        if (p_78256_1_ == null)
+        {
+            return 0;
+        }
+        else
+        {
+            int var2 = 0;
+            boolean var3 = false;
+
+            for (int var4 = 0; var4 < p_78256_1_.length(); ++var4)
+            {
+                char var5 = p_78256_1_.charAt(var4);
+                int var6 = this.getCharWidth(var5);
+
+                if (var6 < 0 && var4 < p_78256_1_.length() - 1)
+                {
+                    ++var4;
+                    var5 = p_78256_1_.charAt(var4);
+
+                    if (var5 != 108 && var5 != 76)
+                    {
+                        if (var5 == 114 || var5 == 82)
+                        {
+                            var3 = false;
+                        }
+                    }
+                    else
+                    {
+                        var3 = true;
+                    }
+
+                    var6 = 0;
+                }
+
+                var2 += var6;
+
+                if (var3 && var6 > 0)
+                {
+                    ++var2;
+                }
+            }
+
+            return var2;
+        }
+    }
+
+    /**
+     * Returns the width of this character as rendered.
+     */
+    public int getCharWidth(char p_78263_1_)
+    {
+        if (p_78263_1_ == 167)
+        {
+            return -1;
+        }
+        else if (p_78263_1_ == 32)
+        {
+            return 4;
+        }
+        else
+        {
+            int var2 = "\u00c0\u00c1\u00c2\u00c8\u00ca\u00cb\u00cd\u00d3\u00d4\u00d5\u00da\u00df\u00e3\u00f5\u011f\u0130\u0131\u0152\u0153\u015e\u015f\u0174\u0175\u017e\u0207\u0000\u0000\u0000\u0000\u0000\u0000\u0000 !\"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u0000\u00c7\u00fc\u00e9\u00e2\u00e4\u00e0\u00e5\u00e7\u00ea\u00eb\u00e8\u00ef\u00ee\u00ec\u00c4\u00c5\u00c9\u00e6\u00c6\u00f4\u00f6\u00f2\u00fb\u00f9\u00ff\u00d6\u00dc\u00f8\u00a3\u00d8\u00d7\u0192\u00e1\u00ed\u00f3\u00fa\u00f1\u00d1\u00aa\u00ba\u00bf\u00ae\u00ac\u00bd\u00bc\u00a1\u00ab\u00bb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\u03b2\u0393\u03c0\u03a3\u03c3\u03bc\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u2205\u2208\u2229\u2261\u00b1\u2265\u2264\u2320\u2321\u00f7\u2248\u00b0\u2219\u00b7\u221a\u207f\u00b2\u25a0\u0000".indexOf(p_78263_1_);
+
+            if (p_78263_1_ > 0 && var2 != -1 && !this.unicodeFlag)
+            {
+                return this.charWidth[var2];
+            }
+            else if (this.glyphWidth[p_78263_1_] != 0)
+            {
+                int var3 = this.glyphWidth[p_78263_1_] >>> 4;
+                int var4 = this.glyphWidth[p_78263_1_] & 15;
+
+                if (var4 > 7)
+                {
+                    var4 = 15;
+                    var3 = 0;
+                }
+
+                ++var4;
+                return (var4 - var3) / 2 + 1;
+            }
+            else
+            {
+                return 0;
+            }
+        }
+    }
+
+    /**
+     * Trims a string to fit a specified Width.
+     */
+    public String trimStringToWidth(String p_78269_1_, int p_78269_2_)
+    {
+        return this.trimStringToWidth(p_78269_1_, p_78269_2_, false);
+    }
+
+    /**
+     * Trims a string to a specified width, and will reverse it if par3 is set.
+     */
+    public String trimStringToWidth(String p_78262_1_, int p_78262_2_, boolean p_78262_3_)
+    {
+        StringBuilder var4 = new StringBuilder();
+        int var5 = 0;
+        int var6 = p_78262_3_ ? p_78262_1_.length() - 1 : 0;
+        int var7 = p_78262_3_ ? -1 : 1;
+        boolean var8 = false;
+        boolean var9 = false;
+
+        for (int var10 = var6; var10 >= 0 && var10 < p_78262_1_.length() && var5 < p_78262_2_; var10 += var7)
+        {
+            char var11 = p_78262_1_.charAt(var10);
+            int var12 = this.getCharWidth(var11);
+
+            if (var8)
+            {
+                var8 = false;
+
+                if (var11 != 108 && var11 != 76)
+                {
+                    if (var11 == 114 || var11 == 82)
+                    {
+                        var9 = false;
+                    }
+                }
+                else
+                {
+                    var9 = true;
+                }
+            }
+            else if (var12 < 0)
+            {
+                var8 = true;
+            }
+            else
+            {
+                var5 += var12;
+
+                if (var9)
+                {
+                    ++var5;
+                }
+            }
+
+            if (var5 > p_78262_2_)
+            {
+                break;
+            }
+
+            if (p_78262_3_)
+            {
+                var4.insert(0, var11);
+            }
+            else
+            {
+                var4.append(var11);
+            }
+        }
+
+        return var4.toString();
+    }
+
+    /**
+     * Remove all newline characters from the end of the string
+     */
+    private String trimStringNewline(String p_78273_1_)
+    {
+        while (p_78273_1_ != null && p_78273_1_.endsWith("\n"))
+        {
+            p_78273_1_ = p_78273_1_.substring(0, p_78273_1_.length() - 1);
+        }
+
+        return p_78273_1_;
+    }
+
+    /**
+     * Splits and draws a String with wordwrap (maximum length is parameter k)
+     */
+    public void drawSplitString(String str, int x, int y, int wrapWidth, int textColor)
+    {
+        this.resetStyles();
+        this.textColor = textColor;
+        str = this.trimStringNewline(str);
+        this.renderSplitString(str, x, y, wrapWidth, false);
+    }
+
+    /**
+     * Perform actual work of rendering a multi-line string with wordwrap and with darker drop shadow color if flag is
+     * set
+     */
+    private void renderSplitString(String str, int x, int y, int wrapWidth, boolean addShadow)
+    {
+        List var6 = this.listFormattedStringToWidth(str, wrapWidth);
+
+        for (Iterator var7 = var6.iterator(); var7.hasNext(); y += this.FONT_HEIGHT)
+        {
+            String var8 = (String)var7.next();
+            this.renderStringAligned(var8, x, y, wrapWidth, this.textColor, addShadow);
+        }
+    }
+
+    /**
+     * Returns the width of the wordwrapped String (maximum length is parameter k)
+     */
+    public int splitStringWidth(String p_78267_1_, int p_78267_2_)
+    {
+        return this.FONT_HEIGHT * this.listFormattedStringToWidth(p_78267_1_, p_78267_2_).size();
+    }
+
+    /**
+     * Set unicodeFlag controlling whether strings should be rendered with Unicode fonts instead of the default.png
+     * font.
+     */
+    public void setUnicodeFlag(boolean p_78264_1_)
+    {
+        this.unicodeFlag = p_78264_1_;
+    }
+
+    /**
+     * Get unicodeFlag controlling whether strings should be rendered with Unicode fonts instead of the default.png
+     * font.
+     */
+    public boolean getUnicodeFlag()
+    {
+        return this.unicodeFlag;
+    }
+
+    /**
+     * Set bidiFlag to control if the Unicode Bidirectional Algorithm should be run before rendering any string.
+     */
+    public void setBidiFlag(boolean p_78275_1_)
+    {
+        this.bidiFlag = p_78275_1_;
+    }
+
+    /**
+     * Breaks a string into a list of pieces that will fit a specified width.
+     */
+    public List listFormattedStringToWidth(String str, int wrapWidth)
+    {
+        return Arrays.asList(this.wrapFormattedStringToWidth(str, wrapWidth).split("\n"));
+    }
+
+    /**
+     * Inserts newline and formatting into a string to wrap it within the specified width.
+     */
+    String wrapFormattedStringToWidth(String str, int wrapWidth)
+    {
+        int var3 = this.sizeStringToWidth(str, wrapWidth);
+
+        if (str.length() <= var3)
+        {
+            return str;
+        }
+        else
+        {
+            String var4 = str.substring(0, var3);
+            char var5 = str.charAt(var3);
+            boolean var6 = var5 == 32 || var5 == 10;
+            String var7 = getFormatFromString(var4) + str.substring(var3 + (var6 ? 1 : 0));
+            return var4 + "\n" + this.wrapFormattedStringToWidth(var7, wrapWidth);
+        }
+    }
+
+    /**
+     * Determines how many characters from the string will fit into the specified width.
+     */
+    private int sizeStringToWidth(String str, int wrapWidth)
+    {
+        int var3 = str.length();
+        int var4 = 0;
+        int var5 = 0;
+        int var6 = -1;
+
+        for (boolean var7 = false; var5 < var3; ++var5)
+        {
+            char var8 = str.charAt(var5);
+
+            switch (var8)
+            {
+                case 10:
+                    --var5;
+                    break;
+
+                case 167:
+                    if (var5 < var3 - 1)
+                    {
+                        ++var5;
+                        char var9 = str.charAt(var5);
+
+                        if (var9 != 108 && var9 != 76)
+                        {
+                            if (var9 == 114 || var9 == 82 || isFormatColor(var9))
+                            {
+                                var7 = false;
+                            }
+                        }
+                        else
+                        {
+                            var7 = true;
+                        }
+                    }
+
+                    break;
+
+                case 32:
+                    var6 = var5;
+
+                default:
+                    var4 += this.getCharWidth(var8);
+
+                    if (var7)
+                    {
+                        ++var4;
+                    }
+            }
+
+            if (var8 == 10)
+            {
+                ++var5;
+                var6 = var5;
+                break;
+            }
+
+            if (var4 > wrapWidth)
+            {
+                break;
+            }
+        }
+
+        return var5 != var3 && var6 != -1 && var6 < var5 ? var6 : var5;
+    }
+
+    /**
+     * Checks if the char code is a hexadecimal character, used to set colour.
+     */
+    private static boolean isFormatColor(char colorChar)
+    {
+        return colorChar >= 48 && colorChar <= 57 || colorChar >= 97 && colorChar <= 102 || colorChar >= 65 && colorChar <= 70;
+    }
+
+    /**
+     * Checks if the char code is O-K...lLrRk-o... used to set special formatting.
+     */
+    private static boolean isFormatSpecial(char formatChar)
+    {
+        return formatChar >= 107 && formatChar <= 111 || formatChar >= 75 && formatChar <= 79 || formatChar == 114 || formatChar == 82;
+    }
+
+    /**
+     * Digests a string for nonprinting formatting characters then returns a string containing only that formatting.
+     */
+    public static String getFormatFromString(String p_78282_0_)
+    {
+        String var1 = "";
+        int var2 = -1;
+        int var3 = p_78282_0_.length();
+
+        while ((var2 = p_78282_0_.indexOf(167, var2 + 1)) != -1)
+        {
+            if (var2 < var3 - 1)
+            {
+                char var4 = p_78282_0_.charAt(var2 + 1);
+
+                if (isFormatColor(var4))
+                {
+                    var1 = "\u00a7" + var4;
+                }
+                else if (isFormatSpecial(var4))
+                {
+                    var1 = var1 + "\u00a7" + var4;
+                }
+            }
+        }
+
+        return var1;
+    }
+
+    /**
+     * Get bidiFlag that controls if the Unicode Bidirectional Algorithm should be run before rendering any string
+     */
+    public boolean getBidiFlag()
+    {
+        return this.bidiFlag;
+    }
+
+    public int func_175064_b(char p_175064_1_)
+    {
+        return this.colorCode["0123456789abcdef".indexOf(p_175064_1_)];
+    }
+}
diff --git a/src/net/minecraft/client/gui/Gui.java b/src/net/minecraft/client/gui/Gui.java
index b829f4c..514864f 100644
--- a/src/net/minecraft/client/gui/Gui.java
+++ b/src/net/minecraft/client/gui/Gui.java
@@ -107,10 +107,10 @@ public class Gui
         Tessellator var15 = Tessellator.getInstance();
         WorldRenderer var16 = var15.getWorldRenderer();
         var16.startDrawingQuads();
-        var16.func_178960_a(var8, var9, var10, var7);
+        var16.setColorRGBA_F(var8, var9, var10, var7);
         var16.addVertex((double)right, (double)top, (double)this.zLevel);
         var16.addVertex((double)left, (double)top, (double)this.zLevel);
-        var16.func_178960_a(var12, var13, var14, var11);
+        var16.setColorRGBA_F(var12, var13, var14, var11);
         var16.addVertex((double)left, (double)bottom, (double)this.zLevel);
         var16.addVertex((double)right, (double)bottom, (double)this.zLevel);
         var15.draw();
@@ -125,7 +125,7 @@ public class Gui
      */
     public void drawCenteredString(FontRenderer fontRendererIn, String text, int x, int y, int color)
     {
-        fontRendererIn.func_175063_a(text, (float)(x - fontRendererIn.getStringWidth(text) / 2), (float)y, color);
+        fontRendererIn.drawStringWithShadow(text, (float)(x - fontRendererIn.getStringWidth(text) / 2), (float)y, color);
     }
 
     /**
@@ -133,7 +133,7 @@ public class Gui
      */
     public void drawString(FontRenderer fontRendererIn, String text, int x, int y, int color)
     {
-        fontRendererIn.func_175063_a(text, (float)x, (float)y, color);
+        fontRendererIn.drawStringWithShadow(text, (float)x, (float)y, color);
     }
 
     /**
diff --git a/src/net/minecraft/client/gui/GuiButton.java b/src/net/minecraft/client/gui/GuiButton.java
index e7f6171..b4eb1bc 100644
--- a/src/net/minecraft/client/gui/GuiButton.java
+++ b/src/net/minecraft/client/gui/GuiButton.java
@@ -3,150 +3,166 @@ package net.minecraft.client.gui;
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.audio.PositionedSoundRecord;
 import net.minecraft.client.audio.SoundHandler;
+import net.minecraft.client.gui.FontRenderer;
+import net.minecraft.client.gui.Gui;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.util.ResourceLocation;
 
 public class GuiButton extends Gui
 {
-    protected static final ResourceLocation buttonTextures = new ResourceLocation("textures/gui/widgets.png");
-
-    /** Button width in pixels */
-    protected int width;
-
-    /** Button height in pixels */
-    protected int height;
-
-    /** The x position of this control. */
-    public int xPosition;
-
-    /** The y position of this control. */
-    public int yPosition;
-
-    /** The string displayed on this control. */
-    public String displayString;
-    public int id;
-
-    /** True if this control is enabled, false to disable. */
-    public boolean enabled;
-
-    /** Hides the button completely if false. */
-    public boolean visible;
-    protected boolean hovered;
-    private static final String __OBFID = "CL_00000668";
-
-    public GuiButton(int buttonId, int x, int y, String buttonText)
-    {
-        this(buttonId, x, y, 200, 20, buttonText);
-    }
-
-    public GuiButton(int buttonId, int x, int y, int widthIn, int heightIn, String buttonText)
-    {
-        this.width = 200;
-        this.height = 20;
-        this.enabled = true;
-        this.visible = true;
-        this.id = buttonId;
-        this.xPosition = x;
-        this.yPosition = y;
-        this.width = widthIn;
-        this.height = heightIn;
-        this.displayString = buttonText;
-    }
-
-    /**
-     * Returns 0 if the button is disabled, 1 if the mouse is NOT hovering over this button and 2 if it IS hovering over
-     * this button.
-     */
-    protected int getHoverState(boolean mouseOver)
-    {
-        byte var2 = 1;
-
-        if (!this.enabled)
-        {
-            var2 = 0;
-        }
-        else if (mouseOver)
-        {
-            var2 = 2;
-        }
-
-        return var2;
-    }
-
-    /**
-     * Draws this button to the screen.
-     */
-    public void drawButton(Minecraft mc, int mouseX, int mouseY)
-    {
-        if (this.visible)
-        {
-            FontRenderer var4 = mc.fontRendererObj;
-            mc.getTextureManager().bindTexture(buttonTextures);
-            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-            this.hovered = mouseX >= this.xPosition && mouseY >= this.yPosition && mouseX < this.xPosition + this.width && mouseY < this.yPosition + this.height;
-            int var5 = this.getHoverState(this.hovered);
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            GlStateManager.blendFunc(770, 771);
-            this.drawTexturedModalRect(this.xPosition, this.yPosition, 0, 46 + var5 * 20, this.width / 2, this.height);
-            this.drawTexturedModalRect(this.xPosition + this.width / 2, this.yPosition, 200 - this.width / 2, 46 + var5 * 20, this.width / 2, this.height);
-            this.mouseDragged(mc, mouseX, mouseY);
-            int var6 = 14737632;
-
-            if (!this.enabled)
-            {
-                var6 = 10526880;
-            }
-            else if (this.hovered)
-            {
-                var6 = 16777120;
-            }
-
-            this.drawCenteredString(var4, this.displayString, this.xPosition + this.width / 2, this.yPosition + (this.height - 8) / 2, var6);
-        }
-    }
-
-    /**
-     * Fired when the mouse button is dragged. Equivalent of MouseListener.mouseDragged(MouseEvent e).
-     */
-    protected void mouseDragged(Minecraft mc, int mouseX, int mouseY) {}
-
-    /**
-     * Fired when the mouse button is released. Equivalent of MouseListener.mouseReleased(MouseEvent e).
-     */
-    public void mouseReleased(int mouseX, int mouseY) {}
-
-    /**
-     * Returns true if the mouse has been pressed on this control. Equivalent of MouseListener.mousePressed(MouseEvent
-     * e).
-     */
-    public boolean mousePressed(Minecraft mc, int mouseX, int mouseY)
-    {
-        return this.enabled && this.visible && mouseX >= this.xPosition && mouseY >= this.yPosition && mouseX < this.xPosition + this.width && mouseY < this.yPosition + this.height;
-    }
-
-    /**
-     * Whether the mouse cursor is currently over the button.
-     */
-    public boolean isMouseOver()
-    {
-        return this.hovered;
-    }
-
-    public void drawButtonForegroundLayer(int mouseX, int mouseY) {}
-
-    public void playPressSound(SoundHandler soundHandlerIn)
-    {
-        soundHandlerIn.playSound(PositionedSoundRecord.createPositionedSoundRecord(new ResourceLocation("gui.button.press"), 1.0F));
-    }
-
-    public int getButtonWidth()
-    {
-        return this.width;
-    }
-
-    public void func_175211_a(int p_175211_1_)
-    {
-        this.width = p_175211_1_;
-    }
+	protected static final ResourceLocation buttonTextures = new ResourceLocation("textures/gui/widgets.png");
+
+	/** Button width in pixels */
+	protected int width;
+
+	/** Button height in pixels */
+	protected int height;
+
+	/** The x position of this control. */
+	public int xPosition;
+
+	/** The y position of this control. */
+	public int yPosition;
+
+	/** The string displayed on this control. */
+	public String displayString;
+	public int id;
+
+	/** True if this control is enabled, false to disable. */
+	public boolean enabled;
+
+	/** Hides the button completely if false. */
+	public boolean visible;
+	protected boolean hovered;
+	private static final String __OBFID = "CL_00000668";
+
+	public GuiButton(int buttonId, int x, int y, String buttonText)
+	{
+		this(buttonId, x, y, 200, 20, buttonText);
+	}
+
+	public GuiButton(int buttonId, int x, int y, int widthIn, int heightIn, String buttonText)
+	{
+		width = 200;
+		height = 20;
+		enabled = true;
+		visible = true;
+		id = buttonId;
+		xPosition = x;
+		yPosition = y;
+		width = widthIn;
+		height = heightIn;
+		displayString = buttonText;
+	}
+
+	/**
+	 * Returns 0 if the button is disabled, 1 if the mouse is NOT hovering over
+	 * this button and 2 if it IS hovering over
+	 * this button.
+	 */
+	protected int getHoverState(boolean mouseOver)
+	{
+		byte var2 = 1;
+
+		if(!enabled)
+			var2 = 0;
+		else if(mouseOver)
+			var2 = 2;
+
+		return var2;
+	}
+
+	/**
+	 * Draws this button to the screen.
+	 */
+	public void drawButton(Minecraft mc, int mouseX, int mouseY)
+	{
+		if(visible)
+		{
+			FontRenderer var4 = mc.fontRendererObj;
+			mc.getTextureManager().bindTexture(buttonTextures);
+			GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+			hovered = mouseX >= xPosition && mouseY >= yPosition && mouseX < xPosition + width && mouseY < yPosition + height;
+			int var5 = getHoverState(hovered);
+			GlStateManager.enableBlend();
+			GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+			GlStateManager.blendFunc(770, 771);
+
+			/*
+			 * Copyright  2014 - 2015 | Alexander01998 | All rights reserved.
+			 *
+			 * This Source Code Form is subject to the terms of the Mozilla
+			 * Public
+			 * License, v. 2.0. If a copy of the MPL was not distributed with
+			 * this
+			 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
+			 */
+			{
+				drawTexturedModalRect(xPosition, yPosition, 0, 46 + var5 * 20, width / 2, height / 2);
+				drawTexturedModalRect(xPosition + width / 2, yPosition, 200 - width / 2, 46 + var5 * 20, width / 2, height / 2);
+				drawTexturedModalRect(xPosition, yPosition + height / 2, 0, 46 + var5 * 20 + 20 - height / 2, width / 2, height / 2);
+				drawTexturedModalRect(xPosition + width / 2, yPosition + height / 2, 200 - width / 2, 46 + var5 * 20 + 20 - height / 2, width / 2, height / 2);
+			}
+
+			mouseDragged(mc, mouseX, mouseY);
+			int var6 = 14737632;
+
+			if(!enabled)
+				var6 = 10526880;
+			else if(hovered)
+				var6 = 16777120;
+
+			drawCenteredString(var4, displayString, xPosition + width / 2, yPosition + (height - 8) / 2, var6);
+		}
+	}
+
+	/**
+	 * Fired when the mouse button is dragged. Equivalent of
+	 * MouseListener.mouseDragged(MouseEvent e).
+	 */
+	protected void mouseDragged(Minecraft mc, int mouseX, int mouseY)
+	{}
+
+	/**
+	 * Fired when the mouse button is released. Equivalent of
+	 * MouseListener.mouseReleased(MouseEvent e).
+	 */
+	public void mouseReleased(int mouseX, int mouseY)
+	{}
+
+	/**
+	 * Returns true if the mouse has been pressed on this control. Equivalent of
+	 * MouseListener.mousePressed(MouseEvent
+	 * e).
+	 */
+	public boolean mousePressed(Minecraft mc, int mouseX, int mouseY)
+	{
+		return enabled && visible && mouseX >= xPosition && mouseY >= yPosition && mouseX < xPosition + width && mouseY < yPosition + height;
+	}
+
+	/**
+	 * Whether the mouse cursor is currently over the button.
+	 */
+	public boolean isMouseOver()
+	{
+		return hovered;
+	}
+
+	public void drawButtonForegroundLayer(int mouseX, int mouseY)
+	{}
+
+	public void playPressSound(SoundHandler soundHandlerIn)
+	{
+		soundHandlerIn.playSound(PositionedSoundRecord.createPositionedSoundRecord(new ResourceLocation("gui.button.press"), 1.0F));
+	}
+
+	public int getButtonWidth()
+	{
+		return width;
+	}
+
+	public void func_175211_a(int p_175211_1_)
+	{
+		width = p_175211_1_;
+	}
 }
diff --git a/src/net/minecraft/client/gui/GuiButtonLanguage.java b/src/net/minecraft/client/gui/GuiButtonLanguage.java
index 3ac6cf9..080b2fa 100644
--- a/src/net/minecraft/client/gui/GuiButtonLanguage.java
+++ b/src/net/minecraft/client/gui/GuiButtonLanguage.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 
 public class GuiButtonLanguage extends GuiButton
diff --git a/src/net/minecraft/client/gui/GuiButtonRealmsProxy.java b/src/net/minecraft/client/gui/GuiButtonRealmsProxy.java
index 4f79373..be170c3 100644
--- a/src/net/minecraft/client/gui/GuiButtonRealmsProxy.java
+++ b/src/net/minecraft/client/gui/GuiButtonRealmsProxy.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.realms.RealmsButton;
 
 public class GuiButtonRealmsProxy extends GuiButton
diff --git a/src/net/minecraft/client/gui/GuiChat.java b/src/net/minecraft/client/gui/GuiChat.java
index 7aeb91d..a401a3e 100644
--- a/src/net/minecraft/client/gui/GuiChat.java
+++ b/src/net/minecraft/client/gui/GuiChat.java
@@ -255,7 +255,7 @@ public class GuiChat extends GuiScreen
 
             if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
             {
-                var3 = this.mc.objectMouseOver.func_178782_a();
+                var3 = this.mc.objectMouseOver.getBlockPos();
             }
 
             this.mc.thePlayer.sendQueue.addToSendQueue(new C14PacketTabComplete(p_146405_1_, var3));
diff --git a/src/net/minecraft/client/gui/GuiCommandBlock.java b/src/net/minecraft/client/gui/GuiCommandBlock.java
index a0c36ff..14bd143 100644
--- a/src/net/minecraft/client/gui/GuiCommandBlock.java
+++ b/src/net/minecraft/client/gui/GuiCommandBlock.java
@@ -1,12 +1,16 @@
 package net.minecraft.client.gui;
 
 import io.netty.buffer.Unpooled;
+
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.command.server.CommandBlockLogic;
 import net.minecraft.network.PacketBuffer;
 import net.minecraft.network.play.client.C17PacketCustomPayload;
 import net.minecraft.util.IChatComponent;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.lwjgl.input.Keyboard;
diff --git a/src/net/minecraft/client/gui/GuiConfirmOpenLink.java b/src/net/minecraft/client/gui/GuiConfirmOpenLink.java
index 0f730f3..0f73b19 100644
--- a/src/net/minecraft/client/gui/GuiConfirmOpenLink.java
+++ b/src/net/minecraft/client/gui/GuiConfirmOpenLink.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 
 public class GuiConfirmOpenLink extends GuiYesNo
diff --git a/src/net/minecraft/client/gui/GuiControls.java b/src/net/minecraft/client/gui/GuiControls.java
index 0c3a8d7..8b6ffd8 100644
--- a/src/net/minecraft/client/gui/GuiControls.java
+++ b/src/net/minecraft/client/gui/GuiControls.java
@@ -1,7 +1,9 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
 import net.minecraft.client.settings.KeyBinding;
diff --git a/src/net/minecraft/client/gui/GuiCreateFlatWorld.java b/src/net/minecraft/client/gui/GuiCreateFlatWorld.java
index 73bddda..65edfbc 100644
--- a/src/net/minecraft/client/gui/GuiCreateFlatWorld.java
+++ b/src/net/minecraft/client/gui/GuiCreateFlatWorld.java
@@ -1,8 +1,10 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.RenderHelper;
 import net.minecraft.client.renderer.Tessellator;
@@ -147,7 +149,7 @@ public class GuiCreateFlatWorld extends GuiScreen
             if (p_148225_3_ != null && p_148225_3_.getItem() != null)
             {
                 RenderHelper.enableGUIStandardItemLighting();
-                GuiCreateFlatWorld.this.itemRender.func_175042_a(p_148225_3_, p_148225_1_ + 2, p_148225_2_ + 2);
+                GuiCreateFlatWorld.this.itemRender.func_180450_b(p_148225_3_, p_148225_1_ + 2, p_148225_2_ + 2);
                 RenderHelper.disableStandardItemLighting();
             }
 
diff --git a/src/net/minecraft/client/gui/GuiCreateWorld.java b/src/net/minecraft/client/gui/GuiCreateWorld.java
index 276d99b..ab6ea0b 100644
--- a/src/net/minecraft/client/gui/GuiCreateWorld.java
+++ b/src/net/minecraft/client/gui/GuiCreateWorld.java
@@ -2,12 +2,15 @@ package net.minecraft.client.gui;
 
 import java.io.IOException;
 import java.util.Random;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.util.ChatAllowedCharacters;
 import net.minecraft.world.WorldSettings;
 import net.minecraft.world.WorldType;
 import net.minecraft.world.storage.ISaveFormat;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.apache.commons.lang3.StringUtils;
 import org.lwjgl.input.Keyboard;
 
diff --git a/src/net/minecraft/client/gui/GuiCustomizeSkin.java b/src/net/minecraft/client/gui/GuiCustomizeSkin.java
index 4f7b75d..7ed34fd 100644
--- a/src/net/minecraft/client/gui/GuiCustomizeSkin.java
+++ b/src/net/minecraft/client/gui/GuiCustomizeSkin.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.entity.player.EnumPlayerModelParts;
 
diff --git a/src/net/minecraft/client/gui/GuiCustomizeWorldScreen.java b/src/net/minecraft/client/gui/GuiCustomizeWorldScreen.java
index 94b72e0..89e3d7f 100644
--- a/src/net/minecraft/client/gui/GuiCustomizeWorldScreen.java
+++ b/src/net/minecraft/client/gui/GuiCustomizeWorldScreen.java
@@ -2,8 +2,11 @@ package net.minecraft.client.gui;
 
 import com.google.common.base.Predicate;
 import com.google.common.primitives.Floats;
+
 import java.io.IOException;
 import java.util.Random;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.Tessellator;
 import net.minecraft.client.renderer.WorldRenderer;
@@ -962,7 +965,7 @@ public class GuiCustomizeWorldScreen extends GuiScreen implements GuiSlider.Form
             GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
             float var8 = 32.0F;
             var7.startDrawingQuads();
-            var7.func_178991_c(4210752);
+            var7.setColorOpaque_I(4210752);
             var7.addVertexWithUV((double)(this.width / 2 - 90), 185.0D, 0.0D, 0.0D, 2.65625D);
             var7.addVertexWithUV((double)(this.width / 2 + 90), 185.0D, 0.0D, 5.625D, 2.65625D);
             var7.addVertexWithUV((double)(this.width / 2 + 90), 100.0D, 0.0D, 5.625D, 0.0D);
diff --git a/src/net/minecraft/client/gui/GuiDisconnected.java b/src/net/minecraft/client/gui/GuiDisconnected.java
index 957deda..018e285 100644
--- a/src/net/minecraft/client/gui/GuiDisconnected.java
+++ b/src/net/minecraft/client/gui/GuiDisconnected.java
@@ -1,70 +1,154 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import java.util.Iterator;
-import java.util.List;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.util.IChatComponent;
-
-public class GuiDisconnected extends GuiScreen
-{
-    private String reason;
-    private IChatComponent message;
-    private List multilineMessage;
-    private final GuiScreen parentScreen;
-    private int field_175353_i;
-    private static final String __OBFID = "CL_00000693";
-
-    public GuiDisconnected(GuiScreen p_i45020_1_, String p_i45020_2_, IChatComponent p_i45020_3_)
-    {
-        this.parentScreen = p_i45020_1_;
-        this.reason = I18n.format(p_i45020_2_, new Object[0]);
-        this.message = p_i45020_3_;
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.buttonList.clear();
-        this.multilineMessage = this.fontRendererObj.listFormattedStringToWidth(this.message.getFormattedText(), this.width - 50);
-        this.field_175353_i = this.multilineMessage.size() * this.fontRendererObj.FONT_HEIGHT;
-        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 2 + this.field_175353_i / 2 + this.fontRendererObj.FONT_HEIGHT, I18n.format("gui.toMenu", new Object[0])));
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.id == 0)
-        {
-            this.mc.displayGuiScreen(this.parentScreen);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawDefaultBackground();
-        this.drawCenteredString(this.fontRendererObj, this.reason, this.width / 2, this.height / 2 - this.field_175353_i / 2 - this.fontRendererObj.FONT_HEIGHT * 2, 11184810);
-        int var4 = this.height / 2 - this.field_175353_i / 2;
-
-        if (this.multilineMessage != null)
-        {
-            for (Iterator var5 = this.multilineMessage.iterator(); var5.hasNext(); var4 += this.fontRendererObj.FONT_HEIGHT)
-            {
-                String var6 = (String)var5.next();
-                this.drawCenteredString(this.fontRendererObj, var6, this.width / 2, var4, 16777215);
-            }
-        }
-
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-}
+package net.minecraft.client.gui;
+
+import java.io.IOException;
+import java.util.Iterator;
+import java.util.List;
+
+import org.apache.logging.log4j.LogManager;
+
+import tk.wurst_client.WurstClient;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.multiplayer.GuiConnecting;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.util.IChatComponent;
+
+public class GuiDisconnected extends GuiScreen
+{
+    private String reason;
+    private IChatComponent message;
+    private List multilineMessage;
+    private final GuiScreen parentScreen;
+    private int field_175353_i;
+    //TODO: Client
+	private int autoReconnectTimer;
+    private static final String __OBFID = "CL_00000693";
+
+    public GuiDisconnected(GuiScreen p_i45020_1_, String p_i45020_2_, IChatComponent p_i45020_3_)
+	{
+		this.parentScreen = p_i45020_1_;
+		this.reason = I18n.format(p_i45020_2_, new Object[0]);
+		this.message = p_i45020_3_;
+		LogManager.getLogger().info(
+			"Disconnected.\n    Message: "
+				+ (message == null ? null : message.getUnformattedText())
+				+ "\n    Reason: " + reason);
+	}
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.buttonList.clear();
+        this.multilineMessage = this.fontRendererObj.listFormattedStringToWidth(this.message.getFormattedText(), this.width - 50);
+        this.field_175353_i = this.multilineMessage.size() * this.fontRendererObj.FONT_HEIGHT;
+        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 2 + this.field_175353_i / 2 + this.fontRendererObj.FONT_HEIGHT, I18n.format("gui.toMenu", new Object[0])));
+        
+		// TODO: Client
+		this.buttonList.add(new GuiButton(1, this.width / 2 - 100,
+			this.height / 4 + 144 + 12, "Reconnect"));
+		this.buttonList.add(new GuiButton(2, this.width / 2 - 100,
+			this.height / 4 + 168 + 12, "AutoReconnect"));
+		if(message.getUnformattedText().toLowerCase().contains("whitelist")
+			|| message.getUnformattedText().toLowerCase()
+				.contains("white-list"))
+			if(parentScreen instanceof GuiMultiplayer
+				&& ((GuiMultiplayer)parentScreen).serverListSelector
+					.getSelectedServer() != -1)
+				this.buttonList.add(new GuiButton(3, this.width / 2 - 100,
+					this.height / 4 + 192 + 12, "4Delete Serverr"));
+		if(WurstClient.INSTANCE.options.autoReconnect)
+			this.autoReconnectTimer = 100;
+    }
+
+    //TODO: Client
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        super.updateScreen();
+        if(WurstClient.INSTANCE.options.autoReconnect)
+        {
+        	((GuiButton)this.buttonList.get(2)).displayString = "AutoReconnect (" + ((this.autoReconnectTimer / 20) + 1) + ")";
+        	if(this.autoReconnectTimer > 0)
+        		this.autoReconnectTimer--;
+        	else
+        	{
+        		try
+				{
+					this.actionPerformed((GuiButton)this.buttonList.get(1));
+				}catch(IOException e)
+				{
+					e.printStackTrace();
+				}
+        	}
+        }
+        else
+        {
+        	((GuiButton)this.buttonList.get(2)).displayString = "AutoReconnect";
+        }
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.id == 0)
+        {
+            this.mc.displayGuiScreen(new GuiMultiplayer(new GuiMainMenu()));
+          //TODO: Client
+        }else if (button.id == 1)
+        {
+        	if (WurstClient.INSTANCE.lastServer != null)
+            {
+        		WurstClient.INSTANCE.currentServerIP = WurstClient.INSTANCE.lastServer.getServerData().serverIP;
+                if(!WurstClient.INSTANCE.currentServerIP.contains(":"))
+                	WurstClient.INSTANCE.currentServerIP += ":25565";
+                this.mc.displayGuiScreen(new GuiConnecting(this, this.mc, WurstClient.INSTANCE.lastServer.getServerData()));
+            }
+        }else if (button.id == 2)
+        {
+        	WurstClient.INSTANCE.options.autoReconnect = !WurstClient.INSTANCE.options.autoReconnect;
+        	WurstClient.INSTANCE.fileManager.saveOptions();
+        	if(WurstClient.INSTANCE.options.autoReconnect)
+        		this.autoReconnectTimer = 100;
+        }else if(button.id == 3)
+		{
+			GuiMultiplayer servers = (GuiMultiplayer)parentScreen;
+			servers.savedServerList
+				.removeServerData(servers.serverListSelector
+					.getSelectedServer());
+			servers.savedServerList.saveServerList();
+			servers.serverListSelector.setSelectedServer(-1);
+			servers.serverListSelector
+				.func_148195_a(servers.savedServerList);
+			mc.displayGuiScreen(servers);
+		}
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawDefaultBackground();
+        this.drawCenteredString(this.fontRendererObj, this.reason, this.width / 2, this.height / 2 - this.field_175353_i / 2 - this.fontRendererObj.FONT_HEIGHT * 2, 11184810);
+        int var4 = this.height / 2 - this.field_175353_i / 2;
+
+        if (this.multilineMessage != null)
+        {
+            for (Iterator var5 = this.multilineMessage.iterator(); var5.hasNext(); var4 += this.fontRendererObj.FONT_HEIGHT)
+            {
+                String var6 = (String)var5.next();
+                this.drawCenteredString(this.fontRendererObj, var6, this.width / 2, var4, 16777215);
+            }
+        }
+
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiEnchantment.java b/src/net/minecraft/client/gui/GuiEnchantment.java
index f1f80fa..f2607b0 100644
--- a/src/net/minecraft/client/gui/GuiEnchantment.java
+++ b/src/net/minecraft/client/gui/GuiEnchantment.java
@@ -209,7 +209,7 @@ public class GuiEnchantment extends GuiContainer
                 }
 
                 var20 = this.mc.fontRendererObj;
-                var20.func_175063_a(var19, (float)(var15 + 86 - var20.getStringWidth(var19)), (float)(var5 + 16 + 19 * var13 + 7), var21);
+                var20.drawStringWithShadow(var19, (float)(var15 + 86 - var20.getStringWidth(var19)), (float)(var5 + 16 + 19 * var13 + 7), var21);
             }
         }
     }
diff --git a/src/net/minecraft/client/gui/GuiErrorScreen.java b/src/net/minecraft/client/gui/GuiErrorScreen.java
index b886d7d..40725d4 100644
--- a/src/net/minecraft/client/gui/GuiErrorScreen.java
+++ b/src/net/minecraft/client/gui/GuiErrorScreen.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 
 public class GuiErrorScreen extends GuiScreen
diff --git a/src/net/minecraft/client/gui/GuiFlatPresets.java b/src/net/minecraft/client/gui/GuiFlatPresets.java
index 47e1373..6361176 100644
--- a/src/net/minecraft/client/gui/GuiFlatPresets.java
+++ b/src/net/minecraft/client/gui/GuiFlatPresets.java
@@ -2,11 +2,14 @@ package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
 import java.io.IOException;
 import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.block.BlockTallGrass;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.RenderHelper;
 import net.minecraft.client.renderer.Tessellator;
@@ -19,6 +22,7 @@ import net.minecraft.item.ItemStack;
 import net.minecraft.world.biome.BiomeGenBase;
 import net.minecraft.world.gen.FlatGeneratorInfo;
 import net.minecraft.world.gen.FlatLayerInfo;
+
 import org.lwjgl.input.Keyboard;
 
 public class GuiFlatPresets extends GuiScreen
@@ -222,7 +226,7 @@ public class GuiFlatPresets extends GuiScreen
             this.func_148173_e(p_178054_1_ + 1, p_178054_2_ + 1);
             GlStateManager.enableRescaleNormal();
             RenderHelper.enableGUIStandardItemLighting();
-            GuiFlatPresets.this.itemRender.func_175042_a(new ItemStack(p_178054_3_, 1, p_178054_4_), p_178054_1_ + 2, p_178054_2_ + 2);
+            GuiFlatPresets.this.itemRender.func_180450_b(new ItemStack(p_178054_3_, 1, p_178054_4_), p_178054_1_ + 2, p_178054_2_ + 2);
             RenderHelper.disableStandardItemLighting();
             GlStateManager.disableRescaleNormal();
         }
diff --git a/src/net/minecraft/client/gui/GuiGameOver.java b/src/net/minecraft/client/gui/GuiGameOver.java
index c737e46..3df0b8b 100644
--- a/src/net/minecraft/client/gui/GuiGameOver.java
+++ b/src/net/minecraft/client/gui/GuiGameOver.java
@@ -1,137 +1,148 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import java.util.Iterator;
-import net.minecraft.client.multiplayer.WorldClient;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.util.EnumChatFormatting;
-
-public class GuiGameOver extends GuiScreen implements GuiYesNoCallback
-{
-    private int field_146347_a;
-    private boolean field_146346_f = false;
-    private static final String __OBFID = "CL_00000690";
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.buttonList.clear();
-
-        if (this.mc.theWorld.getWorldInfo().isHardcoreModeEnabled())
-        {
-            if (this.mc.isIntegratedServerRunning())
-            {
-                this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.deleteWorld", new Object[0])));
-            }
-            else
-            {
-                this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.leaveServer", new Object[0])));
-            }
-        }
-        else
-        {
-            this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 72, I18n.format("deathScreen.respawn", new Object[0])));
-            this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.titleScreen", new Object[0])));
-
-            if (this.mc.getSession() == null)
-            {
-                ((GuiButton)this.buttonList.get(1)).enabled = false;
-            }
-        }
-
-        GuiButton var2;
-
-        for (Iterator var1 = this.buttonList.iterator(); var1.hasNext(); var2.enabled = false)
-        {
-            var2 = (GuiButton)var1.next();
-        }
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        switch (button.id)
-        {
-            case 0:
-                this.mc.thePlayer.respawnPlayer();
-                this.mc.displayGuiScreen((GuiScreen)null);
-                break;
-
-            case 1:
-                GuiYesNo var2 = new GuiYesNo(this, I18n.format("deathScreen.quit.confirm", new Object[0]), "", I18n.format("deathScreen.titleScreen", new Object[0]), I18n.format("deathScreen.respawn", new Object[0]), 0);
-                this.mc.displayGuiScreen(var2);
-                var2.setButtonDelay(20);
-        }
-    }
-
-    public void confirmClicked(boolean result, int id)
-    {
-        if (result)
-        {
-            this.mc.theWorld.sendQuittingDisconnectingPacket();
-            this.mc.loadWorld((WorldClient)null);
-            this.mc.displayGuiScreen(new GuiMainMenu());
-        }
-        else
-        {
-            this.mc.thePlayer.respawnPlayer();
-            this.mc.displayGuiScreen((GuiScreen)null);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawGradientRect(0, 0, this.width, this.height, 1615855616, -1602211792);
-        GlStateManager.pushMatrix();
-        GlStateManager.scale(2.0F, 2.0F, 2.0F);
-        boolean var4 = this.mc.theWorld.getWorldInfo().isHardcoreModeEnabled();
-        String var5 = var4 ? I18n.format("deathScreen.title.hardcore", new Object[0]) : I18n.format("deathScreen.title", new Object[0]);
-        this.drawCenteredString(this.fontRendererObj, var5, this.width / 2 / 2, 30, 16777215);
-        GlStateManager.popMatrix();
-
-        if (var4)
-        {
-            this.drawCenteredString(this.fontRendererObj, I18n.format("deathScreen.hardcoreInfo", new Object[0]), this.width / 2, 144, 16777215);
-        }
-
-        this.drawCenteredString(this.fontRendererObj, I18n.format("deathScreen.score", new Object[0]) + ": " + EnumChatFormatting.YELLOW + this.mc.thePlayer.getScore(), this.width / 2, 100, 16777215);
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-
-    /**
-     * Returns true if this GUI should pause the game when it is displayed in single-player
-     */
-    public boolean doesGuiPauseGame()
-    {
-        return false;
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        super.updateScreen();
-        ++this.field_146347_a;
-        GuiButton var2;
-
-        if (this.field_146347_a == 20)
-        {
-            for (Iterator var1 = this.buttonList.iterator(); var1.hasNext(); var2.enabled = true)
-            {
-                var2 = (GuiButton)var1.next();
-            }
-        }
-    }
-}
+package net.minecraft.client.gui;
+
+import java.io.IOException;
+import java.util.Iterator;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.DeathEvent;
+import tk.wurst_client.events.EventManager;
+import tk.wurst_client.mods.Mod;
+import tk.wurst_client.spam.SpamProcessor;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.multiplayer.WorldClient;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.util.EnumChatFormatting;
+
+public class GuiGameOver extends GuiScreen implements GuiYesNoCallback
+{
+    private int field_146347_a;
+    private boolean field_146346_f = false;
+    private static final String __OBFID = "CL_00000690";
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.buttonList.clear();
+
+        if (this.mc.theWorld.getWorldInfo().isHardcoreModeEnabled())
+        {
+            if (this.mc.isIntegratedServerRunning())
+            {
+                this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.deleteWorld", new Object[0])));
+            }
+            else
+            {
+                this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.leaveServer", new Object[0])));
+            }
+        }
+        else
+        {
+            this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 72, I18n.format("deathScreen.respawn", new Object[0])));
+            this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 96, I18n.format("deathScreen.titleScreen", new Object[0])));
+
+            if (this.mc.getSession() == null)
+            {
+                ((GuiButton)this.buttonList.get(1)).enabled = false;
+            }
+        }
+
+        GuiButton var2;
+
+        for (Iterator var1 = this.buttonList.iterator(); var1.hasNext(); var2.enabled = false)
+        {
+            var2 = (GuiButton)var1.next();
+        }
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        switch (button.id)
+        {
+            case 0:
+                this.mc.thePlayer.respawnPlayer();
+                this.mc.displayGuiScreen((GuiScreen)null);
+                break;
+
+            case 1:
+                GuiYesNo var2 = new GuiYesNo(this, I18n.format("deathScreen.quit.confirm", new Object[0]), "", I18n.format("deathScreen.titleScreen", new Object[0]), I18n.format("deathScreen.respawn", new Object[0]), 0);
+                this.mc.displayGuiScreen(var2);
+                var2.setButtonDelay(20);
+        }
+    }
+
+    public void confirmClicked(boolean result, int id)
+    {
+        if (result)
+        {
+            this.mc.theWorld.sendQuittingDisconnectingPacket();
+            this.mc.loadWorld((WorldClient)null);
+            this.mc.displayGuiScreen(new GuiMainMenu());
+        }
+        else
+        {
+            this.mc.thePlayer.respawnPlayer();
+            this.mc.displayGuiScreen((GuiScreen)null);
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawGradientRect(0, 0, this.width, this.height, 1615855616, -1602211792);
+        GlStateManager.pushMatrix();
+        GlStateManager.scale(2.0F, 2.0F, 2.0F);
+        boolean var4 = this.mc.theWorld.getWorldInfo().isHardcoreModeEnabled();
+        String var5 = var4 ? I18n.format("deathScreen.title.hardcore", new Object[0]) : I18n.format("deathScreen.title", new Object[0]);
+        this.drawCenteredString(this.fontRendererObj, var5, this.width / 2 / 2, 30, 16777215);
+        GlStateManager.popMatrix();
+
+        if (var4)
+        {
+            this.drawCenteredString(this.fontRendererObj, I18n.format("deathScreen.hardcoreInfo", new Object[0]), this.width / 2, 144, 16777215);
+        }
+
+        this.drawCenteredString(this.fontRendererObj, I18n.format("deathScreen.score", new Object[0]) + ": " + EnumChatFormatting.YELLOW + this.mc.thePlayer.getScore(), this.width / 2, 100, 16777215);
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+
+    /**
+     * Returns true if this GUI should pause the game when it is displayed in single-player
+     */
+    public boolean doesGuiPauseGame()
+    {
+        return false;
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        super.updateScreen();
+        ++this.field_146347_a;
+        GuiButton var2;
+
+        if (this.field_146347_a == 20)
+        {
+            for (Iterator var1 = this.buttonList.iterator(); var1.hasNext(); var2.enabled = true)
+            {
+                var2 = (GuiButton)var1.next();
+            }
+            
+            //TODO: Client
+            WurstClient.INSTANCE.eventManager.fireEvent(DeathEvent.class, new DeathEvent());
+            SpamProcessor.runScript("death", "Runs whenever you die.");
+        }
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiIngame.java b/src/net/minecraft/client/gui/GuiIngame.java
index 6dbd34d..1af6fd3 100644
--- a/src/net/minecraft/client/gui/GuiIngame.java
+++ b/src/net/minecraft/client/gui/GuiIngame.java
@@ -1,1194 +1,1284 @@
-package net.minecraft.client.gui;
-
-import com.google.common.base.Predicate;
-import com.google.common.collect.Iterables;
-import com.google.common.collect.Lists;
-import java.awt.Color;
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.Iterator;
-import java.util.Random;
-import net.minecraft.block.material.Material;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.RenderHelper;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.entity.RenderItem;
-import net.minecraft.client.renderer.texture.TextureAtlasSprite;
-import net.minecraft.client.renderer.texture.TextureMap;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.SharedMonsterAttributes;
-import net.minecraft.entity.ai.attributes.IAttributeInstance;
-import net.minecraft.entity.boss.BossStatus;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.init.Blocks;
-import net.minecraft.inventory.IInventory;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemStack;
-import net.minecraft.potion.Potion;
-import net.minecraft.scoreboard.Score;
-import net.minecraft.scoreboard.ScoreObjective;
-import net.minecraft.scoreboard.ScorePlayerTeam;
-import net.minecraft.scoreboard.Scoreboard;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumChatFormatting;
-import net.minecraft.util.FoodStats;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.StringUtils;
-import net.minecraft.world.border.WorldBorder;
-
-public class GuiIngame extends Gui
-{
-    private static final ResourceLocation vignetteTexPath = new ResourceLocation("textures/misc/vignette.png");
-    private static final ResourceLocation widgetsTexPath = new ResourceLocation("textures/gui/widgets.png");
-    private static final ResourceLocation pumpkinBlurTexPath = new ResourceLocation("textures/misc/pumpkinblur.png");
-    private final Random rand = new Random();
-    private final Minecraft mc;
-    private final RenderItem itemRenderer;
-
-    /** ChatGUI instance that retains all previous chat data */
-    private final GuiNewChat persistantChatGUI;
-    private final GuiStreamIndicator streamIndicator;
-    private int updateCounter;
-
-    /** The string specifying which record music is playing */
-    private String recordPlaying = "";
-
-    /** How many ticks the record playing message will be displayed */
-    private int recordPlayingUpFor;
-    private boolean recordIsPlaying;
-
-    /** Previous frame vignette brightness (slowly changes by 1% each frame) */
-    public float prevVignetteBrightness = 1.0F;
-
-    /** Remaining ticks the item highlight should be visible */
-    private int remainingHighlightTicks;
-
-    /** The ItemStack that is currently being highlighted */
-    private ItemStack highlightingItemStack;
-    private final GuiOverlayDebug overlayDebug;
-    private final GuiSpectator field_175197_u;
-    private final GuiPlayerTabOverlay overlayPlayerList;
-    private int field_175195_w;
-    private String field_175201_x = "";
-    private String field_175200_y = "";
-    private int field_175199_z;
-    private int field_175192_A;
-    private int field_175193_B;
-    private int field_175194_C = 0;
-    private int field_175189_D = 0;
-    private long field_175190_E = 0L;
-    private long field_175191_F = 0L;
-    private static final String __OBFID = "CL_00000661";
-
-    public GuiIngame(Minecraft mcIn)
-    {
-        this.mc = mcIn;
-        this.itemRenderer = mcIn.getRenderItem();
-        this.overlayDebug = new GuiOverlayDebug(mcIn);
-        this.field_175197_u = new GuiSpectator(mcIn);
-        this.persistantChatGUI = new GuiNewChat(mcIn);
-        this.streamIndicator = new GuiStreamIndicator(mcIn);
-        this.overlayPlayerList = new GuiPlayerTabOverlay(mcIn, this);
-        this.func_175177_a();
-    }
-
-    public void func_175177_a()
-    {
-        this.field_175199_z = 10;
-        this.field_175192_A = 70;
-        this.field_175193_B = 20;
-    }
-
-    public void func_175180_a(float p_175180_1_)
-    {
-        ScaledResolution var2 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
-        int var3 = var2.getScaledWidth();
-        int var4 = var2.getScaledHeight();
-        this.mc.entityRenderer.setupOverlayRendering();
-        GlStateManager.enableBlend();
-
-        if (Minecraft.isFancyGraphicsEnabled())
-        {
-            this.func_180480_a(this.mc.thePlayer.getBrightness(p_175180_1_), var2);
-        }
-        else
-        {
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        }
-
-        ItemStack var5 = this.mc.thePlayer.inventory.armorItemInSlot(3);
-
-        if (this.mc.gameSettings.thirdPersonView == 0 && var5 != null && var5.getItem() == Item.getItemFromBlock(Blocks.pumpkin))
-        {
-            this.func_180476_e(var2);
-        }
-
-        if (!this.mc.thePlayer.isPotionActive(Potion.confusion))
-        {
-            float var6 = this.mc.thePlayer.prevTimeInPortal + (this.mc.thePlayer.timeInPortal - this.mc.thePlayer.prevTimeInPortal) * p_175180_1_;
-
-            if (var6 > 0.0F)
-            {
-                this.func_180474_b(var6, var2);
-            }
-        }
-
-        if (this.mc.playerController.enableEverythingIsScrewedUpMode())
-        {
-            this.field_175197_u.func_175264_a(var2, p_175180_1_);
-        }
-        else
-        {
-            this.func_180479_a(var2, p_175180_1_);
-        }
-
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        this.mc.getTextureManager().bindTexture(icons);
-        GlStateManager.enableBlend();
-
-        if (this.func_175183_b())
-        {
-            GlStateManager.tryBlendFuncSeparate(775, 769, 1, 0);
-            GlStateManager.enableAlpha();
-            this.drawTexturedModalRect(var3 / 2 - 7, var4 / 2 - 7, 0, 0, 16, 16);
-        }
-
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        this.mc.mcProfiler.startSection("bossHealth");
-        this.renderBossHealth();
-        this.mc.mcProfiler.endSection();
-
-        if (this.mc.playerController.shouldDrawHUD())
-        {
-            this.func_180477_d(var2);
-        }
-
-        GlStateManager.disableBlend();
-        float var7;
-        int var8;
-        int var11;
-
-        if (this.mc.thePlayer.getSleepTimer() > 0)
-        {
-            this.mc.mcProfiler.startSection("sleep");
-            GlStateManager.disableDepth();
-            GlStateManager.disableAlpha();
-            var11 = this.mc.thePlayer.getSleepTimer();
-            var7 = (float)var11 / 100.0F;
-
-            if (var7 > 1.0F)
-            {
-                var7 = 1.0F - (float)(var11 - 100) / 10.0F;
-            }
-
-            var8 = (int)(220.0F * var7) << 24 | 1052704;
-            drawRect(0, 0, var3, var4, var8);
-            GlStateManager.enableAlpha();
-            GlStateManager.enableDepth();
-            this.mc.mcProfiler.endSection();
-        }
-
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        var11 = var3 / 2 - 91;
-
-        if (this.mc.thePlayer.isRidingHorse())
-        {
-            this.func_175186_a(var2, var11);
-        }
-        else if (this.mc.playerController.gameIsSurvivalOrAdventure())
-        {
-            this.func_175176_b(var2, var11);
-        }
-
-        if (this.mc.gameSettings.heldItemTooltips && !this.mc.playerController.enableEverythingIsScrewedUpMode())
-        {
-            this.func_175182_a(var2);
-        }
-        else if (this.mc.thePlayer.func_175149_v())
-        {
-            this.field_175197_u.func_175263_a(var2);
-        }
-
-        if (this.mc.isDemo())
-        {
-            this.func_175185_b(var2);
-        }
-
-        if (this.mc.gameSettings.showDebugInfo)
-        {
-            this.overlayDebug.func_175237_a(var2);
-        }
-
-        int var9;
-
-        if (this.recordPlayingUpFor > 0)
-        {
-            this.mc.mcProfiler.startSection("overlayMessage");
-            var7 = (float)this.recordPlayingUpFor - p_175180_1_;
-            var8 = (int)(var7 * 255.0F / 20.0F);
-
-            if (var8 > 255)
-            {
-                var8 = 255;
-            }
-
-            if (var8 > 8)
-            {
-                GlStateManager.pushMatrix();
-                GlStateManager.translate((float)(var3 / 2), (float)(var4 - 68), 0.0F);
-                GlStateManager.enableBlend();
-                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                var9 = 16777215;
-
-                if (this.recordIsPlaying)
-                {
-                    var9 = Color.HSBtoRGB(var7 / 50.0F, 0.7F, 0.6F) & 16777215;
-                }
-
-                this.func_175179_f().drawString(this.recordPlaying, -this.func_175179_f().getStringWidth(this.recordPlaying) / 2, -4, var9 + (var8 << 24 & -16777216));
-                GlStateManager.disableBlend();
-                GlStateManager.popMatrix();
-            }
-
-            this.mc.mcProfiler.endSection();
-        }
-
-        if (this.field_175195_w > 0)
-        {
-            this.mc.mcProfiler.startSection("titleAndSubtitle");
-            var7 = (float)this.field_175195_w - p_175180_1_;
-            var8 = 255;
-
-            if (this.field_175195_w > this.field_175193_B + this.field_175192_A)
-            {
-                float var14 = (float)(this.field_175199_z + this.field_175192_A + this.field_175193_B) - var7;
-                var8 = (int)(var14 * 255.0F / (float)this.field_175199_z);
-            }
-
-            if (this.field_175195_w <= this.field_175193_B)
-            {
-                var8 = (int)(var7 * 255.0F / (float)this.field_175193_B);
-            }
-
-            var8 = MathHelper.clamp_int(var8, 0, 255);
-
-            if (var8 > 8)
-            {
-                GlStateManager.pushMatrix();
-                GlStateManager.translate((float)(var3 / 2), (float)(var4 / 2), 0.0F);
-                GlStateManager.enableBlend();
-                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                GlStateManager.pushMatrix();
-                GlStateManager.scale(4.0F, 4.0F, 4.0F);
-                var9 = var8 << 24 & -16777216;
-                this.func_175179_f().func_175065_a(this.field_175201_x, (float)(-this.func_175179_f().getStringWidth(this.field_175201_x) / 2), -10.0F, 16777215 | var9, true);
-                GlStateManager.popMatrix();
-                GlStateManager.pushMatrix();
-                GlStateManager.scale(2.0F, 2.0F, 2.0F);
-                this.func_175179_f().func_175065_a(this.field_175200_y, (float)(-this.func_175179_f().getStringWidth(this.field_175200_y) / 2), 5.0F, 16777215 | var9, true);
-                GlStateManager.popMatrix();
-                GlStateManager.disableBlend();
-                GlStateManager.popMatrix();
-            }
-
-            this.mc.mcProfiler.endSection();
-        }
-
-        Scoreboard var12 = this.mc.theWorld.getScoreboard();
-        ScoreObjective var13 = null;
-        ScorePlayerTeam var15 = var12.getPlayersTeam(this.mc.thePlayer.getName());
-
-        if (var15 != null)
-        {
-            int var10 = var15.func_178775_l().func_175746_b();
-
-            if (var10 >= 0)
-            {
-                var13 = var12.getObjectiveInDisplaySlot(3 + var10);
-            }
-        }
-
-        ScoreObjective var16 = var13 != null ? var13 : var12.getObjectiveInDisplaySlot(1);
-
-        if (var16 != null)
-        {
-            this.func_180475_a(var16, var2);
-        }
-
-        GlStateManager.enableBlend();
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        GlStateManager.disableAlpha();
-        GlStateManager.pushMatrix();
-        GlStateManager.translate(0.0F, (float)(var4 - 48), 0.0F);
-        this.mc.mcProfiler.startSection("chat");
-        this.persistantChatGUI.drawChat(this.updateCounter);
-        this.mc.mcProfiler.endSection();
-        GlStateManager.popMatrix();
-        var16 = var12.getObjectiveInDisplaySlot(0);
-
-        if (this.mc.gameSettings.keyBindPlayerList.getIsKeyPressed() && (!this.mc.isIntegratedServerRunning() || this.mc.thePlayer.sendQueue.func_175106_d().size() > 1 || var16 != null))
-        {
-            this.overlayPlayerList.func_175246_a(true);
-            this.overlayPlayerList.func_175249_a(var3, var12, var16);
-        }
-        else
-        {
-            this.overlayPlayerList.func_175246_a(false);
-        }
-
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.disableLighting();
-        GlStateManager.enableAlpha();
-    }
-
-    protected void func_180479_a(ScaledResolution p_180479_1_, float p_180479_2_)
-    {
-        if (this.mc.func_175606_aa() instanceof EntityPlayer)
-        {
-            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-            this.mc.getTextureManager().bindTexture(widgetsTexPath);
-            EntityPlayer var3 = (EntityPlayer)this.mc.func_175606_aa();
-            int var4 = p_180479_1_.getScaledWidth() / 2;
-            float var5 = this.zLevel;
-            this.zLevel = -90.0F;
-            this.drawTexturedModalRect(var4 - 91, p_180479_1_.getScaledHeight() - 22, 0, 0, 182, 22);
-            this.drawTexturedModalRect(var4 - 91 - 1 + var3.inventory.currentItem * 20, p_180479_1_.getScaledHeight() - 22 - 1, 0, 22, 24, 22);
-            this.zLevel = var5;
-            GlStateManager.enableRescaleNormal();
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            RenderHelper.enableGUIStandardItemLighting();
-
-            for (int var6 = 0; var6 < 9; ++var6)
-            {
-                int var7 = p_180479_1_.getScaledWidth() / 2 - 90 + var6 * 20 + 2;
-                int var8 = p_180479_1_.getScaledHeight() - 16 - 3;
-                this.func_175184_a(var6, var7, var8, p_180479_2_, var3);
-            }
-
-            RenderHelper.disableStandardItemLighting();
-            GlStateManager.disableRescaleNormal();
-            GlStateManager.disableBlend();
-        }
-    }
-
-    public void func_175186_a(ScaledResolution p_175186_1_, int p_175186_2_)
-    {
-        this.mc.mcProfiler.startSection("jumpBar");
-        this.mc.getTextureManager().bindTexture(Gui.icons);
-        float var3 = this.mc.thePlayer.getHorseJumpPower();
-        short var4 = 182;
-        int var5 = (int)(var3 * (float)(var4 + 1));
-        int var6 = p_175186_1_.getScaledHeight() - 32 + 3;
-        this.drawTexturedModalRect(p_175186_2_, var6, 0, 84, var4, 5);
-
-        if (var5 > 0)
-        {
-            this.drawTexturedModalRect(p_175186_2_, var6, 0, 89, var5, 5);
-        }
-
-        this.mc.mcProfiler.endSection();
-    }
-
-    public void func_175176_b(ScaledResolution p_175176_1_, int p_175176_2_)
-    {
-        this.mc.mcProfiler.startSection("expBar");
-        this.mc.getTextureManager().bindTexture(Gui.icons);
-        int var3 = this.mc.thePlayer.xpBarCap();
-        int var6;
-
-        if (var3 > 0)
-        {
-            short var4 = 182;
-            int var5 = (int)(this.mc.thePlayer.experience * (float)(var4 + 1));
-            var6 = p_175176_1_.getScaledHeight() - 32 + 3;
-            this.drawTexturedModalRect(p_175176_2_, var6, 0, 64, var4, 5);
-
-            if (var5 > 0)
-            {
-                this.drawTexturedModalRect(p_175176_2_, var6, 0, 69, var5, 5);
-            }
-        }
-
-        this.mc.mcProfiler.endSection();
-
-        if (this.mc.thePlayer.experienceLevel > 0)
-        {
-            this.mc.mcProfiler.startSection("expLevel");
-            int var9 = 8453920;
-            String var10 = "" + this.mc.thePlayer.experienceLevel;
-            var6 = (p_175176_1_.getScaledWidth() - this.func_175179_f().getStringWidth(var10)) / 2;
-            int var7 = p_175176_1_.getScaledHeight() - 31 - 4;
-            boolean var8 = false;
-            this.func_175179_f().drawString(var10, var6 + 1, var7, 0);
-            this.func_175179_f().drawString(var10, var6 - 1, var7, 0);
-            this.func_175179_f().drawString(var10, var6, var7 + 1, 0);
-            this.func_175179_f().drawString(var10, var6, var7 - 1, 0);
-            this.func_175179_f().drawString(var10, var6, var7, var9);
-            this.mc.mcProfiler.endSection();
-        }
-    }
-
-    public void func_175182_a(ScaledResolution p_175182_1_)
-    {
-        this.mc.mcProfiler.startSection("toolHighlight");
-
-        if (this.remainingHighlightTicks > 0 && this.highlightingItemStack != null)
-        {
-            String var2 = this.highlightingItemStack.getDisplayName();
-
-            if (this.highlightingItemStack.hasDisplayName())
-            {
-                var2 = EnumChatFormatting.ITALIC + var2;
-            }
-
-            int var3 = (p_175182_1_.getScaledWidth() - this.func_175179_f().getStringWidth(var2)) / 2;
-            int var4 = p_175182_1_.getScaledHeight() - 59;
-
-            if (!this.mc.playerController.shouldDrawHUD())
-            {
-                var4 += 14;
-            }
-
-            int var5 = (int)((float)this.remainingHighlightTicks * 256.0F / 10.0F);
-
-            if (var5 > 255)
-            {
-                var5 = 255;
-            }
-
-            if (var5 > 0)
-            {
-                GlStateManager.pushMatrix();
-                GlStateManager.enableBlend();
-                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                this.func_175179_f().func_175063_a(var2, (float)var3, (float)var4, 16777215 + (var5 << 24));
-                GlStateManager.disableBlend();
-                GlStateManager.popMatrix();
-            }
-        }
-
-        this.mc.mcProfiler.endSection();
-    }
-
-    public void func_175185_b(ScaledResolution p_175185_1_)
-    {
-        this.mc.mcProfiler.startSection("demo");
-        String var2 = "";
-
-        if (this.mc.theWorld.getTotalWorldTime() >= 120500L)
-        {
-            var2 = I18n.format("demo.demoExpired", new Object[0]);
-        }
-        else
-        {
-            var2 = I18n.format("demo.remainingTime", new Object[] {StringUtils.ticksToElapsedTime((int)(120500L - this.mc.theWorld.getTotalWorldTime()))});
-        }
-
-        int var3 = this.func_175179_f().getStringWidth(var2);
-        this.func_175179_f().func_175063_a(var2, (float)(p_175185_1_.getScaledWidth() - var3 - 10), 5.0F, 16777215);
-        this.mc.mcProfiler.endSection();
-    }
-
-    protected boolean func_175183_b()
-    {
-        if (this.mc.gameSettings.showDebugInfo && !this.mc.thePlayer.func_175140_cp() && !this.mc.gameSettings.field_178879_v)
-        {
-            return false;
-        }
-        else if (this.mc.playerController.enableEverythingIsScrewedUpMode())
-        {
-            if (this.mc.pointedEntity != null)
-            {
-                return true;
-            }
-            else
-            {
-                if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
-                {
-                    BlockPos var1 = this.mc.objectMouseOver.func_178782_a();
-
-                    if (this.mc.theWorld.getTileEntity(var1) instanceof IInventory)
-                    {
-                        return true;
-                    }
-                }
-
-                return false;
-            }
-        }
-        else
-        {
-            return true;
-        }
-    }
-
-    public void func_180478_c(ScaledResolution p_180478_1_)
-    {
-        this.streamIndicator.render(p_180478_1_.getScaledWidth() - 10, 10);
-    }
-
-    private void func_180475_a(ScoreObjective p_180475_1_, ScaledResolution p_180475_2_)
-    {
-        Scoreboard var3 = p_180475_1_.getScoreboard();
-        Collection var4 = var3.getSortedScores(p_180475_1_);
-        ArrayList var5 = Lists.newArrayList(Iterables.filter(var4, new Predicate()
-        {
-            private static final String __OBFID = "CL_00001958";
-            public boolean func_178903_a(Score p_178903_1_)
-            {
-                return p_178903_1_.getPlayerName() != null && !p_178903_1_.getPlayerName().startsWith("#");
-            }
-            public boolean apply(Object p_apply_1_)
-            {
-                return this.func_178903_a((Score)p_apply_1_);
-            }
-        }));
-        ArrayList var21;
-
-        if (var5.size() > 15)
-        {
-            var21 = Lists.newArrayList(Iterables.skip(var5, var4.size() - 15));
-        }
-        else
-        {
-            var21 = var5;
-        }
-
-        int var6 = this.func_175179_f().getStringWidth(p_180475_1_.getDisplayName());
-        String var10;
-
-        for (Iterator var7 = var21.iterator(); var7.hasNext(); var6 = Math.max(var6, this.func_175179_f().getStringWidth(var10)))
-        {
-            Score var8 = (Score)var7.next();
-            ScorePlayerTeam var9 = var3.getPlayersTeam(var8.getPlayerName());
-            var10 = ScorePlayerTeam.formatPlayerName(var9, var8.getPlayerName()) + ": " + EnumChatFormatting.RED + var8.getScorePoints();
-        }
-
-        int var22 = var21.size() * this.func_175179_f().FONT_HEIGHT;
-        int var23 = p_180475_2_.getScaledHeight() / 2 + var22 / 3;
-        byte var24 = 3;
-        int var25 = p_180475_2_.getScaledWidth() - var6 - var24;
-        int var11 = 0;
-        Iterator var12 = var21.iterator();
-
-        while (var12.hasNext())
-        {
-            Score var13 = (Score)var12.next();
-            ++var11;
-            ScorePlayerTeam var14 = var3.getPlayersTeam(var13.getPlayerName());
-            String var15 = ScorePlayerTeam.formatPlayerName(var14, var13.getPlayerName());
-            String var16 = EnumChatFormatting.RED + "" + var13.getScorePoints();
-            int var18 = var23 - var11 * this.func_175179_f().FONT_HEIGHT;
-            int var19 = p_180475_2_.getScaledWidth() - var24 + 2;
-            drawRect(var25 - 2, var18, var19, var18 + this.func_175179_f().FONT_HEIGHT, 1342177280);
-            this.func_175179_f().drawString(var15, var25, var18, 553648127);
-            this.func_175179_f().drawString(var16, var19 - this.func_175179_f().getStringWidth(var16), var18, 553648127);
-
-            if (var11 == var21.size())
-            {
-                String var20 = p_180475_1_.getDisplayName();
-                drawRect(var25 - 2, var18 - this.func_175179_f().FONT_HEIGHT - 1, var19, var18 - 1, 1610612736);
-                drawRect(var25 - 2, var18 - 1, var19, var18, 1342177280);
-                this.func_175179_f().drawString(var20, var25 + var6 / 2 - this.func_175179_f().getStringWidth(var20) / 2, var18 - this.func_175179_f().FONT_HEIGHT, 553648127);
-            }
-        }
-    }
-
-    private void func_180477_d(ScaledResolution p_180477_1_)
-    {
-        if (this.mc.func_175606_aa() instanceof EntityPlayer)
-        {
-            EntityPlayer var2 = (EntityPlayer)this.mc.func_175606_aa();
-            int var3 = MathHelper.ceiling_float_int(var2.getHealth());
-            boolean var4 = this.field_175191_F > (long)this.updateCounter && (this.field_175191_F - (long)this.updateCounter) / 3L % 2L == 1L;
-
-            if (var3 < this.field_175194_C && var2.hurtResistantTime > 0)
-            {
-                this.field_175190_E = Minecraft.getSystemTime();
-                this.field_175191_F = (long)(this.updateCounter + 20);
-            }
-            else if (var3 > this.field_175194_C && var2.hurtResistantTime > 0)
-            {
-                this.field_175190_E = Minecraft.getSystemTime();
-                this.field_175191_F = (long)(this.updateCounter + 10);
-            }
-
-            if (Minecraft.getSystemTime() - this.field_175190_E > 1000L)
-            {
-                this.field_175194_C = var3;
-                this.field_175189_D = var3;
-                this.field_175190_E = Minecraft.getSystemTime();
-            }
-
-            this.field_175194_C = var3;
-            int var5 = this.field_175189_D;
-            this.rand.setSeed((long)(this.updateCounter * 312871));
-            boolean var6 = false;
-            FoodStats var7 = var2.getFoodStats();
-            int var8 = var7.getFoodLevel();
-            int var9 = var7.getPrevFoodLevel();
-            IAttributeInstance var10 = var2.getEntityAttribute(SharedMonsterAttributes.maxHealth);
-            int var11 = p_180477_1_.getScaledWidth() / 2 - 91;
-            int var12 = p_180477_1_.getScaledWidth() / 2 + 91;
-            int var13 = p_180477_1_.getScaledHeight() - 39;
-            float var14 = (float)var10.getAttributeValue();
-            float var15 = var2.getAbsorptionAmount();
-            int var16 = MathHelper.ceiling_float_int((var14 + var15) / 2.0F / 10.0F);
-            int var17 = Math.max(10 - (var16 - 2), 3);
-            int var18 = var13 - (var16 - 1) * var17 - 10;
-            float var19 = var15;
-            int var20 = var2.getTotalArmorValue();
-            int var21 = -1;
-
-            if (var2.isPotionActive(Potion.regeneration))
-            {
-                var21 = this.updateCounter % MathHelper.ceiling_float_int(var14 + 5.0F);
-            }
-
-            this.mc.mcProfiler.startSection("armor");
-            int var22;
-            int var23;
-
-            for (var22 = 0; var22 < 10; ++var22)
-            {
-                if (var20 > 0)
-                {
-                    var23 = var11 + var22 * 8;
-
-                    if (var22 * 2 + 1 < var20)
-                    {
-                        this.drawTexturedModalRect(var23, var18, 34, 9, 9, 9);
-                    }
-
-                    if (var22 * 2 + 1 == var20)
-                    {
-                        this.drawTexturedModalRect(var23, var18, 25, 9, 9, 9);
-                    }
-
-                    if (var22 * 2 + 1 > var20)
-                    {
-                        this.drawTexturedModalRect(var23, var18, 16, 9, 9, 9);
-                    }
-                }
-            }
-
-            this.mc.mcProfiler.endStartSection("health");
-            int var25;
-            int var26;
-            int var27;
-
-            for (var22 = MathHelper.ceiling_float_int((var14 + var15) / 2.0F) - 1; var22 >= 0; --var22)
-            {
-                var23 = 16;
-
-                if (var2.isPotionActive(Potion.poison))
-                {
-                    var23 += 36;
-                }
-                else if (var2.isPotionActive(Potion.wither))
-                {
-                    var23 += 72;
-                }
-
-                byte var24 = 0;
-
-                if (var4)
-                {
-                    var24 = 1;
-                }
-
-                var25 = MathHelper.ceiling_float_int((float)(var22 + 1) / 10.0F) - 1;
-                var26 = var11 + var22 % 10 * 8;
-                var27 = var13 - var25 * var17;
-
-                if (var3 <= 4)
-                {
-                    var27 += this.rand.nextInt(2);
-                }
-
-                if (var22 == var21)
-                {
-                    var27 -= 2;
-                }
-
-                byte var28 = 0;
-
-                if (var2.worldObj.getWorldInfo().isHardcoreModeEnabled())
-                {
-                    var28 = 5;
-                }
-
-                this.drawTexturedModalRect(var26, var27, 16 + var24 * 9, 9 * var28, 9, 9);
-
-                if (var4)
-                {
-                    if (var22 * 2 + 1 < var5)
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 54, 9 * var28, 9, 9);
-                    }
-
-                    if (var22 * 2 + 1 == var5)
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 63, 9 * var28, 9, 9);
-                    }
-                }
-
-                if (var19 > 0.0F)
-                {
-                    if (var19 == var15 && var15 % 2.0F == 1.0F)
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 153, 9 * var28, 9, 9);
-                    }
-                    else
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 144, 9 * var28, 9, 9);
-                    }
-
-                    var19 -= 2.0F;
-                }
-                else
-                {
-                    if (var22 * 2 + 1 < var3)
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 36, 9 * var28, 9, 9);
-                    }
-
-                    if (var22 * 2 + 1 == var3)
-                    {
-                        this.drawTexturedModalRect(var26, var27, var23 + 45, 9 * var28, 9, 9);
-                    }
-                }
-            }
-
-            Entity var34 = var2.ridingEntity;
-            int var36;
-
-            if (var34 == null)
-            {
-                this.mc.mcProfiler.endStartSection("food");
-
-                for (var23 = 0; var23 < 10; ++var23)
-                {
-                    var36 = var13;
-                    var25 = 16;
-                    byte var38 = 0;
-
-                    if (var2.isPotionActive(Potion.hunger))
-                    {
-                        var25 += 36;
-                        var38 = 13;
-                    }
-
-                    if (var2.getFoodStats().getSaturationLevel() <= 0.0F && this.updateCounter % (var8 * 3 + 1) == 0)
-                    {
-                        var36 = var13 + (this.rand.nextInt(3) - 1);
-                    }
-
-                    if (var6)
-                    {
-                        var38 = 1;
-                    }
-
-                    var27 = var12 - var23 * 8 - 9;
-                    this.drawTexturedModalRect(var27, var36, 16 + var38 * 9, 27, 9, 9);
-
-                    if (var6)
-                    {
-                        if (var23 * 2 + 1 < var9)
-                        {
-                            this.drawTexturedModalRect(var27, var36, var25 + 54, 27, 9, 9);
-                        }
-
-                        if (var23 * 2 + 1 == var9)
-                        {
-                            this.drawTexturedModalRect(var27, var36, var25 + 63, 27, 9, 9);
-                        }
-                    }
-
-                    if (var23 * 2 + 1 < var8)
-                    {
-                        this.drawTexturedModalRect(var27, var36, var25 + 36, 27, 9, 9);
-                    }
-
-                    if (var23 * 2 + 1 == var8)
-                    {
-                        this.drawTexturedModalRect(var27, var36, var25 + 45, 27, 9, 9);
-                    }
-                }
-            }
-            else if (var34 instanceof EntityLivingBase)
-            {
-                this.mc.mcProfiler.endStartSection("mountHealth");
-                EntityLivingBase var35 = (EntityLivingBase)var34;
-                var36 = (int)Math.ceil((double)var35.getHealth());
-                float var37 = var35.getMaxHealth();
-                var26 = (int)(var37 + 0.5F) / 2;
-
-                if (var26 > 30)
-                {
-                    var26 = 30;
-                }
-
-                var27 = var13;
-
-                for (int var39 = 0; var26 > 0; var39 += 20)
-                {
-                    int var29 = Math.min(var26, 10);
-                    var26 -= var29;
-
-                    for (int var30 = 0; var30 < var29; ++var30)
-                    {
-                        byte var31 = 52;
-                        byte var32 = 0;
-
-                        if (var6)
-                        {
-                            var32 = 1;
-                        }
-
-                        int var33 = var12 - var30 * 8 - 9;
-                        this.drawTexturedModalRect(var33, var27, var31 + var32 * 9, 9, 9, 9);
-
-                        if (var30 * 2 + 1 + var39 < var36)
-                        {
-                            this.drawTexturedModalRect(var33, var27, var31 + 36, 9, 9, 9);
-                        }
-
-                        if (var30 * 2 + 1 + var39 == var36)
-                        {
-                            this.drawTexturedModalRect(var33, var27, var31 + 45, 9, 9, 9);
-                        }
-                    }
-
-                    var27 -= 10;
-                }
-            }
-
-            this.mc.mcProfiler.endStartSection("air");
-
-            if (var2.isInsideOfMaterial(Material.water))
-            {
-                var23 = this.mc.thePlayer.getAir();
-                var36 = MathHelper.ceiling_double_int((double)(var23 - 2) * 10.0D / 300.0D);
-                var25 = MathHelper.ceiling_double_int((double)var23 * 10.0D / 300.0D) - var36;
-
-                for (var26 = 0; var26 < var36 + var25; ++var26)
-                {
-                    if (var26 < var36)
-                    {
-                        this.drawTexturedModalRect(var12 - var26 * 8 - 9, var18, 16, 18, 9, 9);
-                    }
-                    else
-                    {
-                        this.drawTexturedModalRect(var12 - var26 * 8 - 9, var18, 25, 18, 9, 9);
-                    }
-                }
-            }
-
-            this.mc.mcProfiler.endSection();
-        }
-    }
-
-    /**
-     * Renders dragon's (boss) health on the HUD
-     */
-    private void renderBossHealth()
-    {
-        if (BossStatus.bossName != null && BossStatus.statusBarTime > 0)
-        {
-            --BossStatus.statusBarTime;
-            FontRenderer var1 = this.mc.fontRendererObj;
-            ScaledResolution var2 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
-            int var3 = var2.getScaledWidth();
-            short var4 = 182;
-            int var5 = var3 / 2 - var4 / 2;
-            int var6 = (int)(BossStatus.healthScale * (float)(var4 + 1));
-            byte var7 = 12;
-            this.drawTexturedModalRect(var5, var7, 0, 74, var4, 5);
-            this.drawTexturedModalRect(var5, var7, 0, 74, var4, 5);
-
-            if (var6 > 0)
-            {
-                this.drawTexturedModalRect(var5, var7, 0, 79, var6, 5);
-            }
-
-            String var8 = BossStatus.bossName;
-            this.func_175179_f().func_175063_a(var8, (float)(var3 / 2 - this.func_175179_f().getStringWidth(var8) / 2), (float)(var7 - 10), 16777215);
-            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-            this.mc.getTextureManager().bindTexture(icons);
-        }
-    }
-
-    private void func_180476_e(ScaledResolution p_180476_1_)
-    {
-        GlStateManager.disableDepth();
-        GlStateManager.depthMask(false);
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.disableAlpha();
-        this.mc.getTextureManager().bindTexture(pumpkinBlurTexPath);
-        Tessellator var2 = Tessellator.getInstance();
-        WorldRenderer var3 = var2.getWorldRenderer();
-        var3.startDrawingQuads();
-        var3.addVertexWithUV(0.0D, (double)p_180476_1_.getScaledHeight(), -90.0D, 0.0D, 1.0D);
-        var3.addVertexWithUV((double)p_180476_1_.getScaledWidth(), (double)p_180476_1_.getScaledHeight(), -90.0D, 1.0D, 1.0D);
-        var3.addVertexWithUV((double)p_180476_1_.getScaledWidth(), 0.0D, -90.0D, 1.0D, 0.0D);
-        var3.addVertexWithUV(0.0D, 0.0D, -90.0D, 0.0D, 0.0D);
-        var2.draw();
-        GlStateManager.depthMask(true);
-        GlStateManager.enableDepth();
-        GlStateManager.enableAlpha();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-    }
-
-    private void func_180480_a(float p_180480_1_, ScaledResolution p_180480_2_)
-    {
-        p_180480_1_ = 1.0F - p_180480_1_;
-        p_180480_1_ = MathHelper.clamp_float(p_180480_1_, 0.0F, 1.0F);
-        WorldBorder var3 = this.mc.theWorld.getWorldBorder();
-        float var4 = (float)var3.getClosestDistance(this.mc.thePlayer);
-        double var5 = Math.min(var3.func_177749_o() * (double)var3.getWarningTime() * 1000.0D, Math.abs(var3.getTargetSize() - var3.getDiameter()));
-        double var7 = Math.max((double)var3.getWarningDistance(), var5);
-
-        if ((double)var4 < var7)
-        {
-            var4 = 1.0F - (float)((double)var4 / var7);
-        }
-        else
-        {
-            var4 = 0.0F;
-        }
-
-        this.prevVignetteBrightness = (float)((double)this.prevVignetteBrightness + (double)(p_180480_1_ - this.prevVignetteBrightness) * 0.01D);
-        GlStateManager.disableDepth();
-        GlStateManager.depthMask(false);
-        GlStateManager.tryBlendFuncSeparate(0, 769, 1, 0);
-
-        if (var4 > 0.0F)
-        {
-            GlStateManager.color(0.0F, var4, var4, 1.0F);
-        }
-        else
-        {
-            GlStateManager.color(this.prevVignetteBrightness, this.prevVignetteBrightness, this.prevVignetteBrightness, 1.0F);
-        }
-
-        this.mc.getTextureManager().bindTexture(vignetteTexPath);
-        Tessellator var9 = Tessellator.getInstance();
-        WorldRenderer var10 = var9.getWorldRenderer();
-        var10.startDrawingQuads();
-        var10.addVertexWithUV(0.0D, (double)p_180480_2_.getScaledHeight(), -90.0D, 0.0D, 1.0D);
-        var10.addVertexWithUV((double)p_180480_2_.getScaledWidth(), (double)p_180480_2_.getScaledHeight(), -90.0D, 1.0D, 1.0D);
-        var10.addVertexWithUV((double)p_180480_2_.getScaledWidth(), 0.0D, -90.0D, 1.0D, 0.0D);
-        var10.addVertexWithUV(0.0D, 0.0D, -90.0D, 0.0D, 0.0D);
-        var9.draw();
-        GlStateManager.depthMask(true);
-        GlStateManager.enableDepth();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-    }
-
-    private void func_180474_b(float p_180474_1_, ScaledResolution p_180474_2_)
-    {
-        if (p_180474_1_ < 1.0F)
-        {
-            p_180474_1_ *= p_180474_1_;
-            p_180474_1_ *= p_180474_1_;
-            p_180474_1_ = p_180474_1_ * 0.8F + 0.2F;
-        }
-
-        GlStateManager.disableAlpha();
-        GlStateManager.disableDepth();
-        GlStateManager.depthMask(false);
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, p_180474_1_);
-        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
-        TextureAtlasSprite var3 = this.mc.getBlockRendererDispatcher().func_175023_a().func_178122_a(Blocks.portal.getDefaultState());
-        float var4 = var3.getMinU();
-        float var5 = var3.getMinV();
-        float var6 = var3.getMaxU();
-        float var7 = var3.getMaxV();
-        Tessellator var8 = Tessellator.getInstance();
-        WorldRenderer var9 = var8.getWorldRenderer();
-        var9.startDrawingQuads();
-        var9.addVertexWithUV(0.0D, (double)p_180474_2_.getScaledHeight(), -90.0D, (double)var4, (double)var7);
-        var9.addVertexWithUV((double)p_180474_2_.getScaledWidth(), (double)p_180474_2_.getScaledHeight(), -90.0D, (double)var6, (double)var7);
-        var9.addVertexWithUV((double)p_180474_2_.getScaledWidth(), 0.0D, -90.0D, (double)var6, (double)var5);
-        var9.addVertexWithUV(0.0D, 0.0D, -90.0D, (double)var4, (double)var5);
-        var8.draw();
-        GlStateManager.depthMask(true);
-        GlStateManager.enableDepth();
-        GlStateManager.enableAlpha();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-    }
-
-    private void func_175184_a(int p_175184_1_, int p_175184_2_, int p_175184_3_, float p_175184_4_, EntityPlayer p_175184_5_)
-    {
-        ItemStack var6 = p_175184_5_.inventory.mainInventory[p_175184_1_];
-
-        if (var6 != null)
-        {
-            float var7 = (float)var6.animationsToGo - p_175184_4_;
-
-            if (var7 > 0.0F)
-            {
-                GlStateManager.pushMatrix();
-                float var8 = 1.0F + var7 / 5.0F;
-                GlStateManager.translate((float)(p_175184_2_ + 8), (float)(p_175184_3_ + 12), 0.0F);
-                GlStateManager.scale(1.0F / var8, (var8 + 1.0F) / 2.0F, 1.0F);
-                GlStateManager.translate((float)(-(p_175184_2_ + 8)), (float)(-(p_175184_3_ + 12)), 0.0F);
-            }
-
-            this.itemRenderer.func_180450_b(var6, p_175184_2_, p_175184_3_);
-
-            if (var7 > 0.0F)
-            {
-                GlStateManager.popMatrix();
-            }
-
-            this.itemRenderer.func_175030_a(this.mc.fontRendererObj, var6, p_175184_2_, p_175184_3_);
-        }
-    }
-
-    /**
-     * The update tick for the ingame UI
-     */
-    public void updateTick()
-    {
-        if (this.recordPlayingUpFor > 0)
-        {
-            --this.recordPlayingUpFor;
-        }
-
-        if (this.field_175195_w > 0)
-        {
-            --this.field_175195_w;
-
-            if (this.field_175195_w <= 0)
-            {
-                this.field_175201_x = "";
-                this.field_175200_y = "";
-            }
-        }
-
-        ++this.updateCounter;
-        this.streamIndicator.func_152439_a();
-
-        if (this.mc.thePlayer != null)
-        {
-            ItemStack var1 = this.mc.thePlayer.inventory.getCurrentItem();
-
-            if (var1 == null)
-            {
-                this.remainingHighlightTicks = 0;
-            }
-            else if (this.highlightingItemStack != null && var1.getItem() == this.highlightingItemStack.getItem() && ItemStack.areItemStackTagsEqual(var1, this.highlightingItemStack) && (var1.isItemStackDamageable() || var1.getMetadata() == this.highlightingItemStack.getMetadata()))
-            {
-                if (this.remainingHighlightTicks > 0)
-                {
-                    --this.remainingHighlightTicks;
-                }
-            }
-            else
-            {
-                this.remainingHighlightTicks = 40;
-            }
-
-            this.highlightingItemStack = var1;
-        }
-    }
-
-    public void setRecordPlayingMessage(String p_73833_1_)
-    {
-        this.setRecordPlaying(I18n.format("record.nowPlaying", new Object[] {p_73833_1_}), true);
-    }
-
-    public void setRecordPlaying(String p_110326_1_, boolean p_110326_2_)
-    {
-        this.recordPlaying = p_110326_1_;
-        this.recordPlayingUpFor = 60;
-        this.recordIsPlaying = p_110326_2_;
-    }
-
-    public void func_175178_a(String p_175178_1_, String p_175178_2_, int p_175178_3_, int p_175178_4_, int p_175178_5_)
-    {
-        if (p_175178_1_ == null && p_175178_2_ == null && p_175178_3_ < 0 && p_175178_4_ < 0 && p_175178_5_ < 0)
-        {
-            this.field_175201_x = "";
-            this.field_175200_y = "";
-            this.field_175195_w = 0;
-        }
-        else if (p_175178_1_ != null)
-        {
-            this.field_175201_x = p_175178_1_;
-            this.field_175195_w = this.field_175199_z + this.field_175192_A + this.field_175193_B;
-        }
-        else if (p_175178_2_ != null)
-        {
-            this.field_175200_y = p_175178_2_;
-        }
-        else
-        {
-            if (p_175178_3_ >= 0)
-            {
-                this.field_175199_z = p_175178_3_;
-            }
-
-            if (p_175178_4_ >= 0)
-            {
-                this.field_175192_A = p_175178_4_;
-            }
-
-            if (p_175178_5_ >= 0)
-            {
-                this.field_175193_B = p_175178_5_;
-            }
-
-            if (this.field_175195_w > 0)
-            {
-                this.field_175195_w = this.field_175199_z + this.field_175192_A + this.field_175193_B;
-            }
-        }
-    }
-
-    public void func_175188_a(IChatComponent p_175188_1_, boolean p_175188_2_)
-    {
-        this.setRecordPlaying(p_175188_1_.getUnformattedText(), p_175188_2_);
-    }
-
-    /**
-     * returns a pointer to the persistant Chat GUI, containing all previous chat messages and such
-     */
-    public GuiNewChat getChatGUI()
-    {
-        return this.persistantChatGUI;
-    }
-
-    public int getUpdateCounter()
-    {
-        return this.updateCounter;
-    }
-
-    public FontRenderer func_175179_f()
-    {
-        return this.mc.fontRendererObj;
-    }
-
-    public GuiSpectator func_175187_g()
-    {
-        return this.field_175197_u;
-    }
-
-    public GuiPlayerTabOverlay getTabList()
-    {
-        return this.overlayPlayerList;
-    }
-}
+package net.minecraft.client.gui;
+
+import static org.lwjgl.opengl.GL11.GL_BLEND;
+import static org.lwjgl.opengl.GL11.GL_CULL_FACE;
+import static org.lwjgl.opengl.GL11.GL_ONE_MINUS_SRC_ALPHA;
+import static org.lwjgl.opengl.GL11.GL_QUADS;
+import static org.lwjgl.opengl.GL11.GL_SRC_ALPHA;
+import static org.lwjgl.opengl.GL11.GL_TEXTURE_2D;
+import static org.lwjgl.opengl.GL11.glBegin;
+import static org.lwjgl.opengl.GL11.glBlendFunc;
+import static org.lwjgl.opengl.GL11.glDisable;
+import static org.lwjgl.opengl.GL11.glEnable;
+import static org.lwjgl.opengl.GL11.glEnd;
+import static org.lwjgl.opengl.GL11.glVertex2d;
+
+import java.awt.Color;
+import java.util.ArrayList;
+import java.util.Collection;
+import java.util.Iterator;
+import java.util.Random;
+
+import net.minecraft.block.material.Material;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.OpenGlHelper;
+import net.minecraft.client.renderer.RenderHelper;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.entity.RenderItem;
+import net.minecraft.client.renderer.texture.TextureAtlasSprite;
+import net.minecraft.client.renderer.texture.TextureMap;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.SharedMonsterAttributes;
+import net.minecraft.entity.ai.attributes.IAttributeInstance;
+import net.minecraft.entity.boss.BossStatus;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.init.Blocks;
+import net.minecraft.inventory.IInventory;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemStack;
+import net.minecraft.potion.Potion;
+import net.minecraft.scoreboard.Score;
+import net.minecraft.scoreboard.ScoreObjective;
+import net.minecraft.scoreboard.ScorePlayerTeam;
+import net.minecraft.scoreboard.Scoreboard;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.EnumChatFormatting;
+import net.minecraft.util.FoodStats;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.MovingObjectPosition;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.util.StringUtils;
+import net.minecraft.world.border.WorldBorder;
+
+import org.darkstorm.minecraft.gui.util.RenderUtil;
+import org.lwjgl.opengl.GL11;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.EventManager;
+import tk.wurst_client.events.GUIRenderEvent;
+import tk.wurst_client.font.Fonts;
+import tk.wurst_client.gui.UIRenderer;
+import tk.wurst_client.mods.ArenaBrawlMod;
+import tk.wurst_client.mods.Mod;
+
+import com.google.common.base.Predicate;
+import com.google.common.collect.Iterables;
+import com.google.common.collect.Lists;
+
+public class GuiIngame extends Gui
+{
+    private static final ResourceLocation vignetteTexPath = new ResourceLocation("textures/misc/vignette.png");
+    private static final ResourceLocation widgetsTexPath = new ResourceLocation("textures/gui/widgets.png");
+    private static final ResourceLocation pumpkinBlurTexPath = new ResourceLocation("textures/misc/pumpkinblur.png");
+    //TODO: Client
+    private static final ResourceLocation wurstTextures = new ResourceLocation("wurst/wurst_128.png");
+    private final Random rand = new Random();
+    private final Minecraft mc;
+    private final RenderItem itemRenderer;
+
+    /** ChatGUI instance that retains all previous chat data */
+    private final GuiNewChat persistantChatGUI;
+    private final GuiStreamIndicator streamIndicator;
+    private int updateCounter;
+
+    /** The string specifying which record music is playing */
+    private String recordPlaying = "";
+
+    /** How many ticks the record playing message will be displayed */
+    private int recordPlayingUpFor;
+    private boolean recordIsPlaying;
+
+    /** Previous frame vignette brightness (slowly changes by 1% each frame) */
+    public float prevVignetteBrightness = 1.0F;
+
+    /** Remaining ticks the item highlight should be visible */
+    private int remainingHighlightTicks;
+
+    /** The ItemStack that is currently being highlighted */
+    private ItemStack highlightingItemStack;
+    private final GuiOverlayDebug overlayDebug;
+    private final GuiSpectator field_175197_u;
+    private final GuiPlayerTabOverlay overlayPlayerList;
+    private int field_175195_w;
+    private String field_175201_x = "";
+    private String field_175200_y = "";
+    private int field_175199_z;
+    private int field_175192_A;
+    private int field_175193_B;
+    private int field_175194_C = 0;
+    private int field_175189_D = 0;
+    private long field_175190_E = 0L;
+    private long field_175191_F = 0L;
+    private static final String __OBFID = "CL_00000661";
+
+    public GuiIngame(Minecraft mcIn)
+    {
+        this.mc = mcIn;
+        this.itemRenderer = mcIn.getRenderItem();
+        this.overlayDebug = new GuiOverlayDebug(mcIn);
+        this.field_175197_u = new GuiSpectator(mcIn);
+        this.persistantChatGUI = new GuiNewChat(mcIn);
+        this.streamIndicator = new GuiStreamIndicator(mcIn);
+        this.overlayPlayerList = new GuiPlayerTabOverlay(mcIn, this);
+        this.func_175177_a();
+    }
+
+    public void func_175177_a()
+    {
+        this.field_175199_z = 10;
+        this.field_175192_A = 70;
+        this.field_175193_B = 20;
+    }
+
+    public void func_175180_a(float p_175180_1_)
+    {
+        ScaledResolution var2 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
+        int var3 = var2.getScaledWidth();
+        int var4 = var2.getScaledHeight();
+        this.mc.entityRenderer.setupOverlayRendering();
+        GlStateManager.enableBlend();
+
+        if (Minecraft.isFancyGraphicsEnabled())
+        {
+            this.func_180480_a(this.mc.thePlayer.getBrightness(p_175180_1_), var2);
+        }
+        else
+        {
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        }
+
+        ItemStack var5 = this.mc.thePlayer.inventory.armorItemInSlot(3);
+
+        if (this.mc.gameSettings.thirdPersonView == 0 && var5 != null && var5.getItem() == Item.getItemFromBlock(Blocks.pumpkin))
+        {
+            this.func_180476_e(var2);
+        }
+
+        if (!this.mc.thePlayer.isPotionActive(Potion.confusion))
+        {
+            float var6 = this.mc.thePlayer.prevTimeInPortal + (this.mc.thePlayer.timeInPortal - this.mc.thePlayer.prevTimeInPortal) * p_175180_1_;
+
+            if (var6 > 0.0F)
+            {
+                this.func_180474_b(var6, var2);
+            }
+        }
+
+        if (this.mc.playerController.enableEverythingIsScrewedUpMode())
+        {
+            this.field_175197_u.func_175264_a(var2, p_175180_1_);
+        }
+        else
+        {
+            this.func_180479_a(var2, p_175180_1_);
+        }
+
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        this.mc.getTextureManager().bindTexture(icons);
+        GlStateManager.enableBlend();
+
+        if (this.func_175183_b())
+        {
+            GlStateManager.tryBlendFuncSeparate(775, 769, 1, 0);
+            GlStateManager.enableAlpha();
+            this.drawTexturedModalRect(var3 / 2 - 7, var4 / 2 - 7, 0, 0, 16, 16);
+        }
+
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        this.mc.mcProfiler.startSection("bossHealth");
+        this.renderBossHealth();
+        this.mc.mcProfiler.endSection();
+
+        if (this.mc.playerController.shouldDrawHUD())
+        {
+            this.func_180477_d(var2);
+        }
+
+        GlStateManager.disableBlend();
+        float var7;
+        int var8;
+        int var11;
+
+        if (this.mc.thePlayer.getSleepTimer() > 0)
+        {
+            this.mc.mcProfiler.startSection("sleep");
+            GlStateManager.disableDepth();
+            GlStateManager.disableAlpha();
+            var11 = this.mc.thePlayer.getSleepTimer();
+            var7 = (float)var11 / 100.0F;
+
+            if (var7 > 1.0F)
+            {
+                var7 = 1.0F - (float)(var11 - 100) / 10.0F;
+            }
+
+            var8 = (int)(220.0F * var7) << 24 | 1052704;
+            drawRect(0, 0, var3, var4, var8);
+            GlStateManager.enableAlpha();
+            GlStateManager.enableDepth();
+            this.mc.mcProfiler.endSection();
+        }
+
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        var11 = var3 / 2 - 91;
+
+        if (this.mc.thePlayer.isRidingHorse())
+        {
+            this.func_175186_a(var2, var11);
+        }
+        else if (this.mc.playerController.gameIsSurvivalOrAdventure())
+        {
+            this.func_175176_b(var2, var11);
+        }
+
+        if (this.mc.gameSettings.heldItemTooltips && !this.mc.playerController.enableEverythingIsScrewedUpMode())
+        {
+            this.func_175182_a(var2);
+        }
+        else if (this.mc.thePlayer.isSpectator())
+        {
+            this.field_175197_u.func_175263_a(var2);
+        }
+
+        if (this.mc.isDemo())
+        {
+            this.func_175185_b(var2);
+        }
+
+        if (this.mc.gameSettings.showDebugInfo)
+        {
+            this.overlayDebug.func_175237_a(var2);
+        }
+
+        int var9;
+
+        if (this.recordPlayingUpFor > 0)
+        {
+            this.mc.mcProfiler.startSection("overlayMessage");
+            var7 = (float)this.recordPlayingUpFor - p_175180_1_;
+            var8 = (int)(var7 * 255.0F / 20.0F);
+
+            if (var8 > 255)
+            {
+                var8 = 255;
+            }
+
+            if (var8 > 8)
+            {
+                GlStateManager.pushMatrix();
+                GlStateManager.translate((float)(var3 / 2), (float)(var4 - 68), 0.0F);
+                GlStateManager.enableBlend();
+                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+                var9 = 16777215;
+
+                if (this.recordIsPlaying)
+                {
+                    var9 = Color.HSBtoRGB(var7 / 50.0F, 0.7F, 0.6F) & 16777215;
+                }
+
+                this.func_175179_f().drawString(this.recordPlaying, -this.func_175179_f().getStringWidth(this.recordPlaying) / 2, -4, var9 + (var8 << 24 & -16777216));
+                GlStateManager.disableBlend();
+                GlStateManager.popMatrix();
+            }
+
+            this.mc.mcProfiler.endSection();
+        }
+
+        if (this.field_175195_w > 0)
+        {
+            this.mc.mcProfiler.startSection("titleAndSubtitle");
+            var7 = (float)this.field_175195_w - p_175180_1_;
+            var8 = 255;
+
+            if (this.field_175195_w > this.field_175193_B + this.field_175192_A)
+            {
+                float var14 = (float)(this.field_175199_z + this.field_175192_A + this.field_175193_B) - var7;
+                var8 = (int)(var14 * 255.0F / (float)this.field_175199_z);
+            }
+
+            if (this.field_175195_w <= this.field_175193_B)
+            {
+                var8 = (int)(var7 * 255.0F / (float)this.field_175193_B);
+            }
+
+            var8 = MathHelper.clamp_int(var8, 0, 255);
+
+            if (var8 > 8)
+            {
+                GlStateManager.pushMatrix();
+                GlStateManager.translate((float)(var3 / 2), (float)(var4 / 2), 0.0F);
+                GlStateManager.enableBlend();
+                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+                GlStateManager.pushMatrix();
+                GlStateManager.scale(4.0F, 4.0F, 4.0F);
+                var9 = var8 << 24 & -16777216;
+                this.func_175179_f().drawString(this.field_175201_x, (float)(-this.func_175179_f().getStringWidth(this.field_175201_x) / 2), -10.0F, 16777215 | var9, true);
+                GlStateManager.popMatrix();
+                GlStateManager.pushMatrix();
+                GlStateManager.scale(2.0F, 2.0F, 2.0F);
+                this.func_175179_f().drawString(this.field_175200_y, (float)(-this.func_175179_f().getStringWidth(this.field_175200_y) / 2), 5.0F, 16777215 | var9, true);
+                GlStateManager.popMatrix();
+                GlStateManager.disableBlend();
+                GlStateManager.popMatrix();
+            }
+
+            this.mc.mcProfiler.endSection();
+        }
+
+        Scoreboard var12 = this.mc.theWorld.getScoreboard();
+        ScoreObjective var13 = null;
+        ScorePlayerTeam var15 = var12.getPlayersTeam(this.mc.thePlayer.getName());
+
+        if (var15 != null)
+        {
+            int var10 = var15.func_178775_l().func_175746_b();
+
+            if (var10 >= 0)
+            {
+                var13 = var12.getObjectiveInDisplaySlot(3 + var10);
+            }
+        }
+
+        ScoreObjective var16 = var13 != null ? var13 : var12.getObjectiveInDisplaySlot(1);
+
+        if (var16 != null)
+        {
+            this.func_180475_a(var16, var2);
+            //TODO: Client
+        }else
+        {
+            ArenaBrawlMod.scoreboard = null;
+        }
+
+        //TODO: Client
+        if(!this.mc.gameSettings.showDebugInfo)
+        {
+        	glEnable(GL_BLEND);
+    		glDisable(GL_CULL_FACE);
+    		glDisable(GL_TEXTURE_2D);
+    		glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+            RenderUtil.setColor(new Color(255, 255, 255, 128));
+    		glBegin(GL_QUADS);
+    		{
+    			glVertex2d(0, 6);
+    			glVertex2d(Fonts.segoe22.getStringWidth("v" + WurstClient.INSTANCE.VERSION) + 78, 6);
+    			glVertex2d(Fonts.segoe22.getStringWidth("v" + WurstClient.INSTANCE.VERSION) + 78, 18);
+    			glVertex2d(0, 18);
+    		}
+    		glEnd();
+    		glEnable(GL_TEXTURE_2D);
+    		glEnable(GL_CULL_FACE);
+            GL11.glDisable(GL11.GL_DEPTH_TEST);
+            GL11.glDepthMask(false);
+            UIRenderer.renderUI();
+            UIRenderer.renderPinnedFrames();
+            OpenGlHelper.glBlendFunc(770, 771, 1, 0);
+            GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
+            this.mc.getTextureManager().bindTexture(wurstTextures);
+            Tessellator ts = Tessellator.getInstance();
+            WorldRenderer wr = ts.getWorldRenderer();
+            double x = 0;
+            double y = 3;
+            double h = 18;
+            double w = 72;
+            double fw = 256;
+            double fh = 256;
+            double u1 = 0;
+            double v1 = 0;
+            wr.startDrawingQuads();
+            wr.addVertexWithUV((double)x + 0, (double)y + h, (double)this.zLevel, (double)((float)(u1 + 0) * 0.00390625F), (double)((float)(v1 + fh) * 0.00390625F));
+            wr.addVertexWithUV((double)x + w, (double)y + h, (double)this.zLevel, (double)((float)(u1 + fw) * 0.00390625F), (double)((float)(v1 + fh) * 0.00390625F));
+            wr.addVertexWithUV((double)x + w, (double)y + 0, (double)this.zLevel, (double)((float)(u1 + fw) * 0.00390625F), (double)((float)(v1 + 0) * 0.00390625F));
+            wr.addVertexWithUV((double)x + 0, (double)y + 0, (double)this.zLevel, (double)((float)(u1 + 0) * 0.00390625F), (double)((float)(v1 + 0) * 0.00390625F));
+            ts.draw();
+            WurstClient.INSTANCE.eventManager.fireEvent(GUIRenderEvent.class, new GUIRenderEvent());
+            GL11.glDepthMask(true);
+            GL11.glEnable(GL11.GL_DEPTH_TEST);
+            GL11.glEnable(GL11.GL_ALPHA_TEST);
+            GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
+            GL11.glPushMatrix();
+            
+            GL11.glPopMatrix();
+        }
+
+        GlStateManager.enableBlend();
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        GlStateManager.disableAlpha();
+        GlStateManager.pushMatrix();
+        GlStateManager.translate(0.0F, (float)(var4 - 48), 0.0F);
+        this.mc.mcProfiler.startSection("chat");
+        this.persistantChatGUI.drawChat(this.updateCounter);
+        this.mc.mcProfiler.endSection();
+        GlStateManager.popMatrix();
+        var16 = var12.getObjectiveInDisplaySlot(0);
+
+        if (this.mc.gameSettings.keyBindPlayerList.getIsKeyPressed() && (!this.mc.isIntegratedServerRunning() || this.mc.thePlayer.sendQueue.getPlayerInfo().size() > 1 || var16 != null))
+        {
+            this.overlayPlayerList.func_175246_a(true);
+            this.overlayPlayerList.func_175249_a(var3, var12, var16);
+        }
+        else
+        {
+            this.overlayPlayerList.func_175246_a(false);
+        }
+
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.disableLighting();
+        GlStateManager.enableAlpha();
+    }
+
+    protected void func_180479_a(ScaledResolution p_180479_1_, float p_180479_2_)
+    {
+        if (this.mc.func_175606_aa() instanceof EntityPlayer)
+        {
+            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+            this.mc.getTextureManager().bindTexture(widgetsTexPath);
+            EntityPlayer var3 = (EntityPlayer)this.mc.func_175606_aa();
+            int var4 = p_180479_1_.getScaledWidth() / 2;
+            float var5 = this.zLevel;
+            this.zLevel = -90.0F;
+            this.drawTexturedModalRect(var4 - 91, p_180479_1_.getScaledHeight() - 22, 0, 0, 182, 22);
+            this.drawTexturedModalRect(var4 - 91 - 1 + var3.inventory.currentItem * 20, p_180479_1_.getScaledHeight() - 22 - 1, 0, 22, 24, 22);
+            this.zLevel = var5;
+            GlStateManager.enableRescaleNormal();
+            GlStateManager.enableBlend();
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+            RenderHelper.enableGUIStandardItemLighting();
+
+            for (int var6 = 0; var6 < 9; ++var6)
+            {
+                int var7 = p_180479_1_.getScaledWidth() / 2 - 90 + var6 * 20 + 2;
+                int var8 = p_180479_1_.getScaledHeight() - 16 - 3;
+                this.func_175184_a(var6, var7, var8, p_180479_2_, var3);
+            }
+
+            RenderHelper.disableStandardItemLighting();
+            GlStateManager.disableRescaleNormal();
+            GlStateManager.disableBlend();
+        }
+    }
+
+    public void func_175186_a(ScaledResolution p_175186_1_, int p_175186_2_)
+    {
+        this.mc.mcProfiler.startSection("jumpBar");
+        this.mc.getTextureManager().bindTexture(Gui.icons);
+        float var3 = this.mc.thePlayer.getHorseJumpPower();
+        short var4 = 182;
+        int var5 = (int)(var3 * (float)(var4 + 1));
+        int var6 = p_175186_1_.getScaledHeight() - 32 + 3;
+        this.drawTexturedModalRect(p_175186_2_, var6, 0, 84, var4, 5);
+
+        if (var5 > 0)
+        {
+            this.drawTexturedModalRect(p_175186_2_, var6, 0, 89, var5, 5);
+        }
+
+        this.mc.mcProfiler.endSection();
+    }
+
+    public void func_175176_b(ScaledResolution p_175176_1_, int p_175176_2_)
+    {
+        this.mc.mcProfiler.startSection("expBar");
+        this.mc.getTextureManager().bindTexture(Gui.icons);
+        int var3 = this.mc.thePlayer.xpBarCap();
+        int var6;
+
+        if (var3 > 0)
+        {
+            short var4 = 182;
+            int var5 = (int)(this.mc.thePlayer.experience * (float)(var4 + 1));
+            var6 = p_175176_1_.getScaledHeight() - 32 + 3;
+            this.drawTexturedModalRect(p_175176_2_, var6, 0, 64, var4, 5);
+
+            if (var5 > 0)
+            {
+                this.drawTexturedModalRect(p_175176_2_, var6, 0, 69, var5, 5);
+            }
+        }
+
+        this.mc.mcProfiler.endSection();
+
+        if (this.mc.thePlayer.experienceLevel > 0)
+        {
+            this.mc.mcProfiler.startSection("expLevel");
+            int var9 = 8453920;
+            String var10 = "" + this.mc.thePlayer.experienceLevel;
+            var6 = (p_175176_1_.getScaledWidth() - this.func_175179_f().getStringWidth(var10)) / 2;
+            int var7 = p_175176_1_.getScaledHeight() - 31 - 4;
+            boolean var8 = false;
+            this.func_175179_f().drawString(var10, var6 + 1, var7, 0);
+            this.func_175179_f().drawString(var10, var6 - 1, var7, 0);
+            this.func_175179_f().drawString(var10, var6, var7 + 1, 0);
+            this.func_175179_f().drawString(var10, var6, var7 - 1, 0);
+            this.func_175179_f().drawString(var10, var6, var7, var9);
+            this.mc.mcProfiler.endSection();
+        }
+    }
+
+    public void func_175182_a(ScaledResolution p_175182_1_)
+    {
+        this.mc.mcProfiler.startSection("toolHighlight");
+
+        if (this.remainingHighlightTicks > 0 && this.highlightingItemStack != null)
+        {
+            String var2 = this.highlightingItemStack.getDisplayName();
+
+            if (this.highlightingItemStack.hasDisplayName())
+            {
+                var2 = EnumChatFormatting.ITALIC + var2;
+            }
+
+            int var3 = (p_175182_1_.getScaledWidth() - this.func_175179_f().getStringWidth(var2)) / 2;
+            int var4 = p_175182_1_.getScaledHeight() - 59;
+
+            if (!this.mc.playerController.shouldDrawHUD())
+            {
+                var4 += 14;
+            }
+
+            int var5 = (int)((float)this.remainingHighlightTicks * 256.0F / 10.0F);
+
+            if (var5 > 255)
+            {
+                var5 = 255;
+            }
+
+            if (var5 > 0)
+            {
+                GlStateManager.pushMatrix();
+                GlStateManager.enableBlend();
+                GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+                this.func_175179_f().drawStringWithShadow(var2, (float)var3, (float)var4, 16777215 + (var5 << 24));
+                GlStateManager.disableBlend();
+                GlStateManager.popMatrix();
+            }
+        }
+
+        this.mc.mcProfiler.endSection();
+    }
+
+    public void func_175185_b(ScaledResolution p_175185_1_)
+    {
+        this.mc.mcProfiler.startSection("demo");
+        String var2 = "";
+
+        if (this.mc.theWorld.getTotalWorldTime() >= 120500L)
+        {
+            var2 = I18n.format("demo.demoExpired", new Object[0]);
+        }
+        else
+        {
+            var2 = I18n.format("demo.remainingTime", new Object[] {StringUtils.ticksToElapsedTime((int)(120500L - this.mc.theWorld.getTotalWorldTime()))});
+        }
+
+        int var3 = this.func_175179_f().getStringWidth(var2);
+        this.func_175179_f().drawStringWithShadow(var2, (float)(p_175185_1_.getScaledWidth() - var3 - 10), 5.0F, 16777215);
+        this.mc.mcProfiler.endSection();
+    }
+
+    protected boolean func_175183_b()
+    {
+        if (this.mc.gameSettings.showDebugInfo && !this.mc.thePlayer.func_175140_cp() && !this.mc.gameSettings.field_178879_v)
+        {
+            return false;
+        }
+        else if (this.mc.playerController.enableEverythingIsScrewedUpMode())
+        {
+            if (this.mc.pointedEntity != null)
+            {
+                return true;
+            }
+            else
+            {
+                if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
+                {
+                    BlockPos var1 = this.mc.objectMouseOver.getBlockPos();
+
+                    if (this.mc.theWorld.getTileEntity(var1) instanceof IInventory)
+                    {
+                        return true;
+                    }
+                }
+
+                return false;
+            }
+        }
+        else
+        {
+            return true;
+        }
+    }
+
+    public void func_180478_c(ScaledResolution p_180478_1_)
+    {
+        this.streamIndicator.render(p_180478_1_.getScaledWidth() - 10, 10);
+    }
+
+    private void func_180475_a(ScoreObjective p_180475_1_, ScaledResolution p_180475_2_)
+    {
+        Scoreboard var3 = p_180475_1_.getScoreboard();
+        Collection var4 = var3.getSortedScores(p_180475_1_);
+        ArrayList var5 = Lists.newArrayList(Iterables.filter(var4, new Predicate()
+        {
+            private static final String __OBFID = "CL_00001958";
+            public boolean func_178903_a(Score p_178903_1_)
+            {
+                return p_178903_1_.getPlayerName() != null && !p_178903_1_.getPlayerName().startsWith("#");
+            }
+            public boolean apply(Object p_apply_1_)
+            {
+                return this.func_178903_a((Score)p_apply_1_);
+            }
+        }));
+        ArrayList var21;
+
+        if (var5.size() > 15)
+        {
+            var21 = Lists.newArrayList(Iterables.skip(var5, var4.size() - 15));
+        }
+        else
+        {
+            var21 = var5;
+        }
+
+        int var6 = this.func_175179_f().getStringWidth(p_180475_1_.getDisplayName());
+        String var10;
+
+        for (Iterator var7 = var21.iterator(); var7.hasNext(); var6 = Math.max(var6, this.func_175179_f().getStringWidth(var10)))
+        {
+            Score var8 = (Score)var7.next();
+            ScorePlayerTeam var9 = var3.getPlayersTeam(var8.getPlayerName());
+            var10 = ScorePlayerTeam.formatPlayerName(var9, var8.getPlayerName()) + ": " + EnumChatFormatting.RED + var8.getScorePoints();
+        }
+
+        int var22 = var21.size() * this.func_175179_f().FONT_HEIGHT;
+        int var23 = p_180475_2_.getScaledHeight() / 2 + var22 / 3;
+        byte var24 = 3;
+        int var25 = p_180475_2_.getScaledWidth() - var6 - var24;
+        int var11 = 0;
+        Iterator var12 = var21.iterator();
+        //TODO: Client
+        ArrayList<String> wurst1 = new ArrayList<String>();
+
+        while (var12.hasNext())
+        {
+            Score var13 = (Score)var12.next();
+            ++var11;
+            ScorePlayerTeam var14 = var3.getPlayersTeam(var13.getPlayerName());
+            String var15 = ScorePlayerTeam.formatPlayerName(var14, var13.getPlayerName());
+            //TODO: Client
+            wurst1.add(var15);
+            String var16 = EnumChatFormatting.RED + "" + var13.getScorePoints();
+            int var18 = var23 - var11 * this.func_175179_f().FONT_HEIGHT;
+            int var19 = p_180475_2_.getScaledWidth() - var24 + 2;
+            drawRect(var25 - 2, var18, var19, var18 + this.func_175179_f().FONT_HEIGHT, 1342177280);
+            this.func_175179_f().drawString(var15, var25, var18, 553648127);
+            this.func_175179_f().drawString(var16, var19 - this.func_175179_f().getStringWidth(var16), var18, 553648127);
+
+            if (var11 == var21.size())
+            {
+                String var20 = p_180475_1_.getDisplayName();
+                drawRect(var25 - 2, var18 - this.func_175179_f().FONT_HEIGHT - 1, var19, var18 - 1, 1610612736);
+                drawRect(var25 - 2, var18 - 1, var19, var18, 1342177280);
+                this.func_175179_f().drawString(var20, var25 + var6 / 2 - this.func_175179_f().getStringWidth(var20) / 2, var18 - this.func_175179_f().FONT_HEIGHT, 553648127);
+            }
+            //TODO: Client
+            ArenaBrawlMod.scoreboard = wurst1;
+        }
+    }
+
+    private void func_180477_d(ScaledResolution p_180477_1_)
+    {
+        if (this.mc.func_175606_aa() instanceof EntityPlayer)
+        {
+            EntityPlayer var2 = (EntityPlayer)this.mc.func_175606_aa();
+            int var3 = MathHelper.ceiling_float_int(var2.getHealth());
+            boolean var4 = this.field_175191_F > (long)this.updateCounter && (this.field_175191_F - (long)this.updateCounter) / 3L % 2L == 1L;
+
+            if (var3 < this.field_175194_C && var2.hurtResistantTime > 0)
+            {
+                this.field_175190_E = Minecraft.getSystemTime();
+                this.field_175191_F = (long)(this.updateCounter + 20);
+            }
+            else if (var3 > this.field_175194_C && var2.hurtResistantTime > 0)
+            {
+                this.field_175190_E = Minecraft.getSystemTime();
+                this.field_175191_F = (long)(this.updateCounter + 10);
+            }
+
+            if (Minecraft.getSystemTime() - this.field_175190_E > 1000L)
+            {
+                this.field_175194_C = var3;
+                this.field_175189_D = var3;
+                this.field_175190_E = Minecraft.getSystemTime();
+            }
+
+            this.field_175194_C = var3;
+            int var5 = this.field_175189_D;
+            this.rand.setSeed((long)(this.updateCounter * 312871));
+            boolean var6 = false;
+            FoodStats var7 = var2.getFoodStats();
+            int var8 = var7.getFoodLevel();
+            int var9 = var7.getPrevFoodLevel();
+            IAttributeInstance var10 = var2.getEntityAttribute(SharedMonsterAttributes.maxHealth);
+            int var11 = p_180477_1_.getScaledWidth() / 2 - 91;
+            int var12 = p_180477_1_.getScaledWidth() / 2 + 91;
+            int var13 = p_180477_1_.getScaledHeight() - 39;
+            float var14 = (float)var10.getAttributeValue();
+            float var15 = var2.getAbsorptionAmount();
+            int var16 = MathHelper.ceiling_float_int((var14 + var15) / 2.0F / 10.0F);
+            int var17 = Math.max(10 - (var16 - 2), 3);
+            int var18 = var13 - (var16 - 1) * var17 - 10;
+            float var19 = var15;
+            int var20 = var2.getTotalArmorValue();
+            int var21 = -1;
+
+            if (var2.isPotionActive(Potion.regeneration))
+            {
+                var21 = this.updateCounter % MathHelper.ceiling_float_int(var14 + 5.0F);
+            }
+
+            this.mc.mcProfiler.startSection("armor");
+            int var22;
+            int var23;
+
+            for (var22 = 0; var22 < 10; ++var22)
+            {
+                if (var20 > 0)
+                {
+                    var23 = var11 + var22 * 8;
+
+                    if (var22 * 2 + 1 < var20)
+                    {
+                        this.drawTexturedModalRect(var23, var18, 34, 9, 9, 9);
+                    }
+
+                    if (var22 * 2 + 1 == var20)
+                    {
+                        this.drawTexturedModalRect(var23, var18, 25, 9, 9, 9);
+                    }
+
+                    if (var22 * 2 + 1 > var20)
+                    {
+                        this.drawTexturedModalRect(var23, var18, 16, 9, 9, 9);
+                    }
+                }
+            }
+
+            this.mc.mcProfiler.endStartSection("health");
+            int var25;
+            int var26;
+            int var27;
+
+            for (var22 = MathHelper.ceiling_float_int((var14 + var15) / 2.0F) - 1; var22 >= 0; --var22)
+            {
+                var23 = 16;
+
+                if (var2.isPotionActive(Potion.poison))
+                {
+                    var23 += 36;
+                }
+                else if (var2.isPotionActive(Potion.wither))
+                {
+                    var23 += 72;
+                }
+
+                byte var24 = 0;
+
+                if (var4)
+                {
+                    var24 = 1;
+                }
+
+                var25 = MathHelper.ceiling_float_int((float)(var22 + 1) / 10.0F) - 1;
+                var26 = var11 + var22 % 10 * 8;
+                var27 = var13 - var25 * var17;
+
+                if (var3 <= 4)
+                {
+                    var27 += this.rand.nextInt(2);
+                }
+
+                if (var22 == var21)
+                {
+                    var27 -= 2;
+                }
+
+                byte var28 = 0;
+
+                if (var2.worldObj.getWorldInfo().isHardcoreModeEnabled())
+                {
+                    var28 = 5;
+                }
+
+                this.drawTexturedModalRect(var26, var27, 16 + var24 * 9, 9 * var28, 9, 9);
+
+                if (var4)
+                {
+                    if (var22 * 2 + 1 < var5)
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 54, 9 * var28, 9, 9);
+                    }
+
+                    if (var22 * 2 + 1 == var5)
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 63, 9 * var28, 9, 9);
+                    }
+                }
+
+                if (var19 > 0.0F)
+                {
+                    if (var19 == var15 && var15 % 2.0F == 1.0F)
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 153, 9 * var28, 9, 9);
+                    }
+                    else
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 144, 9 * var28, 9, 9);
+                    }
+
+                    var19 -= 2.0F;
+                }
+                else
+                {
+                    if (var22 * 2 + 1 < var3)
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 36, 9 * var28, 9, 9);
+                    }
+
+                    if (var22 * 2 + 1 == var3)
+                    {
+                        this.drawTexturedModalRect(var26, var27, var23 + 45, 9 * var28, 9, 9);
+                    }
+                }
+            }
+
+            Entity var34 = var2.ridingEntity;
+            int var36;
+
+            if (var34 == null)
+            {
+                this.mc.mcProfiler.endStartSection("food");
+
+                for (var23 = 0; var23 < 10; ++var23)
+                {
+                    var36 = var13;
+                    var25 = 16;
+                    byte var38 = 0;
+
+                    if (var2.isPotionActive(Potion.hunger))
+                    {
+                        var25 += 36;
+                        var38 = 13;
+                    }
+
+                    if (var2.getFoodStats().getSaturationLevel() <= 0.0F && this.updateCounter % (var8 * 3 + 1) == 0)
+                    {
+                        var36 = var13 + (this.rand.nextInt(3) - 1);
+                    }
+
+                    if (var6)
+                    {
+                        var38 = 1;
+                    }
+
+                    var27 = var12 - var23 * 8 - 9;
+                    this.drawTexturedModalRect(var27, var36, 16 + var38 * 9, 27, 9, 9);
+
+                    if (var6)
+                    {
+                        if (var23 * 2 + 1 < var9)
+                        {
+                            this.drawTexturedModalRect(var27, var36, var25 + 54, 27, 9, 9);
+                        }
+
+                        if (var23 * 2 + 1 == var9)
+                        {
+                            this.drawTexturedModalRect(var27, var36, var25 + 63, 27, 9, 9);
+                        }
+                    }
+
+                    if (var23 * 2 + 1 < var8)
+                    {
+                        this.drawTexturedModalRect(var27, var36, var25 + 36, 27, 9, 9);
+                    }
+
+                    if (var23 * 2 + 1 == var8)
+                    {
+                        this.drawTexturedModalRect(var27, var36, var25 + 45, 27, 9, 9);
+                    }
+                }
+            }
+            else if (var34 instanceof EntityLivingBase)
+            {
+                this.mc.mcProfiler.endStartSection("mountHealth");
+                EntityLivingBase var35 = (EntityLivingBase)var34;
+                var36 = (int)Math.ceil((double)var35.getHealth());
+                float var37 = var35.getMaxHealth();
+                var26 = (int)(var37 + 0.5F) / 2;
+
+                if (var26 > 30)
+                {
+                    var26 = 30;
+                }
+
+                var27 = var13;
+
+                for (int var39 = 0; var26 > 0; var39 += 20)
+                {
+                    int var29 = Math.min(var26, 10);
+                    var26 -= var29;
+
+                    for (int var30 = 0; var30 < var29; ++var30)
+                    {
+                        byte var31 = 52;
+                        byte var32 = 0;
+
+                        if (var6)
+                        {
+                            var32 = 1;
+                        }
+
+                        int var33 = var12 - var30 * 8 - 9;
+                        this.drawTexturedModalRect(var33, var27, var31 + var32 * 9, 9, 9, 9);
+
+                        if (var30 * 2 + 1 + var39 < var36)
+                        {
+                            this.drawTexturedModalRect(var33, var27, var31 + 36, 9, 9, 9);
+                        }
+
+                        if (var30 * 2 + 1 + var39 == var36)
+                        {
+                            this.drawTexturedModalRect(var33, var27, var31 + 45, 9, 9, 9);
+                        }
+                    }
+
+                    var27 -= 10;
+                }
+            }
+
+            this.mc.mcProfiler.endStartSection("air");
+
+            if (var2.isInsideOfMaterial(Material.water))
+            {
+                var23 = this.mc.thePlayer.getAir();
+                var36 = MathHelper.ceiling_double_int((double)(var23 - 2) * 10.0D / 300.0D);
+                var25 = MathHelper.ceiling_double_int((double)var23 * 10.0D / 300.0D) - var36;
+
+                for (var26 = 0; var26 < var36 + var25; ++var26)
+                {
+                    if (var26 < var36)
+                    {
+                        this.drawTexturedModalRect(var12 - var26 * 8 - 9, var18, 16, 18, 9, 9);
+                    }
+                    else
+                    {
+                        this.drawTexturedModalRect(var12 - var26 * 8 - 9, var18, 25, 18, 9, 9);
+                    }
+                }
+            }
+
+            this.mc.mcProfiler.endSection();
+        }
+    }
+
+    /**
+     * Renders dragon's (boss) health on the HUD
+     */
+    private void renderBossHealth()
+    {
+        if (BossStatus.bossName != null && BossStatus.statusBarTime > 0)
+        {
+            --BossStatus.statusBarTime;
+            FontRenderer var1 = this.mc.fontRendererObj;
+            ScaledResolution var2 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
+            int var3 = var2.getScaledWidth();
+            short var4 = 182;
+            int var5 = var3 / 2 - var4 / 2;
+            int var6 = (int)(BossStatus.healthScale * (float)(var4 + 1));
+            byte var7 = 12;
+            this.drawTexturedModalRect(var5, var7, 0, 74, var4, 5);
+            this.drawTexturedModalRect(var5, var7, 0, 74, var4, 5);
+
+            if (var6 > 0)
+            {
+                this.drawTexturedModalRect(var5, var7, 0, 79, var6, 5);
+            }
+
+            String var8 = BossStatus.bossName;
+            this.func_175179_f().drawStringWithShadow(var8, (float)(var3 / 2 - this.func_175179_f().getStringWidth(var8) / 2), (float)(var7 - 10), 16777215);
+            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+            this.mc.getTextureManager().bindTexture(icons);
+        }
+    }
+
+    private void func_180476_e(ScaledResolution p_180476_1_)
+    {
+        GlStateManager.disableDepth();
+        GlStateManager.depthMask(false);
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.disableAlpha();
+        this.mc.getTextureManager().bindTexture(pumpkinBlurTexPath);
+        Tessellator var2 = Tessellator.getInstance();
+        WorldRenderer var3 = var2.getWorldRenderer();
+        var3.startDrawingQuads();
+        var3.addVertexWithUV(0.0D, (double)p_180476_1_.getScaledHeight(), -90.0D, 0.0D, 1.0D);
+        var3.addVertexWithUV((double)p_180476_1_.getScaledWidth(), (double)p_180476_1_.getScaledHeight(), -90.0D, 1.0D, 1.0D);
+        var3.addVertexWithUV((double)p_180476_1_.getScaledWidth(), 0.0D, -90.0D, 1.0D, 0.0D);
+        var3.addVertexWithUV(0.0D, 0.0D, -90.0D, 0.0D, 0.0D);
+        var2.draw();
+        GlStateManager.depthMask(true);
+        GlStateManager.enableDepth();
+        GlStateManager.enableAlpha();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+    }
+
+    private void func_180480_a(float p_180480_1_, ScaledResolution p_180480_2_)
+    {
+        p_180480_1_ = 1.0F - p_180480_1_;
+        p_180480_1_ = MathHelper.clamp_float(p_180480_1_, 0.0F, 1.0F);
+        WorldBorder var3 = this.mc.theWorld.getWorldBorder();
+        float var4 = (float)var3.getClosestDistance(this.mc.thePlayer);
+        double var5 = Math.min(var3.func_177749_o() * (double)var3.getWarningTime() * 1000.0D, Math.abs(var3.getTargetSize() - var3.getDiameter()));
+        double var7 = Math.max((double)var3.getWarningDistance(), var5);
+
+        if ((double)var4 < var7)
+        {
+            var4 = 1.0F - (float)((double)var4 / var7);
+        }
+        else
+        {
+            var4 = 0.0F;
+        }
+
+        this.prevVignetteBrightness = (float)((double)this.prevVignetteBrightness + (double)(p_180480_1_ - this.prevVignetteBrightness) * 0.01D);
+        GlStateManager.disableDepth();
+        GlStateManager.depthMask(false);
+        GlStateManager.tryBlendFuncSeparate(0, 769, 1, 0);
+
+        if (var4 > 0.0F)
+        {
+            GlStateManager.color(0.0F, var4, var4, 1.0F);
+        }
+        else
+        {
+            GlStateManager.color(this.prevVignetteBrightness, this.prevVignetteBrightness, this.prevVignetteBrightness, 1.0F);
+        }
+
+        this.mc.getTextureManager().bindTexture(vignetteTexPath);
+        Tessellator var9 = Tessellator.getInstance();
+        WorldRenderer var10 = var9.getWorldRenderer();
+        var10.startDrawingQuads();
+        var10.addVertexWithUV(0.0D, (double)p_180480_2_.getScaledHeight(), -90.0D, 0.0D, 1.0D);
+        var10.addVertexWithUV((double)p_180480_2_.getScaledWidth(), (double)p_180480_2_.getScaledHeight(), -90.0D, 1.0D, 1.0D);
+        var10.addVertexWithUV((double)p_180480_2_.getScaledWidth(), 0.0D, -90.0D, 1.0D, 0.0D);
+        var10.addVertexWithUV(0.0D, 0.0D, -90.0D, 0.0D, 0.0D);
+        var9.draw();
+        GlStateManager.depthMask(true);
+        GlStateManager.enableDepth();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+    }
+
+    private void func_180474_b(float p_180474_1_, ScaledResolution p_180474_2_)
+    {
+        if (p_180474_1_ < 1.0F)
+        {
+            p_180474_1_ *= p_180474_1_;
+            p_180474_1_ *= p_180474_1_;
+            p_180474_1_ = p_180474_1_ * 0.8F + 0.2F;
+        }
+
+        GlStateManager.disableAlpha();
+        GlStateManager.disableDepth();
+        GlStateManager.depthMask(false);
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, p_180474_1_);
+        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
+        TextureAtlasSprite var3 = this.mc.getBlockRendererDispatcher().func_175023_a().func_178122_a(Blocks.portal.getDefaultState());
+        float var4 = var3.getMinU();
+        float var5 = var3.getMinV();
+        float var6 = var3.getMaxU();
+        float var7 = var3.getMaxV();
+        Tessellator var8 = Tessellator.getInstance();
+        WorldRenderer var9 = var8.getWorldRenderer();
+        var9.startDrawingQuads();
+        var9.addVertexWithUV(0.0D, (double)p_180474_2_.getScaledHeight(), -90.0D, (double)var4, (double)var7);
+        var9.addVertexWithUV((double)p_180474_2_.getScaledWidth(), (double)p_180474_2_.getScaledHeight(), -90.0D, (double)var6, (double)var7);
+        var9.addVertexWithUV((double)p_180474_2_.getScaledWidth(), 0.0D, -90.0D, (double)var6, (double)var5);
+        var9.addVertexWithUV(0.0D, 0.0D, -90.0D, (double)var4, (double)var5);
+        var8.draw();
+        GlStateManager.depthMask(true);
+        GlStateManager.enableDepth();
+        GlStateManager.enableAlpha();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+    }
+
+    private void func_175184_a(int p_175184_1_, int p_175184_2_, int p_175184_3_, float p_175184_4_, EntityPlayer p_175184_5_)
+    {
+        ItemStack var6 = p_175184_5_.inventory.mainInventory[p_175184_1_];
+
+        if (var6 != null)
+        {
+            float var7 = (float)var6.animationsToGo - p_175184_4_;
+
+            if (var7 > 0.0F)
+            {
+                GlStateManager.pushMatrix();
+                float var8 = 1.0F + var7 / 5.0F;
+                GlStateManager.translate((float)(p_175184_2_ + 8), (float)(p_175184_3_ + 12), 0.0F);
+                GlStateManager.scale(1.0F / var8, (var8 + 1.0F) / 2.0F, 1.0F);
+                GlStateManager.translate((float)(-(p_175184_2_ + 8)), (float)(-(p_175184_3_ + 12)), 0.0F);
+            }
+
+            this.itemRenderer.renderItemAndEffectIntoGUI(var6, p_175184_2_, p_175184_3_);
+
+            if (var7 > 0.0F)
+            {
+                GlStateManager.popMatrix();
+            }
+
+            this.itemRenderer.func_175030_a(this.mc.fontRendererObj, var6, p_175184_2_, p_175184_3_);
+        }
+    }
+
+    /**
+     * The update tick for the ingame UI
+     */
+    public void updateTick()
+    {
+        if (this.recordPlayingUpFor > 0)
+        {
+            --this.recordPlayingUpFor;
+        }
+
+        if (this.field_175195_w > 0)
+        {
+            --this.field_175195_w;
+
+            if (this.field_175195_w <= 0)
+            {
+                this.field_175201_x = "";
+                this.field_175200_y = "";
+            }
+        }
+
+        ++this.updateCounter;
+        this.streamIndicator.func_152439_a();
+
+        if (this.mc.thePlayer != null)
+        {
+            ItemStack var1 = this.mc.thePlayer.inventory.getCurrentItem();
+
+            if (var1 == null)
+            {
+                this.remainingHighlightTicks = 0;
+            }
+            else if (this.highlightingItemStack != null && var1.getItem() == this.highlightingItemStack.getItem() && ItemStack.areItemStackTagsEqual(var1, this.highlightingItemStack) && (var1.isItemStackDamageable() || var1.getMetadata() == this.highlightingItemStack.getMetadata()))
+            {
+                if (this.remainingHighlightTicks > 0)
+                {
+                    --this.remainingHighlightTicks;
+                }
+            }
+            else
+            {
+                this.remainingHighlightTicks = 40;
+            }
+
+            this.highlightingItemStack = var1;
+        }
+    }
+
+    public void setRecordPlayingMessage(String p_73833_1_)
+    {
+        this.setRecordPlaying(I18n.format("record.nowPlaying", new Object[] {p_73833_1_}), true);
+    }
+
+    public void setRecordPlaying(String p_110326_1_, boolean p_110326_2_)
+    {
+        this.recordPlaying = p_110326_1_;
+        this.recordPlayingUpFor = 60;
+        this.recordIsPlaying = p_110326_2_;
+    }
+
+    public void func_175178_a(String p_175178_1_, String p_175178_2_, int p_175178_3_, int p_175178_4_, int p_175178_5_)
+    {
+        if (p_175178_1_ == null && p_175178_2_ == null && p_175178_3_ < 0 && p_175178_4_ < 0 && p_175178_5_ < 0)
+        {
+            this.field_175201_x = "";
+            this.field_175200_y = "";
+            this.field_175195_w = 0;
+        }
+        else if (p_175178_1_ != null)
+        {
+            this.field_175201_x = p_175178_1_;
+            this.field_175195_w = this.field_175199_z + this.field_175192_A + this.field_175193_B;
+        }
+        else if (p_175178_2_ != null)
+        {
+            this.field_175200_y = p_175178_2_;
+        }
+        else
+        {
+            if (p_175178_3_ >= 0)
+            {
+                this.field_175199_z = p_175178_3_;
+            }
+
+            if (p_175178_4_ >= 0)
+            {
+                this.field_175192_A = p_175178_4_;
+            }
+
+            if (p_175178_5_ >= 0)
+            {
+                this.field_175193_B = p_175178_5_;
+            }
+
+            if (this.field_175195_w > 0)
+            {
+                this.field_175195_w = this.field_175199_z + this.field_175192_A + this.field_175193_B;
+            }
+        }
+    }
+
+    public void func_175188_a(IChatComponent p_175188_1_, boolean p_175188_2_)
+    {
+        this.setRecordPlaying(p_175188_1_.getUnformattedText(), p_175188_2_);
+    }
+
+    /**
+     * returns a pointer to the persistant Chat GUI, containing all previous chat messages and such
+     */
+    public GuiNewChat getChatGUI()
+    {
+        return this.persistantChatGUI;
+    }
+
+    public int getUpdateCounter()
+    {
+        return this.updateCounter;
+    }
+
+    public FontRenderer func_175179_f()
+    {
+        return this.mc.fontRendererObj;
+    }
+
+    public GuiSpectator func_175187_g()
+    {
+        return this.field_175197_u;
+    }
+
+    public GuiPlayerTabOverlay getTabList()
+    {
+        return this.overlayPlayerList;
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiIngameMenu.java b/src/net/minecraft/client/gui/GuiIngameMenu.java
index d8f9c4b..73906b4 100644
--- a/src/net/minecraft/client/gui/GuiIngameMenu.java
+++ b/src/net/minecraft/client/gui/GuiIngameMenu.java
@@ -1,95 +1,142 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import net.minecraft.client.gui.achievement.GuiAchievements;
-import net.minecraft.client.gui.achievement.GuiStats;
-import net.minecraft.client.multiplayer.WorldClient;
-import net.minecraft.client.resources.I18n;
-
-public class GuiIngameMenu extends GuiScreen
-{
-    private int field_146445_a;
-    private int field_146444_f;
-    private static final String __OBFID = "CL_00000703";
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.field_146445_a = 0;
-        this.buttonList.clear();
-        byte var1 = -16;
-        boolean var2 = true;
-        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 120 + var1, I18n.format("menu.returnToMenu", new Object[0])));
-
-        if (!this.mc.isIntegratedServerRunning())
-        {
-            ((GuiButton)this.buttonList.get(0)).displayString = I18n.format("menu.disconnect", new Object[0]);
-        }
-
-        this.buttonList.add(new GuiButton(4, this.width / 2 - 100, this.height / 4 + 24 + var1, I18n.format("menu.returnToGame", new Object[0])));
-        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 96 + var1, 98, 20, I18n.format("menu.options", new Object[0])));
-        GuiButton var3;
-        this.buttonList.add(var3 = new GuiButton(7, this.width / 2 + 2, this.height / 4 + 96 + var1, 98, 20, I18n.format("menu.shareToLan", new Object[0])));
-        this.buttonList.add(new GuiButton(5, this.width / 2 - 100, this.height / 4 + 48 + var1, 98, 20, I18n.format("gui.achievements", new Object[0])));
-        this.buttonList.add(new GuiButton(6, this.width / 2 + 2, this.height / 4 + 48 + var1, 98, 20, I18n.format("gui.stats", new Object[0])));
-        var3.enabled = this.mc.isSingleplayer() && !this.mc.getIntegratedServer().getPublic();
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        switch (button.id)
-        {
-            case 0:
-                this.mc.displayGuiScreen(new GuiOptions(this, this.mc.gameSettings));
-                break;
-
-            case 1:
-                button.enabled = false;
-                this.mc.theWorld.sendQuittingDisconnectingPacket();
-                this.mc.loadWorld((WorldClient)null);
-                this.mc.displayGuiScreen(new GuiMainMenu());
-
-            case 2:
-            case 3:
-            default:
-                break;
-
-            case 4:
-                this.mc.displayGuiScreen((GuiScreen)null);
-                this.mc.setIngameFocus();
-                break;
-
-            case 5:
-                this.mc.displayGuiScreen(new GuiAchievements(this, this.mc.thePlayer.getStatFileWriter()));
-                break;
-
-            case 6:
-                this.mc.displayGuiScreen(new GuiStats(this, this.mc.thePlayer.getStatFileWriter()));
-                break;
-
-            case 7:
-                this.mc.displayGuiScreen(new GuiShareToLan(this));
-        }
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        super.updateScreen();
-        ++this.field_146444_f;
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawDefaultBackground();
-        this.drawCenteredString(this.fontRendererObj, I18n.format("menu.game", new Object[0]), this.width / 2, 40, 16777215);
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-}
+package net.minecraft.client.gui;
+
+import static org.lwjgl.opengl.GL11.GL_CULL_FACE;
+import static org.lwjgl.opengl.GL11.GL_TEXTURE_2D;
+import static org.lwjgl.opengl.GL11.glEnable;
+
+import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.gui.achievement.GuiAchievements;
+import net.minecraft.client.gui.achievement.GuiStats;
+import net.minecraft.client.multiplayer.WorldClient;
+import net.minecraft.client.renderer.OpenGlHelper;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.util.ResourceLocation;
+
+import org.lwjgl.opengl.GL11;
+
+import tk.wurst_client.options.gui.GuiWurstOptions;
+
+public class GuiIngameMenu extends GuiScreen
+{
+    private int field_146445_a;
+    private int field_146444_f;
+    //TODO: Client
+    private static final ResourceLocation wurstTextures = new ResourceLocation("wurst/wurst_128.png");
+    private static final String __OBFID = "CL_00000703";
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.field_146445_a = 0;
+        this.buttonList.clear();
+        byte var1 = -16;
+        boolean var2 = true;
+        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 120 + var1, I18n.format("menu.returnToMenu", new Object[0])));
+
+        if (!this.mc.isIntegratedServerRunning())
+        {
+            ((GuiButton)this.buttonList.get(0)).displayString = I18n.format("menu.disconnect", new Object[0]);
+        }
+
+        this.buttonList.add(new GuiButton(4, this.width / 2 - 100, this.height / 4 + 24 + var1, I18n.format("menu.returnToGame", new Object[0])));
+        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 96 + var1, 98, 20, I18n.format("menu.options", new Object[0])));
+        //TODO: Client
+        this.buttonList.add(new GuiButton(8, this.width / 2 - 100, this.height / 4 + 72 + var1, "            Options"));
+        GuiButton var3;
+        this.buttonList.add(var3 = new GuiButton(7, this.width / 2 + 2, this.height / 4 + 96 + var1, 98, 20, I18n.format("menu.shareToLan", new Object[0])));
+        this.buttonList.add(new GuiButton(5, this.width / 2 - 100, this.height / 4 + 48 + var1, 98, 20, I18n.format("gui.achievements", new Object[0])));
+        this.buttonList.add(new GuiButton(6, this.width / 2 + 2, this.height / 4 + 48 + var1, 98, 20, I18n.format("gui.stats", new Object[0])));
+        var3.enabled = this.mc.isSingleplayer() && !this.mc.getIntegratedServer().getPublic();
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        switch (button.id)
+        {
+            case 0:
+                this.mc.displayGuiScreen(new GuiOptions(this, this.mc.gameSettings));
+                break;
+
+            case 1:
+                button.enabled = false;
+                this.mc.theWorld.sendQuittingDisconnectingPacket();
+                this.mc.loadWorld((WorldClient)null);
+                this.mc.displayGuiScreen(new GuiMainMenu());
+
+            case 2:
+            case 3:
+            default:
+                break;
+
+            case 4:
+                this.mc.displayGuiScreen((GuiScreen)null);
+                this.mc.setIngameFocus();
+                break;
+
+            case 5:
+                this.mc.displayGuiScreen(new GuiAchievements(this, this.mc.thePlayer.getStatFileWriter()));
+                break;
+
+            case 6:
+                this.mc.displayGuiScreen(new GuiStats(this, this.mc.thePlayer.getStatFileWriter()));
+                break;
+
+            case 7:
+                this.mc.displayGuiScreen(new GuiShareToLan(this));
+                break;
+
+                //TODO: Client
+            case 8:
+                this.mc.displayGuiScreen(new GuiWurstOptions(this));
+        }
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        super.updateScreen();
+        ++this.field_146444_f;
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawDefaultBackground();
+        this.drawCenteredString(this.fontRendererObj, I18n.format("menu.game", new Object[0]), this.width / 2, 40, 16777215);
+        super.drawScreen(mouseX, mouseY, partialTicks);
+        //TODO: Client
+		glEnable(GL_TEXTURE_2D);
+		glEnable(GL_CULL_FACE);
+        GL11.glDisable(GL11.GL_DEPTH_TEST);
+        GL11.glDepthMask(false);
+        OpenGlHelper.glBlendFunc(770, 771, 1, 0);
+        GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
+        this.mc.getTextureManager().bindTexture(wurstTextures);
+        Tessellator var3 = Tessellator.getInstance();
+        WorldRenderer var4 = var3.getWorldRenderer();
+        double x = this.width / 2 - 68;
+        double y = this.height / 4 + 73 - 14.5;
+        double h = 16;
+        double w = 63;
+        double fw = 256;
+        double fh = 256;
+        double u1 = 0;
+        double v1 = 0;
+        var4.startDrawingQuads();
+        var4.addVertexWithUV((double)x + 0, (double)y + h, (double)this.zLevel, (double)((float)(u1 + 0) * 0.00390625F), (double)((float)(v1 + fh) * 0.00390625F));
+        var4.addVertexWithUV((double)x + w, (double)y + h, (double)this.zLevel, (double)((float)(u1 + fw) * 0.00390625F), (double)((float)(v1 + fh) * 0.00390625F));
+        var4.addVertexWithUV((double)x + w, (double)y + 0, (double)this.zLevel, (double)((float)(u1 + fw) * 0.00390625F), (double)((float)(v1 + 0) * 0.00390625F));
+        var4.addVertexWithUV((double)x + 0, (double)y + 0, (double)this.zLevel, (double)((float)(u1 + 0) * 0.00390625F), (double)((float)(v1 + 0) * 0.00390625F));
+        var3.draw();
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiKeyBindingList.java b/src/net/minecraft/client/gui/GuiKeyBindingList.java
index 63ce2aa..8f79f96 100644
--- a/src/net/minecraft/client/gui/GuiKeyBindingList.java
+++ b/src/net/minecraft/client/gui/GuiKeyBindingList.java
@@ -1,11 +1,14 @@
 package net.minecraft.client.gui;
 
 import java.util.Arrays;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
 import net.minecraft.client.settings.KeyBinding;
 import net.minecraft.util.EnumChatFormatting;
+
 import org.apache.commons.lang3.ArrayUtils;
 
 public class GuiKeyBindingList extends GuiListExtended
diff --git a/src/net/minecraft/client/gui/GuiLanguage.java b/src/net/minecraft/client/gui/GuiLanguage.java
index 21d8db6..5378b03 100644
--- a/src/net/minecraft/client/gui/GuiLanguage.java
+++ b/src/net/minecraft/client/gui/GuiLanguage.java
@@ -2,10 +2,13 @@ package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
 import java.io.IOException;
 import java.util.Iterator;
 import java.util.Map;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.resources.Language;
 import net.minecraft.client.resources.LanguageManager;
diff --git a/src/net/minecraft/client/gui/GuiListButton.java b/src/net/minecraft/client/gui/GuiListButton.java
index ce714c0..b3b0780 100644
--- a/src/net/minecraft/client/gui/GuiListButton.java
+++ b/src/net/minecraft/client/gui/GuiListButton.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 
 public class GuiListButton extends GuiButton
diff --git a/src/net/minecraft/client/gui/GuiLockIconButton.java b/src/net/minecraft/client/gui/GuiLockIconButton.java
index f86264c..b73a813 100644
--- a/src/net/minecraft/client/gui/GuiLockIconButton.java
+++ b/src/net/minecraft/client/gui/GuiLockIconButton.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 
 public class GuiLockIconButton extends GuiButton
diff --git a/src/net/minecraft/client/gui/GuiMainMenu.java b/src/net/minecraft/client/gui/GuiMainMenu.java
index 38033d9..a379b52 100644
--- a/src/net/minecraft/client/gui/GuiMainMenu.java
+++ b/src/net/minecraft/client/gui/GuiMainMenu.java
@@ -1,567 +1,767 @@
-package net.minecraft.client.gui;
-
-import com.google.common.collect.Lists;
-import java.io.BufferedReader;
-import java.io.IOException;
-import java.io.InputStreamReader;
-import java.net.URI;
-import java.util.ArrayList;
-import java.util.Calendar;
-import java.util.Date;
-import java.util.Random;
-import java.util.concurrent.atomic.AtomicInteger;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.OpenGlHelper;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.texture.DynamicTexture;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.realms.RealmsBridge;
-import net.minecraft.util.EnumChatFormatting;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.world.demo.DemoWorldServer;
-import net.minecraft.world.storage.ISaveFormat;
-import net.minecraft.world.storage.WorldInfo;
-import org.apache.commons.io.Charsets;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.opengl.GL11;
-import org.lwjgl.opengl.GLContext;
-import org.lwjgl.util.glu.Project;
-
-public class GuiMainMenu extends GuiScreen implements GuiYesNoCallback
-{
-    private static final AtomicInteger field_175373_f = new AtomicInteger(0);
-    private static final Logger logger = LogManager.getLogger();
-    private static final Random field_175374_h = new Random();
-
-    /** Counts the number of screen updates. */
-    private float updateCounter;
-
-    /** The splash message. */
-    private String splashText;
-    private GuiButton buttonResetDemo;
-
-    /** Timer used to rotate the panorama, increases every tick. */
-    private int panoramaTimer;
-
-    /**
-     * Texture allocated for the current viewport of the main menu's panorama background.
-     */
-    private DynamicTexture viewportTexture;
-    private boolean field_175375_v = true;
-    private final Object field_104025_t = new Object();
-    private String field_92025_p;
-    private String field_146972_A;
-    private String field_104024_v;
-    private static final ResourceLocation splashTexts = new ResourceLocation("texts/splashes.txt");
-    private static final ResourceLocation minecraftTitleTextures = new ResourceLocation("textures/gui/title/minecraft.png");
-
-    /** An array of all the paths to the panorama pictures. */
-    private static final ResourceLocation[] titlePanoramaPaths = new ResourceLocation[] {new ResourceLocation("textures/gui/title/background/panorama_0.png"), new ResourceLocation("textures/gui/title/background/panorama_1.png"), new ResourceLocation("textures/gui/title/background/panorama_2.png"), new ResourceLocation("textures/gui/title/background/panorama_3.png"), new ResourceLocation("textures/gui/title/background/panorama_4.png"), new ResourceLocation("textures/gui/title/background/panorama_5.png")};
-    public static final String field_96138_a = "Please click " + EnumChatFormatting.UNDERLINE + "here" + EnumChatFormatting.RESET + " for more information.";
-    private int field_92024_r;
-    private int field_92023_s;
-    private int field_92022_t;
-    private int field_92021_u;
-    private int field_92020_v;
-    private int field_92019_w;
-    private ResourceLocation field_110351_G;
-    private GuiButton field_175372_K;
-    private static final String __OBFID = "CL_00001154";
-
-    public GuiMainMenu()
-    {
-        this.field_146972_A = field_96138_a;
-        this.splashText = "missingno";
-        BufferedReader var1 = null;
-
-        try
-        {
-            ArrayList var2 = Lists.newArrayList();
-            var1 = new BufferedReader(new InputStreamReader(Minecraft.getMinecraft().getResourceManager().getResource(splashTexts).getInputStream(), Charsets.UTF_8));
-            String var3;
-
-            while ((var3 = var1.readLine()) != null)
-            {
-                var3 = var3.trim();
-
-                if (!var3.isEmpty())
-                {
-                    var2.add(var3);
-                }
-            }
-
-            if (!var2.isEmpty())
-            {
-                do
-                {
-                    this.splashText = (String)var2.get(field_175374_h.nextInt(var2.size()));
-                }
-                while (this.splashText.hashCode() == 125780783);
-            }
-        }
-        catch (IOException var12)
-        {
-            ;
-        }
-        finally
-        {
-            if (var1 != null)
-            {
-                try
-                {
-                    var1.close();
-                }
-                catch (IOException var11)
-                {
-                    ;
-                }
-            }
-        }
-
-        this.updateCounter = field_175374_h.nextFloat();
-        this.field_92025_p = "";
-
-        if (!GLContext.getCapabilities().OpenGL20 && !OpenGlHelper.areShadersSupported())
-        {
-            this.field_92025_p = I18n.format("title.oldgl1", new Object[0]);
-            this.field_146972_A = I18n.format("title.oldgl2", new Object[0]);
-            this.field_104024_v = "https://help.mojang.com/customer/portal/articles/325948?ref=game";
-        }
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        ++this.panoramaTimer;
-    }
-
-    /**
-     * Returns true if this GUI should pause the game when it is displayed in single-player
-     */
-    public boolean doesGuiPauseGame()
-    {
-        return false;
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.viewportTexture = new DynamicTexture(256, 256);
-        this.field_110351_G = this.mc.getTextureManager().getDynamicTextureLocation("background", this.viewportTexture);
-        Calendar var1 = Calendar.getInstance();
-        var1.setTime(new Date());
-
-        if (var1.get(2) + 1 == 11 && var1.get(5) == 9)
-        {
-            this.splashText = "Happy birthday, ez!";
-        }
-        else if (var1.get(2) + 1 == 6 && var1.get(5) == 1)
-        {
-            this.splashText = "Happy birthday, Notch!";
-        }
-        else if (var1.get(2) + 1 == 12 && var1.get(5) == 24)
-        {
-            this.splashText = "Merry X-mas!";
-        }
-        else if (var1.get(2) + 1 == 1 && var1.get(5) == 1)
-        {
-            this.splashText = "Happy new year!";
-        }
-        else if (var1.get(2) + 1 == 10 && var1.get(5) == 31)
-        {
-            this.splashText = "OOoooOOOoooo! Spooky!";
-        }
-
-        boolean var2 = true;
-        int var3 = this.height / 4 + 48;
-
-        if (this.mc.isDemo())
-        {
-            this.addDemoButtons(var3, 24);
-        }
-        else
-        {
-            this.addSingleplayerMultiplayerButtons(var3, 24);
-        }
-
-        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, var3 + 72 + 12, 98, 20, I18n.format("menu.options", new Object[0])));
-        this.buttonList.add(new GuiButton(4, this.width / 2 + 2, var3 + 72 + 12, 98, 20, I18n.format("menu.quit", new Object[0])));
-        this.buttonList.add(new GuiButtonLanguage(5, this.width / 2 - 124, var3 + 72 + 12));
-        Object var4 = this.field_104025_t;
-
-        synchronized (this.field_104025_t)
-        {
-            this.field_92023_s = this.fontRendererObj.getStringWidth(this.field_92025_p);
-            this.field_92024_r = this.fontRendererObj.getStringWidth(this.field_146972_A);
-            int var5 = Math.max(this.field_92023_s, this.field_92024_r);
-            this.field_92022_t = (this.width - var5) / 2;
-            this.field_92021_u = ((GuiButton)this.buttonList.get(0)).yPosition - 24;
-            this.field_92020_v = this.field_92022_t + var5;
-            this.field_92019_w = this.field_92021_u + 24;
-        }
-    }
-
-    /**
-     * Adds Singleplayer and Multiplayer buttons on Main Menu for players who have bought the game.
-     */
-    private void addSingleplayerMultiplayerButtons(int p_73969_1_, int p_73969_2_)
-    {
-        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, p_73969_1_, I18n.format("menu.singleplayer", new Object[0])));
-        this.buttonList.add(new GuiButton(2, this.width / 2 - 100, p_73969_1_ + p_73969_2_ * 1, I18n.format("menu.multiplayer", new Object[0])));
-        this.buttonList.add(this.field_175372_K = new GuiButton(14, this.width / 2 - 100, p_73969_1_ + p_73969_2_ * 2, I18n.format("menu.online", new Object[0])));
-    }
-
-    /**
-     * Adds Demo buttons on Main Menu for players who are playing Demo.
-     */
-    private void addDemoButtons(int p_73972_1_, int p_73972_2_)
-    {
-        this.buttonList.add(new GuiButton(11, this.width / 2 - 100, p_73972_1_, I18n.format("menu.playdemo", new Object[0])));
-        this.buttonList.add(this.buttonResetDemo = new GuiButton(12, this.width / 2 - 100, p_73972_1_ + p_73972_2_ * 1, I18n.format("menu.resetdemo", new Object[0])));
-        ISaveFormat var3 = this.mc.getSaveLoader();
-        WorldInfo var4 = var3.getWorldInfo("Demo_World");
-
-        if (var4 == null)
-        {
-            this.buttonResetDemo.enabled = false;
-        }
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.id == 0)
-        {
-            this.mc.displayGuiScreen(new GuiOptions(this, this.mc.gameSettings));
-        }
-
-        if (button.id == 5)
-        {
-            this.mc.displayGuiScreen(new GuiLanguage(this, this.mc.gameSettings, this.mc.getLanguageManager()));
-        }
-
-        if (button.id == 1)
-        {
-            this.mc.displayGuiScreen(new GuiSelectWorld(this));
-        }
-
-        if (button.id == 2)
-        {
-            this.mc.displayGuiScreen(new GuiMultiplayer(this));
-        }
-
-        if (button.id == 14 && this.field_175372_K.visible)
-        {
-            this.switchToRealms();
-        }
-
-        if (button.id == 4)
-        {
-            this.mc.shutdown();
-        }
-
-        if (button.id == 11)
-        {
-            this.mc.launchIntegratedServer("Demo_World", "Demo_World", DemoWorldServer.demoWorldSettings);
-        }
-
-        if (button.id == 12)
-        {
-            ISaveFormat var2 = this.mc.getSaveLoader();
-            WorldInfo var3 = var2.getWorldInfo("Demo_World");
-
-            if (var3 != null)
-            {
-                GuiYesNo var4 = GuiSelectWorld.func_152129_a(this, var3.getWorldName(), 12);
-                this.mc.displayGuiScreen(var4);
-            }
-        }
-    }
-
-    private void switchToRealms()
-    {
-        RealmsBridge var1 = new RealmsBridge();
-        var1.switchToRealms(this);
-    }
-
-    public void confirmClicked(boolean result, int id)
-    {
-        if (result && id == 12)
-        {
-            ISaveFormat var6 = this.mc.getSaveLoader();
-            var6.flushCache();
-            var6.deleteWorldDirectory("Demo_World");
-            this.mc.displayGuiScreen(this);
-        }
-        else if (id == 13)
-        {
-            if (result)
-            {
-                try
-                {
-                    Class var3 = Class.forName("java.awt.Desktop");
-                    Object var4 = var3.getMethod("getDesktop", new Class[0]).invoke((Object)null, new Object[0]);
-                    var3.getMethod("browse", new Class[] {URI.class}).invoke(var4, new Object[] {new URI(this.field_104024_v)});
-                }
-                catch (Throwable var5)
-                {
-                    logger.error("Couldn\'t open link", var5);
-                }
-            }
-
-            this.mc.displayGuiScreen(this);
-        }
-    }
-
-    /**
-     * Draws the main menu panorama
-     */
-    private void drawPanorama(int p_73970_1_, int p_73970_2_, float p_73970_3_)
-    {
-        Tessellator var4 = Tessellator.getInstance();
-        WorldRenderer var5 = var4.getWorldRenderer();
-        GlStateManager.matrixMode(5889);
-        GlStateManager.pushMatrix();
-        GlStateManager.loadIdentity();
-        Project.gluPerspective(120.0F, 1.0F, 0.05F, 10.0F);
-        GlStateManager.matrixMode(5888);
-        GlStateManager.pushMatrix();
-        GlStateManager.loadIdentity();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.rotate(180.0F, 1.0F, 0.0F, 0.0F);
-        GlStateManager.rotate(90.0F, 0.0F, 0.0F, 1.0F);
-        GlStateManager.enableBlend();
-        GlStateManager.disableAlpha();
-        GlStateManager.disableCull();
-        GlStateManager.depthMask(false);
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        byte var6 = 8;
-
-        for (int var7 = 0; var7 < var6 * var6; ++var7)
-        {
-            GlStateManager.pushMatrix();
-            float var8 = ((float)(var7 % var6) / (float)var6 - 0.5F) / 64.0F;
-            float var9 = ((float)(var7 / var6) / (float)var6 - 0.5F) / 64.0F;
-            float var10 = 0.0F;
-            GlStateManager.translate(var8, var9, var10);
-            GlStateManager.rotate(MathHelper.sin(((float)this.panoramaTimer + p_73970_3_) / 400.0F) * 25.0F + 20.0F, 1.0F, 0.0F, 0.0F);
-            GlStateManager.rotate(-((float)this.panoramaTimer + p_73970_3_) * 0.1F, 0.0F, 1.0F, 0.0F);
-
-            for (int var11 = 0; var11 < 6; ++var11)
-            {
-                GlStateManager.pushMatrix();
-
-                if (var11 == 1)
-                {
-                    GlStateManager.rotate(90.0F, 0.0F, 1.0F, 0.0F);
-                }
-
-                if (var11 == 2)
-                {
-                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
-                }
-
-                if (var11 == 3)
-                {
-                    GlStateManager.rotate(-90.0F, 0.0F, 1.0F, 0.0F);
-                }
-
-                if (var11 == 4)
-                {
-                    GlStateManager.rotate(90.0F, 1.0F, 0.0F, 0.0F);
-                }
-
-                if (var11 == 5)
-                {
-                    GlStateManager.rotate(-90.0F, 1.0F, 0.0F, 0.0F);
-                }
-
-                this.mc.getTextureManager().bindTexture(titlePanoramaPaths[var11]);
-                var5.startDrawingQuads();
-                var5.func_178974_a(16777215, 255 / (var7 + 1));
-                float var12 = 0.0F;
-                var5.addVertexWithUV(-1.0D, -1.0D, 1.0D, (double)(0.0F + var12), (double)(0.0F + var12));
-                var5.addVertexWithUV(1.0D, -1.0D, 1.0D, (double)(1.0F - var12), (double)(0.0F + var12));
-                var5.addVertexWithUV(1.0D, 1.0D, 1.0D, (double)(1.0F - var12), (double)(1.0F - var12));
-                var5.addVertexWithUV(-1.0D, 1.0D, 1.0D, (double)(0.0F + var12), (double)(1.0F - var12));
-                var4.draw();
-                GlStateManager.popMatrix();
-            }
-
-            GlStateManager.popMatrix();
-            GlStateManager.colorMask(true, true, true, false);
-        }
-
-        var5.setTranslation(0.0D, 0.0D, 0.0D);
-        GlStateManager.colorMask(true, true, true, true);
-        GlStateManager.matrixMode(5889);
-        GlStateManager.popMatrix();
-        GlStateManager.matrixMode(5888);
-        GlStateManager.popMatrix();
-        GlStateManager.depthMask(true);
-        GlStateManager.enableCull();
-        GlStateManager.enableDepth();
-    }
-
-    /**
-     * Rotate and blurs the skybox view in the main menu
-     */
-    private void rotateAndBlurSkybox(float p_73968_1_)
-    {
-        this.mc.getTextureManager().bindTexture(this.field_110351_G);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
-        GL11.glCopyTexSubImage2D(GL11.GL_TEXTURE_2D, 0, 0, 0, 0, 0, 256, 256);
-        GlStateManager.enableBlend();
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        GlStateManager.colorMask(true, true, true, false);
-        Tessellator var2 = Tessellator.getInstance();
-        WorldRenderer var3 = var2.getWorldRenderer();
-        var3.startDrawingQuads();
-        GlStateManager.disableAlpha();
-        byte var4 = 3;
-
-        for (int var5 = 0; var5 < var4; ++var5)
-        {
-            var3.func_178960_a(1.0F, 1.0F, 1.0F, 1.0F / (float)(var5 + 1));
-            int var6 = this.width;
-            int var7 = this.height;
-            float var8 = (float)(var5 - var4 / 2) / 256.0F;
-            var3.addVertexWithUV((double)var6, (double)var7, (double)this.zLevel, (double)(0.0F + var8), 1.0D);
-            var3.addVertexWithUV((double)var6, 0.0D, (double)this.zLevel, (double)(1.0F + var8), 1.0D);
-            var3.addVertexWithUV(0.0D, 0.0D, (double)this.zLevel, (double)(1.0F + var8), 0.0D);
-            var3.addVertexWithUV(0.0D, (double)var7, (double)this.zLevel, (double)(0.0F + var8), 0.0D);
-        }
-
-        var2.draw();
-        GlStateManager.enableAlpha();
-        GlStateManager.colorMask(true, true, true, true);
-    }
-
-    /**
-     * Renders the skybox in the main menu
-     */
-    private void renderSkybox(int p_73971_1_, int p_73971_2_, float p_73971_3_)
-    {
-        this.mc.getFramebuffer().unbindFramebuffer();
-        GlStateManager.viewport(0, 0, 256, 256);
-        this.drawPanorama(p_73971_1_, p_73971_2_, p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.rotateAndBlurSkybox(p_73971_3_);
-        this.mc.getFramebuffer().bindFramebuffer(true);
-        GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
-        Tessellator var4 = Tessellator.getInstance();
-        WorldRenderer var5 = var4.getWorldRenderer();
-        var5.startDrawingQuads();
-        float var6 = this.width > this.height ? 120.0F / (float)this.width : 120.0F / (float)this.height;
-        float var7 = (float)this.height * var6 / 256.0F;
-        float var8 = (float)this.width * var6 / 256.0F;
-        var5.func_178960_a(1.0F, 1.0F, 1.0F, 1.0F);
-        int var9 = this.width;
-        int var10 = this.height;
-        var5.addVertexWithUV(0.0D, (double)var10, (double)this.zLevel, (double)(0.5F - var7), (double)(0.5F + var8));
-        var5.addVertexWithUV((double)var9, (double)var10, (double)this.zLevel, (double)(0.5F - var7), (double)(0.5F - var8));
-        var5.addVertexWithUV((double)var9, 0.0D, (double)this.zLevel, (double)(0.5F + var7), (double)(0.5F - var8));
-        var5.addVertexWithUV(0.0D, 0.0D, (double)this.zLevel, (double)(0.5F + var7), (double)(0.5F + var8));
-        var4.draw();
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        GlStateManager.disableAlpha();
-        this.renderSkybox(mouseX, mouseY, partialTicks);
-        GlStateManager.enableAlpha();
-        Tessellator var4 = Tessellator.getInstance();
-        WorldRenderer var5 = var4.getWorldRenderer();
-        short var6 = 274;
-        int var7 = this.width / 2 - var6 / 2;
-        byte var8 = 30;
-        this.drawGradientRect(0, 0, this.width, this.height, -2130706433, 16777215);
-        this.drawGradientRect(0, 0, this.width, this.height, 0, Integer.MIN_VALUE);
-        this.mc.getTextureManager().bindTexture(minecraftTitleTextures);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-
-        if ((double)this.updateCounter < 1.0E-4D)
-        {
-            this.drawTexturedModalRect(var7 + 0, var8 + 0, 0, 0, 99, 44);
-            this.drawTexturedModalRect(var7 + 99, var8 + 0, 129, 0, 27, 44);
-            this.drawTexturedModalRect(var7 + 99 + 26, var8 + 0, 126, 0, 3, 44);
-            this.drawTexturedModalRect(var7 + 99 + 26 + 3, var8 + 0, 99, 0, 26, 44);
-            this.drawTexturedModalRect(var7 + 155, var8 + 0, 0, 45, 155, 44);
-        }
-        else
-        {
-            this.drawTexturedModalRect(var7 + 0, var8 + 0, 0, 0, 155, 44);
-            this.drawTexturedModalRect(var7 + 155, var8 + 0, 0, 45, 155, 44);
-        }
-
-        var5.func_178991_c(-1);
-        GlStateManager.pushMatrix();
-        GlStateManager.translate((float)(this.width / 2 + 90), 70.0F, 0.0F);
-        GlStateManager.rotate(-20.0F, 0.0F, 0.0F, 1.0F);
-        float var9 = 1.8F - MathHelper.abs(MathHelper.sin((float)(Minecraft.getSystemTime() % 1000L) / 1000.0F * (float)Math.PI * 2.0F) * 0.1F);
-        var9 = var9 * 100.0F / (float)(this.fontRendererObj.getStringWidth(this.splashText) + 32);
-        GlStateManager.scale(var9, var9, var9);
-        this.drawCenteredString(this.fontRendererObj, this.splashText, 0, -8, -256);
-        GlStateManager.popMatrix();
-        String var10 = "Minecraft 1.8";
-
-        if (this.mc.isDemo())
-        {
-            var10 = var10 + " Demo";
-        }
-
-        this.drawString(this.fontRendererObj, var10, 2, this.height - 10, -1);
-        String var11 = "Copyright Mojang AB. Do not distribute!";
-        this.drawString(this.fontRendererObj, var11, this.width - this.fontRendererObj.getStringWidth(var11) - 2, this.height - 10, -1);
-
-        if (this.field_92025_p != null && this.field_92025_p.length() > 0)
-        {
-            drawRect(this.field_92022_t - 2, this.field_92021_u - 2, this.field_92020_v + 2, this.field_92019_w - 1, 1428160512);
-            this.drawString(this.fontRendererObj, this.field_92025_p, this.field_92022_t, this.field_92021_u, -1);
-            this.drawString(this.fontRendererObj, this.field_146972_A, (this.width - this.field_92024_r) / 2, ((GuiButton)this.buttonList.get(0)).yPosition - 12, -1);
-        }
-
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-
-    /**
-     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
-     */
-    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
-    {
-        super.mouseClicked(mouseX, mouseY, mouseButton);
-        Object var4 = this.field_104025_t;
-
-        synchronized (this.field_104025_t)
-        {
-            if (this.field_92025_p.length() > 0 && mouseX >= this.field_92022_t && mouseX <= this.field_92020_v && mouseY >= this.field_92021_u && mouseY <= this.field_92019_w)
-            {
-                GuiConfirmOpenLink var5 = new GuiConfirmOpenLink(this, this.field_104024_v, 13, true);
-                var5.disableSecurityWarning();
-                this.mc.displayGuiScreen(var5);
-            }
-        }
-    }
-}
+package net.minecraft.client.gui;
+
+import static org.lwjgl.opengl.GL11.GL_BLEND;
+import static org.lwjgl.opengl.GL11.GL_ONE_MINUS_SRC_ALPHA;
+import static org.lwjgl.opengl.GL11.GL_SRC_ALPHA;
+import static org.lwjgl.opengl.GL11.glBlendFunc;
+import static org.lwjgl.opengl.GL11.glEnable;
+
+import java.io.BufferedReader;
+import java.io.IOException;
+import java.io.InputStreamReader;
+import java.net.URI;
+import java.net.URL;
+import java.util.ArrayList;
+import java.util.Calendar;
+import java.util.Date;
+import java.util.Random;
+import java.util.concurrent.atomic.AtomicInteger;
+
+import javax.net.ssl.HttpsURLConnection;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.OpenGlHelper;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.texture.DynamicTexture;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.realms.RealmsBridge;
+import net.minecraft.util.EnumChatFormatting;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.world.demo.DemoWorldServer;
+import net.minecraft.world.storage.ISaveFormat;
+import net.minecraft.world.storage.WorldInfo;
+
+import org.apache.commons.io.Charsets;
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.opengl.GL11;
+import org.lwjgl.opengl.GLContext;
+import org.lwjgl.util.glu.Project;
+import org.newdawn.slick.util.xml.XMLElement;
+import org.newdawn.slick.util.xml.XMLElementList;
+import org.newdawn.slick.util.xml.XMLParser;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.alts.gui.GuiAlts;
+import tk.wurst_client.utils.MiscUtils;
+
+import com.google.common.collect.Lists;
+
+public class GuiMainMenu extends GuiScreen implements GuiYesNoCallback
+{
+    private static final AtomicInteger field_175373_f = new AtomicInteger(0);
+    private static final Logger logger = LogManager.getLogger();
+    private static final Random field_175374_h = new Random();
+
+    /** Counts the number of screen updates. */
+    private float updateCounter;
+
+    /** The splash message. *///TODO: Client
+    public static String splashText;
+    private GuiButton buttonResetDemo;
+
+    /** Timer used to rotate the panorama, increases every tick. */
+    private int panoramaTimer;
+
+    /**
+     * Texture allocated for the current viewport of the main menu's panorama background.
+     */
+    private DynamicTexture viewportTexture;
+    private boolean field_175375_v = true;
+    private final Object field_104025_t = new Object();
+    private String field_92025_p;
+    private String field_146972_A;
+    private String field_104024_v;
+    private static final ResourceLocation splashTexts = new ResourceLocation("texts/splashes.txt");
+    
+    //TODO: Client
+    private static final ResourceLocation minecraftTitleTextures = new ResourceLocation("wurst/wurst_380.png");
+    private static final ResourceLocation santaHatTexture = new ResourceLocation("wurst/santa_hat.png");
+    private ArrayList<String> newsItems = new ArrayList<String>();
+
+    /** An array of all the paths to the panorama pictures. */
+    private static final ResourceLocation[] titlePanoramaPaths = new ResourceLocation[] {new ResourceLocation("textures/gui/title/background/panorama_0.png"), new ResourceLocation("textures/gui/title/background/panorama_1.png"), new ResourceLocation("textures/gui/title/background/panorama_2.png"), new ResourceLocation("textures/gui/title/background/panorama_3.png"), new ResourceLocation("textures/gui/title/background/panorama_4.png"), new ResourceLocation("textures/gui/title/background/panorama_5.png")};
+    public static final String field_96138_a = "Please click " + EnumChatFormatting.UNDERLINE + "here" + EnumChatFormatting.RESET + " for more information.";
+    private int field_92024_r;
+    private int field_92023_s;
+    private int field_92022_t;
+    private int field_92021_u;
+    private int field_92020_v;
+    private int field_92019_w;
+    private ResourceLocation field_110351_G;
+    private GuiButton field_175372_K;
+    private static final String __OBFID = "CL_00001154";
+
+    public GuiMainMenu()
+    {
+        this.field_146972_A = field_96138_a;
+        this.splashText = "missingno";
+        BufferedReader var1 = null;
+
+        try
+        {
+            ArrayList var2 = Lists.newArrayList();
+            var1 = new BufferedReader(new InputStreamReader(Minecraft.getMinecraft().getResourceManager().getResource(splashTexts).getInputStream(), Charsets.UTF_8));
+            String var3;
+
+            while ((var3 = var1.readLine()) != null)
+            {
+                var3 = var3.trim();
+
+                if (!var3.isEmpty())
+                {
+                    var2.add(var3);
+                }
+            }
+
+            if (!var2.isEmpty())
+            {
+                do
+                {
+                    this.splashText = (String)var2.get(field_175374_h.nextInt(var2.size()));
+                }
+                while (this.splashText.hashCode() == 125780783);
+            }
+        }
+        catch (IOException var12)
+        {
+            ;
+        }
+        finally
+        {
+            if (var1 != null)
+            {
+                try
+                {
+                    var1.close();
+                }
+                catch (IOException var11)
+                {
+                    ;
+                }
+            }
+        }
+
+        this.updateCounter = field_175374_h.nextFloat();
+        this.field_92025_p = "";
+
+        if (!GLContext.getCapabilities().OpenGL20 && !OpenGlHelper.areShadersSupported())
+        {
+            this.field_92025_p = I18n.format("title.oldgl1", new Object[0]);
+            this.field_146972_A = I18n.format("title.oldgl2", new Object[0]);
+            this.field_104024_v = "https://help.mojang.com/customer/portal/articles/325948?ref=game";
+        }
+        
+        //TODO: Client
+		WurstClient.INSTANCE.analytics.trackPageView("/", "Main Menu");
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        ++this.panoramaTimer;
+    }
+
+    /**
+     * Returns true if this GUI should pause the game when it is displayed in single-player
+     */
+    public boolean doesGuiPauseGame()
+    {
+        return false;
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException {}
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.viewportTexture = new DynamicTexture(256, 256);
+        this.field_110351_G = this.mc.getTextureManager().getDynamicTextureLocation("background", this.viewportTexture);
+        Calendar var1 = Calendar.getInstance();
+        var1.setTime(new Date());
+
+        if (var1.get(2) + 1 == 11 && var1.get(5) == 9)
+        {
+            this.splashText = "Happy birthday, ez!";
+        }
+        else if (var1.get(2) + 1 == 6 && var1.get(5) == 1)
+        {
+            this.splashText = "Happy birthday, Notch!";
+        }
+        else if (var1.get(2) + 1 == 12 && var1.get(5) == 24)
+        {
+            this.splashText = "Merry X-mas!";
+        }
+        else if (var1.get(2) + 1 == 1 && var1.get(5) == 1)
+        {
+            this.splashText = "Happy new year!";
+        }
+        else if (var1.get(2) + 1 == 10 && var1.get(5) == 31)
+        {
+            this.splashText = "OOoooOOOoooo! Spooky!";
+            //TODO: Client
+        }else if (var1.get(2) + 1 == 2 && var1.get(5) == 9)
+        {
+            this.splashText = "Happy birthday, Alexander01998!";
+        }
+        if((GuiMainMenu.splashText.equals("1C2o3l4o5r6m7a8t9iac") || GuiMainMenu.splashText.equals("Thousands of colors!")))
+        	Tessellator.shouldRenderLSD = true;
+        else
+        	Tessellator.shouldRenderLSD = false;
+
+        WurstClient.INSTANCE.currentServerIP = "127.0.0.1:25565";
+
+        boolean var2 = true;
+        int var3 = this.height / 4 + 48;
+
+        if (this.mc.isDemo())
+        {
+            this.addDemoButtons(var3, 24);
+        }
+        else
+        {
+            this.addSingleplayerMultiplayerButtons(var3, 24);
+        }
+
+        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, var3 + 72 + 24, 98, 20, I18n.format("menu.options", new Object[0])));
+        this.buttonList.add(new GuiButton(4, this.width / 2 + 2, var3 + 72 + 24, 98, 20, I18n.format("menu.quit", new Object[0])));
+        this.buttonList.add(new GuiButtonLanguage(5, this.width / 2 - 124, var3 + 72 + 24));
+        Object var4 = this.field_104025_t;
+
+        synchronized (this.field_104025_t)
+        {
+            this.field_92023_s = this.fontRendererObj.getStringWidth(this.field_92025_p);
+            this.field_92024_r = this.fontRendererObj.getStringWidth(this.field_146972_A);
+            int var5 = Math.max(this.field_92023_s, this.field_92024_r);
+            this.field_92022_t = (this.width - var5) / 2;
+            this.field_92021_u = ((GuiButton)this.buttonList.get(0)).yPosition - 24;
+            this.field_92020_v = this.field_92022_t + var5;
+            this.field_92019_w = this.field_92021_u + 24;
+        }
+        
+        //TODO: Client
+        new Thread(new Runnable()
+		{
+			@Override
+			public void run()
+			{
+				try
+				{
+					newsItems.clear();
+					if(!WurstClient.INSTANCE.options.wurstNews)
+						return;
+					HttpsURLConnection connection = (HttpsURLConnection)new URL("https://www.wurst-client.tk/news/feed.xml").openConnection();
+					connection.connect();
+					XMLElement xml = new XMLParser().parse("", connection.getInputStream());
+					XMLElementList xmlItems = xml.getChildrenByName("channel").get(0).getChildrenByName("item");
+					for(int i = 0; i < xmlItems.size(); i++)
+					{
+						XMLElement xmlItem = xmlItems.get(i);
+						newsItems.add(xmlItem.getChildrenByName("title").get(0).getContent());
+					}
+				}catch(Exception e)
+				{
+					e.printStackTrace();
+				}
+			}
+		}).start();
+    }
+
+    /**
+     * Adds Singleplayer and Multiplayer buttons on Main Menu for players who have bought the game.
+     */
+    private void addSingleplayerMultiplayerButtons(int p_73969_1_, int p_73969_2_)
+    {
+        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, p_73969_1_, I18n.format("menu.singleplayer", new Object[0])));
+        this.buttonList.add(new GuiButton(2, this.width / 2 - 100, p_73969_1_ + p_73969_2_ * 1, I18n.format("menu.multiplayer", new Object[0])));
+        //TODO: Client
+        this.buttonList.add(new GuiButton(3, this.width / 2 - 100, p_73969_1_ + p_73969_2_ * 2, "Alt Manager"));
+        //this.buttonList.add(this.field_175372_K = new GuiButton(14, this.width / 2 - 100, p_73969_1_ + p_73969_2_ * 2, I18n.format("menu.online", new Object[0])));
+    }
+
+    /**
+     * Adds Demo buttons on Main Menu for players who are playing Demo.
+     */
+    private void addDemoButtons(int p_73972_1_, int p_73972_2_)
+    {
+        this.buttonList.add(new GuiButton(11, this.width / 2 - 100, p_73972_1_, I18n.format("menu.playdemo", new Object[0])));
+        this.buttonList.add(this.buttonResetDemo = new GuiButton(12, this.width / 2 - 100, p_73972_1_ + p_73972_2_ * 1, I18n.format("menu.resetdemo", new Object[0])));
+        ISaveFormat var3 = this.mc.getSaveLoader();
+        WorldInfo var4 = var3.getWorldInfo("Demo_World");
+
+        if (var4 == null)
+        {
+            this.buttonResetDemo.enabled = false;
+        }
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.id == 0)
+        {
+            this.mc.displayGuiScreen(new GuiOptions(this, this.mc.gameSettings));
+        }
+
+        if (button.id == 5)
+        {
+            this.mc.displayGuiScreen(new GuiLanguage(this, this.mc.gameSettings, this.mc.getLanguageManager()));
+        }
+
+        if (button.id == 1)
+        {
+            this.mc.displayGuiScreen(new GuiSelectWorld(this));
+        }
+
+        if (button.id == 2)
+        {
+            this.mc.displayGuiScreen(new GuiMultiplayer(this));
+        }
+        //TODO: Client
+        if (button.id == 3)
+        {
+            this.mc.displayGuiScreen(new GuiAlts(this));
+        }
+
+        if (button.id == 14 && this.field_175372_K.visible)
+        {
+            this.switchToRealms();
+        }
+
+        if (button.id == 4)
+        {
+            this.mc.shutdown();
+        }
+
+        if (button.id == 11)
+        {
+            this.mc.launchIntegratedServer("Demo_World", "Demo_World", DemoWorldServer.demoWorldSettings);
+        }
+
+        if (button.id == 12)
+        {
+            ISaveFormat var2 = this.mc.getSaveLoader();
+            WorldInfo var3 = var2.getWorldInfo("Demo_World");
+
+            if (var3 != null)
+            {
+                GuiYesNo var4 = GuiSelectWorld.func_152129_a(this, var3.getWorldName(), 12);
+                this.mc.displayGuiScreen(var4);
+            }
+        }
+    }
+
+    private void switchToRealms()
+    {
+        RealmsBridge var1 = new RealmsBridge();
+        var1.switchToRealms(this);
+    }
+
+    public void confirmClicked(boolean result, int id)
+    {
+        if (result && id == 12)
+        {
+            ISaveFormat var6 = this.mc.getSaveLoader();
+            var6.flushCache();
+            var6.deleteWorldDirectory("Demo_World");
+            this.mc.displayGuiScreen(this);
+        }
+        else if (id == 13)
+        {
+            if (result)
+            {
+                try
+                {
+                    Class var3 = Class.forName("java.awt.Desktop");
+                    Object var4 = var3.getMethod("getDesktop", new Class[0]).invoke((Object)null, new Object[0]);
+                    var3.getMethod("browse", new Class[] {URI.class}).invoke(var4, new Object[] {new URI(this.field_104024_v)});
+                }
+                catch (Throwable var5)
+                {
+                    logger.error("Couldn\'t open link", var5);
+                }
+            }
+
+            this.mc.displayGuiScreen(this);
+        }
+        //TODO: Client
+        if(id == 1)
+		{
+			if(result)
+			{
+				MiscUtils
+					.openLink("https://www.youtube.com/watch?v=_Gf8oaC9QKM");
+				WurstClient.INSTANCE.analytics.trackEvent("christmas easter egg",
+					"play christmas song");
+				this.mc.shutdown();
+			}else
+			{
+				this.mc.displayGuiScreen(this);
+				WurstClient.INSTANCE.analytics.trackEvent("christmas easter egg",
+					"grief on christmas");
+			}
+		}
+    }
+
+    /**
+     * Draws the main menu panorama
+     */
+    private void drawPanorama(int p_73970_1_, int p_73970_2_, float p_73970_3_)
+    {
+        Tessellator var4 = Tessellator.getInstance();
+        WorldRenderer var5 = var4.getWorldRenderer();
+        GlStateManager.matrixMode(5889);
+        GlStateManager.pushMatrix();
+        GlStateManager.loadIdentity();
+        Project.gluPerspective(120.0F, 1.0F, 0.05F, 10.0F);
+        GlStateManager.matrixMode(5888);
+        GlStateManager.pushMatrix();
+        GlStateManager.loadIdentity();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.rotate(180.0F, 1.0F, 0.0F, 0.0F);
+        GlStateManager.rotate(90.0F, 0.0F, 0.0F, 1.0F);
+        GlStateManager.enableBlend();
+        GlStateManager.disableAlpha();
+        GlStateManager.disableCull();
+        GlStateManager.depthMask(false);
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        byte var6 = 8;
+
+        for (int var7 = 0; var7 < var6 * var6; ++var7)
+        {
+            GlStateManager.pushMatrix();
+            float var8 = ((float)(var7 % var6) / (float)var6 - 0.5F) / 64.0F;
+            float var9 = ((float)(var7 / var6) / (float)var6 - 0.5F) / 64.0F;
+            float var10 = 0.0F;
+            GlStateManager.translate(var8, var9, var10);
+            GlStateManager.rotate(MathHelper.sin(((float)this.panoramaTimer + p_73970_3_) / 400.0F) * 25.0F + 20.0F, 1.0F, 0.0F, 0.0F);
+            GlStateManager.rotate(-((float)this.panoramaTimer + p_73970_3_) * 0.1F, 0.0F, 1.0F, 0.0F);
+
+            for (int var11 = 0; var11 < 6; ++var11)
+            {
+                GlStateManager.pushMatrix();
+
+                if (var11 == 1)
+                {
+                    GlStateManager.rotate(90.0F, 0.0F, 1.0F, 0.0F);
+                }
+
+                if (var11 == 2)
+                {
+                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
+                }
+
+                if (var11 == 3)
+                {
+                    GlStateManager.rotate(-90.0F, 0.0F, 1.0F, 0.0F);
+                }
+
+                if (var11 == 4)
+                {
+                    GlStateManager.rotate(90.0F, 1.0F, 0.0F, 0.0F);
+                }
+
+                if (var11 == 5)
+                {
+                    GlStateManager.rotate(-90.0F, 1.0F, 0.0F, 0.0F);
+                }
+
+                this.mc.getTextureManager().bindTexture(titlePanoramaPaths[var11]);
+                var5.startDrawingQuads();
+                var5.setColorRGBA_I(16777215, 255 / (var7 + 1));
+                float var12 = 0.0F;
+                var5.addVertexWithUV(-1.0D, -1.0D, 1.0D, (double)(0.0F + var12), (double)(0.0F + var12));
+                var5.addVertexWithUV(1.0D, -1.0D, 1.0D, (double)(1.0F - var12), (double)(0.0F + var12));
+                var5.addVertexWithUV(1.0D, 1.0D, 1.0D, (double)(1.0F - var12), (double)(1.0F - var12));
+                var5.addVertexWithUV(-1.0D, 1.0D, 1.0D, (double)(0.0F + var12), (double)(1.0F - var12));
+                var4.draw();
+                GlStateManager.popMatrix();
+            }
+
+            GlStateManager.popMatrix();
+            GlStateManager.colorMask(true, true, true, false);
+        }
+
+        var5.setTranslation(0.0D, 0.0D, 0.0D);
+        GlStateManager.colorMask(true, true, true, true);
+        GlStateManager.matrixMode(5889);
+        GlStateManager.popMatrix();
+        GlStateManager.matrixMode(5888);
+        GlStateManager.popMatrix();
+        GlStateManager.depthMask(true);
+        GlStateManager.enableCull();
+        GlStateManager.enableDepth();
+    }
+
+    /**
+     * Rotate and blurs the skybox view in the main menu
+     */
+    private void rotateAndBlurSkybox(float p_73968_1_)
+    {
+        this.mc.getTextureManager().bindTexture(this.field_110351_G);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
+        GL11.glCopyTexSubImage2D(GL11.GL_TEXTURE_2D, 0, 0, 0, 0, 0, 256, 256);
+        GlStateManager.enableBlend();
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        GlStateManager.colorMask(true, true, true, false);
+        Tessellator var2 = Tessellator.getInstance();
+        WorldRenderer var3 = var2.getWorldRenderer();
+        var3.startDrawingQuads();
+        GlStateManager.disableAlpha();
+        byte var4 = 3;
+
+        for (int var5 = 0; var5 < var4; ++var5)
+        {
+            var3.setColorRGBA_F(1.0F, 1.0F, 1.0F, 1.0F / (float)(var5 + 1));
+            int var6 = this.width;
+            int var7 = this.height;
+            float var8 = (float)(var5 - var4 / 2) / 256.0F;
+            var3.addVertexWithUV((double)var6, (double)var7, (double)this.zLevel, (double)(0.0F + var8), 1.0D);
+            var3.addVertexWithUV((double)var6, 0.0D, (double)this.zLevel, (double)(1.0F + var8), 1.0D);
+            var3.addVertexWithUV(0.0D, 0.0D, (double)this.zLevel, (double)(1.0F + var8), 0.0D);
+            var3.addVertexWithUV(0.0D, (double)var7, (double)this.zLevel, (double)(0.0F + var8), 0.0D);
+        }
+
+        var2.draw();
+        GlStateManager.enableAlpha();
+        GlStateManager.colorMask(true, true, true, true);
+    }
+
+    /**
+     * Renders the skybox in the main menu
+     */
+    private void renderSkybox(int p_73971_1_, int p_73971_2_, float p_73971_3_)
+    {
+        this.mc.getFramebuffer().unbindFramebuffer();
+        GlStateManager.viewport(0, 0, 256, 256);
+        this.drawPanorama(p_73971_1_, p_73971_2_, p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.rotateAndBlurSkybox(p_73971_3_);
+        this.mc.getFramebuffer().bindFramebuffer(true);
+        GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
+        Tessellator var4 = Tessellator.getInstance();
+        WorldRenderer var5 = var4.getWorldRenderer();
+        var5.startDrawingQuads();
+        float var6 = this.width > this.height ? 120.0F / (float)this.width : 120.0F / (float)this.height;
+        float var7 = (float)this.height * var6 / 256.0F;
+        float var8 = (float)this.width * var6 / 256.0F;
+        var5.setColorRGBA_F(1.0F, 1.0F, 1.0F, 1.0F);
+        int var9 = this.width;
+        int var10 = this.height;
+        var5.addVertexWithUV(0.0D, (double)var10, (double)this.zLevel, (double)(0.5F - var7), (double)(0.5F + var8));
+        var5.addVertexWithUV((double)var9, (double)var10, (double)this.zLevel, (double)(0.5F - var7), (double)(0.5F - var8));
+        var5.addVertexWithUV((double)var9, 0.0D, (double)this.zLevel, (double)(0.5F + var7), (double)(0.5F - var8));
+        var5.addVertexWithUV(0.0D, 0.0D, (double)this.zLevel, (double)(0.5F + var7), (double)(0.5F + var8));
+        var4.draw();
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        GlStateManager.disableAlpha();
+        this.renderSkybox(mouseX, mouseY, partialTicks);
+        GlStateManager.enableAlpha();
+        Tessellator var4 = Tessellator.getInstance();
+        WorldRenderer var5 = var4.getWorldRenderer();
+        
+        //TODO: Client
+        short var6 = 256;
+        int var7 = this.width / 2 - var6 / 2;
+        byte var8 = 30;
+        this.drawGradientRect(0, 0, this.width, this.height, -2130706433, 16777215);
+        this.drawGradientRect(0, 0, this.width, this.height, 0, Integer.MIN_VALUE);
+        this.mc.getTextureManager().bindTexture(minecraftTitleTextures);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        glEnable(GL_BLEND);
+		glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
+        double x = var7;
+        double y = var8;
+        double h = 64;
+        double w = 256;
+        double fw = 256;
+        double fh = 256;
+        double u = 0;
+        double v = 0;
+        if(GuiMainMenu.splashText.equals("umop-apisdn!"))
+        {
+        	GL11.glRotatef(180.0F, 0.0F, 0.0F, 1.0F);
+        	GL11.glTranslatef((float)(-this.width), (float) (-h - 60), 0.0F);
+        }
+        if ((double)this.updateCounter < 1.0E-4D)
+        {
+        	var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 0, (double)y + h, (double)this.zLevel, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 120, (double)y + h, (double)this.zLevel, (double)((float)(u + 120) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 120, (double)y + 0, (double)this.zLevel, (double)((float)(u + 120) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 0, (double)y + 0, (double)this.zLevel, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+            var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 120, (double)y + h, (double)this.zLevel, (double)((float)(160 + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 120 + 38, (double)y + h, (double)this.zLevel, (double)((float)(160 + 38) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 120 + 38, (double)y + 0, (double)this.zLevel, (double)((float)(160 + 38) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 120 + 0, (double)y + 0, (double)this.zLevel, (double)((float)(160 + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+            var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 158 + 0, (double)y + h, (double)this.zLevel, (double)((float)(120 + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 158 + 40, (double)y + h, (double)this.zLevel, (double)((float)(120 + 40) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 158 + 40, (double)y + 0, (double)this.zLevel, (double)((float)(120 + 40) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 158 + 0, (double)y + 0, (double)this.zLevel, (double)((float)(120 + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+            var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 198 + 0, (double)y + h, (double)this.zLevel, (double)((float)(198 + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 198 + 58, (double)y + h, (double)this.zLevel, (double)((float)(198 + 58) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 198 + 58, (double)y + 0, (double)this.zLevel, (double)((float)(198 + 58) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 198 + 0, (double)y + 0, (double)this.zLevel, (double)((float)(198 + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+        }
+        else
+        {
+            var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 0, (double)y + h, (double)this.zLevel, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + w, (double)y + h, (double)this.zLevel, (double)((float)(u + fw) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + w, (double)y + 0, (double)this.zLevel, (double)((float)(u + fw) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 0, (double)y + 0, (double)this.zLevel, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+        }
+        if(Calendar.getInstance().get(Calendar.MONTH) == Calendar.DECEMBER)
+        {
+            this.mc.getTextureManager().bindTexture(santaHatTexture);
+            x = var7 + 192;
+            y = var8 - 36;
+            h = 48;
+            w = 48;
+            fw = 256;
+            fh = 256;
+            u = 0;
+            v = 0;
+            var5.startDrawingQuads();
+            var5.addVertexWithUV((double)x + 0, (double)y + h, (double)0, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + w, (double)y + h, (double)0, (double)((float)(u + fw) * 0.00390625F), (double)((float)(v + fh) * 0.00390625F));
+            var5.addVertexWithUV((double)x + w, (double)y + 0, (double)0, (double)((float)(u + fw) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var5.addVertexWithUV((double)x + 0, (double)y + 0, (double)0, (double)((float)(u + 0) * 0.00390625F), (double)((float)(v + 0) * 0.00390625F));
+            var4.draw();
+        }
+        if(GuiMainMenu.splashText.equals("umop-apisdn!"))
+        {
+        	GL11.glRotatef(-180.0F, 0.0F, 0.0F, 1.0F);
+        	GL11.glTranslatef((float)(-this.width), (float) (-h - 60), 0.0F);
+        }
+
+        var5.setColorOpaque_I(-1);
+        GlStateManager.pushMatrix();
+        GlStateManager.translate((float)(this.width / 2 + 90), 70.0F, 0.0F);
+        GlStateManager.rotate(-20.0F, 0.0F, 0.0F, 1.0F);
+        float var9 = 1.8F - MathHelper.abs(MathHelper.sin((float)(Minecraft.getSystemTime() % 1000L) / 1000.0F * (float)Math.PI * 2.0F) * 0.1F);
+        var9 = var9 * 100.0F / (float)(this.fontRendererObj.getStringWidth(this.splashText) + 32);
+        GlStateManager.scale(var9, var9, var9);
+        
+        //TODO: Client
+        this.drawCenteredString(this.fontRendererObj, this.splashText, 0, 0, -256);
+        GlStateManager.popMatrix();
+        String var10 = "Minecraft 1.8";
+        String wurst10 = "Wurst v" + WurstClient.INSTANCE.VERSION;
+
+        if (this.mc.isDemo())
+        {
+            var10 = var10 + " Demo";
+        }
+
+        //TODO: Client
+        this.drawString(this.fontRendererObj, var10, this.width - this.fontRendererObj.getStringWidth(var10) - 2, 2, -1);
+        this.drawString(this.fontRendererObj, wurst10, 2, 2, -1);
+        String var11 = "Copyright Mojang AB";
+        String wurst11 = "Copyright Alexander01998";
+        this.drawString(this.fontRendererObj, wurst11, 2, 12, -1);
+        this.drawString(this.fontRendererObj, var11, this.width - this.fontRendererObj.getStringWidth(var11) - 2, 12, -1);
+        String var12 = "Do not distribute!";
+        String wurst12 = "All rights reserved.";
+        this.drawString(this.fontRendererObj, wurst12, 2, 22, -1);
+        this.drawString(this.fontRendererObj, var12, this.width - this.fontRendererObj.getStringWidth(var12) - 2, 22, -1);
+        String news = "";
+        for(String item : newsItems)
+		{
+			news += item + "e+++r";
+		}
+        int newsWidth = fontRendererObj.getStringWidth(news);
+        while(fontRendererObj.getStringWidth(news) < Math.max(width * 2, newsWidth * 2) && !news.isEmpty())
+        	news += news;
+        if(!news.isEmpty())
+        {
+        	this.drawCenteredString(fontRendererObj, "nWurst News", this.width / 2, this.height - 20, -1);
+        	this.drawString(this.fontRendererObj, news, -(int)(mc.getSystemTime() / 50 % newsWidth), this.height - 10, -1);
+        }
+
+        if (this.field_92025_p != null && this.field_92025_p.length() > 0)
+        {
+            drawRect(this.field_92022_t - 2, this.field_92021_u - 2, this.field_92020_v + 2, this.field_92019_w - 1, 1428160512);
+            this.drawString(this.fontRendererObj, this.field_92025_p, this.field_92022_t, this.field_92021_u, -1);
+            this.drawString(this.fontRendererObj, this.field_146972_A, (this.width - this.field_92024_r) / 2, ((GuiButton)this.buttonList.get(0)).yPosition - 12, -1);
+        }
+        super.drawScreen(mouseX, mouseY, partialTicks);
+        
+        //TODO: Client
+        if(!WurstClient.INSTANCE.startupMessageDisabled)
+		{
+			if(WurstClient.INSTANCE.updater.isOutdated())
+			{
+				WurstClient.INSTANCE.analytics.trackEvent("updater", "update to v"
+					+ WurstClient.INSTANCE.updater.getLatestVersion(), "from "
+					+ WurstClient.INSTANCE.updater.getCurrentVersion());
+				WurstClient.INSTANCE.updater.update();
+			}else if(Calendar.getInstance().get(Calendar.MONTH) == Calendar.DECEMBER
+				&& Calendar.getInstance().get(Calendar.DAY_OF_MONTH) == 24)
+			{
+				this.mc.displayGuiScreen(new GuiYesNo(this,
+					"Dude, it's Christmas!", "What do you want here?",
+					"I want a Christmas song", "I want to grief", 1));
+				WurstClient.INSTANCE.analytics.trackPageView("/easter-eggs/christmas",
+					"Dude, it's Christmas!");
+			}
+			WurstClient.INSTANCE.startupMessageDisabled = true;
+		}
+    }
+
+    /**
+     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
+     */
+    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
+    {
+        super.mouseClicked(mouseX, mouseY, mouseButton);
+        Object var4 = this.field_104025_t;
+
+        synchronized (this.field_104025_t)
+        {
+            if (this.field_92025_p.length() > 0 && mouseX >= this.field_92022_t && mouseX <= this.field_92020_v && mouseY >= this.field_92021_u && mouseY <= this.field_92019_w)
+            {
+                GuiConfirmOpenLink var5 = new GuiConfirmOpenLink(this, this.field_104024_v, 13, true);
+                var5.disableSecurityWarning();
+                this.mc.displayGuiScreen(var5);
+            }
+        }
+        
+        //TODO: Client
+        if(!newsItems.isEmpty() && mouseButton == 0
+        	&& (mouseY >= this.height - 10 || (mouseY >= this.height - 20
+        	&& mouseX >= this.width / 2 - fontRendererObj.getStringWidth("nWurst News") / 2
+        	&& mouseX <= this.width / 2 + fontRendererObj.getStringWidth("nWurst News") / 2)))
+        	MiscUtils.openLink("https://www.wurst-client.tk/news");
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiMemoryErrorScreen.java b/src/net/minecraft/client/gui/GuiMemoryErrorScreen.java
index 0fb898e..9ab95d0 100644
--- a/src/net/minecraft/client/gui/GuiMemoryErrorScreen.java
+++ b/src/net/minecraft/client/gui/GuiMemoryErrorScreen.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 
 public class GuiMemoryErrorScreen extends GuiScreen
diff --git a/src/net/minecraft/client/gui/GuiMerchant.java b/src/net/minecraft/client/gui/GuiMerchant.java
index 518840e..8c0b1ea 100644
--- a/src/net/minecraft/client/gui/GuiMerchant.java
+++ b/src/net/minecraft/client/gui/GuiMerchant.java
@@ -1,8 +1,11 @@
 package net.minecraft.client.gui;
 
 import io.netty.buffer.Unpooled;
+
 import java.io.IOException;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.inventory.GuiContainer;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.RenderHelper;
@@ -18,6 +21,7 @@ import net.minecraft.util.ResourceLocation;
 import net.minecraft.village.MerchantRecipe;
 import net.minecraft.village.MerchantRecipeList;
 import net.minecraft.world.World;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/gui/GuiMultiplayer.java b/src/net/minecraft/client/gui/GuiMultiplayer.java
index da42542..fb12fbc 100644
--- a/src/net/minecraft/client/gui/GuiMultiplayer.java
+++ b/src/net/minecraft/client/gui/GuiMultiplayer.java
@@ -1,483 +1,634 @@
-package net.minecraft.client.gui;
-
-import com.google.common.base.Splitter;
-import com.google.common.collect.Lists;
-import java.io.IOException;
-import java.util.List;
-import net.minecraft.client.multiplayer.GuiConnecting;
-import net.minecraft.client.multiplayer.ServerData;
-import net.minecraft.client.multiplayer.ServerList;
-import net.minecraft.client.network.LanServerDetector;
-import net.minecraft.client.network.OldServerPinger;
-import net.minecraft.client.resources.I18n;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.input.Keyboard;
-
-public class GuiMultiplayer extends GuiScreen implements GuiYesNoCallback
-{
-    private static final Logger logger = LogManager.getLogger();
-    private final OldServerPinger oldServerPinger = new OldServerPinger();
-    private GuiScreen parentScreen;
-    private ServerSelectionList serverListSelector;
-    private ServerList savedServerList;
-    private GuiButton btnEditServer;
-    private GuiButton btnSelectServer;
-    private GuiButton btnDeleteServer;
-    private boolean deletingServer;
-    private boolean addingServer;
-    private boolean editingServer;
-    private boolean directConnect;
-    private String field_146812_y;
-    private ServerData selectedServer;
-    private LanServerDetector.LanServerList lanServerList;
-    private LanServerDetector.ThreadLanServerFind lanServerDetector;
-    private boolean initialized;
-    private static final String __OBFID = "CL_00000814";
-
-    public GuiMultiplayer(GuiScreen parentScreen)
-    {
-        this.parentScreen = parentScreen;
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        Keyboard.enableRepeatEvents(true);
-        this.buttonList.clear();
-
-        if (!this.initialized)
-        {
-            this.initialized = true;
-            this.savedServerList = new ServerList(this.mc);
-            this.savedServerList.loadServerList();
-            this.lanServerList = new LanServerDetector.LanServerList();
-
-            try
-            {
-                this.lanServerDetector = new LanServerDetector.ThreadLanServerFind(this.lanServerList);
-                this.lanServerDetector.start();
-            }
-            catch (Exception var2)
-            {
-                logger.warn("Unable to start LAN server detection: " + var2.getMessage());
-            }
-
-            this.serverListSelector = new ServerSelectionList(this, this.mc, this.width, this.height, 32, this.height - 64, 36);
-            this.serverListSelector.func_148195_a(this.savedServerList);
-        }
-        else
-        {
-            this.serverListSelector.setDimensions(this.width, this.height, 32, this.height - 64);
-        }
-
-        this.createButtons();
-    }
-
-    /**
-     * Handles mouse input.
-     */
-    public void handleMouseInput() throws IOException
-    {
-        super.handleMouseInput();
-        this.serverListSelector.func_178039_p();
-    }
-
-    public void createButtons()
-    {
-        this.buttonList.add(this.btnEditServer = new GuiButton(7, this.width / 2 - 154, this.height - 28, 70, 20, I18n.format("selectServer.edit", new Object[0])));
-        this.buttonList.add(this.btnDeleteServer = new GuiButton(2, this.width / 2 - 74, this.height - 28, 70, 20, I18n.format("selectServer.delete", new Object[0])));
-        this.buttonList.add(this.btnSelectServer = new GuiButton(1, this.width / 2 - 154, this.height - 52, 100, 20, I18n.format("selectServer.select", new Object[0])));
-        this.buttonList.add(new GuiButton(4, this.width / 2 - 50, this.height - 52, 100, 20, I18n.format("selectServer.direct", new Object[0])));
-        this.buttonList.add(new GuiButton(3, this.width / 2 + 4 + 50, this.height - 52, 100, 20, I18n.format("selectServer.add", new Object[0])));
-        this.buttonList.add(new GuiButton(8, this.width / 2 + 4, this.height - 28, 70, 20, I18n.format("selectServer.refresh", new Object[0])));
-        this.buttonList.add(new GuiButton(0, this.width / 2 + 4 + 76, this.height - 28, 75, 20, I18n.format("gui.cancel", new Object[0])));
-        this.selectServer(this.serverListSelector.func_148193_k());
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        super.updateScreen();
-
-        if (this.lanServerList.getWasUpdated())
-        {
-            List var1 = this.lanServerList.getLanServers();
-            this.lanServerList.setWasNotUpdated();
-            this.serverListSelector.func_148194_a(var1);
-        }
-
-        this.oldServerPinger.pingPendingNetworks();
-    }
-
-    /**
-     * Called when the screen is unloaded. Used to disable keyboard repeat events
-     */
-    public void onGuiClosed()
-    {
-        Keyboard.enableRepeatEvents(false);
-
-        if (this.lanServerDetector != null)
-        {
-            this.lanServerDetector.interrupt();
-            this.lanServerDetector = null;
-        }
-
-        this.oldServerPinger.clearPendingNetworks();
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.enabled)
-        {
-            GuiListExtended.IGuiListEntry var2 = this.serverListSelector.func_148193_k() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.func_148193_k());
-
-            if (button.id == 2 && var2 instanceof ServerListEntryNormal)
-            {
-                String var9 = ((ServerListEntryNormal)var2).getServerData().serverName;
-
-                if (var9 != null)
-                {
-                    this.deletingServer = true;
-                    String var4 = I18n.format("selectServer.deleteQuestion", new Object[0]);
-                    String var5 = "\'" + var9 + "\' " + I18n.format("selectServer.deleteWarning", new Object[0]);
-                    String var6 = I18n.format("selectServer.deleteButton", new Object[0]);
-                    String var7 = I18n.format("gui.cancel", new Object[0]);
-                    GuiYesNo var8 = new GuiYesNo(this, var4, var5, var6, var7, this.serverListSelector.func_148193_k());
-                    this.mc.displayGuiScreen(var8);
-                }
-            }
-            else if (button.id == 1)
-            {
-                this.connectToSelected();
-            }
-            else if (button.id == 4)
-            {
-                this.directConnect = true;
-                this.mc.displayGuiScreen(new GuiScreenServerList(this, this.selectedServer = new ServerData(I18n.format("selectServer.defaultName", new Object[0]), "")));
-            }
-            else if (button.id == 3)
-            {
-                this.addingServer = true;
-                this.mc.displayGuiScreen(new GuiScreenAddServer(this, this.selectedServer = new ServerData(I18n.format("selectServer.defaultName", new Object[0]), "")));
-            }
-            else if (button.id == 7 && var2 instanceof ServerListEntryNormal)
-            {
-                this.editingServer = true;
-                ServerData var3 = ((ServerListEntryNormal)var2).getServerData();
-                this.selectedServer = new ServerData(var3.serverName, var3.serverIP);
-                this.selectedServer.copyFrom(var3);
-                this.mc.displayGuiScreen(new GuiScreenAddServer(this, this.selectedServer));
-            }
-            else if (button.id == 0)
-            {
-                this.mc.displayGuiScreen(this.parentScreen);
-            }
-            else if (button.id == 8)
-            {
-                this.refreshServerList();
-            }
-        }
-    }
-
-    private void refreshServerList()
-    {
-        this.mc.displayGuiScreen(new GuiMultiplayer(this.parentScreen));
-    }
-
-    public void confirmClicked(boolean result, int id)
-    {
-        GuiListExtended.IGuiListEntry var3 = this.serverListSelector.func_148193_k() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.func_148193_k());
-
-        if (this.deletingServer)
-        {
-            this.deletingServer = false;
-
-            if (result && var3 instanceof ServerListEntryNormal)
-            {
-                this.savedServerList.removeServerData(this.serverListSelector.func_148193_k());
-                this.savedServerList.saveServerList();
-                this.serverListSelector.func_148192_c(-1);
-                this.serverListSelector.func_148195_a(this.savedServerList);
-            }
-
-            this.mc.displayGuiScreen(this);
-        }
-        else if (this.directConnect)
-        {
-            this.directConnect = false;
-
-            if (result)
-            {
-                this.connectToServer(this.selectedServer);
-            }
-            else
-            {
-                this.mc.displayGuiScreen(this);
-            }
-        }
-        else if (this.addingServer)
-        {
-            this.addingServer = false;
-
-            if (result)
-            {
-                this.savedServerList.addServerData(this.selectedServer);
-                this.savedServerList.saveServerList();
-                this.serverListSelector.func_148192_c(-1);
-                this.serverListSelector.func_148195_a(this.savedServerList);
-            }
-
-            this.mc.displayGuiScreen(this);
-        }
-        else if (this.editingServer)
-        {
-            this.editingServer = false;
-
-            if (result && var3 instanceof ServerListEntryNormal)
-            {
-                ServerData var4 = ((ServerListEntryNormal)var3).getServerData();
-                var4.serverName = this.selectedServer.serverName;
-                var4.serverIP = this.selectedServer.serverIP;
-                var4.copyFrom(this.selectedServer);
-                this.savedServerList.saveServerList();
-                this.serverListSelector.func_148195_a(this.savedServerList);
-            }
-
-            this.mc.displayGuiScreen(this);
-        }
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException
-    {
-        int var3 = this.serverListSelector.func_148193_k();
-        GuiListExtended.IGuiListEntry var4 = var3 < 0 ? null : this.serverListSelector.getListEntry(var3);
-
-        if (keyCode == 63)
-        {
-            this.refreshServerList();
-        }
-        else
-        {
-            if (var3 >= 0)
-            {
-                if (keyCode == 200)
-                {
-                    if (isShiftKeyDown())
-                    {
-                        if (var3 > 0 && var4 instanceof ServerListEntryNormal)
-                        {
-                            this.savedServerList.swapServers(var3, var3 - 1);
-                            this.selectServer(this.serverListSelector.func_148193_k() - 1);
-                            this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
-                            this.serverListSelector.func_148195_a(this.savedServerList);
-                        }
-                    }
-                    else if (var3 > 0)
-                    {
-                        this.selectServer(this.serverListSelector.func_148193_k() - 1);
-                        this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
-
-                        if (this.serverListSelector.getListEntry(this.serverListSelector.func_148193_k()) instanceof ServerListEntryLanScan)
-                        {
-                            if (this.serverListSelector.func_148193_k() > 0)
-                            {
-                                this.selectServer(this.serverListSelector.getSize() - 1);
-                                this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
-                            }
-                            else
-                            {
-                                this.selectServer(-1);
-                            }
-                        }
-                    }
-                    else
-                    {
-                        this.selectServer(-1);
-                    }
-                }
-                else if (keyCode == 208)
-                {
-                    if (isShiftKeyDown())
-                    {
-                        if (var3 < this.savedServerList.countServers() - 1)
-                        {
-                            this.savedServerList.swapServers(var3, var3 + 1);
-                            this.selectServer(var3 + 1);
-                            this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
-                            this.serverListSelector.func_148195_a(this.savedServerList);
-                        }
-                    }
-                    else if (var3 < this.serverListSelector.getSize())
-                    {
-                        this.selectServer(this.serverListSelector.func_148193_k() + 1);
-                        this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
-
-                        if (this.serverListSelector.getListEntry(this.serverListSelector.func_148193_k()) instanceof ServerListEntryLanScan)
-                        {
-                            if (this.serverListSelector.func_148193_k() < this.serverListSelector.getSize() - 1)
-                            {
-                                this.selectServer(this.serverListSelector.getSize() + 1);
-                                this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
-                            }
-                            else
-                            {
-                                this.selectServer(-1);
-                            }
-                        }
-                    }
-                    else
-                    {
-                        this.selectServer(-1);
-                    }
-                }
-                else if (keyCode != 28 && keyCode != 156)
-                {
-                    super.keyTyped(typedChar, keyCode);
-                }
-                else
-                {
-                    this.actionPerformed((GuiButton)this.buttonList.get(2));
-                }
-            }
-            else
-            {
-                super.keyTyped(typedChar, keyCode);
-            }
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.field_146812_y = null;
-        this.drawDefaultBackground();
-        this.serverListSelector.drawScreen(mouseX, mouseY, partialTicks);
-        this.drawCenteredString(this.fontRendererObj, I18n.format("multiplayer.title", new Object[0]), this.width / 2, 20, 16777215);
-        super.drawScreen(mouseX, mouseY, partialTicks);
-
-        if (this.field_146812_y != null)
-        {
-            this.drawHoveringText(Lists.newArrayList(Splitter.on("\n").split(this.field_146812_y)), mouseX, mouseY);
-        }
-    }
-
-    public void connectToSelected()
-    {
-        GuiListExtended.IGuiListEntry var1 = this.serverListSelector.func_148193_k() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.func_148193_k());
-
-        if (var1 instanceof ServerListEntryNormal)
-        {
-            this.connectToServer(((ServerListEntryNormal)var1).getServerData());
-        }
-        else if (var1 instanceof ServerListEntryLanDetected)
-        {
-            LanServerDetector.LanServer var2 = ((ServerListEntryLanDetected)var1).getLanServer();
-            this.connectToServer(new ServerData(var2.getServerMotd(), var2.getServerIpPort()));
-        }
-    }
-
-    private void connectToServer(ServerData server)
-    {
-        this.mc.displayGuiScreen(new GuiConnecting(this, this.mc, server));
-    }
-
-    public void selectServer(int index)
-    {
-        this.serverListSelector.func_148192_c(index);
-        GuiListExtended.IGuiListEntry var2 = index < 0 ? null : this.serverListSelector.getListEntry(index);
-        this.btnSelectServer.enabled = false;
-        this.btnEditServer.enabled = false;
-        this.btnDeleteServer.enabled = false;
-
-        if (var2 != null && !(var2 instanceof ServerListEntryLanScan))
-        {
-            this.btnSelectServer.enabled = true;
-
-            if (var2 instanceof ServerListEntryNormal)
-            {
-                this.btnEditServer.enabled = true;
-                this.btnDeleteServer.enabled = true;
-            }
-        }
-    }
-
-    public OldServerPinger getOldServerPinger()
-    {
-        return this.oldServerPinger;
-    }
-
-    public void func_146793_a(String p_146793_1_)
-    {
-        this.field_146812_y = p_146793_1_;
-    }
-
-    /**
-     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
-     */
-    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
-    {
-        super.mouseClicked(mouseX, mouseY, mouseButton);
-        this.serverListSelector.func_148179_a(mouseX, mouseY, mouseButton);
-    }
-
-    /**
-     * Called when a mouse button is released.  Args : mouseX, mouseY, releaseButton
-     */
-    protected void mouseReleased(int mouseX, int mouseY, int state)
-    {
-        super.mouseReleased(mouseX, mouseY, state);
-        this.serverListSelector.func_148181_b(mouseX, mouseY, state);
-    }
-
-    public ServerList getServerList()
-    {
-        return this.savedServerList;
-    }
-
-    public boolean func_175392_a(ServerListEntryNormal p_175392_1_, int p_175392_2_)
-    {
-        return p_175392_2_ > 0;
-    }
-
-    public boolean func_175394_b(ServerListEntryNormal p_175394_1_, int p_175394_2_)
-    {
-        return p_175394_2_ < this.savedServerList.countServers() - 1;
-    }
-
-    public void func_175391_a(ServerListEntryNormal p_175391_1_, int p_175391_2_, boolean p_175391_3_)
-    {
-        int var4 = p_175391_3_ ? 0 : p_175391_2_ - 1;
-        this.savedServerList.swapServers(p_175391_2_, var4);
-
-        if (this.serverListSelector.func_148193_k() == p_175391_2_)
-        {
-            this.selectServer(var4);
-        }
-
-        this.serverListSelector.func_148195_a(this.savedServerList);
-    }
-
-    public void func_175393_b(ServerListEntryNormal p_175393_1_, int p_175393_2_, boolean p_175393_3_)
-    {
-        int var4 = p_175393_3_ ? this.savedServerList.countServers() - 1 : p_175393_2_ + 1;
-        this.savedServerList.swapServers(p_175393_2_, var4);
-
-        if (this.serverListSelector.func_148193_k() == p_175393_2_)
-        {
-            this.selectServer(var4);
-        }
-
-        this.serverListSelector.func_148195_a(this.savedServerList);
-    }
-}
+package net.minecraft.client.gui;
+
+import java.awt.Component;
+import java.awt.HeadlessException;
+import java.io.BufferedReader;
+import java.io.File;
+import java.io.FileReader;
+import java.io.FileWriter;
+import java.io.IOException;
+import java.io.PrintWriter;
+import java.util.List;
+
+import javax.swing.JDialog;
+import javax.swing.JFileChooser;
+import javax.swing.filechooser.FileNameExtensionFilter;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.multiplayer.GuiConnecting;
+import net.minecraft.client.multiplayer.ServerData;
+import net.minecraft.client.multiplayer.ServerList;
+import net.minecraft.client.network.LanServerDetector;
+import net.minecraft.client.network.OldServerPinger;
+import net.minecraft.client.resources.I18n;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.input.Keyboard;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.servers.gui.GuiCleanUp;
+import tk.wurst_client.servers.gui.GuiServerFinder;
+import tk.wurst_client.spam.SpamProcessor;
+import tk.wurst_client.utils.MiscUtils;
+
+import com.google.common.base.Splitter;
+import com.google.common.collect.Lists;
+
+public class GuiMultiplayer extends GuiScreen implements GuiYesNoCallback
+{
+    private static final Logger logger = LogManager.getLogger();
+    private final OldServerPinger oldServerPinger = new OldServerPinger();
+    private GuiScreen parentScreen;
+    
+    //TODO: Client
+    public ServerSelectionList serverListSelector;
+    public ServerList savedServerList;
+    
+    private GuiButton btnEditServer;
+    private GuiButton btnSelectServer;
+    private GuiButton btnDeleteServer;
+    private boolean deletingServer;
+    private boolean addingServer;
+    private boolean editingServer;
+    private boolean directConnect;
+    private String field_146812_y;
+    private ServerData selectedServer;
+    private LanServerDetector.LanServerList lanServerList;
+    private LanServerDetector.ThreadLanServerFind lanServerDetector;
+    private boolean initialized;
+    private static final String __OBFID = "CL_00000814";
+
+    public GuiMultiplayer(GuiScreen parentScreen)
+    {
+        this.parentScreen = parentScreen;
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        Keyboard.enableRepeatEvents(true);
+        this.buttonList.clear();
+
+        if (!this.initialized)
+        {
+            this.initialized = true;
+            this.savedServerList = new ServerList(this.mc);
+            this.savedServerList.loadServerList();
+            this.lanServerList = new LanServerDetector.LanServerList();
+
+            try
+            {
+                this.lanServerDetector = new LanServerDetector.ThreadLanServerFind(this.lanServerList);
+                this.lanServerDetector.start();
+            }
+            catch (Exception var2)
+            {
+                logger.warn("Unable to start LAN server detection: " + var2.getMessage());
+            }
+
+            this.serverListSelector = new ServerSelectionList(this, this.mc, this.width, this.height, 32, this.height - 64, 36);
+            this.serverListSelector.func_148195_a(this.savedServerList);
+        }
+        else
+        {
+            this.serverListSelector.setDimensions(this.width, this.height, 32, this.height - 64);
+        }
+
+        this.createButtons();
+        WurstClient.INSTANCE.analytics.trackPageView("/multiplayer", "Select Server");
+    }
+
+    /**
+     * Handles mouse input.
+     */
+    public void handleMouseInput() throws IOException
+    {
+        super.handleMouseInput();
+        this.serverListSelector.func_178039_p();
+    }
+
+    public void createButtons()
+    {
+        this.buttonList.add(this.btnEditServer = new GuiButton(7, this.width / 2 - 154, this.height - 28, 70, 20, I18n.format("selectServer.edit", new Object[0])));
+        this.buttonList.add(this.btnDeleteServer = new GuiButton(2, this.width / 2 - 74, this.height - 28, 70, 20, I18n.format("selectServer.delete", new Object[0])));
+        this.buttonList.add(this.btnSelectServer = new GuiButton(1, this.width / 2 - 154, this.height - 52, 100, 20, I18n.format("selectServer.select", new Object[0])));
+        this.buttonList.add(new GuiButton(4, this.width / 2 - 50, this.height - 52, 100, 20, I18n.format("selectServer.direct", new Object[0])));
+        this.buttonList.add(new GuiButton(3, this.width / 2 + 4 + 50, this.height - 52, 100, 20, I18n.format("selectServer.add", new Object[0])));
+        this.buttonList.add(new GuiButton(8, this.width / 2 + 4, this.height - 28, 70, 20, I18n.format("selectServer.refresh", new Object[0])));
+        this.buttonList.add(new GuiButton(0, this.width / 2 + 4 + 76, this.height - 28, 75, 20, I18n.format("gui.cancel", new Object[0])));
+        //TODO: Client
+        this.buttonList.add(new GuiButton(5, this.width / 2 - 154, 10, 100, 20, "Last server"));
+        this.buttonList.add(new GuiButton(10, this.width / 2 - 154 - 104, this.height - 52, 100, 20, "Import Servers"));
+        this.buttonList.add(new GuiButton(11, this.width / 2 - 154 - 104, this.height - 28, 100, 20, "Export Servers"));
+        this.buttonList.add(new GuiButton(12, this.width / 2 + 154 + 4, this.height - 52, 100, 20, "Server Finder"));
+        this.buttonList.add(new GuiButton(13, this.width / 2 + 154 + 4, this.height - 28, 100, 20, "Clean Up"));
+        this.selectServer(this.serverListSelector.getSelectedServer());
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        super.updateScreen();
+
+        if (this.lanServerList.getWasUpdated())
+        {
+            List var1 = this.lanServerList.getLanServers();
+            this.lanServerList.setWasNotUpdated();
+            this.serverListSelector.func_148194_a(var1);
+        }
+
+        this.oldServerPinger.pingPendingNetworks();
+        //TODO: Client
+        ((GuiButton)this.buttonList.get(7)).enabled = WurstClient.INSTANCE.lastServer != null; //ID: 5
+    }
+
+    /**
+     * Called when the screen is unloaded. Used to disable keyboard repeat events
+     */
+    public void onGuiClosed()
+    {
+        Keyboard.enableRepeatEvents(false);
+
+        if (this.lanServerDetector != null)
+        {
+            this.lanServerDetector.interrupt();
+            this.lanServerDetector = null;
+        }
+
+        this.oldServerPinger.clearPendingNetworks();
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.enabled)
+        {
+            GuiListExtended.IGuiListEntry var2 = this.serverListSelector.getSelectedServer() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer());
+
+            if (button.id == 2 && var2 instanceof ServerListEntryNormal)
+            {
+                String var9 = ((ServerListEntryNormal)var2).getServerData().serverName;
+
+                if (var9 != null)
+                {
+                    this.deletingServer = true;
+                    String var4 = I18n.format("selectServer.deleteQuestion", new Object[0]);
+                    String var5 = "\'" + var9 + "\' " + I18n.format("selectServer.deleteWarning", new Object[0]);
+                    String var6 = I18n.format("selectServer.deleteButton", new Object[0]);
+                    String var7 = I18n.format("gui.cancel", new Object[0]);
+                    GuiYesNo var8 = new GuiYesNo(this, var4, var5, var6, var7, this.serverListSelector.getSelectedServer());
+                    this.mc.displayGuiScreen(var8);
+                }
+            }
+            else if (button.id == 1)
+            {
+                this.connectToSelected();
+            }
+            else if (button.id == 4)
+            {
+                this.directConnect = true;
+                this.mc.displayGuiScreen(new GuiScreenServerList(this, this.selectedServer = new ServerData(I18n.format("selectServer.defaultName", new Object[0]), "")));
+            }
+            else if (button.id == 3)
+            {
+                this.addingServer = true;
+                this.mc.displayGuiScreen(new GuiScreenAddServer(this, this.selectedServer = new ServerData(I18n.format("selectServer.defaultName", new Object[0]), "")));
+            }
+            else if (button.id == 7 && var2 instanceof ServerListEntryNormal)
+            {
+                this.editingServer = true;
+                ServerData var3 = ((ServerListEntryNormal)var2).getServerData();
+                this.selectedServer = new ServerData(var3.serverName, var3.serverIP);
+                this.selectedServer.copyFrom(var3);
+                this.mc.displayGuiScreen(new GuiScreenAddServer(this, this.selectedServer));
+            }
+            else if (button.id == 0)
+            {
+                this.mc.displayGuiScreen(this.parentScreen);
+            }
+            else if (button.id == 8)
+            {
+                this.refreshServerList();
+                //TODO: Client
+            }else if(button.id == 5)
+            {//Last Server
+            	if(WurstClient.INSTANCE.lastServer != null)
+                {
+            		WurstClient.INSTANCE.currentServerIP = WurstClient.INSTANCE.lastServer.getServerData().serverIP;
+                    if(!WurstClient.INSTANCE.currentServerIP.contains(":"))
+                    	WurstClient.INSTANCE.currentServerIP += ":25565";
+                    this.connectToServer(WurstClient.INSTANCE.lastServer.getServerData());
+                }
+            }else if(button.id == 10)
+            {//Import
+            	new Thread(new Runnable()
+            	{
+            		@Override
+            		public void run()
+            		{
+            			JFileChooser fileChooser = new JFileChooser(WurstClient.INSTANCE.fileManager.serverlistsDir)
+            			{
+            				protected JDialog createDialog(Component parent) throws HeadlessException
+            				{
+            					JDialog dialog = super.createDialog(parent);
+            					dialog.setAlwaysOnTop(true);
+            					return dialog;
+            				}
+            			};
+            			fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
+            			fileChooser.setAcceptAllFileFilterUsed(false);
+            			fileChooser.addChoosableFileFilter(new FileNameExtensionFilter("TXT files", "txt"));
+            			int action = fileChooser.showOpenDialog(Minecraft.getMinecraft().getFrame());
+            			if(action == JFileChooser.APPROVE_OPTION)
+            			{
+            				try
+							{
+								File file = fileChooser.getSelectedFile();
+								BufferedReader load = new BufferedReader(new FileReader(file));
+								int i = 0;
+								for(String line = ""; (line = load.readLine()) != null;)
+								{
+									i++;
+									GuiMultiplayer.this.savedServerList.addServerData(new ServerData("Grief me #" + i, line));
+									GuiMultiplayer.this.savedServerList.saveServerList();
+									GuiMultiplayer.this.serverListSelector.setSelectedServer(-1);
+									GuiMultiplayer.this.serverListSelector.func_148195_a(GuiMultiplayer.this.savedServerList);
+								}
+								load.close();
+								GuiMultiplayer.this.refreshServerList();
+							}catch(IOException e)
+							{
+								e.printStackTrace();
+								MiscUtils.simpleError(e, fileChooser);
+							}
+            			}
+            		}
+            	}).start();
+            }else if(button.id == 11)
+			{//Export
+				new Thread(new Runnable()
+				{
+					@Override
+					public void run()
+					{
+						JFileChooser fileChooser = new JFileChooser(WurstClient.INSTANCE.fileManager.serverlistsDir)
+						{
+							protected JDialog createDialog(Component parent) throws HeadlessException
+							{
+								JDialog dialog = super.createDialog(parent);
+								dialog.setAlwaysOnTop(true);
+								return dialog;
+							}
+						};
+						fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
+            			fileChooser.setAcceptAllFileFilterUsed(false);
+            			fileChooser.addChoosableFileFilter(new FileNameExtensionFilter("TXT files", "txt"));
+						int action = fileChooser.showSaveDialog(Minecraft.getMinecraft().getFrame());
+						if(action == JFileChooser.APPROVE_OPTION)
+						{
+							try
+							{
+								File file = fileChooser.getSelectedFile();
+								if(!file.getName().endsWith(".txt"))
+									file = new File(file.getPath() + ".txt");
+								PrintWriter save = new PrintWriter(new FileWriter(file));
+								for(int i = 0; i < GuiMultiplayer.this.savedServerList.countServers(); i++)
+									save.println(GuiMultiplayer.this.savedServerList.getServerData(i).serverIP);
+								save.close();
+							}catch(IOException e)
+							{
+								e.printStackTrace();
+								MiscUtils.simpleError(e, fileChooser);
+							}
+						}
+					}
+				}).start();
+            }else if(button.id == 12)
+            {//Server Finder
+            	this.mc.displayGuiScreen(new GuiServerFinder(this));
+            }else if(button.id == 13)
+            {//Clean Up
+            	this.mc.displayGuiScreen(new GuiCleanUp(this));
+            }
+        }
+    }
+
+    private void refreshServerList()
+    {
+        this.mc.displayGuiScreen(new GuiMultiplayer(this.parentScreen));
+    }
+
+    public void confirmClicked(boolean result, int id)
+    {
+        GuiListExtended.IGuiListEntry var3 = this.serverListSelector.getSelectedServer() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer());
+
+        if (this.deletingServer)
+        {
+            this.deletingServer = false;
+
+            if (result && var3 instanceof ServerListEntryNormal)
+            {
+                this.savedServerList.removeServerData(this.serverListSelector.getSelectedServer());
+                this.savedServerList.saveServerList();
+                this.serverListSelector.setSelectedServer(-1);
+                this.serverListSelector.func_148195_a(this.savedServerList);
+            }
+
+            this.mc.displayGuiScreen(this);
+        }
+        else if (this.directConnect)
+        {
+            this.directConnect = false;
+
+            if (result)
+            {
+                this.connectToServer(this.selectedServer);
+            }
+            else
+            {
+                this.mc.displayGuiScreen(this);
+            }
+        }
+        else if (this.addingServer)
+        {
+            this.addingServer = false;
+
+            if (result)
+            {
+                this.savedServerList.addServerData(this.selectedServer);
+                this.savedServerList.saveServerList();
+                this.serverListSelector.setSelectedServer(-1);
+                this.serverListSelector.func_148195_a(this.savedServerList);
+            }
+
+            this.mc.displayGuiScreen(this);
+        }
+        else if (this.editingServer)
+        {
+            this.editingServer = false;
+
+            if (result && var3 instanceof ServerListEntryNormal)
+            {
+                ServerData var4 = ((ServerListEntryNormal)var3).getServerData();
+                var4.serverName = this.selectedServer.serverName;
+                var4.serverIP = this.selectedServer.serverIP;
+                var4.copyFrom(this.selectedServer);
+                this.savedServerList.saveServerList();
+                this.serverListSelector.func_148195_a(this.savedServerList);
+            }
+
+            this.mc.displayGuiScreen(this);
+        }
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException
+    {
+        int var3 = this.serverListSelector.getSelectedServer();
+        GuiListExtended.IGuiListEntry var4 = var3 < 0 ? null : this.serverListSelector.getListEntry(var3);
+
+        if (keyCode == 63)
+        {
+            this.refreshServerList();
+        }
+        else
+        {
+            if (var3 >= 0)
+            {
+                if (keyCode == 200)
+                {
+                    if (isShiftKeyDown())
+                    {
+                        if (var3 > 0 && var4 instanceof ServerListEntryNormal)
+                        {
+                            this.savedServerList.swapServers(var3, var3 - 1);
+                            this.selectServer(this.serverListSelector.getSelectedServer() - 1);
+                            this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
+                            this.serverListSelector.func_148195_a(this.savedServerList);
+                        }
+                    }
+                    else if (var3 > 0)
+                    {
+                        this.selectServer(this.serverListSelector.getSelectedServer() - 1);
+                        this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
+
+                        if (this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer()) instanceof ServerListEntryLanScan)
+                        {
+                            if (this.serverListSelector.getSelectedServer() > 0)
+                            {
+                                this.selectServer(this.serverListSelector.getSize() - 1);
+                                this.serverListSelector.scrollBy(-this.serverListSelector.getSlotHeight());
+                            }
+                            else
+                            {
+                                this.selectServer(-1);
+                            }
+                        }
+                    }
+                    else
+                    {
+                        this.selectServer(-1);
+                    }
+                }
+                else if (keyCode == 208)
+                {
+                    if (isShiftKeyDown())
+                    {
+                        if (var3 < this.savedServerList.countServers() - 1)
+                        {
+                            this.savedServerList.swapServers(var3, var3 + 1);
+                            this.selectServer(var3 + 1);
+                            this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
+                            this.serverListSelector.func_148195_a(this.savedServerList);
+                        }
+                    }
+                    else if (var3 < this.serverListSelector.getSize())
+                    {
+                        this.selectServer(this.serverListSelector.getSelectedServer() + 1);
+                        this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
+
+                        if (this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer()) instanceof ServerListEntryLanScan)
+                        {
+                            if (this.serverListSelector.getSelectedServer() < this.serverListSelector.getSize() - 1)
+                            {
+                                this.selectServer(this.serverListSelector.getSize() + 1);
+                                this.serverListSelector.scrollBy(this.serverListSelector.getSlotHeight());
+                            }
+                            else
+                            {
+                                this.selectServer(-1);
+                            }
+                        }
+                    }
+                    else
+                    {
+                        this.selectServer(-1);
+                    }
+                }
+                else if (keyCode != 28 && keyCode != 156)
+                {
+                    super.keyTyped(typedChar, keyCode);
+                }
+                else
+                {
+                    this.actionPerformed((GuiButton)this.buttonList.get(2));
+                }
+            }
+            else
+            {
+                super.keyTyped(typedChar, keyCode);
+            }
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.field_146812_y = null;
+        this.drawDefaultBackground();
+        this.serverListSelector.drawScreen(mouseX, mouseY, partialTicks);
+        //TODO: Client
+        this.drawCenteredString(this.fontRendererObj, I18n.format("multiplayer.title", new Object[0]), this.width / 2, 16, 16777215);
+        super.drawScreen(mouseX, mouseY, partialTicks);
+
+        if (this.field_146812_y != null)
+        {
+            this.drawHoveringText(Lists.newArrayList(Splitter.on("\n").split(this.field_146812_y)), mouseX, mouseY);
+        }
+    }
+
+    public void connectToSelected()
+    {
+        GuiListExtended.IGuiListEntry var1 = this.serverListSelector.getSelectedServer() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer());
+
+        //TODO: Client
+        if(var1 instanceof ServerListEntryNormal)
+        {
+        	WurstClient.INSTANCE.currentServerIP = ((ServerListEntryNormal) var1).getServerData().serverIP;
+        	if(!WurstClient.INSTANCE.currentServerIP.contains(":"))
+        		WurstClient.INSTANCE.currentServerIP += ":25565";
+        	WurstClient.INSTANCE.lastServer = (ServerListEntryNormal) (this.serverListSelector.getSelectedServer() < 0 ? null : this.serverListSelector.getListEntry(this.serverListSelector.getSelectedServer()));
+        }else if(var1 instanceof ServerListEntryLanDetected)
+        {
+        	WurstClient.INSTANCE.currentServerIP = ((ServerListEntryLanDetected) var1).getLanServer().getServerIpPort();
+            WurstClient.INSTANCE.lastServer = new ServerListEntryNormal(this, new ServerData("LAN-Server", WurstClient.INSTANCE.currentServerIP));
+        }
+        if (var1 instanceof ServerListEntryNormal)
+        {
+            this.connectToServer(((ServerListEntryNormal)var1).getServerData());
+        }
+        else if (var1 instanceof ServerListEntryLanDetected)
+        {
+            LanServerDetector.LanServer var2 = ((ServerListEntryLanDetected)var1).getLanServer();
+            this.connectToServer(new ServerData(var2.getServerMotd(), var2.getServerIpPort()));
+        }
+    }
+
+    private void connectToServer(ServerData server)
+    {
+        this.mc.displayGuiScreen(new GuiConnecting(this, this.mc, server));
+        
+        //TODO: Client
+        SpamProcessor.runScript("joinserver", "Runs whenever you join a server.");
+		WurstClient.INSTANCE.analytics.trackPageView("/play/multiplayer", "Multiplayer");
+    }
+
+    public void selectServer(int index)
+    {
+        this.serverListSelector.setSelectedServer(index);
+        GuiListExtended.IGuiListEntry var2 = index < 0 ? null : this.serverListSelector.getListEntry(index);
+        this.btnSelectServer.enabled = false;
+        this.btnEditServer.enabled = false;
+        this.btnDeleteServer.enabled = false;
+
+        if (var2 != null && !(var2 instanceof ServerListEntryLanScan))
+        {
+            this.btnSelectServer.enabled = true;
+
+            if (var2 instanceof ServerListEntryNormal)
+            {
+                this.btnEditServer.enabled = true;
+                this.btnDeleteServer.enabled = true;
+            }
+        }
+    }
+
+    public OldServerPinger getOldServerPinger()
+    {
+        return this.oldServerPinger;
+    }
+
+    public void func_146793_a(String p_146793_1_)
+    {
+        this.field_146812_y = p_146793_1_;
+    }
+
+    /**
+     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
+     */
+    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
+    {
+        super.mouseClicked(mouseX, mouseY, mouseButton);
+        this.serverListSelector.func_148179_a(mouseX, mouseY, mouseButton);
+    }
+
+    /**
+     * Called when a mouse button is released.  Args : mouseX, mouseY, releaseButton
+     */
+    protected void mouseReleased(int mouseX, int mouseY, int state)
+    {
+        super.mouseReleased(mouseX, mouseY, state);
+        this.serverListSelector.func_148181_b(mouseX, mouseY, state);
+    }
+
+    public ServerList getServerList()
+    {
+        return this.savedServerList;
+    }
+
+    public boolean func_175392_a(ServerListEntryNormal p_175392_1_, int p_175392_2_)
+    {
+        return p_175392_2_ > 0;
+    }
+
+    public boolean func_175394_b(ServerListEntryNormal p_175394_1_, int p_175394_2_)
+    {
+        return p_175394_2_ < this.savedServerList.countServers() - 1;
+    }
+
+    public void func_175391_a(ServerListEntryNormal p_175391_1_, int p_175391_2_, boolean p_175391_3_)
+    {
+        int var4 = p_175391_3_ ? 0 : p_175391_2_ - 1;
+        this.savedServerList.swapServers(p_175391_2_, var4);
+
+        if (this.serverListSelector.getSelectedServer() == p_175391_2_)
+        {
+            this.selectServer(var4);
+        }
+
+        this.serverListSelector.func_148195_a(this.savedServerList);
+    }
+
+    public void func_175393_b(ServerListEntryNormal p_175393_1_, int p_175393_2_, boolean p_175393_3_)
+    {
+        int var4 = p_175393_3_ ? this.savedServerList.countServers() - 1 : p_175393_2_ + 1;
+        this.savedServerList.swapServers(p_175393_2_, var4);
+
+        if (this.serverListSelector.getSelectedServer() == p_175393_2_)
+        {
+            this.selectServer(var4);
+        }
+
+        this.serverListSelector.func_148195_a(this.savedServerList);
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiNewChat.java b/src/net/minecraft/client/gui/GuiNewChat.java
index 1614678..5332ac5 100644
--- a/src/net/minecraft/client/gui/GuiNewChat.java
+++ b/src/net/minecraft/client/gui/GuiNewChat.java
@@ -1,386 +1,399 @@
-package net.minecraft.client.gui;
-
-import com.google.common.collect.Lists;
-import java.util.Iterator;
-import java.util.List;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.MathHelper;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-
-public class GuiNewChat extends Gui
-{
-    private static final Logger logger = LogManager.getLogger();
-    private final Minecraft mc;
-
-    /** A list of messages previously sent through the chat GUI */
-    private final List sentMessages = Lists.newArrayList();
-
-    /** Chat lines to be displayed in the chat box */
-    private final List chatLines = Lists.newArrayList();
-    private final List field_146253_i = Lists.newArrayList();
-    private int scrollPos;
-    private boolean isScrolled;
-    private static final String __OBFID = "CL_00000669";
-
-    public GuiNewChat(Minecraft mcIn)
-    {
-        this.mc = mcIn;
-    }
-
-    public void drawChat(int p_146230_1_)
-    {
-        if (this.mc.gameSettings.chatVisibility != EntityPlayer.EnumChatVisibility.HIDDEN)
-        {
-            int var2 = this.getLineCount();
-            boolean var3 = false;
-            int var4 = 0;
-            int var5 = this.field_146253_i.size();
-            float var6 = this.mc.gameSettings.chatOpacity * 0.9F + 0.1F;
-
-            if (var5 > 0)
-            {
-                if (this.getChatOpen())
-                {
-                    var3 = true;
-                }
-
-                float var7 = this.getChatScale();
-                int var8 = MathHelper.ceiling_float_int((float)this.getChatWidth() / var7);
-                GlStateManager.pushMatrix();
-                GlStateManager.translate(2.0F, 20.0F, 0.0F);
-                GlStateManager.scale(var7, var7, 1.0F);
-                int var9;
-                int var11;
-                int var14;
-
-                for (var9 = 0; var9 + this.scrollPos < this.field_146253_i.size() && var9 < var2; ++var9)
-                {
-                    ChatLine var10 = (ChatLine)this.field_146253_i.get(var9 + this.scrollPos);
-
-                    if (var10 != null)
-                    {
-                        var11 = p_146230_1_ - var10.getUpdatedCounter();
-
-                        if (var11 < 200 || var3)
-                        {
-                            double var12 = (double)var11 / 200.0D;
-                            var12 = 1.0D - var12;
-                            var12 *= 10.0D;
-                            var12 = MathHelper.clamp_double(var12, 0.0D, 1.0D);
-                            var12 *= var12;
-                            var14 = (int)(255.0D * var12);
-
-                            if (var3)
-                            {
-                                var14 = 255;
-                            }
-
-                            var14 = (int)((float)var14 * var6);
-                            ++var4;
-
-                            if (var14 > 3)
-                            {
-                                byte var15 = 0;
-                                int var16 = -var9 * 9;
-                                drawRect(var15, var16 - 9, var15 + var8 + 4, var16, var14 / 2 << 24);
-                                String var17 = var10.getChatComponent().getFormattedText();
-                                GlStateManager.enableBlend();
-                                this.mc.fontRendererObj.func_175063_a(var17, (float)var15, (float)(var16 - 8), 16777215 + (var14 << 24));
-                                GlStateManager.disableAlpha();
-                                GlStateManager.disableBlend();
-                            }
-                        }
-                    }
-                }
-
-                if (var3)
-                {
-                    var9 = this.mc.fontRendererObj.FONT_HEIGHT;
-                    GlStateManager.translate(-3.0F, 0.0F, 0.0F);
-                    int var18 = var5 * var9 + var5;
-                    var11 = var4 * var9 + var4;
-                    int var19 = this.scrollPos * var11 / var5;
-                    int var13 = var11 * var11 / var18;
-
-                    if (var18 != var11)
-                    {
-                        var14 = var19 > 0 ? 170 : 96;
-                        int var20 = this.isScrolled ? 13382451 : 3355562;
-                        drawRect(0, -var19, 2, -var19 - var13, var20 + (var14 << 24));
-                        drawRect(2, -var19, 1, -var19 - var13, 13421772 + (var14 << 24));
-                    }
-                }
-
-                GlStateManager.popMatrix();
-            }
-        }
-    }
-
-    /**
-     * Clears the chat.
-     */
-    public void clearChatMessages()
-    {
-        this.field_146253_i.clear();
-        this.chatLines.clear();
-        this.sentMessages.clear();
-    }
-
-    public void printChatMessage(IChatComponent p_146227_1_)
-    {
-        this.printChatMessageWithOptionalDeletion(p_146227_1_, 0);
-    }
-
-    /**
-     * prints the ChatComponent to Chat. If the ID is not 0, deletes an existing Chat Line of that ID from the GUI
-     */
-    public void printChatMessageWithOptionalDeletion(IChatComponent p_146234_1_, int p_146234_2_)
-    {
-        this.setChatLine(p_146234_1_, p_146234_2_, this.mc.ingameGUI.getUpdateCounter(), false);
-        logger.info("[CHAT] " + p_146234_1_.getUnformattedText());
-    }
-
-    private void setChatLine(IChatComponent p_146237_1_, int p_146237_2_, int p_146237_3_, boolean p_146237_4_)
-    {
-        if (p_146237_2_ != 0)
-        {
-            this.deleteChatLine(p_146237_2_);
-        }
-
-        int var5 = MathHelper.floor_float((float)this.getChatWidth() / this.getChatScale());
-        List var6 = GuiUtilRenderComponents.func_178908_a(p_146237_1_, var5, this.mc.fontRendererObj, false, false);
-        boolean var7 = this.getChatOpen();
-        IChatComponent var9;
-
-        for (Iterator var8 = var6.iterator(); var8.hasNext(); this.field_146253_i.add(0, new ChatLine(p_146237_3_, var9, p_146237_2_)))
-        {
-            var9 = (IChatComponent)var8.next();
-
-            if (var7 && this.scrollPos > 0)
-            {
-                this.isScrolled = true;
-                this.scroll(1);
-            }
-        }
-
-        while (this.field_146253_i.size() > 100)
-        {
-            this.field_146253_i.remove(this.field_146253_i.size() - 1);
-        }
-
-        if (!p_146237_4_)
-        {
-            this.chatLines.add(0, new ChatLine(p_146237_3_, p_146237_1_, p_146237_2_));
-
-            while (this.chatLines.size() > 100)
-            {
-                this.chatLines.remove(this.chatLines.size() - 1);
-            }
-        }
-    }
-
-    public void refreshChat()
-    {
-        this.field_146253_i.clear();
-        this.resetScroll();
-
-        for (int var1 = this.chatLines.size() - 1; var1 >= 0; --var1)
-        {
-            ChatLine var2 = (ChatLine)this.chatLines.get(var1);
-            this.setChatLine(var2.getChatComponent(), var2.getChatLineID(), var2.getUpdatedCounter(), true);
-        }
-    }
-
-    /**
-     * Gets the list of messages previously sent through the chat GUI
-     */
-    public List getSentMessages()
-    {
-        return this.sentMessages;
-    }
-
-    /**
-     * Adds this string to the list of sent messages, for recall using the up/down arrow keys
-     */
-    public void addToSentMessages(String p_146239_1_)
-    {
-        if (this.sentMessages.isEmpty() || !((String)this.sentMessages.get(this.sentMessages.size() - 1)).equals(p_146239_1_))
-        {
-            this.sentMessages.add(p_146239_1_);
-        }
-    }
-
-    /**
-     * Resets the chat scroll (executed when the GUI is closed, among others)
-     */
-    public void resetScroll()
-    {
-        this.scrollPos = 0;
-        this.isScrolled = false;
-    }
-
-    /**
-     * Scrolls the chat by the given number of lines.
-     */
-    public void scroll(int p_146229_1_)
-    {
-        this.scrollPos += p_146229_1_;
-        int var2 = this.field_146253_i.size();
-
-        if (this.scrollPos > var2 - this.getLineCount())
-        {
-            this.scrollPos = var2 - this.getLineCount();
-        }
-
-        if (this.scrollPos <= 0)
-        {
-            this.scrollPos = 0;
-            this.isScrolled = false;
-        }
-    }
-
-    /**
-     * Gets the chat component under the mouse
-     */
-    public IChatComponent getChatComponent(int p_146236_1_, int p_146236_2_)
-    {
-        if (!this.getChatOpen())
-        {
-            return null;
-        }
-        else
-        {
-            ScaledResolution var3 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
-            int var4 = var3.getScaleFactor();
-            float var5 = this.getChatScale();
-            int var6 = p_146236_1_ / var4 - 3;
-            int var7 = p_146236_2_ / var4 - 27;
-            var6 = MathHelper.floor_float((float)var6 / var5);
-            var7 = MathHelper.floor_float((float)var7 / var5);
-
-            if (var6 >= 0 && var7 >= 0)
-            {
-                int var8 = Math.min(this.getLineCount(), this.field_146253_i.size());
-
-                if (var6 <= MathHelper.floor_float((float)this.getChatWidth() / this.getChatScale()) && var7 < this.mc.fontRendererObj.FONT_HEIGHT * var8 + var8)
-                {
-                    int var9 = var7 / this.mc.fontRendererObj.FONT_HEIGHT + this.scrollPos;
-
-                    if (var9 >= 0 && var9 < this.field_146253_i.size())
-                    {
-                        ChatLine var10 = (ChatLine)this.field_146253_i.get(var9);
-                        int var11 = 0;
-                        Iterator var12 = var10.getChatComponent().iterator();
-
-                        while (var12.hasNext())
-                        {
-                            IChatComponent var13 = (IChatComponent)var12.next();
-
-                            if (var13 instanceof ChatComponentText)
-                            {
-                                var11 += this.mc.fontRendererObj.getStringWidth(GuiUtilRenderComponents.func_178909_a(((ChatComponentText)var13).getChatComponentText_TextValue(), false));
-
-                                if (var11 > var6)
-                                {
-                                    return var13;
-                                }
-                            }
-                        }
-                    }
-
-                    return null;
-                }
-                else
-                {
-                    return null;
-                }
-            }
-            else
-            {
-                return null;
-            }
-        }
-    }
-
-    /**
-     * Returns true if the chat GUI is open
-     */
-    public boolean getChatOpen()
-    {
-        return this.mc.currentScreen instanceof GuiChat;
-    }
-
-    /**
-     * finds and deletes a Chat line by ID
-     */
-    public void deleteChatLine(int p_146242_1_)
-    {
-        Iterator var2 = this.field_146253_i.iterator();
-        ChatLine var3;
-
-        while (var2.hasNext())
-        {
-            var3 = (ChatLine)var2.next();
-
-            if (var3.getChatLineID() == p_146242_1_)
-            {
-                var2.remove();
-            }
-        }
-
-        var2 = this.chatLines.iterator();
-
-        while (var2.hasNext())
-        {
-            var3 = (ChatLine)var2.next();
-
-            if (var3.getChatLineID() == p_146242_1_)
-            {
-                var2.remove();
-                break;
-            }
-        }
-    }
-
-    public int getChatWidth()
-    {
-        return calculateChatboxWidth(this.mc.gameSettings.chatWidth);
-    }
-
-    public int getChatHeight()
-    {
-        return calculateChatboxHeight(this.getChatOpen() ? this.mc.gameSettings.chatHeightFocused : this.mc.gameSettings.chatHeightUnfocused);
-    }
-
-    /**
-     * Returns the chatscale from mc.gameSettings.chatScale
-     */
-    public float getChatScale()
-    {
-        return this.mc.gameSettings.chatScale;
-    }
-
-    public static int calculateChatboxWidth(float p_146233_0_)
-    {
-        short var1 = 320;
-        byte var2 = 40;
-        return MathHelper.floor_float(p_146233_0_ * (float)(var1 - var2) + (float)var2);
-    }
-
-    public static int calculateChatboxHeight(float p_146243_0_)
-    {
-        short var1 = 180;
-        byte var2 = 20;
-        return MathHelper.floor_float(p_146243_0_ * (float)(var1 - var2) + (float)var2);
-    }
-
-    public int getLineCount()
-    {
-        return this.getChatHeight() / 9;
-    }
-}
+package net.minecraft.client.gui;
+
+import java.util.Iterator;
+import java.util.List;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.util.ChatComponentText;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.MathHelper;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.ChatInputEvent;
+
+import com.google.common.collect.Lists;
+
+public class GuiNewChat extends Gui
+{
+    private static final Logger logger = LogManager.getLogger();
+    private final Minecraft mc;
+
+    /** A list of messages previously sent through the chat GUI */
+    private final List sentMessages = Lists.newArrayList();
+
+    /** Chat lines to be displayed in the chat box */
+    private final List chatLines = Lists.newArrayList();
+    private final List field_146253_i = Lists.newArrayList();
+    private int scrollPos;
+    private boolean isScrolled;
+    private static final String __OBFID = "CL_00000669";
+
+    public GuiNewChat(Minecraft mcIn)
+    {
+        this.mc = mcIn;
+    }
+
+    public void drawChat(int p_146230_1_)
+    {
+        if (this.mc.gameSettings.chatVisibility != EntityPlayer.EnumChatVisibility.HIDDEN)
+        {
+            int var2 = this.getLineCount();
+            boolean var3 = false;
+            int var4 = 0;
+            int var5 = this.field_146253_i.size();
+            float var6 = this.mc.gameSettings.chatOpacity * 0.9F + 0.1F;
+
+            if (var5 > 0)
+            {
+                if (this.getChatOpen())
+                {
+                    var3 = true;
+                }
+
+                float var7 = this.getChatScale();
+                int var8 = MathHelper.ceiling_float_int((float)this.getChatWidth() / var7);
+                GlStateManager.pushMatrix();
+                GlStateManager.translate(2.0F, 20.0F, 0.0F);
+                GlStateManager.scale(var7, var7, 1.0F);
+                int var9;
+                int var11;
+                int var14;
+
+                for (var9 = 0; var9 + this.scrollPos < this.field_146253_i.size() && var9 < var2; ++var9)
+                {
+                    ChatLine var10 = (ChatLine)this.field_146253_i.get(var9 + this.scrollPos);
+
+                    if (var10 != null)
+                    {
+                        var11 = p_146230_1_ - var10.getUpdatedCounter();
+
+                        if (var11 < 200 || var3)
+                        {
+                            double var12 = (double)var11 / 200.0D;
+                            var12 = 1.0D - var12;
+                            var12 *= 10.0D;
+                            var12 = MathHelper.clamp_double(var12, 0.0D, 1.0D);
+                            var12 *= var12;
+                            var14 = (int)(255.0D * var12);
+
+                            if (var3)
+                            {
+                                var14 = 255;
+                            }
+
+                            var14 = (int)((float)var14 * var6);
+                            ++var4;
+
+                            if (var14 > 3)
+                            {
+                                byte var15 = 0;
+                                int var16 = -var9 * 9;
+                                drawRect(var15, var16 - 9, var15 + var8 + 4, var16, var14 / 2 << 24);
+                                String var17 = var10.getChatComponent().getFormattedText();
+                                GlStateManager.enableBlend();
+                                this.mc.fontRendererObj.drawStringWithShadow(var17, (float)var15, (float)(var16 - 8), 16777215 + (var14 << 24));
+                                GlStateManager.disableAlpha();
+                                GlStateManager.disableBlend();
+                            }
+                        }
+                    }
+                }
+
+                if (var3)
+                {
+                    var9 = this.mc.fontRendererObj.FONT_HEIGHT;
+                    GlStateManager.translate(-3.0F, 0.0F, 0.0F);
+                    int var18 = var5 * var9 + var5;
+                    var11 = var4 * var9 + var4;
+                    int var19 = this.scrollPos * var11 / var5;
+                    int var13 = var11 * var11 / var18;
+
+                    if (var18 != var11)
+                    {
+                        var14 = var19 > 0 ? 170 : 96;
+                        int var20 = this.isScrolled ? 13382451 : 3355562;
+                        drawRect(0, -var19, 2, -var19 - var13, var20 + (var14 << 24));
+                        drawRect(2, -var19, 1, -var19 - var13, 13421772 + (var14 << 24));
+                    }
+                }
+
+                GlStateManager.popMatrix();
+            }
+        }
+    }
+
+    /**
+     * Clears the chat.
+     */
+    public void clearChatMessages()
+    {
+        this.field_146253_i.clear();
+        this.chatLines.clear();
+        this.sentMessages.clear();
+    }
+
+    public void printChatMessage(IChatComponent p_146227_1_)
+    {
+        this.printChatMessageWithOptionalDeletion(p_146227_1_, 0);
+    }
+
+    /**
+     * prints the ChatComponent to Chat. If the ID is not 0, deletes an existing Chat Line of that ID from the GUI
+     */
+    public void printChatMessageWithOptionalDeletion(IChatComponent p_146234_1_, int p_146234_2_)
+    {
+    	//TODO: Client
+    	ChatInputEvent event = new ChatInputEvent(p_146234_1_, field_146253_i);
+    	WurstClient.INSTANCE.eventManager.fireEvent(ChatInputEvent.class, event);
+    	if(event.isCancelled())
+    		return;
+    	p_146234_1_ = event.getComponent();
+    	
+        this.setChatLine(p_146234_1_, p_146234_2_, this.mc.ingameGUI.getUpdateCounter(), false);
+        logger.info("[CHAT] " + p_146234_1_.getUnformattedText());
+    }
+
+    private void setChatLine(IChatComponent p_146237_1_, int p_146237_2_, int p_146237_3_, boolean p_146237_4_)
+    {
+        if (p_146237_2_ != 0)
+        {
+            this.deleteChatLine(p_146237_2_);
+        }
+
+        int var5 = MathHelper.floor_float((float)this.getChatWidth() / this.getChatScale());
+        List var6 = GuiUtilRenderComponents.func_178908_a(p_146237_1_, var5, this.mc.fontRendererObj, false, false);
+        boolean var7 = this.getChatOpen();
+        IChatComponent var9;
+
+        for (Iterator var8 = var6.iterator(); var8.hasNext(); this.field_146253_i.add(0, new ChatLine(p_146237_3_, var9, p_146237_2_)))
+        {
+            var9 = (IChatComponent)var8.next();
+
+            if (var7 && this.scrollPos > 0)
+            {
+                this.isScrolled = true;
+                this.scroll(1);
+            }
+        }
+
+        while (this.field_146253_i.size() > 100)
+        {
+            this.field_146253_i.remove(this.field_146253_i.size() - 1);
+        }
+
+        if (!p_146237_4_)
+        {
+            this.chatLines.add(0, new ChatLine(p_146237_3_, p_146237_1_, p_146237_2_));
+
+            while (this.chatLines.size() > 100)
+            {
+                this.chatLines.remove(this.chatLines.size() - 1);
+            }
+        }
+    }
+
+    public void refreshChat()
+    {
+        this.field_146253_i.clear();
+        this.resetScroll();
+
+        for (int var1 = this.chatLines.size() - 1; var1 >= 0; --var1)
+        {
+            ChatLine var2 = (ChatLine)this.chatLines.get(var1);
+            this.setChatLine(var2.getChatComponent(), var2.getChatLineID(), var2.getUpdatedCounter(), true);
+        }
+    }
+
+    /**
+     * Gets the list of messages previously sent through the chat GUI
+     */
+    public List getSentMessages()
+    {
+        return this.sentMessages;
+    }
+
+    /**
+     * Adds this string to the list of sent messages, for recall using the up/down arrow keys
+     */
+    public void addToSentMessages(String p_146239_1_)
+    {
+        if (this.sentMessages.isEmpty() || !((String)this.sentMessages.get(this.sentMessages.size() - 1)).equals(p_146239_1_))
+        {
+            this.sentMessages.add(p_146239_1_);
+        }
+    }
+
+    /**
+     * Resets the chat scroll (executed when the GUI is closed, among others)
+     */
+    public void resetScroll()
+    {
+        this.scrollPos = 0;
+        this.isScrolled = false;
+    }
+
+    /**
+     * Scrolls the chat by the given number of lines.
+     */
+    public void scroll(int p_146229_1_)
+    {
+        this.scrollPos += p_146229_1_;
+        int var2 = this.field_146253_i.size();
+
+        if (this.scrollPos > var2 - this.getLineCount())
+        {
+            this.scrollPos = var2 - this.getLineCount();
+        }
+
+        if (this.scrollPos <= 0)
+        {
+            this.scrollPos = 0;
+            this.isScrolled = false;
+        }
+    }
+
+    /**
+     * Gets the chat component under the mouse
+     */
+    public IChatComponent getChatComponent(int p_146236_1_, int p_146236_2_)
+    {
+        if (!this.getChatOpen())
+        {
+            return null;
+        }
+        else
+        {
+            ScaledResolution var3 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
+            int var4 = var3.getScaleFactor();
+            float var5 = this.getChatScale();
+            int var6 = p_146236_1_ / var4 - 3;
+            int var7 = p_146236_2_ / var4 - 27;
+            var6 = MathHelper.floor_float((float)var6 / var5);
+            var7 = MathHelper.floor_float((float)var7 / var5);
+
+            if (var6 >= 0 && var7 >= 0)
+            {
+                int var8 = Math.min(this.getLineCount(), this.field_146253_i.size());
+
+                if (var6 <= MathHelper.floor_float((float)this.getChatWidth() / this.getChatScale()) && var7 < this.mc.fontRendererObj.FONT_HEIGHT * var8 + var8)
+                {
+                    int var9 = var7 / this.mc.fontRendererObj.FONT_HEIGHT + this.scrollPos;
+
+                    if (var9 >= 0 && var9 < this.field_146253_i.size())
+                    {
+                        ChatLine var10 = (ChatLine)this.field_146253_i.get(var9);
+                        int var11 = 0;
+                        Iterator var12 = var10.getChatComponent().iterator();
+
+                        while (var12.hasNext())
+                        {
+                            IChatComponent var13 = (IChatComponent)var12.next();
+
+                            if (var13 instanceof ChatComponentText)
+                            {
+                                var11 += this.mc.fontRendererObj.getStringWidth(GuiUtilRenderComponents.func_178909_a(((ChatComponentText)var13).getChatComponentText_TextValue(), false));
+
+                                if (var11 > var6)
+                                {
+                                    return var13;
+                                }
+                            }
+                        }
+                    }
+
+                    return null;
+                }
+                else
+                {
+                    return null;
+                }
+            }
+            else
+            {
+                return null;
+            }
+        }
+    }
+
+    /**
+     * Returns true if the chat GUI is open
+     */
+    public boolean getChatOpen()
+    {
+        return this.mc.currentScreen instanceof GuiChat;
+    }
+
+    /**
+     * finds and deletes a Chat line by ID
+     */
+    public void deleteChatLine(int p_146242_1_)
+    {
+        Iterator var2 = this.field_146253_i.iterator();
+        ChatLine var3;
+
+        while (var2.hasNext())
+        {
+            var3 = (ChatLine)var2.next();
+
+            if (var3.getChatLineID() == p_146242_1_)
+            {
+                var2.remove();
+            }
+        }
+
+        var2 = this.chatLines.iterator();
+
+        while (var2.hasNext())
+        {
+            var3 = (ChatLine)var2.next();
+
+            if (var3.getChatLineID() == p_146242_1_)
+            {
+                var2.remove();
+                break;
+            }
+        }
+    }
+
+    public int getChatWidth()
+    {
+        return calculateChatboxWidth(this.mc.gameSettings.chatWidth);
+    }
+
+    public int getChatHeight()
+    {
+        return calculateChatboxHeight(this.getChatOpen() ? this.mc.gameSettings.chatHeightFocused : this.mc.gameSettings.chatHeightUnfocused);
+    }
+
+    /**
+     * Returns the chatscale from mc.gameSettings.chatScale
+     */
+    public float getChatScale()
+    {
+        return this.mc.gameSettings.chatScale;
+    }
+
+    public static int calculateChatboxWidth(float p_146233_0_)
+    {
+        short var1 = 320;
+        byte var2 = 40;
+        return MathHelper.floor_float(p_146233_0_ * (float)(var1 - var2) + (float)var2);
+    }
+
+    public static int calculateChatboxHeight(float p_146243_0_)
+    {
+        short var1 = 180;
+        byte var2 = 20;
+        return MathHelper.floor_float(p_146243_0_ * (float)(var1 - var2) + (float)var2);
+    }
+
+    public int getLineCount()
+    {
+        return this.getChatHeight() / 9;
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiOptionButton.java b/src/net/minecraft/client/gui/GuiOptionButton.java
index 833c342..91e7357 100644
--- a/src/net/minecraft/client/gui/GuiOptionButton.java
+++ b/src/net/minecraft/client/gui/GuiOptionButton.java
@@ -1,5 +1,6 @@
 package net.minecraft.client.gui;
 
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.settings.GameSettings;
 
 public class GuiOptionButton extends GuiButton
diff --git a/src/net/minecraft/client/gui/GuiOptionSlider.java b/src/net/minecraft/client/gui/GuiOptionSlider.java
index 423c7b2..0a8a076 100644
--- a/src/net/minecraft/client/gui/GuiOptionSlider.java
+++ b/src/net/minecraft/client/gui/GuiOptionSlider.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.settings.GameSettings;
 import net.minecraft.util.MathHelper;
diff --git a/src/net/minecraft/client/gui/GuiOptions.java b/src/net/minecraft/client/gui/GuiOptions.java
index 2696569..c712d1e 100644
--- a/src/net/minecraft/client/gui/GuiOptions.java
+++ b/src/net/minecraft/client/gui/GuiOptions.java
@@ -1,10 +1,12 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
 import net.minecraft.client.audio.PositionedSoundRecord;
 import net.minecraft.client.audio.SoundCategory;
 import net.minecraft.client.audio.SoundEventAccessorComposite;
 import net.minecraft.client.audio.SoundHandler;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.stream.GuiStreamOptions;
 import net.minecraft.client.gui.stream.GuiStreamUnavailable;
 import net.minecraft.client.resources.I18n;
diff --git a/src/net/minecraft/client/gui/GuiOptionsRowList.java b/src/net/minecraft/client/gui/GuiOptionsRowList.java
index 812b099..f8fb11a 100644
--- a/src/net/minecraft/client/gui/GuiOptionsRowList.java
+++ b/src/net/minecraft/client/gui/GuiOptionsRowList.java
@@ -1,8 +1,11 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.util.List;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.settings.GameSettings;
 
 public class GuiOptionsRowList extends GuiListExtended
diff --git a/src/net/minecraft/client/gui/GuiOverlayDebug.java b/src/net/minecraft/client/gui/GuiOverlayDebug.java
index 273ee40..bccdceb 100644
--- a/src/net/minecraft/client/gui/GuiOverlayDebug.java
+++ b/src/net/minecraft/client/gui/GuiOverlayDebug.java
@@ -152,9 +152,9 @@ public class GuiOverlayDebug extends Gui
                 var5.add("Shader: " + this.mc.entityRenderer.getShaderGroup().getShaderGroupName());
             }
 
-            if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.mc.objectMouseOver.func_178782_a() != null)
+            if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.mc.objectMouseOver.getBlockPos() != null)
             {
-                BlockPos var9 = this.mc.objectMouseOver.func_178782_a();
+                BlockPos var9 = this.mc.objectMouseOver.getBlockPos();
                 var5.add(String.format("Looking at: %d %d %d", new Object[] {Integer.valueOf(var9.getX()), Integer.valueOf(var9.getY()), Integer.valueOf(var9.getZ())}));
             }
 
@@ -176,9 +176,9 @@ public class GuiOverlayDebug extends Gui
         }
         else
         {
-            if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.mc.objectMouseOver.func_178782_a() != null)
+            if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.mc.objectMouseOver.getBlockPos() != null)
             {
-                BlockPos var10 = this.mc.objectMouseOver.func_178782_a();
+                BlockPos var10 = this.mc.objectMouseOver.getBlockPos();
                 IBlockState var11 = this.mc.theWorld.getBlockState(var10);
 
                 if (this.mc.theWorld.getWorldType() != WorldType.DEBUG_WORLD)
diff --git a/src/net/minecraft/client/gui/GuiPageButtonList.java b/src/net/minecraft/client/gui/GuiPageButtonList.java
index 7f0ae74..4d9c413 100644
--- a/src/net/minecraft/client/gui/GuiPageButtonList.java
+++ b/src/net/minecraft/client/gui/GuiPageButtonList.java
@@ -4,8 +4,11 @@ import com.google.common.base.Objects;
 import com.google.common.base.Predicate;
 import com.google.common.base.Predicates;
 import com.google.common.collect.Lists;
+
 import java.util.List;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.util.IntHashMap;
 
 public class GuiPageButtonList extends GuiListExtended
diff --git a/src/net/minecraft/client/gui/GuiPlayerTabOverlay.java b/src/net/minecraft/client/gui/GuiPlayerTabOverlay.java
index d09e06f..70e33f6 100644
--- a/src/net/minecraft/client/gui/GuiPlayerTabOverlay.java
+++ b/src/net/minecraft/client/gui/GuiPlayerTabOverlay.java
@@ -37,9 +37,9 @@ public class GuiPlayerTabOverlay extends Gui
         this.field_175251_g = p_i45529_2_;
     }
 
-    public String func_175243_a(NetworkPlayerInfo p_175243_1_)
+    public String func_175243_a(NetworkPlayerInfo networkPlayerInfo)
     {
-        return p_175243_1_.func_178854_k() != null ? p_175243_1_.func_178854_k().getFormattedText() : ScorePlayerTeam.formatPlayerName(p_175243_1_.func_178850_i(), p_175243_1_.func_178845_a().getName());
+        return networkPlayerInfo.getPlayerName() != null ? networkPlayerInfo.getPlayerName().getFormattedText() : ScorePlayerTeam.formatPlayerName(networkPlayerInfo.getScoreTeam(), networkPlayerInfo.getGameProfile().getName());
     }
 
     public void func_175246_a(boolean p_175246_1_)
@@ -55,7 +55,7 @@ public class GuiPlayerTabOverlay extends Gui
     public void func_175249_a(int p_175249_1_, Scoreboard p_175249_2_, ScoreObjective p_175249_3_)
     {
         NetHandlerPlayClient var4 = this.field_175250_f.thePlayer.sendQueue;
-        List var5 = field_175252_a.sortedCopy(var4.func_175106_d());
+        List var5 = field_175252_a.sortedCopy(var4.getPlayerInfo());
         int var6 = 0;
         int var7 = 0;
         Iterator var8 = var5.iterator();
@@ -69,7 +69,7 @@ public class GuiPlayerTabOverlay extends Gui
 
             if (p_175249_3_ != null && p_175249_3_.func_178766_e() != IScoreObjectiveCriteria.EnumRenderType.HEARTS)
             {
-                var10 = this.field_175250_f.fontRendererObj.getStringWidth(" " + p_175249_2_.getValueFromObjective(var9.func_178845_a().getName(), p_175249_3_).getScorePoints());
+                var10 = this.field_175250_f.fontRendererObj.getStringWidth(" " + p_175249_2_.getValueFromObjective(var9.getGameProfile().getName(), p_175249_3_).getScorePoints());
                 var7 = Math.max(var7, var10);
             }
         }
@@ -83,7 +83,7 @@ public class GuiPlayerTabOverlay extends Gui
             ++var10;
         }
 
-        boolean var11 = this.field_175250_f.isIntegratedServerRunning() || this.field_175250_f.getNetHandler().getNetworkManager().func_179292_f();
+        boolean var11 = this.field_175250_f.isIntegratedServerRunning() || this.field_175250_f.getNetHandler().getNetworkManager().isEncrypted();
         int var12;
 
         if (p_175249_3_ != null)
@@ -141,7 +141,7 @@ public class GuiPlayerTabOverlay extends Gui
             {
                 var20 = (String)var19.next();
                 var21 = this.field_175250_f.fontRendererObj.getStringWidth(var20);
-                this.field_175250_f.fontRendererObj.func_175063_a(var20, (float)(p_175249_1_ / 2 - var21 / 2), (float)var15, -1);
+                this.field_175250_f.fontRendererObj.drawStringWithShadow(var20, (float)(p_175249_1_ / 2 - var21 / 2), (float)var15, -1);
             }
 
             ++var15;
@@ -170,7 +170,7 @@ public class GuiPlayerTabOverlay extends Gui
                 {
                     this.field_175250_f.getTextureManager().bindTexture(var24.func_178837_g());
                     Gui.drawScaledCustomSizeModalRect(var22, var23, 8.0F, 8.0F, 8, 8, 8, 8, 64.0F, 64.0F);
-                    EntityPlayer var26 = this.field_175250_f.theWorld.getPlayerEntityByUUID(var24.func_178845_a().getId());
+                    EntityPlayer var26 = this.field_175250_f.theWorld.getPlayerEntityByUUID(var24.getGameProfile().getId());
 
                     if (var26 != null && var26.func_175148_a(EnumPlayerModelParts.HAT))
                     {
@@ -183,11 +183,11 @@ public class GuiPlayerTabOverlay extends Gui
                 if (var24.getGameType() == WorldSettings.GameType.SPECTATOR)
                 {
                     var25 = EnumChatFormatting.ITALIC + var25;
-                    this.field_175250_f.fontRendererObj.func_175063_a(var25, (float)var22, (float)var23, -1862270977);
+                    this.field_175250_f.fontRendererObj.drawStringWithShadow(var25, (float)var22, (float)var23, -1862270977);
                 }
                 else
                 {
-                    this.field_175250_f.fontRendererObj.func_175063_a(var25, (float)var22, (float)var23, -1);
+                    this.field_175250_f.fontRendererObj.drawStringWithShadow(var25, (float)var22, (float)var23, -1);
                 }
 
                 if (p_175249_3_ != null && var24.getGameType() != WorldSettings.GameType.SPECTATOR)
@@ -197,7 +197,7 @@ public class GuiPlayerTabOverlay extends Gui
 
                     if (var27 - var32 > 5)
                     {
-                        this.func_175247_a(p_175249_3_, var23, var24.func_178845_a().getName(), var32, var27, var24);
+                        this.func_175247_a(p_175249_3_, var23, var24.getGameProfile().getName(), var32, var27, var24);
                     }
                 }
 
@@ -214,7 +214,7 @@ public class GuiPlayerTabOverlay extends Gui
             {
                 var20 = (String)var19.next();
                 var21 = this.field_175250_f.fontRendererObj.getStringWidth(var20);
-                this.field_175250_f.fontRendererObj.func_175063_a(var20, (float)(p_175249_1_ / 2 - var21 / 2), (float)var15, -1);
+                this.field_175250_f.fontRendererObj.drawStringWithShadow(var20, (float)(p_175249_1_ / 2 - var21 / 2), (float)var15, -1);
             }
         }
     }
@@ -344,14 +344,14 @@ public class GuiPlayerTabOverlay extends Gui
                         var14 = var14 + "hp";
                     }
 
-                    this.field_175250_f.fontRendererObj.func_175063_a(var14, (float)((p_175247_5_ + p_175247_4_) / 2 - this.field_175250_f.fontRendererObj.getStringWidth(var14) / 2), (float)p_175247_2_, var13);
+                    this.field_175250_f.fontRendererObj.drawStringWithShadow(var14, (float)((p_175247_5_ + p_175247_4_) / 2 - this.field_175250_f.fontRendererObj.getStringWidth(var14) / 2), (float)p_175247_2_, var13);
                 }
             }
         }
         else
         {
             String var15 = EnumChatFormatting.YELLOW + "" + var7;
-            this.field_175250_f.fontRendererObj.func_175063_a(var15, (float)(p_175247_5_ - this.field_175250_f.fontRendererObj.getStringWidth(var15)), (float)p_175247_2_, 16777215);
+            this.field_175250_f.fontRendererObj.drawStringWithShadow(var15, (float)(p_175247_5_ - this.field_175250_f.fontRendererObj.getStringWidth(var15)), (float)p_175247_2_, 16777215);
         }
     }
 
@@ -373,9 +373,9 @@ public class GuiPlayerTabOverlay extends Gui
 
         public int func_178952_a(NetworkPlayerInfo p_178952_1_, NetworkPlayerInfo p_178952_2_)
         {
-            ScorePlayerTeam var3 = p_178952_1_.func_178850_i();
-            ScorePlayerTeam var4 = p_178952_2_.func_178850_i();
-            return ComparisonChain.start().compareTrueFirst(p_178952_1_.getGameType() != WorldSettings.GameType.SPECTATOR, p_178952_2_.getGameType() != WorldSettings.GameType.SPECTATOR).compare(var3 != null ? var3.getRegisteredName() : "", var4 != null ? var4.getRegisteredName() : "").compare(p_178952_1_.func_178845_a().getName(), p_178952_2_.func_178845_a().getName()).result();
+            ScorePlayerTeam var3 = p_178952_1_.getScoreTeam();
+            ScorePlayerTeam var4 = p_178952_2_.getScoreTeam();
+            return ComparisonChain.start().compareTrueFirst(p_178952_1_.getGameType() != WorldSettings.GameType.SPECTATOR, p_178952_2_.getGameType() != WorldSettings.GameType.SPECTATOR).compare(var3 != null ? var3.getRegisteredName() : "", var4 != null ? var4.getRegisteredName() : "").compare(p_178952_1_.getGameProfile().getName(), p_178952_2_.getGameProfile().getName()).result();
         }
 
         public int compare(Object p_compare_1_, Object p_compare_2_)
diff --git a/src/net/minecraft/client/gui/GuiRenameWorld.java b/src/net/minecraft/client/gui/GuiRenameWorld.java
index 977a564..f762a5d 100644
--- a/src/net/minecraft/client/gui/GuiRenameWorld.java
+++ b/src/net/minecraft/client/gui/GuiRenameWorld.java
@@ -1,9 +1,12 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.world.storage.ISaveFormat;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.lwjgl.input.Keyboard;
 
 public class GuiRenameWorld extends GuiScreen
diff --git a/src/net/minecraft/client/gui/GuiScreen.java b/src/net/minecraft/client/gui/GuiScreen.java
index 1aa3ab1..99da842 100644
--- a/src/net/minecraft/client/gui/GuiScreen.java
+++ b/src/net/minecraft/client/gui/GuiScreen.java
@@ -3,6 +3,7 @@ package net.minecraft.client.gui;
 import com.google.common.base.Splitter;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Sets;
+
 import java.awt.Toolkit;
 import java.awt.datatransfer.ClipboardOwner;
 import java.awt.datatransfer.DataFlavor;
@@ -17,7 +18,9 @@ import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
+
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.stream.GuiTwitchUserMode;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.RenderHelper;
@@ -37,11 +40,13 @@ import net.minecraft.stats.StatList;
 import net.minecraft.util.ChatComponentTranslation;
 import net.minecraft.util.EnumChatFormatting;
 import net.minecraft.util.IChatComponent;
+
 import org.apache.commons.lang3.StringUtils;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.lwjgl.input.Keyboard;
 import org.lwjgl.input.Mouse;
+
 import tv.twitch.chat.ChatUserInfo;
 
 public abstract class GuiScreen extends Gui implements GuiYesNoCallback
@@ -51,7 +56,8 @@ public abstract class GuiScreen extends Gui implements GuiYesNoCallback
     private static final Splitter field_175285_g = Splitter.on('\n');
 
     /** Reference to the Minecraft object. */
-    protected Minecraft mc;
+    //TODO: Client
+    public static Minecraft mc;
 
     /**
      * Holds a instance of RenderItem, used to draw the achievement icons on screen (is based on ItemStack)
@@ -250,7 +256,7 @@ public abstract class GuiScreen extends Gui implements GuiYesNoCallback
             for (int var12 = 0; var12 < textLines.size(); ++var12)
             {
                 String var13 = (String)textLines.get(var12);
-                this.fontRendererObj.func_175063_a(var13, (float)var14, (float)var15, -1);
+                this.fontRendererObj.drawStringWithShadow(var13, (float)var14, (float)var15, -1);
 
                 if (var12 == 0)
                 {
@@ -657,7 +663,7 @@ public abstract class GuiScreen extends Gui implements GuiYesNoCallback
         GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
         float var4 = 32.0F;
         var3.startDrawingQuads();
-        var3.func_178991_c(4210752);
+        var3.setColorOpaque_I(4210752);
         var3.addVertexWithUV(0.0D, (double)this.height, 0.0D, 0.0D, (double)((float)this.height / var4 + (float)tint));
         var3.addVertexWithUV((double)this.width, (double)this.height, 0.0D, (double)((float)this.width / var4), (double)((float)this.height / var4 + (float)tint));
         var3.addVertexWithUV((double)this.width, 0.0D, 0.0D, (double)((float)this.width / var4), (double)tint);
diff --git a/src/net/minecraft/client/gui/GuiScreenAddServer.java b/src/net/minecraft/client/gui/GuiScreenAddServer.java
index 098969d..05f4d73 100644
--- a/src/net/minecraft/client/gui/GuiScreenAddServer.java
+++ b/src/net/minecraft/client/gui/GuiScreenAddServer.java
@@ -1,8 +1,11 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.multiplayer.ServerData;
 import net.minecraft.client.resources.I18n;
+
 import org.lwjgl.input.Keyboard;
 
 public class GuiScreenAddServer extends GuiScreen
diff --git a/src/net/minecraft/client/gui/GuiScreenBook.java b/src/net/minecraft/client/gui/GuiScreenBook.java
index 914a882..49add9e 100644
--- a/src/net/minecraft/client/gui/GuiScreenBook.java
+++ b/src/net/minecraft/client/gui/GuiScreenBook.java
@@ -1,676 +1,751 @@
-package net.minecraft.client.gui;
-
-import com.google.common.collect.Lists;
-import com.google.gson.JsonParseException;
-import io.netty.buffer.Unpooled;
-import java.io.IOException;
-import java.util.Iterator;
-import java.util.List;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.event.ClickEvent;
-import net.minecraft.init.Items;
-import net.minecraft.item.ItemEditableBook;
-import net.minecraft.item.ItemStack;
-import net.minecraft.nbt.NBTTagCompound;
-import net.minecraft.nbt.NBTTagList;
-import net.minecraft.nbt.NBTTagString;
-import net.minecraft.network.PacketBuffer;
-import net.minecraft.network.play.client.C17PacketCustomPayload;
-import net.minecraft.util.ChatAllowedCharacters;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.EnumChatFormatting;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.ResourceLocation;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.input.Keyboard;
-
-public class GuiScreenBook extends GuiScreen
-{
-    private static final Logger logger = LogManager.getLogger();
-    private static final ResourceLocation bookGuiTextures = new ResourceLocation("textures/gui/book.png");
-
-    /** The player editing the book */
-    private final EntityPlayer editingPlayer;
-    private final ItemStack bookObj;
-
-    /** Whether the book is signed or can still be edited */
-    private final boolean bookIsUnsigned;
-
-    /**
-     * Whether the book's title or contents has been modified since being opened
-     */
-    private boolean bookIsModified;
-
-    /** Determines if the signing screen is open */
-    private boolean bookGettingSigned;
-
-    /** Update ticks since the gui was opened */
-    private int updateCount;
-    private int bookImageWidth = 192;
-    private int bookImageHeight = 192;
-    private int bookTotalPages = 1;
-    private int currPage;
-    private NBTTagList bookPages;
-    private String bookTitle = "";
-    private List field_175386_A;
-    private int field_175387_B = -1;
-    private GuiScreenBook.NextPageButton buttonNextPage;
-    private GuiScreenBook.NextPageButton buttonPreviousPage;
-    private GuiButton buttonDone;
-
-    /** The GuiButton to sign this book. */
-    private GuiButton buttonSign;
-    private GuiButton buttonFinalize;
-    private GuiButton buttonCancel;
-    private static final String __OBFID = "CL_00000744";
-
-    public GuiScreenBook(EntityPlayer p_i1080_1_, ItemStack p_i1080_2_, boolean p_i1080_3_)
-    {
-        this.editingPlayer = p_i1080_1_;
-        this.bookObj = p_i1080_2_;
-        this.bookIsUnsigned = p_i1080_3_;
-
-        if (p_i1080_2_.hasTagCompound())
-        {
-            NBTTagCompound var4 = p_i1080_2_.getTagCompound();
-            this.bookPages = var4.getTagList("pages", 8);
-
-            if (this.bookPages != null)
-            {
-                this.bookPages = (NBTTagList)this.bookPages.copy();
-                this.bookTotalPages = this.bookPages.tagCount();
-
-                if (this.bookTotalPages < 1)
-                {
-                    this.bookTotalPages = 1;
-                }
-            }
-        }
-
-        if (this.bookPages == null && p_i1080_3_)
-        {
-            this.bookPages = new NBTTagList();
-            this.bookPages.appendTag(new NBTTagString(""));
-            this.bookTotalPages = 1;
-        }
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        super.updateScreen();
-        ++this.updateCount;
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.buttonList.clear();
-        Keyboard.enableRepeatEvents(true);
-
-        if (this.bookIsUnsigned)
-        {
-            this.buttonList.add(this.buttonSign = new GuiButton(3, this.width / 2 - 100, 4 + this.bookImageHeight, 98, 20, I18n.format("book.signButton", new Object[0])));
-            this.buttonList.add(this.buttonDone = new GuiButton(0, this.width / 2 + 2, 4 + this.bookImageHeight, 98, 20, I18n.format("gui.done", new Object[0])));
-            this.buttonList.add(this.buttonFinalize = new GuiButton(5, this.width / 2 - 100, 4 + this.bookImageHeight, 98, 20, I18n.format("book.finalizeButton", new Object[0])));
-            this.buttonList.add(this.buttonCancel = new GuiButton(4, this.width / 2 + 2, 4 + this.bookImageHeight, 98, 20, I18n.format("gui.cancel", new Object[0])));
-        }
-        else
-        {
-            this.buttonList.add(this.buttonDone = new GuiButton(0, this.width / 2 - 100, 4 + this.bookImageHeight, 200, 20, I18n.format("gui.done", new Object[0])));
-        }
-
-        int var1 = (this.width - this.bookImageWidth) / 2;
-        byte var2 = 2;
-        this.buttonList.add(this.buttonNextPage = new GuiScreenBook.NextPageButton(1, var1 + 120, var2 + 154, true));
-        this.buttonList.add(this.buttonPreviousPage = new GuiScreenBook.NextPageButton(2, var1 + 38, var2 + 154, false));
-        this.updateButtons();
-    }
-
-    /**
-     * Called when the screen is unloaded. Used to disable keyboard repeat events
-     */
-    public void onGuiClosed()
-    {
-        Keyboard.enableRepeatEvents(false);
-    }
-
-    private void updateButtons()
-    {
-        this.buttonNextPage.visible = !this.bookGettingSigned && (this.currPage < this.bookTotalPages - 1 || this.bookIsUnsigned);
-        this.buttonPreviousPage.visible = !this.bookGettingSigned && this.currPage > 0;
-        this.buttonDone.visible = !this.bookIsUnsigned || !this.bookGettingSigned;
-
-        if (this.bookIsUnsigned)
-        {
-            this.buttonSign.visible = !this.bookGettingSigned;
-            this.buttonCancel.visible = this.bookGettingSigned;
-            this.buttonFinalize.visible = this.bookGettingSigned;
-            this.buttonFinalize.enabled = this.bookTitle.trim().length() > 0;
-        }
-    }
-
-    private void sendBookToServer(boolean p_146462_1_) throws IOException
-    {
-        if (this.bookIsUnsigned && this.bookIsModified)
-        {
-            if (this.bookPages != null)
-            {
-                String var2;
-
-                while (this.bookPages.tagCount() > 1)
-                {
-                    var2 = this.bookPages.getStringTagAt(this.bookPages.tagCount() - 1);
-
-                    if (var2.length() != 0)
-                    {
-                        break;
-                    }
-
-                    this.bookPages.removeTag(this.bookPages.tagCount() - 1);
-                }
-
-                if (this.bookObj.hasTagCompound())
-                {
-                    NBTTagCompound var6 = this.bookObj.getTagCompound();
-                    var6.setTag("pages", this.bookPages);
-                }
-                else
-                {
-                    this.bookObj.setTagInfo("pages", this.bookPages);
-                }
-
-                var2 = "MC|BEdit";
-
-                if (p_146462_1_)
-                {
-                    var2 = "MC|BSign";
-                    this.bookObj.setTagInfo("author", new NBTTagString(this.editingPlayer.getName()));
-                    this.bookObj.setTagInfo("title", new NBTTagString(this.bookTitle.trim()));
-
-                    for (int var3 = 0; var3 < this.bookPages.tagCount(); ++var3)
-                    {
-                        String var4 = this.bookPages.getStringTagAt(var3);
-                        ChatComponentText var5 = new ChatComponentText(var4);
-                        var4 = IChatComponent.Serializer.componentToJson(var5);
-                        this.bookPages.set(var3, new NBTTagString(var4));
-                    }
-
-                    this.bookObj.setItem(Items.written_book);
-                }
-
-                PacketBuffer var7 = new PacketBuffer(Unpooled.buffer());
-                var7.writeItemStackToBuffer(this.bookObj);
-                this.mc.getNetHandler().addToSendQueue(new C17PacketCustomPayload(var2, var7));
-            }
-        }
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.enabled)
-        {
-            if (button.id == 0)
-            {
-                this.mc.displayGuiScreen((GuiScreen)null);
-                this.sendBookToServer(false);
-            }
-            else if (button.id == 3 && this.bookIsUnsigned)
-            {
-                this.bookGettingSigned = true;
-            }
-            else if (button.id == 1)
-            {
-                if (this.currPage < this.bookTotalPages - 1)
-                {
-                    ++this.currPage;
-                }
-                else if (this.bookIsUnsigned)
-                {
-                    this.addNewPage();
-
-                    if (this.currPage < this.bookTotalPages - 1)
-                    {
-                        ++this.currPage;
-                    }
-                }
-            }
-            else if (button.id == 2)
-            {
-                if (this.currPage > 0)
-                {
-                    --this.currPage;
-                }
-            }
-            else if (button.id == 5 && this.bookGettingSigned)
-            {
-                this.sendBookToServer(true);
-                this.mc.displayGuiScreen((GuiScreen)null);
-            }
-            else if (button.id == 4 && this.bookGettingSigned)
-            {
-                this.bookGettingSigned = false;
-            }
-
-            this.updateButtons();
-        }
-    }
-
-    private void addNewPage()
-    {
-        if (this.bookPages != null && this.bookPages.tagCount() < 50)
-        {
-            this.bookPages.appendTag(new NBTTagString(""));
-            ++this.bookTotalPages;
-            this.bookIsModified = true;
-        }
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException
-    {
-        super.keyTyped(typedChar, keyCode);
-
-        if (this.bookIsUnsigned)
-        {
-            if (this.bookGettingSigned)
-            {
-                this.keyTypedInTitle(typedChar, keyCode);
-            }
-            else
-            {
-                this.keyTypedInBook(typedChar, keyCode);
-            }
-        }
-    }
-
-    /**
-     * Processes keystrokes when editing the text of a book
-     */
-    private void keyTypedInBook(char p_146463_1_, int p_146463_2_)
-    {
-        if (GuiScreen.func_175279_e(p_146463_2_))
-        {
-            this.pageInsertIntoCurrent(GuiScreen.getClipboardString());
-        }
-        else
-        {
-            switch (p_146463_2_)
-            {
-                case 14:
-                    String var3 = this.pageGetCurrent();
-
-                    if (var3.length() > 0)
-                    {
-                        this.pageSetCurrent(var3.substring(0, var3.length() - 1));
-                    }
-
-                    return;
-
-                case 28:
-                case 156:
-                    this.pageInsertIntoCurrent("\n");
-                    return;
-
-                default:
-                    if (ChatAllowedCharacters.isAllowedCharacter(p_146463_1_))
-                    {
-                        this.pageInsertIntoCurrent(Character.toString(p_146463_1_));
-                    }
-            }
-        }
-    }
-
-    /**
-     * Processes keystrokes when editing the title of a book
-     */
-    private void keyTypedInTitle(char p_146460_1_, int p_146460_2_) throws IOException
-    {
-        switch (p_146460_2_)
-        {
-            case 14:
-                if (!this.bookTitle.isEmpty())
-                {
-                    this.bookTitle = this.bookTitle.substring(0, this.bookTitle.length() - 1);
-                    this.updateButtons();
-                }
-
-                return;
-
-            case 28:
-            case 156:
-                if (!this.bookTitle.isEmpty())
-                {
-                    this.sendBookToServer(true);
-                    this.mc.displayGuiScreen((GuiScreen)null);
-                }
-
-                return;
-
-            default:
-                if (this.bookTitle.length() < 16 && ChatAllowedCharacters.isAllowedCharacter(p_146460_1_))
-                {
-                    this.bookTitle = this.bookTitle + Character.toString(p_146460_1_);
-                    this.updateButtons();
-                    this.bookIsModified = true;
-                }
-        }
-    }
-
-    /**
-     * Returns the entire text of the current page as determined by currPage
-     */
-    private String pageGetCurrent()
-    {
-        return this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount() ? this.bookPages.getStringTagAt(this.currPage) : "";
-    }
-
-    /**
-     * Sets the text of the current page as determined by currPage
-     */
-    private void pageSetCurrent(String p_146457_1_)
-    {
-        if (this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount())
-        {
-            this.bookPages.set(this.currPage, new NBTTagString(p_146457_1_));
-            this.bookIsModified = true;
-        }
-    }
-
-    /**
-     * Processes any text getting inserted into the current page, enforcing the page size limit
-     */
-    private void pageInsertIntoCurrent(String p_146459_1_)
-    {
-        String var2 = this.pageGetCurrent();
-        String var3 = var2 + p_146459_1_;
-        int var4 = this.fontRendererObj.splitStringWidth(var3 + "" + EnumChatFormatting.BLACK + "_", 118);
-
-        if (var4 <= 128 && var3.length() < 256)
-        {
-            this.pageSetCurrent(var3);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        this.mc.getTextureManager().bindTexture(bookGuiTextures);
-        int var4 = (this.width - this.bookImageWidth) / 2;
-        byte var5 = 2;
-        this.drawTexturedModalRect(var4, var5, 0, 0, this.bookImageWidth, this.bookImageHeight);
-        String var6;
-        String var7;
-        int var8;
-        int var9;
-
-        if (this.bookGettingSigned)
-        {
-            var6 = this.bookTitle;
-
-            if (this.bookIsUnsigned)
-            {
-                if (this.updateCount / 6 % 2 == 0)
-                {
-                    var6 = var6 + "" + EnumChatFormatting.BLACK + "_";
-                }
-                else
-                {
-                    var6 = var6 + "" + EnumChatFormatting.GRAY + "_";
-                }
-            }
-
-            var7 = I18n.format("book.editTitle", new Object[0]);
-            var8 = this.fontRendererObj.getStringWidth(var7);
-            this.fontRendererObj.drawString(var7, var4 + 36 + (116 - var8) / 2, var5 + 16 + 16, 0);
-            var9 = this.fontRendererObj.getStringWidth(var6);
-            this.fontRendererObj.drawString(var6, var4 + 36 + (116 - var9) / 2, var5 + 48, 0);
-            String var10 = I18n.format("book.byAuthor", new Object[] {this.editingPlayer.getName()});
-            int var11 = this.fontRendererObj.getStringWidth(var10);
-            this.fontRendererObj.drawString(EnumChatFormatting.DARK_GRAY + var10, var4 + 36 + (116 - var11) / 2, var5 + 48 + 10, 0);
-            String var12 = I18n.format("book.finalizeWarning", new Object[0]);
-            this.fontRendererObj.drawSplitString(var12, var4 + 36, var5 + 80, 116, 0);
-        }
-        else
-        {
-            var6 = I18n.format("book.pageIndicator", new Object[] {Integer.valueOf(this.currPage + 1), Integer.valueOf(this.bookTotalPages)});
-            var7 = "";
-
-            if (this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount())
-            {
-                var7 = this.bookPages.getStringTagAt(this.currPage);
-            }
-
-            if (this.bookIsUnsigned)
-            {
-                if (this.fontRendererObj.getBidiFlag())
-                {
-                    var7 = var7 + "_";
-                }
-                else if (this.updateCount / 6 % 2 == 0)
-                {
-                    var7 = var7 + "" + EnumChatFormatting.BLACK + "_";
-                }
-                else
-                {
-                    var7 = var7 + "" + EnumChatFormatting.GRAY + "_";
-                }
-            }
-            else if (this.field_175387_B != this.currPage)
-            {
-                if (ItemEditableBook.validBookTagContents(this.bookObj.getTagCompound()))
-                {
-                    try
-                    {
-                        IChatComponent var14 = IChatComponent.Serializer.jsonToComponent(var7);
-                        this.field_175386_A = var14 != null ? GuiUtilRenderComponents.func_178908_a(var14, 116, this.fontRendererObj, true, true) : null;
-                    }
-                    catch (JsonParseException var13)
-                    {
-                        this.field_175386_A = null;
-                    }
-                }
-                else
-                {
-                    ChatComponentText var15 = new ChatComponentText(EnumChatFormatting.DARK_RED.toString() + "* Invalid book tag *");
-                    this.field_175386_A = Lists.newArrayList(var15);
-                }
-
-                this.field_175387_B = this.currPage;
-            }
-
-            var8 = this.fontRendererObj.getStringWidth(var6);
-            this.fontRendererObj.drawString(var6, var4 - var8 + this.bookImageWidth - 44, var5 + 16, 0);
-
-            if (this.field_175386_A == null)
-            {
-                this.fontRendererObj.drawSplitString(var7, var4 + 36, var5 + 16 + 16, 116, 0);
-            }
-            else
-            {
-                var9 = Math.min(128 / this.fontRendererObj.FONT_HEIGHT, this.field_175386_A.size());
-
-                for (int var16 = 0; var16 < var9; ++var16)
-                {
-                    IChatComponent var18 = (IChatComponent)this.field_175386_A.get(var16);
-                    this.fontRendererObj.drawString(var18.getUnformattedText(), var4 + 36, var5 + 16 + 16 + var16 * this.fontRendererObj.FONT_HEIGHT, 0);
-                }
-
-                IChatComponent var17 = this.func_175385_b(mouseX, mouseY);
-
-                if (var17 != null)
-                {
-                    this.func_175272_a(var17, mouseX, mouseY);
-                }
-            }
-        }
-
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-
-    /**
-     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
-     */
-    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
-    {
-        if (mouseButton == 0)
-        {
-            IChatComponent var4 = this.func_175385_b(mouseX, mouseY);
-
-            if (this.func_175276_a(var4))
-            {
-                return;
-            }
-        }
-
-        super.mouseClicked(mouseX, mouseY, mouseButton);
-    }
-
-    protected boolean func_175276_a(IChatComponent p_175276_1_)
-    {
-        ClickEvent var2 = p_175276_1_ == null ? null : p_175276_1_.getChatStyle().getChatClickEvent();
-
-        if (var2 == null)
-        {
-            return false;
-        }
-        else if (var2.getAction() == ClickEvent.Action.CHANGE_PAGE)
-        {
-            String var6 = var2.getValue();
-
-            try
-            {
-                int var4 = Integer.parseInt(var6) - 1;
-
-                if (var4 >= 0 && var4 < this.bookTotalPages && var4 != this.currPage)
-                {
-                    this.currPage = var4;
-                    this.updateButtons();
-                    return true;
-                }
-            }
-            catch (Throwable var5)
-            {
-                ;
-            }
-
-            return false;
-        }
-        else
-        {
-            boolean var3 = super.func_175276_a(p_175276_1_);
-
-            if (var3 && var2.getAction() == ClickEvent.Action.RUN_COMMAND)
-            {
-                this.mc.displayGuiScreen((GuiScreen)null);
-            }
-
-            return var3;
-        }
-    }
-
-    public IChatComponent func_175385_b(int p_175385_1_, int p_175385_2_)
-    {
-        if (this.field_175386_A == null)
-        {
-            return null;
-        }
-        else
-        {
-            int var3 = p_175385_1_ - (this.width - this.bookImageWidth) / 2 - 36;
-            int var4 = p_175385_2_ - 2 - 16 - 16;
-
-            if (var3 >= 0 && var4 >= 0)
-            {
-                int var5 = Math.min(128 / this.fontRendererObj.FONT_HEIGHT, this.field_175386_A.size());
-
-                if (var3 <= 116 && var4 < this.mc.fontRendererObj.FONT_HEIGHT * var5 + var5)
-                {
-                    int var6 = var4 / this.mc.fontRendererObj.FONT_HEIGHT;
-
-                    if (var6 >= 0 && var6 < this.field_175386_A.size())
-                    {
-                        IChatComponent var7 = (IChatComponent)this.field_175386_A.get(var6);
-                        int var8 = 0;
-                        Iterator var9 = var7.iterator();
-
-                        while (var9.hasNext())
-                        {
-                            IChatComponent var10 = (IChatComponent)var9.next();
-
-                            if (var10 instanceof ChatComponentText)
-                            {
-                                var8 += this.mc.fontRendererObj.getStringWidth(((ChatComponentText)var10).getChatComponentText_TextValue());
-
-                                if (var8 > var3)
-                                {
-                                    return var10;
-                                }
-                            }
-                        }
-                    }
-
-                    return null;
-                }
-                else
-                {
-                    return null;
-                }
-            }
-            else
-            {
-                return null;
-            }
-        }
-    }
-
-    static class NextPageButton extends GuiButton
-    {
-        private final boolean field_146151_o;
-        private static final String __OBFID = "CL_00000745";
-
-        public NextPageButton(int p_i46316_1_, int p_i46316_2_, int p_i46316_3_, boolean p_i46316_4_)
-        {
-            super(p_i46316_1_, p_i46316_2_, p_i46316_3_, 23, 13, "");
-            this.field_146151_o = p_i46316_4_;
-        }
-
-        public void drawButton(Minecraft mc, int mouseX, int mouseY)
-        {
-            if (this.visible)
-            {
-                boolean var4 = mouseX >= this.xPosition && mouseY >= this.yPosition && mouseX < this.xPosition + this.width && mouseY < this.yPosition + this.height;
-                GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-                mc.getTextureManager().bindTexture(GuiScreenBook.bookGuiTextures);
-                int var5 = 0;
-                int var6 = 192;
-
-                if (var4)
-                {
-                    var5 += 23;
-                }
-
-                if (!this.field_146151_o)
-                {
-                    var6 += 13;
-                }
-
-                this.drawTexturedModalRect(this.xPosition, this.yPosition, var5, var6, 23, 13);
-            }
-        }
-    }
-}
+package net.minecraft.client.gui;
+
+import com.google.common.collect.Lists;
+import com.google.gson.JsonParseException;
+
+import io.netty.buffer.Unpooled;
+
+import java.io.IOException;
+import java.util.Iterator;
+import java.util.List;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.event.ClickEvent;
+import net.minecraft.init.Items;
+import net.minecraft.item.ItemEditableBook;
+import net.minecraft.item.ItemStack;
+import net.minecraft.nbt.JsonToNBT;
+import net.minecraft.nbt.NBTBase;
+import net.minecraft.nbt.NBTException;
+import net.minecraft.nbt.NBTTagCompound;
+import net.minecraft.nbt.NBTTagList;
+import net.minecraft.nbt.NBTTagString;
+import net.minecraft.network.PacketBuffer;
+import net.minecraft.network.play.client.C17PacketCustomPayload;
+import net.minecraft.util.ChatAllowedCharacters;
+import net.minecraft.util.ChatComponentText;
+import net.minecraft.util.ChatStyle;
+import net.minecraft.util.EnumChatFormatting;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.ResourceLocation;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.input.Keyboard;
+
+import tk.wurst_client.bookhack.gui.GuiBookHack;
+import tk.wurst_client.events.EventManager;
+
+public class GuiScreenBook extends GuiScreen
+{
+    private static final Logger logger = LogManager.getLogger();
+    private static final ResourceLocation bookGuiTextures = new ResourceLocation("textures/gui/book.png");
+
+    /** The player editing the book */
+    private final EntityPlayer editingPlayer;
+    private final ItemStack bookObj;
+
+    /** Whether the book is signed or can still be edited */
+    private final boolean bookIsUnsigned;
+
+    /**
+     * Whether the book's title or contents has been modified since being opened
+     */
+    private boolean bookIsModified;
+
+    /** Determines if the signing screen is open */
+    private boolean bookGettingSigned;
+
+    /** Update ticks since the gui was opened */
+    private int updateCount;
+    private int bookImageWidth = 192;
+    private int bookImageHeight = 192;
+    private int bookTotalPages = 1;
+    private int currPage;
+    private NBTTagList bookPages;
+    private String bookTitle = "";
+    private List field_175386_A;
+    private int field_175387_B = -1;
+    private GuiScreenBook.NextPageButton buttonNextPage;
+    private GuiScreenBook.NextPageButton buttonPreviousPage;
+    private GuiButton buttonDone;
+
+    /** The GuiButton to sign this book. */
+    private GuiButton buttonSign;
+    private GuiButton buttonFinalize;
+    private GuiButton buttonCancel;
+    private static final String __OBFID = "CL_00000744";
+    
+    //TODO: Client
+    private boolean hasCommand;
+    private String command;
+
+    public GuiScreenBook(EntityPlayer p_i1080_1_, ItemStack p_i1080_2_, boolean p_i1080_3_)
+    {
+        this.editingPlayer = p_i1080_1_;
+        this.bookObj = p_i1080_2_;
+        this.bookIsUnsigned = p_i1080_3_;
+
+        if (p_i1080_2_.hasTagCompound())
+        {
+            NBTTagCompound var4 = p_i1080_2_.getTagCompound();
+            this.bookPages = var4.getTagList("pages", 8);
+
+            if (this.bookPages != null)
+            {
+                this.bookPages = (NBTTagList)this.bookPages.copy();
+                this.bookTotalPages = this.bookPages.tagCount();
+
+                if (this.bookTotalPages < 1)
+                {
+                    this.bookTotalPages = 1;
+                }
+            }
+        }
+
+        if (this.bookPages == null && p_i1080_3_)
+        {
+            this.bookPages = new NBTTagList();
+            this.bookPages.appendTag(new NBTTagString(""));
+            this.bookTotalPages = 1;
+        }
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        super.updateScreen();
+        ++this.updateCount;
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.buttonList.clear();
+        Keyboard.enableRepeatEvents(true);
+
+        if (this.bookIsUnsigned)
+        {
+            this.buttonList.add(this.buttonSign = new GuiButton(3, this.width / 2 - 100, 4 + this.bookImageHeight, 98, 20, I18n.format("book.signButton", new Object[0])));
+            this.buttonList.add(this.buttonDone = new GuiButton(0, this.width / 2 + 2, 4 + this.bookImageHeight, 98, 20, I18n.format("gui.done", new Object[0])));
+            this.buttonList.add(this.buttonFinalize = new GuiButton(5, this.width / 2 - 100, 4 + this.bookImageHeight, 98, 20, I18n.format("book.finalizeButton", new Object[0])));
+            this.buttonList.add(this.buttonCancel = new GuiButton(4, this.width / 2 + 2, 4 + this.bookImageHeight, 98, 20, I18n.format("gui.cancel", new Object[0])));
+            
+            //TODO: Client
+            this.buttonList.add(new GuiButton(6, (width + bookImageWidth) / 2, bookImageHeight / 2, 100, 20, "Command Link"));
+            
+        }
+        else
+        {
+            this.buttonList.add(this.buttonDone = new GuiButton(0, this.width / 2 - 100, 4 + this.bookImageHeight, 200, 20, I18n.format("gui.done", new Object[0])));
+        }
+
+        int var1 = (this.width - this.bookImageWidth) / 2;
+        byte var2 = 2;
+        this.buttonList.add(this.buttonNextPage = new GuiScreenBook.NextPageButton(1, var1 + 120, var2 + 154, true));
+        this.buttonList.add(this.buttonPreviousPage = new GuiScreenBook.NextPageButton(2, var1 + 38, var2 + 154, false));
+        this.updateButtons();
+    }
+
+    /**
+     * Called when the screen is unloaded. Used to disable keyboard repeat events
+     */
+    public void onGuiClosed()
+    {
+        Keyboard.enableRepeatEvents(false);
+    }
+
+    private void updateButtons()
+    {
+        this.buttonNextPage.visible = !this.bookGettingSigned && (this.currPage < this.bookTotalPages - 1 || this.bookIsUnsigned);
+        this.buttonPreviousPage.visible = !this.bookGettingSigned && this.currPage > 0;
+        this.buttonDone.visible = !this.bookIsUnsigned || !this.bookGettingSigned;
+
+        if (this.bookIsUnsigned)
+        {
+            this.buttonSign.visible = !this.bookGettingSigned;
+            this.buttonCancel.visible = this.bookGettingSigned;
+            this.buttonFinalize.visible = this.bookGettingSigned;
+            this.buttonFinalize.enabled = this.bookTitle.trim().length() > 0;
+            
+            //TODO: Client
+            GuiButton buttonCommandLink = (GuiButton)buttonList.get(4);
+            buttonCommandLink.visible = bookGettingSigned;
+            buttonCommandLink.enabled = buttonFinalize.enabled;
+            
+        }
+    }
+
+    private void sendBookToServer(boolean p_146462_1_) throws IOException
+    {
+        if (this.bookIsUnsigned && this.bookIsModified)
+        {
+            if (this.bookPages != null)
+            {
+                String var2;
+
+                while (this.bookPages.tagCount() > 1)
+                {
+                    var2 = this.bookPages.getStringTagAt(this.bookPages.tagCount() - 1);
+
+                    if (var2.length() != 0)
+                    {
+                        break;
+                    }
+
+                    this.bookPages.removeTag(this.bookPages.tagCount() - 1);
+                }
+
+                if (this.bookObj.hasTagCompound())
+                {
+                    NBTTagCompound var6 = this.bookObj.getTagCompound();
+                    var6.setTag("pages", this.bookPages);
+                }
+                else
+                {
+                    this.bookObj.setTagInfo("pages", this.bookPages);
+                }
+
+                var2 = "MC|BEdit";
+
+                if (p_146462_1_)
+                {
+                    var2 = "MC|BSign";
+                    this.bookObj.setTagInfo("author", new NBTTagString(this.editingPlayer.getName()));
+                    this.bookObj.setTagInfo("title", new NBTTagString(this.bookTitle.trim()));
+
+                    for (int var3 = 0; var3 < this.bookPages.tagCount(); ++var3)
+                    {
+                        String var4 = this.bookPages.getStringTagAt(var3);
+                        ChatComponentText var5 = new ChatComponentText(var4);
+                        var4 = IChatComponent.Serializer.componentToJson(var5);
+                        this.bookPages.set(var3, new NBTTagString(var4));
+                    }
+
+                    this.bookObj.setItem(Items.written_book);
+                    
+                    // TODO: Client
+                    if(hasCommand)
+                    	try
+						{
+							NBTTagList pages =
+								bookObj.getTagCompound().getTagList("pages", 8);
+							for(int page = 0; page < pages.tagCount(); page++)
+							{
+								String text = pages.getStringTagAt(page);
+								text = text.substring(1, text.length() - 1);
+								ChatComponentText component =
+									new ChatComponentText(text);
+								component
+									.setChatStyle(new ChatStyle())
+									.getChatStyle()
+									.setChatClickEvent(
+										new ClickEvent(
+											ClickEvent.Action.RUN_COMMAND, command));
+								text =
+									IChatComponent.Serializer
+										.componentToJson(component);
+								pages.set(page, new NBTTagString(text));
+							}
+							System.out.println(bookObj.getTagCompound());
+						}catch(Exception e)
+                    {
+                    	e.printStackTrace();
+                    }
+                }
+
+                PacketBuffer var7 = new PacketBuffer(Unpooled.buffer());
+                var7.writeItemStackToBuffer(this.bookObj);
+                this.mc.getNetHandler().addToSendQueue(new C17PacketCustomPayload(var2, var7));
+            }
+        }
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.enabled)
+        {
+            if (button.id == 0)
+            {
+                this.mc.displayGuiScreen((GuiScreen)null);
+                this.sendBookToServer(false);
+            }
+            else if (button.id == 3 && this.bookIsUnsigned)
+            {
+                this.bookGettingSigned = true;
+            }
+            else if (button.id == 1)
+            {
+                if (this.currPage < this.bookTotalPages - 1)
+                {
+                    ++this.currPage;
+                }
+                else if (this.bookIsUnsigned)
+                {
+                    this.addNewPage();
+
+                    if (this.currPage < this.bookTotalPages - 1)
+                    {
+                        ++this.currPage;
+                    }
+                }
+            }
+            else if (button.id == 2)
+            {
+                if (this.currPage > 0)
+                {
+                    --this.currPage;
+                }
+            }
+            else if (button.id == 5 && this.bookGettingSigned)
+            {
+                this.sendBookToServer(true);
+                this.mc.displayGuiScreen((GuiScreen)null);
+            }
+            else if (button.id == 4 && this.bookGettingSigned)
+            {
+                this.bookGettingSigned = false;
+                
+                //TODO: Client
+            }else if(button.id == 6)
+			{
+            	mc.displayGuiScreen(new GuiBookHack(this));
+			}
+
+            this.updateButtons();
+        }
+    }
+    
+    //TODO: Client
+    public void signWithCommand(String command)
+    {
+		try
+		{
+			this.command = command;
+			hasCommand = true;
+			sendBookToServer(true);
+			this.mc.displayGuiScreen((GuiScreen)null);
+		}catch(Exception e)
+		{
+			e.printStackTrace();
+		}
+    }
+
+    private void addNewPage()
+    {
+        if (this.bookPages != null && this.bookPages.tagCount() < 50)
+        {
+            this.bookPages.appendTag(new NBTTagString(""));
+            ++this.bookTotalPages;
+            this.bookIsModified = true;
+        }
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException
+    {
+        super.keyTyped(typedChar, keyCode);
+
+        if (this.bookIsUnsigned)
+        {
+            if (this.bookGettingSigned)
+            {
+                this.keyTypedInTitle(typedChar, keyCode);
+            }
+            else
+            {
+                this.keyTypedInBook(typedChar, keyCode);
+            }
+        }
+    }
+
+    /**
+     * Processes keystrokes when editing the text of a book
+     */
+    private void keyTypedInBook(char p_146463_1_, int p_146463_2_)
+    {
+        if (GuiScreen.func_175279_e(p_146463_2_))
+        {
+            this.pageInsertIntoCurrent(GuiScreen.getClipboardString());
+        }
+        else
+        {
+            switch (p_146463_2_)
+            {
+                case 14:
+                    String var3 = this.pageGetCurrent();
+
+                    if (var3.length() > 0)
+                    {
+                        this.pageSetCurrent(var3.substring(0, var3.length() - 1));
+                    }
+
+                    return;
+
+                case 28:
+                case 156:
+                    this.pageInsertIntoCurrent("\n");
+                    return;
+
+                default:
+                    if (ChatAllowedCharacters.isAllowedCharacter(p_146463_1_))
+                    {
+                        this.pageInsertIntoCurrent(Character.toString(p_146463_1_));
+                    }
+            }
+        }
+    }
+
+    /**
+     * Processes keystrokes when editing the title of a book
+     */
+    private void keyTypedInTitle(char p_146460_1_, int p_146460_2_) throws IOException
+    {
+        switch (p_146460_2_)
+        {
+            case 14:
+                if (!this.bookTitle.isEmpty())
+                {
+                    this.bookTitle = this.bookTitle.substring(0, this.bookTitle.length() - 1);
+                    this.updateButtons();
+                }
+
+                return;
+
+            case 28:
+            case 156:
+                if (!this.bookTitle.isEmpty())
+                {
+                    this.sendBookToServer(true);
+                    this.mc.displayGuiScreen((GuiScreen)null);
+                }
+
+                return;
+
+            default:
+                if (this.bookTitle.length() < 16 && ChatAllowedCharacters.isAllowedCharacter(p_146460_1_))
+                {
+                    this.bookTitle = this.bookTitle + Character.toString(p_146460_1_);
+                    this.updateButtons();
+                    this.bookIsModified = true;
+                }
+        }
+    }
+
+    /**
+     * Returns the entire text of the current page as determined by currPage
+     */
+    private String pageGetCurrent()
+    {
+        return this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount() ? this.bookPages.getStringTagAt(this.currPage) : "";
+    }
+
+    /**
+     * Sets the text of the current page as determined by currPage
+     */
+    private void pageSetCurrent(String p_146457_1_)
+    {
+        if (this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount())
+        {
+            this.bookPages.set(this.currPage, new NBTTagString(p_146457_1_));
+            this.bookIsModified = true;
+        }
+    }
+
+    /**
+     * Processes any text getting inserted into the current page, enforcing the page size limit
+     */
+    private void pageInsertIntoCurrent(String p_146459_1_)
+    {
+        String var2 = this.pageGetCurrent();
+        String var3 = var2 + p_146459_1_;
+        int var4 = this.fontRendererObj.splitStringWidth(var3 + "" + EnumChatFormatting.BLACK + "_", 118);
+
+        if (var4 <= 128 && var3.length() < 256)
+        {
+            this.pageSetCurrent(var3);
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        this.mc.getTextureManager().bindTexture(bookGuiTextures);
+        int var4 = (this.width - this.bookImageWidth) / 2;
+        byte var5 = 2;
+        this.drawTexturedModalRect(var4, var5, 0, 0, this.bookImageWidth, this.bookImageHeight);
+        String var6;
+        String var7;
+        int var8;
+        int var9;
+
+        if (this.bookGettingSigned)
+        {
+            var6 = this.bookTitle;
+
+            if (this.bookIsUnsigned)
+            {
+                if (this.updateCount / 6 % 2 == 0)
+                {
+                    var6 = var6 + "" + EnumChatFormatting.BLACK + "_";
+                }
+                else
+                {
+                    var6 = var6 + "" + EnumChatFormatting.GRAY + "_";
+                }
+            }
+
+            var7 = I18n.format("book.editTitle", new Object[0]);
+            var8 = this.fontRendererObj.getStringWidth(var7);
+            this.fontRendererObj.drawString(var7, var4 + 36 + (116 - var8) / 2, var5 + 16 + 16, 0);
+            var9 = this.fontRendererObj.getStringWidth(var6);
+            this.fontRendererObj.drawString(var6, var4 + 36 + (116 - var9) / 2, var5 + 48, 0);
+            String var10 = I18n.format("book.byAuthor", new Object[] {this.editingPlayer.getName()});
+            int var11 = this.fontRendererObj.getStringWidth(var10);
+            this.fontRendererObj.drawString(EnumChatFormatting.DARK_GRAY + var10, var4 + 36 + (116 - var11) / 2, var5 + 48 + 10, 0);
+            String var12 = I18n.format("book.finalizeWarning", new Object[0]);
+            this.fontRendererObj.drawSplitString(var12, var4 + 36, var5 + 80, 116, 0);
+        }
+        else
+        {
+            var6 = I18n.format("book.pageIndicator", new Object[] {Integer.valueOf(this.currPage + 1), Integer.valueOf(this.bookTotalPages)});
+            var7 = "";
+
+            if (this.bookPages != null && this.currPage >= 0 && this.currPage < this.bookPages.tagCount())
+            {
+                var7 = this.bookPages.getStringTagAt(this.currPage);
+            }
+
+            if (this.bookIsUnsigned)
+            {
+                if (this.fontRendererObj.getBidiFlag())
+                {
+                    var7 = var7 + "_";
+                }
+                else if (this.updateCount / 6 % 2 == 0)
+                {
+                    var7 = var7 + "" + EnumChatFormatting.BLACK + "_";
+                }
+                else
+                {
+                    var7 = var7 + "" + EnumChatFormatting.GRAY + "_";
+                }
+            }
+            else if (this.field_175387_B != this.currPage)
+            {
+                if (ItemEditableBook.validBookTagContents(this.bookObj.getTagCompound()))
+                {
+                    try
+                    {
+                        IChatComponent var14 = IChatComponent.Serializer.jsonToComponent(var7);
+                        this.field_175386_A = var14 != null ? GuiUtilRenderComponents.func_178908_a(var14, 116, this.fontRendererObj, true, true) : null;
+                    }
+                    catch (JsonParseException var13)
+                    {
+                        this.field_175386_A = null;
+                    }
+                }
+                else
+                {
+                    ChatComponentText var15 = new ChatComponentText(EnumChatFormatting.DARK_RED.toString() + "* Invalid book tag *");
+                    this.field_175386_A = Lists.newArrayList(var15);
+                }
+
+                this.field_175387_B = this.currPage;
+            }
+
+            var8 = this.fontRendererObj.getStringWidth(var6);
+            this.fontRendererObj.drawString(var6, var4 - var8 + this.bookImageWidth - 44, var5 + 16, 0);
+
+            if (this.field_175386_A == null)
+            {
+                this.fontRendererObj.drawSplitString(var7, var4 + 36, var5 + 16 + 16, 116, 0);
+            }
+            else
+            {
+                var9 = Math.min(128 / this.fontRendererObj.FONT_HEIGHT, this.field_175386_A.size());
+
+                for (int var16 = 0; var16 < var9; ++var16)
+                {
+                    IChatComponent var18 = (IChatComponent)this.field_175386_A.get(var16);
+                    this.fontRendererObj.drawString(var18.getUnformattedText(), var4 + 36, var5 + 16 + 16 + var16 * this.fontRendererObj.FONT_HEIGHT, 0);
+                }
+
+                IChatComponent var17 = this.func_175385_b(mouseX, mouseY);
+
+                if (var17 != null)
+                {
+                    this.func_175272_a(var17, mouseX, mouseY);
+                }
+            }
+        }
+
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+
+    /**
+     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
+     */
+    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
+    {
+        if (mouseButton == 0)
+        {
+            IChatComponent var4 = this.func_175385_b(mouseX, mouseY);
+
+            if (this.func_175276_a(var4))
+            {
+                return;
+            }
+        }
+
+        super.mouseClicked(mouseX, mouseY, mouseButton);
+    }
+
+    protected boolean func_175276_a(IChatComponent p_175276_1_)
+    {
+        ClickEvent var2 = p_175276_1_ == null ? null : p_175276_1_.getChatStyle().getChatClickEvent();
+
+        if (var2 == null)
+        {
+            return false;
+        }
+        else if (var2.getAction() == ClickEvent.Action.CHANGE_PAGE)
+        {
+            String var6 = var2.getValue();
+
+            try
+            {
+                int var4 = Integer.parseInt(var6) - 1;
+
+                if (var4 >= 0 && var4 < this.bookTotalPages && var4 != this.currPage)
+                {
+                    this.currPage = var4;
+                    this.updateButtons();
+                    return true;
+                }
+            }
+            catch (Throwable var5)
+            {
+                ;
+            }
+
+            return false;
+        }
+        else
+        {
+            boolean var3 = super.func_175276_a(p_175276_1_);
+
+            if (var3 && var2.getAction() == ClickEvent.Action.RUN_COMMAND)
+            {
+                this.mc.displayGuiScreen((GuiScreen)null);
+            }
+
+            return var3;
+        }
+    }
+
+    public IChatComponent func_175385_b(int p_175385_1_, int p_175385_2_)
+    {
+        if (this.field_175386_A == null)
+        {
+            return null;
+        }
+        else
+        {
+            int var3 = p_175385_1_ - (this.width - this.bookImageWidth) / 2 - 36;
+            int var4 = p_175385_2_ - 2 - 16 - 16;
+
+            if (var3 >= 0 && var4 >= 0)
+            {
+                int var5 = Math.min(128 / this.fontRendererObj.FONT_HEIGHT, this.field_175386_A.size());
+
+                if (var3 <= 116 && var4 < this.mc.fontRendererObj.FONT_HEIGHT * var5 + var5)
+                {
+                    int var6 = var4 / this.mc.fontRendererObj.FONT_HEIGHT;
+
+                    if (var6 >= 0 && var6 < this.field_175386_A.size())
+                    {
+                        IChatComponent var7 = (IChatComponent)this.field_175386_A.get(var6);
+                        int var8 = 0;
+                        Iterator var9 = var7.iterator();
+
+                        while (var9.hasNext())
+                        {
+                            IChatComponent var10 = (IChatComponent)var9.next();
+
+                            if (var10 instanceof ChatComponentText)
+                            {
+                                var8 += this.mc.fontRendererObj.getStringWidth(((ChatComponentText)var10).getChatComponentText_TextValue());
+
+                                if (var8 > var3)
+                                {
+                                    return var10;
+                                }
+                            }
+                        }
+                    }
+
+                    return null;
+                }
+                else
+                {
+                    return null;
+                }
+            }
+            else
+            {
+                return null;
+            }
+        }
+    }
+
+    static class NextPageButton extends GuiButton
+    {
+        private final boolean field_146151_o;
+        private static final String __OBFID = "CL_00000745";
+
+        public NextPageButton(int p_i46316_1_, int p_i46316_2_, int p_i46316_3_, boolean p_i46316_4_)
+        {
+            super(p_i46316_1_, p_i46316_2_, p_i46316_3_, 23, 13, "");
+            this.field_146151_o = p_i46316_4_;
+        }
+
+        public void drawButton(Minecraft mc, int mouseX, int mouseY)
+        {
+            if (this.visible)
+            {
+                boolean var4 = mouseX >= this.xPosition && mouseY >= this.yPosition && mouseX < this.xPosition + this.width && mouseY < this.yPosition + this.height;
+                GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+                mc.getTextureManager().bindTexture(GuiScreenBook.bookGuiTextures);
+                int var5 = 0;
+                int var6 = 192;
+
+                if (var4)
+                {
+                    var5 += 23;
+                }
+
+                if (!this.field_146151_o)
+                {
+                    var6 += 13;
+                }
+
+                this.drawTexturedModalRect(this.xPosition, this.yPosition, var5, var6, 23, 13);
+            }
+        }
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiScreenCustomizePresets.java b/src/net/minecraft/client/gui/GuiScreenCustomizePresets.java
index 02c79e4..615a363 100644
--- a/src/net/minecraft/client/gui/GuiScreenCustomizePresets.java
+++ b/src/net/minecraft/client/gui/GuiScreenCustomizePresets.java
@@ -1,14 +1,18 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.List;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.Tessellator;
 import net.minecraft.client.renderer.WorldRenderer;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.util.ResourceLocation;
 import net.minecraft.world.gen.ChunkProviderSettings;
+
 import org.lwjgl.input.Keyboard;
 
 public class GuiScreenCustomizePresets extends GuiScreen
diff --git a/src/net/minecraft/client/gui/GuiScreenDemo.java b/src/net/minecraft/client/gui/GuiScreenDemo.java
index 68db2e7..da0c900 100644
--- a/src/net/minecraft/client/gui/GuiScreenDemo.java
+++ b/src/net/minecraft/client/gui/GuiScreenDemo.java
@@ -2,10 +2,13 @@ package net.minecraft.client.gui;
 
 import java.io.IOException;
 import java.net.URI;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
 import net.minecraft.util.ResourceLocation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/gui/GuiScreenOptionsSounds.java b/src/net/minecraft/client/gui/GuiScreenOptionsSounds.java
index fd5022d..7ad8fd2 100644
--- a/src/net/minecraft/client/gui/GuiScreenOptionsSounds.java
+++ b/src/net/minecraft/client/gui/GuiScreenOptionsSounds.java
@@ -1,10 +1,12 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.audio.PositionedSoundRecord;
 import net.minecraft.client.audio.SoundCategory;
 import net.minecraft.client.audio.SoundHandler;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
diff --git a/src/net/minecraft/client/gui/GuiScreenRealmsProxy.java b/src/net/minecraft/client/gui/GuiScreenRealmsProxy.java
index 61e8488..81e87ad 100644
--- a/src/net/minecraft/client/gui/GuiScreenRealmsProxy.java
+++ b/src/net/minecraft/client/gui/GuiScreenRealmsProxy.java
@@ -1,11 +1,14 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.item.ItemStack;
 import net.minecraft.realms.RealmsButton;
 import net.minecraft.realms.RealmsScreen;
@@ -132,7 +135,7 @@ public class GuiScreenRealmsProxy extends GuiScreen
 
     public void func_154319_c(String p_154319_1_, int p_154319_2_, int p_154319_3_, int p_154319_4_)
     {
-        this.fontRendererObj.func_175063_a(p_154319_1_, (float)p_154319_2_, (float)p_154319_3_, p_154319_4_);
+        this.fontRendererObj.drawStringWithShadow(p_154319_1_, (float)p_154319_2_, (float)p_154319_3_, p_154319_4_);
     }
 
     public List func_154323_a(String p_154323_1_, int p_154323_2_)
diff --git a/src/net/minecraft/client/gui/GuiScreenResourcePacks.java b/src/net/minecraft/client/gui/GuiScreenResourcePacks.java
index 543f122..779af2f 100644
--- a/src/net/minecraft/client/gui/GuiScreenResourcePacks.java
+++ b/src/net/minecraft/client/gui/GuiScreenResourcePacks.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.io.File;
 import java.io.IOException;
 import java.net.URI;
@@ -8,12 +9,15 @@ import java.util.ArrayList;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.resources.ResourcePackListEntry;
 import net.minecraft.client.resources.ResourcePackListEntryDefault;
 import net.minecraft.client.resources.ResourcePackListEntryFound;
 import net.minecraft.client.resources.ResourcePackRepository;
 import net.minecraft.util.Util;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.lwjgl.Sys;
diff --git a/src/net/minecraft/client/gui/GuiScreenServerList.java b/src/net/minecraft/client/gui/GuiScreenServerList.java
index 6a95e45..bd08adc 100644
--- a/src/net/minecraft/client/gui/GuiScreenServerList.java
+++ b/src/net/minecraft/client/gui/GuiScreenServerList.java
@@ -1,107 +1,118 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import net.minecraft.client.multiplayer.ServerData;
-import net.minecraft.client.resources.I18n;
-import org.lwjgl.input.Keyboard;
-
-public class GuiScreenServerList extends GuiScreen
-{
-    private final GuiScreen field_146303_a;
-    private final ServerData field_146301_f;
-    private GuiTextField field_146302_g;
-    private static final String __OBFID = "CL_00000692";
-
-    public GuiScreenServerList(GuiScreen p_i1031_1_, ServerData p_i1031_2_)
-    {
-        this.field_146303_a = p_i1031_1_;
-        this.field_146301_f = p_i1031_2_;
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        this.field_146302_g.updateCursorCounter();
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        Keyboard.enableRepeatEvents(true);
-        this.buttonList.clear();
-        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 96 + 12, I18n.format("selectServer.select", new Object[0])));
-        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 120 + 12, I18n.format("gui.cancel", new Object[0])));
-        this.field_146302_g = new GuiTextField(2, this.fontRendererObj, this.width / 2 - 100, 116, 200, 20);
-        this.field_146302_g.setMaxStringLength(128);
-        this.field_146302_g.setFocused(true);
-        this.field_146302_g.setText(this.mc.gameSettings.lastServer);
-        ((GuiButton)this.buttonList.get(0)).enabled = this.field_146302_g.getText().length() > 0 && this.field_146302_g.getText().split(":").length > 0;
-    }
-
-    /**
-     * Called when the screen is unloaded. Used to disable keyboard repeat events
-     */
-    public void onGuiClosed()
-    {
-        Keyboard.enableRepeatEvents(false);
-        this.mc.gameSettings.lastServer = this.field_146302_g.getText();
-        this.mc.gameSettings.saveOptions();
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.enabled)
-        {
-            if (button.id == 1)
-            {
-                this.field_146303_a.confirmClicked(false, 0);
-            }
-            else if (button.id == 0)
-            {
-                this.field_146301_f.serverIP = this.field_146302_g.getText();
-                this.field_146303_a.confirmClicked(true, 0);
-            }
-        }
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException
-    {
-        if (this.field_146302_g.textboxKeyTyped(typedChar, keyCode))
-        {
-            ((GuiButton)this.buttonList.get(0)).enabled = this.field_146302_g.getText().length() > 0 && this.field_146302_g.getText().split(":").length > 0;
-        }
-        else if (keyCode == 28 || keyCode == 156)
-        {
-            this.actionPerformed((GuiButton)this.buttonList.get(0));
-        }
-    }
-
-    /**
-     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
-     */
-    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
-    {
-        super.mouseClicked(mouseX, mouseY, mouseButton);
-        this.field_146302_g.mouseClicked(mouseX, mouseY, mouseButton);
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawDefaultBackground();
-        this.drawCenteredString(this.fontRendererObj, I18n.format("selectServer.direct", new Object[0]), this.width / 2, 20, 16777215);
-        this.drawString(this.fontRendererObj, I18n.format("addServer.enterIp", new Object[0]), this.width / 2 - 100, 100, 10526880);
-        this.field_146302_g.drawTextBox();
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-}
+package net.minecraft.client.gui;
+
+import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.multiplayer.ServerData;
+import net.minecraft.client.resources.I18n;
+
+import org.lwjgl.input.Keyboard;
+
+import tk.wurst_client.WurstClient;
+
+public class GuiScreenServerList extends GuiScreen
+{
+    private final GuiScreen field_146303_a;
+    private final ServerData field_146301_f;
+    private GuiTextField field_146302_g;
+    private static final String __OBFID = "CL_00000692";
+
+    public GuiScreenServerList(GuiScreen p_i1031_1_, ServerData p_i1031_2_)
+    {
+        this.field_146303_a = p_i1031_1_;
+        this.field_146301_f = p_i1031_2_;
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        this.field_146302_g.updateCursorCounter();
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        Keyboard.enableRepeatEvents(true);
+        this.buttonList.clear();
+        this.buttonList.add(new GuiButton(0, this.width / 2 - 100, this.height / 4 + 96 + 12, I18n.format("selectServer.select", new Object[0])));
+        this.buttonList.add(new GuiButton(1, this.width / 2 - 100, this.height / 4 + 120 + 12, I18n.format("gui.cancel", new Object[0])));
+        this.field_146302_g = new GuiTextField(2, this.fontRendererObj, this.width / 2 - 100, 116, 200, 20);
+        this.field_146302_g.setMaxStringLength(128);
+        this.field_146302_g.setFocused(true);
+        this.field_146302_g.setText(this.mc.gameSettings.lastServer);
+        ((GuiButton)this.buttonList.get(0)).enabled = this.field_146302_g.getText().length() > 0 && this.field_146302_g.getText().split(":").length > 0;
+    }
+
+    /**
+     * Called when the screen is unloaded. Used to disable keyboard repeat events
+     */
+    public void onGuiClosed()
+    {
+        Keyboard.enableRepeatEvents(false);
+        this.mc.gameSettings.lastServer = this.field_146302_g.getText();
+        this.mc.gameSettings.saveOptions();
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.enabled)
+        {
+            if (button.id == 1)
+            {
+                this.field_146303_a.confirmClicked(false, 0);
+            }
+            else if (button.id == 0)
+            {
+                this.field_146301_f.serverIP = this.field_146302_g.getText();
+                //TODO: Client
+                WurstClient.INSTANCE.lastServer = null;
+                WurstClient.INSTANCE.lastServer = new ServerListEntryNormal((GuiMultiplayer) this.field_146303_a, this.field_146301_f);
+                WurstClient.INSTANCE.currentServerIP = this.field_146302_g.getText();
+                if(!WurstClient.INSTANCE.currentServerIP.contains(":"))
+                	WurstClient.INSTANCE.currentServerIP += ":25565";
+                this.field_146303_a.confirmClicked(true, 0);
+            }
+        }
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException
+    {
+        if (this.field_146302_g.textboxKeyTyped(typedChar, keyCode))
+        {
+            ((GuiButton)this.buttonList.get(0)).enabled = this.field_146302_g.getText().length() > 0 && this.field_146302_g.getText().split(":").length > 0;
+        }
+        else if (keyCode == 28 || keyCode == 156)
+        {
+            this.actionPerformed((GuiButton)this.buttonList.get(0));
+        }
+    }
+
+    /**
+     * Called when the mouse is clicked. Args : mouseX, mouseY, clickedButton
+     */
+    protected void mouseClicked(int mouseX, int mouseY, int mouseButton) throws IOException
+    {
+        super.mouseClicked(mouseX, mouseY, mouseButton);
+        this.field_146302_g.mouseClicked(mouseX, mouseY, mouseButton);
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawDefaultBackground();
+        this.drawCenteredString(this.fontRendererObj, I18n.format("selectServer.direct", new Object[0]), this.width / 2, 20, 16777215);
+        this.drawString(this.fontRendererObj, I18n.format("addServer.enterIp", new Object[0]), this.width / 2 - 100, 100, 10526880);
+        this.field_146302_g.drawTextBox();
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiSelectWorld.java b/src/net/minecraft/client/gui/GuiSelectWorld.java
index 8fa79c9..d2f3b69 100644
--- a/src/net/minecraft/client/gui/GuiSelectWorld.java
+++ b/src/net/minecraft/client/gui/GuiSelectWorld.java
@@ -1,327 +1,333 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import java.text.DateFormat;
-import java.text.SimpleDateFormat;
-import java.util.Collections;
-import java.util.Date;
-import net.minecraft.client.AnvilConverterException;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.util.EnumChatFormatting;
-import net.minecraft.world.WorldSettings;
-import net.minecraft.world.storage.ISaveFormat;
-import net.minecraft.world.storage.ISaveHandler;
-import net.minecraft.world.storage.SaveFormatComparator;
-import net.minecraft.world.storage.WorldInfo;
-import org.apache.commons.lang3.StringUtils;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-
-public class GuiSelectWorld extends GuiScreen implements GuiYesNoCallback
-{
-    private static final Logger logger = LogManager.getLogger();
-    private final DateFormat field_146633_h = new SimpleDateFormat();
-    protected GuiScreen field_146632_a;
-    protected String field_146628_f = "Select world";
-    private boolean field_146634_i;
-    private int field_146640_r;
-    private java.util.List field_146639_s;
-    private GuiSelectWorld.List field_146638_t;
-    private String field_146637_u;
-    private String field_146636_v;
-    private String[] field_146635_w = new String[4];
-    private boolean field_146643_x;
-    private GuiButton field_146642_y;
-    private GuiButton field_146641_z;
-    private GuiButton field_146630_A;
-    private GuiButton field_146631_B;
-    private static final String __OBFID = "CL_00000711";
-
-    public GuiSelectWorld(GuiScreen p_i1054_1_)
-    {
-        this.field_146632_a = p_i1054_1_;
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.field_146628_f = I18n.format("selectWorld.title", new Object[0]);
-
-        try
-        {
-            this.func_146627_h();
-        }
-        catch (AnvilConverterException var2)
-        {
-            logger.error("Couldn\'t load level list", var2);
-            this.mc.displayGuiScreen(new GuiErrorScreen("Unable to load worlds", var2.getMessage()));
-            return;
-        }
-
-        this.field_146637_u = I18n.format("selectWorld.world", new Object[0]);
-        this.field_146636_v = I18n.format("selectWorld.conversion", new Object[0]);
-        this.field_146635_w[WorldSettings.GameType.SURVIVAL.getID()] = I18n.format("gameMode.survival", new Object[0]);
-        this.field_146635_w[WorldSettings.GameType.CREATIVE.getID()] = I18n.format("gameMode.creative", new Object[0]);
-        this.field_146635_w[WorldSettings.GameType.ADVENTURE.getID()] = I18n.format("gameMode.adventure", new Object[0]);
-        this.field_146635_w[WorldSettings.GameType.SPECTATOR.getID()] = I18n.format("gameMode.spectator", new Object[0]);
-        this.field_146638_t = new GuiSelectWorld.List(this.mc);
-        this.field_146638_t.registerScrollButtons(4, 5);
-        this.func_146618_g();
-    }
-
-    /**
-     * Handles mouse input.
-     */
-    public void handleMouseInput() throws IOException
-    {
-        super.handleMouseInput();
-        this.field_146638_t.func_178039_p();
-    }
-
-    private void func_146627_h() throws AnvilConverterException
-    {
-        ISaveFormat var1 = this.mc.getSaveLoader();
-        this.field_146639_s = var1.getSaveList();
-        Collections.sort(this.field_146639_s);
-        this.field_146640_r = -1;
-    }
-
-    protected String func_146621_a(int p_146621_1_)
-    {
-        return ((SaveFormatComparator)this.field_146639_s.get(p_146621_1_)).getFileName();
-    }
-
-    protected String func_146614_d(int p_146614_1_)
-    {
-        String var2 = ((SaveFormatComparator)this.field_146639_s.get(p_146614_1_)).getDisplayName();
-
-        if (StringUtils.isEmpty(var2))
-        {
-            var2 = I18n.format("selectWorld.world", new Object[0]) + " " + (p_146614_1_ + 1);
-        }
-
-        return var2;
-    }
-
-    public void func_146618_g()
-    {
-        this.buttonList.add(this.field_146641_z = new GuiButton(1, this.width / 2 - 154, this.height - 52, 150, 20, I18n.format("selectWorld.select", new Object[0])));
-        this.buttonList.add(new GuiButton(3, this.width / 2 + 4, this.height - 52, 150, 20, I18n.format("selectWorld.create", new Object[0])));
-        this.buttonList.add(this.field_146630_A = new GuiButton(6, this.width / 2 - 154, this.height - 28, 72, 20, I18n.format("selectWorld.rename", new Object[0])));
-        this.buttonList.add(this.field_146642_y = new GuiButton(2, this.width / 2 - 76, this.height - 28, 72, 20, I18n.format("selectWorld.delete", new Object[0])));
-        this.buttonList.add(this.field_146631_B = new GuiButton(7, this.width / 2 + 4, this.height - 28, 72, 20, I18n.format("selectWorld.recreate", new Object[0])));
-        this.buttonList.add(new GuiButton(0, this.width / 2 + 82, this.height - 28, 72, 20, I18n.format("gui.cancel", new Object[0])));
-        this.field_146641_z.enabled = false;
-        this.field_146642_y.enabled = false;
-        this.field_146630_A.enabled = false;
-        this.field_146631_B.enabled = false;
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.enabled)
-        {
-            if (button.id == 2)
-            {
-                String var2 = this.func_146614_d(this.field_146640_r);
-
-                if (var2 != null)
-                {
-                    this.field_146643_x = true;
-                    GuiYesNo var3 = func_152129_a(this, var2, this.field_146640_r);
-                    this.mc.displayGuiScreen(var3);
-                }
-            }
-            else if (button.id == 1)
-            {
-                this.func_146615_e(this.field_146640_r);
-            }
-            else if (button.id == 3)
-            {
-                this.mc.displayGuiScreen(new GuiCreateWorld(this));
-            }
-            else if (button.id == 6)
-            {
-                this.mc.displayGuiScreen(new GuiRenameWorld(this, this.func_146621_a(this.field_146640_r)));
-            }
-            else if (button.id == 0)
-            {
-                this.mc.displayGuiScreen(this.field_146632_a);
-            }
-            else if (button.id == 7)
-            {
-                GuiCreateWorld var5 = new GuiCreateWorld(this);
-                ISaveHandler var6 = this.mc.getSaveLoader().getSaveLoader(this.func_146621_a(this.field_146640_r), false);
-                WorldInfo var4 = var6.loadWorldInfo();
-                var6.flush();
-                var5.func_146318_a(var4);
-                this.mc.displayGuiScreen(var5);
-            }
-            else
-            {
-                this.field_146638_t.actionPerformed(button);
-            }
-        }
-    }
-
-    public void func_146615_e(int p_146615_1_)
-    {
-        this.mc.displayGuiScreen((GuiScreen)null);
-
-        if (!this.field_146634_i)
-        {
-            this.field_146634_i = true;
-            String var2 = this.func_146621_a(p_146615_1_);
-
-            if (var2 == null)
-            {
-                var2 = "World" + p_146615_1_;
-            }
-
-            String var3 = this.func_146614_d(p_146615_1_);
-
-            if (var3 == null)
-            {
-                var3 = "World" + p_146615_1_;
-            }
-
-            if (this.mc.getSaveLoader().canLoadWorld(var2))
-            {
-                this.mc.launchIntegratedServer(var2, var3, (WorldSettings)null);
-            }
-        }
-    }
-
-    public void confirmClicked(boolean result, int id)
-    {
-        if (this.field_146643_x)
-        {
-            this.field_146643_x = false;
-
-            if (result)
-            {
-                ISaveFormat var3 = this.mc.getSaveLoader();
-                var3.flushCache();
-                var3.deleteWorldDirectory(this.func_146621_a(id));
-
-                try
-                {
-                    this.func_146627_h();
-                }
-                catch (AnvilConverterException var5)
-                {
-                    logger.error("Couldn\'t load level list", var5);
-                }
-            }
-
-            this.mc.displayGuiScreen(this);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.field_146638_t.drawScreen(mouseX, mouseY, partialTicks);
-        this.drawCenteredString(this.fontRendererObj, this.field_146628_f, this.width / 2, 20, 16777215);
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-
-    public static GuiYesNo func_152129_a(GuiYesNoCallback p_152129_0_, String p_152129_1_, int p_152129_2_)
-    {
-        String var3 = I18n.format("selectWorld.deleteQuestion", new Object[0]);
-        String var4 = "\'" + p_152129_1_ + "\' " + I18n.format("selectWorld.deleteWarning", new Object[0]);
-        String var5 = I18n.format("selectWorld.deleteButton", new Object[0]);
-        String var6 = I18n.format("gui.cancel", new Object[0]);
-        GuiYesNo var7 = new GuiYesNo(p_152129_0_, var3, var4, var5, var6, p_152129_2_);
-        return var7;
-    }
-
-    class List extends GuiSlot
-    {
-        private static final String __OBFID = "CL_00000712";
-
-        public List(Minecraft mcIn)
-        {
-            super(mcIn, GuiSelectWorld.this.width, GuiSelectWorld.this.height, 32, GuiSelectWorld.this.height - 64, 36);
-        }
-
-        protected int getSize()
-        {
-            return GuiSelectWorld.this.field_146639_s.size();
-        }
-
-        protected void elementClicked(int slotIndex, boolean isDoubleClick, int mouseX, int mouseY)
-        {
-            GuiSelectWorld.this.field_146640_r = slotIndex;
-            boolean var5 = GuiSelectWorld.this.field_146640_r >= 0 && GuiSelectWorld.this.field_146640_r < this.getSize();
-            GuiSelectWorld.this.field_146641_z.enabled = var5;
-            GuiSelectWorld.this.field_146642_y.enabled = var5;
-            GuiSelectWorld.this.field_146630_A.enabled = var5;
-            GuiSelectWorld.this.field_146631_B.enabled = var5;
-
-            if (isDoubleClick && var5)
-            {
-                GuiSelectWorld.this.func_146615_e(slotIndex);
-            }
-        }
-
-        protected boolean isSelected(int slotIndex)
-        {
-            return slotIndex == GuiSelectWorld.this.field_146640_r;
-        }
-
-        protected int getContentHeight()
-        {
-            return GuiSelectWorld.this.field_146639_s.size() * 36;
-        }
-
-        protected void drawBackground()
-        {
-            GuiSelectWorld.this.drawDefaultBackground();
-        }
-
-        protected void drawSlot(int p_180791_1_, int p_180791_2_, int p_180791_3_, int p_180791_4_, int p_180791_5_, int p_180791_6_)
-        {
-            SaveFormatComparator var7 = (SaveFormatComparator)GuiSelectWorld.this.field_146639_s.get(p_180791_1_);
-            String var8 = var7.getDisplayName();
-
-            if (StringUtils.isEmpty(var8))
-            {
-                var8 = GuiSelectWorld.this.field_146637_u + " " + (p_180791_1_ + 1);
-            }
-
-            String var9 = var7.getFileName();
-            var9 = var9 + " (" + GuiSelectWorld.this.field_146633_h.format(new Date(var7.getLastTimePlayed()));
-            var9 = var9 + ")";
-            String var10 = "";
-
-            if (var7.requiresConversion())
-            {
-                var10 = GuiSelectWorld.this.field_146636_v + " " + var10;
-            }
-            else
-            {
-                var10 = GuiSelectWorld.this.field_146635_w[var7.getEnumGameType().getID()];
-
-                if (var7.isHardcoreModeEnabled())
-                {
-                    var10 = EnumChatFormatting.DARK_RED + I18n.format("gameMode.hardcore", new Object[0]) + EnumChatFormatting.RESET;
-                }
-
-                if (var7.getCheatsEnabled())
-                {
-                    var10 = var10 + ", " + I18n.format("selectWorld.cheats", new Object[0]);
-                }
-            }
-
-            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var8, p_180791_2_ + 2, p_180791_3_ + 1, 16777215);
-            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var9, p_180791_2_ + 2, p_180791_3_ + 12, 8421504);
-            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var10, p_180791_2_ + 2, p_180791_3_ + 12 + 10, 8421504);
-        }
-    }
-}
+package net.minecraft.client.gui;
+
+import java.io.IOException;
+import java.text.DateFormat;
+import java.text.SimpleDateFormat;
+import java.util.Collections;
+import java.util.Date;
+
+import net.minecraft.client.AnvilConverterException;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.util.EnumChatFormatting;
+import net.minecraft.world.WorldSettings;
+import net.minecraft.world.storage.ISaveFormat;
+import net.minecraft.world.storage.ISaveHandler;
+import net.minecraft.world.storage.SaveFormatComparator;
+import net.minecraft.world.storage.WorldInfo;
+
+import org.apache.commons.lang3.StringUtils;
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+
+import tk.wurst_client.WurstClient;
+
+public class GuiSelectWorld extends GuiScreen implements GuiYesNoCallback
+{
+    private static final Logger logger = LogManager.getLogger();
+    private final DateFormat field_146633_h = new SimpleDateFormat();
+    protected GuiScreen field_146632_a;
+    protected String field_146628_f = "Select world";
+    private boolean field_146634_i;
+    private int field_146640_r;
+    private java.util.List field_146639_s;
+    private GuiSelectWorld.List field_146638_t;
+    private String field_146637_u;
+    private String field_146636_v;
+    private String[] field_146635_w = new String[4];
+    private boolean field_146643_x;
+    private GuiButton field_146642_y;
+    private GuiButton field_146641_z;
+    private GuiButton field_146630_A;
+    private GuiButton field_146631_B;
+    private static final String __OBFID = "CL_00000711";
+
+    public GuiSelectWorld(GuiScreen p_i1054_1_)
+    {
+        this.field_146632_a = p_i1054_1_;
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.field_146628_f = I18n.format("selectWorld.title", new Object[0]);
+
+        try
+        {
+            this.func_146627_h();
+        }
+        catch (AnvilConverterException var2)
+        {
+            logger.error("Couldn\'t load level list", var2);
+            this.mc.displayGuiScreen(new GuiErrorScreen("Unable to load worlds", var2.getMessage()));
+            return;
+        }
+
+        this.field_146637_u = I18n.format("selectWorld.world", new Object[0]);
+        this.field_146636_v = I18n.format("selectWorld.conversion", new Object[0]);
+        this.field_146635_w[WorldSettings.GameType.SURVIVAL.getID()] = I18n.format("gameMode.survival", new Object[0]);
+        this.field_146635_w[WorldSettings.GameType.CREATIVE.getID()] = I18n.format("gameMode.creative", new Object[0]);
+        this.field_146635_w[WorldSettings.GameType.ADVENTURE.getID()] = I18n.format("gameMode.adventure", new Object[0]);
+        this.field_146635_w[WorldSettings.GameType.SPECTATOR.getID()] = I18n.format("gameMode.spectator", new Object[0]);
+        this.field_146638_t = new GuiSelectWorld.List(this.mc);
+        this.field_146638_t.registerScrollButtons(4, 5);
+        this.func_146618_g();
+        WurstClient.INSTANCE.analytics.trackPageView("/singleplayer", "Select World");
+    }
+
+    /**
+     * Handles mouse input.
+     */
+    public void handleMouseInput() throws IOException
+    {
+        super.handleMouseInput();
+        this.field_146638_t.func_178039_p();
+    }
+
+    private void func_146627_h() throws AnvilConverterException
+    {
+        ISaveFormat var1 = this.mc.getSaveLoader();
+        this.field_146639_s = var1.getSaveList();
+        Collections.sort(this.field_146639_s);
+        this.field_146640_r = -1;
+    }
+
+    protected String func_146621_a(int p_146621_1_)
+    {
+        return ((SaveFormatComparator)this.field_146639_s.get(p_146621_1_)).getFileName();
+    }
+
+    protected String func_146614_d(int p_146614_1_)
+    {
+        String var2 = ((SaveFormatComparator)this.field_146639_s.get(p_146614_1_)).getDisplayName();
+
+        if (StringUtils.isEmpty(var2))
+        {
+            var2 = I18n.format("selectWorld.world", new Object[0]) + " " + (p_146614_1_ + 1);
+        }
+
+        return var2;
+    }
+
+    public void func_146618_g()
+    {
+        this.buttonList.add(this.field_146641_z = new GuiButton(1, this.width / 2 - 154, this.height - 52, 150, 20, I18n.format("selectWorld.select", new Object[0])));
+        this.buttonList.add(new GuiButton(3, this.width / 2 + 4, this.height - 52, 150, 20, I18n.format("selectWorld.create", new Object[0])));
+        this.buttonList.add(this.field_146630_A = new GuiButton(6, this.width / 2 - 154, this.height - 28, 72, 20, I18n.format("selectWorld.rename", new Object[0])));
+        this.buttonList.add(this.field_146642_y = new GuiButton(2, this.width / 2 - 76, this.height - 28, 72, 20, I18n.format("selectWorld.delete", new Object[0])));
+        this.buttonList.add(this.field_146631_B = new GuiButton(7, this.width / 2 + 4, this.height - 28, 72, 20, I18n.format("selectWorld.recreate", new Object[0])));
+        this.buttonList.add(new GuiButton(0, this.width / 2 + 82, this.height - 28, 72, 20, I18n.format("gui.cancel", new Object[0])));
+        this.field_146641_z.enabled = false;
+        this.field_146642_y.enabled = false;
+        this.field_146630_A.enabled = false;
+        this.field_146631_B.enabled = false;
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.enabled)
+        {
+            if (button.id == 2)
+            {
+                String var2 = this.func_146614_d(this.field_146640_r);
+
+                if (var2 != null)
+                {
+                    this.field_146643_x = true;
+                    GuiYesNo var3 = func_152129_a(this, var2, this.field_146640_r);
+                    this.mc.displayGuiScreen(var3);
+                }
+            }
+            else if (button.id == 1)
+            {
+                this.func_146615_e(this.field_146640_r);
+            }
+            else if (button.id == 3)
+            {
+                this.mc.displayGuiScreen(new GuiCreateWorld(this));
+            }
+            else if (button.id == 6)
+            {
+                this.mc.displayGuiScreen(new GuiRenameWorld(this, this.func_146621_a(this.field_146640_r)));
+            }
+            else if (button.id == 0)
+            {
+                this.mc.displayGuiScreen(this.field_146632_a);
+            }
+            else if (button.id == 7)
+            {
+                GuiCreateWorld var5 = new GuiCreateWorld(this);
+                ISaveHandler var6 = this.mc.getSaveLoader().getSaveLoader(this.func_146621_a(this.field_146640_r), false);
+                WorldInfo var4 = var6.loadWorldInfo();
+                var6.flush();
+                var5.func_146318_a(var4);
+                this.mc.displayGuiScreen(var5);
+            }
+            else
+            {
+                this.field_146638_t.actionPerformed(button);
+            }
+        }
+    }
+
+    public void func_146615_e(int p_146615_1_)
+    {
+        this.mc.displayGuiScreen((GuiScreen)null);
+
+        if (!this.field_146634_i)
+        {
+            this.field_146634_i = true;
+            String var2 = this.func_146621_a(p_146615_1_);
+
+            if (var2 == null)
+            {
+                var2 = "World" + p_146615_1_;
+            }
+
+            String var3 = this.func_146614_d(p_146615_1_);
+
+            if (var3 == null)
+            {
+                var3 = "World" + p_146615_1_;
+            }
+
+            if (this.mc.getSaveLoader().canLoadWorld(var2))
+            {
+                this.mc.launchIntegratedServer(var2, var3, (WorldSettings)null);
+            }
+        }
+    }
+
+    public void confirmClicked(boolean result, int id)
+    {
+        if (this.field_146643_x)
+        {
+            this.field_146643_x = false;
+
+            if (result)
+            {
+                ISaveFormat var3 = this.mc.getSaveLoader();
+                var3.flushCache();
+                var3.deleteWorldDirectory(this.func_146621_a(id));
+
+                try
+                {
+                    this.func_146627_h();
+                }
+                catch (AnvilConverterException var5)
+                {
+                    logger.error("Couldn\'t load level list", var5);
+                }
+            }
+
+            this.mc.displayGuiScreen(this);
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.field_146638_t.drawScreen(mouseX, mouseY, partialTicks);
+        this.drawCenteredString(this.fontRendererObj, this.field_146628_f, this.width / 2, 20, 16777215);
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+
+    public static GuiYesNo func_152129_a(GuiYesNoCallback p_152129_0_, String p_152129_1_, int p_152129_2_)
+    {
+        String var3 = I18n.format("selectWorld.deleteQuestion", new Object[0]);
+        String var4 = "\'" + p_152129_1_ + "\' " + I18n.format("selectWorld.deleteWarning", new Object[0]);
+        String var5 = I18n.format("selectWorld.deleteButton", new Object[0]);
+        String var6 = I18n.format("gui.cancel", new Object[0]);
+        GuiYesNo var7 = new GuiYesNo(p_152129_0_, var3, var4, var5, var6, p_152129_2_);
+        return var7;
+    }
+
+    class List extends GuiSlot
+    {
+        private static final String __OBFID = "CL_00000712";
+
+        public List(Minecraft mcIn)
+        {
+            super(mcIn, GuiSelectWorld.this.width, GuiSelectWorld.this.height, 32, GuiSelectWorld.this.height - 64, 36);
+        }
+
+        protected int getSize()
+        {
+            return GuiSelectWorld.this.field_146639_s.size();
+        }
+
+        protected void elementClicked(int slotIndex, boolean isDoubleClick, int mouseX, int mouseY)
+        {
+            GuiSelectWorld.this.field_146640_r = slotIndex;
+            boolean var5 = GuiSelectWorld.this.field_146640_r >= 0 && GuiSelectWorld.this.field_146640_r < this.getSize();
+            GuiSelectWorld.this.field_146641_z.enabled = var5;
+            GuiSelectWorld.this.field_146642_y.enabled = var5;
+            GuiSelectWorld.this.field_146630_A.enabled = var5;
+            GuiSelectWorld.this.field_146631_B.enabled = var5;
+
+            if (isDoubleClick && var5)
+            {
+                GuiSelectWorld.this.func_146615_e(slotIndex);
+            }
+        }
+
+        protected boolean isSelected(int slotIndex)
+        {
+            return slotIndex == GuiSelectWorld.this.field_146640_r;
+        }
+
+        protected int getContentHeight()
+        {
+            return GuiSelectWorld.this.field_146639_s.size() * 36;
+        }
+
+        protected void drawBackground()
+        {
+            GuiSelectWorld.this.drawDefaultBackground();
+        }
+
+        protected void drawSlot(int p_180791_1_, int p_180791_2_, int p_180791_3_, int p_180791_4_, int p_180791_5_, int p_180791_6_)
+        {
+            SaveFormatComparator var7 = (SaveFormatComparator)GuiSelectWorld.this.field_146639_s.get(p_180791_1_);
+            String var8 = var7.getDisplayName();
+
+            if (StringUtils.isEmpty(var8))
+            {
+                var8 = GuiSelectWorld.this.field_146637_u + " " + (p_180791_1_ + 1);
+            }
+
+            String var9 = var7.getFileName();
+            var9 = var9 + " (" + GuiSelectWorld.this.field_146633_h.format(new Date(var7.getLastTimePlayed()));
+            var9 = var9 + ")";
+            String var10 = "";
+
+            if (var7.requiresConversion())
+            {
+                var10 = GuiSelectWorld.this.field_146636_v + " " + var10;
+            }
+            else
+            {
+                var10 = GuiSelectWorld.this.field_146635_w[var7.getEnumGameType().getID()];
+
+                if (var7.isHardcoreModeEnabled())
+                {
+                    var10 = EnumChatFormatting.DARK_RED + I18n.format("gameMode.hardcore", new Object[0]) + EnumChatFormatting.RESET;
+                }
+
+                if (var7.getCheatsEnabled())
+                {
+                    var10 = var10 + ", " + I18n.format("selectWorld.cheats", new Object[0]);
+                }
+            }
+
+            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var8, p_180791_2_ + 2, p_180791_3_ + 1, 16777215);
+            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var9, p_180791_2_ + 2, p_180791_3_ + 12, 8421504);
+            GuiSelectWorld.this.drawString(GuiSelectWorld.this.fontRendererObj, var10, p_180791_2_ + 2, p_180791_3_ + 12 + 10, 8421504);
+        }
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiShareToLan.java b/src/net/minecraft/client/gui/GuiShareToLan.java
index 9e7abdc..13a0ef5 100644
--- a/src/net/minecraft/client/gui/GuiShareToLan.java
+++ b/src/net/minecraft/client/gui/GuiShareToLan.java
@@ -1,113 +1,118 @@
-package net.minecraft.client.gui;
-
-import java.io.IOException;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.ChatComponentTranslation;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.world.WorldSettings;
-
-public class GuiShareToLan extends GuiScreen
-{
-    private final GuiScreen field_146598_a;
-    private GuiButton field_146596_f;
-    private GuiButton field_146597_g;
-    private String field_146599_h = "survival";
-    private boolean field_146600_i;
-    private static final String __OBFID = "CL_00000713";
-
-    public GuiShareToLan(GuiScreen p_i1055_1_)
-    {
-        this.field_146598_a = p_i1055_1_;
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.buttonList.clear();
-        this.buttonList.add(new GuiButton(101, this.width / 2 - 155, this.height - 28, 150, 20, I18n.format("lanServer.start", new Object[0])));
-        this.buttonList.add(new GuiButton(102, this.width / 2 + 5, this.height - 28, 150, 20, I18n.format("gui.cancel", new Object[0])));
-        this.buttonList.add(this.field_146597_g = new GuiButton(104, this.width / 2 - 155, 100, 150, 20, I18n.format("selectWorld.gameMode", new Object[0])));
-        this.buttonList.add(this.field_146596_f = new GuiButton(103, this.width / 2 + 5, 100, 150, 20, I18n.format("selectWorld.allowCommands", new Object[0])));
-        this.func_146595_g();
-    }
-
-    private void func_146595_g()
-    {
-        this.field_146597_g.displayString = I18n.format("selectWorld.gameMode", new Object[0]) + " " + I18n.format("selectWorld.gameMode." + this.field_146599_h, new Object[0]);
-        this.field_146596_f.displayString = I18n.format("selectWorld.allowCommands", new Object[0]) + " ";
-
-        if (this.field_146600_i)
-        {
-            this.field_146596_f.displayString = this.field_146596_f.displayString + I18n.format("options.on", new Object[0]);
-        }
-        else
-        {
-            this.field_146596_f.displayString = this.field_146596_f.displayString + I18n.format("options.off", new Object[0]);
-        }
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.id == 102)
-        {
-            this.mc.displayGuiScreen(this.field_146598_a);
-        }
-        else if (button.id == 104)
-        {
-            if (this.field_146599_h.equals("spectator"))
-            {
-                this.field_146599_h = "creative";
-            }
-            else if (this.field_146599_h.equals("creative"))
-            {
-                this.field_146599_h = "adventure";
-            }
-            else if (this.field_146599_h.equals("adventure"))
-            {
-                this.field_146599_h = "survival";
-            }
-            else
-            {
-                this.field_146599_h = "spectator";
-            }
-
-            this.func_146595_g();
-        }
-        else if (button.id == 103)
-        {
-            this.field_146600_i = !this.field_146600_i;
-            this.func_146595_g();
-        }
-        else if (button.id == 101)
-        {
-            this.mc.displayGuiScreen((GuiScreen)null);
-            String var2 = this.mc.getIntegratedServer().shareToLAN(WorldSettings.GameType.getByName(this.field_146599_h), this.field_146600_i);
-            Object var3;
-
-            if (var2 != null)
-            {
-                var3 = new ChatComponentTranslation("commands.publish.started", new Object[] {var2});
-            }
-            else
-            {
-                var3 = new ChatComponentText("commands.publish.failed");
-            }
-
-            this.mc.ingameGUI.getChatGUI().printChatMessage((IChatComponent)var3);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawDefaultBackground();
-        this.drawCenteredString(this.fontRendererObj, I18n.format("lanServer.title", new Object[0]), this.width / 2, 50, 16777215);
-        this.drawCenteredString(this.fontRendererObj, I18n.format("lanServer.otherPlayers", new Object[0]), this.width / 2, 82, 16777215);
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-}
+package net.minecraft.client.gui;
+
+import java.io.IOException;
+
+import tk.wurst_client.WurstClient;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.util.ChatComponentText;
+import net.minecraft.util.ChatComponentTranslation;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.world.WorldSettings;
+
+public class GuiShareToLan extends GuiScreen
+{
+    private final GuiScreen field_146598_a;
+    private GuiButton field_146596_f;
+    private GuiButton field_146597_g;
+    private String field_146599_h = "survival";
+    private boolean field_146600_i;
+    private static final String __OBFID = "CL_00000713";
+
+    public GuiShareToLan(GuiScreen p_i1055_1_)
+    {
+        this.field_146598_a = p_i1055_1_;
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+        this.buttonList.clear();
+        this.buttonList.add(new GuiButton(101, this.width / 2 - 155, this.height - 28, 150, 20, I18n.format("lanServer.start", new Object[0])));
+        this.buttonList.add(new GuiButton(102, this.width / 2 + 5, this.height - 28, 150, 20, I18n.format("gui.cancel", new Object[0])));
+        this.buttonList.add(this.field_146597_g = new GuiButton(104, this.width / 2 - 155, 100, 150, 20, I18n.format("selectWorld.gameMode", new Object[0])));
+        this.buttonList.add(this.field_146596_f = new GuiButton(103, this.width / 2 + 5, 100, 150, 20, I18n.format("selectWorld.allowCommands", new Object[0])));
+        this.func_146595_g();
+    }
+
+    private void func_146595_g()
+    {
+        this.field_146597_g.displayString = I18n.format("selectWorld.gameMode", new Object[0]) + " " + I18n.format("selectWorld.gameMode." + this.field_146599_h, new Object[0]);
+        this.field_146596_f.displayString = I18n.format("selectWorld.allowCommands", new Object[0]) + " ";
+
+        if (this.field_146600_i)
+        {
+            this.field_146596_f.displayString = this.field_146596_f.displayString + I18n.format("options.on", new Object[0]);
+        }
+        else
+        {
+            this.field_146596_f.displayString = this.field_146596_f.displayString + I18n.format("options.off", new Object[0]);
+        }
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.id == 102)
+        {
+            this.mc.displayGuiScreen(this.field_146598_a);
+        }
+        else if (button.id == 104)
+        {
+            if (this.field_146599_h.equals("spectator"))
+            {
+                this.field_146599_h = "creative";
+            }
+            else if (this.field_146599_h.equals("creative"))
+            {
+                this.field_146599_h = "adventure";
+            }
+            else if (this.field_146599_h.equals("adventure"))
+            {
+                this.field_146599_h = "survival";
+            }
+            else
+            {
+                this.field_146599_h = "spectator";
+            }
+
+            this.func_146595_g();
+        }
+        else if (button.id == 103)
+        {
+            this.field_146600_i = !this.field_146600_i;
+            this.func_146595_g();
+        }
+        else if (button.id == 101)
+        {
+            this.mc.displayGuiScreen((GuiScreen)null);
+            String var2 = this.mc.getIntegratedServer().shareToLAN(WorldSettings.GameType.getByName(this.field_146599_h), this.field_146600_i);
+            Object var3;
+
+            if (var2 != null)
+            {
+                var3 = new ChatComponentTranslation("commands.publish.started", new Object[] {var2});
+                //TODO: Client
+                WurstClient.INSTANCE.currentServerIP = WurstClient.INSTANCE.currentServerIP.split(":")[0].concat(":" + var2);
+            }
+            else
+            {
+                var3 = new ChatComponentText("commands.publish.failed");
+            }
+
+            this.mc.ingameGUI.getChatGUI().printChatMessage((IChatComponent)var3);
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawDefaultBackground();
+        this.drawCenteredString(this.fontRendererObj, I18n.format("lanServer.title", new Object[0]), this.width / 2, 50, 16777215);
+        this.drawCenteredString(this.fontRendererObj, I18n.format("lanServer.otherPlayers", new Object[0]), this.width / 2, 82, 16777215);
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+}
diff --git a/src/net/minecraft/client/gui/GuiSimpleScrolledSelectionListProxy.java b/src/net/minecraft/client/gui/GuiSimpleScrolledSelectionListProxy.java
index 4566817..6798a27 100644
--- a/src/net/minecraft/client/gui/GuiSimpleScrolledSelectionListProxy.java
+++ b/src/net/minecraft/client/gui/GuiSimpleScrolledSelectionListProxy.java
@@ -128,21 +128,21 @@ public class GuiSimpleScrolledSelectionListProxy extends GuiSlot
                 }
 
                 var7.startDrawingQuads();
-                var7.func_178974_a(0, 255);
+                var7.setColorRGBA_I(0, 255);
                 var7.addVertexWithUV((double)var4, (double)this.bottom, 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)this.bottom, 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)this.top, 0.0D, 1.0D, 0.0D);
                 var7.addVertexWithUV((double)var4, (double)this.top, 0.0D, 0.0D, 0.0D);
                 var6.draw();
                 var7.startDrawingQuads();
-                var7.func_178974_a(8421504, 255);
+                var7.setColorRGBA_I(8421504, 255);
                 var7.addVertexWithUV((double)var4, (double)(var13 + var12), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)(var13 + var12), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)var13, 0.0D, 1.0D, 0.0D);
                 var7.addVertexWithUV((double)var4, (double)var13, 0.0D, 0.0D, 0.0D);
                 var6.draw();
                 var7.startDrawingQuads();
-                var7.func_178974_a(12632256, 255);
+                var7.setColorRGBA_I(12632256, 255);
                 var7.addVertexWithUV((double)var4, (double)(var13 + var12 - 1), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)(var5 - 1), (double)(var13 + var12 - 1), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)(var5 - 1), (double)var13, 0.0D, 1.0D, 0.0D);
diff --git a/src/net/minecraft/client/gui/GuiSleepMP.java b/src/net/minecraft/client/gui/GuiSleepMP.java
index 3a117a3..1fed6a6 100644
--- a/src/net/minecraft/client/gui/GuiSleepMP.java
+++ b/src/net/minecraft/client/gui/GuiSleepMP.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.network.NetHandlerPlayClient;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.network.play.client.C0BPacketEntityAction;
diff --git a/src/net/minecraft/client/gui/GuiSlider.java b/src/net/minecraft/client/gui/GuiSlider.java
index 1a0f324..6feaf04 100644
--- a/src/net/minecraft/client/gui/GuiSlider.java
+++ b/src/net/minecraft/client/gui/GuiSlider.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.resources.I18n;
 
diff --git a/src/net/minecraft/client/gui/GuiSlot.java b/src/net/minecraft/client/gui/GuiSlot.java
index 0220892..bc3ab20 100644
--- a/src/net/minecraft/client/gui/GuiSlot.java
+++ b/src/net/minecraft/client/gui/GuiSlot.java
@@ -1,10 +1,12 @@
 package net.minecraft.client.gui;
 
 import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.Tessellator;
 import net.minecraft.client.renderer.WorldRenderer;
 import net.minecraft.util.MathHelper;
+
 import org.lwjgl.input.Mouse;
 
 public abstract class GuiSlot
@@ -241,7 +243,7 @@ public abstract class GuiSlot
             GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
             float var8 = 32.0F;
             var7.startDrawingQuads();
-            var7.func_178991_c(2105376);
+            var7.setColorOpaque_I(2105376);
             var7.addVertexWithUV((double)this.left, (double)this.bottom, 0.0D, (double)((float)this.left / var8), (double)((float)(this.bottom + (int)this.amountScrolled) / var8));
             var7.addVertexWithUV((double)this.right, (double)this.bottom, 0.0D, (double)((float)this.right / var8), (double)((float)(this.bottom + (int)this.amountScrolled) / var8));
             var7.addVertexWithUV((double)this.right, (double)this.top, 0.0D, (double)((float)this.right / var8), (double)((float)(this.top + (int)this.amountScrolled) / var8));
@@ -266,18 +268,18 @@ public abstract class GuiSlot
             GlStateManager.shadeModel(7425);
             GlStateManager.func_179090_x();
             var7.startDrawingQuads();
-            var7.func_178974_a(0, 0);
+            var7.setColorRGBA_I(0, 0);
             var7.addVertexWithUV((double)this.left, (double)(this.top + var11), 0.0D, 0.0D, 1.0D);
             var7.addVertexWithUV((double)this.right, (double)(this.top + var11), 0.0D, 1.0D, 1.0D);
-            var7.func_178974_a(0, 255);
+            var7.setColorRGBA_I(0, 255);
             var7.addVertexWithUV((double)this.right, (double)this.top, 0.0D, 1.0D, 0.0D);
             var7.addVertexWithUV((double)this.left, (double)this.top, 0.0D, 0.0D, 0.0D);
             var6.draw();
             var7.startDrawingQuads();
-            var7.func_178974_a(0, 255);
+            var7.setColorRGBA_I(0, 255);
             var7.addVertexWithUV((double)this.left, (double)this.bottom, 0.0D, 0.0D, 1.0D);
             var7.addVertexWithUV((double)this.right, (double)this.bottom, 0.0D, 1.0D, 1.0D);
-            var7.func_178974_a(0, 0);
+            var7.setColorRGBA_I(0, 0);
             var7.addVertexWithUV((double)this.right, (double)(this.bottom - var11), 0.0D, 1.0D, 0.0D);
             var7.addVertexWithUV((double)this.left, (double)(this.bottom - var11), 0.0D, 0.0D, 0.0D);
             var6.draw();
@@ -295,21 +297,21 @@ public abstract class GuiSlot
                 }
 
                 var7.startDrawingQuads();
-                var7.func_178974_a(0, 255);
+                var7.setColorRGBA_I(0, 255);
                 var7.addVertexWithUV((double)var4, (double)this.bottom, 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)this.bottom, 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)this.top, 0.0D, 1.0D, 0.0D);
                 var7.addVertexWithUV((double)var4, (double)this.top, 0.0D, 0.0D, 0.0D);
                 var6.draw();
                 var7.startDrawingQuads();
-                var7.func_178974_a(8421504, 255);
+                var7.setColorRGBA_I(8421504, 255);
                 var7.addVertexWithUV((double)var4, (double)(var14 + var13), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)(var14 + var13), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)var5, (double)var14, 0.0D, 1.0D, 0.0D);
                 var7.addVertexWithUV((double)var4, (double)var14, 0.0D, 0.0D, 0.0D);
                 var6.draw();
                 var7.startDrawingQuads();
-                var7.func_178974_a(12632256, 255);
+                var7.setColorRGBA_I(12632256, 255);
                 var7.addVertexWithUV((double)var4, (double)(var14 + var13 - 1), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)(var5 - 1), (double)(var14 + var13 - 1), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)(var5 - 1), (double)var14, 0.0D, 1.0D, 0.0D);
@@ -464,12 +466,12 @@ public abstract class GuiSlot
                 GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
                 GlStateManager.func_179090_x();
                 var7.startDrawingQuads();
-                var7.func_178991_c(8421504);
+                var7.setColorOpaque_I(8421504);
                 var7.addVertexWithUV((double)var11, (double)(var9 + var10 + 2), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)var12, (double)(var9 + var10 + 2), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)var12, (double)(var9 - 2), 0.0D, 1.0D, 0.0D);
                 var7.addVertexWithUV((double)var11, (double)(var9 - 2), 0.0D, 0.0D, 0.0D);
-                var7.func_178991_c(0);
+                var7.setColorOpaque_I(0);
                 var7.addVertexWithUV((double)(var11 + 1), (double)(var9 + var10 + 1), 0.0D, 0.0D, 1.0D);
                 var7.addVertexWithUV((double)(var12 - 1), (double)(var9 + var10 + 1), 0.0D, 1.0D, 1.0D);
                 var7.addVertexWithUV((double)(var12 - 1), (double)(var9 - 1), 0.0D, 1.0D, 0.0D);
@@ -498,10 +500,10 @@ public abstract class GuiSlot
         GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
         float var7 = 32.0F;
         var6.startDrawingQuads();
-        var6.func_178974_a(4210752, p_148136_4_);
+        var6.setColorRGBA_I(4210752, p_148136_4_);
         var6.addVertexWithUV((double)this.left, (double)p_148136_2_, 0.0D, 0.0D, (double)((float)p_148136_2_ / var7));
         var6.addVertexWithUV((double)(this.left + this.width), (double)p_148136_2_, 0.0D, (double)((float)this.width / var7), (double)((float)p_148136_2_ / var7));
-        var6.func_178974_a(4210752, p_148136_3_);
+        var6.setColorRGBA_I(4210752, p_148136_3_);
         var6.addVertexWithUV((double)(this.left + this.width), (double)p_148136_1_, 0.0D, (double)((float)this.width / var7), (double)((float)p_148136_1_ / var7));
         var6.addVertexWithUV((double)this.left, (double)p_148136_1_, 0.0D, 0.0D, (double)((float)p_148136_1_ / var7));
         var5.draw();
diff --git a/src/net/minecraft/client/gui/GuiSnooper.java b/src/net/minecraft/client/gui/GuiSnooper.java
index 78acac1..05a0ce4 100644
--- a/src/net/minecraft/client/gui/GuiSnooper.java
+++ b/src/net/minecraft/client/gui/GuiSnooper.java
@@ -1,11 +1,14 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.TreeMap;
 import java.util.Map.Entry;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
 
diff --git a/src/net/minecraft/client/gui/GuiSpectator.java b/src/net/minecraft/client/gui/GuiSpectator.java
index a925cbe..aec3e44 100644
--- a/src/net/minecraft/client/gui/GuiSpectator.java
+++ b/src/net/minecraft/client/gui/GuiSpectator.java
@@ -111,7 +111,7 @@ public class GuiSpectator extends Gui implements ISpectatorMenuReciepient
 
             if (var6 > 3 && p_175266_5_.func_178662_A_())
             {
-                this.field_175268_g.fontRendererObj.func_175063_a(var8, (float)(p_175266_2_ + 19 - 2 - this.field_175268_g.fontRendererObj.getStringWidth(var8)), p_175266_3_ + 6.0F + 3.0F, 16777215 + (var6 << 24));
+                this.field_175268_g.fontRendererObj.drawStringWithShadow(var8, (float)(p_175266_2_ + 19 - 2 - this.field_175268_g.fontRendererObj.getStringWidth(var8)), p_175266_3_ + 6.0F + 3.0F, 16777215 + (var6 << 24));
             }
         }
     }
@@ -132,7 +132,7 @@ public class GuiSpectator extends Gui implements ISpectatorMenuReciepient
                 GlStateManager.pushMatrix();
                 GlStateManager.enableBlend();
                 GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                this.field_175268_g.fontRendererObj.func_175063_a(var4, (float)var5, (float)var6, 16777215 + (var2 << 24));
+                this.field_175268_g.fontRendererObj.drawStringWithShadow(var4, (float)var5, (float)var6, 16777215 + (var2 << 24));
                 GlStateManager.disableBlend();
                 GlStateManager.popMatrix();
             }
diff --git a/src/net/minecraft/client/gui/GuiTextField.java b/src/net/minecraft/client/gui/GuiTextField.java
index 04144e8..5d721ef 100644
--- a/src/net/minecraft/client/gui/GuiTextField.java
+++ b/src/net/minecraft/client/gui/GuiTextField.java
@@ -549,7 +549,7 @@ public class GuiTextField extends Gui
             if (var4.length() > 0)
             {
                 String var10 = var5 ? var4.substring(0, var2) : var4;
-                var9 = this.fontRendererInstance.func_175063_a(var10, (float)var7, (float)var8, var1);
+                var9 = this.fontRendererInstance.drawStringWithShadow(var10, (float)var7, (float)var8, var1);
             }
 
             boolean var13 = this.cursorPosition < this.text.length() || this.text.length() >= this.getMaxStringLength();
@@ -567,7 +567,7 @@ public class GuiTextField extends Gui
 
             if (var4.length() > 0 && var5 && var2 < var4.length())
             {
-                var9 = this.fontRendererInstance.func_175063_a(var4.substring(var2), (float)var9, (float)var8, var1);
+                var9 = this.fontRendererInstance.drawStringWithShadow(var4.substring(var2), (float)var9, (float)var8, var1);
             }
 
             if (var6)
@@ -578,7 +578,7 @@ public class GuiTextField extends Gui
                 }
                 else
                 {
-                    this.fontRendererInstance.func_175063_a("_", (float)var11, (float)var8, var1);
+                    this.fontRendererInstance.drawStringWithShadow("_", (float)var11, (float)var8, var1);
                 }
             }
 
diff --git a/src/net/minecraft/client/gui/GuiVideoSettings.java b/src/net/minecraft/client/gui/GuiVideoSettings.java
index 5c2d5b1..33507fc 100644
--- a/src/net/minecraft/client/gui/GuiVideoSettings.java
+++ b/src/net/minecraft/client/gui/GuiVideoSettings.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.renderer.OpenGlHelper;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
diff --git a/src/net/minecraft/client/gui/GuiWinGame.java b/src/net/minecraft/client/gui/GuiWinGame.java
index 28cacd3..448f3f2 100644
--- a/src/net/minecraft/client/gui/GuiWinGame.java
+++ b/src/net/minecraft/client/gui/GuiWinGame.java
@@ -131,7 +131,7 @@ public class GuiWinGame extends GuiScreen
         WorldRenderer var5 = var4.getWorldRenderer();
         this.mc.getTextureManager().bindTexture(Gui.optionsBackground);
         var5.startDrawingQuads();
-        var5.func_178960_a(1.0F, 1.0F, 1.0F, 1.0F);
+        var5.setColorRGBA_F(1.0F, 1.0F, 1.0F, 1.0F);
         int var6 = this.width;
         float var7 = 0.0F - ((float)this.field_146581_h + p_146575_3_) * 0.5F * this.field_146578_s;
         float var8 = (float)this.height - ((float)this.field_146581_h + p_146575_3_) * 0.5F * this.field_146578_s;
@@ -152,7 +152,7 @@ public class GuiWinGame extends GuiScreen
 
         var10 *= var10;
         var10 = var10 * 96.0F / 255.0F;
-        var5.func_178986_b(var10, var10, var10);
+        var5.setColorOpaque_F(var10, var10, var10);
         var5.addVertexWithUV(0.0D, (double)this.height, (double)this.zLevel, 0.0D, (double)(var7 * var9));
         var5.addVertexWithUV((double)var6, (double)this.height, (double)this.zLevel, (double)((float)var6 * var9), (double)(var7 * var9));
         var5.addVertexWithUV((double)var6, 0.0D, (double)this.zLevel, (double)((float)var6 * var9), (double)(var8 * var9));
@@ -178,7 +178,7 @@ public class GuiWinGame extends GuiScreen
         GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
         this.drawTexturedModalRect(var7, var8, 0, 0, 155, 44);
         this.drawTexturedModalRect(var7 + 155, var8, 0, 45, 155, 44);
-        var5.func_178991_c(16777215);
+        var5.setColorOpaque_I(16777215);
         int var10 = var8 + 200;
         int var11;
 
@@ -200,12 +200,12 @@ public class GuiWinGame extends GuiScreen
 
                 if (var13.startsWith("[C]"))
                 {
-                    this.fontRendererObj.func_175063_a(var13.substring(3), (float)(var7 + (var6 - this.fontRendererObj.getStringWidth(var13.substring(3))) / 2), (float)var10, 16777215);
+                    this.fontRendererObj.drawStringWithShadow(var13.substring(3), (float)(var7 + (var6 - this.fontRendererObj.getStringWidth(var13.substring(3))) / 2), (float)var10, 16777215);
                 }
                 else
                 {
                     this.fontRendererObj.fontRandom.setSeed((long)var11 * 4238972211L + (long)(this.field_146581_h / 4));
-                    this.fontRendererObj.func_175063_a(var13, (float)var7, (float)var10, 16777215);
+                    this.fontRendererObj.drawStringWithShadow(var13, (float)var7, (float)var10, 16777215);
                 }
             }
 
@@ -217,7 +217,7 @@ public class GuiWinGame extends GuiScreen
         GlStateManager.enableBlend();
         GlStateManager.blendFunc(0, 769);
         var5.startDrawingQuads();
-        var5.func_178960_a(1.0F, 1.0F, 1.0F, 1.0F);
+        var5.setColorRGBA_F(1.0F, 1.0F, 1.0F, 1.0F);
         var11 = this.width;
         int var14 = this.height;
         var5.addVertexWithUV(0.0D, (double)var14, (double)this.zLevel, 0.0D, 1.0D);
diff --git a/src/net/minecraft/client/gui/GuiYesNo.java b/src/net/minecraft/client/gui/GuiYesNo.java
index a6aafc7..79fe27f 100644
--- a/src/net/minecraft/client/gui/GuiYesNo.java
+++ b/src/net/minecraft/client/gui/GuiYesNo.java
@@ -1,9 +1,12 @@
 package net.minecraft.client.gui;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.Iterator;
 import java.util.List;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 
 public class GuiYesNo extends GuiScreen
diff --git a/src/net/minecraft/client/gui/ScreenChatOptions.java b/src/net/minecraft/client/gui/ScreenChatOptions.java
index 711f2dc..0124bb4 100644
--- a/src/net/minecraft/client/gui/ScreenChatOptions.java
+++ b/src/net/minecraft/client/gui/ScreenChatOptions.java
@@ -1,6 +1,8 @@
 package net.minecraft.client.gui;
 
 import java.io.IOException;
+
+import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.resources.I18n;
 import net.minecraft.client.settings.GameSettings;
 
diff --git a/src/net/minecraft/client/gui/ServerSelectionList.java b/src/net/minecraft/client/gui/ServerSelectionList.java
index 86db79f..268883b 100644
--- a/src/net/minecraft/client/gui/ServerSelectionList.java
+++ b/src/net/minecraft/client/gui/ServerSelectionList.java
@@ -13,7 +13,7 @@ public class ServerSelectionList extends GuiListExtended
     private final List field_148198_l = Lists.newArrayList();
     private final List field_148199_m = Lists.newArrayList();
     private final GuiListExtended.IGuiListEntry lanScanEntry = new ServerListEntryLanScan();
-    private int field_148197_o = -1;
+    private int selectedServer = -1;
     private static final String __OBFID = "CL_00000819";
 
     public ServerSelectionList(GuiMultiplayer p_i45049_1_, Minecraft mcIn, int p_i45049_3_, int p_i45049_4_, int p_i45049_5_, int p_i45049_6_, int p_i45049_7_)
@@ -52,9 +52,10 @@ public class ServerSelectionList extends GuiListExtended
         return this.field_148198_l.size() + 1 + this.field_148199_m.size();
     }
 
-    public void func_148192_c(int p_148192_1_)
+    //TODO: Client
+    public void setSelectedServer(int selected)
     {
-        this.field_148197_o = p_148192_1_;
+        this.selectedServer = selected;
     }
 
     /**
@@ -62,12 +63,12 @@ public class ServerSelectionList extends GuiListExtended
      */
     protected boolean isSelected(int slotIndex)
     {
-        return slotIndex == this.field_148197_o;
+        return slotIndex == this.selectedServer;
     }
 
-    public int func_148193_k()
+    public int getSelectedServer()
     {
-        return this.field_148197_o;
+        return this.selectedServer;
     }
 
     public void func_148195_a(ServerList p_148195_1_)
diff --git a/src/net/minecraft/client/gui/achievement/GuiAchievements.java b/src/net/minecraft/client/gui/achievement/GuiAchievements.java
index 7b40c1c..0bf8d69 100644
--- a/src/net/minecraft/client/gui/achievement/GuiAchievements.java
+++ b/src/net/minecraft/client/gui/achievement/GuiAchievements.java
@@ -2,6 +2,7 @@ package net.minecraft.client.gui.achievement;
 
 import java.io.IOException;
 import java.util.Random;
+
 import net.minecraft.block.Block;
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
@@ -21,6 +22,7 @@ import net.minecraft.stats.StatFileWriter;
 import net.minecraft.util.ChatComponentTranslation;
 import net.minecraft.util.MathHelper;
 import net.minecraft.util.ResourceLocation;
+
 import org.lwjgl.input.Mouse;
 
 public class GuiAchievements extends GuiScreen implements IProgressMeter
@@ -526,7 +528,7 @@ public class GuiAchievements extends GuiScreen implements IProgressMeter
 
                 if (this.statFileWriter.hasAchievementUnlocked(var33))
                 {
-                    this.fontRendererObj.func_175063_a(I18n.format("achievement.taken", new Object[0]), (float)var40, (float)(var41 + var31 + 4), -7302913);
+                    this.fontRendererObj.drawStringWithShadow(I18n.format("achievement.taken", new Object[0]), (float)var40, (float)(var41 + var31 + 4), -7302913);
                 }
             }
             else
@@ -559,7 +561,7 @@ public class GuiAchievements extends GuiScreen implements IProgressMeter
 
             if (var36 != null)
             {
-                this.fontRendererObj.func_175063_a(var36, (float)var40, (float)var41, this.statFileWriter.canUnlockAchievement(var33) ? (var33.getSpecial() ? -128 : -1) : (var33.getSpecial() ? -8355776 : -8355712));
+                this.fontRendererObj.drawStringWithShadow(var36, (float)var40, (float)var41, this.statFileWriter.canUnlockAchievement(var33) ? (var33.getSpecial() ? -128 : -1) : (var33.getSpecial() ? -8355776 : -8355712));
             }
         }
 
diff --git a/src/net/minecraft/client/gui/achievement/GuiStats.java b/src/net/minecraft/client/gui/achievement/GuiStats.java
index 8b2fcfb..cf60fee 100644
--- a/src/net/minecraft/client/gui/achievement/GuiStats.java
+++ b/src/net/minecraft/client/gui/achievement/GuiStats.java
@@ -1,11 +1,13 @@
 package net.minecraft.client.gui.achievement;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.Collections;
 import java.util.Comparator;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.audio.PositionedSoundRecord;
 import net.minecraft.client.gui.GuiButton;
@@ -26,6 +28,7 @@ import net.minecraft.stats.StatCrafting;
 import net.minecraft.stats.StatFileWriter;
 import net.minecraft.stats.StatList;
 import net.minecraft.util.ResourceLocation;
+
 import org.lwjgl.input.Mouse;
 
 public class GuiStats extends GuiScreen implements IProgressMeter
@@ -185,7 +188,7 @@ public class GuiStats extends GuiScreen implements IProgressMeter
         this.drawButtonBackground(p_146521_1_ + 1, p_146521_2_ + 1);
         GlStateManager.enableRescaleNormal();
         RenderHelper.enableGUIStandardItemLighting();
-        this.itemRender.func_175042_a(new ItemStack(p_146521_3_, 1, 0), p_146521_1_ + 2, p_146521_2_ + 2);
+        this.itemRender.func_180450_b(new ItemStack(p_146521_3_, 1, 0), p_146521_1_ + 2, p_146521_2_ + 2);
         RenderHelper.disableStandardItemLighting();
         GlStateManager.disableRescaleNormal();
     }
@@ -403,7 +406,7 @@ public class GuiStats extends GuiScreen implements IProgressMeter
                         int var7 = p_148142_2_ - 12;
                         int var8 = GuiStats.this.fontRendererObj.getStringWidth(var9);
                         GuiStats.this.drawGradientRect(var6 - 3, var7 - 3, var6 + var8 + 3, var7 + 8 + 3, -1073741824, -1073741824);
-                        GuiStats.this.fontRendererObj.func_175063_a(var9, (float)var6, (float)var7, -1);
+                        GuiStats.this.fontRendererObj.drawStringWithShadow(var9, (float)var6, (float)var7, -1);
                     }
                 }
             }
@@ -424,7 +427,7 @@ public class GuiStats extends GuiScreen implements IProgressMeter
                     int var9 = p_148213_3_ - 12;
                     int var10 = GuiStats.this.fontRendererObj.getStringWidth(var7);
                     GuiStats.this.drawGradientRect(var8 - 3, var9 - 3, var8 + var10 + 3, var9 + 8 + 3, -1073741824, -1073741824);
-                    GuiStats.this.fontRendererObj.func_175063_a(var7, (float)var8, (float)var9, -1);
+                    GuiStats.this.fontRendererObj.drawStringWithShadow(var7, (float)var8, (float)var9, -1);
                 }
             }
         }
diff --git a/src/net/minecraft/client/gui/inventory/GuiBeacon.java b/src/net/minecraft/client/gui/inventory/GuiBeacon.java
index ba125d8..4c3f8fd 100644
--- a/src/net/minecraft/client/gui/inventory/GuiBeacon.java
+++ b/src/net/minecraft/client/gui/inventory/GuiBeacon.java
@@ -1,8 +1,10 @@
 package net.minecraft.client.gui.inventory;
 
 import io.netty.buffer.Unpooled;
+
 import java.io.IOException;
 import java.util.Iterator;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiScreen;
@@ -19,6 +21,7 @@ import net.minecraft.network.play.client.C17PacketCustomPayload;
 import net.minecraft.potion.Potion;
 import net.minecraft.tileentity.TileEntityBeacon;
 import net.minecraft.util.ResourceLocation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/gui/inventory/GuiChest.java b/src/net/minecraft/client/gui/inventory/GuiChest.java
index 93156ec..217e755 100644
--- a/src/net/minecraft/client/gui/inventory/GuiChest.java
+++ b/src/net/minecraft/client/gui/inventory/GuiChest.java
@@ -1,54 +1,138 @@
-package net.minecraft.client.gui.inventory;
-
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.inventory.ContainerChest;
-import net.minecraft.inventory.IInventory;
-import net.minecraft.util.ResourceLocation;
-
-public class GuiChest extends GuiContainer
-{
-    private static final ResourceLocation field_147017_u = new ResourceLocation("textures/gui/container/generic_54.png");
-    private IInventory upperChestInventory;
-    private IInventory lowerChestInventory;
-
-    /**
-     * window height is calculated with these values; the more rows, the heigher
-     */
-    private int inventoryRows;
-    private static final String __OBFID = "CL_00000749";
-
-    public GuiChest(IInventory p_i46315_1_, IInventory p_i46315_2_)
-    {
-        super(new ContainerChest(p_i46315_1_, p_i46315_2_, Minecraft.getMinecraft().thePlayer));
-        this.upperChestInventory = p_i46315_1_;
-        this.lowerChestInventory = p_i46315_2_;
-        this.allowUserInput = false;
-        short var3 = 222;
-        int var4 = var3 - 108;
-        this.inventoryRows = p_i46315_2_.getSizeInventory() / 9;
-        this.ySize = var4 + this.inventoryRows * 18;
-    }
-
-    /**
-     * Draw the foreground layer for the GuiContainer (everything in front of the items). Args : mouseX, mouseY
-     */
-    protected void drawGuiContainerForegroundLayer(int mouseX, int mouseY)
-    {
-        this.fontRendererObj.drawString(this.lowerChestInventory.getDisplayName().getUnformattedText(), 8, 6, 4210752);
-        this.fontRendererObj.drawString(this.upperChestInventory.getDisplayName().getUnformattedText(), 8, this.ySize - 96 + 2, 4210752);
-    }
-
-    /**
-     * Args : renderPartialTicks, mouseX, mouseY
-     */
-    protected void drawGuiContainerBackgroundLayer(float partialTicks, int mouseX, int mouseY)
-    {
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        this.mc.getTextureManager().bindTexture(field_147017_u);
-        int var4 = (this.width - this.xSize) / 2;
-        int var5 = (this.height - this.ySize) / 2;
-        this.drawTexturedModalRect(var4, var5, 0, 0, this.xSize, this.inventoryRows * 18 + 17);
-        this.drawTexturedModalRect(var4, var5 + this.inventoryRows * 18 + 17, 0, 126, this.xSize, 96);
-    }
-}
+package net.minecraft.client.gui.inventory;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.gui.inventory.GuiContainer;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.inventory.ContainerChest;
+import net.minecraft.inventory.IInventory;
+import net.minecraft.inventory.Slot;
+import net.minecraft.util.ResourceLocation;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.AutoStealMod;
+import tk.wurst_client.mods.YesCheatMod;
+
+public class GuiChest extends GuiContainer
+{
+    private static final String __OBFID = "CL_00000749";
+	private static final ResourceLocation field_147017_u = new ResourceLocation("textures/gui/container/generic_54.png");
+	private IInventory upperChestInventory;
+	private IInventory lowerChestInventory;
+
+	/**
+	 * window height is calculated with these values; the more rows, the higher
+	 */
+	private int inventoryRows;
+
+	public GuiChest(IInventory p_i46315_1_, IInventory p_i46315_2_)
+	{
+		super(new ContainerChest(p_i46315_1_, p_i46315_2_, Minecraft.getMinecraft().thePlayer));
+		upperChestInventory = p_i46315_1_;
+		lowerChestInventory = p_i46315_2_;
+		allowUserInput = false;
+		short var3 = 222;
+		int var4 = var3 - 108;
+		inventoryRows = p_i46315_2_.getSizeInventory() / 9;
+		ySize = var4 + inventoryRows * 18;
+	}
+
+	//TODO: Client
+	@SuppressWarnings("unchecked")
+	@Override
+	public void initGui()
+	{
+		super.initGui();
+		buttonList.add(new GuiButton(0, guiLeft + xSize - 108, guiTop + 4, 50, 12, "Steal"));
+		buttonList.add(new GuiButton(1, guiLeft + xSize - 56, guiTop + 4, 50, 12, "Store"));
+		if(WurstClient.INSTANCE.modManager.getModByClass(AutoStealMod.class).isEnabled())
+			actionPerformed((GuiButton)buttonList.get(0));
+	}
+
+	//TODO: Client
+	/*
+	 * Copyright  2014 - 2015 | Alexander01998 | All rights reserved.
+	 * 
+	 * This Source Code Form is subject to the terms of the Mozilla Public
+	 * License, v. 2.0. If a copy of the MPL was not distributed with this
+	 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
+	 */
+	@Override
+	protected void actionPerformed(GuiButton button)
+	{
+		if(button.id == 0)// Steal
+			new Thread(new Runnable()
+			{
+				@Override
+				public void run()
+				{
+					try
+					{
+						for(int i = 0; i < inventoryRows * 9; i++)
+						{
+							Slot slot = (Slot)inventorySlots.inventorySlots.get(i);
+							if(slot.getStack() == null)
+								continue;
+							if(WurstClient.INSTANCE.modManager
+								.getModByClass(YesCheatMod.class).isEnabled())
+								Thread.sleep(250);
+							handleMouseClick(slot, slot.slotNumber, 0, 1);
+							handleMouseClick(slot, slot.slotNumber, 0, 6);
+						}
+					}catch(Exception e)
+					{
+						e.printStackTrace();
+					}
+				}
+			}).start();
+		else if(button.id == 1)// Store
+			new Thread(new Runnable()
+			{
+				@Override
+				public void run()
+				{
+					try
+					{
+						for(int i = inventoryRows * 9; i < inventoryRows * 9 + 44; i++)
+						{
+							Slot slot = (Slot)inventorySlots.inventorySlots.get(i);
+							if(slot.getStack() == null)
+								continue;
+							if(WurstClient.INSTANCE.modManager
+								.getModByClass(YesCheatMod.class).isEnabled())
+								Thread.sleep(250);
+							handleMouseClick(slot, slot.slotNumber, 0, 1);
+							handleMouseClick(slot, slot.slotNumber, 0, 6);
+						}
+					}catch(Exception e)
+					{
+						e.printStackTrace();
+					}
+				}
+			}).start();
+	}
+
+	/**
+	 * Draw the foreground layer for the GuiContainer (everything in front of
+	 * the items). Args : mouseX, mouseY
+	 */
+	@Override
+	protected void drawGuiContainerForegroundLayer(int mouseX, int mouseY)
+	{
+		fontRendererObj.drawString(lowerChestInventory.getDisplayName().getUnformattedText(), 8, 6, 4210752);
+		fontRendererObj.drawString(upperChestInventory.getDisplayName().getUnformattedText(), 8, ySize - 96 + 2, 4210752);
+	}
+
+	/**
+	 * Args : renderPartialTicks, mouseX, mouseY
+	 */
+	@Override
+	protected void drawGuiContainerBackgroundLayer(float partialTicks, int mouseX, int mouseY)
+	{
+		GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+		mc.getTextureManager().bindTexture(field_147017_u);
+		int var4 = (width - xSize) / 2;
+		int var5 = (height - ySize) / 2;
+		drawTexturedModalRect(var4, var5, 0, 0, xSize, inventoryRows * 18 + 17);
+		drawTexturedModalRect(var4, var5 + inventoryRows * 18 + 17, 0, 126, xSize, 96);
+	}
+}
diff --git a/src/net/minecraft/client/gui/inventory/GuiContainer.java b/src/net/minecraft/client/gui/inventory/GuiContainer.java
index 07acadb..61d1fe5 100644
--- a/src/net/minecraft/client/gui/inventory/GuiContainer.java
+++ b/src/net/minecraft/client/gui/inventory/GuiContainer.java
@@ -229,40 +229,40 @@ public abstract class GuiContainer extends GuiScreen
     {
         int var2 = slotIn.xDisplayPosition;
         int var3 = slotIn.yDisplayPosition;
-        ItemStack var4 = slotIn.getStack();
+        ItemStack itemStack = slotIn.getStack();
         boolean var5 = false;
         boolean var6 = slotIn == this.clickedSlot && this.draggedStack != null && !this.isRightMouseClick;
-        ItemStack var7 = this.mc.thePlayer.inventory.getItemStack();
+        ItemStack heldItemStack = this.mc.thePlayer.inventory.getItemStack();
         String var8 = null;
 
-        if (slotIn == this.clickedSlot && this.draggedStack != null && this.isRightMouseClick && var4 != null)
+        if (slotIn == this.clickedSlot && this.draggedStack != null && this.isRightMouseClick && itemStack != null)
         {
-            var4 = var4.copy();
-            var4.stackSize /= 2;
+            itemStack = itemStack.copy();
+            itemStack.stackSize /= 2;
         }
-        else if (this.dragSplitting && this.dragSplittingSlots.contains(slotIn) && var7 != null)
+        else if (this.dragSplitting && this.dragSplittingSlots.contains(slotIn) && heldItemStack != null)
         {
             if (this.dragSplittingSlots.size() == 1)
             {
                 return;
             }
 
-            if (Container.canAddItemToSlot(slotIn, var7, true) && this.inventorySlots.canDragIntoSlot(slotIn))
+            if (Container.canAddItemToSlot(slotIn, heldItemStack, true) && this.inventorySlots.canDragIntoSlot(slotIn))
             {
-                var4 = var7.copy();
+                itemStack = heldItemStack.copy();
                 var5 = true;
-                Container.computeStackSize(this.dragSplittingSlots, this.dragSplittingLimit, var4, slotIn.getStack() == null ? 0 : slotIn.getStack().stackSize);
+                Container.computeStackSize(this.dragSplittingSlots, this.dragSplittingLimit, itemStack, slotIn.getStack() == null ? 0 : slotIn.getStack().stackSize);
 
-                if (var4.stackSize > var4.getMaxStackSize())
+                if (itemStack.stackSize > itemStack.getMaxStackSize())
                 {
-                    var8 = EnumChatFormatting.YELLOW + "" + var4.getMaxStackSize();
-                    var4.stackSize = var4.getMaxStackSize();
+                    var8 = EnumChatFormatting.YELLOW + "" + itemStack.getMaxStackSize();
+                    itemStack.stackSize = itemStack.getMaxStackSize();
                 }
 
-                if (var4.stackSize > slotIn.func_178170_b(var4))
+                if (itemStack.stackSize > slotIn.func_178170_b(itemStack))
                 {
-                    var8 = EnumChatFormatting.YELLOW + "" + slotIn.func_178170_b(var4);
-                    var4.stackSize = slotIn.func_178170_b(var4);
+                    var8 = EnumChatFormatting.YELLOW + "" + slotIn.func_178170_b(itemStack);
+                    itemStack.stackSize = slotIn.func_178170_b(itemStack);
                 }
             }
             else
@@ -275,9 +275,9 @@ public abstract class GuiContainer extends GuiScreen
         this.zLevel = 100.0F;
         this.itemRender.zLevel = 100.0F;
 
-        if (var4 == null)
+        if (itemStack == null)
         {
-            String var9 = slotIn.func_178171_c();
+            String var9 = slotIn.getNull();
 
             if (var9 != null)
             {
@@ -288,6 +288,8 @@ public abstract class GuiContainer extends GuiScreen
                 GlStateManager.enableLighting();
                 var6 = true;
             }
+            //TODO: Client
+            var6 = true;
         }
 
         if (!var6)
@@ -298,8 +300,8 @@ public abstract class GuiContainer extends GuiScreen
             }
 
             GlStateManager.enableDepth();
-            this.itemRender.func_180450_b(var4, var2, var3);
-            this.itemRender.func_180453_a(this.fontRendererObj, var4, var2, var3, var8);
+            this.itemRender.func_180450_b(itemStack, var2, var3);
+            this.itemRender.func_180453_a(this.fontRendererObj, itemStack, var2, var3, var8);
         }
 
         this.itemRender.zLevel = 0.0F;
diff --git a/src/net/minecraft/client/gui/inventory/GuiContainerCreative.java b/src/net/minecraft/client/gui/inventory/GuiContainerCreative.java
index 3ba9565..30138df 100644
--- a/src/net/minecraft/client/gui/inventory/GuiContainerCreative.java
+++ b/src/net/minecraft/client/gui/inventory/GuiContainerCreative.java
@@ -1,10 +1,12 @@
 package net.minecraft.client.gui.inventory;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
+
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiTextField;
 import net.minecraft.client.gui.achievement.GuiAchievements;
@@ -29,6 +31,7 @@ import net.minecraft.item.ItemStack;
 import net.minecraft.util.EnumChatFormatting;
 import net.minecraft.util.MathHelper;
 import net.minecraft.util.ResourceLocation;
+
 import org.lwjgl.input.Keyboard;
 import org.lwjgl.input.Mouse;
 
@@ -83,7 +86,7 @@ public class GuiContainerCreative extends InventoryEffectRenderer
     /**
      * Called when the mouse is clicked over a slot or outside the gui.
      */
-    protected void handleMouseClick(Slot slotIn, int slotId, int clickedButton, int clickType)
+    public void handleMouseClick(Slot slotIn, int slotId, int clickedButton, int clickType)
     {
         this.field_147057_D = true;
         boolean var5 = clickType == 1;
@@ -1035,9 +1038,9 @@ public class GuiContainerCreative extends InventoryEffectRenderer
             return this.field_148332_b.func_178170_b(p_178170_1_);
         }
 
-        public String func_178171_c()
+        public String getNull()
         {
-            return this.field_148332_b.func_178171_c();
+            return this.field_148332_b.getNull();
         }
 
         public ItemStack decrStackSize(int p_75209_1_)
diff --git a/src/net/minecraft/client/gui/inventory/GuiEditSign.java b/src/net/minecraft/client/gui/inventory/GuiEditSign.java
index 21ea6e9..929f5b6 100644
--- a/src/net/minecraft/client/gui/inventory/GuiEditSign.java
+++ b/src/net/minecraft/client/gui/inventory/GuiEditSign.java
@@ -1,176 +1,200 @@
-package net.minecraft.client.gui.inventory;
-
-import java.io.IOException;
-import net.minecraft.block.Block;
-import net.minecraft.client.gui.GuiButton;
-import net.minecraft.client.gui.GuiScreen;
-import net.minecraft.client.network.NetHandlerPlayClient;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.tileentity.TileEntityRendererDispatcher;
-import net.minecraft.client.resources.I18n;
-import net.minecraft.init.Blocks;
-import net.minecraft.network.play.client.C12PacketUpdateSign;
-import net.minecraft.tileentity.TileEntitySign;
-import net.minecraft.util.ChatAllowedCharacters;
-import net.minecraft.util.ChatComponentText;
-import org.lwjgl.input.Keyboard;
-
-public class GuiEditSign extends GuiScreen
-{
-    /** Reference to the sign object. */
-    private TileEntitySign tileSign;
-
-    /** Counts the number of screen updates. */
-    private int updateCounter;
-
-    /** The index of the line that is being edited. */
-    private int editLine;
-
-    /** "Done" button for the GUI. */
-    private GuiButton doneBtn;
-    private static final String __OBFID = "CL_00000764";
-
-    public GuiEditSign(TileEntitySign p_i1097_1_)
-    {
-        this.tileSign = p_i1097_1_;
-    }
-
-    /**
-     * Adds the buttons (and other controls) to the screen in question.
-     */
-    public void initGui()
-    {
-        this.buttonList.clear();
-        Keyboard.enableRepeatEvents(true);
-        this.buttonList.add(this.doneBtn = new GuiButton(0, this.width / 2 - 100, this.height / 4 + 120, I18n.format("gui.done", new Object[0])));
-        this.tileSign.setEditable(false);
-    }
-
-    /**
-     * Called when the screen is unloaded. Used to disable keyboard repeat events
-     */
-    public void onGuiClosed()
-    {
-        Keyboard.enableRepeatEvents(false);
-        NetHandlerPlayClient var1 = this.mc.getNetHandler();
-
-        if (var1 != null)
-        {
-            var1.addToSendQueue(new C12PacketUpdateSign(this.tileSign.getPos(), this.tileSign.signText));
-        }
-
-        this.tileSign.setEditable(true);
-    }
-
-    /**
-     * Called from the main game loop to update the screen.
-     */
-    public void updateScreen()
-    {
-        ++this.updateCounter;
-    }
-
-    protected void actionPerformed(GuiButton button) throws IOException
-    {
-        if (button.enabled)
-        {
-            if (button.id == 0)
-            {
-                this.tileSign.markDirty();
-                this.mc.displayGuiScreen((GuiScreen)null);
-            }
-        }
-    }
-
-    /**
-     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
-     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
-     */
-    protected void keyTyped(char typedChar, int keyCode) throws IOException
-    {
-        if (keyCode == 200)
-        {
-            this.editLine = this.editLine - 1 & 3;
-        }
-
-        if (keyCode == 208 || keyCode == 28 || keyCode == 156)
-        {
-            this.editLine = this.editLine + 1 & 3;
-        }
-
-        String var3 = this.tileSign.signText[this.editLine].getUnformattedText();
-
-        if (keyCode == 14 && var3.length() > 0)
-        {
-            var3 = var3.substring(0, var3.length() - 1);
-        }
-
-        if (ChatAllowedCharacters.isAllowedCharacter(typedChar) && this.fontRendererObj.getStringWidth(var3 + typedChar) <= 90)
-        {
-            var3 = var3 + typedChar;
-        }
-
-        this.tileSign.signText[this.editLine] = new ChatComponentText(var3);
-
-        if (keyCode == 1)
-        {
-            this.actionPerformed(this.doneBtn);
-        }
-    }
-
-    /**
-     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
-     */
-    public void drawScreen(int mouseX, int mouseY, float partialTicks)
-    {
-        this.drawDefaultBackground();
-        this.drawCenteredString(this.fontRendererObj, I18n.format("sign.edit", new Object[0]), this.width / 2, 40, 16777215);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.pushMatrix();
-        GlStateManager.translate((float)(this.width / 2), 0.0F, 50.0F);
-        float var4 = 93.75F;
-        GlStateManager.scale(-var4, -var4, -var4);
-        GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
-        Block var5 = this.tileSign.getBlockType();
-
-        if (var5 == Blocks.standing_sign)
-        {
-            float var6 = (float)(this.tileSign.getBlockMetadata() * 360) / 16.0F;
-            GlStateManager.rotate(var6, 0.0F, 1.0F, 0.0F);
-            GlStateManager.translate(0.0F, -1.0625F, 0.0F);
-        }
-        else
-        {
-            int var8 = this.tileSign.getBlockMetadata();
-            float var7 = 0.0F;
-
-            if (var8 == 2)
-            {
-                var7 = 180.0F;
-            }
-
-            if (var8 == 4)
-            {
-                var7 = 90.0F;
-            }
-
-            if (var8 == 5)
-            {
-                var7 = -90.0F;
-            }
-
-            GlStateManager.rotate(var7, 0.0F, 1.0F, 0.0F);
-            GlStateManager.translate(0.0F, -1.0625F, 0.0F);
-        }
-
-        if (this.updateCounter / 6 % 2 == 0)
-        {
-            this.tileSign.lineBeingEdited = this.editLine;
-        }
-
-        TileEntityRendererDispatcher.instance.renderTileEntityAt(this.tileSign, -0.5D, -0.75D, -0.5D, 0.0F);
-        this.tileSign.lineBeingEdited = -1;
-        GlStateManager.popMatrix();
-        super.drawScreen(mouseX, mouseY, partialTicks);
-    }
-}
+package net.minecraft.client.gui.inventory;
+
+import java.io.IOException;
+
+import net.minecraft.block.Block;
+import net.minecraft.client.gui.GuiButton;
+import net.minecraft.client.gui.GuiScreen;
+import net.minecraft.client.network.NetHandlerPlayClient;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.tileentity.TileEntityRendererDispatcher;
+import net.minecraft.client.resources.I18n;
+import net.minecraft.init.Blocks;
+import net.minecraft.network.play.client.C12PacketUpdateSign;
+import net.minecraft.tileentity.TileEntitySign;
+import net.minecraft.util.ChatAllowedCharacters;
+import net.minecraft.util.ChatComponentText;
+
+import org.lwjgl.input.Keyboard;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.AutoSignMod;
+
+public class GuiEditSign extends GuiScreen
+{
+    /** Reference to the sign object. */
+    private TileEntitySign tileSign;
+
+    /** Counts the number of screen updates. */
+    private int updateCounter;
+
+    /** The index of the line that is being edited. */
+    private int editLine;
+
+    /** "Done" button for the GUI. */
+    private GuiButton doneBtn;
+    private static final String __OBFID = "CL_00000764";
+    
+    //TODO: Client
+    private static AutoSignMod autoSign;
+
+    public GuiEditSign(TileEntitySign p_i1097_1_)
+    {
+        this.tileSign = p_i1097_1_;
+        if(autoSign == null)
+        	autoSign = (AutoSignMod)WurstClient.INSTANCE.modManager.getModByClass(AutoSignMod.class);
+    }
+
+    /**
+     * Adds the buttons (and other controls) to the screen in question.
+     */
+    public void initGui()
+    {
+		// TODO: Client
+		if(WurstClient.INSTANCE.modManager.getModByClass(AutoSignMod.class)
+			.isEnabled() && autoSign.signText != null)
+		{
+			this.tileSign.signText = autoSign.signText;
+			mc.displayGuiScreen(null);
+		}
+    	
+        this.buttonList.clear();
+        Keyboard.enableRepeatEvents(true);
+        this.buttonList.add(this.doneBtn = new GuiButton(0, this.width / 2 - 100, this.height / 4 + 120, I18n.format("gui.done", new Object[0])));
+        this.tileSign.setEditable(false);
+    }
+
+    /**
+     * Called when the screen is unloaded. Used to disable keyboard repeat events
+     */
+    public void onGuiClosed()
+    {
+        Keyboard.enableRepeatEvents(false);
+        NetHandlerPlayClient var1 = this.mc.getNetHandler();
+
+        if (var1 != null)
+        {
+            var1.addToSendQueue(new C12PacketUpdateSign(this.tileSign.getPos(), this.tileSign.signText));
+        }
+
+        this.tileSign.setEditable(true);
+    }
+
+    /**
+     * Called from the main game loop to update the screen.
+     */
+    public void updateScreen()
+    {
+        ++this.updateCounter;
+    }
+
+    protected void actionPerformed(GuiButton button) throws IOException
+    {
+        if (button.enabled)
+        {
+            if (button.id == 0)
+            {
+				// TODO: Client
+				if(WurstClient.INSTANCE.modManager.getModByClass(
+					AutoSignMod.class).isEnabled()
+					&& autoSign.signText == null)
+					autoSign.signText = this.tileSign.signText;
+            	
+                this.tileSign.markDirty();
+                this.mc.displayGuiScreen((GuiScreen)null);
+            }
+        }
+    }
+
+    /**
+     * Fired when a key is typed (except F11 who toggle full screen). This is the equivalent of
+     * KeyListener.keyTyped(KeyEvent e). Args : character (character on the key), keyCode (lwjgl Keyboard key code)
+     */
+    protected void keyTyped(char typedChar, int keyCode) throws IOException
+    {
+        if (keyCode == 200)
+        {
+            this.editLine = this.editLine - 1 & 3;
+        }
+
+        if (keyCode == 208 || keyCode == 28 || keyCode == 156)
+        {
+            this.editLine = this.editLine + 1 & 3;
+        }
+
+        String var3 = this.tileSign.signText[this.editLine].getUnformattedText();
+
+        if (keyCode == 14 && var3.length() > 0)
+        {
+            var3 = var3.substring(0, var3.length() - 1);
+        }
+
+        if (ChatAllowedCharacters.isAllowedCharacter(typedChar) && this.fontRendererObj.getStringWidth(var3 + typedChar) <= 90)
+        {
+            var3 = var3 + typedChar;
+        }
+
+        this.tileSign.signText[this.editLine] = new ChatComponentText(var3);
+
+        if (keyCode == 1)
+        {
+            this.actionPerformed(this.doneBtn);
+        }
+    }
+
+    /**
+     * Draws the screen and all the components in it. Args : mouseX, mouseY, renderPartialTicks
+     */
+    public void drawScreen(int mouseX, int mouseY, float partialTicks)
+    {
+        this.drawDefaultBackground();
+        this.drawCenteredString(this.fontRendererObj, I18n.format("sign.edit", new Object[0]), this.width / 2, 40, 16777215);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.pushMatrix();
+        GlStateManager.translate((float)(this.width / 2), 0.0F, 50.0F);
+        float var4 = 93.75F;
+        GlStateManager.scale(-var4, -var4, -var4);
+        GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
+        Block var5 = this.tileSign.getBlockType();
+
+        if (var5 == Blocks.standing_sign)
+        {
+            float var6 = (float)(this.tileSign.getBlockMetadata() * 360) / 16.0F;
+            GlStateManager.rotate(var6, 0.0F, 1.0F, 0.0F);
+            GlStateManager.translate(0.0F, -1.0625F, 0.0F);
+        }
+        else
+        {
+            int var8 = this.tileSign.getBlockMetadata();
+            float var7 = 0.0F;
+
+            if (var8 == 2)
+            {
+                var7 = 180.0F;
+            }
+
+            if (var8 == 4)
+            {
+                var7 = 90.0F;
+            }
+
+            if (var8 == 5)
+            {
+                var7 = -90.0F;
+            }
+
+            GlStateManager.rotate(var7, 0.0F, 1.0F, 0.0F);
+            GlStateManager.translate(0.0F, -1.0625F, 0.0F);
+        }
+
+        if (this.updateCounter / 6 % 2 == 0)
+        {
+            this.tileSign.lineBeingEdited = this.editLine;
+        }
+
+        TileEntityRendererDispatcher.instance.renderTileEntityAt(this.tileSign, -0.5D, -0.75D, -0.5D, 0.0F);
+        this.tileSign.lineBeingEdited = -1;
+        GlStateManager.popMatrix();
+        super.drawScreen(mouseX, mouseY, partialTicks);
+    }
+}
diff --git a/src/net/minecraft/client/gui/inventory/GuiInventory.java b/src/net/minecraft/client/gui/inventory/GuiInventory.java
index b39e3fe..dec1ac4 100644
--- a/src/net/minecraft/client/gui/inventory/GuiInventory.java
+++ b/src/net/minecraft/client/gui/inventory/GuiInventory.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui.inventory;
 
 import java.io.IOException;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.achievement.GuiAchievements;
diff --git a/src/net/minecraft/client/gui/spectator/categories/TeleportToPlayer.java b/src/net/minecraft/client/gui/spectator/categories/TeleportToPlayer.java
index a2a9b30..e996b3d 100644
--- a/src/net/minecraft/client/gui/spectator/categories/TeleportToPlayer.java
+++ b/src/net/minecraft/client/gui/spectator/categories/TeleportToPlayer.java
@@ -26,7 +26,7 @@ public class TeleportToPlayer implements ISpectatorMenuView, ISpectatorMenuObjec
         private static final String __OBFID = "CL_00001921";
         public int func_178746_a(NetworkPlayerInfo p_178746_1_, NetworkPlayerInfo p_178746_2_)
         {
-            return ComparisonChain.start().compare(p_178746_1_.func_178845_a().getId(), p_178746_2_.func_178845_a().getId()).result();
+            return ComparisonChain.start().compare(p_178746_1_.getGameProfile().getId(), p_178746_2_.getGameProfile().getId()).result();
         }
         public int compare(Object p_compare_1_, Object p_compare_2_)
         {
@@ -38,7 +38,7 @@ public class TeleportToPlayer implements ISpectatorMenuView, ISpectatorMenuObjec
 
     public TeleportToPlayer()
     {
-        this(field_178674_a.sortedCopy(Minecraft.getMinecraft().getNetHandler().func_175106_d()));
+        this(field_178674_a.sortedCopy(Minecraft.getMinecraft().getNetHandler().getPlayerInfo()));
     }
 
     public TeleportToPlayer(Collection p_i45493_1_)
@@ -52,7 +52,7 @@ public class TeleportToPlayer implements ISpectatorMenuView, ISpectatorMenuObjec
 
             if (var3.getGameType() != WorldSettings.GameType.SPECTATOR)
             {
-                this.field_178673_b.add(new PlayerMenuObject(var3.func_178845_a()));
+                this.field_178673_b.add(new PlayerMenuObject(var3.getGameProfile()));
             }
         }
     }
diff --git a/src/net/minecraft/client/gui/spectator/categories/TeleportToTeam.java b/src/net/minecraft/client/gui/spectator/categories/TeleportToTeam.java
index 680b12c..b01bf87 100644
--- a/src/net/minecraft/client/gui/spectator/categories/TeleportToTeam.java
+++ b/src/net/minecraft/client/gui/spectator/categories/TeleportToTeam.java
@@ -109,13 +109,13 @@ public class TeleportToTeam implements ISpectatorMenuView, ISpectatorMenuObject
 
             if (!this.field_178675_d.isEmpty())
             {
-                String var6 = ((NetworkPlayerInfo)this.field_178675_d.get((new Random()).nextInt(this.field_178675_d.size()))).func_178845_a().getName();
+                String var6 = ((NetworkPlayerInfo)this.field_178675_d.get((new Random()).nextInt(this.field_178675_d.size()))).getGameProfile().getName();
                 this.field_178677_c = AbstractClientPlayer.getLocationSkin(var6);
                 AbstractClientPlayer.getDownloadImageSkin(this.field_178677_c, var6);
             }
             else
             {
-                this.field_178677_c = DefaultPlayerSkin.func_177335_a();
+                this.field_178677_c = DefaultPlayerSkin.getLocationStevePNG();
             }
         }
 
diff --git a/src/net/minecraft/client/gui/stream/GuiIngestServers.java b/src/net/minecraft/client/gui/stream/GuiIngestServers.java
index 59d0d1f..df80b05 100644
--- a/src/net/minecraft/client/gui/stream/GuiIngestServers.java
+++ b/src/net/minecraft/client/gui/stream/GuiIngestServers.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui.stream;
 
 import java.io.IOException;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiScreen;
diff --git a/src/net/minecraft/client/gui/stream/GuiStreamOptions.java b/src/net/minecraft/client/gui/stream/GuiStreamOptions.java
index 94ad401..502ca47 100644
--- a/src/net/minecraft/client/gui/stream/GuiStreamOptions.java
+++ b/src/net/minecraft/client/gui/stream/GuiStreamOptions.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.gui.stream;
 
 import java.io.IOException;
+
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiOptionButton;
 import net.minecraft.client.gui.GuiOptionSlider;
diff --git a/src/net/minecraft/client/gui/stream/GuiStreamUnavailable.java b/src/net/minecraft/client/gui/stream/GuiStreamUnavailable.java
index 1b29f2e..a05ccad 100644
--- a/src/net/minecraft/client/gui/stream/GuiStreamUnavailable.java
+++ b/src/net/minecraft/client/gui/stream/GuiStreamUnavailable.java
@@ -1,12 +1,14 @@
 package net.minecraft.client.gui.stream;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.net.URI;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiScreen;
@@ -18,10 +20,12 @@ import net.minecraft.util.ChatComponentTranslation;
 import net.minecraft.util.IChatComponent;
 import net.minecraft.util.Session;
 import net.minecraft.util.Util;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.lwjgl.opengl.GL11;
 import org.lwjgl.opengl.GLContext;
+
 import tv.twitch.ErrorCode;
 
 public class GuiStreamUnavailable extends GuiScreen
diff --git a/src/net/minecraft/client/gui/stream/GuiTwitchUserMode.java b/src/net/minecraft/client/gui/stream/GuiTwitchUserMode.java
index 9af11d4..44390a0 100644
--- a/src/net/minecraft/client/gui/stream/GuiTwitchUserMode.java
+++ b/src/net/minecraft/client/gui/stream/GuiTwitchUserMode.java
@@ -1,11 +1,13 @@
 package net.minecraft.client.gui.stream;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
+
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiScreen;
 import net.minecraft.client.resources.I18n;
diff --git a/src/net/minecraft/client/main/Main.java b/src/net/minecraft/client/main/Main.java
index 591ccdf..8b075ac 100644
--- a/src/net/minecraft/client/main/Main.java
+++ b/src/net/minecraft/client/main/Main.java
@@ -1,8 +1,5 @@
 package net.minecraft.client.main;
 
-import com.google.gson.GsonBuilder;
-import com.mojang.authlib.properties.PropertyMap;
-import com.mojang.authlib.properties.PropertyMap.Serializer;
 import java.io.File;
 import java.net.Authenticator;
 import java.net.InetSocketAddress;
@@ -10,6 +7,9 @@ import java.net.PasswordAuthentication;
 import java.net.Proxy;
 import java.net.Proxy.Type;
 import java.util.List;
+
+import javax.swing.UIManager;
+
 import joptsimple.ArgumentAcceptingOptionSpec;
 import joptsimple.NonOptionArgumentSpec;
 import joptsimple.OptionParser;
@@ -17,12 +17,25 @@ import joptsimple.OptionSet;
 import net.minecraft.client.Minecraft;
 import net.minecraft.util.Session;
 
+import com.google.gson.GsonBuilder;
+import com.mojang.authlib.properties.PropertyMap;
+import com.mojang.authlib.properties.PropertyMap.Serializer;
+
 public class Main
 {
     private static final String __OBFID = "CL_00001461";
 
     public static void main(String[] p_main_0_)
     {
+    	//TODO: Client
+		try
+		{
+			UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
+		}catch(Exception e)
+		{
+			e.printStackTrace();
+		}
+		
         System.setProperty("java.net.preferIPv4Stack", "true");
         OptionParser var1 = new OptionParser();
         var1.allowsUnrecognizedOptions();
diff --git a/src/net/minecraft/client/multiplayer/GuiConnecting.java b/src/net/minecraft/client/multiplayer/GuiConnecting.java
index ee9ae67..6130e68 100644
--- a/src/net/minecraft/client/multiplayer/GuiConnecting.java
+++ b/src/net/minecraft/client/multiplayer/GuiConnecting.java
@@ -4,6 +4,7 @@ import java.io.IOException;
 import java.net.InetAddress;
 import java.net.UnknownHostException;
 import java.util.concurrent.atomic.AtomicInteger;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiButton;
 import net.minecraft.client.gui.GuiDisconnected;
@@ -16,6 +17,7 @@ import net.minecraft.network.handshake.client.C00Handshake;
 import net.minecraft.network.login.client.C00PacketLoginStart;
 import net.minecraft.util.ChatComponentText;
 import net.minecraft.util.ChatComponentTranslation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/multiplayer/PlayerControllerMP.java b/src/net/minecraft/client/multiplayer/PlayerControllerMP.java
index 1c4d5a3..8651342 100644
--- a/src/net/minecraft/client/multiplayer/PlayerControllerMP.java
+++ b/src/net/minecraft/client/multiplayer/PlayerControllerMP.java
@@ -1,616 +1,640 @@
-package net.minecraft.client.multiplayer;
-
-import net.minecraft.block.Block;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.audio.PositionedSoundRecord;
-import net.minecraft.client.entity.EntityPlayerSP;
-import net.minecraft.client.network.NetHandlerPlayClient;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.passive.EntityHorse;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.item.ItemBlock;
-import net.minecraft.item.ItemStack;
-import net.minecraft.item.ItemSword;
-import net.minecraft.network.play.client.C02PacketUseEntity;
-import net.minecraft.network.play.client.C07PacketPlayerDigging;
-import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
-import net.minecraft.network.play.client.C09PacketHeldItemChange;
-import net.minecraft.network.play.client.C0EPacketClickWindow;
-import net.minecraft.network.play.client.C10PacketCreativeInventoryAction;
-import net.minecraft.network.play.client.C11PacketEnchantItem;
-import net.minecraft.stats.StatFileWriter;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.World;
-import net.minecraft.world.WorldSettings;
-
-public class PlayerControllerMP
-{
-    /** The Minecraft instance. */
-    private final Minecraft mc;
-    private final NetHandlerPlayClient netClientHandler;
-    private BlockPos field_178895_c = new BlockPos(-1, -1, -1);
-
-    /** The Item currently being used to destroy a block */
-    private ItemStack currentItemHittingBlock;
-
-    /** Current block damage (MP) */
-    private float curBlockDamageMP;
-
-    /**
-     * Tick counter, when it hits 4 it resets back to 0 and plays the step sound
-     */
-    private float stepSoundTickCounter;
-
-    /**
-     * Delays the first damage on the block after the first click on the block
-     */
-    private int blockHitDelay;
-
-    /** Tells if the player is hitting a block */
-    private boolean isHittingBlock;
-
-    /** Current game type for the player */
-    private WorldSettings.GameType currentGameType;
-
-    /** Index of the current item held by the player in the inventory hotbar */
-    private int currentPlayerItem;
-    private static final String __OBFID = "CL_00000881";
-
-    public PlayerControllerMP(Minecraft mcIn, NetHandlerPlayClient p_i45062_2_)
-    {
-        this.currentGameType = WorldSettings.GameType.SURVIVAL;
-        this.mc = mcIn;
-        this.netClientHandler = p_i45062_2_;
-    }
-
-    public static void func_178891_a(Minecraft mcIn, PlayerControllerMP p_178891_1_, BlockPos p_178891_2_, EnumFacing p_178891_3_)
-    {
-        if (!mcIn.theWorld.func_175719_a(mcIn.thePlayer, p_178891_2_, p_178891_3_))
-        {
-            p_178891_1_.func_178888_a(p_178891_2_, p_178891_3_);
-        }
-    }
-
-    /**
-     * Sets player capabilities depending on current gametype. params: player
-     */
-    public void setPlayerCapabilities(EntityPlayer p_78748_1_)
-    {
-        this.currentGameType.configurePlayerCapabilities(p_78748_1_.capabilities);
-    }
-
-    /**
-     * If modified to return true, the player spins around slowly around (0, 68.5, 0). The GUI is disabled, the view is
-     * set to first person, and both chat and menu are disabled. Unless the server is modified to ignore illegal
-     * stances, attempting to enter a world at all will result in an immediate kick due to an illegal stance. Appears to
-     * be left-over debug, or demo code.
-     */
-    public boolean enableEverythingIsScrewedUpMode()
-    {
-        return this.currentGameType == WorldSettings.GameType.SPECTATOR;
-    }
-
-    /**
-     * Sets the game type for the player.
-     */
-    public void setGameType(WorldSettings.GameType p_78746_1_)
-    {
-        this.currentGameType = p_78746_1_;
-        this.currentGameType.configurePlayerCapabilities(this.mc.thePlayer.capabilities);
-    }
-
-    /**
-     * Flips the player around.
-     */
-    public void flipPlayer(EntityPlayer playerIn)
-    {
-        playerIn.rotationYaw = -180.0F;
-    }
-
-    public boolean shouldDrawHUD()
-    {
-        return this.currentGameType.isSurvivalOrAdventure();
-    }
-
-    public boolean func_178888_a(BlockPos p_178888_1_, EnumFacing p_178888_2_)
-    {
-        if (this.currentGameType.isAdventure())
-        {
-            if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
-            {
-                return false;
-            }
-
-            if (!this.mc.thePlayer.func_175142_cm())
-            {
-                Block var3 = this.mc.theWorld.getBlockState(p_178888_1_).getBlock();
-                ItemStack var4 = this.mc.thePlayer.getCurrentEquippedItem();
-
-                if (var4 == null)
-                {
-                    return false;
-                }
-
-                if (!var4.canDestroy(var3))
-                {
-                    return false;
-                }
-            }
-        }
-
-        if (this.currentGameType.isCreative() && this.mc.thePlayer.getHeldItem() != null && this.mc.thePlayer.getHeldItem().getItem() instanceof ItemSword)
-        {
-            return false;
-        }
-        else
-        {
-            WorldClient var8 = this.mc.theWorld;
-            IBlockState var9 = var8.getBlockState(p_178888_1_);
-            Block var5 = var9.getBlock();
-
-            if (var5.getMaterial() == Material.air)
-            {
-                return false;
-            }
-            else
-            {
-                var8.playAuxSFX(2001, p_178888_1_, Block.getStateId(var9));
-                boolean var6 = var8.setBlockToAir(p_178888_1_);
-
-                if (var6)
-                {
-                    var5.onBlockDestroyedByPlayer(var8, p_178888_1_, var9);
-                }
-
-                this.field_178895_c = new BlockPos(this.field_178895_c.getX(), -1, this.field_178895_c.getZ());
-
-                if (!this.currentGameType.isCreative())
-                {
-                    ItemStack var7 = this.mc.thePlayer.getCurrentEquippedItem();
-
-                    if (var7 != null)
-                    {
-                        var7.onBlockDestroyed(var8, var5, p_178888_1_, this.mc.thePlayer);
-
-                        if (var7.stackSize == 0)
-                        {
-                            this.mc.thePlayer.destroyCurrentEquippedItem();
-                        }
-                    }
-                }
-
-                return var6;
-            }
-        }
-    }
-
-    public boolean func_180511_b(BlockPos p_180511_1_, EnumFacing p_180511_2_)
-    {
-        Block var3;
-
-        if (this.currentGameType.isAdventure())
-        {
-            if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
-            {
-                return false;
-            }
-
-            if (!this.mc.thePlayer.func_175142_cm())
-            {
-                var3 = this.mc.theWorld.getBlockState(p_180511_1_).getBlock();
-                ItemStack var4 = this.mc.thePlayer.getCurrentEquippedItem();
-
-                if (var4 == null)
-                {
-                    return false;
-                }
-
-                if (!var4.canDestroy(var3))
-                {
-                    return false;
-                }
-            }
-        }
-
-        if (!this.mc.theWorld.getWorldBorder().contains(p_180511_1_))
-        {
-            return false;
-        }
-        else
-        {
-            if (this.currentGameType.isCreative())
-            {
-                this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180511_1_, p_180511_2_));
-                func_178891_a(this.mc, this, p_180511_1_, p_180511_2_);
-                this.blockHitDelay = 5;
-            }
-            else if (!this.isHittingBlock || !this.func_178893_a(p_180511_1_))
-            {
-                if (this.isHittingBlock)
-                {
-                    this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.ABORT_DESTROY_BLOCK, this.field_178895_c, p_180511_2_));
-                }
-
-                this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180511_1_, p_180511_2_));
-                var3 = this.mc.theWorld.getBlockState(p_180511_1_).getBlock();
-                boolean var5 = var3.getMaterial() != Material.air;
-
-                if (var5 && this.curBlockDamageMP == 0.0F)
-                {
-                    var3.onBlockClicked(this.mc.theWorld, p_180511_1_, this.mc.thePlayer);
-                }
-
-                if (var5 && var3.getPlayerRelativeBlockHardness(this.mc.thePlayer, this.mc.thePlayer.worldObj, p_180511_1_) >= 1.0F)
-                {
-                    this.func_178888_a(p_180511_1_, p_180511_2_);
-                }
-                else
-                {
-                    this.isHittingBlock = true;
-                    this.field_178895_c = p_180511_1_;
-                    this.currentItemHittingBlock = this.mc.thePlayer.getHeldItem();
-                    this.curBlockDamageMP = 0.0F;
-                    this.stepSoundTickCounter = 0.0F;
-                    this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, (int)(this.curBlockDamageMP * 10.0F) - 1);
-                }
-            }
-
-            return true;
-        }
-    }
-
-    /**
-     * Resets current block damage and isHittingBlock
-     */
-    public void resetBlockRemoving()
-    {
-        if (this.isHittingBlock)
-        {
-            this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.ABORT_DESTROY_BLOCK, this.field_178895_c, EnumFacing.DOWN));
-            this.isHittingBlock = false;
-            this.curBlockDamageMP = 0.0F;
-            this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, -1);
-        }
-    }
-
-    public boolean func_180512_c(BlockPos p_180512_1_, EnumFacing p_180512_2_)
-    {
-        this.syncCurrentPlayItem();
-
-        if (this.blockHitDelay > 0)
-        {
-            --this.blockHitDelay;
-            return true;
-        }
-        else if (this.currentGameType.isCreative() && this.mc.theWorld.getWorldBorder().contains(p_180512_1_))
-        {
-            this.blockHitDelay = 5;
-            this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180512_1_, p_180512_2_));
-            func_178891_a(this.mc, this, p_180512_1_, p_180512_2_);
-            return true;
-        }
-        else if (this.func_178893_a(p_180512_1_))
-        {
-            Block var3 = this.mc.theWorld.getBlockState(p_180512_1_).getBlock();
-
-            if (var3.getMaterial() == Material.air)
-            {
-                this.isHittingBlock = false;
-                return false;
-            }
-            else
-            {
-                this.curBlockDamageMP += var3.getPlayerRelativeBlockHardness(this.mc.thePlayer, this.mc.thePlayer.worldObj, p_180512_1_);
-
-                if (this.stepSoundTickCounter % 4.0F == 0.0F)
-                {
-                    this.mc.getSoundHandler().playSound(new PositionedSoundRecord(new ResourceLocation(var3.stepSound.getStepSound()), (var3.stepSound.getVolume() + 1.0F) / 8.0F, var3.stepSound.getFrequency() * 0.5F, (float)p_180512_1_.getX() + 0.5F, (float)p_180512_1_.getY() + 0.5F, (float)p_180512_1_.getZ() + 0.5F));
-                }
-
-                ++this.stepSoundTickCounter;
-
-                if (this.curBlockDamageMP >= 1.0F)
-                {
-                    this.isHittingBlock = false;
-                    this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, p_180512_1_, p_180512_2_));
-                    this.func_178888_a(p_180512_1_, p_180512_2_);
-                    this.curBlockDamageMP = 0.0F;
-                    this.stepSoundTickCounter = 0.0F;
-                    this.blockHitDelay = 5;
-                }
-
-                this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, (int)(this.curBlockDamageMP * 10.0F) - 1);
-                return true;
-            }
-        }
-        else
-        {
-            return this.func_180511_b(p_180512_1_, p_180512_2_);
-        }
-    }
-
-    /**
-     * player reach distance = 4F
-     */
-    public float getBlockReachDistance()
-    {
-        return this.currentGameType.isCreative() ? 5.0F : 4.5F;
-    }
-
-    public void updateController()
-    {
-        this.syncCurrentPlayItem();
-
-        if (this.netClientHandler.getNetworkManager().isChannelOpen())
-        {
-            this.netClientHandler.getNetworkManager().processReceivedPackets();
-        }
-        else
-        {
-            this.netClientHandler.getNetworkManager().checkDisconnected();
-        }
-    }
-
-    private boolean func_178893_a(BlockPos p_178893_1_)
-    {
-        ItemStack var2 = this.mc.thePlayer.getHeldItem();
-        boolean var3 = this.currentItemHittingBlock == null && var2 == null;
-
-        if (this.currentItemHittingBlock != null && var2 != null)
-        {
-            var3 = var2.getItem() == this.currentItemHittingBlock.getItem() && ItemStack.areItemStackTagsEqual(var2, this.currentItemHittingBlock) && (var2.isItemStackDamageable() || var2.getMetadata() == this.currentItemHittingBlock.getMetadata());
-        }
-
-        return p_178893_1_.equals(this.field_178895_c) && var3;
-    }
-
-    /**
-     * Syncs the current player item with the server
-     */
-    private void syncCurrentPlayItem()
-    {
-        int var1 = this.mc.thePlayer.inventory.currentItem;
-
-        if (var1 != this.currentPlayerItem)
-        {
-            this.currentPlayerItem = var1;
-            this.netClientHandler.addToSendQueue(new C09PacketHeldItemChange(this.currentPlayerItem));
-        }
-    }
-
-    public boolean func_178890_a(EntityPlayerSP p_178890_1_, WorldClient p_178890_2_, ItemStack p_178890_3_, BlockPos p_178890_4_, EnumFacing p_178890_5_, Vec3 p_178890_6_)
-    {
-        this.syncCurrentPlayItem();
-        float var7 = (float)(p_178890_6_.xCoord - (double)p_178890_4_.getX());
-        float var8 = (float)(p_178890_6_.yCoord - (double)p_178890_4_.getY());
-        float var9 = (float)(p_178890_6_.zCoord - (double)p_178890_4_.getZ());
-        boolean var10 = false;
-
-        if (!this.mc.theWorld.getWorldBorder().contains(p_178890_4_))
-        {
-            return false;
-        }
-        else
-        {
-            if (this.currentGameType != WorldSettings.GameType.SPECTATOR)
-            {
-                IBlockState var11 = p_178890_2_.getBlockState(p_178890_4_);
-
-                if ((!p_178890_1_.isSneaking() || p_178890_1_.getHeldItem() == null) && var11.getBlock().onBlockActivated(p_178890_2_, p_178890_4_, var11, p_178890_1_, p_178890_5_, var7, var8, var9))
-                {
-                    var10 = true;
-                }
-
-                if (!var10 && p_178890_3_ != null && p_178890_3_.getItem() instanceof ItemBlock)
-                {
-                    ItemBlock var12 = (ItemBlock)p_178890_3_.getItem();
-
-                    if (!var12.canPlaceBlockOnSide(p_178890_2_, p_178890_4_, p_178890_5_, p_178890_1_, p_178890_3_))
-                    {
-                        return false;
-                    }
-                }
-            }
-
-            this.netClientHandler.addToSendQueue(new C08PacketPlayerBlockPlacement(p_178890_4_, p_178890_5_.getIndex(), p_178890_1_.inventory.getCurrentItem(), var7, var8, var9));
-
-            if (!var10 && this.currentGameType != WorldSettings.GameType.SPECTATOR)
-            {
-                if (p_178890_3_ == null)
-                {
-                    return false;
-                }
-                else if (this.currentGameType.isCreative())
-                {
-                    int var14 = p_178890_3_.getMetadata();
-                    int var15 = p_178890_3_.stackSize;
-                    boolean var13 = p_178890_3_.onItemUse(p_178890_1_, p_178890_2_, p_178890_4_, p_178890_5_, var7, var8, var9);
-                    p_178890_3_.setItemDamage(var14);
-                    p_178890_3_.stackSize = var15;
-                    return var13;
-                }
-                else
-                {
-                    return p_178890_3_.onItemUse(p_178890_1_, p_178890_2_, p_178890_4_, p_178890_5_, var7, var8, var9);
-                }
-            }
-            else
-            {
-                return true;
-            }
-        }
-    }
-
-    /**
-     * Notifies the server of things like consuming food, etc...
-     */
-    public boolean sendUseItem(EntityPlayer playerIn, World worldIn, ItemStack itemStackIn)
-    {
-        if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
-        {
-            return false;
-        }
-        else
-        {
-            this.syncCurrentPlayItem();
-            this.netClientHandler.addToSendQueue(new C08PacketPlayerBlockPlacement(playerIn.inventory.getCurrentItem()));
-            int var4 = itemStackIn.stackSize;
-            ItemStack var5 = itemStackIn.useItemRightClick(worldIn, playerIn);
-
-            if (var5 == itemStackIn && (var5 == null || var5.stackSize == var4))
-            {
-                return false;
-            }
-            else
-            {
-                playerIn.inventory.mainInventory[playerIn.inventory.currentItem] = var5;
-
-                if (var5.stackSize == 0)
-                {
-                    playerIn.inventory.mainInventory[playerIn.inventory.currentItem] = null;
-                }
-
-                return true;
-            }
-        }
-    }
-
-    public EntityPlayerSP func_178892_a(World worldIn, StatFileWriter p_178892_2_)
-    {
-        return new EntityPlayerSP(this.mc, worldIn, this.netClientHandler, p_178892_2_);
-    }
-
-    /**
-     * Attacks an entity
-     */
-    public void attackEntity(EntityPlayer playerIn, Entity targetEntity)
-    {
-        this.syncCurrentPlayItem();
-        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(targetEntity, C02PacketUseEntity.Action.ATTACK));
-
-        if (this.currentGameType != WorldSettings.GameType.SPECTATOR)
-        {
-            playerIn.attackTargetEntityWithCurrentItem(targetEntity);
-        }
-    }
-
-    /**
-     * Send packet to server - player is interacting with another entity (left click)
-     */
-    public boolean interactWithEntitySendPacket(EntityPlayer playerIn, Entity targetEntity)
-    {
-        this.syncCurrentPlayItem();
-        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(targetEntity, C02PacketUseEntity.Action.INTERACT));
-        return this.currentGameType != WorldSettings.GameType.SPECTATOR && playerIn.interactWith(targetEntity);
-    }
-
-    public boolean func_178894_a(EntityPlayer p_178894_1_, Entity p_178894_2_, MovingObjectPosition p_178894_3_)
-    {
-        this.syncCurrentPlayItem();
-        Vec3 var4 = new Vec3(p_178894_3_.hitVec.xCoord - p_178894_2_.posX, p_178894_3_.hitVec.yCoord - p_178894_2_.posY, p_178894_3_.hitVec.zCoord - p_178894_2_.posZ);
-        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(p_178894_2_, var4));
-        return this.currentGameType != WorldSettings.GameType.SPECTATOR && p_178894_2_.func_174825_a(p_178894_1_, var4);
-    }
-
-    /**
-     * Handles slot clicks sends a packet to the server.
-     */
-    public ItemStack windowClick(int windowId, int slotId, int p_78753_3_, int p_78753_4_, EntityPlayer playerIn)
-    {
-        short var6 = playerIn.openContainer.getNextTransactionID(playerIn.inventory);
-        ItemStack var7 = playerIn.openContainer.slotClick(slotId, p_78753_3_, p_78753_4_, playerIn);
-        this.netClientHandler.addToSendQueue(new C0EPacketClickWindow(windowId, slotId, p_78753_3_, p_78753_4_, var7, var6));
-        return var7;
-    }
-
-    /**
-     * GuiEnchantment uses this during multiplayer to tell PlayerControllerMP to send a packet indicating the
-     * enchantment action the player has taken.
-     */
-    public void sendEnchantPacket(int p_78756_1_, int p_78756_2_)
-    {
-        this.netClientHandler.addToSendQueue(new C11PacketEnchantItem(p_78756_1_, p_78756_2_));
-    }
-
-    /**
-     * Used in PlayerControllerMP to update the server with an ItemStack in a slot.
-     */
-    public void sendSlotPacket(ItemStack itemStackIn, int slotId)
-    {
-        if (this.currentGameType.isCreative())
-        {
-            this.netClientHandler.addToSendQueue(new C10PacketCreativeInventoryAction(slotId, itemStackIn));
-        }
-    }
-
-    /**
-     * Sends a Packet107 to the server to drop the item on the ground
-     */
-    public void sendPacketDropItem(ItemStack itemStackIn)
-    {
-        if (this.currentGameType.isCreative() && itemStackIn != null)
-        {
-            this.netClientHandler.addToSendQueue(new C10PacketCreativeInventoryAction(-1, itemStackIn));
-        }
-    }
-
-    public void onStoppedUsingItem(EntityPlayer playerIn)
-    {
-        this.syncCurrentPlayItem();
-        this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, EnumFacing.DOWN));
-        playerIn.stopUsingItem();
-    }
-
-    public boolean gameIsSurvivalOrAdventure()
-    {
-        return this.currentGameType.isSurvivalOrAdventure();
-    }
-
-    /**
-     * Checks if the player is not creative, used for checking if it should break a block instantly
-     */
-    public boolean isNotCreative()
-    {
-        return !this.currentGameType.isCreative();
-    }
-
-    /**
-     * returns true if player is in creative mode
-     */
-    public boolean isInCreativeMode()
-    {
-        return this.currentGameType.isCreative();
-    }
-
-    /**
-     * true for hitting entities far away.
-     */
-    public boolean extendedReach()
-    {
-        return this.currentGameType.isCreative();
-    }
-
-    /**
-     * Checks if the player is riding a horse, used to chose the GUI to open
-     */
-    public boolean isRidingHorse()
-    {
-        return this.mc.thePlayer.isRiding() && this.mc.thePlayer.ridingEntity instanceof EntityHorse;
-    }
-
-    public boolean isSpectatorMode()
-    {
-        return this.currentGameType == WorldSettings.GameType.SPECTATOR;
-    }
-
-    public WorldSettings.GameType func_178889_l()
-    {
-        return this.currentGameType;
-    }
-}
+package net.minecraft.client.multiplayer;
+
+import net.minecraft.block.Block;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.audio.PositionedSoundRecord;
+import net.minecraft.client.entity.EntityPlayerSP;
+import net.minecraft.client.network.NetHandlerPlayClient;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.passive.EntityHorse;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.item.ItemBlock;
+import net.minecraft.item.ItemStack;
+import net.minecraft.item.ItemSword;
+import net.minecraft.network.play.client.C02PacketUseEntity;
+import net.minecraft.network.play.client.C07PacketPlayerDigging;
+import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
+import net.minecraft.network.play.client.C09PacketHeldItemChange;
+import net.minecraft.network.play.client.C0EPacketClickWindow;
+import net.minecraft.network.play.client.C10PacketCreativeInventoryAction;
+import net.minecraft.network.play.client.C11PacketEnchantItem;
+import net.minecraft.stats.StatFileWriter;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.MovingObjectPosition;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.util.Vec3;
+import net.minecraft.world.World;
+import net.minecraft.world.WorldSettings;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.FastBreakMod;
+
+public class PlayerControllerMP
+{
+    /** The Minecraft instance. */
+    private final Minecraft mc;
+    private final NetHandlerPlayClient netClientHandler;
+    private BlockPos field_178895_c = new BlockPos(-1, -1, -1);
+
+    /** The Item currently being used to destroy a block */
+    private ItemStack currentItemHittingBlock;
+
+    /** Current block damage (MP) */
+    //TODO: Client
+    public static float curBlockDamageMP;
+
+    /**
+     * Tick counter, when it hits 4 it resets back to 0 and plays the step sound
+     */
+    private float stepSoundTickCounter;
+
+    /**
+     * Delays the first damage on the block after the first click on the block
+     */
+    private int blockHitDelay;
+
+    /** Tells if the player is hitting a block */
+    private boolean isHittingBlock;
+
+    /** Current game type for the player */
+    private WorldSettings.GameType currentGameType;
+
+    /** Index of the current item held by the player in the inventory hotbar */
+    private int currentPlayerItem;
+	private FastBreakMod fastBreak;
+    private static final String __OBFID = "CL_00000881";
+
+    public PlayerControllerMP(Minecraft mcIn, NetHandlerPlayClient p_i45062_2_)
+    {
+        this.currentGameType = WorldSettings.GameType.SURVIVAL;
+        this.mc = mcIn;
+        this.netClientHandler = p_i45062_2_;
+    }
+
+    public static void clickBlockCreative(Minecraft mcIn, PlayerControllerMP p_178891_1_, BlockPos p_178891_2_, EnumFacing p_178891_3_)
+    {
+        if (!mcIn.theWorld.func_175719_a(mcIn.thePlayer, p_178891_2_, p_178891_3_))
+        {
+            p_178891_1_.onPlayerDestroyBlock(p_178891_2_, p_178891_3_);
+        }
+    }
+
+    /**
+     * Sets player capabilities depending on current gametype. params: player
+     */
+    public void setPlayerCapabilities(EntityPlayer p_78748_1_)
+    {
+        this.currentGameType.configurePlayerCapabilities(p_78748_1_.capabilities);
+    }
+
+    /**
+     * If modified to return true, the player spins around slowly around (0, 68.5, 0). The GUI is disabled, the view is
+     * set to first person, and both chat and menu are disabled. Unless the server is modified to ignore illegal
+     * stances, attempting to enter a world at all will result in an immediate kick due to an illegal stance. Appears to
+     * be left-over debug, or demo code.
+     */
+    public boolean enableEverythingIsScrewedUpMode()
+    {
+        return this.currentGameType == WorldSettings.GameType.SPECTATOR;
+    }
+
+    /**
+     * Sets the game type for the player.
+     */
+    public void setGameType(WorldSettings.GameType p_78746_1_)
+    {
+        this.currentGameType = p_78746_1_;
+        this.currentGameType.configurePlayerCapabilities(this.mc.thePlayer.capabilities);
+    }
+
+    /**
+     * Flips the player around.
+     */
+    public void flipPlayer(EntityPlayer playerIn)
+    {
+        playerIn.rotationYaw = -180.0F;
+    }
+
+    public boolean shouldDrawHUD()
+    {
+        return this.currentGameType.isSurvivalOrAdventure();
+    }
+
+    public boolean onPlayerDestroyBlock(BlockPos pos, EnumFacing side)
+    {
+        if (this.currentGameType.isAdventure())
+        {
+            if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
+            {
+                return false;
+            }
+
+            if (!this.mc.thePlayer.func_175142_cm())
+            {
+                Block var3 = this.mc.theWorld.getBlockState(pos).getBlock();
+                ItemStack var4 = this.mc.thePlayer.getCurrentEquippedItem();
+
+                if (var4 == null)
+                {
+                    return false;
+                }
+
+                if (!var4.canDestroy(var3))
+                {
+                    return false;
+                }
+            }
+        }
+
+        if (this.currentGameType.isCreative() && this.mc.thePlayer.getHeldItem() != null && this.mc.thePlayer.getHeldItem().getItem() instanceof ItemSword)
+        {
+            return false;
+        }
+        else
+        {
+            WorldClient var8 = this.mc.theWorld;
+            IBlockState var9 = var8.getBlockState(pos);
+            Block var5 = var9.getBlock();
+
+            if (var5.getMaterial() == Material.air)
+            {
+                return false;
+            }
+            else
+            {
+                var8.playAuxSFX(2001, pos, Block.getStateId(var9));
+                boolean var6 = var8.setBlockToAir(pos);
+
+                if (var6)
+                {
+                    var5.onBlockDestroyedByPlayer(var8, pos, var9);
+                }
+
+                this.field_178895_c = new BlockPos(this.field_178895_c.getX(), -1, this.field_178895_c.getZ());
+
+                if (!this.currentGameType.isCreative())
+                {
+                    ItemStack var7 = this.mc.thePlayer.getCurrentEquippedItem();
+
+                    if (var7 != null)
+                    {
+                        var7.onBlockDestroyed(var8, var5, pos, this.mc.thePlayer);
+
+                        if (var7.stackSize == 0)
+                        {
+                            this.mc.thePlayer.destroyCurrentEquippedItem();
+                        }
+                    }
+                }
+
+                return var6;
+            }
+        }
+    }
+
+    public boolean clickBlock(BlockPos p_180511_1_, EnumFacing p_180511_2_)
+    {
+        Block var3;
+
+        if (this.currentGameType.isAdventure())
+        {
+            if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
+            {
+                return false;
+            }
+
+            if (!this.mc.thePlayer.func_175142_cm())
+            {
+                var3 = this.mc.theWorld.getBlockState(p_180511_1_).getBlock();
+                ItemStack var4 = this.mc.thePlayer.getCurrentEquippedItem();
+
+                if (var4 == null)
+                {
+                    return false;
+                }
+
+                if (!var4.canDestroy(var3))
+                {
+                    return false;
+                }
+            }
+        }
+
+        if (!this.mc.theWorld.getWorldBorder().contains(p_180511_1_))
+        {
+            return false;
+        }
+        else
+        {
+            if (this.currentGameType.isCreative())
+            {
+                this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180511_1_, p_180511_2_));
+                clickBlockCreative(this.mc, this, p_180511_1_, p_180511_2_);
+                //TODO: Client
+                this.blockHitDelay = WurstClient.INSTANCE.modManager.getModByClass(FastBreakMod.class).isEnabled() ? 0 : 5;
+            }
+            else if (!this.isHittingBlock || !this.sameToolAndBlock(p_180511_1_))
+            {
+                if (this.isHittingBlock)
+                {
+                    this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.ABORT_DESTROY_BLOCK, this.field_178895_c, p_180511_2_));
+                }
+
+                this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180511_1_, p_180511_2_));
+                var3 = this.mc.theWorld.getBlockState(p_180511_1_).getBlock();
+                boolean var5 = var3.getMaterial() != Material.air;
+
+                if (var5 && this.curBlockDamageMP == 0.0F)
+                {
+                    var3.onBlockClicked(this.mc.theWorld, p_180511_1_, this.mc.thePlayer);
+                }
+
+                if (var5 && var3.getPlayerRelativeBlockHardness(this.mc.thePlayer, this.mc.thePlayer.worldObj, p_180511_1_) >= 1.0F)
+                {
+                    this.onPlayerDestroyBlock(p_180511_1_, p_180511_2_);
+                }
+                else
+                {
+                    this.isHittingBlock = true;
+                    this.field_178895_c = p_180511_1_;
+                    this.currentItemHittingBlock = this.mc.thePlayer.getHeldItem();
+                    this.curBlockDamageMP = 0.0F;
+                    this.stepSoundTickCounter = 0.0F;
+                    this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, (int)(this.curBlockDamageMP * 10.0F) - 1);
+                }
+            }
+
+            return true;
+        }
+    }
+
+    /**
+     * Resets current block damage and isHittingBlock
+     */
+    public void resetBlockRemoving()
+    {
+        if (this.isHittingBlock)
+        {
+            this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.ABORT_DESTROY_BLOCK, this.field_178895_c, EnumFacing.DOWN));
+            this.isHittingBlock = false;
+            this.curBlockDamageMP = 0.0F;
+            this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, -1);
+        }
+    }
+
+    /**
+     * Called when a player damages a block and updates damage counters
+     */
+    public boolean onPlayerDamageBlock(BlockPos p_180512_1_, EnumFacing p_180512_2_)
+    {
+        this.syncCurrentPlayItem();
+
+        if (this.blockHitDelay > 0)
+        {
+            --this.blockHitDelay;
+            return true;
+        }
+        else if (this.currentGameType.isCreative() && this.mc.theWorld.getWorldBorder().contains(p_180512_1_))
+        {
+        	//TODO: Client
+            this.blockHitDelay = WurstClient.INSTANCE.modManager.getModByClass(FastBreakMod.class).isEnabled() ? 0 : 5;
+            this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, p_180512_1_, p_180512_2_));
+            clickBlockCreative(this.mc, this, p_180512_1_, p_180512_2_);
+            return true;
+        }
+        else if (this.sameToolAndBlock(p_180512_1_))
+        {
+            Block var3 = this.mc.theWorld.getBlockState(p_180512_1_).getBlock();
+
+            if (var3.getMaterial() == Material.air)
+            {
+                this.isHittingBlock = false;
+                return false;
+            }
+            else
+            {
+                //TODO: Client
+				if(fastBreak == null)
+					fastBreak =
+						(FastBreakMod)WurstClient.INSTANCE.modManager
+							.getModByClass(FastBreakMod.class);
+				this.curBlockDamageMP +=
+					var3.getPlayerRelativeBlockHardness(this.mc.thePlayer,
+						this.mc.thePlayer.worldObj, p_180512_1_)
+						* (!this.currentGameType.isCreative()
+							&& fastBreak.isEnabled()
+							&& WurstClient.INSTANCE.options.fastbreakMode == 0
+							? fastBreak.speed : 1);
+
+                if (this.stepSoundTickCounter % 4.0F == 0.0F)
+                {
+                    this.mc.getSoundHandler().playSound(new PositionedSoundRecord(new ResourceLocation(var3.stepSound.getStepSound()), (var3.stepSound.getVolume() + 1.0F) / 8.0F, var3.stepSound.getFrequency() * 0.5F, (float)p_180512_1_.getX() + 0.5F, (float)p_180512_1_.getY() + 0.5F, (float)p_180512_1_.getZ() + 0.5F));
+                }
+
+                ++this.stepSoundTickCounter;
+
+                if (this.curBlockDamageMP >= 1.0F)
+                {
+                    this.isHittingBlock = false;
+                    this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, p_180512_1_, p_180512_2_));
+                    this.onPlayerDestroyBlock(p_180512_1_, p_180512_2_);
+                    this.curBlockDamageMP = 0.0F;
+                    this.stepSoundTickCounter = 0.0F;
+                    this.blockHitDelay = 5;
+                    //TODO: Client
+                }else if(!this.currentGameType.isCreative() && WurstClient.INSTANCE.modManager.getModByClass(FastBreakMod.class).isEnabled() && WurstClient.INSTANCE.options.fastbreakMode == 1)
+                {
+                    this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, p_180512_1_, p_180512_2_));
+                }
+
+                this.mc.theWorld.sendBlockBreakProgress(this.mc.thePlayer.getEntityId(), this.field_178895_c, (int)(this.curBlockDamageMP * 10.0F) - 1);
+                return true;
+            }
+        }
+        else
+        {
+            return this.clickBlock(p_180512_1_, p_180512_2_);
+        }
+    }
+
+    /**
+     * player reach distance = 4F
+     */
+    public float getBlockReachDistance()
+    {
+        return this.currentGameType.isCreative() ? 5.0F : 4.5F;
+    }
+
+    public void updateController()
+    {
+        this.syncCurrentPlayItem();
+
+        if (this.netClientHandler.getNetworkManager().isChannelOpen())
+        {
+            this.netClientHandler.getNetworkManager().processReceivedPackets();
+        }
+        else
+        {
+            this.netClientHandler.getNetworkManager().checkDisconnected();
+        }
+    }
+
+    private boolean sameToolAndBlock(BlockPos p_178893_1_)
+    {
+        ItemStack var2 = this.mc.thePlayer.getHeldItem();
+        boolean var3 = this.currentItemHittingBlock == null && var2 == null;
+
+        if (this.currentItemHittingBlock != null && var2 != null)
+        {
+            var3 = var2.getItem() == this.currentItemHittingBlock.getItem() && ItemStack.areItemStackTagsEqual(var2, this.currentItemHittingBlock) && (var2.isItemStackDamageable() || var2.getMetadata() == this.currentItemHittingBlock.getMetadata());
+        }
+
+        return p_178893_1_.equals(this.field_178895_c) && var3;
+    }
+
+    /**
+     * Syncs the current player item with the server
+     */
+    private void syncCurrentPlayItem()
+    {
+        int var1 = this.mc.thePlayer.inventory.currentItem;
+
+        if (var1 != this.currentPlayerItem)
+        {
+            this.currentPlayerItem = var1;
+            this.netClientHandler.addToSendQueue(new C09PacketHeldItemChange(this.currentPlayerItem));
+        }
+    }
+
+    public boolean func_178890_a(EntityPlayerSP p_178890_1_, WorldClient p_178890_2_, ItemStack p_178890_3_, BlockPos p_178890_4_, EnumFacing p_178890_5_, Vec3 p_178890_6_)
+    {
+        this.syncCurrentPlayItem();
+        float var7 = (float)(p_178890_6_.xCoord - (double)p_178890_4_.getX());
+        float var8 = (float)(p_178890_6_.yCoord - (double)p_178890_4_.getY());
+        float var9 = (float)(p_178890_6_.zCoord - (double)p_178890_4_.getZ());
+        boolean var10 = false;
+
+        if (!this.mc.theWorld.getWorldBorder().contains(p_178890_4_))
+        {
+            return false;
+        }
+        else
+        {
+            if (this.currentGameType != WorldSettings.GameType.SPECTATOR)
+            {
+                IBlockState var11 = p_178890_2_.getBlockState(p_178890_4_);
+
+                if ((!p_178890_1_.isSneaking() || p_178890_1_.getHeldItem() == null) && var11.getBlock().onBlockActivated(p_178890_2_, p_178890_4_, var11, p_178890_1_, p_178890_5_, var7, var8, var9))
+                {
+                    var10 = true;
+                }
+
+                if (!var10 && p_178890_3_ != null && p_178890_3_.getItem() instanceof ItemBlock)
+                {
+                    ItemBlock var12 = (ItemBlock)p_178890_3_.getItem();
+
+                    if (!var12.canPlaceBlockOnSide(p_178890_2_, p_178890_4_, p_178890_5_, p_178890_1_, p_178890_3_))
+                    {
+                        return false;
+                    }
+                }
+            }
+
+            this.netClientHandler.addToSendQueue(new C08PacketPlayerBlockPlacement(p_178890_4_, p_178890_5_.getIndex(), p_178890_1_.inventory.getCurrentItem(), var7, var8, var9));
+
+            if (!var10 && this.currentGameType != WorldSettings.GameType.SPECTATOR)
+            {
+                if (p_178890_3_ == null)
+                {
+                    return false;
+                }
+                else if (this.currentGameType.isCreative())
+                {
+                    int var14 = p_178890_3_.getMetadata();
+                    int var15 = p_178890_3_.stackSize;
+                    boolean var13 = p_178890_3_.onItemUse(p_178890_1_, p_178890_2_, p_178890_4_, p_178890_5_, var7, var8, var9);
+                    p_178890_3_.setItemDamage(var14);
+                    p_178890_3_.stackSize = var15;
+                    return var13;
+                }
+                else
+                {
+                    return p_178890_3_.onItemUse(p_178890_1_, p_178890_2_, p_178890_4_, p_178890_5_, var7, var8, var9);
+                }
+            }
+            else
+            {
+                return true;
+            }
+        }
+    }
+
+    /**
+     * Notifies the server of things like consuming food, etc...
+     */
+    public boolean sendUseItem(EntityPlayer playerIn, World worldIn, ItemStack itemStackIn)
+    {
+        if (this.currentGameType == WorldSettings.GameType.SPECTATOR)
+        {
+            return false;
+        }
+        else
+        {
+            this.syncCurrentPlayItem();
+            this.netClientHandler.addToSendQueue(new C08PacketPlayerBlockPlacement(playerIn.inventory.getCurrentItem()));
+            int var4 = itemStackIn.stackSize;
+            ItemStack var5 = itemStackIn.useItemRightClick(worldIn, playerIn);
+
+            if (var5 == itemStackIn && (var5 == null || var5.stackSize == var4))
+            {
+                return false;
+            }
+            else
+            {
+                playerIn.inventory.mainInventory[playerIn.inventory.currentItem] = var5;
+
+                if (var5.stackSize == 0)
+                {
+                    playerIn.inventory.mainInventory[playerIn.inventory.currentItem] = null;
+                }
+
+                return true;
+            }
+        }
+    }
+
+    public EntityPlayerSP func_178892_a(World worldIn, StatFileWriter p_178892_2_)
+    {
+        return new EntityPlayerSP(this.mc, worldIn, this.netClientHandler, p_178892_2_);
+    }
+
+    /**
+     * Attacks an entity
+     */
+    public void attackEntity(EntityPlayer playerIn, Entity targetEntity)
+    {
+        this.syncCurrentPlayItem();
+        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(targetEntity, C02PacketUseEntity.Action.ATTACK));
+
+        if (this.currentGameType != WorldSettings.GameType.SPECTATOR)
+        {
+            playerIn.attackTargetEntityWithCurrentItem(targetEntity);
+        }
+    }
+
+    /**
+     * Send packet to server - player is interacting with another entity (left click)
+     */
+    public boolean interactWithEntitySendPacket(EntityPlayer playerIn, Entity targetEntity)
+    {
+        this.syncCurrentPlayItem();
+        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(targetEntity, C02PacketUseEntity.Action.INTERACT));
+        return this.currentGameType != WorldSettings.GameType.SPECTATOR && playerIn.interactWith(targetEntity);
+    }
+
+    public boolean func_178894_a(EntityPlayer p_178894_1_, Entity p_178894_2_, MovingObjectPosition p_178894_3_)
+    {
+        this.syncCurrentPlayItem();
+        Vec3 var4 = new Vec3(p_178894_3_.hitVec.xCoord - p_178894_2_.posX, p_178894_3_.hitVec.yCoord - p_178894_2_.posY, p_178894_3_.hitVec.zCoord - p_178894_2_.posZ);
+        this.netClientHandler.addToSendQueue(new C02PacketUseEntity(p_178894_2_, var4));
+        return this.currentGameType != WorldSettings.GameType.SPECTATOR && p_178894_2_.func_174825_a(p_178894_1_, var4);
+    }
+
+    /**
+     * Handles slot clicks sends a packet to the server.
+     */
+    public ItemStack windowClick(int windowId, int slotId, int p_78753_3_, int p_78753_4_, EntityPlayer playerIn)
+    {
+        short var6 = playerIn.openContainer.getNextTransactionID(playerIn.inventory);
+        ItemStack var7 = playerIn.openContainer.slotClick(slotId, p_78753_3_, p_78753_4_, playerIn);
+        this.netClientHandler.addToSendQueue(new C0EPacketClickWindow(windowId, slotId, p_78753_3_, p_78753_4_, var7, var6));
+        return var7;
+    }
+
+    /**
+     * GuiEnchantment uses this during multiplayer to tell PlayerControllerMP to send a packet indicating the
+     * enchantment action the player has taken.
+     */
+    public void sendEnchantPacket(int p_78756_1_, int p_78756_2_)
+    {
+        this.netClientHandler.addToSendQueue(new C11PacketEnchantItem(p_78756_1_, p_78756_2_));
+    }
+
+    /**
+     * Used in PlayerControllerMP to update the server with an ItemStack in a slot.
+     */
+    public void sendSlotPacket(ItemStack itemStackIn, int slotId)
+    {
+        if (this.currentGameType.isCreative())
+        {
+            this.netClientHandler.addToSendQueue(new C10PacketCreativeInventoryAction(slotId, itemStackIn));
+        }
+    }
+
+    /**
+     * Sends a Packet107 to the server to drop the item on the ground
+     */
+    public void sendPacketDropItem(ItemStack itemStackIn)
+    {
+        if (this.currentGameType.isCreative() && itemStackIn != null)
+        {
+            this.netClientHandler.addToSendQueue(new C10PacketCreativeInventoryAction(-1, itemStackIn));
+        }
+    }
+
+    public void onStoppedUsingItem(EntityPlayer playerIn)
+    {
+        this.syncCurrentPlayItem();
+        this.netClientHandler.addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.RELEASE_USE_ITEM, BlockPos.ORIGIN, EnumFacing.DOWN));
+        playerIn.stopUsingItem();
+    }
+
+    public boolean gameIsSurvivalOrAdventure()
+    {
+        return this.currentGameType.isSurvivalOrAdventure();
+    }
+
+    /**
+     * Checks if the player is not creative, used for checking if it should break a block instantly
+     */
+    public boolean isNotCreative()
+    {
+        return !this.currentGameType.isCreative();
+    }
+
+    /**
+     * returns true if player is in creative mode
+     */
+    public boolean isInCreativeMode()
+    {
+        return this.currentGameType.isCreative();
+    }
+
+    /**
+     * true for hitting entities far away.
+     */
+    public boolean extendedReach()
+    {
+        return this.currentGameType.isCreative();
+    }
+
+    /**
+     * Checks if the player is riding a horse, used to chose the GUI to open
+     */
+    public boolean isRidingHorse()
+    {
+        return this.mc.thePlayer.isRiding() && this.mc.thePlayer.ridingEntity instanceof EntityHorse;
+    }
+
+    public boolean isSpectatorMode()
+    {
+        return this.currentGameType == WorldSettings.GameType.SPECTATOR;
+    }
+
+    public WorldSettings.GameType func_178889_l()
+    {
+        return this.currentGameType;
+    }
+}
diff --git a/src/net/minecraft/client/multiplayer/ServerList.java b/src/net/minecraft/client/multiplayer/ServerList.java
index 8bfcbea..dd12b7f 100644
--- a/src/net/minecraft/client/multiplayer/ServerList.java
+++ b/src/net/minecraft/client/multiplayer/ServerList.java
@@ -27,6 +27,12 @@ public class ServerList
         this.mc = mcIn;
         this.loadServerList();
     }
+    
+    //TODO: Client
+    public void clearServerList()
+    {
+    	this.servers.clear();
+    }
 
     /**
      * Loads a list of servers from servers.dat, by running ServerData.getServerDataFromNBTCompound on each NBT compound
@@ -95,9 +101,9 @@ public class ServerList
     /**
      * Removes the ServerData instance stored for the given index in the list.
      */
-    public void removeServerData(int p_78851_1_)
+    public void removeServerData(int index)
     {
-        this.servers.remove(p_78851_1_);
+        this.servers.remove(index);
     }
 
     /**
@@ -127,9 +133,9 @@ public class ServerList
         this.saveServerList();
     }
 
-    public void func_147413_a(int p_147413_1_, ServerData p_147413_2_)
+    public void setServer(int index, ServerData server)
     {
-        this.servers.set(p_147413_1_, p_147413_2_);
+        this.servers.set(index, server);
     }
 
     public static void func_147414_b(ServerData p_147414_0_)
@@ -143,7 +149,7 @@ public class ServerList
 
             if (var3.serverName.equals(p_147414_0_.serverName) && var3.serverIP.equals(p_147414_0_.serverIP))
             {
-                var1.func_147413_a(var2, p_147414_0_);
+                var1.setServer(var2, p_147414_0_);
                 break;
             }
         }
diff --git a/src/net/minecraft/client/multiplayer/WorldClient.java b/src/net/minecraft/client/multiplayer/WorldClient.java
index 284bebf..e5a8fef 100644
--- a/src/net/minecraft/client/multiplayer/WorldClient.java
+++ b/src/net/minecraft/client/multiplayer/WorldClient.java
@@ -1,10 +1,12 @@
 package net.minecraft.client.multiplayer;
 
 import com.google.common.collect.Sets;
+
 import java.util.Iterator;
 import java.util.Random;
 import java.util.Set;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.state.IBlockState;
 import net.minecraft.client.Minecraft;
diff --git a/src/net/minecraft/client/network/NetHandlerLoginClient.java b/src/net/minecraft/client/network/NetHandlerLoginClient.java
index 4a4a4f8..cee4b7e 100644
--- a/src/net/minecraft/client/network/NetHandlerLoginClient.java
+++ b/src/net/minecraft/client/network/NetHandlerLoginClient.java
@@ -5,11 +5,15 @@ import com.mojang.authlib.exceptions.AuthenticationException;
 import com.mojang.authlib.exceptions.AuthenticationUnavailableException;
 import com.mojang.authlib.exceptions.InvalidCredentialsException;
 import com.mojang.authlib.minecraft.MinecraftSessionService;
+
 import io.netty.util.concurrent.Future;
 import io.netty.util.concurrent.GenericFutureListener;
+
 import java.math.BigInteger;
 import java.security.PublicKey;
+
 import javax.crypto.SecretKey;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.gui.GuiDisconnected;
 import net.minecraft.client.gui.GuiScreen;
@@ -24,6 +28,7 @@ import net.minecraft.network.login.server.S03PacketEnableCompression;
 import net.minecraft.util.ChatComponentTranslation;
 import net.minecraft.util.CryptManager;
 import net.minecraft.util.IChatComponent;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/network/NetHandlerPlayClient.java b/src/net/minecraft/client/network/NetHandlerPlayClient.java
index dd6c06e..bee0b73 100644
--- a/src/net/minecraft/client/network/NetHandlerPlayClient.java
+++ b/src/net/minecraft/client/network/NetHandlerPlayClient.java
@@ -4,7 +4,9 @@ import com.google.common.collect.Maps;
 import com.google.common.util.concurrent.FutureCallback;
 import com.google.common.util.concurrent.Futures;
 import com.mojang.authlib.GameProfile;
+
 import io.netty.buffer.Unpooled;
+
 import java.io.File;
 import java.io.IOException;
 import java.util.Collection;
@@ -14,6 +16,7 @@ import java.util.Map;
 import java.util.Random;
 import java.util.UUID;
 import java.util.Map.Entry;
+
 import net.minecraft.block.Block;
 import net.minecraft.client.ClientBrandRetriever;
 import net.minecraft.client.Minecraft;
@@ -209,6 +212,7 @@ import net.minecraft.world.WorldProviderSurface;
 import net.minecraft.world.WorldSettings;
 import net.minecraft.world.chunk.Chunk;
 import net.minecraft.world.storage.MapData;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
@@ -540,7 +544,7 @@ public class NetHandlerPlayClient implements INetHandlerPlayClient
         double var6 = (double)packetIn.func_148946_h() / 32.0D;
         float var8 = (float)(packetIn.func_148941_i() * 360) / 256.0F;
         float var9 = (float)(packetIn.func_148945_j() * 360) / 256.0F;
-        EntityOtherPlayerMP var10 = new EntityOtherPlayerMP(this.gameController.theWorld, this.func_175102_a(packetIn.func_179819_c()).func_178845_a());
+        EntityOtherPlayerMP var10 = new EntityOtherPlayerMP(this.gameController.theWorld, this.func_175102_a(packetIn.func_179819_c()).getGameProfile());
         var10.prevPosX = var10.lastTickPosX = (double)(var10.serverPosX = packetIn.func_148942_f());
         var10.prevPosY = var10.lastTickPosY = (double)(var10.serverPosY = packetIn.func_148949_g());
         var10.prevPosZ = var10.lastTickPosZ = (double)(var10.serverPosZ = packetIn.func_148946_h());
@@ -1642,7 +1646,7 @@ public class NetHandlerPlayClient implements INetHandlerPlayClient
                 if (packetIn.func_179768_b() == S38PacketPlayerListItem.Action.ADD_PLAYER)
                 {
                     var4 = new NetworkPlayerInfo(var3);
-                    this.playerInfoMap.put(var4.func_178845_a().getId(), var4);
+                    this.playerInfoMap.put(var4.getGameProfile().getId(), var4);
                 }
 
                 if (var4 != null)
@@ -1650,16 +1654,16 @@ public class NetHandlerPlayClient implements INetHandlerPlayClient
                     switch (NetHandlerPlayClient.SwitchAction.field_178884_b[packetIn.func_179768_b().ordinal()])
                     {
                         case 1:
-                            var4.func_178839_a(var3.func_179960_c());
-                            var4.func_178838_a(var3.func_179963_b());
+                            var4.setGameType(var3.func_179960_c());
+                            var4.setResponseTime(var3.func_179963_b());
                             break;
 
                         case 2:
-                            var4.func_178839_a(var3.func_179960_c());
+                            var4.setGameType(var3.func_179960_c());
                             break;
 
                         case 3:
-                            var4.func_178838_a(var3.func_179963_b());
+                            var4.setResponseTime(var3.func_179963_b());
                             break;
 
                         case 4:
@@ -2121,7 +2125,7 @@ public class NetHandlerPlayClient implements INetHandlerPlayClient
         return this.netManager;
     }
 
-    public Collection func_175106_d()
+    public Collection getPlayerInfo()
     {
         return this.playerInfoMap.values();
     }
@@ -2145,7 +2149,7 @@ public class NetHandlerPlayClient implements INetHandlerPlayClient
 
             var3 = (NetworkPlayerInfo)var2.next();
         }
-        while (!var3.func_178845_a().getName().equals(p_175104_1_));
+        while (!var3.getGameProfile().getName().equals(p_175104_1_));
 
         return var3;
     }
diff --git a/src/net/minecraft/client/network/NetworkPlayerInfo.java b/src/net/minecraft/client/network/NetworkPlayerInfo.java
index f5f680b..7260387 100644
--- a/src/net/minecraft/client/network/NetworkPlayerInfo.java
+++ b/src/net/minecraft/client/network/NetworkPlayerInfo.java
@@ -4,6 +4,7 @@ import com.google.common.base.Objects;
 import com.mojang.authlib.GameProfile;
 import com.mojang.authlib.minecraft.MinecraftProfileTexture;
 import com.mojang.authlib.minecraft.MinecraftProfileTexture.Type;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.resources.DefaultPlayerSkin;
 import net.minecraft.client.resources.SkinManager;
@@ -15,7 +16,7 @@ import net.minecraft.world.WorldSettings;
 
 public class NetworkPlayerInfo
 {
-    private final GameProfile field_178867_a;
+    private final GameProfile gameProfile;
     private WorldSettings.GameType gameType;
 
     /** Player response time to server in milliseconds */
@@ -23,8 +24,8 @@ public class NetworkPlayerInfo
     private boolean field_178864_d = false;
     private ResourceLocation field_178865_e;
     private ResourceLocation field_178862_f;
-    private String field_178863_g;
-    private IChatComponent field_178872_h;
+    private String name;
+    private IChatComponent playerName;
     private int field_178873_i = 0;
     private int field_178870_j = 0;
     private long field_178871_k = 0L;
@@ -34,19 +35,19 @@ public class NetworkPlayerInfo
 
     public NetworkPlayerInfo(GameProfile p_i46294_1_)
     {
-        this.field_178867_a = p_i46294_1_;
+        this.gameProfile = p_i46294_1_;
     }
 
     public NetworkPlayerInfo(S38PacketPlayerListItem.AddPlayerData p_i46295_1_)
     {
-        this.field_178867_a = p_i46295_1_.func_179962_a();
+        this.gameProfile = p_i46295_1_.func_179962_a();
         this.gameType = p_i46295_1_.func_179960_c();
         this.responseTime = p_i46295_1_.func_179963_b();
     }
 
-    public GameProfile func_178845_a()
+    public GameProfile getGameProfile()
     {
-        return this.field_178867_a;
+        return this.gameProfile;
     }
 
     public WorldSettings.GameType getGameType()
@@ -59,14 +60,14 @@ public class NetworkPlayerInfo
         return this.responseTime;
     }
 
-    protected void func_178839_a(WorldSettings.GameType p_178839_1_)
+    protected void setGameType(WorldSettings.GameType gameType)
     {
-        this.gameType = p_178839_1_;
+        this.gameType = gameType;
     }
 
-    protected void func_178838_a(int p_178838_1_)
+    protected void setResponseTime(int responseTime)
     {
-        this.responseTime = p_178838_1_;
+        this.responseTime = responseTime;
     }
 
     public boolean func_178856_e()
@@ -74,9 +75,9 @@ public class NetworkPlayerInfo
         return this.field_178865_e != null;
     }
 
-    public String func_178851_f()
+    public String getModelName()
     {
-        return this.field_178863_g == null ? DefaultPlayerSkin.func_177332_b(this.field_178867_a.getId()) : this.field_178863_g;
+        return this.name == null ? DefaultPlayerSkin.getModelNameFromUUID(this.gameProfile.getId()) : this.name;
     }
 
     public ResourceLocation func_178837_g()
@@ -86,7 +87,7 @@ public class NetworkPlayerInfo
             this.func_178841_j();
         }
 
-        return (ResourceLocation)Objects.firstNonNull(this.field_178865_e, DefaultPlayerSkin.func_177334_a(this.field_178867_a.getId()));
+        return (ResourceLocation)Objects.firstNonNull(this.field_178865_e, DefaultPlayerSkin.getLocationFromUUID(this.gameProfile.getId()));
     }
 
     public ResourceLocation func_178861_h()
@@ -99,9 +100,9 @@ public class NetworkPlayerInfo
         return this.field_178862_f;
     }
 
-    public ScorePlayerTeam func_178850_i()
+    public ScorePlayerTeam getScoreTeam()
     {
-        return Minecraft.getMinecraft().theWorld.getScoreboard().getPlayersTeam(this.func_178845_a().getName());
+        return Minecraft.getMinecraft().theWorld.getScoreboard().getPlayersTeam(this.getGameProfile().getName());
     }
 
     protected void func_178841_j()
@@ -111,7 +112,7 @@ public class NetworkPlayerInfo
             if (!this.field_178864_d)
             {
                 this.field_178864_d = true;
-                Minecraft.getMinecraft().getSkinManager().func_152790_a(this.field_178867_a, new SkinManager.SkinAvailableCallback()
+                Minecraft.getMinecraft().getSkinManager().func_152790_a(this.gameProfile, new SkinManager.SkinAvailableCallback()
                 {
                     private static final String __OBFID = "CL_00002619";
                     public void func_180521_a(Type p_180521_1_, ResourceLocation p_180521_2_, MinecraftProfileTexture p_180521_3_)
@@ -120,11 +121,11 @@ public class NetworkPlayerInfo
                         {
                             case 1:
                                 NetworkPlayerInfo.this.field_178865_e = p_180521_2_;
-                                NetworkPlayerInfo.this.field_178863_g = p_180521_3_.getMetadata("model");
+                                NetworkPlayerInfo.this.name = p_180521_3_.getMetadata("model");
 
-                                if (NetworkPlayerInfo.this.field_178863_g == null)
+                                if (NetworkPlayerInfo.this.name == null)
                                 {
-                                    NetworkPlayerInfo.this.field_178863_g = "default";
+                                    NetworkPlayerInfo.this.name = "default";
                                 }
 
                                 break;
@@ -140,12 +141,18 @@ public class NetworkPlayerInfo
 
     public void func_178859_a(IChatComponent p_178859_1_)
     {
-        this.field_178872_h = p_178859_1_;
+        this.playerName = p_178859_1_;
+    }
+
+    public IChatComponent getPlayerName()
+    {
+        return this.playerName;
     }
 
-    public IChatComponent func_178854_k()
+    //TODO: Client
+    public String getPlayerNameForReal()
     {
-        return this.field_178872_h;
+        return this.getPlayerName() != null ? this.getPlayerName().getFormattedText() : ScorePlayerTeam.formatPlayerName(this.getScoreTeam(), this.getGameProfile().getName());
     }
 
     public int func_178835_l()
diff --git a/src/net/minecraft/client/network/OldServerPinger.java b/src/net/minecraft/client/network/OldServerPinger.java
index 4fa3c4e..25169cc 100644
--- a/src/net/minecraft/client/network/OldServerPinger.java
+++ b/src/net/minecraft/client/network/OldServerPinger.java
@@ -5,6 +5,7 @@ import com.google.common.base.Splitter;
 import com.google.common.collect.Iterables;
 import com.google.common.collect.Lists;
 import com.mojang.authlib.GameProfile;
+
 import io.netty.bootstrap.Bootstrap;
 import io.netty.buffer.ByteBuf;
 import io.netty.buffer.Unpooled;
@@ -18,11 +19,13 @@ import io.netty.channel.ChannelOption;
 import io.netty.channel.EventLoopGroup;
 import io.netty.channel.SimpleChannelInboundHandler;
 import io.netty.channel.socket.nio.NioSocketChannel;
+
 import java.net.InetAddress;
 import java.net.UnknownHostException;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.multiplayer.ServerAddress;
 import net.minecraft.client.multiplayer.ServerData;
@@ -39,6 +42,7 @@ import net.minecraft.util.ChatComponentText;
 import net.minecraft.util.EnumChatFormatting;
 import net.minecraft.util.IChatComponent;
 import net.minecraft.util.MathHelper;
+
 import org.apache.commons.lang3.ArrayUtils;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
diff --git a/src/net/minecraft/client/particle/Barrier.java b/src/net/minecraft/client/particle/Barrier.java
index d450e62..b06c385 100644
--- a/src/net/minecraft/client/particle/Barrier.java
+++ b/src/net/minecraft/client/particle/Barrier.java
@@ -35,7 +35,7 @@ public class Barrier extends EntityFX
         float var13 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)p_180434_3_ - interpPosX);
         float var14 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)p_180434_3_ - interpPosY);
         float var15 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_180434_3_ - interpPosZ);
-        p_180434_1_.func_178986_b(this.particleRed, this.particleGreen, this.particleBlue);
+        p_180434_1_.setColorOpaque_F(this.particleRed, this.particleGreen, this.particleBlue);
         float var16 = 0.5F;
         p_180434_1_.addVertexWithUV((double)(var13 - p_180434_4_ * var16 - p_180434_7_ * var16), (double)(var14 - p_180434_5_ * var16), (double)(var15 - p_180434_6_ * var16 - p_180434_8_ * var16), (double)var10, (double)var12);
         p_180434_1_.addVertexWithUV((double)(var13 - p_180434_4_ * var16 + p_180434_7_ * var16), (double)(var14 + p_180434_5_ * var16), (double)(var15 - p_180434_6_ * var16 + p_180434_8_ * var16), (double)var10, (double)var11);
diff --git a/src/net/minecraft/client/particle/EffectRenderer.java b/src/net/minecraft/client/particle/EffectRenderer.java
index cba3c5c..dfe81bd 100644
--- a/src/net/minecraft/client/particle/EffectRenderer.java
+++ b/src/net/minecraft/client/particle/EffectRenderer.java
@@ -2,12 +2,14 @@ package net.minecraft.client.particle;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 import java.util.Random;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.material.Material;
 import net.minecraft.block.state.IBlockState;
diff --git a/src/net/minecraft/client/particle/EntityBreakingFX.java b/src/net/minecraft/client/particle/EntityBreakingFX.java
index ede5178..38cd702 100644
--- a/src/net/minecraft/client/particle/EntityBreakingFX.java
+++ b/src/net/minecraft/client/particle/EntityBreakingFX.java
@@ -61,7 +61,7 @@ public class EntityBreakingFX extends EntityFX
         float var14 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)p_180434_3_ - interpPosX);
         float var15 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)p_180434_3_ - interpPosY);
         float var16 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_180434_3_ - interpPosZ);
-        p_180434_1_.func_178986_b(this.particleRed, this.particleGreen, this.particleBlue);
+        p_180434_1_.setColorOpaque_F(this.particleRed, this.particleGreen, this.particleBlue);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 - p_180434_7_ * var13), (double)(var15 - p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 - p_180434_8_ * var13), (double)var9, (double)var12);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 + p_180434_8_ * var13), (double)var9, (double)var11);
         p_180434_1_.addVertexWithUV((double)(var14 + p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 + p_180434_6_ * var13 + p_180434_8_ * var13), (double)var10, (double)var11);
diff --git a/src/net/minecraft/client/particle/EntityDiggingFX.java b/src/net/minecraft/client/particle/EntityDiggingFX.java
index f1035f6..13eed07 100644
--- a/src/net/minecraft/client/particle/EntityDiggingFX.java
+++ b/src/net/minecraft/client/particle/EntityDiggingFX.java
@@ -82,7 +82,7 @@ public class EntityDiggingFX extends EntityFX
         float var14 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)p_180434_3_ - interpPosX);
         float var15 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)p_180434_3_ - interpPosY);
         float var16 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_180434_3_ - interpPosZ);
-        p_180434_1_.func_178986_b(this.particleRed, this.particleGreen, this.particleBlue);
+        p_180434_1_.setColorOpaque_F(this.particleRed, this.particleGreen, this.particleBlue);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 - p_180434_7_ * var13), (double)(var15 - p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 - p_180434_8_ * var13), (double)var9, (double)var12);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 + p_180434_8_ * var13), (double)var9, (double)var11);
         p_180434_1_.addVertexWithUV((double)(var14 + p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 + p_180434_6_ * var13 + p_180434_8_ * var13), (double)var10, (double)var11);
diff --git a/src/net/minecraft/client/particle/EntityFX.java b/src/net/minecraft/client/particle/EntityFX.java
index bdbe2f0..4ddd93c 100644
--- a/src/net/minecraft/client/particle/EntityFX.java
+++ b/src/net/minecraft/client/particle/EntityFX.java
@@ -188,7 +188,7 @@ public class EntityFX extends Entity
         float var14 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)p_180434_3_ - interpPosX);
         float var15 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)p_180434_3_ - interpPosY);
         float var16 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_180434_3_ - interpPosZ);
-        p_180434_1_.func_178960_a(this.particleRed, this.particleGreen, this.particleBlue, this.particleAlpha);
+        p_180434_1_.setColorRGBA_F(this.particleRed, this.particleGreen, this.particleBlue, this.particleAlpha);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 - p_180434_7_ * var13), (double)(var15 - p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 - p_180434_8_ * var13), (double)var10, (double)var12);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 + p_180434_8_ * var13), (double)var10, (double)var11);
         p_180434_1_.addVertexWithUV((double)(var14 + p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 + p_180434_6_ * var13 + p_180434_8_ * var13), (double)var9, (double)var11);
diff --git a/src/net/minecraft/client/particle/EntityFireworkOverlayFX.java b/src/net/minecraft/client/particle/EntityFireworkOverlayFX.java
index 1a7ed22..0a4bfbb 100644
--- a/src/net/minecraft/client/particle/EntityFireworkOverlayFX.java
+++ b/src/net/minecraft/client/particle/EntityFireworkOverlayFX.java
@@ -26,7 +26,7 @@ public class EntityFireworkOverlayFX extends EntityFX
         float var14 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)p_180434_3_ - interpPosX);
         float var15 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)p_180434_3_ - interpPosY);
         float var16 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_180434_3_ - interpPosZ);
-        p_180434_1_.func_178960_a(this.particleRed, this.particleGreen, this.particleBlue, this.particleAlpha);
+        p_180434_1_.setColorRGBA_F(this.particleRed, this.particleGreen, this.particleBlue, this.particleAlpha);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 - p_180434_7_ * var13), (double)(var15 - p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 - p_180434_8_ * var13), (double)var10, (double)var12);
         p_180434_1_.addVertexWithUV((double)(var14 - p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 - p_180434_6_ * var13 + p_180434_8_ * var13), (double)var10, (double)var11);
         p_180434_1_.addVertexWithUV((double)(var14 + p_180434_4_ * var13 + p_180434_7_ * var13), (double)(var15 + p_180434_5_ * var13), (double)(var16 + p_180434_6_ * var13 + p_180434_8_ * var13), (double)var9, (double)var11);
diff --git a/src/net/minecraft/client/particle/EntityFootStepFX.java b/src/net/minecraft/client/particle/EntityFootStepFX.java
index 462000b..81f8cc2 100644
--- a/src/net/minecraft/client/particle/EntityFootStepFX.java
+++ b/src/net/minecraft/client/particle/EntityFootStepFX.java
@@ -48,7 +48,7 @@ public class EntityFootStepFX extends EntityFX
         GlStateManager.enableBlend();
         GlStateManager.blendFunc(770, 771);
         p_180434_1_.startDrawingQuads();
-        p_180434_1_.func_178960_a(var15, var15, var15, var10);
+        p_180434_1_.setColorRGBA_F(var15, var15, var15, var10);
         p_180434_1_.addVertexWithUV((double)(var12 - var11), (double)var13, (double)(var14 + var11), 0.0D, 1.0D);
         p_180434_1_.addVertexWithUV((double)(var12 + var11), (double)var13, (double)(var14 + var11), 1.0D, 1.0D);
         p_180434_1_.addVertexWithUV((double)(var12 + var11), (double)var13, (double)(var14 - var11), 1.0D, 0.0D);
diff --git a/src/net/minecraft/client/particle/EntityLargeExplodeFX.java b/src/net/minecraft/client/particle/EntityLargeExplodeFX.java
index 21fdc5b..db0bbb6 100644
--- a/src/net/minecraft/client/particle/EntityLargeExplodeFX.java
+++ b/src/net/minecraft/client/particle/EntityLargeExplodeFX.java
@@ -49,7 +49,7 @@ public class EntityLargeExplodeFX extends EntityFX
             GlStateManager.disableLighting();
             RenderHelper.disableStandardItemLighting();
             p_180434_1_.startDrawingQuads();
-            p_180434_1_.func_178960_a(this.particleRed, this.particleGreen, this.particleBlue, 1.0F);
+            p_180434_1_.setColorRGBA_F(this.particleRed, this.particleGreen, this.particleBlue, 1.0F);
             p_180434_1_.func_178980_d(0.0F, 1.0F, 0.0F);
             p_180434_1_.func_178963_b(240);
             p_180434_1_.addVertexWithUV((double)(var15 - p_180434_4_ * var14 - p_180434_7_ * var14), (double)(var16 - p_180434_5_ * var14), (double)(var17 - p_180434_6_ * var14 - p_180434_8_ * var14), (double)var11, (double)var13);
diff --git a/src/net/minecraft/client/renderer/BlockFluidRenderer.java b/src/net/minecraft/client/renderer/BlockFluidRenderer.java
index 13aedf6..b98e79f 100644
--- a/src/net/minecraft/client/renderer/BlockFluidRenderer.java
+++ b/src/net/minecraft/client/renderer/BlockFluidRenderer.java
@@ -118,7 +118,7 @@ public class BlockFluidRenderer
                 }
 
                 p_178270_4_.func_178963_b(var5.getMixedBrightnessForBlock(p_178270_1_, p_178270_3_));
-                p_178270_4_.func_178986_b(var16 * var8, var16 * var9, var16 * var10);
+                p_178270_4_.setColorOpaque_F(var16 * var8, var16 * var9, var16 * var10);
                 p_178270_4_.addVertexWithUV(var24 + 0.0D, var26 + (double)var20, var28 + 0.0D, (double)var33, (double)var37);
                 p_178270_4_.addVertexWithUV(var24 + 0.0D, var26 + (double)var21, var28 + 1.0D, (double)var34, (double)var38);
                 p_178270_4_.addVertexWithUV(var24 + 1.0D, var26 + (double)var22, var28 + 1.0D, (double)var35, (double)var39);
@@ -136,7 +136,7 @@ public class BlockFluidRenderer
             if (var12)
             {
                 p_178270_4_.func_178963_b(var5.getMixedBrightnessForBlock(p_178270_1_, p_178270_3_.offsetDown()));
-                p_178270_4_.func_178986_b(var15, var15, var15);
+                p_178270_4_.setColorOpaque_F(var15, var15, var15);
                 var32 = var6[0].getMinU();
                 var33 = var6[0].getMaxU();
                 var34 = var6[0].getMinV();
@@ -229,7 +229,7 @@ public class BlockFluidRenderer
                     p_178270_4_.func_178963_b(var5.getMixedBrightnessForBlock(p_178270_1_, var55));
                     float var51 = 1.0F;
                     var51 *= var52 < 2 ? var17 : var18;
-                    p_178270_4_.func_178986_b(var16 * var51 * var8, var16 * var51 * var9, var16 * var51 * var10);
+                    p_178270_4_.setColorOpaque_F(var16 * var51 * var8, var16 * var51 * var9, var16 * var51 * var10);
                     p_178270_4_.addVertexWithUV(var56, var26 + (double)var36, var57, (double)var46, (double)var48);
                     p_178270_4_.addVertexWithUV(var58, var26 + (double)var37, var44, (double)var47, (double)var49);
                     p_178270_4_.addVertexWithUV(var58, var26 + 0.0D, var44, (double)var47, (double)var50);
diff --git a/src/net/minecraft/client/renderer/BlockModelRenderer.java b/src/net/minecraft/client/renderer/BlockModelRenderer.java
index e9db01f..18cbc00 100644
--- a/src/net/minecraft/client/renderer/BlockModelRenderer.java
+++ b/src/net/minecraft/client/renderer/BlockModelRenderer.java
@@ -3,6 +3,7 @@ package net.minecraft.client.renderer;
 import java.util.BitSet;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.state.IBlockState;
 import net.minecraft.client.Minecraft;
diff --git a/src/net/minecraft/client/renderer/EntityRenderer.java b/src/net/minecraft/client/renderer/EntityRenderer.java
index e32c68b..654ae1c 100644
--- a/src/net/minecraft/client/renderer/EntityRenderer.java
+++ b/src/net/minecraft/client/renderer/EntityRenderer.java
@@ -1,2052 +1,2095 @@
-package net.minecraft.client.renderer;
-
-import com.google.gson.JsonSyntaxException;
-import java.io.IOException;
-import java.nio.FloatBuffer;
-import java.util.List;
-import java.util.Random;
-import java.util.concurrent.Callable;
-import net.minecraft.block.Block;
-import net.minecraft.block.BlockBed;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.entity.AbstractClientPlayer;
-import net.minecraft.client.gui.MapItemRenderer;
-import net.minecraft.client.gui.ScaledResolution;
-import net.minecraft.client.multiplayer.WorldClient;
-import net.minecraft.client.particle.EffectRenderer;
-import net.minecraft.client.renderer.culling.ClippingHelperImpl;
-import net.minecraft.client.renderer.culling.Frustrum;
-import net.minecraft.client.renderer.texture.DynamicTexture;
-import net.minecraft.client.renderer.texture.TextureMap;
-import net.minecraft.client.resources.IResourceManager;
-import net.minecraft.client.resources.IResourceManagerReloadListener;
-import net.minecraft.client.shader.ShaderGroup;
-import net.minecraft.client.shader.ShaderLinkHelper;
-import net.minecraft.crash.CrashReport;
-import net.minecraft.crash.CrashReportCategory;
-import net.minecraft.enchantment.EnchantmentHelper;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.boss.BossStatus;
-import net.minecraft.entity.item.EntityItemFrame;
-import net.minecraft.entity.monster.EntityCreeper;
-import net.minecraft.entity.monster.EntityEnderman;
-import net.minecraft.entity.monster.EntitySpider;
-import net.minecraft.entity.passive.EntityAnimal;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.init.Blocks;
-import net.minecraft.inventory.IInventory;
-import net.minecraft.item.ItemStack;
-import net.minecraft.potion.Potion;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.EnumWorldBlockLayer;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.MouseFilter;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ReportedException;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.WorldSettings;
-import net.minecraft.world.biome.BiomeGenBase;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.input.Mouse;
-import org.lwjgl.opengl.Display;
-import org.lwjgl.opengl.GL11;
-import org.lwjgl.opengl.GLContext;
-import org.lwjgl.util.glu.Project;
-
-public class EntityRenderer implements IResourceManagerReloadListener
-{
-    private static final Logger logger = LogManager.getLogger();
-    private static final ResourceLocation locationRainPng = new ResourceLocation("textures/environment/rain.png");
-    private static final ResourceLocation locationSnowPng = new ResourceLocation("textures/environment/snow.png");
-    public static boolean anaglyphEnable;
-
-    /** Anaglyph field (0=R, 1=GB) */
-    public static int anaglyphField;
-
-    /** A reference to the Minecraft object. */
-    private Minecraft mc;
-    private final IResourceManager resourceManager;
-    private Random random = new Random();
-    private float farPlaneDistance;
-    public final ItemRenderer itemRenderer;
-    private final MapItemRenderer theMapItemRenderer;
-
-    /** Entity renderer update count */
-    private int rendererUpdateCount;
-
-    /** Pointed entity */
-    private Entity pointedEntity;
-    private MouseFilter mouseFilterXAxis = new MouseFilter();
-    private MouseFilter mouseFilterYAxis = new MouseFilter();
-    private float thirdPersonDistance = 4.0F;
-
-    /** Third person distance temp */
-    private float thirdPersonDistanceTemp = 4.0F;
-
-    /** Smooth cam yaw */
-    private float smoothCamYaw;
-
-    /** Smooth cam pitch */
-    private float smoothCamPitch;
-
-    /** Smooth cam filter X */
-    private float smoothCamFilterX;
-
-    /** Smooth cam filter Y */
-    private float smoothCamFilterY;
-
-    /** Smooth cam partial ticks */
-    private float smoothCamPartialTicks;
-
-    /** FOV modifier hand */
-    private float fovModifierHand;
-
-    /** FOV modifier hand prev */
-    private float fovModifierHandPrev;
-    private float bossColorModifier;
-    private float bossColorModifierPrev;
-
-    /** Cloud fog mode */
-    private boolean cloudFog;
-    private boolean field_175074_C = true;
-    private boolean field_175073_D = true;
-
-    /** Previous frame time in milliseconds */
-    private long prevFrameTime = Minecraft.getSystemTime();
-
-    /** End time of last render (ns) */
-    private long renderEndNanoTime;
-
-    /**
-     * The texture id of the blocklight/skylight texture used for lighting effects
-     */
-    private final DynamicTexture lightmapTexture;
-
-    /**
-     * Colors computed in updateLightmap() and loaded into the lightmap emptyTexture
-     */
-    private final int[] lightmapColors;
-    private final ResourceLocation locationLightMap;
-
-    /**
-     * Is set, updateCameraAndRender() calls updateLightmap(); set by updateTorchFlicker()
-     */
-    private boolean lightmapUpdateNeeded;
-
-    /** Torch flicker X */
-    private float torchFlickerX;
-    private float field_175075_L;
-
-    /** Rain sound counter */
-    private int rainSoundCounter;
-    private float[] field_175076_N = new float[1024];
-    private float[] field_175077_O = new float[1024];
-
-    /** Fog color buffer */
-    private FloatBuffer fogColorBuffer = GLAllocation.createDirectFloatBuffer(16);
-    private float field_175080_Q;
-    private float field_175082_R;
-    private float field_175081_S;
-
-    /** Fog color 2 */
-    private float fogColor2;
-
-    /** Fog color 1 */
-    private float fogColor1;
-    private int field_175079_V = 0;
-    private boolean field_175078_W = false;
-    private double cameraZoom = 1.0D;
-    private double cameraYaw;
-    private double cameraPitch;
-    private ShaderGroup theShaderGroup;
-    private static final ResourceLocation[] shaderResourceLocations = new ResourceLocation[] {new ResourceLocation("shaders/post/notch.json"), new ResourceLocation("shaders/post/fxaa.json"), new ResourceLocation("shaders/post/art.json"), new ResourceLocation("shaders/post/bumpy.json"), new ResourceLocation("shaders/post/blobs2.json"), new ResourceLocation("shaders/post/pencil.json"), new ResourceLocation("shaders/post/color_convolve.json"), new ResourceLocation("shaders/post/deconverge.json"), new ResourceLocation("shaders/post/flip.json"), new ResourceLocation("shaders/post/invert.json"), new ResourceLocation("shaders/post/ntsc.json"), new ResourceLocation("shaders/post/outline.json"), new ResourceLocation("shaders/post/phosphor.json"), new ResourceLocation("shaders/post/scan_pincushion.json"), new ResourceLocation("shaders/post/sobel.json"), new ResourceLocation("shaders/post/bits.json"), new ResourceLocation("shaders/post/desaturate.json"), new ResourceLocation("shaders/post/green.json"), new ResourceLocation("shaders/post/blur.json"), new ResourceLocation("shaders/post/wobble.json"), new ResourceLocation("shaders/post/blobs.json"), new ResourceLocation("shaders/post/antialias.json"), new ResourceLocation("shaders/post/creeper.json"), new ResourceLocation("shaders/post/spider.json")};
-    public static final int shaderCount = shaderResourceLocations.length;
-    private int shaderIndex;
-    private boolean field_175083_ad;
-    private int field_175084_ae;
-    private static final String __OBFID = "CL_00000947";
-
-    public EntityRenderer(Minecraft mcIn, IResourceManager p_i45076_2_)
-    {
-        this.shaderIndex = shaderCount;
-        this.field_175083_ad = false;
-        this.field_175084_ae = 0;
-        this.mc = mcIn;
-        this.resourceManager = p_i45076_2_;
-        this.itemRenderer = mcIn.getItemRenderer();
-        this.theMapItemRenderer = new MapItemRenderer(mcIn.getTextureManager());
-        this.lightmapTexture = new DynamicTexture(16, 16);
-        this.locationLightMap = mcIn.getTextureManager().getDynamicTextureLocation("lightMap", this.lightmapTexture);
-        this.lightmapColors = this.lightmapTexture.getTextureData();
-        this.theShaderGroup = null;
-
-        for (int var3 = 0; var3 < 32; ++var3)
-        {
-            for (int var4 = 0; var4 < 32; ++var4)
-            {
-                float var5 = (float)(var4 - 16);
-                float var6 = (float)(var3 - 16);
-                float var7 = MathHelper.sqrt_float(var5 * var5 + var6 * var6);
-                this.field_175076_N[var3 << 5 | var4] = -var6 / var7;
-                this.field_175077_O[var3 << 5 | var4] = var5 / var7;
-            }
-        }
-    }
-
-    public boolean isShaderActive()
-    {
-        return OpenGlHelper.shadersSupported && this.theShaderGroup != null;
-    }
-
-    public void func_175071_c()
-    {
-        this.field_175083_ad = !this.field_175083_ad;
-    }
-
-    public void func_175066_a(Entity p_175066_1_)
-    {
-        if (OpenGlHelper.shadersSupported)
-        {
-            if (this.theShaderGroup != null)
-            {
-                this.theShaderGroup.deleteShaderGroup();
-            }
-
-            this.theShaderGroup = null;
-
-            if (p_175066_1_ instanceof EntityCreeper)
-            {
-                this.func_175069_a(new ResourceLocation("shaders/post/creeper.json"));
-            }
-            else if (p_175066_1_ instanceof EntitySpider)
-            {
-                this.func_175069_a(new ResourceLocation("shaders/post/spider.json"));
-            }
-            else if (p_175066_1_ instanceof EntityEnderman)
-            {
-                this.func_175069_a(new ResourceLocation("shaders/post/invert.json"));
-            }
-        }
-    }
-
-    public void activateNextShader()
-    {
-        if (OpenGlHelper.shadersSupported)
-        {
-            if (this.mc.func_175606_aa() instanceof EntityPlayer)
-            {
-                if (this.theShaderGroup != null)
-                {
-                    this.theShaderGroup.deleteShaderGroup();
-                }
-
-                this.shaderIndex = (this.shaderIndex + 1) % (shaderResourceLocations.length + 1);
-
-                if (this.shaderIndex != shaderCount)
-                {
-                    this.func_175069_a(shaderResourceLocations[this.shaderIndex]);
-                }
-                else
-                {
-                    this.theShaderGroup = null;
-                }
-            }
-        }
-    }
-
-    private void func_175069_a(ResourceLocation p_175069_1_)
-    {
-        try
-        {
-            this.theShaderGroup = new ShaderGroup(this.mc.getTextureManager(), this.resourceManager, this.mc.getFramebuffer(), p_175069_1_);
-            this.theShaderGroup.createBindFramebuffers(this.mc.displayWidth, this.mc.displayHeight);
-            this.field_175083_ad = true;
-        }
-        catch (IOException var3)
-        {
-            logger.warn("Failed to load shader: " + p_175069_1_, var3);
-            this.shaderIndex = shaderCount;
-            this.field_175083_ad = false;
-        }
-        catch (JsonSyntaxException var4)
-        {
-            logger.warn("Failed to load shader: " + p_175069_1_, var4);
-            this.shaderIndex = shaderCount;
-            this.field_175083_ad = false;
-        }
-    }
-
-    public void onResourceManagerReload(IResourceManager p_110549_1_)
-    {
-        if (this.theShaderGroup != null)
-        {
-            this.theShaderGroup.deleteShaderGroup();
-        }
-
-        this.theShaderGroup = null;
-
-        if (this.shaderIndex != shaderCount)
-        {
-            this.func_175069_a(shaderResourceLocations[this.shaderIndex]);
-        }
-        else
-        {
-            this.func_175066_a(this.mc.func_175606_aa());
-        }
-    }
-
-    /**
-     * Updates the entity renderer
-     */
-    public void updateRenderer()
-    {
-        if (OpenGlHelper.shadersSupported && ShaderLinkHelper.getStaticShaderLinkHelper() == null)
-        {
-            ShaderLinkHelper.setNewStaticShaderLinkHelper();
-        }
-
-        this.updateFovModifierHand();
-        this.updateTorchFlicker();
-        this.fogColor2 = this.fogColor1;
-        this.thirdPersonDistanceTemp = this.thirdPersonDistance;
-        float var1;
-        float var2;
-
-        if (this.mc.gameSettings.smoothCamera)
-        {
-            var1 = this.mc.gameSettings.mouseSensitivity * 0.6F + 0.2F;
-            var2 = var1 * var1 * var1 * 8.0F;
-            this.smoothCamFilterX = this.mouseFilterXAxis.smooth(this.smoothCamYaw, 0.05F * var2);
-            this.smoothCamFilterY = this.mouseFilterYAxis.smooth(this.smoothCamPitch, 0.05F * var2);
-            this.smoothCamPartialTicks = 0.0F;
-            this.smoothCamYaw = 0.0F;
-            this.smoothCamPitch = 0.0F;
-        }
-        else
-        {
-            this.smoothCamFilterX = 0.0F;
-            this.smoothCamFilterY = 0.0F;
-            this.mouseFilterXAxis.func_180179_a();
-            this.mouseFilterYAxis.func_180179_a();
-        }
-
-        if (this.mc.func_175606_aa() == null)
-        {
-            this.mc.func_175607_a(this.mc.thePlayer);
-        }
-
-        var1 = this.mc.theWorld.getLightBrightness(new BlockPos(this.mc.func_175606_aa()));
-        var2 = (float)this.mc.gameSettings.renderDistanceChunks / 32.0F;
-        float var3 = var1 * (1.0F - var2) + var2;
-        this.fogColor1 += (var3 - this.fogColor1) * 0.1F;
-        ++this.rendererUpdateCount;
-        this.itemRenderer.updateEquippedItem();
-        this.addRainParticles();
-        this.bossColorModifierPrev = this.bossColorModifier;
-
-        if (BossStatus.hasColorModifier)
-        {
-            this.bossColorModifier += 0.05F;
-
-            if (this.bossColorModifier > 1.0F)
-            {
-                this.bossColorModifier = 1.0F;
-            }
-
-            BossStatus.hasColorModifier = false;
-        }
-        else if (this.bossColorModifier > 0.0F)
-        {
-            this.bossColorModifier -= 0.0125F;
-        }
-    }
-
-    public ShaderGroup getShaderGroup()
-    {
-        return this.theShaderGroup;
-    }
-
-    public void updateShaderGroupSize(int p_147704_1_, int p_147704_2_)
-    {
-        if (OpenGlHelper.shadersSupported)
-        {
-            if (this.theShaderGroup != null)
-            {
-                this.theShaderGroup.createBindFramebuffers(p_147704_1_, p_147704_2_);
-            }
-
-            this.mc.renderGlobal.checkOcclusionQueryResult(p_147704_1_, p_147704_2_);
-        }
-    }
-
-    /**
-     * Finds what block or object the mouse is over at the specified partial tick time. Args: partialTickTime
-     */
-    public void getMouseOver(float p_78473_1_)
-    {
-        Entity var2 = this.mc.func_175606_aa();
-
-        if (var2 != null)
-        {
-            if (this.mc.theWorld != null)
-            {
-                this.mc.mcProfiler.startSection("pick");
-                this.mc.pointedEntity = null;
-                double var3 = (double)this.mc.playerController.getBlockReachDistance();
-                this.mc.objectMouseOver = var2.func_174822_a(var3, p_78473_1_);
-                double var5 = var3;
-                Vec3 var7 = var2.func_174824_e(p_78473_1_);
-
-                if (this.mc.playerController.extendedReach())
-                {
-                    var3 = 6.0D;
-                    var5 = 6.0D;
-                }
-                else
-                {
-                    if (var3 > 3.0D)
-                    {
-                        var5 = 3.0D;
-                    }
-
-                    var3 = var5;
-                }
-
-                if (this.mc.objectMouseOver != null)
-                {
-                    var5 = this.mc.objectMouseOver.hitVec.distanceTo(var7);
-                }
-
-                Vec3 var8 = var2.getLook(p_78473_1_);
-                Vec3 var9 = var7.addVector(var8.xCoord * var3, var8.yCoord * var3, var8.zCoord * var3);
-                this.pointedEntity = null;
-                Vec3 var10 = null;
-                float var11 = 1.0F;
-                List var12 = this.mc.theWorld.getEntitiesWithinAABBExcludingEntity(var2, var2.getEntityBoundingBox().addCoord(var8.xCoord * var3, var8.yCoord * var3, var8.zCoord * var3).expand((double)var11, (double)var11, (double)var11));
-                double var13 = var5;
-
-                for (int var15 = 0; var15 < var12.size(); ++var15)
-                {
-                    Entity var16 = (Entity)var12.get(var15);
-
-                    if (var16.canBeCollidedWith())
-                    {
-                        float var17 = var16.getCollisionBorderSize();
-                        AxisAlignedBB var18 = var16.getEntityBoundingBox().expand((double)var17, (double)var17, (double)var17);
-                        MovingObjectPosition var19 = var18.calculateIntercept(var7, var9);
-
-                        if (var18.isVecInside(var7))
-                        {
-                            if (0.0D < var13 || var13 == 0.0D)
-                            {
-                                this.pointedEntity = var16;
-                                var10 = var19 == null ? var7 : var19.hitVec;
-                                var13 = 0.0D;
-                            }
-                        }
-                        else if (var19 != null)
-                        {
-                            double var20 = var7.distanceTo(var19.hitVec);
-
-                            if (var20 < var13 || var13 == 0.0D)
-                            {
-                                if (var16 == var2.ridingEntity)
-                                {
-                                    if (var13 == 0.0D)
-                                    {
-                                        this.pointedEntity = var16;
-                                        var10 = var19.hitVec;
-                                    }
-                                }
-                                else
-                                {
-                                    this.pointedEntity = var16;
-                                    var10 = var19.hitVec;
-                                    var13 = var20;
-                                }
-                            }
-                        }
-                    }
-                }
-
-                if (this.pointedEntity != null && (var13 < var5 || this.mc.objectMouseOver == null))
-                {
-                    this.mc.objectMouseOver = new MovingObjectPosition(this.pointedEntity, var10);
-
-                    if (this.pointedEntity instanceof EntityLivingBase || this.pointedEntity instanceof EntityItemFrame)
-                    {
-                        this.mc.pointedEntity = this.pointedEntity;
-                    }
-                }
-
-                this.mc.mcProfiler.endSection();
-            }
-        }
-    }
-
-    /**
-     * Update FOV modifier hand
-     */
-    private void updateFovModifierHand()
-    {
-        float var1 = 1.0F;
-
-        if (this.mc.func_175606_aa() instanceof AbstractClientPlayer)
-        {
-            AbstractClientPlayer var2 = (AbstractClientPlayer)this.mc.func_175606_aa();
-            var1 = var2.func_175156_o();
-        }
-
-        this.fovModifierHandPrev = this.fovModifierHand;
-        this.fovModifierHand += (var1 - this.fovModifierHand) * 0.5F;
-
-        if (this.fovModifierHand > 1.5F)
-        {
-            this.fovModifierHand = 1.5F;
-        }
-
-        if (this.fovModifierHand < 0.1F)
-        {
-            this.fovModifierHand = 0.1F;
-        }
-    }
-
-    /**
-     * Changes the field of view of the player depending on if they are underwater or not
-     */
-    private float getFOVModifier(float p_78481_1_, boolean p_78481_2_)
-    {
-        if (this.field_175078_W)
-        {
-            return 90.0F;
-        }
-        else
-        {
-            Entity var3 = this.mc.func_175606_aa();
-            float var4 = 70.0F;
-
-            if (p_78481_2_)
-            {
-                var4 = this.mc.gameSettings.fovSetting;
-                var4 *= this.fovModifierHandPrev + (this.fovModifierHand - this.fovModifierHandPrev) * p_78481_1_;
-            }
-
-            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).getHealth() <= 0.0F)
-            {
-                float var5 = (float)((EntityLivingBase)var3).deathTime + p_78481_1_;
-                var4 /= (1.0F - 500.0F / (var5 + 500.0F)) * 2.0F + 1.0F;
-            }
-
-            Block var6 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78481_1_);
-
-            if (var6.getMaterial() == Material.water)
-            {
-                var4 = var4 * 60.0F / 70.0F;
-            }
-
-            return var4;
-        }
-    }
-
-    private void hurtCameraEffect(float p_78482_1_)
-    {
-        if (this.mc.func_175606_aa() instanceof EntityLivingBase)
-        {
-            EntityLivingBase var2 = (EntityLivingBase)this.mc.func_175606_aa();
-            float var3 = (float)var2.hurtTime - p_78482_1_;
-            float var4;
-
-            if (var2.getHealth() <= 0.0F)
-            {
-                var4 = (float)var2.deathTime + p_78482_1_;
-                GlStateManager.rotate(40.0F - 8000.0F / (var4 + 200.0F), 0.0F, 0.0F, 1.0F);
-            }
-
-            if (var3 < 0.0F)
-            {
-                return;
-            }
-
-            var3 /= (float)var2.maxHurtTime;
-            var3 = MathHelper.sin(var3 * var3 * var3 * var3 * (float)Math.PI);
-            var4 = var2.attackedAtYaw;
-            GlStateManager.rotate(-var4, 0.0F, 1.0F, 0.0F);
-            GlStateManager.rotate(-var3 * 14.0F, 0.0F, 0.0F, 1.0F);
-            GlStateManager.rotate(var4, 0.0F, 1.0F, 0.0F);
-        }
-    }
-
-    /**
-     * Setups all the GL settings for view bobbing. Args: partialTickTime
-     */
-    private void setupViewBobbing(float p_78475_1_)
-    {
-        if (this.mc.func_175606_aa() instanceof EntityPlayer)
-        {
-            EntityPlayer var2 = (EntityPlayer)this.mc.func_175606_aa();
-            float var3 = var2.distanceWalkedModified - var2.prevDistanceWalkedModified;
-            float var4 = -(var2.distanceWalkedModified + var3 * p_78475_1_);
-            float var5 = var2.prevCameraYaw + (var2.cameraYaw - var2.prevCameraYaw) * p_78475_1_;
-            float var6 = var2.prevCameraPitch + (var2.cameraPitch - var2.prevCameraPitch) * p_78475_1_;
-            GlStateManager.translate(MathHelper.sin(var4 * (float)Math.PI) * var5 * 0.5F, -Math.abs(MathHelper.cos(var4 * (float)Math.PI) * var5), 0.0F);
-            GlStateManager.rotate(MathHelper.sin(var4 * (float)Math.PI) * var5 * 3.0F, 0.0F, 0.0F, 1.0F);
-            GlStateManager.rotate(Math.abs(MathHelper.cos(var4 * (float)Math.PI - 0.2F) * var5) * 5.0F, 1.0F, 0.0F, 0.0F);
-            GlStateManager.rotate(var6, 1.0F, 0.0F, 0.0F);
-        }
-    }
-
-    /**
-     * sets up player's eye (or camera in third person mode)
-     */
-    private void orientCamera(float p_78467_1_)
-    {
-        Entity var2 = this.mc.func_175606_aa();
-        float var3 = var2.getEyeHeight();
-        double var4 = var2.prevPosX + (var2.posX - var2.prevPosX) * (double)p_78467_1_;
-        double var6 = var2.prevPosY + (var2.posY - var2.prevPosY) * (double)p_78467_1_ + (double)var3;
-        double var8 = var2.prevPosZ + (var2.posZ - var2.prevPosZ) * (double)p_78467_1_;
-
-        if (var2 instanceof EntityLivingBase && ((EntityLivingBase)var2).isPlayerSleeping())
-        {
-            var3 = (float)((double)var3 + 1.0D);
-            GlStateManager.translate(0.0F, 0.3F, 0.0F);
-
-            if (!this.mc.gameSettings.debugCamEnable)
-            {
-                BlockPos var27 = new BlockPos(var2);
-                IBlockState var11 = this.mc.theWorld.getBlockState(var27);
-                Block var29 = var11.getBlock();
-
-                if (var29 == Blocks.bed)
-                {
-                    int var30 = ((EnumFacing)var11.getValue(BlockBed.AGE)).getHorizontalIndex();
-                    GlStateManager.rotate((float)(var30 * 90), 0.0F, 1.0F, 0.0F);
-                }
-
-                GlStateManager.rotate(var2.prevRotationYaw + (var2.rotationYaw - var2.prevRotationYaw) * p_78467_1_ + 180.0F, 0.0F, -1.0F, 0.0F);
-                GlStateManager.rotate(var2.prevRotationPitch + (var2.rotationPitch - var2.prevRotationPitch) * p_78467_1_, -1.0F, 0.0F, 0.0F);
-            }
-        }
-        else if (this.mc.gameSettings.thirdPersonView > 0)
-        {
-            double var10 = (double)(this.thirdPersonDistanceTemp + (this.thirdPersonDistance - this.thirdPersonDistanceTemp) * p_78467_1_);
-
-            if (this.mc.gameSettings.debugCamEnable)
-            {
-                GlStateManager.translate(0.0F, 0.0F, (float)(-var10));
-            }
-            else
-            {
-                float var12 = var2.rotationYaw;
-                float var13 = var2.rotationPitch;
-
-                if (this.mc.gameSettings.thirdPersonView == 2)
-                {
-                    var13 += 180.0F;
-                }
-
-                double var14 = (double)(-MathHelper.sin(var12 / 180.0F * (float)Math.PI) * MathHelper.cos(var13 / 180.0F * (float)Math.PI)) * var10;
-                double var16 = (double)(MathHelper.cos(var12 / 180.0F * (float)Math.PI) * MathHelper.cos(var13 / 180.0F * (float)Math.PI)) * var10;
-                double var18 = (double)(-MathHelper.sin(var13 / 180.0F * (float)Math.PI)) * var10;
-
-                for (int var20 = 0; var20 < 8; ++var20)
-                {
-                    float var21 = (float)((var20 & 1) * 2 - 1);
-                    float var22 = (float)((var20 >> 1 & 1) * 2 - 1);
-                    float var23 = (float)((var20 >> 2 & 1) * 2 - 1);
-                    var21 *= 0.1F;
-                    var22 *= 0.1F;
-                    var23 *= 0.1F;
-                    MovingObjectPosition var24 = this.mc.theWorld.rayTraceBlocks(new Vec3(var4 + (double)var21, var6 + (double)var22, var8 + (double)var23), new Vec3(var4 - var14 + (double)var21 + (double)var23, var6 - var18 + (double)var22, var8 - var16 + (double)var23));
-
-                    if (var24 != null)
-                    {
-                        double var25 = var24.hitVec.distanceTo(new Vec3(var4, var6, var8));
-
-                        if (var25 < var10)
-                        {
-                            var10 = var25;
-                        }
-                    }
-                }
-
-                if (this.mc.gameSettings.thirdPersonView == 2)
-                {
-                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
-                }
-
-                GlStateManager.rotate(var2.rotationPitch - var13, 1.0F, 0.0F, 0.0F);
-                GlStateManager.rotate(var2.rotationYaw - var12, 0.0F, 1.0F, 0.0F);
-                GlStateManager.translate(0.0F, 0.0F, (float)(-var10));
-                GlStateManager.rotate(var12 - var2.rotationYaw, 0.0F, 1.0F, 0.0F);
-                GlStateManager.rotate(var13 - var2.rotationPitch, 1.0F, 0.0F, 0.0F);
-            }
-        }
-        else
-        {
-            GlStateManager.translate(0.0F, 0.0F, -0.1F);
-        }
-
-        if (!this.mc.gameSettings.debugCamEnable)
-        {
-            GlStateManager.rotate(var2.prevRotationPitch + (var2.rotationPitch - var2.prevRotationPitch) * p_78467_1_, 1.0F, 0.0F, 0.0F);
-
-            if (var2 instanceof EntityAnimal)
-            {
-                EntityAnimal var28 = (EntityAnimal)var2;
-                GlStateManager.rotate(var28.prevRotationYawHead + (var28.rotationYawHead - var28.prevRotationYawHead) * p_78467_1_ + 180.0F, 0.0F, 1.0F, 0.0F);
-            }
-            else
-            {
-                GlStateManager.rotate(var2.prevRotationYaw + (var2.rotationYaw - var2.prevRotationYaw) * p_78467_1_ + 180.0F, 0.0F, 1.0F, 0.0F);
-            }
-        }
-
-        GlStateManager.translate(0.0F, -var3, 0.0F);
-        var4 = var2.prevPosX + (var2.posX - var2.prevPosX) * (double)p_78467_1_;
-        var6 = var2.prevPosY + (var2.posY - var2.prevPosY) * (double)p_78467_1_ + (double)var3;
-        var8 = var2.prevPosZ + (var2.posZ - var2.prevPosZ) * (double)p_78467_1_;
-        this.cloudFog = this.mc.renderGlobal.hasCloudFog(var4, var6, var8, p_78467_1_);
-    }
-
-    /**
-     * sets up projection, view effects, camera position/rotation
-     */
-    private void setupCameraTransform(float p_78479_1_, int p_78479_2_)
-    {
-        this.farPlaneDistance = (float)(this.mc.gameSettings.renderDistanceChunks * 16);
-        GlStateManager.matrixMode(5889);
-        GlStateManager.loadIdentity();
-        float var3 = 0.07F;
-
-        if (this.mc.gameSettings.anaglyph)
-        {
-            GlStateManager.translate((float)(-(p_78479_2_ * 2 - 1)) * var3, 0.0F, 0.0F);
-        }
-
-        if (this.cameraZoom != 1.0D)
-        {
-            GlStateManager.translate((float)this.cameraYaw, (float)(-this.cameraPitch), 0.0F);
-            GlStateManager.scale(this.cameraZoom, this.cameraZoom, 1.0D);
-        }
-
-        Project.gluPerspective(this.getFOVModifier(p_78479_1_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
-        GlStateManager.matrixMode(5888);
-        GlStateManager.loadIdentity();
-
-        if (this.mc.gameSettings.anaglyph)
-        {
-            GlStateManager.translate((float)(p_78479_2_ * 2 - 1) * 0.1F, 0.0F, 0.0F);
-        }
-
-        this.hurtCameraEffect(p_78479_1_);
-
-        if (this.mc.gameSettings.viewBobbing)
-        {
-            this.setupViewBobbing(p_78479_1_);
-        }
-
-        float var4 = this.mc.thePlayer.prevTimeInPortal + (this.mc.thePlayer.timeInPortal - this.mc.thePlayer.prevTimeInPortal) * p_78479_1_;
-
-        if (var4 > 0.0F)
-        {
-            byte var5 = 20;
-
-            if (this.mc.thePlayer.isPotionActive(Potion.confusion))
-            {
-                var5 = 7;
-            }
-
-            float var6 = 5.0F / (var4 * var4 + 5.0F) - var4 * 0.04F;
-            var6 *= var6;
-            GlStateManager.rotate(((float)this.rendererUpdateCount + p_78479_1_) * (float)var5, 0.0F, 1.0F, 1.0F);
-            GlStateManager.scale(1.0F / var6, 1.0F, 1.0F);
-            GlStateManager.rotate(-((float)this.rendererUpdateCount + p_78479_1_) * (float)var5, 0.0F, 1.0F, 1.0F);
-        }
-
-        this.orientCamera(p_78479_1_);
-
-        if (this.field_175078_W)
-        {
-            switch (this.field_175079_V)
-            {
-                case 0:
-                    GlStateManager.rotate(90.0F, 0.0F, 1.0F, 0.0F);
-                    break;
-
-                case 1:
-                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
-                    break;
-
-                case 2:
-                    GlStateManager.rotate(-90.0F, 0.0F, 1.0F, 0.0F);
-                    break;
-
-                case 3:
-                    GlStateManager.rotate(90.0F, 1.0F, 0.0F, 0.0F);
-                    break;
-
-                case 4:
-                    GlStateManager.rotate(-90.0F, 1.0F, 0.0F, 0.0F);
-            }
-        }
-    }
-
-    /**
-     * Render player hand
-     */
-    private void renderHand(float p_78476_1_, int p_78476_2_)
-    {
-        if (!this.field_175078_W)
-        {
-            GlStateManager.matrixMode(5889);
-            GlStateManager.loadIdentity();
-            float var3 = 0.07F;
-
-            if (this.mc.gameSettings.anaglyph)
-            {
-                GlStateManager.translate((float)(-(p_78476_2_ * 2 - 1)) * var3, 0.0F, 0.0F);
-            }
-
-            Project.gluPerspective(this.getFOVModifier(p_78476_1_, false), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 2.0F);
-            GlStateManager.matrixMode(5888);
-            GlStateManager.loadIdentity();
-
-            if (this.mc.gameSettings.anaglyph)
-            {
-                GlStateManager.translate((float)(p_78476_2_ * 2 - 1) * 0.1F, 0.0F, 0.0F);
-            }
-
-            GlStateManager.pushMatrix();
-            this.hurtCameraEffect(p_78476_1_);
-
-            if (this.mc.gameSettings.viewBobbing)
-            {
-                this.setupViewBobbing(p_78476_1_);
-            }
-
-            boolean var4 = this.mc.func_175606_aa() instanceof EntityLivingBase && ((EntityLivingBase)this.mc.func_175606_aa()).isPlayerSleeping();
-
-            if (this.mc.gameSettings.thirdPersonView == 0 && !var4 && !this.mc.gameSettings.hideGUI && !this.mc.playerController.enableEverythingIsScrewedUpMode())
-            {
-                this.func_180436_i();
-                this.itemRenderer.renderItemInFirstPerson(p_78476_1_);
-                this.func_175072_h();
-            }
-
-            GlStateManager.popMatrix();
-
-            if (this.mc.gameSettings.thirdPersonView == 0 && !var4)
-            {
-                this.itemRenderer.renderOverlays(p_78476_1_);
-                this.hurtCameraEffect(p_78476_1_);
-            }
-
-            if (this.mc.gameSettings.viewBobbing)
-            {
-                this.setupViewBobbing(p_78476_1_);
-            }
-        }
-    }
-
-    public void func_175072_h()
-    {
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GlStateManager.func_179090_x();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-    }
-
-    public void func_180436_i()
-    {
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GlStateManager.matrixMode(5890);
-        GlStateManager.loadIdentity();
-        float var1 = 0.00390625F;
-        GlStateManager.scale(var1, var1, var1);
-        GlStateManager.translate(8.0F, 8.0F, 8.0F);
-        GlStateManager.matrixMode(5888);
-        this.mc.getTextureManager().bindTexture(this.locationLightMap);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_CLAMP);
-        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_CLAMP);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.func_179098_w();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-    }
-
-    /**
-     * Recompute a random value that is applied to block color in updateLightmap()
-     */
-    private void updateTorchFlicker()
-    {
-        this.field_175075_L = (float)((double)this.field_175075_L + (Math.random() - Math.random()) * Math.random() * Math.random());
-        this.field_175075_L = (float)((double)this.field_175075_L * 0.9D);
-        this.torchFlickerX += (this.field_175075_L - this.torchFlickerX) * 1.0F;
-        this.lightmapUpdateNeeded = true;
-    }
-
-    private void updateLightmap(float p_78472_1_)
-    {
-        if (this.lightmapUpdateNeeded)
-        {
-            this.mc.mcProfiler.startSection("lightTex");
-            WorldClient var2 = this.mc.theWorld;
-
-            if (var2 != null)
-            {
-                for (int var3 = 0; var3 < 256; ++var3)
-                {
-                    float var4 = var2.getSunBrightness(1.0F) * 0.95F + 0.05F;
-                    float var5 = var2.provider.getLightBrightnessTable()[var3 / 16] * var4;
-                    float var6 = var2.provider.getLightBrightnessTable()[var3 % 16] * (this.torchFlickerX * 0.1F + 1.5F);
-
-                    if (var2.func_175658_ac() > 0)
-                    {
-                        var5 = var2.provider.getLightBrightnessTable()[var3 / 16];
-                    }
-
-                    float var7 = var5 * (var2.getSunBrightness(1.0F) * 0.65F + 0.35F);
-                    float var8 = var5 * (var2.getSunBrightness(1.0F) * 0.65F + 0.35F);
-                    float var11 = var6 * ((var6 * 0.6F + 0.4F) * 0.6F + 0.4F);
-                    float var12 = var6 * (var6 * var6 * 0.6F + 0.4F);
-                    float var13 = var7 + var6;
-                    float var14 = var8 + var11;
-                    float var15 = var5 + var12;
-                    var13 = var13 * 0.96F + 0.03F;
-                    var14 = var14 * 0.96F + 0.03F;
-                    var15 = var15 * 0.96F + 0.03F;
-                    float var16;
-
-                    if (this.bossColorModifier > 0.0F)
-                    {
-                        var16 = this.bossColorModifierPrev + (this.bossColorModifier - this.bossColorModifierPrev) * p_78472_1_;
-                        var13 = var13 * (1.0F - var16) + var13 * 0.7F * var16;
-                        var14 = var14 * (1.0F - var16) + var14 * 0.6F * var16;
-                        var15 = var15 * (1.0F - var16) + var15 * 0.6F * var16;
-                    }
-
-                    if (var2.provider.getDimensionId() == 1)
-                    {
-                        var13 = 0.22F + var6 * 0.75F;
-                        var14 = 0.28F + var11 * 0.75F;
-                        var15 = 0.25F + var12 * 0.75F;
-                    }
-
-                    float var17;
-
-                    if (this.mc.thePlayer.isPotionActive(Potion.nightVision))
-                    {
-                        var16 = this.func_180438_a(this.mc.thePlayer, p_78472_1_);
-                        var17 = 1.0F / var13;
-
-                        if (var17 > 1.0F / var14)
-                        {
-                            var17 = 1.0F / var14;
-                        }
-
-                        if (var17 > 1.0F / var15)
-                        {
-                            var17 = 1.0F / var15;
-                        }
-
-                        var13 = var13 * (1.0F - var16) + var13 * var17 * var16;
-                        var14 = var14 * (1.0F - var16) + var14 * var17 * var16;
-                        var15 = var15 * (1.0F - var16) + var15 * var17 * var16;
-                    }
-
-                    if (var13 > 1.0F)
-                    {
-                        var13 = 1.0F;
-                    }
-
-                    if (var14 > 1.0F)
-                    {
-                        var14 = 1.0F;
-                    }
-
-                    if (var15 > 1.0F)
-                    {
-                        var15 = 1.0F;
-                    }
-
-                    var16 = this.mc.gameSettings.gammaSetting;
-                    var17 = 1.0F - var13;
-                    float var18 = 1.0F - var14;
-                    float var19 = 1.0F - var15;
-                    var17 = 1.0F - var17 * var17 * var17 * var17;
-                    var18 = 1.0F - var18 * var18 * var18 * var18;
-                    var19 = 1.0F - var19 * var19 * var19 * var19;
-                    var13 = var13 * (1.0F - var16) + var17 * var16;
-                    var14 = var14 * (1.0F - var16) + var18 * var16;
-                    var15 = var15 * (1.0F - var16) + var19 * var16;
-                    var13 = var13 * 0.96F + 0.03F;
-                    var14 = var14 * 0.96F + 0.03F;
-                    var15 = var15 * 0.96F + 0.03F;
-
-                    if (var13 > 1.0F)
-                    {
-                        var13 = 1.0F;
-                    }
-
-                    if (var14 > 1.0F)
-                    {
-                        var14 = 1.0F;
-                    }
-
-                    if (var15 > 1.0F)
-                    {
-                        var15 = 1.0F;
-                    }
-
-                    if (var13 < 0.0F)
-                    {
-                        var13 = 0.0F;
-                    }
-
-                    if (var14 < 0.0F)
-                    {
-                        var14 = 0.0F;
-                    }
-
-                    if (var15 < 0.0F)
-                    {
-                        var15 = 0.0F;
-                    }
-
-                    short var20 = 255;
-                    int var21 = (int)(var13 * 255.0F);
-                    int var22 = (int)(var14 * 255.0F);
-                    int var23 = (int)(var15 * 255.0F);
-                    this.lightmapColors[var3] = var20 << 24 | var21 << 16 | var22 << 8 | var23;
-                }
-
-                this.lightmapTexture.updateDynamicTexture();
-                this.lightmapUpdateNeeded = false;
-                this.mc.mcProfiler.endSection();
-            }
-        }
-    }
-
-    private float func_180438_a(EntityLivingBase p_180438_1_, float p_180438_2_)
-    {
-        int var3 = p_180438_1_.getActivePotionEffect(Potion.nightVision).getDuration();
-        return var3 > 200 ? 1.0F : 0.7F + MathHelper.sin(((float)var3 - p_180438_2_) * (float)Math.PI * 0.2F) * 0.3F;
-    }
-
-    /**
-     * Will update any inputs that effect the camera angle (mouse) and then render the world and GUI
-     */
-    public void updateCameraAndRender(float p_78480_1_)
-    {
-        boolean var2 = Display.isActive();
-
-        if (!var2 && this.mc.gameSettings.pauseOnLostFocus && (!this.mc.gameSettings.touchscreen || !Mouse.isButtonDown(1)))
-        {
-            if (Minecraft.getSystemTime() - this.prevFrameTime > 500L)
-            {
-                this.mc.displayInGameMenu();
-            }
-        }
-        else
-        {
-            this.prevFrameTime = Minecraft.getSystemTime();
-        }
-
-        this.mc.mcProfiler.startSection("mouse");
-
-        if (var2 && Minecraft.isRunningOnMac && this.mc.inGameHasFocus && !Mouse.isInsideWindow())
-        {
-            Mouse.setGrabbed(false);
-            Mouse.setCursorPosition(Display.getWidth() / 2, Display.getHeight() / 2);
-            Mouse.setGrabbed(true);
-        }
-
-        if (this.mc.inGameHasFocus && var2)
-        {
-            this.mc.mouseHelper.mouseXYChange();
-            float var3 = this.mc.gameSettings.mouseSensitivity * 0.6F + 0.2F;
-            float var4 = var3 * var3 * var3 * 8.0F;
-            float var5 = (float)this.mc.mouseHelper.deltaX * var4;
-            float var6 = (float)this.mc.mouseHelper.deltaY * var4;
-            byte var7 = 1;
-
-            if (this.mc.gameSettings.invertMouse)
-            {
-                var7 = -1;
-            }
-
-            if (this.mc.gameSettings.smoothCamera)
-            {
-                this.smoothCamYaw += var5;
-                this.smoothCamPitch += var6;
-                float var8 = p_78480_1_ - this.smoothCamPartialTicks;
-                this.smoothCamPartialTicks = p_78480_1_;
-                var5 = this.smoothCamFilterX * var8;
-                var6 = this.smoothCamFilterY * var8;
-                this.mc.thePlayer.setAngles(var5, var6 * (float)var7);
-            }
-            else
-            {
-                this.smoothCamYaw = 0.0F;
-                this.smoothCamPitch = 0.0F;
-                this.mc.thePlayer.setAngles(var5, var6 * (float)var7);
-            }
-        }
-
-        this.mc.mcProfiler.endSection();
-
-        if (!this.mc.skipRenderWorld)
-        {
-            anaglyphEnable = this.mc.gameSettings.anaglyph;
-            final ScaledResolution var13 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
-            int var14 = var13.getScaledWidth();
-            int var15 = var13.getScaledHeight();
-            final int var16 = Mouse.getX() * var14 / this.mc.displayWidth;
-            final int var17 = var15 - Mouse.getY() * var15 / this.mc.displayHeight - 1;
-            int var18 = this.mc.gameSettings.limitFramerate;
-
-            if (this.mc.theWorld != null)
-            {
-                this.mc.mcProfiler.startSection("level");
-                int var9 = Math.max(Minecraft.func_175610_ah(), 30);
-                this.renderWorld(p_78480_1_, this.renderEndNanoTime + (long)(1000000000 / var9));
-
-                if (OpenGlHelper.shadersSupported)
-                {
-                    this.mc.renderGlobal.func_174975_c();
-
-                    if (this.theShaderGroup != null && this.field_175083_ad)
-                    {
-                        GlStateManager.matrixMode(5890);
-                        GlStateManager.pushMatrix();
-                        GlStateManager.loadIdentity();
-                        this.theShaderGroup.loadShaderGroup(p_78480_1_);
-                        GlStateManager.popMatrix();
-                    }
-
-                    this.mc.getFramebuffer().bindFramebuffer(true);
-                }
-
-                this.renderEndNanoTime = System.nanoTime();
-                this.mc.mcProfiler.endStartSection("gui");
-
-                if (!this.mc.gameSettings.hideGUI || this.mc.currentScreen != null)
-                {
-                    GlStateManager.alphaFunc(516, 0.1F);
-                    this.mc.ingameGUI.func_175180_a(p_78480_1_);
-                }
-
-                this.mc.mcProfiler.endSection();
-            }
-            else
-            {
-                GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
-                GlStateManager.matrixMode(5889);
-                GlStateManager.loadIdentity();
-                GlStateManager.matrixMode(5888);
-                GlStateManager.loadIdentity();
-                this.setupOverlayRendering();
-                this.renderEndNanoTime = System.nanoTime();
-            }
-
-            if (this.mc.currentScreen != null)
-            {
-                GlStateManager.clear(256);
-
-                try
-                {
-                    this.mc.currentScreen.drawScreen(var16, var17, p_78480_1_);
-                }
-                catch (Throwable var12)
-                {
-                    CrashReport var10 = CrashReport.makeCrashReport(var12, "Rendering screen");
-                    CrashReportCategory var11 = var10.makeCategory("Screen render details");
-                    var11.addCrashSectionCallable("Screen name", new Callable()
-                    {
-                        private static final String __OBFID = "CL_00000948";
-                        public String call()
-                        {
-                            return EntityRenderer.this.mc.currentScreen.getClass().getCanonicalName();
-                        }
-                    });
-                    var11.addCrashSectionCallable("Mouse location", new Callable()
-                    {
-                        private static final String __OBFID = "CL_00000950";
-                        public String call()
-                        {
-                            return String.format("Scaled: (%d, %d). Absolute: (%d, %d)", new Object[] {Integer.valueOf(var16), Integer.valueOf(var17), Integer.valueOf(Mouse.getX()), Integer.valueOf(Mouse.getY())});
-                        }
-                    });
-                    var11.addCrashSectionCallable("Screen size", new Callable()
-                    {
-                        private static final String __OBFID = "CL_00000951";
-                        public String call()
-                        {
-                            return String.format("Scaled: (%d, %d). Absolute: (%d, %d). Scale factor of %d", new Object[] {Integer.valueOf(var13.getScaledWidth()), Integer.valueOf(var13.getScaledHeight()), Integer.valueOf(EntityRenderer.this.mc.displayWidth), Integer.valueOf(EntityRenderer.this.mc.displayHeight), Integer.valueOf(var13.getScaleFactor())});
-                        }
-                    });
-                    throw new ReportedException(var10);
-                }
-            }
-        }
-    }
-
-    public void func_152430_c(float p_152430_1_)
-    {
-        this.setupOverlayRendering();
-        this.mc.ingameGUI.func_180478_c(new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight));
-    }
-
-    private boolean func_175070_n()
-    {
-        if (!this.field_175073_D)
-        {
-            return false;
-        }
-        else
-        {
-            Entity var1 = this.mc.func_175606_aa();
-            boolean var2 = var1 instanceof EntityPlayer && !this.mc.gameSettings.hideGUI;
-
-            if (var2 && !((EntityPlayer)var1).capabilities.allowEdit)
-            {
-                ItemStack var3 = ((EntityPlayer)var1).getCurrentEquippedItem();
-
-                if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
-                {
-                    BlockPos var4 = this.mc.objectMouseOver.func_178782_a();
-                    Block var5 = this.mc.theWorld.getBlockState(var4).getBlock();
-
-                    if (this.mc.playerController.func_178889_l() == WorldSettings.GameType.SPECTATOR)
-                    {
-                        var2 = var5.hasTileEntity() && this.mc.theWorld.getTileEntity(var4) instanceof IInventory;
-                    }
-                    else
-                    {
-                        var2 = var3 != null && (var3.canDestroy(var5) || var3.canPlaceOn(var5));
-                    }
-                }
-            }
-
-            return var2;
-        }
-    }
-
-    private void func_175067_i(float p_175067_1_)
-    {
-        if (this.mc.gameSettings.showDebugInfo && !this.mc.gameSettings.hideGUI && !this.mc.thePlayer.func_175140_cp() && !this.mc.gameSettings.field_178879_v)
-        {
-            Entity var2 = this.mc.func_175606_aa();
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            GL11.glLineWidth(1.0F);
-            GlStateManager.func_179090_x();
-            GlStateManager.depthMask(false);
-            GlStateManager.pushMatrix();
-            GlStateManager.matrixMode(5888);
-            GlStateManager.loadIdentity();
-            this.orientCamera(p_175067_1_);
-            GlStateManager.translate(0.0F, var2.getEyeHeight(), 0.0F);
-            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 0.005D, 1.0E-4D, 1.0E-4D), -65536);
-            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 1.0E-4D, 1.0E-4D, 0.005D), -16776961);
-            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 1.0E-4D, 0.0033D, 1.0E-4D), -16711936);
-            GlStateManager.popMatrix();
-            GlStateManager.depthMask(true);
-            GlStateManager.func_179098_w();
-            GlStateManager.disableBlend();
-        }
-    }
-
-    public void renderWorld(float p_78471_1_, long p_78471_2_)
-    {
-        this.updateLightmap(p_78471_1_);
-
-        if (this.mc.func_175606_aa() == null)
-        {
-            this.mc.func_175607_a(this.mc.thePlayer);
-        }
-
-        this.getMouseOver(p_78471_1_);
-        GlStateManager.enableDepth();
-        GlStateManager.enableAlpha();
-        GlStateManager.alphaFunc(516, 0.5F);
-        this.mc.mcProfiler.startSection("center");
-
-        if (this.mc.gameSettings.anaglyph)
-        {
-            anaglyphField = 0;
-            GlStateManager.colorMask(false, true, true, false);
-            this.func_175068_a(0, p_78471_1_, p_78471_2_);
-            anaglyphField = 1;
-            GlStateManager.colorMask(true, false, false, false);
-            this.func_175068_a(1, p_78471_1_, p_78471_2_);
-            GlStateManager.colorMask(true, true, true, false);
-        }
-        else
-        {
-            this.func_175068_a(2, p_78471_1_, p_78471_2_);
-        }
-
-        this.mc.mcProfiler.endSection();
-    }
-
-    private void func_175068_a(int p_175068_1_, float p_175068_2_, long p_175068_3_)
-    {
-        RenderGlobal var5 = this.mc.renderGlobal;
-        EffectRenderer var6 = this.mc.effectRenderer;
-        boolean var7 = this.func_175070_n();
-        GlStateManager.enableCull();
-        this.mc.mcProfiler.endStartSection("clear");
-        GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
-        this.updateFogColor(p_175068_2_);
-        GlStateManager.clear(16640);
-        this.mc.mcProfiler.endStartSection("camera");
-        this.setupCameraTransform(p_175068_2_, p_175068_1_);
-        ActiveRenderInfo.updateRenderInfo(this.mc.thePlayer, this.mc.gameSettings.thirdPersonView == 2);
-        this.mc.mcProfiler.endStartSection("frustum");
-        ClippingHelperImpl.getInstance();
-        this.mc.mcProfiler.endStartSection("culling");
-        Frustrum var8 = new Frustrum();
-        Entity var9 = this.mc.func_175606_aa();
-        double var10 = var9.lastTickPosX + (var9.posX - var9.lastTickPosX) * (double)p_175068_2_;
-        double var12 = var9.lastTickPosY + (var9.posY - var9.lastTickPosY) * (double)p_175068_2_;
-        double var14 = var9.lastTickPosZ + (var9.posZ - var9.lastTickPosZ) * (double)p_175068_2_;
-        var8.setPosition(var10, var12, var14);
-
-        if (this.mc.gameSettings.renderDistanceChunks >= 4)
-        {
-            this.setupFog(-1, p_175068_2_);
-            this.mc.mcProfiler.endStartSection("sky");
-            GlStateManager.matrixMode(5889);
-            GlStateManager.loadIdentity();
-            Project.gluPerspective(this.getFOVModifier(p_175068_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 2.0F);
-            GlStateManager.matrixMode(5888);
-            var5.func_174976_a(p_175068_2_, p_175068_1_);
-            GlStateManager.matrixMode(5889);
-            GlStateManager.loadIdentity();
-            Project.gluPerspective(this.getFOVModifier(p_175068_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
-            GlStateManager.matrixMode(5888);
-        }
-
-        this.setupFog(0, p_175068_2_);
-        GlStateManager.shadeModel(7425);
-
-        if (var9.posY + (double)var9.getEyeHeight() < 128.0D)
-        {
-            this.func_180437_a(var5, p_175068_2_, p_175068_1_);
-        }
-
-        this.mc.mcProfiler.endStartSection("prepareterrain");
-        this.setupFog(0, p_175068_2_);
-        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
-        RenderHelper.disableStandardItemLighting();
-        this.mc.mcProfiler.endStartSection("terrain_setup");
-        var5.func_174970_a(var9, (double)p_175068_2_, var8, this.field_175084_ae++, this.mc.thePlayer.func_175149_v());
-
-        if (p_175068_1_ == 0 || p_175068_1_ == 2)
-        {
-            this.mc.mcProfiler.endStartSection("updatechunks");
-            this.mc.renderGlobal.func_174967_a(p_175068_3_);
-        }
-
-        this.mc.mcProfiler.endStartSection("terrain");
-        GlStateManager.matrixMode(5888);
-        GlStateManager.pushMatrix();
-        GlStateManager.disableAlpha();
-        var5.func_174977_a(EnumWorldBlockLayer.SOLID, (double)p_175068_2_, p_175068_1_, var9);
-        GlStateManager.enableAlpha();
-        var5.func_174977_a(EnumWorldBlockLayer.CUTOUT_MIPPED, (double)p_175068_2_, p_175068_1_, var9);
-        this.mc.getTextureManager().getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
-        var5.func_174977_a(EnumWorldBlockLayer.CUTOUT, (double)p_175068_2_, p_175068_1_, var9);
-        this.mc.getTextureManager().getTexture(TextureMap.locationBlocksTexture).func_174935_a();
-        GlStateManager.shadeModel(7424);
-        GlStateManager.alphaFunc(516, 0.1F);
-        EntityPlayer var16;
-
-        if (!this.field_175078_W)
-        {
-            GlStateManager.matrixMode(5888);
-            GlStateManager.popMatrix();
-            GlStateManager.pushMatrix();
-            RenderHelper.enableStandardItemLighting();
-            this.mc.mcProfiler.endStartSection("entities");
-            var5.func_180446_a(var9, var8, p_175068_2_);
-            RenderHelper.disableStandardItemLighting();
-            this.func_175072_h();
-            GlStateManager.matrixMode(5888);
-            GlStateManager.popMatrix();
-            GlStateManager.pushMatrix();
-
-            if (this.mc.objectMouseOver != null && var9.isInsideOfMaterial(Material.water) && var7)
-            {
-                var16 = (EntityPlayer)var9;
-                GlStateManager.disableAlpha();
-                this.mc.mcProfiler.endStartSection("outline");
-                var5.drawSelectionBox(var16, this.mc.objectMouseOver, 0, p_175068_2_);
-                GlStateManager.enableAlpha();
-            }
-        }
-
-        GlStateManager.matrixMode(5888);
-        GlStateManager.popMatrix();
-
-        if (var7 && this.mc.objectMouseOver != null && !var9.isInsideOfMaterial(Material.water))
-        {
-            var16 = (EntityPlayer)var9;
-            GlStateManager.disableAlpha();
-            this.mc.mcProfiler.endStartSection("outline");
-            var5.drawSelectionBox(var16, this.mc.objectMouseOver, 0, p_175068_2_);
-            GlStateManager.enableAlpha();
-        }
-
-        this.mc.mcProfiler.endStartSection("destroyProgress");
-        GlStateManager.enableBlend();
-        GlStateManager.tryBlendFuncSeparate(770, 1, 1, 0);
-        var5.func_174981_a(Tessellator.getInstance(), Tessellator.getInstance().getWorldRenderer(), var9, p_175068_2_);
-        GlStateManager.disableBlend();
-
-        if (!this.field_175078_W)
-        {
-            this.func_180436_i();
-            this.mc.mcProfiler.endStartSection("litParticles");
-            var6.renderLitParticles(var9, p_175068_2_);
-            RenderHelper.disableStandardItemLighting();
-            this.setupFog(0, p_175068_2_);
-            this.mc.mcProfiler.endStartSection("particles");
-            var6.renderParticles(var9, p_175068_2_);
-            this.func_175072_h();
-        }
-
-        GlStateManager.depthMask(false);
-        GlStateManager.enableCull();
-        this.mc.mcProfiler.endStartSection("weather");
-        this.renderRainSnow(p_175068_2_);
-        GlStateManager.depthMask(true);
-        var5.func_180449_a(var9, p_175068_2_);
-        GlStateManager.disableBlend();
-        GlStateManager.enableCull();
-        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-        GlStateManager.alphaFunc(516, 0.1F);
-        this.setupFog(0, p_175068_2_);
-        GlStateManager.enableBlend();
-        GlStateManager.depthMask(false);
-        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
-        GlStateManager.shadeModel(7425);
-
-        if (this.mc.gameSettings.fancyGraphics)
-        {
-            this.mc.mcProfiler.endStartSection("translucent");
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            var5.func_174977_a(EnumWorldBlockLayer.TRANSLUCENT, (double)p_175068_2_, p_175068_1_, var9);
-            GlStateManager.disableBlend();
-        }
-        else
-        {
-            this.mc.mcProfiler.endStartSection("translucent");
-            var5.func_174977_a(EnumWorldBlockLayer.TRANSLUCENT, (double)p_175068_2_, p_175068_1_, var9);
-        }
-
-        GlStateManager.shadeModel(7424);
-        GlStateManager.depthMask(true);
-        GlStateManager.enableCull();
-        GlStateManager.disableBlend();
-        GlStateManager.disableFog();
-
-        if (var9.posY + (double)var9.getEyeHeight() >= 128.0D)
-        {
-            this.mc.mcProfiler.endStartSection("aboveClouds");
-            this.func_180437_a(var5, p_175068_2_, p_175068_1_);
-        }
-
-        this.mc.mcProfiler.endStartSection("hand");
-
-        if (this.field_175074_C)
-        {
-            GlStateManager.clear(256);
-            this.renderHand(p_175068_2_, p_175068_1_);
-            this.func_175067_i(p_175068_2_);
-        }
-    }
-
-    private void func_180437_a(RenderGlobal p_180437_1_, float p_180437_2_, int p_180437_3_)
-    {
-        if (this.mc.gameSettings.shouldRenderClouds())
-        {
-            this.mc.mcProfiler.endStartSection("clouds");
-            GlStateManager.matrixMode(5889);
-            GlStateManager.loadIdentity();
-            Project.gluPerspective(this.getFOVModifier(p_180437_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 4.0F);
-            GlStateManager.matrixMode(5888);
-            GlStateManager.pushMatrix();
-            this.setupFog(0, p_180437_2_);
-            p_180437_1_.func_180447_b(p_180437_2_, p_180437_3_);
-            GlStateManager.disableFog();
-            GlStateManager.popMatrix();
-            GlStateManager.matrixMode(5889);
-            GlStateManager.loadIdentity();
-            Project.gluPerspective(this.getFOVModifier(p_180437_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
-            GlStateManager.matrixMode(5888);
-        }
-    }
-
-    private void addRainParticles()
-    {
-        float var1 = this.mc.theWorld.getRainStrength(1.0F);
-
-        if (!this.mc.gameSettings.fancyGraphics)
-        {
-            var1 /= 2.0F;
-        }
-
-        if (var1 != 0.0F)
-        {
-            this.random.setSeed((long)this.rendererUpdateCount * 312987231L);
-            Entity var2 = this.mc.func_175606_aa();
-            WorldClient var3 = this.mc.theWorld;
-            BlockPos var4 = new BlockPos(var2);
-            byte var5 = 10;
-            double var6 = 0.0D;
-            double var8 = 0.0D;
-            double var10 = 0.0D;
-            int var12 = 0;
-            int var13 = (int)(100.0F * var1 * var1);
-
-            if (this.mc.gameSettings.particleSetting == 1)
-            {
-                var13 >>= 1;
-            }
-            else if (this.mc.gameSettings.particleSetting == 2)
-            {
-                var13 = 0;
-            }
-
-            for (int var14 = 0; var14 < var13; ++var14)
-            {
-                BlockPos var15 = var3.func_175725_q(var4.add(this.random.nextInt(var5) - this.random.nextInt(var5), 0, this.random.nextInt(var5) - this.random.nextInt(var5)));
-                BiomeGenBase var16 = var3.getBiomeGenForCoords(var15);
-                BlockPos var17 = var15.offsetDown();
-                Block var18 = var3.getBlockState(var17).getBlock();
-
-                if (var15.getY() <= var4.getY() + var5 && var15.getY() >= var4.getY() - var5 && var16.canSpawnLightningBolt() && var16.func_180626_a(var15) >= 0.15F)
-                {
-                    float var19 = this.random.nextFloat();
-                    float var20 = this.random.nextFloat();
-
-                    if (var18.getMaterial() == Material.lava)
-                    {
-                        this.mc.theWorld.spawnParticle(EnumParticleTypes.SMOKE_NORMAL, (double)((float)var15.getX() + var19), (double)((float)var15.getY() + 0.1F) - var18.getBlockBoundsMinY(), (double)((float)var15.getZ() + var20), 0.0D, 0.0D, 0.0D, new int[0]);
-                    }
-                    else if (var18.getMaterial() != Material.air)
-                    {
-                        var18.setBlockBoundsBasedOnState(var3, var17);
-                        ++var12;
-
-                        if (this.random.nextInt(var12) == 0)
-                        {
-                            var6 = (double)((float)var17.getX() + var19);
-                            var8 = (double)((float)var17.getY() + 0.1F) + var18.getBlockBoundsMaxY() - 1.0D;
-                            var10 = (double)((float)var17.getZ() + var20);
-                        }
-
-                        this.mc.theWorld.spawnParticle(EnumParticleTypes.WATER_DROP, (double)((float)var17.getX() + var19), (double)((float)var17.getY() + 0.1F) + var18.getBlockBoundsMaxY(), (double)((float)var17.getZ() + var20), 0.0D, 0.0D, 0.0D, new int[0]);
-                    }
-                }
-            }
-
-            if (var12 > 0 && this.random.nextInt(3) < this.rainSoundCounter++)
-            {
-                this.rainSoundCounter = 0;
-
-                if (var8 > (double)(var4.getY() + 1) && var3.func_175725_q(var4).getY() > MathHelper.floor_float((float)var4.getY()))
-                {
-                    this.mc.theWorld.playSound(var6, var8, var10, "ambient.weather.rain", 0.1F, 0.5F, false);
-                }
-                else
-                {
-                    this.mc.theWorld.playSound(var6, var8, var10, "ambient.weather.rain", 0.2F, 1.0F, false);
-                }
-            }
-        }
-    }
-
-    /**
-     * Render rain and snow
-     */
-    protected void renderRainSnow(float p_78474_1_)
-    {
-        float var2 = this.mc.theWorld.getRainStrength(p_78474_1_);
-
-        if (var2 > 0.0F)
-        {
-            this.func_180436_i();
-            Entity var3 = this.mc.func_175606_aa();
-            WorldClient var4 = this.mc.theWorld;
-            int var5 = MathHelper.floor_double(var3.posX);
-            int var6 = MathHelper.floor_double(var3.posY);
-            int var7 = MathHelper.floor_double(var3.posZ);
-            Tessellator var8 = Tessellator.getInstance();
-            WorldRenderer var9 = var8.getWorldRenderer();
-            GlStateManager.disableCull();
-            GL11.glNormal3f(0.0F, 1.0F, 0.0F);
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            GlStateManager.alphaFunc(516, 0.1F);
-            double var10 = var3.lastTickPosX + (var3.posX - var3.lastTickPosX) * (double)p_78474_1_;
-            double var12 = var3.lastTickPosY + (var3.posY - var3.lastTickPosY) * (double)p_78474_1_;
-            double var14 = var3.lastTickPosZ + (var3.posZ - var3.lastTickPosZ) * (double)p_78474_1_;
-            int var16 = MathHelper.floor_double(var12);
-            byte var17 = 5;
-
-            if (this.mc.gameSettings.fancyGraphics)
-            {
-                var17 = 10;
-            }
-
-            byte var18 = -1;
-            float var19 = (float)this.rendererUpdateCount + p_78474_1_;
-
-            if (this.mc.gameSettings.fancyGraphics)
-            {
-                var17 = 10;
-            }
-
-            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-
-            for (int var20 = var7 - var17; var20 <= var7 + var17; ++var20)
-            {
-                for (int var21 = var5 - var17; var21 <= var5 + var17; ++var21)
-                {
-                    int var22 = (var20 - var7 + 16) * 32 + var21 - var5 + 16;
-                    float var23 = this.field_175076_N[var22] * 0.5F;
-                    float var24 = this.field_175077_O[var22] * 0.5F;
-                    BlockPos var25 = new BlockPos(var21, 0, var20);
-                    BiomeGenBase var26 = var4.getBiomeGenForCoords(var25);
-
-                    if (var26.canSpawnLightningBolt() || var26.getEnableSnow())
-                    {
-                        int var27 = var4.func_175725_q(var25).getY();
-                        int var28 = var6 - var17;
-                        int var29 = var6 + var17;
-
-                        if (var28 < var27)
-                        {
-                            var28 = var27;
-                        }
-
-                        if (var29 < var27)
-                        {
-                            var29 = var27;
-                        }
-
-                        float var30 = 1.0F;
-                        int var31 = var27;
-
-                        if (var27 < var16)
-                        {
-                            var31 = var16;
-                        }
-
-                        if (var28 != var29)
-                        {
-                            this.random.setSeed((long)(var21 * var21 * 3121 + var21 * 45238971 ^ var20 * var20 * 418711 + var20 * 13761));
-                            float var32 = var26.func_180626_a(new BlockPos(var21, var28, var20));
-                            float var33;
-                            double var36;
-
-                            if (var4.getWorldChunkManager().getTemperatureAtHeight(var32, var27) >= 0.15F)
-                            {
-                                if (var18 != 0)
-                                {
-                                    if (var18 >= 0)
-                                    {
-                                        var8.draw();
-                                    }
-
-                                    var18 = 0;
-                                    this.mc.getTextureManager().bindTexture(locationRainPng);
-                                    var9.startDrawingQuads();
-                                }
-
-                                var33 = ((float)(this.rendererUpdateCount + var21 * var21 * 3121 + var21 * 45238971 + var20 * var20 * 418711 + var20 * 13761 & 31) + p_78474_1_) / 32.0F * (3.0F + this.random.nextFloat());
-                                double var34 = (double)((float)var21 + 0.5F) - var3.posX;
-                                var36 = (double)((float)var20 + 0.5F) - var3.posZ;
-                                float var38 = MathHelper.sqrt_double(var34 * var34 + var36 * var36) / (float)var17;
-                                float var39 = 1.0F;
-                                var9.func_178963_b(var4.getCombinedLight(new BlockPos(var21, var31, var20), 0));
-                                var9.func_178960_a(var39, var39, var39, ((1.0F - var38 * var38) * 0.5F + 0.5F) * var2);
-                                var9.setTranslation(-var10 * 1.0D, -var12 * 1.0D, -var14 * 1.0D);
-                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var28, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30), (double)((float)var28 * var30 / 4.0F + var33 * var30));
-                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var28, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30), (double)((float)var28 * var30 / 4.0F + var33 * var30));
-                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var29, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30), (double)((float)var29 * var30 / 4.0F + var33 * var30));
-                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var29, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30), (double)((float)var29 * var30 / 4.0F + var33 * var30));
-                                var9.setTranslation(0.0D, 0.0D, 0.0D);
-                            }
-                            else
-                            {
-                                if (var18 != 1)
-                                {
-                                    if (var18 >= 0)
-                                    {
-                                        var8.draw();
-                                    }
-
-                                    var18 = 1;
-                                    this.mc.getTextureManager().bindTexture(locationSnowPng);
-                                    var9.startDrawingQuads();
-                                }
-
-                                var33 = ((float)(this.rendererUpdateCount & 511) + p_78474_1_) / 512.0F;
-                                float var42 = this.random.nextFloat() + var19 * 0.01F * (float)this.random.nextGaussian();
-                                float var35 = this.random.nextFloat() + var19 * (float)this.random.nextGaussian() * 0.001F;
-                                var36 = (double)((float)var21 + 0.5F) - var3.posX;
-                                double var43 = (double)((float)var20 + 0.5F) - var3.posZ;
-                                float var40 = MathHelper.sqrt_double(var36 * var36 + var43 * var43) / (float)var17;
-                                float var41 = 1.0F;
-                                var9.func_178963_b((var4.getCombinedLight(new BlockPos(var21, var31, var20), 0) * 3 + 15728880) / 4);
-                                var9.func_178960_a(var41, var41, var41, ((1.0F - var40 * var40) * 0.3F + 0.5F) * var2);
-                                var9.setTranslation(-var10 * 1.0D, -var12 * 1.0D, -var14 * 1.0D);
-                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var28, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30 + var42), (double)((float)var28 * var30 / 4.0F + var33 * var30 + var35));
-                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var28, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30 + var42), (double)((float)var28 * var30 / 4.0F + var33 * var30 + var35));
-                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var29, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30 + var42), (double)((float)var29 * var30 / 4.0F + var33 * var30 + var35));
-                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var29, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30 + var42), (double)((float)var29 * var30 / 4.0F + var33 * var30 + var35));
-                                var9.setTranslation(0.0D, 0.0D, 0.0D);
-                            }
-                        }
-                    }
-                }
-            }
-
-            if (var18 >= 0)
-            {
-                var8.draw();
-            }
-
-            GlStateManager.enableCull();
-            GlStateManager.disableBlend();
-            GlStateManager.alphaFunc(516, 0.1F);
-            this.func_175072_h();
-        }
-    }
-
-    /**
-     * Setup orthogonal projection for rendering GUI screen overlays
-     */
-    public void setupOverlayRendering()
-    {
-        ScaledResolution var1 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
-        GlStateManager.clear(256);
-        GlStateManager.matrixMode(5889);
-        GlStateManager.loadIdentity();
-        GlStateManager.ortho(0.0D, var1.getScaledWidth_double(), var1.getScaledHeight_double(), 0.0D, 1000.0D, 3000.0D);
-        GlStateManager.matrixMode(5888);
-        GlStateManager.loadIdentity();
-        GlStateManager.translate(0.0F, 0.0F, -2000.0F);
-    }
-
-    /**
-     * calculates fog and calls glClearColor
-     */
-    private void updateFogColor(float p_78466_1_)
-    {
-        WorldClient var2 = this.mc.theWorld;
-        Entity var3 = this.mc.func_175606_aa();
-        float var4 = 0.25F + 0.75F * (float)this.mc.gameSettings.renderDistanceChunks / 32.0F;
-        var4 = 1.0F - (float)Math.pow((double)var4, 0.25D);
-        Vec3 var5 = var2.getSkyColor(this.mc.func_175606_aa(), p_78466_1_);
-        float var6 = (float)var5.xCoord;
-        float var7 = (float)var5.yCoord;
-        float var8 = (float)var5.zCoord;
-        Vec3 var9 = var2.getFogColor(p_78466_1_);
-        this.field_175080_Q = (float)var9.xCoord;
-        this.field_175082_R = (float)var9.yCoord;
-        this.field_175081_S = (float)var9.zCoord;
-        float var13;
-
-        if (this.mc.gameSettings.renderDistanceChunks >= 4)
-        {
-            double var10 = -1.0D;
-            Vec3 var12 = MathHelper.sin(var2.getCelestialAngleRadians(p_78466_1_)) > 0.0F ? new Vec3(var10, 0.0D, 0.0D) : new Vec3(1.0D, 0.0D, 0.0D);
-            var13 = (float)var3.getLook(p_78466_1_).dotProduct(var12);
-
-            if (var13 < 0.0F)
-            {
-                var13 = 0.0F;
-            }
-
-            if (var13 > 0.0F)
-            {
-                float[] var14 = var2.provider.calcSunriseSunsetColors(var2.getCelestialAngle(p_78466_1_), p_78466_1_);
-
-                if (var14 != null)
-                {
-                    var13 *= var14[3];
-                    this.field_175080_Q = this.field_175080_Q * (1.0F - var13) + var14[0] * var13;
-                    this.field_175082_R = this.field_175082_R * (1.0F - var13) + var14[1] * var13;
-                    this.field_175081_S = this.field_175081_S * (1.0F - var13) + var14[2] * var13;
-                }
-            }
-        }
-
-        this.field_175080_Q += (var6 - this.field_175080_Q) * var4;
-        this.field_175082_R += (var7 - this.field_175082_R) * var4;
-        this.field_175081_S += (var8 - this.field_175081_S) * var4;
-        float var19 = var2.getRainStrength(p_78466_1_);
-        float var11;
-        float var20;
-
-        if (var19 > 0.0F)
-        {
-            var11 = 1.0F - var19 * 0.5F;
-            var20 = 1.0F - var19 * 0.4F;
-            this.field_175080_Q *= var11;
-            this.field_175082_R *= var11;
-            this.field_175081_S *= var20;
-        }
-
-        var11 = var2.getWeightedThunderStrength(p_78466_1_);
-
-        if (var11 > 0.0F)
-        {
-            var20 = 1.0F - var11 * 0.5F;
-            this.field_175080_Q *= var20;
-            this.field_175082_R *= var20;
-            this.field_175081_S *= var20;
-        }
-
-        Block var21 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78466_1_);
-
-        if (this.cloudFog)
-        {
-            Vec3 var22 = var2.getCloudColour(p_78466_1_);
-            this.field_175080_Q = (float)var22.xCoord;
-            this.field_175082_R = (float)var22.yCoord;
-            this.field_175081_S = (float)var22.zCoord;
-        }
-        else if (var21.getMaterial() == Material.water)
-        {
-            var13 = (float)EnchantmentHelper.func_180319_a(var3) * 0.2F;
-
-            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.waterBreathing))
-            {
-                var13 = var13 * 0.3F + 0.6F;
-            }
-
-            this.field_175080_Q = 0.02F + var13;
-            this.field_175082_R = 0.02F + var13;
-            this.field_175081_S = 0.2F + var13;
-        }
-        else if (var21.getMaterial() == Material.lava)
-        {
-            this.field_175080_Q = 0.6F;
-            this.field_175082_R = 0.1F;
-            this.field_175081_S = 0.0F;
-        }
-
-        var13 = this.fogColor2 + (this.fogColor1 - this.fogColor2) * p_78466_1_;
-        this.field_175080_Q *= var13;
-        this.field_175082_R *= var13;
-        this.field_175081_S *= var13;
-        double var23 = (var3.lastTickPosY + (var3.posY - var3.lastTickPosY) * (double)p_78466_1_) * var2.provider.getVoidFogYFactor();
-
-        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.blindness))
-        {
-            int var16 = ((EntityLivingBase)var3).getActivePotionEffect(Potion.blindness).getDuration();
-
-            if (var16 < 20)
-            {
-                var23 *= (double)(1.0F - (float)var16 / 20.0F);
-            }
-            else
-            {
-                var23 = 0.0D;
-            }
-        }
-
-        if (var23 < 1.0D)
-        {
-            if (var23 < 0.0D)
-            {
-                var23 = 0.0D;
-            }
-
-            var23 *= var23;
-            this.field_175080_Q = (float)((double)this.field_175080_Q * var23);
-            this.field_175082_R = (float)((double)this.field_175082_R * var23);
-            this.field_175081_S = (float)((double)this.field_175081_S * var23);
-        }
-
-        float var24;
-
-        if (this.bossColorModifier > 0.0F)
-        {
-            var24 = this.bossColorModifierPrev + (this.bossColorModifier - this.bossColorModifierPrev) * p_78466_1_;
-            this.field_175080_Q = this.field_175080_Q * (1.0F - var24) + this.field_175080_Q * 0.7F * var24;
-            this.field_175082_R = this.field_175082_R * (1.0F - var24) + this.field_175082_R * 0.6F * var24;
-            this.field_175081_S = this.field_175081_S * (1.0F - var24) + this.field_175081_S * 0.6F * var24;
-        }
-
-        float var17;
-
-        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.nightVision))
-        {
-            var24 = this.func_180438_a((EntityLivingBase)var3, p_78466_1_);
-            var17 = 1.0F / this.field_175080_Q;
-
-            if (var17 > 1.0F / this.field_175082_R)
-            {
-                var17 = 1.0F / this.field_175082_R;
-            }
-
-            if (var17 > 1.0F / this.field_175081_S)
-            {
-                var17 = 1.0F / this.field_175081_S;
-            }
-
-            this.field_175080_Q = this.field_175080_Q * (1.0F - var24) + this.field_175080_Q * var17 * var24;
-            this.field_175082_R = this.field_175082_R * (1.0F - var24) + this.field_175082_R * var17 * var24;
-            this.field_175081_S = this.field_175081_S * (1.0F - var24) + this.field_175081_S * var17 * var24;
-        }
-
-        if (this.mc.gameSettings.anaglyph)
-        {
-            var24 = (this.field_175080_Q * 30.0F + this.field_175082_R * 59.0F + this.field_175081_S * 11.0F) / 100.0F;
-            var17 = (this.field_175080_Q * 30.0F + this.field_175082_R * 70.0F) / 100.0F;
-            float var18 = (this.field_175080_Q * 30.0F + this.field_175081_S * 70.0F) / 100.0F;
-            this.field_175080_Q = var24;
-            this.field_175082_R = var17;
-            this.field_175081_S = var18;
-        }
-
-        GlStateManager.clearColor(this.field_175080_Q, this.field_175082_R, this.field_175081_S, 0.0F);
-    }
-
-    /**
-     * Sets up the fog to be rendered. If the arg passed in is -1 the fog starts at 0 and goes to 80% of far plane
-     * distance and is used for sky rendering.
-     */
-    private void setupFog(int p_78468_1_, float p_78468_2_)
-    {
-        Entity var3 = this.mc.func_175606_aa();
-        boolean var4 = false;
-
-        if (var3 instanceof EntityPlayer)
-        {
-            var4 = ((EntityPlayer)var3).capabilities.isCreativeMode;
-        }
-
-        GL11.glFog(GL11.GL_FOG_COLOR, this.setFogColorBuffer(this.field_175080_Q, this.field_175082_R, this.field_175081_S, 1.0F));
-        GL11.glNormal3f(0.0F, -1.0F, 0.0F);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        Block var5 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78468_2_);
-        float var6;
-
-        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.blindness))
-        {
-            var6 = 5.0F;
-            int var7 = ((EntityLivingBase)var3).getActivePotionEffect(Potion.blindness).getDuration();
-
-            if (var7 < 20)
-            {
-                var6 = 5.0F + (this.farPlaneDistance - 5.0F) * (1.0F - (float)var7 / 20.0F);
-            }
-
-            GlStateManager.setFog(9729);
-
-            if (p_78468_1_ == -1)
-            {
-                GlStateManager.setFogStart(0.0F);
-                GlStateManager.setFogEnd(var6 * 0.8F);
-            }
-            else
-            {
-                GlStateManager.setFogStart(var6 * 0.25F);
-                GlStateManager.setFogEnd(var6);
-            }
-
-            if (GLContext.getCapabilities().GL_NV_fog_distance)
-            {
-                GL11.glFogi(34138, 34139);
-            }
-        }
-        else if (this.cloudFog)
-        {
-            GlStateManager.setFog(2048);
-            GlStateManager.setFogDensity(0.1F);
-        }
-        else if (var5.getMaterial() == Material.water)
-        {
-            GlStateManager.setFog(2048);
-
-            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.waterBreathing))
-            {
-                GlStateManager.setFogDensity(0.01F);
-            }
-            else
-            {
-                GlStateManager.setFogDensity(0.1F - (float)EnchantmentHelper.func_180319_a(var3) * 0.03F);
-            }
-        }
-        else if (var5.getMaterial() == Material.lava)
-        {
-            GlStateManager.setFog(2048);
-            GlStateManager.setFogDensity(2.0F);
-        }
-        else
-        {
-            var6 = this.farPlaneDistance;
-            GlStateManager.setFog(9729);
-
-            if (p_78468_1_ == -1)
-            {
-                GlStateManager.setFogStart(0.0F);
-                GlStateManager.setFogEnd(var6);
-            }
-            else
-            {
-                GlStateManager.setFogStart(var6 * 0.75F);
-                GlStateManager.setFogEnd(var6);
-            }
-
-            if (GLContext.getCapabilities().GL_NV_fog_distance)
-            {
-                GL11.glFogi(34138, 34139);
-            }
-
-            if (this.mc.theWorld.provider.doesXZShowFog((int)var3.posX, (int)var3.posZ))
-            {
-                GlStateManager.setFogStart(var6 * 0.05F);
-                GlStateManager.setFogEnd(Math.min(var6, 192.0F) * 0.5F);
-            }
-        }
-
-        GlStateManager.enableColorMaterial();
-        GlStateManager.enableFog();
-        GlStateManager.colorMaterial(1028, 4608);
-    }
-
-    /**
-     * Update and return fogColorBuffer with the RGBA values passed as arguments
-     */
-    private FloatBuffer setFogColorBuffer(float p_78469_1_, float p_78469_2_, float p_78469_3_, float p_78469_4_)
-    {
-        this.fogColorBuffer.clear();
-        this.fogColorBuffer.put(p_78469_1_).put(p_78469_2_).put(p_78469_3_).put(p_78469_4_);
-        this.fogColorBuffer.flip();
-        return this.fogColorBuffer;
-    }
-
-    public MapItemRenderer getMapItemRenderer()
-    {
-        return this.theMapItemRenderer;
-    }
-}
+package net.minecraft.client.renderer;
+
+import java.io.IOException;
+import java.nio.FloatBuffer;
+import java.util.List;
+import java.util.Random;
+import java.util.concurrent.Callable;
+
+import net.minecraft.block.Block;
+import net.minecraft.block.BlockBed;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.entity.AbstractClientPlayer;
+import net.minecraft.client.gui.MapItemRenderer;
+import net.minecraft.client.gui.ScaledResolution;
+import net.minecraft.client.multiplayer.WorldClient;
+import net.minecraft.client.particle.EffectRenderer;
+import net.minecraft.client.renderer.culling.ClippingHelperImpl;
+import net.minecraft.client.renderer.culling.Frustrum;
+import net.minecraft.client.renderer.texture.DynamicTexture;
+import net.minecraft.client.renderer.texture.TextureMap;
+import net.minecraft.client.resources.IResourceManager;
+import net.minecraft.client.resources.IResourceManagerReloadListener;
+import net.minecraft.client.shader.ShaderGroup;
+import net.minecraft.client.shader.ShaderLinkHelper;
+import net.minecraft.crash.CrashReport;
+import net.minecraft.crash.CrashReportCategory;
+import net.minecraft.enchantment.EnchantmentHelper;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.boss.BossStatus;
+import net.minecraft.entity.item.EntityItemFrame;
+import net.minecraft.entity.monster.EntityCreeper;
+import net.minecraft.entity.monster.EntityEnderman;
+import net.minecraft.entity.monster.EntitySpider;
+import net.minecraft.entity.passive.EntityAnimal;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.init.Blocks;
+import net.minecraft.inventory.IInventory;
+import net.minecraft.item.ItemStack;
+import net.minecraft.potion.Potion;
+import net.minecraft.util.*;
+import net.minecraft.world.WorldSettings;
+import net.minecraft.world.biome.BiomeGenBase;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.input.Mouse;
+import org.lwjgl.opengl.Display;
+import org.lwjgl.opengl.GL11;
+import org.lwjgl.opengl.GLContext;
+import org.lwjgl.util.glu.Project;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.EventManager;
+import tk.wurst_client.events.RenderEvent;
+import tk.wurst_client.mods.AntiBlindMod;
+import tk.wurst_client.mods.CaveFinderMod;
+import tk.wurst_client.mods.TracersMod;
+
+import com.google.gson.JsonSyntaxException;
+
+public class EntityRenderer implements IResourceManagerReloadListener
+{
+    private static final Logger logger = LogManager.getLogger();
+    private static final ResourceLocation locationRainPng = new ResourceLocation("textures/environment/rain.png");
+    private static final ResourceLocation locationSnowPng = new ResourceLocation("textures/environment/snow.png");
+    public static boolean anaglyphEnable;
+
+    /** Anaglyph field (0=R, 1=GB) */
+    public static int anaglyphField;
+
+    /** A reference to the Minecraft object. */
+    private Minecraft mc;
+    private final IResourceManager resourceManager;
+    private Random random = new Random();
+    private float farPlaneDistance;
+    public final ItemRenderer itemRenderer;
+    private final MapItemRenderer theMapItemRenderer;
+
+    /** Entity renderer update count */
+    private int rendererUpdateCount;
+
+    /** Pointed entity */
+    private Entity pointedEntity;
+    private MouseFilter mouseFilterXAxis = new MouseFilter();
+    private MouseFilter mouseFilterYAxis = new MouseFilter();
+    private float thirdPersonDistance = 4.0F;
+
+    /** Third person distance temp */
+    private float thirdPersonDistanceTemp = 4.0F;
+
+    /** Smooth cam yaw */
+    private float smoothCamYaw;
+
+    /** Smooth cam pitch */
+    private float smoothCamPitch;
+
+    /** Smooth cam filter X */
+    private float smoothCamFilterX;
+
+    /** Smooth cam filter Y */
+    private float smoothCamFilterY;
+
+    /** Smooth cam partial ticks */
+    private float smoothCamPartialTicks;
+
+    /** FOV modifier hand */
+    private float fovModifierHand;
+
+    /** FOV modifier hand prev */
+    private float fovModifierHandPrev;
+    private float bossColorModifier;
+    private float bossColorModifierPrev;
+
+    /** Cloud fog mode */
+    private boolean cloudFog;
+    private boolean field_175074_C = true;
+    private boolean field_175073_D = true;
+
+    /** Previous frame time in milliseconds */
+    private long prevFrameTime = Minecraft.getSystemTime();
+
+    /** End time of last render (ns) */
+    private long renderEndNanoTime;
+
+    /**
+     * The texture id of the blocklight/skylight texture used for lighting effects
+     */
+    private final DynamicTexture lightmapTexture;
+
+    /**
+     * Colors computed in updateLightmap() and loaded into the lightmap emptyTexture
+     */
+    private final int[] lightmapColors;
+    private final ResourceLocation locationLightMap;
+
+    /**
+     * Is set, updateCameraAndRender() calls updateLightmap(); set by updateTorchFlicker()
+     */
+    private boolean lightmapUpdateNeeded;
+
+    /** Torch flicker X */
+    private float torchFlickerX;
+    private float field_175075_L;
+
+    /** Rain sound counter */
+    private int rainSoundCounter;
+    private float[] field_175076_N = new float[1024];
+    private float[] field_175077_O = new float[1024];
+
+    /** Fog color buffer */
+    private FloatBuffer fogColorBuffer = GLAllocation.createDirectFloatBuffer(16);
+    private float field_175080_Q;
+    private float field_175082_R;
+    private float field_175081_S;
+
+    /** Fog color 2 */
+    private float fogColor2;
+
+    /** Fog color 1 */
+    private float fogColor1;
+    private int field_175079_V = 0;
+    private boolean field_175078_W = false;
+    private double cameraZoom = 1.0D;
+    private double cameraYaw;
+    private double cameraPitch;
+    //TODO: Client
+    public ShaderGroup theShaderGroup;
+    private static final ResourceLocation[] shaderResourceLocations = new ResourceLocation[] {new ResourceLocation("shaders/post/notch.json"), new ResourceLocation("shaders/post/fxaa.json"), new ResourceLocation("shaders/post/art.json"), new ResourceLocation("shaders/post/bumpy.json"), new ResourceLocation("shaders/post/blobs2.json"), new ResourceLocation("shaders/post/pencil.json"), new ResourceLocation("shaders/post/color_convolve.json"), new ResourceLocation("shaders/post/deconverge.json"), new ResourceLocation("shaders/post/flip.json"), new ResourceLocation("shaders/post/invert.json"), new ResourceLocation("shaders/post/ntsc.json"), new ResourceLocation("shaders/post/outline.json"), new ResourceLocation("shaders/post/phosphor.json"), new ResourceLocation("shaders/post/scan_pincushion.json"), new ResourceLocation("shaders/post/sobel.json"), new ResourceLocation("shaders/post/bits.json"), new ResourceLocation("shaders/post/desaturate.json"), new ResourceLocation("shaders/post/green.json"), new ResourceLocation("shaders/post/blur.json"), new ResourceLocation("shaders/post/wobble.json"), new ResourceLocation("shaders/post/blobs.json"), new ResourceLocation("shaders/post/antialias.json"), new ResourceLocation("shaders/post/creeper.json"), new ResourceLocation("shaders/post/spider.json")};
+    public static final int shaderCount = shaderResourceLocations.length;
+    private int shaderIndex;
+    private boolean field_175083_ad;
+    private int field_175084_ae;
+    private static final String __OBFID = "CL_00000947";
+    
+    //TODO: Client
+    private CaveFinderMod caveFinderMod;
+
+    public EntityRenderer(Minecraft mcIn, IResourceManager p_i45076_2_)
+    {
+        this.shaderIndex = shaderCount;
+        this.field_175083_ad = false;
+        this.field_175084_ae = 0;
+        this.mc = mcIn;
+        this.resourceManager = p_i45076_2_;
+        this.itemRenderer = mcIn.getItemRenderer();
+        this.theMapItemRenderer = new MapItemRenderer(mcIn.getTextureManager());
+        this.lightmapTexture = new DynamicTexture(16, 16);
+        this.locationLightMap = mcIn.getTextureManager().getDynamicTextureLocation("lightMap", this.lightmapTexture);
+        this.lightmapColors = this.lightmapTexture.getTextureData();
+        this.theShaderGroup = null;
+
+        for (int var3 = 0; var3 < 32; ++var3)
+        {
+            for (int var4 = 0; var4 < 32; ++var4)
+            {
+                float var5 = (float)(var4 - 16);
+                float var6 = (float)(var3 - 16);
+                float var7 = MathHelper.sqrt_float(var5 * var5 + var6 * var6);
+                this.field_175076_N[var3 << 5 | var4] = -var6 / var7;
+                this.field_175077_O[var3 << 5 | var4] = var5 / var7;
+            }
+        }
+    }
+
+    public boolean isShaderActive()
+    {
+        return OpenGlHelper.shadersSupported && this.theShaderGroup != null;
+    }
+
+    public void func_175071_c()
+    {
+        this.field_175083_ad = !this.field_175083_ad;
+    }
+
+    public void func_175066_a(Entity p_175066_1_)
+    {
+        if (OpenGlHelper.shadersSupported)
+        {
+            if (this.theShaderGroup != null)
+            {
+                this.theShaderGroup.deleteShaderGroup();
+            }
+
+            this.theShaderGroup = null;
+
+            if (p_175066_1_ instanceof EntityCreeper)
+            {
+                this.func_175069_a(new ResourceLocation("shaders/post/creeper.json"));
+            }
+            else if (p_175066_1_ instanceof EntitySpider)
+            {
+                this.func_175069_a(new ResourceLocation("shaders/post/spider.json"));
+            }
+            else if (p_175066_1_ instanceof EntityEnderman)
+            {
+                this.func_175069_a(new ResourceLocation("shaders/post/invert.json"));
+            }
+        }
+    }
+
+    public void activateNextShader()
+    {
+        if (OpenGlHelper.shadersSupported)
+        {
+            if (this.mc.func_175606_aa() instanceof EntityPlayer)
+            {
+                if (this.theShaderGroup != null)
+                {
+                    this.theShaderGroup.deleteShaderGroup();
+                }
+
+                this.shaderIndex = (this.shaderIndex + 1) % (shaderResourceLocations.length + 1);
+
+                if (this.shaderIndex != shaderCount)
+                {
+                    this.func_175069_a(shaderResourceLocations[this.shaderIndex]);
+                }
+                else
+                {
+                    this.theShaderGroup = null;
+                }
+            }
+        }
+    }
+
+    //TODO: Client
+    public void activateLSD()
+    {
+        if(OpenGlHelper.shadersSupported)
+        {
+            if(this.mc.func_175606_aa() instanceof EntityPlayer)
+            {
+                if(this.theShaderGroup != null)
+                {
+                    this.theShaderGroup.deleteShaderGroup();
+                }
+
+                this.shaderIndex = 19;
+
+                if(this.shaderIndex != shaderCount)
+                {
+                    this.func_175069_a(shaderResourceLocations[19]);
+                }else
+                {
+                    this.theShaderGroup = null;
+                }
+            }
+        }else
+			Tessellator.shouldRenderLSD = true;
+    }
+
+    private void func_175069_a(ResourceLocation p_175069_1_)
+    {
+        try
+        {
+            this.theShaderGroup = new ShaderGroup(this.mc.getTextureManager(), this.resourceManager, this.mc.getFramebuffer(), p_175069_1_);
+            this.theShaderGroup.createBindFramebuffers(this.mc.displayWidth, this.mc.displayHeight);
+            this.field_175083_ad = true;
+        }
+        catch (IOException var3)
+        {
+            logger.warn("Failed to load shader: " + p_175069_1_, var3);
+            this.shaderIndex = shaderCount;
+            this.field_175083_ad = false;
+        }
+        catch (JsonSyntaxException var4)
+        {
+            logger.warn("Failed to load shader: " + p_175069_1_, var4);
+            this.shaderIndex = shaderCount;
+            this.field_175083_ad = false;
+        }
+    }
+
+    public void onResourceManagerReload(IResourceManager p_110549_1_)
+    {
+        if (this.theShaderGroup != null)
+        {
+            this.theShaderGroup.deleteShaderGroup();
+        }
+
+        this.theShaderGroup = null;
+
+        if (this.shaderIndex != shaderCount)
+        {
+            this.func_175069_a(shaderResourceLocations[this.shaderIndex]);
+        }
+        else
+        {
+            this.func_175066_a(this.mc.func_175606_aa());
+        }
+    }
+
+    /**
+     * Updates the entity renderer
+     */
+    public void updateRenderer()
+    {
+        if (OpenGlHelper.shadersSupported && ShaderLinkHelper.getStaticShaderLinkHelper() == null)
+        {
+            ShaderLinkHelper.setNewStaticShaderLinkHelper();
+        }
+
+        this.updateFovModifierHand();
+        this.updateTorchFlicker();
+        this.fogColor2 = this.fogColor1;
+        this.thirdPersonDistanceTemp = this.thirdPersonDistance;
+        float var1;
+        float var2;
+
+        if (this.mc.gameSettings.smoothCamera)
+        {
+            var1 = this.mc.gameSettings.mouseSensitivity * 0.6F + 0.2F;
+            var2 = var1 * var1 * var1 * 8.0F;
+            this.smoothCamFilterX = this.mouseFilterXAxis.smooth(this.smoothCamYaw, 0.05F * var2);
+            this.smoothCamFilterY = this.mouseFilterYAxis.smooth(this.smoothCamPitch, 0.05F * var2);
+            this.smoothCamPartialTicks = 0.0F;
+            this.smoothCamYaw = 0.0F;
+            this.smoothCamPitch = 0.0F;
+        }
+        else
+        {
+            this.smoothCamFilterX = 0.0F;
+            this.smoothCamFilterY = 0.0F;
+            this.mouseFilterXAxis.func_180179_a();
+            this.mouseFilterYAxis.func_180179_a();
+        }
+
+        if (this.mc.func_175606_aa() == null)
+        {
+            this.mc.func_175607_a(this.mc.thePlayer);
+        }
+
+        var1 = this.mc.theWorld.getLightBrightness(new BlockPos(this.mc.func_175606_aa()));
+        var2 = (float)this.mc.gameSettings.renderDistanceChunks / 32.0F;
+        float var3 = var1 * (1.0F - var2) + var2;
+        this.fogColor1 += (var3 - this.fogColor1) * 0.1F;
+        ++this.rendererUpdateCount;
+        this.itemRenderer.updateEquippedItem();
+        this.addRainParticles();
+        this.bossColorModifierPrev = this.bossColorModifier;
+
+        if (BossStatus.hasColorModifier)
+        {
+            this.bossColorModifier += 0.05F;
+
+            if (this.bossColorModifier > 1.0F)
+            {
+                this.bossColorModifier = 1.0F;
+            }
+
+            BossStatus.hasColorModifier = false;
+        }
+        else if (this.bossColorModifier > 0.0F)
+        {
+            this.bossColorModifier -= 0.0125F;
+        }
+    }
+
+    public ShaderGroup getShaderGroup()
+    {
+        return this.theShaderGroup;
+    }
+
+    public void updateShaderGroupSize(int p_147704_1_, int p_147704_2_)
+    {
+        if (OpenGlHelper.shadersSupported)
+        {
+            if (this.theShaderGroup != null)
+            {
+                this.theShaderGroup.createBindFramebuffers(p_147704_1_, p_147704_2_);
+            }
+
+            this.mc.renderGlobal.checkOcclusionQueryResult(p_147704_1_, p_147704_2_);
+        }
+    }
+
+    /**
+     * Finds what block or object the mouse is over at the specified partial tick time. Args: partialTickTime
+     */
+    public void getMouseOver(float p_78473_1_)
+    {
+        Entity var2 = this.mc.func_175606_aa();
+
+        if (var2 != null)
+        {
+            if (this.mc.theWorld != null)
+            {
+                this.mc.mcProfiler.startSection("pick");
+                this.mc.pointedEntity = null;
+                double var3 = (double)this.mc.playerController.getBlockReachDistance();
+                this.mc.objectMouseOver = var2.func_174822_a(var3, p_78473_1_);
+                double var5 = var3;
+                Vec3 var7 = var2.func_174824_e(p_78473_1_);
+
+                if (this.mc.playerController.extendedReach())
+                {
+                    var3 = 6.0D;
+                    var5 = 6.0D;
+                }
+                else
+                {
+                    if (var3 > 3.0D)
+                    {
+                        var5 = 3.0D;
+                    }
+
+                    var3 = var5;
+                }
+
+                if (this.mc.objectMouseOver != null)
+                {
+                    var5 = this.mc.objectMouseOver.hitVec.distanceTo(var7);
+                }
+
+                Vec3 var8 = var2.getLook(p_78473_1_);
+                Vec3 var9 = var7.addVector(var8.xCoord * var3, var8.yCoord * var3, var8.zCoord * var3);
+                this.pointedEntity = null;
+                Vec3 var10 = null;
+                float var11 = 1.0F;
+                List var12 = this.mc.theWorld.getEntitiesWithinAABBExcludingEntity(var2, var2.getEntityBoundingBox().addCoord(var8.xCoord * var3, var8.yCoord * var3, var8.zCoord * var3).expand((double)var11, (double)var11, (double)var11));
+                double var13 = var5;
+
+                for (int var15 = 0; var15 < var12.size(); ++var15)
+                {
+                    Entity var16 = (Entity)var12.get(var15);
+
+                    if (var16.canBeCollidedWith())
+                    {
+                        float var17 = var16.getCollisionBorderSize();
+                        AxisAlignedBB var18 = var16.getEntityBoundingBox().expand((double)var17, (double)var17, (double)var17);
+                        MovingObjectPosition var19 = var18.calculateIntercept(var7, var9);
+
+                        if (var18.isVecInside(var7))
+                        {
+                            if (0.0D < var13 || var13 == 0.0D)
+                            {
+                                this.pointedEntity = var16;
+                                var10 = var19 == null ? var7 : var19.hitVec;
+                                var13 = 0.0D;
+                            }
+                        }
+                        else if (var19 != null)
+                        {
+                            double var20 = var7.distanceTo(var19.hitVec);
+
+                            if (var20 < var13 || var13 == 0.0D)
+                            {
+                                if (var16 == var2.ridingEntity)
+                                {
+                                    if (var13 == 0.0D)
+                                    {
+                                        this.pointedEntity = var16;
+                                        var10 = var19.hitVec;
+                                    }
+                                }
+                                else
+                                {
+                                    this.pointedEntity = var16;
+                                    var10 = var19.hitVec;
+                                    var13 = var20;
+                                }
+                            }
+                        }
+                    }
+                }
+
+                if (this.pointedEntity != null && (var13 < var5 || this.mc.objectMouseOver == null))
+                {
+                    this.mc.objectMouseOver = new MovingObjectPosition(this.pointedEntity, var10);
+
+                    if (this.pointedEntity instanceof EntityLivingBase || this.pointedEntity instanceof EntityItemFrame)
+                    {
+                        this.mc.pointedEntity = this.pointedEntity;
+                    }
+                }
+
+                this.mc.mcProfiler.endSection();
+            }
+        }
+    }
+
+    /**
+     * Update FOV modifier hand
+     */
+    private void updateFovModifierHand()
+    {
+        float var1 = 1.0F;
+
+        if (this.mc.func_175606_aa() instanceof AbstractClientPlayer)
+        {
+            AbstractClientPlayer var2 = (AbstractClientPlayer)this.mc.func_175606_aa();
+            var1 = var2.func_175156_o();
+        }
+
+        this.fovModifierHandPrev = this.fovModifierHand;
+        this.fovModifierHand += (var1 - this.fovModifierHand) * 0.5F;
+
+        if (this.fovModifierHand > 1.5F)
+        {
+            this.fovModifierHand = 1.5F;
+        }
+
+        if (this.fovModifierHand < 0.1F)
+        {
+            this.fovModifierHand = 0.1F;
+        }
+    }
+
+    /**
+     * Changes the field of view of the player depending on if they are underwater or not
+     */
+    private float getFOVModifier(float p_78481_1_, boolean p_78481_2_)
+    {
+        if (this.field_175078_W)
+        {
+            return 90.0F;
+        }
+        else
+        {
+            Entity var3 = this.mc.func_175606_aa();
+            float var4 = 70.0F;
+
+            if (p_78481_2_)
+            {
+                var4 = this.mc.gameSettings.fovSetting;
+                var4 *= this.fovModifierHandPrev + (this.fovModifierHand - this.fovModifierHandPrev) * p_78481_1_;
+            }
+
+            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).getHealth() <= 0.0F)
+            {
+                float var5 = (float)((EntityLivingBase)var3).deathTime + p_78481_1_;
+                var4 /= (1.0F - 500.0F / (var5 + 500.0F)) * 2.0F + 1.0F;
+            }
+
+            Block var6 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78481_1_);
+
+            if (var6.getMaterial() == Material.water)
+            {
+                var4 = var4 * 60.0F / 70.0F;
+            }
+
+            return var4;
+        }
+    }
+
+    private void hurtCameraEffect(float p_78482_1_)
+    {
+        if (this.mc.func_175606_aa() instanceof EntityLivingBase)
+        {
+            EntityLivingBase var2 = (EntityLivingBase)this.mc.func_175606_aa();
+            float var3 = (float)var2.hurtTime - p_78482_1_;
+            float var4;
+
+            if (var2.getHealth() <= 0.0F)
+            {
+                var4 = (float)var2.deathTime + p_78482_1_;
+                GlStateManager.rotate(40.0F - 8000.0F / (var4 + 200.0F), 0.0F, 0.0F, 1.0F);
+            }
+
+            if (var3 < 0.0F)
+            {
+                return;
+            }
+
+            var3 /= (float)var2.maxHurtTime;
+            var3 = MathHelper.sin(var3 * var3 * var3 * var3 * (float)Math.PI);
+            var4 = var2.attackedAtYaw;
+            GlStateManager.rotate(-var4, 0.0F, 1.0F, 0.0F);
+            GlStateManager.rotate(-var3 * 14.0F, 0.0F, 0.0F, 1.0F);
+            GlStateManager.rotate(var4, 0.0F, 1.0F, 0.0F);
+        }
+    }
+
+    /**
+     * Setups all the GL settings for view bobbing. Args: partialTickTime
+     */
+    private void setupViewBobbing(float p_78475_1_)
+    {
+        if (this.mc.func_175606_aa() instanceof EntityPlayer)
+        {
+            EntityPlayer var2 = (EntityPlayer)this.mc.func_175606_aa();
+            float var3 = var2.distanceWalkedModified - var2.prevDistanceWalkedModified;
+            float var4 = -(var2.distanceWalkedModified + var3 * p_78475_1_);
+            float var5 = var2.prevCameraYaw + (var2.cameraYaw - var2.prevCameraYaw) * p_78475_1_;
+            float var6 = var2.prevCameraPitch + (var2.cameraPitch - var2.prevCameraPitch) * p_78475_1_;
+            GlStateManager.translate(MathHelper.sin(var4 * (float)Math.PI) * var5 * 0.5F, -Math.abs(MathHelper.cos(var4 * (float)Math.PI) * var5), 0.0F);
+            GlStateManager.rotate(MathHelper.sin(var4 * (float)Math.PI) * var5 * 3.0F, 0.0F, 0.0F, 1.0F);
+            GlStateManager.rotate(Math.abs(MathHelper.cos(var4 * (float)Math.PI - 0.2F) * var5) * 5.0F, 1.0F, 0.0F, 0.0F);
+            GlStateManager.rotate(var6, 1.0F, 0.0F, 0.0F);
+        }
+    }
+
+    /**
+     * sets up player's eye (or camera in third person mode)
+     */
+    private void orientCamera(float p_78467_1_)
+    {
+        Entity var2 = this.mc.func_175606_aa();
+        float var3 = var2.getEyeHeight();
+        double var4 = var2.prevPosX + (var2.posX - var2.prevPosX) * (double)p_78467_1_;
+        double var6 = var2.prevPosY + (var2.posY - var2.prevPosY) * (double)p_78467_1_ + (double)var3;
+        double var8 = var2.prevPosZ + (var2.posZ - var2.prevPosZ) * (double)p_78467_1_;
+
+        if (var2 instanceof EntityLivingBase && ((EntityLivingBase)var2).isPlayerSleeping())
+        {
+            var3 = (float)((double)var3 + 1.0D);
+            GlStateManager.translate(0.0F, 0.3F, 0.0F);
+
+            if (!this.mc.gameSettings.debugCamEnable)
+            {
+                BlockPos var27 = new BlockPos(var2);
+                IBlockState var11 = this.mc.theWorld.getBlockState(var27);
+                Block var29 = var11.getBlock();
+
+                if (var29 == Blocks.bed)
+                {
+                    int var30 = ((EnumFacing)var11.getValue(BlockBed.AGE)).getHorizontalIndex();
+                    GlStateManager.rotate((float)(var30 * 90), 0.0F, 1.0F, 0.0F);
+                }
+
+                GlStateManager.rotate(var2.prevRotationYaw + (var2.rotationYaw - var2.prevRotationYaw) * p_78467_1_ + 180.0F, 0.0F, -1.0F, 0.0F);
+                GlStateManager.rotate(var2.prevRotationPitch + (var2.rotationPitch - var2.prevRotationPitch) * p_78467_1_, -1.0F, 0.0F, 0.0F);
+            }
+        }
+        else if (this.mc.gameSettings.thirdPersonView > 0)
+        {
+            double var10 = (double)(this.thirdPersonDistanceTemp + (this.thirdPersonDistance - this.thirdPersonDistanceTemp) * p_78467_1_);
+
+            if (this.mc.gameSettings.debugCamEnable)
+            {
+                GlStateManager.translate(0.0F, 0.0F, (float)(-var10));
+            }
+            else
+            {
+                float var12 = var2.rotationYaw;
+                float var13 = var2.rotationPitch;
+
+                if (this.mc.gameSettings.thirdPersonView == 2)
+                {
+                    var13 += 180.0F;
+                }
+
+                double var14 = (double)(-MathHelper.sin(var12 / 180.0F * (float)Math.PI) * MathHelper.cos(var13 / 180.0F * (float)Math.PI)) * var10;
+                double var16 = (double)(MathHelper.cos(var12 / 180.0F * (float)Math.PI) * MathHelper.cos(var13 / 180.0F * (float)Math.PI)) * var10;
+                double var18 = (double)(-MathHelper.sin(var13 / 180.0F * (float)Math.PI)) * var10;
+
+                for (int var20 = 0; var20 < 8; ++var20)
+                {
+                    float var21 = (float)((var20 & 1) * 2 - 1);
+                    float var22 = (float)((var20 >> 1 & 1) * 2 - 1);
+                    float var23 = (float)((var20 >> 2 & 1) * 2 - 1);
+                    var21 *= 0.1F;
+                    var22 *= 0.1F;
+                    var23 *= 0.1F;
+                    MovingObjectPosition var24 = this.mc.theWorld.rayTraceBlocks(new Vec3(var4 + (double)var21, var6 + (double)var22, var8 + (double)var23), new Vec3(var4 - var14 + (double)var21 + (double)var23, var6 - var18 + (double)var22, var8 - var16 + (double)var23));
+
+                    if (var24 != null)
+                    {
+                        double var25 = var24.hitVec.distanceTo(new Vec3(var4, var6, var8));
+
+                        if (var25 < var10)
+                        {
+                            var10 = var25;
+                        }
+                    }
+                }
+
+                if (this.mc.gameSettings.thirdPersonView == 2)
+                {
+                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
+                }
+
+                GlStateManager.rotate(var2.rotationPitch - var13, 1.0F, 0.0F, 0.0F);
+                GlStateManager.rotate(var2.rotationYaw - var12, 0.0F, 1.0F, 0.0F);
+                GlStateManager.translate(0.0F, 0.0F, (float)(-var10));
+                GlStateManager.rotate(var12 - var2.rotationYaw, 0.0F, 1.0F, 0.0F);
+                GlStateManager.rotate(var13 - var2.rotationPitch, 1.0F, 0.0F, 0.0F);
+            }
+        }
+        else
+        {
+            GlStateManager.translate(0.0F, 0.0F, -0.1F);
+        }
+
+        if (!this.mc.gameSettings.debugCamEnable)
+        {
+            GlStateManager.rotate(var2.prevRotationPitch + (var2.rotationPitch - var2.prevRotationPitch) * p_78467_1_, 1.0F, 0.0F, 0.0F);
+
+            if (var2 instanceof EntityAnimal)
+            {
+                EntityAnimal var28 = (EntityAnimal)var2;
+                GlStateManager.rotate(var28.prevRotationYawHead + (var28.rotationYawHead - var28.prevRotationYawHead) * p_78467_1_ + 180.0F, 0.0F, 1.0F, 0.0F);
+            }
+            else
+            {
+                GlStateManager.rotate(var2.prevRotationYaw + (var2.rotationYaw - var2.prevRotationYaw) * p_78467_1_ + 180.0F, 0.0F, 1.0F, 0.0F);
+            }
+        }
+
+        GlStateManager.translate(0.0F, -var3, 0.0F);
+        var4 = var2.prevPosX + (var2.posX - var2.prevPosX) * (double)p_78467_1_;
+        var6 = var2.prevPosY + (var2.posY - var2.prevPosY) * (double)p_78467_1_ + (double)var3;
+        var8 = var2.prevPosZ + (var2.posZ - var2.prevPosZ) * (double)p_78467_1_;
+        this.cloudFog = this.mc.renderGlobal.hasCloudFog(var4, var6, var8, p_78467_1_);
+    }
+
+    /**
+     * sets up projection, view effects, camera position/rotation
+     */
+    private void setupCameraTransform(float p_78479_1_, int p_78479_2_)
+    {
+        this.farPlaneDistance = (float)(this.mc.gameSettings.renderDistanceChunks * 16);
+        GlStateManager.matrixMode(5889);
+        GlStateManager.loadIdentity();
+        float var3 = 0.07F;
+
+        if (this.mc.gameSettings.anaglyph)
+        {
+            GlStateManager.translate((float)(-(p_78479_2_ * 2 - 1)) * var3, 0.0F, 0.0F);
+        }
+
+        if (this.cameraZoom != 1.0D)
+        {
+            GlStateManager.translate((float)this.cameraYaw, (float)(-this.cameraPitch), 0.0F);
+            GlStateManager.scale(this.cameraZoom, this.cameraZoom, 1.0D);
+        }
+
+        Project.gluPerspective(this.getFOVModifier(p_78479_1_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
+        GlStateManager.matrixMode(5888);
+        GlStateManager.loadIdentity();
+
+        if (this.mc.gameSettings.anaglyph)
+        {
+            GlStateManager.translate((float)(p_78479_2_ * 2 - 1) * 0.1F, 0.0F, 0.0F);
+        }
+
+        this.hurtCameraEffect(p_78479_1_);
+
+        //TODO: Client
+        if (this.mc.gameSettings.viewBobbing && !WurstClient.INSTANCE.modManager.getModByClass(TracersMod.class).isEnabled())
+        {
+            this.setupViewBobbing(p_78479_1_);
+        }
+
+        float var4 = this.mc.thePlayer.prevTimeInPortal + (this.mc.thePlayer.timeInPortal - this.mc.thePlayer.prevTimeInPortal) * p_78479_1_;
+
+        //TODO: Client
+        if (var4 > 0.0F && !WurstClient.INSTANCE.modManager.getModByClass(AntiBlindMod.class).isEnabled())
+        {
+            byte var5 = 20;
+
+            if (this.mc.thePlayer.isPotionActive(Potion.confusion))
+            {
+                var5 = 7;
+            }
+
+            float var6 = 5.0F / (var4 * var4 + 5.0F) - var4 * 0.04F;
+            var6 *= var6;
+            GlStateManager.rotate(((float)this.rendererUpdateCount + p_78479_1_) * (float)var5, 0.0F, 1.0F, 1.0F);
+            GlStateManager.scale(1.0F / var6, 1.0F, 1.0F);
+            GlStateManager.rotate(-((float)this.rendererUpdateCount + p_78479_1_) * (float)var5, 0.0F, 1.0F, 1.0F);
+        }
+
+        this.orientCamera(p_78479_1_);
+
+        if (this.field_175078_W)
+        {
+            switch (this.field_175079_V)
+            {
+                case 0:
+                    GlStateManager.rotate(90.0F, 0.0F, 1.0F, 0.0F);
+                    break;
+
+                case 1:
+                    GlStateManager.rotate(180.0F, 0.0F, 1.0F, 0.0F);
+                    break;
+
+                case 2:
+                    GlStateManager.rotate(-90.0F, 0.0F, 1.0F, 0.0F);
+                    break;
+
+                case 3:
+                    GlStateManager.rotate(90.0F, 1.0F, 0.0F, 0.0F);
+                    break;
+
+                case 4:
+                    GlStateManager.rotate(-90.0F, 1.0F, 0.0F, 0.0F);
+            }
+        }
+    }
+
+    /**
+     * Render player hand
+     */
+    private void renderHand(float p_78476_1_, int p_78476_2_)
+    {
+        if (!this.field_175078_W)
+        {
+            GlStateManager.matrixMode(5889);
+            GlStateManager.loadIdentity();
+            float var3 = 0.07F;
+
+            if (this.mc.gameSettings.anaglyph)
+            {
+                GlStateManager.translate((float)(-(p_78476_2_ * 2 - 1)) * var3, 0.0F, 0.0F);
+            }
+
+            Project.gluPerspective(this.getFOVModifier(p_78476_1_, false), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 2.0F);
+            GlStateManager.matrixMode(5888);
+            GlStateManager.loadIdentity();
+
+            if (this.mc.gameSettings.anaglyph)
+            {
+                GlStateManager.translate((float)(p_78476_2_ * 2 - 1) * 0.1F, 0.0F, 0.0F);
+            }
+
+            GlStateManager.pushMatrix();
+            this.hurtCameraEffect(p_78476_1_);
+
+            if (this.mc.gameSettings.viewBobbing)
+            {
+                this.setupViewBobbing(p_78476_1_);
+            }
+
+            boolean var4 = this.mc.func_175606_aa() instanceof EntityLivingBase && ((EntityLivingBase)this.mc.func_175606_aa()).isPlayerSleeping();
+
+            if (this.mc.gameSettings.thirdPersonView == 0 && !var4 && !this.mc.gameSettings.hideGUI && !this.mc.playerController.enableEverythingIsScrewedUpMode())
+            {
+                this.func_180436_i();
+                this.itemRenderer.renderItemInFirstPerson(p_78476_1_);
+                this.func_175072_h();
+            }
+
+            GlStateManager.popMatrix();
+
+            if (this.mc.gameSettings.thirdPersonView == 0 && !var4)
+            {
+                this.itemRenderer.renderOverlays(p_78476_1_);
+                this.hurtCameraEffect(p_78476_1_);
+            }
+
+            if (this.mc.gameSettings.viewBobbing)
+            {
+                this.setupViewBobbing(p_78476_1_);
+            }
+        }
+    }
+
+    public void func_175072_h()
+    {
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GlStateManager.func_179090_x();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+    }
+
+    public void func_180436_i()
+    {
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GlStateManager.matrixMode(5890);
+        GlStateManager.loadIdentity();
+        float var1 = 0.00390625F;
+        GlStateManager.scale(var1, var1, var1);
+        GlStateManager.translate(8.0F, 8.0F, 8.0F);
+        GlStateManager.matrixMode(5888);
+        this.mc.getTextureManager().bindTexture(this.locationLightMap);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_CLAMP);
+        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_CLAMP);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.func_179098_w();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+    }
+
+    /**
+     * Recompute a random value that is applied to block color in updateLightmap()
+     */
+    private void updateTorchFlicker()
+    {
+        this.field_175075_L = (float)((double)this.field_175075_L + (Math.random() - Math.random()) * Math.random() * Math.random());
+        this.field_175075_L = (float)((double)this.field_175075_L * 0.9D);
+        this.torchFlickerX += (this.field_175075_L - this.torchFlickerX) * 1.0F;
+        this.lightmapUpdateNeeded = true;
+    }
+
+    private void updateLightmap(float p_78472_1_)
+    {
+        if (this.lightmapUpdateNeeded)
+        {
+            this.mc.mcProfiler.startSection("lightTex");
+            WorldClient var2 = this.mc.theWorld;
+
+            if (var2 != null)
+            {
+                for (int var3 = 0; var3 < 256; ++var3)
+                {
+                    float var4 = var2.getSunBrightness(1.0F) * 0.95F + 0.05F;
+                    float var5 = var2.provider.getLightBrightnessTable()[var3 / 16] * var4;
+                    float var6 = var2.provider.getLightBrightnessTable()[var3 % 16] * (this.torchFlickerX * 0.1F + 1.5F);
+
+                    if (var2.func_175658_ac() > 0)
+                    {
+                        var5 = var2.provider.getLightBrightnessTable()[var3 / 16];
+                    }
+
+                    float var7 = var5 * (var2.getSunBrightness(1.0F) * 0.65F + 0.35F);
+                    float var8 = var5 * (var2.getSunBrightness(1.0F) * 0.65F + 0.35F);
+                    float var11 = var6 * ((var6 * 0.6F + 0.4F) * 0.6F + 0.4F);
+                    float var12 = var6 * (var6 * var6 * 0.6F + 0.4F);
+                    float var13 = var7 + var6;
+                    float var14 = var8 + var11;
+                    float var15 = var5 + var12;
+                    var13 = var13 * 0.96F + 0.03F;
+                    var14 = var14 * 0.96F + 0.03F;
+                    var15 = var15 * 0.96F + 0.03F;
+                    float var16;
+
+                    if (this.bossColorModifier > 0.0F)
+                    {
+                        var16 = this.bossColorModifierPrev + (this.bossColorModifier - this.bossColorModifierPrev) * p_78472_1_;
+                        var13 = var13 * (1.0F - var16) + var13 * 0.7F * var16;
+                        var14 = var14 * (1.0F - var16) + var14 * 0.6F * var16;
+                        var15 = var15 * (1.0F - var16) + var15 * 0.6F * var16;
+                    }
+
+                    if (var2.provider.getDimensionId() == 1)
+                    {
+                        var13 = 0.22F + var6 * 0.75F;
+                        var14 = 0.28F + var11 * 0.75F;
+                        var15 = 0.25F + var12 * 0.75F;
+                    }
+
+                    float var17;
+
+                    if (this.mc.thePlayer.isPotionActive(Potion.nightVision))
+                    {
+                        var16 = this.func_180438_a(this.mc.thePlayer, p_78472_1_);
+                        var17 = 1.0F / var13;
+
+                        if (var17 > 1.0F / var14)
+                        {
+                            var17 = 1.0F / var14;
+                        }
+
+                        if (var17 > 1.0F / var15)
+                        {
+                            var17 = 1.0F / var15;
+                        }
+
+                        var13 = var13 * (1.0F - var16) + var13 * var17 * var16;
+                        var14 = var14 * (1.0F - var16) + var14 * var17 * var16;
+                        var15 = var15 * (1.0F - var16) + var15 * var17 * var16;
+                    }
+
+                    if (var13 > 1.0F)
+                    {
+                        var13 = 1.0F;
+                    }
+
+                    if (var14 > 1.0F)
+                    {
+                        var14 = 1.0F;
+                    }
+
+                    if (var15 > 1.0F)
+                    {
+                        var15 = 1.0F;
+                    }
+
+                    var16 = this.mc.gameSettings.gammaSetting;
+                    var17 = 1.0F - var13;
+                    float var18 = 1.0F - var14;
+                    float var19 = 1.0F - var15;
+                    var17 = 1.0F - var17 * var17 * var17 * var17;
+                    var18 = 1.0F - var18 * var18 * var18 * var18;
+                    var19 = 1.0F - var19 * var19 * var19 * var19;
+                    var13 = var13 * (1.0F - var16) + var17 * var16;
+                    var14 = var14 * (1.0F - var16) + var18 * var16;
+                    var15 = var15 * (1.0F - var16) + var19 * var16;
+                    var13 = var13 * 0.96F + 0.03F;
+                    var14 = var14 * 0.96F + 0.03F;
+                    var15 = var15 * 0.96F + 0.03F;
+
+                    if (var13 > 1.0F)
+                    {
+                        var13 = 1.0F;
+                    }
+
+                    if (var14 > 1.0F)
+                    {
+                        var14 = 1.0F;
+                    }
+
+                    if (var15 > 1.0F)
+                    {
+                        var15 = 1.0F;
+                    }
+
+                    if (var13 < 0.0F)
+                    {
+                        var13 = 0.0F;
+                    }
+
+                    if (var14 < 0.0F)
+                    {
+                        var14 = 0.0F;
+                    }
+
+                    if (var15 < 0.0F)
+                    {
+                        var15 = 0.0F;
+                    }
+
+                    short var20 = 255;
+                    int var21 = (int)(var13 * 255.0F);
+                    int var22 = (int)(var14 * 255.0F);
+                    int var23 = (int)(var15 * 255.0F);
+                    this.lightmapColors[var3] = var20 << 24 | var21 << 16 | var22 << 8 | var23;
+                }
+
+                this.lightmapTexture.updateDynamicTexture();
+                this.lightmapUpdateNeeded = false;
+                this.mc.mcProfiler.endSection();
+            }
+        }
+    }
+
+    private float func_180438_a(EntityLivingBase p_180438_1_, float p_180438_2_)
+    {
+        int var3 = p_180438_1_.getActivePotionEffect(Potion.nightVision).getDuration();
+        return var3 > 200 ? 1.0F : 0.7F + MathHelper.sin(((float)var3 - p_180438_2_) * (float)Math.PI * 0.2F) * 0.3F;
+    }
+
+    /**
+     * Will update any inputs that effect the camera angle (mouse) and then render the world and GUI
+     */
+    public void updateCameraAndRender(float p_78480_1_)
+    {
+        boolean var2 = Display.isActive();
+
+        if (!var2 && this.mc.gameSettings.pauseOnLostFocus && (!this.mc.gameSettings.touchscreen || !Mouse.isButtonDown(1)))
+        {
+            if (Minecraft.getSystemTime() - this.prevFrameTime > 500L)
+            {
+                this.mc.displayInGameMenu();
+            }
+        }
+        else
+        {
+            this.prevFrameTime = Minecraft.getSystemTime();
+        }
+
+        this.mc.mcProfiler.startSection("mouse");
+
+        if (var2 && Minecraft.isRunningOnMac && this.mc.inGameHasFocus && !Mouse.isInsideWindow())
+        {
+            Mouse.setGrabbed(false);
+            Mouse.setCursorPosition(Display.getWidth() / 2, Display.getHeight() / 2);
+            Mouse.setGrabbed(true);
+        }
+
+        if (this.mc.inGameHasFocus && var2)
+        {
+            this.mc.mouseHelper.mouseXYChange();
+            float var3 = this.mc.gameSettings.mouseSensitivity * 0.6F + 0.2F;
+            float var4 = var3 * var3 * var3 * 8.0F;
+            float var5 = (float)this.mc.mouseHelper.deltaX * var4;
+            float var6 = (float)this.mc.mouseHelper.deltaY * var4;
+            byte var7 = 1;
+
+            if (this.mc.gameSettings.invertMouse)
+            {
+                var7 = -1;
+            }
+
+            if (this.mc.gameSettings.smoothCamera)
+            {
+                this.smoothCamYaw += var5;
+                this.smoothCamPitch += var6;
+                float var8 = p_78480_1_ - this.smoothCamPartialTicks;
+                this.smoothCamPartialTicks = p_78480_1_;
+                var5 = this.smoothCamFilterX * var8;
+                var6 = this.smoothCamFilterY * var8;
+                this.mc.thePlayer.setAngles(var5, var6 * (float)var7);
+            }
+            else
+            {
+                this.smoothCamYaw = 0.0F;
+                this.smoothCamPitch = 0.0F;
+                this.mc.thePlayer.setAngles(var5, var6 * (float)var7);
+            }
+        }
+
+        this.mc.mcProfiler.endSection();
+
+        if (!this.mc.skipRenderWorld)
+        {
+            anaglyphEnable = this.mc.gameSettings.anaglyph;
+            final ScaledResolution var13 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
+            int var14 = var13.getScaledWidth();
+            int var15 = var13.getScaledHeight();
+            final int var16 = Mouse.getX() * var14 / this.mc.displayWidth;
+            final int var17 = var15 - Mouse.getY() * var15 / this.mc.displayHeight - 1;
+            int var18 = this.mc.gameSettings.limitFramerate;
+
+            if (this.mc.theWorld != null)
+            {
+                this.mc.mcProfiler.startSection("level");
+                int var9 = Math.max(Minecraft.func_175610_ah(), 30);
+                this.renderWorld(p_78480_1_, this.renderEndNanoTime + (long)(1000000000 / var9));
+
+                if (OpenGlHelper.shadersSupported)
+                {
+                    this.mc.renderGlobal.func_174975_c();
+
+                    if (this.theShaderGroup != null && this.field_175083_ad)
+                    {
+                        GlStateManager.matrixMode(5890);
+                        GlStateManager.pushMatrix();
+                        GlStateManager.loadIdentity();
+                        this.theShaderGroup.loadShaderGroup(p_78480_1_);
+                        GlStateManager.popMatrix();
+                    }
+
+                    this.mc.getFramebuffer().bindFramebuffer(true);
+                }
+
+                this.renderEndNanoTime = System.nanoTime();
+                this.mc.mcProfiler.endStartSection("gui");
+
+                if (!this.mc.gameSettings.hideGUI || this.mc.currentScreen != null)
+                {
+                    GlStateManager.alphaFunc(516, 0.1F);
+                    this.mc.ingameGUI.func_175180_a(p_78480_1_);
+                }
+
+                this.mc.mcProfiler.endSection();
+            }
+            else
+            {
+                GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
+                GlStateManager.matrixMode(5889);
+                GlStateManager.loadIdentity();
+                GlStateManager.matrixMode(5888);
+                GlStateManager.loadIdentity();
+                this.setupOverlayRendering();
+                this.renderEndNanoTime = System.nanoTime();
+            }
+
+            if (this.mc.currentScreen != null)
+            {
+                GlStateManager.clear(256);
+
+                try
+                {
+                    this.mc.currentScreen.drawScreen(var16, var17, p_78480_1_);
+                }
+                catch (Throwable var12)
+                {
+                    CrashReport var10 = CrashReport.makeCrashReport(var12, "Rendering screen");
+                    CrashReportCategory var11 = var10.makeCategory("Screen render details");
+                    var11.addCrashSectionCallable("Screen name", new Callable()
+                    {
+                        private static final String __OBFID = "CL_00000948";
+                        public String call()
+                        {
+                            return EntityRenderer.this.mc.currentScreen.getClass().getCanonicalName();
+                        }
+                    });
+                    var11.addCrashSectionCallable("Mouse location", new Callable()
+                    {
+                        private static final String __OBFID = "CL_00000950";
+                        public String call()
+                        {
+                            return String.format("Scaled: (%d, %d). Absolute: (%d, %d)", new Object[] {Integer.valueOf(var16), Integer.valueOf(var17), Integer.valueOf(Mouse.getX()), Integer.valueOf(Mouse.getY())});
+                        }
+                    });
+                    var11.addCrashSectionCallable("Screen size", new Callable()
+                    {
+                        private static final String __OBFID = "CL_00000951";
+                        public String call()
+                        {
+                            return String.format("Scaled: (%d, %d). Absolute: (%d, %d). Scale factor of %d", new Object[] {Integer.valueOf(var13.getScaledWidth()), Integer.valueOf(var13.getScaledHeight()), Integer.valueOf(EntityRenderer.this.mc.displayWidth), Integer.valueOf(EntityRenderer.this.mc.displayHeight), Integer.valueOf(var13.getScaleFactor())});
+                        }
+                    });
+                    throw new ReportedException(var10);
+                }
+            }
+        }
+    }
+
+    public void func_152430_c(float p_152430_1_)
+    {
+        this.setupOverlayRendering();
+        this.mc.ingameGUI.func_180478_c(new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight));
+    }
+
+    private boolean func_175070_n()
+    {
+        if (!this.field_175073_D)
+        {
+            return false;
+        }
+        else
+        {
+            Entity var1 = this.mc.func_175606_aa();
+            boolean var2 = var1 instanceof EntityPlayer && !this.mc.gameSettings.hideGUI;
+
+            if (var2 && !((EntityPlayer)var1).capabilities.allowEdit)
+            {
+                ItemStack var3 = ((EntityPlayer)var1).getCurrentEquippedItem();
+
+                if (this.mc.objectMouseOver != null && this.mc.objectMouseOver.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
+                {
+                    BlockPos var4 = this.mc.objectMouseOver.getBlockPos();
+                    Block var5 = this.mc.theWorld.getBlockState(var4).getBlock();
+
+                    if (this.mc.playerController.func_178889_l() == WorldSettings.GameType.SPECTATOR)
+                    {
+                        var2 = var5.hasTileEntity() && this.mc.theWorld.getTileEntity(var4) instanceof IInventory;
+                    }
+                    else
+                    {
+                        var2 = var3 != null && (var3.canDestroy(var5) || var3.canPlaceOn(var5));
+                    }
+                }
+            }
+
+            return var2;
+        }
+    }
+
+    private void func_175067_i(float p_175067_1_)
+    {
+        if (this.mc.gameSettings.showDebugInfo && !this.mc.gameSettings.hideGUI && !this.mc.thePlayer.func_175140_cp() && !this.mc.gameSettings.field_178879_v)
+        {
+            Entity var2 = this.mc.func_175606_aa();
+            GlStateManager.enableBlend();
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+            GL11.glLineWidth(1.0F);
+            GlStateManager.func_179090_x();
+            GlStateManager.depthMask(false);
+            GlStateManager.pushMatrix();
+            GlStateManager.matrixMode(5888);
+            GlStateManager.loadIdentity();
+            this.orientCamera(p_175067_1_);
+            GlStateManager.translate(0.0F, var2.getEyeHeight(), 0.0F);
+            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 0.005D, 1.0E-4D, 1.0E-4D), -65536);
+            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 1.0E-4D, 1.0E-4D, 0.005D), -16776961);
+            RenderGlobal.drawOutlinedBoundingBox(new AxisAlignedBB(0.0D, 0.0D, 0.0D, 1.0E-4D, 0.0033D, 1.0E-4D), -16711936);
+            GlStateManager.popMatrix();
+            GlStateManager.depthMask(true);
+            GlStateManager.func_179098_w();
+            GlStateManager.disableBlend();
+        }
+    }
+
+    public void renderWorld(float p_78471_1_, long p_78471_2_)
+    {
+        this.updateLightmap(p_78471_1_);
+
+        if (this.mc.func_175606_aa() == null)
+        {
+            this.mc.func_175607_a(this.mc.thePlayer);
+        }
+
+        this.getMouseOver(p_78471_1_);
+        
+        //TODO: Client
+        if(caveFinderMod == null)
+			caveFinderMod = (CaveFinderMod)WurstClient.INSTANCE.modManager.getModByClass(CaveFinderMod.class);
+		if(!caveFinderMod.isEnabled())
+			GlStateManager.enableDepth();
+        
+        GlStateManager.enableAlpha();
+        GlStateManager.alphaFunc(516, 0.5F);
+        this.mc.mcProfiler.startSection("center");
+
+        if (this.mc.gameSettings.anaglyph)
+        {
+            anaglyphField = 0;
+            GlStateManager.colorMask(false, true, true, false);
+            this.func_175068_a(0, p_78471_1_, p_78471_2_);
+            anaglyphField = 1;
+            GlStateManager.colorMask(true, false, false, false);
+            this.func_175068_a(1, p_78471_1_, p_78471_2_);
+            GlStateManager.colorMask(true, true, true, false);
+        }
+        else
+        {
+            this.func_175068_a(2, p_78471_1_, p_78471_2_);
+        }
+
+        this.mc.mcProfiler.endSection();
+    }
+
+    private void func_175068_a(int p_175068_1_, float p_175068_2_, long p_175068_3_)
+    {
+        RenderGlobal var5 = this.mc.renderGlobal;
+        EffectRenderer var6 = this.mc.effectRenderer;
+        boolean var7 = this.func_175070_n();
+        GlStateManager.enableCull();
+        this.mc.mcProfiler.endStartSection("clear");
+        GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
+        this.updateFogColor(p_175068_2_);
+        GlStateManager.clear(16640);
+        this.mc.mcProfiler.endStartSection("camera");
+        this.setupCameraTransform(p_175068_2_, p_175068_1_);
+        ActiveRenderInfo.updateRenderInfo(this.mc.thePlayer, this.mc.gameSettings.thirdPersonView == 2);
+        this.mc.mcProfiler.endStartSection("frustum");
+        ClippingHelperImpl.getInstance();
+        this.mc.mcProfiler.endStartSection("culling");
+        Frustrum var8 = new Frustrum();
+        Entity var9 = this.mc.func_175606_aa();
+        double var10 = var9.lastTickPosX + (var9.posX - var9.lastTickPosX) * (double)p_175068_2_;
+        double var12 = var9.lastTickPosY + (var9.posY - var9.lastTickPosY) * (double)p_175068_2_;
+        double var14 = var9.lastTickPosZ + (var9.posZ - var9.lastTickPosZ) * (double)p_175068_2_;
+        var8.setPosition(var10, var12, var14);
+
+        if (this.mc.gameSettings.renderDistanceChunks >= 4)
+        {
+            this.setupFog(-1, p_175068_2_);
+            this.mc.mcProfiler.endStartSection("sky");
+            GlStateManager.matrixMode(5889);
+            GlStateManager.loadIdentity();
+            Project.gluPerspective(this.getFOVModifier(p_175068_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 2.0F);
+            GlStateManager.matrixMode(5888);
+            var5.func_174976_a(p_175068_2_, p_175068_1_);
+            GlStateManager.matrixMode(5889);
+            GlStateManager.loadIdentity();
+            Project.gluPerspective(this.getFOVModifier(p_175068_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
+            GlStateManager.matrixMode(5888);
+        }
+
+        this.setupFog(0, p_175068_2_);
+        GlStateManager.shadeModel(7425);
+
+        if (var9.posY + (double)var9.getEyeHeight() < 128.0D)
+        {
+            this.func_180437_a(var5, p_175068_2_, p_175068_1_);
+        }
+
+        this.mc.mcProfiler.endStartSection("prepareterrain");
+        this.setupFog(0, p_175068_2_);
+        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
+        RenderHelper.disableStandardItemLighting();
+        this.mc.mcProfiler.endStartSection("terrain_setup");
+        var5.func_174970_a(var9, (double)p_175068_2_, var8, this.field_175084_ae++, this.mc.thePlayer.isSpectator());
+
+        if (p_175068_1_ == 0 || p_175068_1_ == 2)
+        {
+            this.mc.mcProfiler.endStartSection("updatechunks");
+            this.mc.renderGlobal.func_174967_a(p_175068_3_);
+        }
+
+        this.mc.mcProfiler.endStartSection("terrain");
+        GlStateManager.matrixMode(5888);
+        GlStateManager.pushMatrix();
+        GlStateManager.disableAlpha();
+        var5.func_174977_a(EnumWorldBlockLayer.SOLID, (double)p_175068_2_, p_175068_1_, var9);
+        GlStateManager.enableAlpha();
+        var5.func_174977_a(EnumWorldBlockLayer.CUTOUT_MIPPED, (double)p_175068_2_, p_175068_1_, var9);
+        this.mc.getTextureManager().getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
+        var5.func_174977_a(EnumWorldBlockLayer.CUTOUT, (double)p_175068_2_, p_175068_1_, var9);
+        this.mc.getTextureManager().getTexture(TextureMap.locationBlocksTexture).func_174935_a();
+        GlStateManager.shadeModel(7424);
+        GlStateManager.alphaFunc(516, 0.1F);
+        EntityPlayer var16;
+
+        if (!this.field_175078_W)
+        {
+            GlStateManager.matrixMode(5888);
+            GlStateManager.popMatrix();
+            GlStateManager.pushMatrix();
+            RenderHelper.enableStandardItemLighting();
+            this.mc.mcProfiler.endStartSection("entities");
+            var5.func_180446_a(var9, var8, p_175068_2_);
+            RenderHelper.disableStandardItemLighting();
+            this.func_175072_h();
+            GlStateManager.matrixMode(5888);
+            GlStateManager.popMatrix();
+            GlStateManager.pushMatrix();
+
+            if (this.mc.objectMouseOver != null && var9.isInsideOfMaterial(Material.water) && var7)
+            {
+                var16 = (EntityPlayer)var9;
+                GlStateManager.disableAlpha();
+                this.mc.mcProfiler.endStartSection("outline");
+                var5.drawSelectionBox(var16, this.mc.objectMouseOver, 0, p_175068_2_);
+                GlStateManager.enableAlpha();
+            }
+        }
+
+        GlStateManager.matrixMode(5888);
+        GlStateManager.popMatrix();
+
+        if (var7 && this.mc.objectMouseOver != null && !var9.isInsideOfMaterial(Material.water))
+        {
+            var16 = (EntityPlayer)var9;
+            GlStateManager.disableAlpha();
+            this.mc.mcProfiler.endStartSection("outline");
+            var5.drawSelectionBox(var16, this.mc.objectMouseOver, 0, p_175068_2_);
+            GlStateManager.enableAlpha();
+        }
+
+        this.mc.mcProfiler.endStartSection("destroyProgress");
+        GlStateManager.enableBlend();
+        GlStateManager.tryBlendFuncSeparate(770, 1, 1, 0);
+        var5.func_174981_a(Tessellator.getInstance(), Tessellator.getInstance().getWorldRenderer(), var9, p_175068_2_);
+        GlStateManager.disableBlend();
+
+        if (!this.field_175078_W)
+        {
+            this.func_180436_i();
+            this.mc.mcProfiler.endStartSection("litParticles");
+            var6.renderLitParticles(var9, p_175068_2_);
+            RenderHelper.disableStandardItemLighting();
+            this.setupFog(0, p_175068_2_);
+            this.mc.mcProfiler.endStartSection("particles");
+            var6.renderParticles(var9, p_175068_2_);
+            this.func_175072_h();
+        }
+
+        GlStateManager.depthMask(false);
+        GlStateManager.enableCull();
+        this.mc.mcProfiler.endStartSection("weather");
+        this.renderRainSnow(p_175068_2_);
+        GlStateManager.depthMask(true);
+        var5.func_180449_a(var9, p_175068_2_);
+        GlStateManager.disableBlend();
+        GlStateManager.enableCull();
+        GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+        GlStateManager.alphaFunc(516, 0.1F);
+        this.setupFog(0, p_175068_2_);
+        GlStateManager.enableBlend();
+        GlStateManager.depthMask(false);
+        this.mc.getTextureManager().bindTexture(TextureMap.locationBlocksTexture);
+        GlStateManager.shadeModel(7425);
+
+        if (this.mc.gameSettings.fancyGraphics)
+        {
+            this.mc.mcProfiler.endStartSection("translucent");
+            GlStateManager.enableBlend();
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+            var5.func_174977_a(EnumWorldBlockLayer.TRANSLUCENT, (double)p_175068_2_, p_175068_1_, var9);
+            GlStateManager.disableBlend();
+        }
+        else
+        {
+            this.mc.mcProfiler.endStartSection("translucent");
+            var5.func_174977_a(EnumWorldBlockLayer.TRANSLUCENT, (double)p_175068_2_, p_175068_1_, var9);
+        }
+
+        GlStateManager.shadeModel(7424);
+        GlStateManager.depthMask(true);
+        GlStateManager.enableCull();
+        GlStateManager.disableBlend();
+        GlStateManager.disableFog();
+
+        if (var9.posY + (double)var9.getEyeHeight() >= 128.0D)
+        {
+            this.mc.mcProfiler.endStartSection("aboveClouds");
+            this.func_180437_a(var5, p_175068_2_, p_175068_1_);
+        }
+
+        this.mc.mcProfiler.endStartSection("hand");
+
+        //TODO: Client
+        WurstClient.INSTANCE.eventManager.fireEvent(RenderEvent.class, new RenderEvent());
+        
+        if (this.field_175074_C)
+        {
+            GlStateManager.clear(256);
+            this.renderHand(p_175068_2_, p_175068_1_);
+            this.func_175067_i(p_175068_2_);
+        }
+    }
+
+    private void func_180437_a(RenderGlobal p_180437_1_, float p_180437_2_, int p_180437_3_)
+    {
+        if (this.mc.gameSettings.shouldRenderClouds())
+        {
+            this.mc.mcProfiler.endStartSection("clouds");
+            GlStateManager.matrixMode(5889);
+            GlStateManager.loadIdentity();
+            Project.gluPerspective(this.getFOVModifier(p_180437_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * 4.0F);
+            GlStateManager.matrixMode(5888);
+            GlStateManager.pushMatrix();
+            this.setupFog(0, p_180437_2_);
+            p_180437_1_.func_180447_b(p_180437_2_, p_180437_3_);
+            GlStateManager.disableFog();
+            GlStateManager.popMatrix();
+            GlStateManager.matrixMode(5889);
+            GlStateManager.loadIdentity();
+            Project.gluPerspective(this.getFOVModifier(p_180437_2_, true), (float)this.mc.displayWidth / (float)this.mc.displayHeight, 0.05F, this.farPlaneDistance * MathHelper.field_180189_a);
+            GlStateManager.matrixMode(5888);
+        }
+    }
+
+    private void addRainParticles()
+    {
+        float var1 = this.mc.theWorld.getRainStrength(1.0F);
+
+        if (!this.mc.gameSettings.fancyGraphics)
+        {
+            var1 /= 2.0F;
+        }
+
+        if (var1 != 0.0F)
+        {
+            this.random.setSeed((long)this.rendererUpdateCount * 312987231L);
+            Entity var2 = this.mc.func_175606_aa();
+            WorldClient var3 = this.mc.theWorld;
+            BlockPos var4 = new BlockPos(var2);
+            byte var5 = 10;
+            double var6 = 0.0D;
+            double var8 = 0.0D;
+            double var10 = 0.0D;
+            int var12 = 0;
+            int var13 = (int)(100.0F * var1 * var1);
+
+            if (this.mc.gameSettings.particleSetting == 1)
+            {
+                var13 >>= 1;
+            }
+            else if (this.mc.gameSettings.particleSetting == 2)
+            {
+                var13 = 0;
+            }
+
+            for (int var14 = 0; var14 < var13; ++var14)
+            {
+                BlockPos var15 = var3.func_175725_q(var4.add(this.random.nextInt(var5) - this.random.nextInt(var5), 0, this.random.nextInt(var5) - this.random.nextInt(var5)));
+                BiomeGenBase var16 = var3.getBiomeGenForCoords(var15);
+                BlockPos var17 = var15.offsetDown();
+                Block var18 = var3.getBlockState(var17).getBlock();
+
+                if (var15.getY() <= var4.getY() + var5 && var15.getY() >= var4.getY() - var5 && var16.canSpawnLightningBolt() && var16.func_180626_a(var15) >= 0.15F)
+                {
+                    float var19 = this.random.nextFloat();
+                    float var20 = this.random.nextFloat();
+
+                    if (var18.getMaterial() == Material.lava)
+                    {
+                        this.mc.theWorld.spawnParticle(EnumParticleTypes.SMOKE_NORMAL, (double)((float)var15.getX() + var19), (double)((float)var15.getY() + 0.1F) - var18.getBlockBoundsMinY(), (double)((float)var15.getZ() + var20), 0.0D, 0.0D, 0.0D, new int[0]);
+                    }
+                    else if (var18.getMaterial() != Material.air)
+                    {
+                        var18.setBlockBoundsBasedOnState(var3, var17);
+                        ++var12;
+
+                        if (this.random.nextInt(var12) == 0)
+                        {
+                            var6 = (double)((float)var17.getX() + var19);
+                            var8 = (double)((float)var17.getY() + 0.1F) + var18.getBlockBoundsMaxY() - 1.0D;
+                            var10 = (double)((float)var17.getZ() + var20);
+                        }
+
+                        this.mc.theWorld.spawnParticle(EnumParticleTypes.WATER_DROP, (double)((float)var17.getX() + var19), (double)((float)var17.getY() + 0.1F) + var18.getBlockBoundsMaxY(), (double)((float)var17.getZ() + var20), 0.0D, 0.0D, 0.0D, new int[0]);
+                    }
+                }
+            }
+
+            if (var12 > 0 && this.random.nextInt(3) < this.rainSoundCounter++)
+            {
+                this.rainSoundCounter = 0;
+
+                if (var8 > (double)(var4.getY() + 1) && var3.func_175725_q(var4).getY() > MathHelper.floor_float((float)var4.getY()))
+                {
+                    this.mc.theWorld.playSound(var6, var8, var10, "ambient.weather.rain", 0.1F, 0.5F, false);
+                }
+                else
+                {
+                    this.mc.theWorld.playSound(var6, var8, var10, "ambient.weather.rain", 0.2F, 1.0F, false);
+                }
+            }
+        }
+    }
+
+    /**
+     * Render rain and snow
+     */
+    protected void renderRainSnow(float p_78474_1_)
+    {
+        float var2 = this.mc.theWorld.getRainStrength(p_78474_1_);
+
+        if (var2 > 0.0F)
+        {
+            this.func_180436_i();
+            Entity var3 = this.mc.func_175606_aa();
+            WorldClient var4 = this.mc.theWorld;
+            int var5 = MathHelper.floor_double(var3.posX);
+            int var6 = MathHelper.floor_double(var3.posY);
+            int var7 = MathHelper.floor_double(var3.posZ);
+            Tessellator var8 = Tessellator.getInstance();
+            WorldRenderer var9 = var8.getWorldRenderer();
+            GlStateManager.disableCull();
+            GL11.glNormal3f(0.0F, 1.0F, 0.0F);
+            GlStateManager.enableBlend();
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+            GlStateManager.alphaFunc(516, 0.1F);
+            double var10 = var3.lastTickPosX + (var3.posX - var3.lastTickPosX) * (double)p_78474_1_;
+            double var12 = var3.lastTickPosY + (var3.posY - var3.lastTickPosY) * (double)p_78474_1_;
+            double var14 = var3.lastTickPosZ + (var3.posZ - var3.lastTickPosZ) * (double)p_78474_1_;
+            int var16 = MathHelper.floor_double(var12);
+            byte var17 = 5;
+
+            if (this.mc.gameSettings.fancyGraphics)
+            {
+                var17 = 10;
+            }
+
+            byte var18 = -1;
+            float var19 = (float)this.rendererUpdateCount + p_78474_1_;
+
+            if (this.mc.gameSettings.fancyGraphics)
+            {
+                var17 = 10;
+            }
+
+            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+
+            for (int var20 = var7 - var17; var20 <= var7 + var17; ++var20)
+            {
+                for (int var21 = var5 - var17; var21 <= var5 + var17; ++var21)
+                {
+                    int var22 = (var20 - var7 + 16) * 32 + var21 - var5 + 16;
+                    float var23 = this.field_175076_N[var22] * 0.5F;
+                    float var24 = this.field_175077_O[var22] * 0.5F;
+                    BlockPos var25 = new BlockPos(var21, 0, var20);
+                    BiomeGenBase var26 = var4.getBiomeGenForCoords(var25);
+
+                    if (var26.canSpawnLightningBolt() || var26.getEnableSnow())
+                    {
+                        int var27 = var4.func_175725_q(var25).getY();
+                        int var28 = var6 - var17;
+                        int var29 = var6 + var17;
+
+                        if (var28 < var27)
+                        {
+                            var28 = var27;
+                        }
+
+                        if (var29 < var27)
+                        {
+                            var29 = var27;
+                        }
+
+                        float var30 = 1.0F;
+                        int var31 = var27;
+
+                        if (var27 < var16)
+                        {
+                            var31 = var16;
+                        }
+
+                        if (var28 != var29)
+                        {
+                            this.random.setSeed((long)(var21 * var21 * 3121 + var21 * 45238971 ^ var20 * var20 * 418711 + var20 * 13761));
+                            float var32 = var26.func_180626_a(new BlockPos(var21, var28, var20));
+                            float var33;
+                            double var36;
+
+                            if (var4.getWorldChunkManager().getTemperatureAtHeight(var32, var27) >= 0.15F)
+                            {
+                                if (var18 != 0)
+                                {
+                                    if (var18 >= 0)
+                                    {
+                                        var8.draw();
+                                    }
+
+                                    var18 = 0;
+                                    this.mc.getTextureManager().bindTexture(locationRainPng);
+                                    var9.startDrawingQuads();
+                                }
+
+                                var33 = ((float)(this.rendererUpdateCount + var21 * var21 * 3121 + var21 * 45238971 + var20 * var20 * 418711 + var20 * 13761 & 31) + p_78474_1_) / 32.0F * (3.0F + this.random.nextFloat());
+                                double var34 = (double)((float)var21 + 0.5F) - var3.posX;
+                                var36 = (double)((float)var20 + 0.5F) - var3.posZ;
+                                float var38 = MathHelper.sqrt_double(var34 * var34 + var36 * var36) / (float)var17;
+                                float var39 = 1.0F;
+                                var9.func_178963_b(var4.getCombinedLight(new BlockPos(var21, var31, var20), 0));
+                                var9.setColorRGBA_F(var39, var39, var39, ((1.0F - var38 * var38) * 0.5F + 0.5F) * var2);
+                                var9.setTranslation(-var10 * 1.0D, -var12 * 1.0D, -var14 * 1.0D);
+                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var28, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30), (double)((float)var28 * var30 / 4.0F + var33 * var30));
+                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var28, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30), (double)((float)var28 * var30 / 4.0F + var33 * var30));
+                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var29, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30), (double)((float)var29 * var30 / 4.0F + var33 * var30));
+                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var29, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30), (double)((float)var29 * var30 / 4.0F + var33 * var30));
+                                var9.setTranslation(0.0D, 0.0D, 0.0D);
+                            }
+                            else
+                            {
+                                if (var18 != 1)
+                                {
+                                    if (var18 >= 0)
+                                    {
+                                        var8.draw();
+                                    }
+
+                                    var18 = 1;
+                                    this.mc.getTextureManager().bindTexture(locationSnowPng);
+                                    var9.startDrawingQuads();
+                                }
+
+                                var33 = ((float)(this.rendererUpdateCount & 511) + p_78474_1_) / 512.0F;
+                                float var42 = this.random.nextFloat() + var19 * 0.01F * (float)this.random.nextGaussian();
+                                float var35 = this.random.nextFloat() + var19 * (float)this.random.nextGaussian() * 0.001F;
+                                var36 = (double)((float)var21 + 0.5F) - var3.posX;
+                                double var43 = (double)((float)var20 + 0.5F) - var3.posZ;
+                                float var40 = MathHelper.sqrt_double(var36 * var36 + var43 * var43) / (float)var17;
+                                float var41 = 1.0F;
+                                var9.func_178963_b((var4.getCombinedLight(new BlockPos(var21, var31, var20), 0) * 3 + 15728880) / 4);
+                                var9.setColorRGBA_F(var41, var41, var41, ((1.0F - var40 * var40) * 0.3F + 0.5F) * var2);
+                                var9.setTranslation(-var10 * 1.0D, -var12 * 1.0D, -var14 * 1.0D);
+                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var28, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30 + var42), (double)((float)var28 * var30 / 4.0F + var33 * var30 + var35));
+                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var28, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30 + var42), (double)((float)var28 * var30 / 4.0F + var33 * var30 + var35));
+                                var9.addVertexWithUV((double)((float)var21 + var23) + 0.5D, (double)var29, (double)((float)var20 + var24) + 0.5D, (double)(1.0F * var30 + var42), (double)((float)var29 * var30 / 4.0F + var33 * var30 + var35));
+                                var9.addVertexWithUV((double)((float)var21 - var23) + 0.5D, (double)var29, (double)((float)var20 - var24) + 0.5D, (double)(0.0F * var30 + var42), (double)((float)var29 * var30 / 4.0F + var33 * var30 + var35));
+                                var9.setTranslation(0.0D, 0.0D, 0.0D);
+                            }
+                        }
+                    }
+                }
+            }
+
+            if (var18 >= 0)
+            {
+                var8.draw();
+            }
+
+            GlStateManager.enableCull();
+            GlStateManager.disableBlend();
+            GlStateManager.alphaFunc(516, 0.1F);
+            this.func_175072_h();
+        }
+    }
+
+    /**
+     * Setup orthogonal projection for rendering GUI screen overlays
+     */
+    public void setupOverlayRendering()
+    {
+        ScaledResolution var1 = new ScaledResolution(this.mc, this.mc.displayWidth, this.mc.displayHeight);
+        GlStateManager.clear(256);
+        GlStateManager.matrixMode(5889);
+        GlStateManager.loadIdentity();
+        GlStateManager.ortho(0.0D, var1.getScaledWidth_double(), var1.getScaledHeight_double(), 0.0D, 1000.0D, 3000.0D);
+        GlStateManager.matrixMode(5888);
+        GlStateManager.loadIdentity();
+        GlStateManager.translate(0.0F, 0.0F, -2000.0F);
+    }
+
+    /**
+     * calculates fog and calls glClearColor
+     */
+    private void updateFogColor(float p_78466_1_)
+    {
+        WorldClient var2 = this.mc.theWorld;
+        Entity var3 = this.mc.func_175606_aa();
+        float var4 = 0.25F + 0.75F * (float)this.mc.gameSettings.renderDistanceChunks / 32.0F;
+        var4 = 1.0F - (float)Math.pow((double)var4, 0.25D);
+        Vec3 var5 = var2.getSkyColor(this.mc.func_175606_aa(), p_78466_1_);
+        float var6 = (float)var5.xCoord;
+        float var7 = (float)var5.yCoord;
+        float var8 = (float)var5.zCoord;
+        Vec3 var9 = var2.getFogColor(p_78466_1_);
+        this.field_175080_Q = (float)var9.xCoord;
+        this.field_175082_R = (float)var9.yCoord;
+        this.field_175081_S = (float)var9.zCoord;
+        float var13;
+
+        if (this.mc.gameSettings.renderDistanceChunks >= 4)
+        {
+            double var10 = -1.0D;
+            Vec3 var12 = MathHelper.sin(var2.getCelestialAngleRadians(p_78466_1_)) > 0.0F ? new Vec3(var10, 0.0D, 0.0D) : new Vec3(1.0D, 0.0D, 0.0D);
+            var13 = (float)var3.getLook(p_78466_1_).dotProduct(var12);
+
+            if (var13 < 0.0F)
+            {
+                var13 = 0.0F;
+            }
+
+            if (var13 > 0.0F)
+            {
+                float[] var14 = var2.provider.calcSunriseSunsetColors(var2.getCelestialAngle(p_78466_1_), p_78466_1_);
+
+                if (var14 != null)
+                {
+                    var13 *= var14[3];
+                    this.field_175080_Q = this.field_175080_Q * (1.0F - var13) + var14[0] * var13;
+                    this.field_175082_R = this.field_175082_R * (1.0F - var13) + var14[1] * var13;
+                    this.field_175081_S = this.field_175081_S * (1.0F - var13) + var14[2] * var13;
+                }
+            }
+        }
+
+        this.field_175080_Q += (var6 - this.field_175080_Q) * var4;
+        this.field_175082_R += (var7 - this.field_175082_R) * var4;
+        this.field_175081_S += (var8 - this.field_175081_S) * var4;
+        float var19 = var2.getRainStrength(p_78466_1_);
+        float var11;
+        float var20;
+
+        if (var19 > 0.0F)
+        {
+            var11 = 1.0F - var19 * 0.5F;
+            var20 = 1.0F - var19 * 0.4F;
+            this.field_175080_Q *= var11;
+            this.field_175082_R *= var11;
+            this.field_175081_S *= var20;
+        }
+
+        var11 = var2.getWeightedThunderStrength(p_78466_1_);
+
+        if (var11 > 0.0F)
+        {
+            var20 = 1.0F - var11 * 0.5F;
+            this.field_175080_Q *= var20;
+            this.field_175082_R *= var20;
+            this.field_175081_S *= var20;
+        }
+
+        Block var21 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78466_1_);
+
+        if (this.cloudFog)
+        {
+            Vec3 var22 = var2.getCloudColour(p_78466_1_);
+            this.field_175080_Q = (float)var22.xCoord;
+            this.field_175082_R = (float)var22.yCoord;
+            this.field_175081_S = (float)var22.zCoord;
+        }
+        else if (var21.getMaterial() == Material.water)
+        {
+            var13 = (float)EnchantmentHelper.func_180319_a(var3) * 0.2F;
+
+            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.waterBreathing))
+            {
+                var13 = var13 * 0.3F + 0.6F;
+            }
+
+            this.field_175080_Q = 0.02F + var13;
+            this.field_175082_R = 0.02F + var13;
+            this.field_175081_S = 0.2F + var13;
+        }
+        else if (var21.getMaterial() == Material.lava)
+        {
+            this.field_175080_Q = 0.6F;
+            this.field_175082_R = 0.1F;
+            this.field_175081_S = 0.0F;
+        }
+
+        var13 = this.fogColor2 + (this.fogColor1 - this.fogColor2) * p_78466_1_;
+        this.field_175080_Q *= var13;
+        this.field_175082_R *= var13;
+        this.field_175081_S *= var13;
+        double var23 = (var3.lastTickPosY + (var3.posY - var3.lastTickPosY) * (double)p_78466_1_) * var2.provider.getVoidFogYFactor();
+
+        //TODO: Client
+        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.blindness) && !WurstClient.INSTANCE.modManager.getModByClass(AntiBlindMod.class).isEnabled())
+        {
+            int var16 = ((EntityLivingBase)var3).getActivePotionEffect(Potion.blindness).getDuration();
+
+            if (var16 < 20)
+            {
+                var23 *= (double)(1.0F - (float)var16 / 20.0F);
+            }
+            else
+            {
+                var23 = 0.0D;
+            }
+        }
+
+        if (var23 < 1.0D)
+        {
+            if (var23 < 0.0D)
+            {
+                var23 = 0.0D;
+            }
+
+            var23 *= var23;
+            this.field_175080_Q = (float)((double)this.field_175080_Q * var23);
+            this.field_175082_R = (float)((double)this.field_175082_R * var23);
+            this.field_175081_S = (float)((double)this.field_175081_S * var23);
+        }
+
+        float var24;
+
+        if (this.bossColorModifier > 0.0F)
+        {
+            var24 = this.bossColorModifierPrev + (this.bossColorModifier - this.bossColorModifierPrev) * p_78466_1_;
+            this.field_175080_Q = this.field_175080_Q * (1.0F - var24) + this.field_175080_Q * 0.7F * var24;
+            this.field_175082_R = this.field_175082_R * (1.0F - var24) + this.field_175082_R * 0.6F * var24;
+            this.field_175081_S = this.field_175081_S * (1.0F - var24) + this.field_175081_S * 0.6F * var24;
+        }
+
+        float var17;
+
+        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.nightVision))
+        {
+            var24 = this.func_180438_a((EntityLivingBase)var3, p_78466_1_);
+            var17 = 1.0F / this.field_175080_Q;
+
+            if (var17 > 1.0F / this.field_175082_R)
+            {
+                var17 = 1.0F / this.field_175082_R;
+            }
+
+            if (var17 > 1.0F / this.field_175081_S)
+            {
+                var17 = 1.0F / this.field_175081_S;
+            }
+
+            this.field_175080_Q = this.field_175080_Q * (1.0F - var24) + this.field_175080_Q * var17 * var24;
+            this.field_175082_R = this.field_175082_R * (1.0F - var24) + this.field_175082_R * var17 * var24;
+            this.field_175081_S = this.field_175081_S * (1.0F - var24) + this.field_175081_S * var17 * var24;
+        }
+
+        if (this.mc.gameSettings.anaglyph)
+        {
+            var24 = (this.field_175080_Q * 30.0F + this.field_175082_R * 59.0F + this.field_175081_S * 11.0F) / 100.0F;
+            var17 = (this.field_175080_Q * 30.0F + this.field_175082_R * 70.0F) / 100.0F;
+            float var18 = (this.field_175080_Q * 30.0F + this.field_175081_S * 70.0F) / 100.0F;
+            this.field_175080_Q = var24;
+            this.field_175082_R = var17;
+            this.field_175081_S = var18;
+        }
+
+        GlStateManager.clearColor(this.field_175080_Q, this.field_175082_R, this.field_175081_S, 0.0F);
+    }
+
+    /**
+     * Sets up the fog to be rendered. If the arg passed in is -1 the fog starts at 0 and goes to 80% of far plane
+     * distance and is used for sky rendering.
+     */
+    private void setupFog(int p_78468_1_, float p_78468_2_)
+    {
+        Entity var3 = this.mc.func_175606_aa();
+        boolean var4 = false;
+
+        if (var3 instanceof EntityPlayer)
+        {
+            var4 = ((EntityPlayer)var3).capabilities.isCreativeMode;
+        }
+
+        GL11.glFog(GL11.GL_FOG_COLOR, this.setFogColorBuffer(this.field_175080_Q, this.field_175082_R, this.field_175081_S, 1.0F));
+        GL11.glNormal3f(0.0F, -1.0F, 0.0F);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        Block var5 = ActiveRenderInfo.func_180786_a(this.mc.theWorld, var3, p_78468_2_);
+        float var6;
+
+        //TODO: Client
+        if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.blindness) && !WurstClient.INSTANCE.modManager.getModByClass(AntiBlindMod.class).isEnabled())
+        {
+            var6 = 5.0F;
+            int var7 = ((EntityLivingBase)var3).getActivePotionEffect(Potion.blindness).getDuration();
+
+            if (var7 < 20)
+            {
+                var6 = 5.0F + (this.farPlaneDistance - 5.0F) * (1.0F - (float)var7 / 20.0F);
+            }
+
+            GlStateManager.setFog(9729);
+
+            if (p_78468_1_ == -1)
+            {
+                GlStateManager.setFogStart(0.0F);
+                GlStateManager.setFogEnd(var6 * 0.8F);
+            }
+            else
+            {
+                GlStateManager.setFogStart(var6 * 0.25F);
+                GlStateManager.setFogEnd(var6);
+            }
+
+            if (GLContext.getCapabilities().GL_NV_fog_distance)
+            {
+                GL11.glFogi(34138, 34139);
+            }
+        }
+        else if (this.cloudFog)
+        {
+            GlStateManager.setFog(2048);
+            GlStateManager.setFogDensity(0.1F);
+        }
+        else if (var5.getMaterial() == Material.water)
+        {
+            GlStateManager.setFog(2048);
+
+            if (var3 instanceof EntityLivingBase && ((EntityLivingBase)var3).isPotionActive(Potion.waterBreathing))
+            {
+                GlStateManager.setFogDensity(0.01F);
+            }
+            else
+            {
+                GlStateManager.setFogDensity(0.1F - (float)EnchantmentHelper.func_180319_a(var3) * 0.03F);
+            }
+        }
+        else if (var5.getMaterial() == Material.lava)
+        {
+            GlStateManager.setFog(2048);
+            GlStateManager.setFogDensity(2.0F);
+        }
+        else
+        {
+            var6 = this.farPlaneDistance;
+            GlStateManager.setFog(9729);
+
+            if (p_78468_1_ == -1)
+            {
+                GlStateManager.setFogStart(0.0F);
+                GlStateManager.setFogEnd(var6);
+            }
+            else
+            {
+                GlStateManager.setFogStart(var6 * 0.75F);
+                GlStateManager.setFogEnd(var6);
+            }
+
+            if (GLContext.getCapabilities().GL_NV_fog_distance)
+            {
+                GL11.glFogi(34138, 34139);
+            }
+
+            if (this.mc.theWorld.provider.doesXZShowFog((int)var3.posX, (int)var3.posZ))
+            {
+                GlStateManager.setFogStart(var6 * 0.05F);
+                GlStateManager.setFogEnd(Math.min(var6, 192.0F) * 0.5F);
+            }
+        }
+
+        GlStateManager.enableColorMaterial();
+        GlStateManager.enableFog();
+        GlStateManager.colorMaterial(1028, 4608);
+    }
+
+    /**
+     * Update and return fogColorBuffer with the RGBA values passed as arguments
+     */
+    private FloatBuffer setFogColorBuffer(float p_78469_1_, float p_78469_2_, float p_78469_3_, float p_78469_4_)
+    {
+        this.fogColorBuffer.clear();
+        this.fogColorBuffer.put(p_78469_1_).put(p_78469_2_).put(p_78469_3_).put(p_78469_4_);
+        this.fogColorBuffer.flip();
+        return this.fogColorBuffer;
+    }
+
+    public MapItemRenderer getMapItemRenderer()
+    {
+        return this.theMapItemRenderer;
+    }
+}
diff --git a/src/net/minecraft/client/renderer/InventoryEffectRenderer.java b/src/net/minecraft/client/renderer/InventoryEffectRenderer.java
index 0bf153c..5a50937 100644
--- a/src/net/minecraft/client/renderer/InventoryEffectRenderer.java
+++ b/src/net/minecraft/client/renderer/InventoryEffectRenderer.java
@@ -105,9 +105,9 @@ public abstract class InventoryEffectRenderer extends GuiContainer
                     var11 = var11 + " " + I18n.format("enchantment.level.4", new Object[0]);
                 }
 
-                this.fontRendererObj.func_175063_a(var11, (float)(var1 + 10 + 18), (float)(var2 + 6), 16777215);
+                this.fontRendererObj.drawStringWithShadow(var11, (float)(var1 + 10 + 18), (float)(var2 + 6), 16777215);
                 String var10 = Potion.getDurationString(var7);
-                this.fontRendererObj.func_175063_a(var10, (float)(var1 + 10 + 18), (float)(var2 + 6 + 10), 8355711);
+                this.fontRendererObj.drawStringWithShadow(var10, (float)(var1 + 10 + 18), (float)(var2 + 6 + 10), 8355711);
             }
         }
     }
diff --git a/src/net/minecraft/client/renderer/ItemRenderer.java b/src/net/minecraft/client/renderer/ItemRenderer.java
index 0f3580a..a695f1d 100644
--- a/src/net/minecraft/client/renderer/ItemRenderer.java
+++ b/src/net/minecraft/client/renderer/ItemRenderer.java
@@ -396,7 +396,7 @@ public class ItemRenderer
             }
         }
 
-        if (!this.mc.thePlayer.func_175149_v())
+        if (!this.mc.thePlayer.isSpectator())
         {
             if (this.mc.thePlayer.isInsideOfMaterial(Material.water))
             {
diff --git a/src/net/minecraft/client/renderer/RenderGlobal.java b/src/net/minecraft/client/renderer/RenderGlobal.java
index 0ccdbe4..c9576c8 100644
--- a/src/net/minecraft/client/renderer/RenderGlobal.java
+++ b/src/net/minecraft/client/renderer/RenderGlobal.java
@@ -4,6 +4,7 @@ import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
 import com.google.common.collect.Sets;
 import com.google.gson.JsonSyntaxException;
+
 import java.io.IOException;
 import java.util.EnumSet;
 import java.util.Iterator;
@@ -13,10 +14,12 @@ import java.util.Map;
 import java.util.Random;
 import java.util.Set;
 import java.util.concurrent.Callable;
+
 import javax.vecmath.Matrix4f;
 import javax.vecmath.Vector3d;
 import javax.vecmath.Vector3f;
 import javax.vecmath.Vector4f;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockChest;
 import net.minecraft.block.BlockEnderChest;
@@ -80,6 +83,7 @@ import net.minecraft.util.Vec3;
 import net.minecraft.world.IWorldAccess;
 import net.minecraft.world.border.WorldBorder;
 import net.minecraft.world.chunk.Chunk;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.lwjgl.opengl.GL11;
@@ -268,7 +272,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
     protected boolean func_174985_d()
     {
-        return this.field_175015_z != null && this.field_174991_A != null && this.mc.thePlayer != null && this.mc.thePlayer.func_175149_v() && this.mc.gameSettings.field_178883_an.getIsKeyPressed();
+        return this.field_175015_z != null && this.field_174991_A != null && this.mc.thePlayer != null && this.mc.thePlayer.isSpectator() && this.mc.gameSettings.field_178883_an.getIsKeyPressed();
     }
 
     private void func_174964_o()
@@ -1176,7 +1180,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
             }
 
             var2.startDrawingQuads();
-            var2.func_178991_c(2631720);
+            var2.setColorOpaque_I(2631720);
             var2.addVertexWithUV(-100.0D, -100.0D, -100.0D, 0.0D, 0.0D);
             var2.addVertexWithUV(-100.0D, -100.0D, 100.0D, 0.0D, 16.0D);
             var2.addVertexWithUV(100.0D, -100.0D, 100.0D, 16.0D, 16.0D);
@@ -1271,10 +1275,10 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
                 }
 
                 var24.startDrawing(6);
-                var24.func_178960_a(var10, var11, var12, var25[3]);
+                var24.setColorRGBA_F(var10, var11, var12, var25[3]);
                 var24.addVertex(0.0D, 100.0D, 0.0D);
                 boolean var27 = true;
-                var24.func_178960_a(var25[0], var25[1], var25[2], 0.0F);
+                var24.setColorRGBA_F(var25[0], var25[1], var25[2], 0.0F);
 
                 for (int var28 = 0; var28 <= 16; ++var28)
                 {
@@ -1378,7 +1382,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
                 var13 = -((float)(var26 + 65.0D));
                 var14 = -1.0F;
                 var24.startDrawingQuads();
-                var24.func_178974_a(0, 255);
+                var24.setColorRGBA_I(0, 255);
                 var24.addVertex(-1.0D, (double)var13, 1.0D);
                 var24.addVertex(1.0D, (double)var13, 1.0D);
                 var24.addVertex(1.0D, -1.0D, 1.0D);
@@ -1467,7 +1471,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
                 float var22 = (float)(var15 * 4.8828125E-4D);
                 float var23 = (float)(var17 * 4.8828125E-4D);
                 var7.startDrawingQuads();
-                var7.func_178960_a(var9, var10, var11, 0.8F);
+                var7.setColorRGBA_F(var9, var10, var11, 0.8F);
 
                 for (int var24 = -256; var24 < 256; var24 += 32)
                 {
@@ -1578,7 +1582,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
                     if (var14 > -5.0F)
                     {
-                        var5.func_178960_a(var18 * 0.7F, var19 * 0.7F, var20 * 0.7F, 0.8F);
+                        var5.setColorRGBA_F(var18 * 0.7F, var19 * 0.7F, var20 * 0.7F, 0.8F);
                         var5.func_178980_d(0.0F, -1.0F, 0.0F);
                         var5.addVertexWithUV((double)(var34 + 0.0F), (double)(var14 + 0.0F), (double)(var35 + 8.0F), (double)((var32 + 0.0F) * 0.00390625F + var22), (double)((var33 + 8.0F) * 0.00390625F + var23));
                         var5.addVertexWithUV((double)(var34 + 8.0F), (double)(var14 + 0.0F), (double)(var35 + 8.0F), (double)((var32 + 8.0F) * 0.00390625F + var22), (double)((var33 + 8.0F) * 0.00390625F + var23));
@@ -1588,7 +1592,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
                     if (var14 <= 5.0F)
                     {
-                        var5.func_178960_a(var18, var19, var20, 0.8F);
+                        var5.setColorRGBA_F(var18, var19, var20, 0.8F);
                         var5.func_178980_d(0.0F, 1.0F, 0.0F);
                         var5.addVertexWithUV((double)(var34 + 0.0F), (double)(var14 + 4.0F - 9.765625E-4F), (double)(var35 + 8.0F), (double)((var32 + 0.0F) * 0.00390625F + var22), (double)((var33 + 8.0F) * 0.00390625F + var23));
                         var5.addVertexWithUV((double)(var34 + 8.0F), (double)(var14 + 4.0F - 9.765625E-4F), (double)(var35 + 8.0F), (double)((var32 + 8.0F) * 0.00390625F + var22), (double)((var33 + 8.0F) * 0.00390625F + var23));
@@ -1596,7 +1600,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
                         var5.addVertexWithUV((double)(var34 + 0.0F), (double)(var14 + 4.0F - 9.765625E-4F), (double)(var35 + 0.0F), (double)((var32 + 0.0F) * 0.00390625F + var22), (double)((var33 + 0.0F) * 0.00390625F + var23));
                     }
 
-                    var5.func_178960_a(var18 * 0.9F, var19 * 0.9F, var20 * 0.9F, 0.8F);
+                    var5.setColorRGBA_F(var18 * 0.9F, var19 * 0.9F, var20 * 0.9F, 0.8F);
                     int var36;
 
                     if (var30 > -1)
@@ -1625,7 +1629,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
                         }
                     }
 
-                    var5.func_178960_a(var18 * 0.8F, var19 * 0.8F, var20 * 0.8F, 0.8F);
+                    var5.setColorRGBA_F(var18 * 0.8F, var19 * 0.8F, var20 * 0.8F, 0.8F);
 
                     if (var31 > -1)
                     {
@@ -1893,7 +1897,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
             GlStateManager.func_179090_x();
             GlStateManager.depthMask(false);
             float var5 = 0.002F;
-            BlockPos var6 = p_72731_2_.func_178782_a();
+            BlockPos var6 = p_72731_2_.getBlockPos();
             Block var7 = this.theWorld.getBlockState(var6).getBlock();
 
             if (var7.getMaterial() != Material.air && this.theWorld.getWorldBorder().contains(var6))
@@ -1922,7 +1926,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
         if (p_147590_1_ != -1)
         {
-            var3.func_178991_c(p_147590_1_);
+            var3.setColorOpaque_I(p_147590_1_);
         }
 
         var3.addVertex(p_147590_0_.minX, p_147590_0_.minY, p_147590_0_.minZ);
@@ -1935,7 +1939,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
         if (p_147590_1_ != -1)
         {
-            var3.func_178991_c(p_147590_1_);
+            var3.setColorOpaque_I(p_147590_1_);
         }
 
         var3.addVertex(p_147590_0_.minX, p_147590_0_.maxY, p_147590_0_.minZ);
@@ -1948,7 +1952,7 @@ public class RenderGlobal implements IWorldAccess, IResourceManagerReloadListene
 
         if (p_147590_1_ != -1)
         {
-            var3.func_178991_c(p_147590_1_);
+            var3.setColorOpaque_I(p_147590_1_);
         }
 
         var3.addVertex(p_147590_0_.minX, p_147590_0_.minY, p_147590_0_.minZ);
diff --git a/src/net/minecraft/client/renderer/Tessellator.java b/src/net/minecraft/client/renderer/Tessellator.java
index dff5dc4..80aa66a 100644
--- a/src/net/minecraft/client/renderer/Tessellator.java
+++ b/src/net/minecraft/client/renderer/Tessellator.java
@@ -7,6 +7,8 @@ public class Tessellator
 
     /** The static instance of the Tessellator. */
     private static final Tessellator instance = new Tessellator(2097152);
+    //TODO: Client
+	public static boolean shouldRenderLSD;
     private static final String __OBFID = "CL_00000960";
 
     public static Tessellator getInstance()
diff --git a/src/net/minecraft/client/renderer/ThreadDownloadImageData.java b/src/net/minecraft/client/renderer/ThreadDownloadImageData.java
index 72b9763..34a4e61 100644
--- a/src/net/minecraft/client/renderer/ThreadDownloadImageData.java
+++ b/src/net/minecraft/client/renderer/ThreadDownloadImageData.java
@@ -121,33 +121,33 @@ public class ThreadDownloadImageData extends SimpleTexture
                     var1.setDoOutput(false);
                     var1.connect();
 
-                    if (var1.getResponseCode() / 100 == 2)
+                    if (var1.getResponseCode() / 100 != 2)
                     {
-                        BufferedImage var2;
-
-                        if (ThreadDownloadImageData.this.field_152434_e != null)
-                        {
-                            FileUtils.copyInputStreamToFile(var1.getInputStream(), ThreadDownloadImageData.this.field_152434_e);
-                            var2 = ImageIO.read(ThreadDownloadImageData.this.field_152434_e);
-                        }
-                        else
-                        {
-                            var2 = TextureUtil.func_177053_a(var1.getInputStream());
-                        }
-
-                        if (ThreadDownloadImageData.this.imageBuffer != null)
-                        {
-                            var2 = ThreadDownloadImageData.this.imageBuffer.parseUserSkin(var2);
-                        }
-
-                        ThreadDownloadImageData.this.setBufferedImage(var2);
                         return;
                     }
+
+                    BufferedImage var2;
+
+                    if (ThreadDownloadImageData.this.field_152434_e != null)
+                    {
+                        FileUtils.copyInputStreamToFile(var1.getInputStream(), ThreadDownloadImageData.this.field_152434_e);
+                        var2 = ImageIO.read(ThreadDownloadImageData.this.field_152434_e);
+                    }
+                    else
+                    {
+                        var2 = TextureUtil.func_177053_a(var1.getInputStream());
+                    }
+
+                    if (ThreadDownloadImageData.this.imageBuffer != null)
+                    {
+                        var2 = ThreadDownloadImageData.this.imageBuffer.parseUserSkin(var2);
+                    }
+
+                    ThreadDownloadImageData.this.setBufferedImage(var2);
                 }
                 catch (Exception var6)
                 {
                     ThreadDownloadImageData.logger.error("Couldn\'t download http texture", var6);
-                    return;
                 }
                 finally
                 {
diff --git a/src/net/minecraft/client/renderer/WorldRenderer.java b/src/net/minecraft/client/renderer/WorldRenderer.java
index 736354e..cbcce03 100644
--- a/src/net/minecraft/client/renderer/WorldRenderer.java
+++ b/src/net/minecraft/client/renderer/WorldRenderer.java
@@ -1,615 +1,623 @@
-package net.minecraft.client.renderer;
-
-import java.nio.ByteBuffer;
-import java.nio.ByteOrder;
-import java.nio.FloatBuffer;
-import java.nio.IntBuffer;
-import java.util.Iterator;
-import java.util.List;
-import java.util.PriorityQueue;
-import net.minecraft.client.renderer.vertex.VertexFormat;
-import net.minecraft.client.renderer.vertex.VertexFormatElement;
-import net.minecraft.client.util.QuadComparator;
-import net.minecraft.util.MathHelper;
-import org.apache.logging.log4j.LogManager;
-
-public class WorldRenderer
-{
-    private ByteBuffer byteBuffer;
-    private IntBuffer rawIntBuffer;
-    private FloatBuffer rawFloatBuffer;
-    private int vertexCount;
-    private double field_178998_e;
-    private double field_178995_f;
-    private int field_178996_g;
-    private int field_179007_h;
-    private int rawBufferIndex;
-
-    /** Boolean for whether this renderer needs to be updated or not */
-    private boolean needsUpdate;
-    private int drawMode;
-    private double xOffset;
-    private double yOffset;
-    private double zOffset;
-    private int field_179003_o;
-    private int field_179012_p;
-    private VertexFormat vertexFormat;
-    private boolean isDrawing;
-    private int bufferSize;
-    private static final String __OBFID = "CL_00000942";
-
-    public WorldRenderer(int p_i46275_1_)
-    {
-        this.bufferSize = p_i46275_1_;
-        this.byteBuffer = GLAllocation.createDirectByteBuffer(p_i46275_1_ * 4);
-        this.rawIntBuffer = this.byteBuffer.asIntBuffer();
-        this.rawFloatBuffer = this.byteBuffer.asFloatBuffer();
-        this.vertexFormat = new VertexFormat();
-        this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.POSITION, 3));
-    }
-
-    private void growBuffer(int p_178983_1_)
-    {
-        LogManager.getLogger().warn("Needed to grow BufferBuilder buffer: Old size " + this.bufferSize * 4 + " bytes, new size " + (this.bufferSize * 4 + p_178983_1_) + " bytes.");
-        this.bufferSize += p_178983_1_ / 4;
-        ByteBuffer var2 = GLAllocation.createDirectByteBuffer(this.bufferSize * 4);
-        this.rawIntBuffer.position(0);
-        var2.asIntBuffer().put(this.rawIntBuffer);
-        this.byteBuffer = var2;
-        this.rawIntBuffer = this.byteBuffer.asIntBuffer();
-        this.rawFloatBuffer = this.byteBuffer.asFloatBuffer();
-    }
-
-    public WorldRenderer.State getVertexState(float p_178971_1_, float p_178971_2_, float p_178971_3_)
-    {
-        int[] var4 = new int[this.rawBufferIndex];
-        PriorityQueue var5 = new PriorityQueue(this.rawBufferIndex, new QuadComparator(this.rawFloatBuffer, (float)((double)p_178971_1_ + this.xOffset), (float)((double)p_178971_2_ + this.yOffset), (float)((double)p_178971_3_ + this.zOffset), this.vertexFormat.func_177338_f() / 4));
-        int var6 = this.vertexFormat.func_177338_f();
-        int var7;
-
-        for (var7 = 0; var7 < this.rawBufferIndex; var7 += var6)
-        {
-            var5.add(Integer.valueOf(var7));
-        }
-
-        for (var7 = 0; !var5.isEmpty(); var7 += var6)
-        {
-            int var8 = ((Integer)var5.remove()).intValue();
-
-            for (int var9 = 0; var9 < var6; ++var9)
-            {
-                var4[var7 + var9] = this.rawIntBuffer.get(var8 + var9);
-            }
-        }
-
-        this.rawIntBuffer.clear();
-        this.rawIntBuffer.put(var4);
-        return new WorldRenderer.State(var4, this.rawBufferIndex, this.vertexCount, new VertexFormat(this.vertexFormat));
-    }
-
-    public void setVertexState(WorldRenderer.State p_178993_1_)
-    {
-        this.rawIntBuffer.clear();
-        this.rawIntBuffer.put(p_178993_1_.func_179013_a());
-        this.rawBufferIndex = p_178993_1_.getRawBufferIndex();
-        this.vertexCount = p_178993_1_.getVertexCount();
-        this.vertexFormat = new VertexFormat(p_178993_1_.func_179016_d());
-    }
-
-    public void reset()
-    {
-        this.vertexCount = 0;
-        this.rawBufferIndex = 0;
-        this.vertexFormat.clear();
-        this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.POSITION, 3));
-    }
-
-    public void startDrawingQuads()
-    {
-        this.startDrawing(7);
-    }
-
-    public void startDrawing(int p_178964_1_)
-    {
-        if (this.isDrawing)
-        {
-            throw new IllegalStateException("Already building!");
-        }
-        else
-        {
-            this.isDrawing = true;
-            this.reset();
-            this.drawMode = p_178964_1_;
-            this.needsUpdate = false;
-        }
-    }
-
-    public void setTextureUV(double p_178992_1_, double p_178992_3_)
-    {
-        if (!this.vertexFormat.func_177347_a(0) && !this.vertexFormat.func_177347_a(1))
-        {
-            VertexFormatElement var5 = new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.UV, 2);
-            this.vertexFormat.func_177349_a(var5);
-        }
-
-        this.field_178998_e = p_178992_1_;
-        this.field_178995_f = p_178992_3_;
-    }
-
-    public void func_178963_b(int p_178963_1_)
-    {
-        if (!this.vertexFormat.func_177347_a(1))
-        {
-            if (!this.vertexFormat.func_177347_a(0))
-            {
-                this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.UV, 2));
-            }
-
-            VertexFormatElement var2 = new VertexFormatElement(1, VertexFormatElement.EnumType.SHORT, VertexFormatElement.EnumUseage.UV, 2);
-            this.vertexFormat.func_177349_a(var2);
-        }
-
-        this.field_178996_g = p_178963_1_;
-    }
-
-    public void func_178986_b(float p_178986_1_, float p_178986_2_, float p_178986_3_)
-    {
-        this.setPosition((int)(p_178986_1_ * 255.0F), (int)(p_178986_2_ * 255.0F), (int)(p_178986_3_ * 255.0F));
-    }
-
-    public void func_178960_a(float p_178960_1_, float p_178960_2_, float p_178960_3_, float p_178960_4_)
-    {
-        this.func_178961_b((int)(p_178960_1_ * 255.0F), (int)(p_178960_2_ * 255.0F), (int)(p_178960_3_ * 255.0F), (int)(p_178960_4_ * 255.0F));
-    }
-
-    /**
-     * Sets a new position for the renderer and setting it up so it can be reloaded with the new data for that position
-     */
-    public void setPosition(int p_78913_1_, int p_78913_2_, int p_78913_3_)
-    {
-        this.func_178961_b(p_78913_1_, p_78913_2_, p_78913_3_, 255);
-    }
-
-    public void func_178962_a(int p_178962_1_, int p_178962_2_, int p_178962_3_, int p_178962_4_)
-    {
-        int var5 = (this.vertexCount - 4) * (this.vertexFormat.func_177338_f() / 4) + this.vertexFormat.func_177344_b(1) / 4;
-        int var6 = this.vertexFormat.func_177338_f() >> 2;
-        this.rawIntBuffer.put(var5, p_178962_1_);
-        this.rawIntBuffer.put(var5 + var6, p_178962_2_);
-        this.rawIntBuffer.put(var5 + var6 * 2, p_178962_3_);
-        this.rawIntBuffer.put(var5 + var6 * 3, p_178962_4_);
-    }
-
-    public void func_178987_a(double p_178987_1_, double p_178987_3_, double p_178987_5_)
-    {
-        if (this.rawBufferIndex >= this.bufferSize - this.vertexFormat.func_177338_f())
-        {
-            this.growBuffer(2097152);
-        }
-
-        int var7 = this.vertexFormat.func_177338_f() / 4;
-        int var8 = (this.vertexCount - 4) * var7;
-
-        for (int var9 = 0; var9 < 4; ++var9)
-        {
-            int var10 = var8 + var9 * var7;
-            int var11 = var10 + 1;
-            int var12 = var11 + 1;
-            this.rawIntBuffer.put(var10, Float.floatToRawIntBits((float)(p_178987_1_ + this.xOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var10))));
-            this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)(p_178987_3_ + this.yOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var11))));
-            this.rawIntBuffer.put(var12, Float.floatToRawIntBits((float)(p_178987_5_ + this.zOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var12))));
-        }
-    }
-
-    /**
-     * Takes in the pass the call list is being requested for. Args: renderPass
-     */
-    private int getGLCallListForPass(int p_78909_1_)
-    {
-        return ((this.vertexCount - p_78909_1_) * this.vertexFormat.func_177338_f() + this.vertexFormat.func_177340_e()) / 4;
-    }
-
-    public void func_178978_a(float p_178978_1_, float p_178978_2_, float p_178978_3_, int p_178978_4_)
-    {
-        int var5 = this.getGLCallListForPass(p_178978_4_);
-        int var6 = this.rawIntBuffer.get(var5);
-        int var7;
-        int var8;
-        int var9;
-
-        if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
-        {
-            var7 = (int)((float)(var6 & 255) * p_178978_1_);
-            var8 = (int)((float)(var6 >> 8 & 255) * p_178978_2_);
-            var9 = (int)((float)(var6 >> 16 & 255) * p_178978_3_);
-            var6 &= -16777216;
-            var6 |= var9 << 16 | var8 << 8 | var7;
-        }
-        else
-        {
-            var7 = (int)((float)(this.field_179007_h >> 24 & 255) * p_178978_1_);
-            var8 = (int)((float)(this.field_179007_h >> 16 & 255) * p_178978_2_);
-            var9 = (int)((float)(this.field_179007_h >> 8 & 255) * p_178978_3_);
-            var6 &= 255;
-            var6 |= var7 << 24 | var8 << 16 | var9 << 8;
-        }
-
-        if (this.needsUpdate)
-        {
-            var6 = -1;
-        }
-
-        this.rawIntBuffer.put(var5, var6);
-    }
-
-    private void func_178988_b(int p_178988_1_, int p_178988_2_)
-    {
-        int var3 = this.getGLCallListForPass(p_178988_2_);
-        int var4 = p_178988_1_ >> 16 & 255;
-        int var5 = p_178988_1_ >> 8 & 255;
-        int var6 = p_178988_1_ & 255;
-        int var7 = p_178988_1_ >> 24 & 255;
-        this.func_178972_a(var3, var4, var5, var6, var7);
-    }
-
-    public void func_178994_b(float p_178994_1_, float p_178994_2_, float p_178994_3_, int p_178994_4_)
-    {
-        int var5 = this.getGLCallListForPass(p_178994_4_);
-        int var6 = MathHelper.clamp_int((int)(p_178994_1_ * 255.0F), 0, 255);
-        int var7 = MathHelper.clamp_int((int)(p_178994_2_ * 255.0F), 0, 255);
-        int var8 = MathHelper.clamp_int((int)(p_178994_3_ * 255.0F), 0, 255);
-        this.func_178972_a(var5, var6, var7, var8, 255);
-    }
-
-    private void func_178972_a(int p_178972_1_, int p_178972_2_, int p_178972_3_, int p_178972_4_, int p_178972_5_)
-    {
-        if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
-        {
-            this.rawIntBuffer.put(p_178972_1_, p_178972_5_ << 24 | p_178972_4_ << 16 | p_178972_3_ << 8 | p_178972_2_);
-        }
-        else
-        {
-            this.rawIntBuffer.put(p_178972_1_, p_178972_2_ << 24 | p_178972_3_ << 16 | p_178972_4_ << 8 | p_178972_5_);
-        }
-    }
-
-    public void func_178961_b(int p_178961_1_, int p_178961_2_, int p_178961_3_, int p_178961_4_)
-    {
-        if (!this.needsUpdate)
-        {
-            if (p_178961_1_ > 255)
-            {
-                p_178961_1_ = 255;
-            }
-
-            if (p_178961_2_ > 255)
-            {
-                p_178961_2_ = 255;
-            }
-
-            if (p_178961_3_ > 255)
-            {
-                p_178961_3_ = 255;
-            }
-
-            if (p_178961_4_ > 255)
-            {
-                p_178961_4_ = 255;
-            }
-
-            if (p_178961_1_ < 0)
-            {
-                p_178961_1_ = 0;
-            }
-
-            if (p_178961_2_ < 0)
-            {
-                p_178961_2_ = 0;
-            }
-
-            if (p_178961_3_ < 0)
-            {
-                p_178961_3_ = 0;
-            }
-
-            if (p_178961_4_ < 0)
-            {
-                p_178961_4_ = 0;
-            }
-
-            if (!this.vertexFormat.func_177346_d())
-            {
-                VertexFormatElement var5 = new VertexFormatElement(0, VertexFormatElement.EnumType.UBYTE, VertexFormatElement.EnumUseage.COLOR, 4);
-                this.vertexFormat.func_177349_a(var5);
-            }
-
-            if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
-            {
-                this.field_179007_h = p_178961_4_ << 24 | p_178961_3_ << 16 | p_178961_2_ << 8 | p_178961_1_;
-            }
-            else
-            {
-                this.field_179007_h = p_178961_1_ << 24 | p_178961_2_ << 16 | p_178961_3_ << 8 | p_178961_4_;
-            }
-        }
-    }
-
-    public void func_178982_a(byte p_178982_1_, byte p_178982_2_, byte p_178982_3_)
-    {
-        this.setPosition(p_178982_1_ & 255, p_178982_2_ & 255, p_178982_3_ & 255);
-    }
-
-    public void addVertexWithUV(double p_178985_1_, double p_178985_3_, double p_178985_5_, double p_178985_7_, double p_178985_9_)
-    {
-        this.setTextureUV(p_178985_7_, p_178985_9_);
-        this.addVertex(p_178985_1_, p_178985_3_, p_178985_5_);
-    }
-
-    public void setVertexFormat(VertexFormat p_178967_1_)
-    {
-        this.vertexFormat = new VertexFormat(p_178967_1_);
-    }
-
-    public void func_178981_a(int[] p_178981_1_)
-    {
-        int var2 = this.vertexFormat.func_177338_f() / 4;
-        this.vertexCount += p_178981_1_.length / var2;
-        this.rawIntBuffer.position(this.rawBufferIndex);
-        this.rawIntBuffer.put(p_178981_1_);
-        this.rawBufferIndex += p_178981_1_.length;
-    }
-
-    public void addVertex(double p_178984_1_, double p_178984_3_, double p_178984_5_)
-    {
-        if (this.rawBufferIndex >= this.bufferSize - this.vertexFormat.func_177338_f())
-        {
-            this.growBuffer(2097152);
-        }
-
-        List var7 = this.vertexFormat.func_177343_g();
-        Iterator var8 = var7.iterator();
-
-        while (var8.hasNext())
-        {
-            VertexFormatElement var9 = (VertexFormatElement)var8.next();
-            int var10 = var9.func_177373_a() >> 2;
-            int var11 = this.rawBufferIndex + var10;
-
-            switch (WorldRenderer.SwitchEnumUseage.field_178959_a[var9.func_177375_c().ordinal()])
-            {
-                case 1:
-                    this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)(p_178984_1_ + this.xOffset)));
-                    this.rawIntBuffer.put(var11 + 1, Float.floatToRawIntBits((float)(p_178984_3_ + this.yOffset)));
-                    this.rawIntBuffer.put(var11 + 2, Float.floatToRawIntBits((float)(p_178984_5_ + this.zOffset)));
-                    break;
-
-                case 2:
-                    this.rawIntBuffer.put(var11, this.field_179007_h);
-                    break;
-
-                case 3:
-                    if (var9.func_177369_e() == 0)
-                    {
-                        this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)this.field_178998_e));
-                        this.rawIntBuffer.put(var11 + 1, Float.floatToRawIntBits((float)this.field_178995_f));
-                    }
-                    else
-                    {
-                        this.rawIntBuffer.put(var11, this.field_178996_g);
-                    }
-
-                    break;
-
-                case 4:
-                    this.rawIntBuffer.put(var11, this.field_179003_o);
-            }
-        }
-
-        this.rawBufferIndex += this.vertexFormat.func_177338_f() >> 2;
-        ++this.vertexCount;
-    }
-
-    public void func_178991_c(int p_178991_1_)
-    {
-        int var2 = p_178991_1_ >> 16 & 255;
-        int var3 = p_178991_1_ >> 8 & 255;
-        int var4 = p_178991_1_ & 255;
-        this.setPosition(var2, var3, var4);
-    }
-
-    public void func_178974_a(int p_178974_1_, int p_178974_2_)
-    {
-        int var3 = p_178974_1_ >> 16 & 255;
-        int var4 = p_178974_1_ >> 8 & 255;
-        int var5 = p_178974_1_ & 255;
-        this.func_178961_b(var3, var4, var5, p_178974_2_);
-    }
-
-    /**
-     * Marks the current renderer data as dirty and needing to be updated.
-     */
-    public void markDirty()
-    {
-        this.needsUpdate = true;
-    }
-
-    public void func_178980_d(float p_178980_1_, float p_178980_2_, float p_178980_3_)
-    {
-        if (!this.vertexFormat.func_177350_b())
-        {
-            VertexFormatElement var4 = new VertexFormatElement(0, VertexFormatElement.EnumType.BYTE, VertexFormatElement.EnumUseage.NORMAL, 3);
-            this.vertexFormat.func_177349_a(var4);
-            this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.UBYTE, VertexFormatElement.EnumUseage.PADDING, 1));
-        }
-
-        byte var7 = (byte)((int)(p_178980_1_ * 127.0F));
-        byte var5 = (byte)((int)(p_178980_2_ * 127.0F));
-        byte var6 = (byte)((int)(p_178980_3_ * 127.0F));
-        this.field_179003_o = var7 & 255 | (var5 & 255) << 8 | (var6 & 255) << 16;
-    }
-
-    public void func_178975_e(float p_178975_1_, float p_178975_2_, float p_178975_3_)
-    {
-        byte var4 = (byte)((int)(p_178975_1_ * 127.0F));
-        byte var5 = (byte)((int)(p_178975_2_ * 127.0F));
-        byte var6 = (byte)((int)(p_178975_3_ * 127.0F));
-        int var7 = this.vertexFormat.func_177338_f() >> 2;
-        int var8 = (this.vertexCount - 4) * var7 + this.vertexFormat.func_177342_c() / 4;
-        this.field_179003_o = var4 & 255 | (var5 & 255) << 8 | (var6 & 255) << 16;
-        this.rawIntBuffer.put(var8, this.field_179003_o);
-        this.rawIntBuffer.put(var8 + var7, this.field_179003_o);
-        this.rawIntBuffer.put(var8 + var7 * 2, this.field_179003_o);
-        this.rawIntBuffer.put(var8 + var7 * 3, this.field_179003_o);
-    }
-
-    public void setTranslation(double p_178969_1_, double p_178969_3_, double p_178969_5_)
-    {
-        this.xOffset = p_178969_1_;
-        this.yOffset = p_178969_3_;
-        this.zOffset = p_178969_5_;
-    }
-
-    public int draw()
-    {
-        if (!this.isDrawing)
-        {
-            throw new IllegalStateException("Not building!");
-        }
-        else
-        {
-            this.isDrawing = false;
-
-            if (this.vertexCount > 0)
-            {
-                this.byteBuffer.position(0);
-                this.byteBuffer.limit(this.rawBufferIndex * 4);
-            }
-
-            this.field_179012_p = this.rawBufferIndex * 4;
-            return this.field_179012_p;
-        }
-    }
-
-    public int func_178976_e()
-    {
-        return this.field_179012_p;
-    }
-
-    public ByteBuffer func_178966_f()
-    {
-        return this.byteBuffer;
-    }
-
-    public VertexFormat func_178973_g()
-    {
-        return this.vertexFormat;
-    }
-
-    public int func_178989_h()
-    {
-        return this.vertexCount;
-    }
-
-    public int getDrawMode()
-    {
-        return this.drawMode;
-    }
-
-    public void func_178968_d(int p_178968_1_)
-    {
-        for (int var2 = 0; var2 < 4; ++var2)
-        {
-            this.func_178988_b(p_178968_1_, var2 + 1);
-        }
-    }
-
-    public void func_178990_f(float p_178990_1_, float p_178990_2_, float p_178990_3_)
-    {
-        for (int var4 = 0; var4 < 4; ++var4)
-        {
-            this.func_178994_b(p_178990_1_, p_178990_2_, p_178990_3_, var4 + 1);
-        }
-    }
-
-    public class State
-    {
-        private final int[] field_179019_b;
-        private final int field_179020_c;
-        private final int field_179017_d;
-        private final VertexFormat field_179018_e;
-        private static final String __OBFID = "CL_00002568";
-
-        public State(int[] p_i46274_2_, int p_i46274_3_, int p_i46274_4_, VertexFormat p_i46274_5_)
-        {
-            this.field_179019_b = p_i46274_2_;
-            this.field_179020_c = p_i46274_3_;
-            this.field_179017_d = p_i46274_4_;
-            this.field_179018_e = p_i46274_5_;
-        }
-
-        public int[] func_179013_a()
-        {
-            return this.field_179019_b;
-        }
-
-        public int getRawBufferIndex()
-        {
-            return this.field_179020_c;
-        }
-
-        public int getVertexCount()
-        {
-            return this.field_179017_d;
-        }
-
-        public VertexFormat func_179016_d()
-        {
-            return this.field_179018_e;
-        }
-    }
-
-    static final class SwitchEnumUseage
-    {
-        static final int[] field_178959_a = new int[VertexFormatElement.EnumUseage.values().length];
-        private static final String __OBFID = "CL_00002569";
-
-        static
-        {
-            try
-            {
-                field_178959_a[VertexFormatElement.EnumUseage.POSITION.ordinal()] = 1;
-            }
-            catch (NoSuchFieldError var4)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178959_a[VertexFormatElement.EnumUseage.COLOR.ordinal()] = 2;
-            }
-            catch (NoSuchFieldError var3)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178959_a[VertexFormatElement.EnumUseage.UV.ordinal()] = 3;
-            }
-            catch (NoSuchFieldError var2)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178959_a[VertexFormatElement.EnumUseage.NORMAL.ordinal()] = 4;
-            }
-            catch (NoSuchFieldError var1)
-            {
-                ;
-            }
-        }
-    }
-}
+package net.minecraft.client.renderer;
+
+import java.nio.ByteBuffer;
+import java.nio.ByteOrder;
+import java.nio.FloatBuffer;
+import java.nio.IntBuffer;
+import java.util.Iterator;
+import java.util.List;
+import java.util.PriorityQueue;
+
+import net.minecraft.client.renderer.vertex.VertexFormat;
+import net.minecraft.client.renderer.vertex.VertexFormatElement;
+import net.minecraft.client.util.QuadComparator;
+import net.minecraft.util.MathHelper;
+
+import org.apache.logging.log4j.LogManager;
+
+import tk.wurst_client.mods.LsdMod;
+
+public class WorldRenderer
+{
+    private ByteBuffer byteBuffer;
+    private IntBuffer rawIntBuffer;
+    private FloatBuffer rawFloatBuffer;
+    private int vertexCount;
+    private double field_178998_e;
+    private double field_178995_f;
+    private int field_178996_g;
+    private int field_179007_h;
+    private int rawBufferIndex;
+
+    /** Boolean for whether this renderer needs to be updated or not */
+    private boolean needsUpdate;
+    private int drawMode;
+    private double xOffset;
+    private double yOffset;
+    private double zOffset;
+    private int field_179003_o;
+    private int field_179012_p;
+    private VertexFormat vertexFormat;
+    private boolean isDrawing;
+    private int bufferSize;
+    private static final String __OBFID = "CL_00000942";
+
+    public WorldRenderer(int p_i46275_1_)
+    {
+        this.bufferSize = p_i46275_1_;
+        this.byteBuffer = GLAllocation.createDirectByteBuffer(p_i46275_1_ * 4);
+        this.rawIntBuffer = this.byteBuffer.asIntBuffer();
+        this.rawFloatBuffer = this.byteBuffer.asFloatBuffer();
+        this.vertexFormat = new VertexFormat();
+        this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.POSITION, 3));
+    }
+
+    private void growBuffer(int p_178983_1_)
+    {
+        LogManager.getLogger().warn("Needed to grow BufferBuilder buffer: Old size " + this.bufferSize * 4 + " bytes, new size " + (this.bufferSize * 4 + p_178983_1_) + " bytes.");
+        this.bufferSize += p_178983_1_ / 4;
+        ByteBuffer var2 = GLAllocation.createDirectByteBuffer(this.bufferSize * 4);
+        this.rawIntBuffer.position(0);
+        var2.asIntBuffer().put(this.rawIntBuffer);
+        this.byteBuffer = var2;
+        this.rawIntBuffer = this.byteBuffer.asIntBuffer();
+        this.rawFloatBuffer = this.byteBuffer.asFloatBuffer();
+    }
+
+    public WorldRenderer.State getVertexState(float p_178971_1_, float p_178971_2_, float p_178971_3_)
+    {
+        int[] var4 = new int[this.rawBufferIndex];
+        PriorityQueue var5 = new PriorityQueue(this.rawBufferIndex, new QuadComparator(this.rawFloatBuffer, (float)((double)p_178971_1_ + this.xOffset), (float)((double)p_178971_2_ + this.yOffset), (float)((double)p_178971_3_ + this.zOffset), this.vertexFormat.func_177338_f() / 4));
+        int var6 = this.vertexFormat.func_177338_f();
+        int var7;
+
+        for (var7 = 0; var7 < this.rawBufferIndex; var7 += var6)
+        {
+            var5.add(Integer.valueOf(var7));
+        }
+
+        for (var7 = 0; !var5.isEmpty(); var7 += var6)
+        {
+            int var8 = ((Integer)var5.remove()).intValue();
+
+            for (int var9 = 0; var9 < var6; ++var9)
+            {
+                var4[var7 + var9] = this.rawIntBuffer.get(var8 + var9);
+            }
+        }
+
+        this.rawIntBuffer.clear();
+        this.rawIntBuffer.put(var4);
+        return new WorldRenderer.State(var4, this.rawBufferIndex, this.vertexCount, new VertexFormat(this.vertexFormat));
+    }
+
+    public void setVertexState(WorldRenderer.State p_178993_1_)
+    {
+        this.rawIntBuffer.clear();
+        this.rawIntBuffer.put(p_178993_1_.func_179013_a());
+        this.rawBufferIndex = p_178993_1_.getRawBufferIndex();
+        this.vertexCount = p_178993_1_.getVertexCount();
+        this.vertexFormat = new VertexFormat(p_178993_1_.func_179016_d());
+    }
+
+    public void reset()
+    {
+        this.vertexCount = 0;
+        this.rawBufferIndex = 0;
+        this.vertexFormat.clear();
+        this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.POSITION, 3));
+    }
+
+    public void startDrawingQuads()
+    {
+        this.startDrawing(7);
+    }
+
+    public void startDrawing(int p_178964_1_)
+    {
+        if (this.isDrawing)
+        {
+            throw new IllegalStateException("Already building!");
+        }
+        else
+        {
+            this.isDrawing = true;
+            this.reset();
+            this.drawMode = p_178964_1_;
+            this.needsUpdate = false;
+        }
+    }
+
+    public void setTextureUV(double p_178992_1_, double p_178992_3_)
+    {
+        if (!this.vertexFormat.func_177347_a(0) && !this.vertexFormat.func_177347_a(1))
+        {
+            VertexFormatElement var5 = new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.UV, 2);
+            this.vertexFormat.func_177349_a(var5);
+        }
+
+        this.field_178998_e = p_178992_1_;
+        this.field_178995_f = p_178992_3_;
+    }
+
+    public void func_178963_b(int p_178963_1_)
+    {
+        if (!this.vertexFormat.func_177347_a(1))
+        {
+            if (!this.vertexFormat.func_177347_a(0))
+            {
+                this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.FLOAT, VertexFormatElement.EnumUseage.UV, 2));
+            }
+
+            VertexFormatElement var2 = new VertexFormatElement(1, VertexFormatElement.EnumType.SHORT, VertexFormatElement.EnumUseage.UV, 2);
+            this.vertexFormat.func_177349_a(var2);
+        }
+
+        this.field_178996_g = p_178963_1_;
+    }
+
+    public void setColorOpaque_F(float red, float blue, float green)
+    {
+        this.setColorOpaque((int)(red * 255.0F), (int)(blue * 255.0F), (int)(green * 255.0F));
+    }
+
+    public void setColorRGBA_F(float red, float blue, float green, float alpha)
+    {
+        this.setColorRGBA((int)(red * 255.0F), (int)(blue * 255.0F), (int)(green * 255.0F), (int)(alpha * 255.0F));
+    }
+    
+    public void setColorOpaque(int red, int blue, int green)
+    {
+        this.setColorRGBA(red, blue, green, 255);
+    }
+
+    public void func_178962_a(int p_178962_1_, int p_178962_2_, int p_178962_3_, int p_178962_4_)
+    {
+        int var5 = (this.vertexCount - 4) * (this.vertexFormat.func_177338_f() / 4) + this.vertexFormat.func_177344_b(1) / 4;
+        int var6 = this.vertexFormat.func_177338_f() >> 2;
+        this.rawIntBuffer.put(var5, p_178962_1_);
+        this.rawIntBuffer.put(var5 + var6, p_178962_2_);
+        this.rawIntBuffer.put(var5 + var6 * 2, p_178962_3_);
+        this.rawIntBuffer.put(var5 + var6 * 3, p_178962_4_);
+    }
+
+    public void func_178987_a(double p_178987_1_, double p_178987_3_, double p_178987_5_)
+    {
+        if (this.rawBufferIndex >= this.bufferSize - this.vertexFormat.func_177338_f())
+        {
+            this.growBuffer(2097152);
+        }
+
+        int var7 = this.vertexFormat.func_177338_f() / 4;
+        int var8 = (this.vertexCount - 4) * var7;
+
+        for (int var9 = 0; var9 < 4; ++var9)
+        {
+            int var10 = var8 + var9 * var7;
+            int var11 = var10 + 1;
+            int var12 = var11 + 1;
+            this.rawIntBuffer.put(var10, Float.floatToRawIntBits((float)(p_178987_1_ + this.xOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var10))));
+            this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)(p_178987_3_ + this.yOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var11))));
+            this.rawIntBuffer.put(var12, Float.floatToRawIntBits((float)(p_178987_5_ + this.zOffset) + Float.intBitsToFloat(this.rawIntBuffer.get(var12))));
+        }
+    }
+
+    /**
+     * Takes in the pass the call list is being requested for. Args: renderPass
+     */
+    private int getGLCallListForPass(int p_78909_1_)
+    {
+        return ((this.vertexCount - p_78909_1_) * this.vertexFormat.func_177338_f() + this.vertexFormat.func_177340_e()) / 4;
+    }
+
+    public void func_178978_a(float p_178978_1_, float p_178978_2_, float p_178978_3_, int p_178978_4_)
+    {
+        int var5 = this.getGLCallListForPass(p_178978_4_);
+        int var6 = this.rawIntBuffer.get(var5);
+        int var7;
+        int var8;
+        int var9;
+
+        if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
+        {
+            var7 = (int)((float)(var6 & 255) * p_178978_1_);
+            var8 = (int)((float)(var6 >> 8 & 255) * p_178978_2_);
+            var9 = (int)((float)(var6 >> 16 & 255) * p_178978_3_);
+            var6 &= -16777216;
+            var6 |= var9 << 16 | var8 << 8 | var7;
+        }
+        else
+        {
+            var7 = (int)((float)(this.field_179007_h >> 24 & 255) * p_178978_1_);
+            var8 = (int)((float)(this.field_179007_h >> 16 & 255) * p_178978_2_);
+            var9 = (int)((float)(this.field_179007_h >> 8 & 255) * p_178978_3_);
+            var6 &= 255;
+            var6 |= var7 << 24 | var8 << 16 | var9 << 8;
+        }
+
+        if (this.needsUpdate)
+        {
+            var6 = -1;
+        }
+
+        this.rawIntBuffer.put(var5, var6);
+    }
+
+    private void func_178988_b(int p_178988_1_, int p_178988_2_)
+    {
+        int var3 = this.getGLCallListForPass(p_178988_2_);
+        int var4 = p_178988_1_ >> 16 & 255;
+        int var5 = p_178988_1_ >> 8 & 255;
+        int var6 = p_178988_1_ & 255;
+        int var7 = p_178988_1_ >> 24 & 255;
+        this.func_178972_a(var3, var4, var5, var6, var7);
+    }
+
+    public void func_178994_b(float p_178994_1_, float p_178994_2_, float p_178994_3_, int p_178994_4_)
+    {
+        int var5 = this.getGLCallListForPass(p_178994_4_);
+        int var6 = MathHelper.clamp_int((int)(p_178994_1_ * 255.0F), 0, 255);
+        int var7 = MathHelper.clamp_int((int)(p_178994_2_ * 255.0F), 0, 255);
+        int var8 = MathHelper.clamp_int((int)(p_178994_3_ * 255.0F), 0, 255);
+        this.func_178972_a(var5, var6, var7, var8, 255);
+    }
+
+    private void func_178972_a(int p_178972_1_, int p_178972_2_, int p_178972_3_, int p_178972_4_, int p_178972_5_)
+    {
+        if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
+        {
+            this.rawIntBuffer.put(p_178972_1_, p_178972_5_ << 24 | p_178972_4_ << 16 | p_178972_3_ << 8 | p_178972_2_);
+        }
+        else
+        {
+            this.rawIntBuffer.put(p_178972_1_, p_178972_2_ << 24 | p_178972_3_ << 16 | p_178972_4_ << 8 | p_178972_5_);
+        }
+    }
+
+    public void setColorRGBA(int red, int blue, int green, int alpha)
+    {
+        if (!this.needsUpdate)
+        {
+            if (red > 255)
+            {
+                red = 255;
+            }
+
+            if (blue > 255)
+            {
+                blue = 255;
+            }
+
+            if (green > 255)
+            {
+                green = 255;
+            }
+
+            if (alpha > 255)
+            {
+                alpha = 255;
+            }
+
+            if (red < 0)
+            {
+                red = 0;
+            }
+
+            if (blue < 0)
+            {
+                blue = 0;
+            }
+
+            if (green < 0)
+            {
+                green = 0;
+            }
+
+            if (alpha < 0)
+            {
+                alpha = 0;
+            }
+            //TODO: Client
+            if(Tessellator.shouldRenderLSD)
+            {
+            	red = LsdMod.randomColor().getRed();
+            	blue = LsdMod.randomColor().getBlue();
+            	green = LsdMod.randomColor().getGreen();
+            }
+
+            if (!this.vertexFormat.func_177346_d())
+            {
+                VertexFormatElement var5 = new VertexFormatElement(0, VertexFormatElement.EnumType.UBYTE, VertexFormatElement.EnumUseage.COLOR, 4);
+                this.vertexFormat.func_177349_a(var5);
+            }
+
+            if (ByteOrder.nativeOrder() == ByteOrder.LITTLE_ENDIAN)
+            {
+                this.field_179007_h = alpha << 24 | green << 16 | blue << 8 | red;
+            }
+            else
+            {
+                this.field_179007_h = red << 24 | blue << 16 | green << 8 | alpha;
+            }
+        }
+    }
+
+    public void setColorOpaque_B(byte red, byte blue, byte green)
+    {
+        this.setColorOpaque(red & 255, blue & 255, green & 255);
+    }
+
+    public void addVertexWithUV(double p_178985_1_, double p_178985_3_, double p_178985_5_, double p_178985_7_, double p_178985_9_)
+    {
+        this.setTextureUV(p_178985_7_, p_178985_9_);
+        this.addVertex(p_178985_1_, p_178985_3_, p_178985_5_);
+    }
+
+    public void setVertexFormat(VertexFormat p_178967_1_)
+    {
+        this.vertexFormat = new VertexFormat(p_178967_1_);
+    }
+
+    public void func_178981_a(int[] p_178981_1_)
+    {
+        int var2 = this.vertexFormat.func_177338_f() / 4;
+        this.vertexCount += p_178981_1_.length / var2;
+        this.rawIntBuffer.position(this.rawBufferIndex);
+        this.rawIntBuffer.put(p_178981_1_);
+        this.rawBufferIndex += p_178981_1_.length;
+    }
+
+    public void addVertex(double p_178984_1_, double p_178984_3_, double p_178984_5_)
+    {
+        if (this.rawBufferIndex >= this.bufferSize - this.vertexFormat.func_177338_f())
+        {
+            this.growBuffer(2097152);
+        }
+
+        List var7 = this.vertexFormat.func_177343_g();
+        Iterator var8 = var7.iterator();
+
+        while (var8.hasNext())
+        {
+            VertexFormatElement var9 = (VertexFormatElement)var8.next();
+            int var10 = var9.func_177373_a() >> 2;
+            int var11 = this.rawBufferIndex + var10;
+
+            switch (WorldRenderer.SwitchEnumUseage.field_178959_a[var9.func_177375_c().ordinal()])
+            {
+                case 1:
+                    this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)(p_178984_1_ + this.xOffset)));
+                    this.rawIntBuffer.put(var11 + 1, Float.floatToRawIntBits((float)(p_178984_3_ + this.yOffset)));
+                    this.rawIntBuffer.put(var11 + 2, Float.floatToRawIntBits((float)(p_178984_5_ + this.zOffset)));
+                    break;
+
+                case 2:
+                    this.rawIntBuffer.put(var11, this.field_179007_h);
+                    break;
+
+                case 3:
+                    if (var9.func_177369_e() == 0)
+                    {
+                        this.rawIntBuffer.put(var11, Float.floatToRawIntBits((float)this.field_178998_e));
+                        this.rawIntBuffer.put(var11 + 1, Float.floatToRawIntBits((float)this.field_178995_f));
+                    }
+                    else
+                    {
+                        this.rawIntBuffer.put(var11, this.field_178996_g);
+                    }
+
+                    break;
+
+                case 4:
+                    this.rawIntBuffer.put(var11, this.field_179003_o);
+            }
+        }
+
+        this.rawBufferIndex += this.vertexFormat.func_177338_f() >> 2;
+        ++this.vertexCount;
+    }
+
+    public void setColorOpaque_I(int rgb)
+    {
+        int red = rgb >> 16 & 255;
+        int blue = rgb >> 8 & 255;
+        int green = rgb & 255;
+        this.setColorOpaque(red, blue, green);
+    }
+
+    public void setColorRGBA_I(int rgb, int alpha)
+    {
+        int red = rgb >> 16 & 255;
+        int blue = rgb >> 8 & 255;
+        int green = rgb & 255;
+        this.setColorRGBA(red, blue, green, alpha);
+    }
+
+    /**
+     * Marks the current renderer data as dirty and needing to be updated.
+     */
+    public void markDirty()
+    {
+        this.needsUpdate = true;
+    }
+
+    public void func_178980_d(float p_178980_1_, float p_178980_2_, float p_178980_3_)
+    {
+        if (!this.vertexFormat.func_177350_b())
+        {
+            VertexFormatElement var4 = new VertexFormatElement(0, VertexFormatElement.EnumType.BYTE, VertexFormatElement.EnumUseage.NORMAL, 3);
+            this.vertexFormat.func_177349_a(var4);
+            this.vertexFormat.func_177349_a(new VertexFormatElement(0, VertexFormatElement.EnumType.UBYTE, VertexFormatElement.EnumUseage.PADDING, 1));
+        }
+
+        byte var7 = (byte)((int)(p_178980_1_ * 127.0F));
+        byte var5 = (byte)((int)(p_178980_2_ * 127.0F));
+        byte var6 = (byte)((int)(p_178980_3_ * 127.0F));
+        this.field_179003_o = var7 & 255 | (var5 & 255) << 8 | (var6 & 255) << 16;
+    }
+
+    public void func_178975_e(float p_178975_1_, float p_178975_2_, float p_178975_3_)
+    {
+        byte var4 = (byte)((int)(p_178975_1_ * 127.0F));
+        byte var5 = (byte)((int)(p_178975_2_ * 127.0F));
+        byte var6 = (byte)((int)(p_178975_3_ * 127.0F));
+        int var7 = this.vertexFormat.func_177338_f() >> 2;
+        int var8 = (this.vertexCount - 4) * var7 + this.vertexFormat.func_177342_c() / 4;
+        this.field_179003_o = var4 & 255 | (var5 & 255) << 8 | (var6 & 255) << 16;
+        this.rawIntBuffer.put(var8, this.field_179003_o);
+        this.rawIntBuffer.put(var8 + var7, this.field_179003_o);
+        this.rawIntBuffer.put(var8 + var7 * 2, this.field_179003_o);
+        this.rawIntBuffer.put(var8 + var7 * 3, this.field_179003_o);
+    }
+
+    public void setTranslation(double p_178969_1_, double p_178969_3_, double p_178969_5_)
+    {
+        this.xOffset = p_178969_1_;
+        this.yOffset = p_178969_3_;
+        this.zOffset = p_178969_5_;
+    }
+
+    public int draw()
+    {
+        if (!this.isDrawing)
+        {
+            throw new IllegalStateException("Not building!");
+        }
+        else
+        {
+            this.isDrawing = false;
+
+            if (this.vertexCount > 0)
+            {
+                this.byteBuffer.position(0);
+                this.byteBuffer.limit(this.rawBufferIndex * 4);
+            }
+
+            this.field_179012_p = this.rawBufferIndex * 4;
+            return this.field_179012_p;
+        }
+    }
+
+    public int func_178976_e()
+    {
+        return this.field_179012_p;
+    }
+
+    public ByteBuffer func_178966_f()
+    {
+        return this.byteBuffer;
+    }
+
+    public VertexFormat func_178973_g()
+    {
+        return this.vertexFormat;
+    }
+
+    public int func_178989_h()
+    {
+        return this.vertexCount;
+    }
+
+    public int getDrawMode()
+    {
+        return this.drawMode;
+    }
+
+    public void func_178968_d(int p_178968_1_)
+    {
+        for (int var2 = 0; var2 < 4; ++var2)
+        {
+            this.func_178988_b(p_178968_1_, var2 + 1);
+        }
+    }
+
+    public void func_178990_f(float p_178990_1_, float p_178990_2_, float p_178990_3_)
+    {
+        for (int var4 = 0; var4 < 4; ++var4)
+        {
+            this.func_178994_b(p_178990_1_, p_178990_2_, p_178990_3_, var4 + 1);
+        }
+    }
+
+    public class State
+    {
+        private final int[] field_179019_b;
+        private final int field_179020_c;
+        private final int field_179017_d;
+        private final VertexFormat field_179018_e;
+        private static final String __OBFID = "CL_00002568";
+
+        public State(int[] p_i46274_2_, int p_i46274_3_, int p_i46274_4_, VertexFormat p_i46274_5_)
+        {
+            this.field_179019_b = p_i46274_2_;
+            this.field_179020_c = p_i46274_3_;
+            this.field_179017_d = p_i46274_4_;
+            this.field_179018_e = p_i46274_5_;
+        }
+
+        public int[] func_179013_a()
+        {
+            return this.field_179019_b;
+        }
+
+        public int getRawBufferIndex()
+        {
+            return this.field_179020_c;
+        }
+
+        public int getVertexCount()
+        {
+            return this.field_179017_d;
+        }
+
+        public VertexFormat func_179016_d()
+        {
+            return this.field_179018_e;
+        }
+    }
+
+    static final class SwitchEnumUseage
+    {
+        static final int[] field_178959_a = new int[VertexFormatElement.EnumUseage.values().length];
+        private static final String __OBFID = "CL_00002569";
+
+        static
+        {
+            try
+            {
+                field_178959_a[VertexFormatElement.EnumUseage.POSITION.ordinal()] = 1;
+            }
+            catch (NoSuchFieldError var4)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178959_a[VertexFormatElement.EnumUseage.COLOR.ordinal()] = 2;
+            }
+            catch (NoSuchFieldError var3)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178959_a[VertexFormatElement.EnumUseage.UV.ordinal()] = 3;
+            }
+            catch (NoSuchFieldError var2)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178959_a[VertexFormatElement.EnumUseage.NORMAL.ordinal()] = 4;
+            }
+            catch (NoSuchFieldError var1)
+            {
+                ;
+            }
+        }
+    }
+}
diff --git a/src/net/minecraft/client/renderer/chunk/ChunkRenderWorker.java b/src/net/minecraft/client/renderer/chunk/ChunkRenderWorker.java
index c1aa703..f240c63 100644
--- a/src/net/minecraft/client/renderer/chunk/ChunkRenderWorker.java
+++ b/src/net/minecraft/client/renderer/chunk/ChunkRenderWorker.java
@@ -4,14 +4,17 @@ import com.google.common.collect.Lists;
 import com.google.common.util.concurrent.FutureCallback;
 import com.google.common.util.concurrent.Futures;
 import com.google.common.util.concurrent.ListenableFuture;
+
 import java.util.ArrayList;
 import java.util.List;
 import java.util.concurrent.CancellationException;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.renderer.RegionRenderCacheBuilder;
 import net.minecraft.crash.CrashReport;
 import net.minecraft.entity.Entity;
 import net.minecraft.util.EnumWorldBlockLayer;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/renderer/entity/Render.java b/src/net/minecraft/client/renderer/entity/Render.java
index a00ffea..1570620 100644
--- a/src/net/minecraft/client/renderer/entity/Render.java
+++ b/src/net/minecraft/client/renderer/entity/Render.java
@@ -1,392 +1,418 @@
-package net.minecraft.client.renderer.entity;
-
-import java.util.Iterator;
-import net.minecraft.block.Block;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.gui.FontRenderer;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.culling.ICamera;
-import net.minecraft.client.renderer.texture.TextureAtlasSprite;
-import net.minecraft.client.renderer.texture.TextureMap;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLiving;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.world.World;
-import org.lwjgl.opengl.GL11;
-
-public abstract class Render
-{
-    private static final ResourceLocation shadowTextures = new ResourceLocation("textures/misc/shadow.png");
-    protected final RenderManager renderManager;
-    protected float shadowSize;
-
-    /**
-     * Determines the darkness of the object's shadow. Higher value makes a darker shadow.
-     */
-    protected float shadowOpaque = 1.0F;
-    private static final String __OBFID = "CL_00000992";
-
-    protected Render(RenderManager p_i46179_1_)
-    {
-        this.renderManager = p_i46179_1_;
-    }
-
-    public boolean func_177071_a(Entity p_177071_1_, ICamera p_177071_2_, double p_177071_3_, double p_177071_5_, double p_177071_7_)
-    {
-        return p_177071_1_.isInRangeToRender3d(p_177071_3_, p_177071_5_, p_177071_7_) && (p_177071_1_.ignoreFrustumCheck || p_177071_2_.isBoundingBoxInFrustum(p_177071_1_.getEntityBoundingBox()));
-    }
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        this.func_177067_a(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_);
-    }
-
-    protected void func_177067_a(Entity p_177067_1_, double p_177067_2_, double p_177067_4_, double p_177067_6_)
-    {
-        if (this.func_177070_b(p_177067_1_))
-        {
-            this.renderLivingLabel(p_177067_1_, p_177067_1_.getDisplayName().getFormattedText(), p_177067_2_, p_177067_4_, p_177067_6_, 64);
-        }
-    }
-
-    protected boolean func_177070_b(Entity p_177070_1_)
-    {
-        return p_177070_1_.getAlwaysRenderNameTagForRender() && p_177070_1_.hasCustomName();
-    }
-
-    protected void func_177069_a(Entity p_177069_1_, double p_177069_2_, double p_177069_4_, double p_177069_6_, String p_177069_8_, float p_177069_9_, double p_177069_10_)
-    {
-        this.renderLivingLabel(p_177069_1_, p_177069_8_, p_177069_2_, p_177069_4_, p_177069_6_, 64);
-    }
-
-    /**
-     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
-     */
-    protected abstract ResourceLocation getEntityTexture(Entity p_110775_1_);
-
-    protected boolean bindEntityTexture(Entity p_180548_1_)
-    {
-        ResourceLocation var2 = this.getEntityTexture(p_180548_1_);
-
-        if (var2 == null)
-        {
-            return false;
-        }
-        else
-        {
-            this.bindTexture(var2);
-            return true;
-        }
-    }
-
-    public void bindTexture(ResourceLocation p_110776_1_)
-    {
-        this.renderManager.renderEngine.bindTexture(p_110776_1_);
-    }
-
-    /**
-     * Renders fire on top of the entity. Args: entity, x, y, z, partialTickTime
-     */
-    private void renderEntityOnFire(Entity p_76977_1_, double p_76977_2_, double p_76977_4_, double p_76977_6_, float p_76977_8_)
-    {
-        GlStateManager.disableLighting();
-        TextureMap var9 = Minecraft.getMinecraft().getTextureMapBlocks();
-        TextureAtlasSprite var10 = var9.getAtlasSprite("minecraft:blocks/fire_layer_0");
-        TextureAtlasSprite var11 = var9.getAtlasSprite("minecraft:blocks/fire_layer_1");
-        GlStateManager.pushMatrix();
-        GlStateManager.translate((float)p_76977_2_, (float)p_76977_4_, (float)p_76977_6_);
-        float var12 = p_76977_1_.width * 1.4F;
-        GlStateManager.scale(var12, var12, var12);
-        Tessellator var13 = Tessellator.getInstance();
-        WorldRenderer var14 = var13.getWorldRenderer();
-        float var15 = 0.5F;
-        float var16 = 0.0F;
-        float var17 = p_76977_1_.height / var12;
-        float var18 = (float)(p_76977_1_.posY - p_76977_1_.getEntityBoundingBox().minY);
-        GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
-        GlStateManager.translate(0.0F, 0.0F, -0.3F + (float)((int)var17) * 0.02F);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        float var19 = 0.0F;
-        int var20 = 0;
-        var14.startDrawingQuads();
-
-        while (var17 > 0.0F)
-        {
-            TextureAtlasSprite var21 = var20 % 2 == 0 ? var10 : var11;
-            this.bindTexture(TextureMap.locationBlocksTexture);
-            float var22 = var21.getMinU();
-            float var23 = var21.getMinV();
-            float var24 = var21.getMaxU();
-            float var25 = var21.getMaxV();
-
-            if (var20 / 2 % 2 == 0)
-            {
-                float var26 = var24;
-                var24 = var22;
-                var22 = var26;
-            }
-
-            var14.addVertexWithUV((double)(var15 - var16), (double)(0.0F - var18), (double)var19, (double)var24, (double)var25);
-            var14.addVertexWithUV((double)(-var15 - var16), (double)(0.0F - var18), (double)var19, (double)var22, (double)var25);
-            var14.addVertexWithUV((double)(-var15 - var16), (double)(1.4F - var18), (double)var19, (double)var22, (double)var23);
-            var14.addVertexWithUV((double)(var15 - var16), (double)(1.4F - var18), (double)var19, (double)var24, (double)var23);
-            var17 -= 0.45F;
-            var18 -= 0.45F;
-            var15 *= 0.9F;
-            var19 += 0.03F;
-            ++var20;
-        }
-
-        var13.draw();
-        GlStateManager.popMatrix();
-        GlStateManager.enableLighting();
-    }
-
-    /**
-     * Renders the entity shadows at the position, shadow alpha and partialTickTime. Args: entity, x, y, z, shadowAlpha,
-     * partialTickTime
-     */
-    private void renderShadow(Entity p_76975_1_, double p_76975_2_, double p_76975_4_, double p_76975_6_, float p_76975_8_, float p_76975_9_)
-    {
-        GlStateManager.enableBlend();
-        GlStateManager.blendFunc(770, 771);
-        this.renderManager.renderEngine.bindTexture(shadowTextures);
-        World var10 = this.getWorldFromRenderManager();
-        GlStateManager.depthMask(false);
-        float var11 = this.shadowSize;
-
-        if (p_76975_1_ instanceof EntityLiving)
-        {
-            EntityLiving var12 = (EntityLiving)p_76975_1_;
-            var11 *= var12.getRenderSizeModifier();
-
-            if (var12.isChild())
-            {
-                var11 *= 0.5F;
-            }
-        }
-
-        double var35 = p_76975_1_.lastTickPosX + (p_76975_1_.posX - p_76975_1_.lastTickPosX) * (double)p_76975_9_;
-        double var14 = p_76975_1_.lastTickPosY + (p_76975_1_.posY - p_76975_1_.lastTickPosY) * (double)p_76975_9_;
-        double var16 = p_76975_1_.lastTickPosZ + (p_76975_1_.posZ - p_76975_1_.lastTickPosZ) * (double)p_76975_9_;
-        int var18 = MathHelper.floor_double(var35 - (double)var11);
-        int var19 = MathHelper.floor_double(var35 + (double)var11);
-        int var20 = MathHelper.floor_double(var14 - (double)var11);
-        int var21 = MathHelper.floor_double(var14);
-        int var22 = MathHelper.floor_double(var16 - (double)var11);
-        int var23 = MathHelper.floor_double(var16 + (double)var11);
-        double var24 = p_76975_2_ - var35;
-        double var26 = p_76975_4_ - var14;
-        double var28 = p_76975_6_ - var16;
-        Tessellator var30 = Tessellator.getInstance();
-        WorldRenderer var31 = var30.getWorldRenderer();
-        var31.startDrawingQuads();
-        Iterator var32 = BlockPos.getAllInBox(new BlockPos(var18, var20, var22), new BlockPos(var19, var21, var23)).iterator();
-
-        while (var32.hasNext())
-        {
-            BlockPos var33 = (BlockPos)var32.next();
-            Block var34 = var10.getBlockState(var33.offsetDown()).getBlock();
-
-            if (var34.getRenderType() != -1 && var10.getLightFromNeighbors(var33) > 3)
-            {
-                this.func_180549_a(var34, p_76975_2_, p_76975_4_, p_76975_6_, var33, p_76975_8_, var11, var24, var26, var28);
-            }
-        }
-
-        var30.draw();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.disableBlend();
-        GlStateManager.depthMask(true);
-    }
-
-    /**
-     * Returns the render manager's world object
-     */
-    private World getWorldFromRenderManager()
-    {
-        return this.renderManager.worldObj;
-    }
-
-    private void func_180549_a(Block p_180549_1_, double p_180549_2_, double p_180549_4_, double p_180549_6_, BlockPos p_180549_8_, float p_180549_9_, float p_180549_10_, double p_180549_11_, double p_180549_13_, double p_180549_15_)
-    {
-        if (p_180549_1_.isFullCube())
-        {
-            Tessellator var17 = Tessellator.getInstance();
-            WorldRenderer var18 = var17.getWorldRenderer();
-            double var19 = ((double)p_180549_9_ - (p_180549_4_ - ((double)p_180549_8_.getY() + p_180549_13_)) / 2.0D) * 0.5D * (double)this.getWorldFromRenderManager().getLightBrightness(p_180549_8_);
-
-            if (var19 >= 0.0D)
-            {
-                if (var19 > 1.0D)
-                {
-                    var19 = 1.0D;
-                }
-
-                var18.func_178960_a(1.0F, 1.0F, 1.0F, (float)var19);
-                double var21 = (double)p_180549_8_.getX() + p_180549_1_.getBlockBoundsMinX() + p_180549_11_;
-                double var23 = (double)p_180549_8_.getX() + p_180549_1_.getBlockBoundsMaxX() + p_180549_11_;
-                double var25 = (double)p_180549_8_.getY() + p_180549_1_.getBlockBoundsMinY() + p_180549_13_ + 0.015625D;
-                double var27 = (double)p_180549_8_.getZ() + p_180549_1_.getBlockBoundsMinZ() + p_180549_15_;
-                double var29 = (double)p_180549_8_.getZ() + p_180549_1_.getBlockBoundsMaxZ() + p_180549_15_;
-                float var31 = (float)((p_180549_2_ - var21) / 2.0D / (double)p_180549_10_ + 0.5D);
-                float var32 = (float)((p_180549_2_ - var23) / 2.0D / (double)p_180549_10_ + 0.5D);
-                float var33 = (float)((p_180549_6_ - var27) / 2.0D / (double)p_180549_10_ + 0.5D);
-                float var34 = (float)((p_180549_6_ - var29) / 2.0D / (double)p_180549_10_ + 0.5D);
-                var18.addVertexWithUV(var21, var25, var27, (double)var31, (double)var33);
-                var18.addVertexWithUV(var21, var25, var29, (double)var31, (double)var34);
-                var18.addVertexWithUV(var23, var25, var29, (double)var32, (double)var34);
-                var18.addVertexWithUV(var23, var25, var27, (double)var32, (double)var33);
-            }
-        }
-    }
-
-    /**
-     * Renders a white box with the bounds of the AABB translated by the offset. Args: aabb, x, y, z
-     */
-    public static void renderOffsetAABB(AxisAlignedBB p_76978_0_, double p_76978_1_, double p_76978_3_, double p_76978_5_)
-    {
-        GlStateManager.func_179090_x();
-        Tessellator var7 = Tessellator.getInstance();
-        WorldRenderer var8 = var7.getWorldRenderer();
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        var8.startDrawingQuads();
-        var8.setTranslation(p_76978_1_, p_76978_3_, p_76978_5_);
-        var8.func_178980_d(0.0F, 0.0F, -1.0F);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.func_178980_d(0.0F, 0.0F, 1.0F);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.func_178980_d(0.0F, -1.0F, 0.0F);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.func_178980_d(0.0F, 1.0F, 0.0F);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.func_178980_d(-1.0F, 0.0F, 0.0F);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.func_178980_d(1.0F, 0.0F, 0.0F);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
-        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
-        var8.setTranslation(0.0D, 0.0D, 0.0D);
-        var7.draw();
-        GlStateManager.func_179098_w();
-    }
-
-    /**
-     * Renders the entity's shadow and fire (if its on fire). Args: entity, x, y, z, yaw, partialTickTime
-     */
-    public void doRenderShadowAndFire(Entity p_76979_1_, double p_76979_2_, double p_76979_4_, double p_76979_6_, float p_76979_8_, float p_76979_9_)
-    {
-        if (this.renderManager.options != null)
-        {
-            if (this.renderManager.options.fancyGraphics && this.shadowSize > 0.0F && !p_76979_1_.isInvisible() && this.renderManager.func_178627_a())
-            {
-                double var10 = this.renderManager.getDistanceToCamera(p_76979_1_.posX, p_76979_1_.posY, p_76979_1_.posZ);
-                float var12 = (float)((1.0D - var10 / 256.0D) * (double)this.shadowOpaque);
-
-                if (var12 > 0.0F)
-                {
-                    this.renderShadow(p_76979_1_, p_76979_2_, p_76979_4_, p_76979_6_, var12, p_76979_9_);
-                }
-            }
-
-            if (p_76979_1_.canRenderOnFire() && (!(p_76979_1_ instanceof EntityPlayer) || !((EntityPlayer)p_76979_1_).func_175149_v()))
-            {
-                this.renderEntityOnFire(p_76979_1_, p_76979_2_, p_76979_4_, p_76979_6_, p_76979_9_);
-            }
-        }
-    }
-
-    /**
-     * Returns the font renderer from the set render manager
-     */
-    public FontRenderer getFontRendererFromRenderManager()
-    {
-        return this.renderManager.getFontRenderer();
-    }
-
-    /**
-     * Renders an entity's name above its head
-     */
-    protected void renderLivingLabel(Entity p_147906_1_, String p_147906_2_, double p_147906_3_, double p_147906_5_, double p_147906_7_, int p_147906_9_)
-    {
-        double var10 = p_147906_1_.getDistanceSqToEntity(this.renderManager.livingPlayer);
-
-        if (var10 <= (double)(p_147906_9_ * p_147906_9_))
-        {
-            FontRenderer var12 = this.getFontRendererFromRenderManager();
-            float var13 = 1.6F;
-            float var14 = 0.016666668F * var13;
-            GlStateManager.pushMatrix();
-            GlStateManager.translate((float)p_147906_3_ + 0.0F, (float)p_147906_5_ + p_147906_1_.height + 0.5F, (float)p_147906_7_);
-            GL11.glNormal3f(0.0F, 1.0F, 0.0F);
-            GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
-            GlStateManager.rotate(this.renderManager.playerViewX, 1.0F, 0.0F, 0.0F);
-            GlStateManager.scale(-var14, -var14, var14);
-            GlStateManager.disableLighting();
-            GlStateManager.depthMask(false);
-            GlStateManager.disableDepth();
-            GlStateManager.enableBlend();
-            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-            Tessellator var15 = Tessellator.getInstance();
-            WorldRenderer var16 = var15.getWorldRenderer();
-            byte var17 = 0;
-
-            if (p_147906_2_.equals("deadmau5"))
-            {
-                var17 = -10;
-            }
-
-            GlStateManager.func_179090_x();
-            var16.startDrawingQuads();
-            int var18 = var12.getStringWidth(p_147906_2_) / 2;
-            var16.func_178960_a(0.0F, 0.0F, 0.0F, 0.25F);
-            var16.addVertex((double)(-var18 - 1), (double)(-1 + var17), 0.0D);
-            var16.addVertex((double)(-var18 - 1), (double)(8 + var17), 0.0D);
-            var16.addVertex((double)(var18 + 1), (double)(8 + var17), 0.0D);
-            var16.addVertex((double)(var18 + 1), (double)(-1 + var17), 0.0D);
-            var15.draw();
-            GlStateManager.func_179098_w();
-            var12.drawString(p_147906_2_, -var12.getStringWidth(p_147906_2_) / 2, var17, 553648127);
-            GlStateManager.enableDepth();
-            GlStateManager.depthMask(true);
-            var12.drawString(p_147906_2_, -var12.getStringWidth(p_147906_2_) / 2, var17, -1);
-            GlStateManager.enableLighting();
-            GlStateManager.disableBlend();
-            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-            GlStateManager.popMatrix();
-        }
-    }
-
-    public RenderManager func_177068_d()
-    {
-        return this.renderManager;
-    }
-}
+package net.minecraft.client.renderer.entity;
+
+import java.util.Iterator;
+
+import net.minecraft.block.Block;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.gui.FontRenderer;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.culling.ICamera;
+import net.minecraft.client.renderer.texture.TextureAtlasSprite;
+import net.minecraft.client.renderer.texture.TextureMap;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLiving;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.world.World;
+
+import org.lwjgl.opengl.GL11;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.HealthTagsMod;
+import tk.wurst_client.mods.NameTagsMod;
+
+public abstract class Render
+{
+    private static final ResourceLocation shadowTextures = new ResourceLocation("textures/misc/shadow.png");
+    protected final RenderManager renderManager;
+    protected float shadowSize;
+
+    /**
+     * Determines the darkness of the object's shadow. Higher value makes a darker shadow.
+     */
+    protected float shadowOpaque = 1.0F;
+    private static final String __OBFID = "CL_00000992";
+
+    protected Render(RenderManager p_i46179_1_)
+    {
+        this.renderManager = p_i46179_1_;
+    }
+
+    public boolean func_177071_a(Entity p_177071_1_, ICamera p_177071_2_, double p_177071_3_, double p_177071_5_, double p_177071_7_)
+    {
+        return p_177071_1_.isInRangeToRender3d(p_177071_3_, p_177071_5_, p_177071_7_) && (p_177071_1_.ignoreFrustumCheck || p_177071_2_.isBoundingBoxInFrustum(p_177071_1_.getEntityBoundingBox()));
+    }
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        this.func_177067_a(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_);
+    }
+
+    protected void func_177067_a(Entity p_177067_1_, double p_177067_2_, double p_177067_4_, double p_177067_6_)
+    {
+        if (this.func_177070_b(p_177067_1_))
+        {
+            this.renderLivingLabel(p_177067_1_, p_177067_1_.getDisplayName().getFormattedText(), p_177067_2_, p_177067_4_, p_177067_6_, 64);
+        }
+    }
+
+    protected boolean func_177070_b(Entity p_177070_1_)
+    {
+        return p_177070_1_.getAlwaysRenderNameTagForRender() && p_177070_1_.hasCustomName();
+    }
+
+    protected void func_177069_a(Entity p_177069_1_, double p_177069_2_, double p_177069_4_, double p_177069_6_, String p_177069_8_, float p_177069_9_, double p_177069_10_)
+    {
+        this.renderLivingLabel(p_177069_1_, p_177069_8_, p_177069_2_, p_177069_4_, p_177069_6_, 64);
+    }
+
+    /**
+     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
+     */
+    protected abstract ResourceLocation getEntityTexture(Entity p_110775_1_);
+
+    protected boolean bindEntityTexture(Entity p_180548_1_)
+    {
+        ResourceLocation var2 = this.getEntityTexture(p_180548_1_);
+
+        if (var2 == null)
+        {
+            return false;
+        }
+        else
+        {
+            this.bindTexture(var2);
+            return true;
+        }
+    }
+
+    public void bindTexture(ResourceLocation p_110776_1_)
+    {
+        this.renderManager.renderEngine.bindTexture(p_110776_1_);
+    }
+
+    /**
+     * Renders fire on top of the entity. Args: entity, x, y, z, partialTickTime
+     */
+    private void renderEntityOnFire(Entity p_76977_1_, double p_76977_2_, double p_76977_4_, double p_76977_6_, float p_76977_8_)
+    {
+        GlStateManager.disableLighting();
+        TextureMap var9 = Minecraft.getMinecraft().getTextureMapBlocks();
+        TextureAtlasSprite var10 = var9.getAtlasSprite("minecraft:blocks/fire_layer_0");
+        TextureAtlasSprite var11 = var9.getAtlasSprite("minecraft:blocks/fire_layer_1");
+        GlStateManager.pushMatrix();
+        GlStateManager.translate((float)p_76977_2_, (float)p_76977_4_, (float)p_76977_6_);
+        float var12 = p_76977_1_.width * 1.4F;
+        GlStateManager.scale(var12, var12, var12);
+        Tessellator var13 = Tessellator.getInstance();
+        WorldRenderer var14 = var13.getWorldRenderer();
+        float var15 = 0.5F;
+        float var16 = 0.0F;
+        float var17 = p_76977_1_.height / var12;
+        float var18 = (float)(p_76977_1_.posY - p_76977_1_.getEntityBoundingBox().minY);
+        GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
+        GlStateManager.translate(0.0F, 0.0F, -0.3F + (float)((int)var17) * 0.02F);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        float var19 = 0.0F;
+        int var20 = 0;
+        var14.startDrawingQuads();
+
+        while (var17 > 0.0F)
+        {
+            TextureAtlasSprite var21 = var20 % 2 == 0 ? var10 : var11;
+            this.bindTexture(TextureMap.locationBlocksTexture);
+            float var22 = var21.getMinU();
+            float var23 = var21.getMinV();
+            float var24 = var21.getMaxU();
+            float var25 = var21.getMaxV();
+
+            if (var20 / 2 % 2 == 0)
+            {
+                float var26 = var24;
+                var24 = var22;
+                var22 = var26;
+            }
+
+            var14.addVertexWithUV((double)(var15 - var16), (double)(0.0F - var18), (double)var19, (double)var24, (double)var25);
+            var14.addVertexWithUV((double)(-var15 - var16), (double)(0.0F - var18), (double)var19, (double)var22, (double)var25);
+            var14.addVertexWithUV((double)(-var15 - var16), (double)(1.4F - var18), (double)var19, (double)var22, (double)var23);
+            var14.addVertexWithUV((double)(var15 - var16), (double)(1.4F - var18), (double)var19, (double)var24, (double)var23);
+            var17 -= 0.45F;
+            var18 -= 0.45F;
+            var15 *= 0.9F;
+            var19 += 0.03F;
+            ++var20;
+        }
+
+        var13.draw();
+        GlStateManager.popMatrix();
+        GlStateManager.enableLighting();
+    }
+
+    /**
+     * Renders the entity shadows at the position, shadow alpha and partialTickTime. Args: entity, x, y, z, shadowAlpha,
+     * partialTickTime
+     */
+    private void renderShadow(Entity p_76975_1_, double p_76975_2_, double p_76975_4_, double p_76975_6_, float p_76975_8_, float p_76975_9_)
+    {
+        GlStateManager.enableBlend();
+        GlStateManager.blendFunc(770, 771);
+        this.renderManager.renderEngine.bindTexture(shadowTextures);
+        World var10 = this.getWorldFromRenderManager();
+        GlStateManager.depthMask(false);
+        float var11 = this.shadowSize;
+
+        if (p_76975_1_ instanceof EntityLiving)
+        {
+            EntityLiving var12 = (EntityLiving)p_76975_1_;
+            var11 *= var12.getRenderSizeModifier();
+
+            if (var12.isChild())
+            {
+                var11 *= 0.5F;
+            }
+        }
+
+        double var35 = p_76975_1_.lastTickPosX + (p_76975_1_.posX - p_76975_1_.lastTickPosX) * (double)p_76975_9_;
+        double var14 = p_76975_1_.lastTickPosY + (p_76975_1_.posY - p_76975_1_.lastTickPosY) * (double)p_76975_9_;
+        double var16 = p_76975_1_.lastTickPosZ + (p_76975_1_.posZ - p_76975_1_.lastTickPosZ) * (double)p_76975_9_;
+        int var18 = MathHelper.floor_double(var35 - (double)var11);
+        int var19 = MathHelper.floor_double(var35 + (double)var11);
+        int var20 = MathHelper.floor_double(var14 - (double)var11);
+        int var21 = MathHelper.floor_double(var14);
+        int var22 = MathHelper.floor_double(var16 - (double)var11);
+        int var23 = MathHelper.floor_double(var16 + (double)var11);
+        double var24 = p_76975_2_ - var35;
+        double var26 = p_76975_4_ - var14;
+        double var28 = p_76975_6_ - var16;
+        Tessellator var30 = Tessellator.getInstance();
+        WorldRenderer var31 = var30.getWorldRenderer();
+        var31.startDrawingQuads();
+        Iterator var32 = BlockPos.getAllInBox(new BlockPos(var18, var20, var22), new BlockPos(var19, var21, var23)).iterator();
+
+        while (var32.hasNext())
+        {
+            BlockPos var33 = (BlockPos)var32.next();
+            Block var34 = var10.getBlockState(var33.offsetDown()).getBlock();
+
+            if (var34.getRenderType() != -1 && var10.getLightFromNeighbors(var33) > 3)
+            {
+                this.func_180549_a(var34, p_76975_2_, p_76975_4_, p_76975_6_, var33, p_76975_8_, var11, var24, var26, var28);
+            }
+        }
+
+        var30.draw();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.disableBlend();
+        GlStateManager.depthMask(true);
+    }
+
+    /**
+     * Returns the render manager's world object
+     */
+    private World getWorldFromRenderManager()
+    {
+        return this.renderManager.worldObj;
+    }
+
+    private void func_180549_a(Block p_180549_1_, double p_180549_2_, double p_180549_4_, double p_180549_6_, BlockPos p_180549_8_, float p_180549_9_, float p_180549_10_, double p_180549_11_, double p_180549_13_, double p_180549_15_)
+    {
+        if (p_180549_1_.isFullCube())
+        {
+            Tessellator var17 = Tessellator.getInstance();
+            WorldRenderer var18 = var17.getWorldRenderer();
+            double var19 = ((double)p_180549_9_ - (p_180549_4_ - ((double)p_180549_8_.getY() + p_180549_13_)) / 2.0D) * 0.5D * (double)this.getWorldFromRenderManager().getLightBrightness(p_180549_8_);
+
+            if (var19 >= 0.0D)
+            {
+                if (var19 > 1.0D)
+                {
+                    var19 = 1.0D;
+                }
+
+                var18.setColorRGBA_F(1.0F, 1.0F, 1.0F, (float)var19);
+                double var21 = (double)p_180549_8_.getX() + p_180549_1_.getBlockBoundsMinX() + p_180549_11_;
+                double var23 = (double)p_180549_8_.getX() + p_180549_1_.getBlockBoundsMaxX() + p_180549_11_;
+                double var25 = (double)p_180549_8_.getY() + p_180549_1_.getBlockBoundsMinY() + p_180549_13_ + 0.015625D;
+                double var27 = (double)p_180549_8_.getZ() + p_180549_1_.getBlockBoundsMinZ() + p_180549_15_;
+                double var29 = (double)p_180549_8_.getZ() + p_180549_1_.getBlockBoundsMaxZ() + p_180549_15_;
+                float var31 = (float)((p_180549_2_ - var21) / 2.0D / (double)p_180549_10_ + 0.5D);
+                float var32 = (float)((p_180549_2_ - var23) / 2.0D / (double)p_180549_10_ + 0.5D);
+                float var33 = (float)((p_180549_6_ - var27) / 2.0D / (double)p_180549_10_ + 0.5D);
+                float var34 = (float)((p_180549_6_ - var29) / 2.0D / (double)p_180549_10_ + 0.5D);
+                var18.addVertexWithUV(var21, var25, var27, (double)var31, (double)var33);
+                var18.addVertexWithUV(var21, var25, var29, (double)var31, (double)var34);
+                var18.addVertexWithUV(var23, var25, var29, (double)var32, (double)var34);
+                var18.addVertexWithUV(var23, var25, var27, (double)var32, (double)var33);
+            }
+        }
+    }
+
+    /**
+     * Renders a white box with the bounds of the AABB translated by the offset. Args: aabb, x, y, z
+     */
+    public static void renderOffsetAABB(AxisAlignedBB p_76978_0_, double p_76978_1_, double p_76978_3_, double p_76978_5_)
+    {
+        GlStateManager.func_179090_x();
+        Tessellator var7 = Tessellator.getInstance();
+        WorldRenderer var8 = var7.getWorldRenderer();
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        var8.startDrawingQuads();
+        var8.setTranslation(p_76978_1_, p_76978_3_, p_76978_5_);
+        var8.func_178980_d(0.0F, 0.0F, -1.0F);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.func_178980_d(0.0F, 0.0F, 1.0F);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.func_178980_d(0.0F, -1.0F, 0.0F);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.func_178980_d(0.0F, 1.0F, 0.0F);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.func_178980_d(-1.0F, 0.0F, 0.0F);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.minX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.func_178980_d(1.0F, 0.0F, 0.0F);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.minZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.maxY, p_76978_0_.maxZ);
+        var8.addVertex(p_76978_0_.maxX, p_76978_0_.minY, p_76978_0_.maxZ);
+        var8.setTranslation(0.0D, 0.0D, 0.0D);
+        var7.draw();
+        GlStateManager.func_179098_w();
+    }
+
+    /**
+     * Renders the entity's shadow and fire (if its on fire). Args: entity, x, y, z, yaw, partialTickTime
+     */
+    public void doRenderShadowAndFire(Entity p_76979_1_, double p_76979_2_, double p_76979_4_, double p_76979_6_, float p_76979_8_, float p_76979_9_)
+    {
+        if (this.renderManager.options != null)
+        {
+            if (this.renderManager.options.fancyGraphics && this.shadowSize > 0.0F && !p_76979_1_.isInvisible() && this.renderManager.func_178627_a())
+            {
+                double var10 = this.renderManager.getDistanceToCamera(p_76979_1_.posX, p_76979_1_.posY, p_76979_1_.posZ);
+                float var12 = (float)((1.0D - var10 / 256.0D) * (double)this.shadowOpaque);
+
+                if (var12 > 0.0F)
+                {
+                    this.renderShadow(p_76979_1_, p_76979_2_, p_76979_4_, p_76979_6_, var12, p_76979_9_);
+                }
+            }
+
+            if (p_76979_1_.canRenderOnFire() && (!(p_76979_1_ instanceof EntityPlayer) || !((EntityPlayer)p_76979_1_).isSpectator()))
+            {
+                this.renderEntityOnFire(p_76979_1_, p_76979_2_, p_76979_4_, p_76979_6_, p_76979_9_);
+            }
+        }
+    }
+
+    /**
+     * Returns the font renderer from the set render manager
+     */
+    public FontRenderer getFontRendererFromRenderManager()
+    {
+        return this.renderManager.getFontRenderer();
+    }
+
+    /**
+     * Renders an entity's name above its head
+     */
+    protected void renderLivingLabel(Entity p_147906_1_, String p_147906_2_, double p_147906_3_, double p_147906_5_, double p_147906_7_, int p_147906_9_)
+    {
+        double var10 = p_147906_1_.getDistanceSqToEntity(this.renderManager.livingPlayer);
+
+        if (var10 <= (double)(p_147906_9_ * p_147906_9_))
+        {
+            FontRenderer var12 = this.getFontRendererFromRenderManager();
+            float var13 = 1.6F;
+            //TODO: Client
+            float var14 = 0.016666668F * var13 * (p_147906_1_.getDistanceToEntity(this.renderManager.livingPlayer) > 10 && WurstClient.INSTANCE.modManager.getModByClass(NameTagsMod.class).isEnabled() ? p_147906_1_.getDistanceToEntity(this.renderManager.livingPlayer) / 10 : 1);
+            var14 *= (WurstClient.INSTANCE.modManager.getModByClass(NameTagsMod.class).isEnabled() ? (p_147906_1_.boundingBox.getAverageEdgeLength() > - 50 ? 1 : p_147906_1_.getDistanceToEntity(this.renderManager.livingPlayer) / 300) : 1);
+            GlStateManager.pushMatrix();
+            GlStateManager.translate((float)p_147906_3_ + 0.0F, (float)p_147906_5_ + p_147906_1_.height + 0.5F, (float)p_147906_7_);
+            GL11.glNormal3f(0.0F, 1.0F, 0.0F);
+            GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
+            GlStateManager.rotate(this.renderManager.playerViewX, 1.0F, 0.0F, 0.0F);
+            GlStateManager.scale(-var14, -var14, var14);
+            GlStateManager.disableLighting();
+            GlStateManager.depthMask(false);
+            GlStateManager.disableDepth();
+            GlStateManager.enableBlend();
+            GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+            Tessellator var15 = Tessellator.getInstance();
+            WorldRenderer var16 = var15.getWorldRenderer();
+            byte var17 = 0;
+
+            if (p_147906_2_.equals("deadmau5"))
+            {
+                var17 = -10;
+            }
+
+            //TODO: Client
+            if(WurstClient.INSTANCE.friends.contains(p_147906_1_.getName()))
+            	p_147906_2_ = "2" + (p_147906_2_.startsWith("") ? p_147906_2_.substring(2) : p_147906_2_);
+            if(p_147906_1_ instanceof EntityLivingBase && WurstClient.INSTANCE.modManager.getModByClass(HealthTagsMod.class).isEnabled())
+            {
+            	p_147906_2_ += " ";
+            	int health = (int)((EntityLivingBase) p_147906_1_).getHealth();
+            	if(health <= 5)
+            		p_147906_2_ += "4";
+            	else if(health <= 10)
+            		p_147906_2_ += "6";
+            	else if(health <= 15)
+            		p_147906_2_ += "e";
+            	else if(health <= 20)
+            		p_147906_2_ += "a";
+            	p_147906_2_ += health;
+            }
+            GlStateManager.func_179090_x();
+            var16.startDrawingQuads();
+            int var18 = var12.getStringWidth(p_147906_2_) / 2;
+            var16.setColorRGBA_F(0.0F, 0.0F, 0.0F, 0.25F);
+            var16.addVertex((double)(-var18 - 1), (double)(-1 + var17), 0.0D);
+            var16.addVertex((double)(-var18 - 1), (double)(8 + var17), 0.0D);
+            var16.addVertex((double)(var18 + 1), (double)(8 + var17), 0.0D);
+            var16.addVertex((double)(var18 + 1), (double)(-1 + var17), 0.0D);
+            var15.draw();
+            GlStateManager.func_179098_w();
+            var12.drawString(p_147906_2_, -var12.getStringWidth(p_147906_2_) / 2, var17, 553648127);
+            GlStateManager.enableDepth();
+            GlStateManager.depthMask(true);
+            var12.drawString(p_147906_2_, -var12.getStringWidth(p_147906_2_) / 2, var17, -1);
+            GlStateManager.enableLighting();
+            GlStateManager.disableBlend();
+            GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+            GlStateManager.popMatrix();
+        }
+    }
+
+    public RenderManager func_177068_d()
+    {
+        return this.renderManager;
+    }
+}
diff --git a/src/net/minecraft/client/renderer/entity/RenderDragon.java b/src/net/minecraft/client/renderer/entity/RenderDragon.java
index 63a12a1..03a9cce 100644
--- a/src/net/minecraft/client/renderer/entity/RenderDragon.java
+++ b/src/net/minecraft/client/renderer/entity/RenderDragon.java
@@ -136,9 +136,9 @@ public class RenderDragon extends RenderLiving
             float var22 = MathHelper.sin((float)(var21 % var20) * (float)Math.PI * 2.0F / (float)var20) * 0.75F;
             float var23 = MathHelper.cos((float)(var21 % var20) * (float)Math.PI * 2.0F / (float)var20) * 0.75F;
             float var24 = (float)(var21 % var20) * 1.0F / (float)var20;
-            var17.func_178991_c(0);
+            var17.setColorOpaque_I(0);
             var17.addVertexWithUV((double)(var22 * 0.2F), (double)(var23 * 0.2F), 0.0D, (double)var24, (double)var19);
-            var17.func_178991_c(16777215);
+            var17.setColorOpaque_I(16777215);
             var17.addVertexWithUV((double)var22, (double)var23, (double)var15, (double)var24, (double)var18);
         }
 
diff --git a/src/net/minecraft/client/renderer/entity/RenderFallingBlock.java b/src/net/minecraft/client/renderer/entity/RenderFallingBlock.java
index 6936e51..31257a7 100644
--- a/src/net/minecraft/client/renderer/entity/RenderFallingBlock.java
+++ b/src/net/minecraft/client/renderer/entity/RenderFallingBlock.java
@@ -1,93 +1,96 @@
-package net.minecraft.client.renderer.entity;
-
-import net.minecraft.block.Block;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.BlockRendererDispatcher;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.texture.TextureMap;
-import net.minecraft.client.renderer.vertex.DefaultVertexFormats;
-import net.minecraft.client.resources.model.IBakedModel;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.item.EntityFallingBlock;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.ResourceLocation;
-import net.minecraft.world.World;
-
-public class RenderFallingBlock extends Render
-{
-    private static final String __OBFID = "CL_00000994";
-
-    public RenderFallingBlock(RenderManager p_i46177_1_)
-    {
-        super(p_i46177_1_);
-        this.shadowSize = 0.5F;
-    }
-
-    public void doRender(EntityFallingBlock p_180557_1_, double p_180557_2_, double p_180557_4_, double p_180557_6_, float p_180557_8_, float p_180557_9_)
-    {
-        if (p_180557_1_.getBlock() != null)
-        {
-            this.bindTexture(TextureMap.locationBlocksTexture);
-            IBlockState var10 = p_180557_1_.getBlock();
-            Block var11 = var10.getBlock();
-            BlockPos var12 = new BlockPos(p_180557_1_);
-            World var13 = p_180557_1_.getWorldObj();
-
-            if (var10 != var13.getBlockState(var12) && var11.getRenderType() != -1)
-            {
-                if (var11.getRenderType() == 3)
-                {
-                    GlStateManager.pushMatrix();
-                    GlStateManager.translate((float)p_180557_2_, (float)p_180557_4_, (float)p_180557_6_);
-                    GlStateManager.disableLighting();
-                    Tessellator var14 = Tessellator.getInstance();
-                    WorldRenderer var15 = var14.getWorldRenderer();
-                    var15.startDrawingQuads();
-                    var15.setVertexFormat(DefaultVertexFormats.field_176600_a);
-                    int var16 = var12.getX();
-                    int var17 = var12.getY();
-                    int var18 = var12.getZ();
-                    var15.setTranslation((double)((float)(-var16) - 0.5F), (double)(-var17), (double)((float)(-var18) - 0.5F));
-                    BlockRendererDispatcher var19 = Minecraft.getMinecraft().getBlockRendererDispatcher();
-                    IBakedModel var20 = var19.getModelFromBlockState(var10, var13, (BlockPos)null);
-                    var19.func_175019_b().renderBlockModel(var13, var20, var10, var12, var15, false);
-                    var15.setTranslation(0.0D, 0.0D, 0.0D);
-                    var14.draw();
-                    GlStateManager.enableLighting();
-                    GlStateManager.popMatrix();
-                    super.doRender(p_180557_1_, p_180557_2_, p_180557_4_, p_180557_6_, p_180557_8_, p_180557_9_);
-                }
-            }
-        }
-    }
-
-    /**
-     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
-     */
-    protected ResourceLocation getEntityTexture(EntityFallingBlock p_110775_1_)
-    {
-        return TextureMap.locationBlocksTexture;
-    }
-
-    /**
-     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
-     */
-    protected ResourceLocation getEntityTexture(Entity p_110775_1_)
-    {
-        return this.getEntityTexture((EntityFallingBlock)p_110775_1_);
-    }
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        this.doRender((EntityFallingBlock)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
-    }
-}
+package net.minecraft.client.renderer.entity;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.ProphuntEspMod;
+import net.minecraft.block.Block;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.renderer.BlockRendererDispatcher;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.texture.TextureMap;
+import net.minecraft.client.renderer.vertex.DefaultVertexFormats;
+import net.minecraft.client.resources.model.IBakedModel;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.item.EntityFallingBlock;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.ResourceLocation;
+import net.minecraft.world.World;
+
+public class RenderFallingBlock extends Render
+{
+    private static final String __OBFID = "CL_00000994";
+
+    public RenderFallingBlock(RenderManager p_i46177_1_)
+    {
+        super(p_i46177_1_);
+        this.shadowSize = 0.5F;
+    }
+
+    public void doRender(EntityFallingBlock p_180557_1_, double p_180557_2_, double p_180557_4_, double p_180557_6_, float p_180557_8_, float p_180557_9_)
+    {
+    	//TODO: Client
+        if (p_180557_1_.getBlock() != null && !WurstClient.INSTANCE.modManager.getModByClass(ProphuntEspMod.class).isEnabled())
+        {
+            this.bindTexture(TextureMap.locationBlocksTexture);
+            IBlockState var10 = p_180557_1_.getBlock();
+            Block var11 = var10.getBlock();
+            BlockPos var12 = new BlockPos(p_180557_1_);
+            World var13 = p_180557_1_.getWorldObj();
+
+            if (var10 != var13.getBlockState(var12) && var11.getRenderType() != -1)
+            {
+                if (var11.getRenderType() == 3)
+                {
+                    GlStateManager.pushMatrix();
+                    GlStateManager.translate((float)p_180557_2_, (float)p_180557_4_, (float)p_180557_6_);
+                    GlStateManager.disableLighting();
+                    Tessellator var14 = Tessellator.getInstance();
+                    WorldRenderer var15 = var14.getWorldRenderer();
+                    var15.startDrawingQuads();
+                    var15.setVertexFormat(DefaultVertexFormats.field_176600_a);
+                    int var16 = var12.getX();
+                    int var17 = var12.getY();
+                    int var18 = var12.getZ();
+                    var15.setTranslation((double)((float)(-var16) - 0.5F), (double)(-var17), (double)((float)(-var18) - 0.5F));
+                    BlockRendererDispatcher var19 = Minecraft.getMinecraft().getBlockRendererDispatcher();
+                    IBakedModel var20 = var19.getModelFromBlockState(var10, var13, (BlockPos)null);
+                    var19.func_175019_b().renderBlockModel(var13, var20, var10, var12, var15, false);
+                    var15.setTranslation(0.0D, 0.0D, 0.0D);
+                    var14.draw();
+                    GlStateManager.enableLighting();
+                    GlStateManager.popMatrix();
+                    super.doRender(p_180557_1_, p_180557_2_, p_180557_4_, p_180557_6_, p_180557_8_, p_180557_9_);
+                }
+            }
+        }
+    }
+
+    /**
+     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
+     */
+    protected ResourceLocation getEntityTexture(EntityFallingBlock p_110775_1_)
+    {
+        return TextureMap.locationBlocksTexture;
+    }
+
+    /**
+     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
+     */
+    protected ResourceLocation getEntityTexture(Entity p_110775_1_)
+    {
+        return this.getEntityTexture((EntityFallingBlock)p_110775_1_);
+    }
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        this.doRender((EntityFallingBlock)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
+    }
+}
diff --git a/src/net/minecraft/client/renderer/entity/RenderFish.java b/src/net/minecraft/client/renderer/entity/RenderFish.java
index fdad66c..d29aa64 100644
--- a/src/net/minecraft/client/renderer/entity/RenderFish.java
+++ b/src/net/minecraft/client/renderer/entity/RenderFish.java
@@ -86,7 +86,7 @@ public class RenderFish extends Render
             GlStateManager.func_179090_x();
             GlStateManager.disableLighting();
             var11.startDrawing(3);
-            var11.func_178991_c(0);
+            var11.setColorOpaque_I(0);
             byte var44 = 16;
 
             for (int var45 = 0; var45 <= var44; ++var45)
diff --git a/src/net/minecraft/client/renderer/entity/RenderGuardian.java b/src/net/minecraft/client/renderer/entity/RenderGuardian.java
index ac9dfc4..85611a5 100644
--- a/src/net/minecraft/client/renderer/entity/RenderGuardian.java
+++ b/src/net/minecraft/client/renderer/entity/RenderGuardian.java
@@ -109,7 +109,7 @@ public class RenderGuardian extends RenderLiving
             double var26 = (double)var15 * 0.05D * (1.0D - (double)(var25 & 1) * 2.5D);
             var13.startDrawingQuads();
             float var28 = var11 * var11;
-            var13.func_178961_b(64 + (int)(var28 * 240.0F), 32 + (int)(var28 * 192.0F), 128 - (int)(var28 * 64.0F), 255);
+            var13.setColorRGBA(64 + (int)(var28 * 240.0F), 32 + (int)(var28 * 192.0F), 128 - (int)(var28 * 64.0F), 255);
             double var29 = (double)var25 * 0.2D;
             double var31 = var29 * 1.41D;
             double var33 = 0.0D + Math.cos(var26 + 2.356194490192345D) * var31;
diff --git a/src/net/minecraft/client/renderer/entity/RenderItem.java b/src/net/minecraft/client/renderer/entity/RenderItem.java
index eadc994..020d30f 100644
--- a/src/net/minecraft/client/renderer/entity/RenderItem.java
+++ b/src/net/minecraft/client/renderer/entity/RenderItem.java
@@ -3,6 +3,7 @@ package net.minecraft.client.renderer.entity;
 import java.util.Iterator;
 import java.util.List;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockDirt;
 import net.minecraft.block.BlockDoublePlant;
@@ -67,7 +68,7 @@ public class RenderItem implements IResourceManagerReloadListener
     /** Defines the zLevel of rendering of item on GUI. */
     public float zLevel;
     private final ItemModelMesher itemModelMesher;
-    private final TextureManager field_175057_n;
+    private final TextureManager textureManager;
     public static float field_175055_b = 0.0F;
     public static float field_175056_c = 0.0F;
     public static float field_175053_d = 0.0F;
@@ -81,7 +82,7 @@ public class RenderItem implements IResourceManagerReloadListener
 
     public RenderItem(TextureManager p_i46165_1_, ModelManager p_i46165_2_)
     {
-        this.field_175057_n = p_i46165_1_;
+        this.textureManager = p_i46165_1_;
         this.itemModelMesher = new ItemModelMesher(p_i46165_2_);
         this.registerItems();
     }
@@ -178,7 +179,7 @@ public class RenderItem implements IResourceManagerReloadListener
         GlStateManager.depthFunc(514);
         GlStateManager.disableLighting();
         GlStateManager.blendFunc(768, 1);
-        this.field_175057_n.bindTexture(RES_ITEM_GLINT);
+        this.textureManager.bindTexture(RES_ITEM_GLINT);
         GlStateManager.matrixMode(5890);
         GlStateManager.pushMatrix();
         GlStateManager.scale(8.0F, 8.0F, 8.0F);
@@ -199,7 +200,7 @@ public class RenderItem implements IResourceManagerReloadListener
         GlStateManager.enableLighting();
         GlStateManager.depthFunc(515);
         GlStateManager.depthMask(true);
-        this.field_175057_n.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureManager.bindTexture(TextureMap.locationBlocksTexture);
     }
 
     private void func_175038_a(WorldRenderer p_175038_1_, BakedQuad p_175038_2_)
@@ -325,8 +326,8 @@ public class RenderItem implements IResourceManagerReloadListener
 
     protected void func_175040_a(ItemStack p_175040_1_, IBakedModel p_175040_2_, ItemCameraTransforms.TransformType p_175040_3_)
     {
-        this.field_175057_n.bindTexture(TextureMap.locationBlocksTexture);
-        this.field_175057_n.getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
+        this.textureManager.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureManager.getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
         this.func_175046_c(p_175040_1_);
         GlStateManager.enableRescaleNormal();
         GlStateManager.alphaFunc(516, 0.1F);
@@ -360,31 +361,31 @@ public class RenderItem implements IResourceManagerReloadListener
         GlStateManager.popMatrix();
         GlStateManager.disableRescaleNormal();
         GlStateManager.disableBlend();
-        this.field_175057_n.bindTexture(TextureMap.locationBlocksTexture);
-        this.field_175057_n.getTexture(TextureMap.locationBlocksTexture).func_174935_a();
+        this.textureManager.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureManager.getTexture(TextureMap.locationBlocksTexture).func_174935_a();
     }
 
-    public void func_175042_a(ItemStack p_175042_1_, int p_175042_2_, int p_175042_3_)
+    public void func_180450_b(ItemStack itemStack, int x, int y)
     {
-        IBakedModel var4 = this.itemModelMesher.getItemModel(p_175042_1_);
+        IBakedModel bakedModel = this.itemModelMesher.getItemModel(itemStack);
         GlStateManager.pushMatrix();
-        this.field_175057_n.bindTexture(TextureMap.locationBlocksTexture);
-        this.field_175057_n.getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
+        this.textureManager.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureManager.getTexture(TextureMap.locationBlocksTexture).func_174936_b(false, false);
         GlStateManager.enableRescaleNormal();
         GlStateManager.enableAlpha();
         GlStateManager.alphaFunc(516, 0.1F);
         GlStateManager.enableBlend();
         GlStateManager.blendFunc(770, 771);
         GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        this.func_180452_a(p_175042_2_, p_175042_3_, var4.isAmbientOcclusionEnabled());
-        this.func_175034_a(var4.getItemCameraTransforms().field_178354_e);
-        this.func_180454_a(p_175042_1_, var4);
+        this.func_180452_a(x, y, bakedModel.isAmbientOcclusionEnabled());
+        this.func_175034_a(bakedModel.getItemCameraTransforms().field_178354_e);
+        this.func_180454_a(itemStack, bakedModel);
         GlStateManager.disableAlpha();
         GlStateManager.disableRescaleNormal();
         GlStateManager.disableLighting();
         GlStateManager.popMatrix();
-        this.field_175057_n.bindTexture(TextureMap.locationBlocksTexture);
-        this.field_175057_n.getTexture(TextureMap.locationBlocksTexture).func_174935_a();
+        this.textureManager.bindTexture(TextureMap.locationBlocksTexture);
+        this.textureManager.getTexture(TextureMap.locationBlocksTexture).func_174935_a();
     }
 
     private void func_180452_a(int p_180452_1_, int p_180452_2_, boolean p_180452_3_)
@@ -409,7 +410,8 @@ public class RenderItem implements IResourceManagerReloadListener
         }
     }
 
-    public void func_180450_b(final ItemStack p_180450_1_, int p_180450_2_, int p_180450_3_)
+    //TODO: Client
+    public void renderItemAndEffectIntoGUI(final ItemStack p_180450_1_, int p_180450_2_, int p_180450_3_)
     {
         if (p_180450_1_ != null)
         {
@@ -417,7 +419,7 @@ public class RenderItem implements IResourceManagerReloadListener
 
             try
             {
-                this.func_175042_a(p_180450_1_, p_180450_2_, p_180450_3_);
+                this.func_180450_b(p_180450_1_, p_180450_2_, p_180450_3_);
             }
             catch (Throwable var7)
             {
@@ -483,7 +485,7 @@ public class RenderItem implements IResourceManagerReloadListener
                 GlStateManager.disableLighting();
                 GlStateManager.disableDepth();
                 GlStateManager.disableBlend();
-                p_180453_1_.func_175063_a(var6, (float)(p_180453_3_ + 19 - 2 - p_180453_1_.getStringWidth(var6)), (float)(p_180453_4_ + 6 + 3), 16777215);
+                p_180453_1_.drawStringWithShadow(var6, (float)(p_180453_3_ + 19 - 2 - p_180453_1_.getStringWidth(var6)), (float)(p_180453_4_ + 6 + 3), 16777215);
                 GlStateManager.enableLighting();
                 GlStateManager.enableDepth();
             }
@@ -516,7 +518,7 @@ public class RenderItem implements IResourceManagerReloadListener
     private void func_175044_a(WorldRenderer p_175044_1_, int p_175044_2_, int p_175044_3_, int p_175044_4_, int p_175044_5_, int p_175044_6_)
     {
         p_175044_1_.startDrawingQuads();
-        p_175044_1_.func_178991_c(p_175044_6_);
+        p_175044_1_.setColorOpaque_I(p_175044_6_);
         p_175044_1_.addVertex((double)(p_175044_2_ + 0), (double)(p_175044_3_ + 0), 0.0D);
         p_175044_1_.addVertex((double)(p_175044_2_ + 0), (double)(p_175044_3_ + p_175044_5_), 0.0D);
         p_175044_1_.addVertex((double)(p_175044_2_ + p_175044_4_), (double)(p_175044_3_ + p_175044_5_), 0.0D);
diff --git a/src/net/minecraft/client/renderer/entity/RenderLightningBolt.java b/src/net/minecraft/client/renderer/entity/RenderLightningBolt.java
index cf9b5c6..34f6c75 100644
--- a/src/net/minecraft/client/renderer/entity/RenderLightningBolt.java
+++ b/src/net/minecraft/client/renderer/entity/RenderLightningBolt.java
@@ -85,7 +85,7 @@ public class RenderLightningBolt extends Render
 
                     var11.startDrawing(5);
                     float var32 = 0.5F;
-                    var11.func_178960_a(0.9F * var32, 0.9F * var32, 1.0F * var32, 0.3F);
+                    var11.setColorRGBA_F(0.9F * var32, 0.9F * var32, 1.0F * var32, 0.3F);
                     double var33 = 0.1D + (double)var46 * 0.2D;
 
                     if (var20 == 0)
diff --git a/src/net/minecraft/client/renderer/entity/RenderLiving.java b/src/net/minecraft/client/renderer/entity/RenderLiving.java
index f4b6692..b1a34c8 100644
--- a/src/net/minecraft/client/renderer/entity/RenderLiving.java
+++ b/src/net/minecraft/client/renderer/entity/RenderLiving.java
@@ -120,11 +120,11 @@ public abstract class RenderLiving extends RendererLivingEntity
             {
                 if (var48 % 2 == 0)
                 {
-                    var12.func_178960_a(0.5F, 0.4F, 0.3F, 1.0F);
+                    var12.setColorRGBA_F(0.5F, 0.4F, 0.3F, 1.0F);
                 }
                 else
                 {
-                    var12.func_178960_a(0.35F, 0.28F, 0.21000001F, 1.0F);
+                    var12.setColorRGBA_F(0.35F, 0.28F, 0.21000001F, 1.0F);
                 }
 
                 var49 = (float)var48 / 24.0F;
@@ -139,11 +139,11 @@ public abstract class RenderLiving extends RendererLivingEntity
             {
                 if (var48 % 2 == 0)
                 {
-                    var12.func_178960_a(0.5F, 0.4F, 0.3F, 1.0F);
+                    var12.setColorRGBA_F(0.5F, 0.4F, 0.3F, 1.0F);
                 }
                 else
                 {
-                    var12.func_178960_a(0.35F, 0.28F, 0.21000001F, 1.0F);
+                    var12.setColorRGBA_F(0.35F, 0.28F, 0.21000001F, 1.0F);
                 }
 
                 var49 = (float)var48 / 24.0F;
diff --git a/src/net/minecraft/client/renderer/entity/RenderManager.java b/src/net/minecraft/client/renderer/entity/RenderManager.java
index 7fdac31..12df2a4 100644
--- a/src/net/minecraft/client/renderer/entity/RenderManager.java
+++ b/src/net/minecraft/client/renderer/entity/RenderManager.java
@@ -1,7 +1,7 @@
 package net.minecraft.client.renderer.entity;
 
-import com.google.common.collect.Maps;
 import java.util.Map;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockBed;
 import net.minecraft.block.state.IBlockState;
@@ -100,18 +100,21 @@ import net.minecraft.util.ReportedException;
 import net.minecraft.util.Vec3;
 import net.minecraft.world.World;
 
+import com.google.common.collect.Maps;
+
 public class RenderManager
 {
     /** A map of entity classes and the associated renderer. */
     private Map entityRenderMap = Maps.newHashMap();
     private Map field_178636_l = Maps.newHashMap();
-    private RenderPlayer field_178637_m;
+    private RenderPlayer renderPlayer;
 
     /** Renders fonts */
+    //TODO: Client
     private FontRenderer textRenderer;
-    private double renderPosX;
-    private double renderPosY;
-    private double renderPosZ;
+    public double renderPosX;
+    public double renderPosY;
+    public double renderPosZ;
     public TextureManager renderEngine;
 
     /** Reference to the World object. */
@@ -197,8 +200,8 @@ public class RenderManager
         this.entityRenderMap.put(EntityFishHook.class, new RenderFish(this));
         this.entityRenderMap.put(EntityHorse.class, new RenderHorse(this, new ModelHorse(), 0.75F));
         this.entityRenderMap.put(EntityLightningBolt.class, new RenderLightningBolt(this));
-        this.field_178637_m = new RenderPlayer(this);
-        this.field_178636_l.put("default", this.field_178637_m);
+        this.renderPlayer = new RenderPlayer(this);
+        this.field_178636_l.put("default", this.renderPlayer);
         this.field_178636_l.put("slim", new RenderPlayer(this, true));
     }
 
@@ -228,7 +231,7 @@ public class RenderManager
         {
             String var2 = ((AbstractClientPlayer)p_78713_1_).func_175154_l();
             RenderPlayer var3 = (RenderPlayer)this.field_178636_l.get(var2);
-            return var3 != null ? var3 : this.field_178637_m;
+            return var3 != null ? var3 : this.renderPlayer;
         }
         else
         {
@@ -452,7 +455,7 @@ public class RenderManager
         WorldRenderer var14 = var16.getWorldRenderer();
         Vec3 var15 = p_85094_1_.getLook(p_85094_9_);
         var14.startDrawing(3);
-        var14.func_178991_c(255);
+        var14.setColorOpaque_I(255);
         var14.addVertex(p_85094_2_, p_85094_4_ + (double)p_85094_1_.getEyeHeight(), p_85094_6_);
         var14.addVertex(p_85094_2_ + var15.xCoord * 2.0D, p_85094_4_ + (double)p_85094_1_.getEyeHeight() + var15.yCoord * 2.0D, p_85094_6_ + var15.zCoord * 2.0D);
         var16.draw();
diff --git a/src/net/minecraft/client/renderer/entity/RenderPlayer.java b/src/net/minecraft/client/renderer/entity/RenderPlayer.java
index bc2dd09..d27f6c2 100644
--- a/src/net/minecraft/client/renderer/entity/RenderPlayer.java
+++ b/src/net/minecraft/client/renderer/entity/RenderPlayer.java
@@ -1,268 +1,271 @@
-package net.minecraft.client.renderer.entity;
-
-import net.minecraft.client.entity.AbstractClientPlayer;
-import net.minecraft.client.entity.EntityPlayerSP;
-import net.minecraft.client.model.ModelBase;
-import net.minecraft.client.model.ModelPlayer;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.entity.layers.LayerArrow;
-import net.minecraft.client.renderer.entity.layers.LayerBipedArmor;
-import net.minecraft.client.renderer.entity.layers.LayerCape;
-import net.minecraft.client.renderer.entity.layers.LayerCustomHead;
-import net.minecraft.client.renderer.entity.layers.LayerDeadmau5Head;
-import net.minecraft.client.renderer.entity.layers.LayerHeldItem;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.player.EnumPlayerModelParts;
-import net.minecraft.item.EnumAction;
-import net.minecraft.item.ItemStack;
-import net.minecraft.scoreboard.Score;
-import net.minecraft.scoreboard.ScoreObjective;
-import net.minecraft.scoreboard.Scoreboard;
-import net.minecraft.util.ResourceLocation;
-
-public class RenderPlayer extends RendererLivingEntity
-{
-    private boolean field_177140_a;
-    private static final String __OBFID = "CL_00001020";
-
-    public RenderPlayer(RenderManager p_i46102_1_)
-    {
-        this(p_i46102_1_, false);
-    }
-
-    public RenderPlayer(RenderManager p_i46103_1_, boolean p_i46103_2_)
-    {
-        super(p_i46103_1_, new ModelPlayer(0.0F, p_i46103_2_), 0.5F);
-        this.field_177140_a = p_i46103_2_;
-        this.addLayer(new LayerBipedArmor(this));
-        this.addLayer(new LayerHeldItem(this));
-        this.addLayer(new LayerArrow(this));
-        this.addLayer(new LayerDeadmau5Head(this));
-        this.addLayer(new LayerCape(this));
-        this.addLayer(new LayerCustomHead(this.func_177136_g().bipedHead));
-    }
-
-    public ModelPlayer func_177136_g()
-    {
-        return (ModelPlayer)super.getMainModel();
-    }
-
-    public void func_180596_a(AbstractClientPlayer p_180596_1_, double p_180596_2_, double p_180596_4_, double p_180596_6_, float p_180596_8_, float p_180596_9_)
-    {
-        if (!p_180596_1_.func_175144_cb() || this.renderManager.livingPlayer == p_180596_1_)
-        {
-            double var10 = p_180596_4_;
-
-            if (p_180596_1_.isSneaking() && !(p_180596_1_ instanceof EntityPlayerSP))
-            {
-                var10 = p_180596_4_ - 0.125D;
-            }
-
-            this.func_177137_d(p_180596_1_);
-            super.doRender((EntityLivingBase)p_180596_1_, p_180596_2_, var10, p_180596_6_, p_180596_8_, p_180596_9_);
-        }
-    }
-
-    private void func_177137_d(AbstractClientPlayer p_177137_1_)
-    {
-        ModelPlayer var2 = this.func_177136_g();
-
-        if (p_177137_1_.func_175149_v())
-        {
-            var2.func_178719_a(false);
-            var2.bipedHead.showModel = true;
-            var2.bipedHeadwear.showModel = true;
-        }
-        else
-        {
-            ItemStack var3 = p_177137_1_.inventory.getCurrentItem();
-            var2.func_178719_a(true);
-            var2.bipedHeadwear.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.HAT);
-            var2.field_178730_v.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.JACKET);
-            var2.field_178733_c.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.LEFT_PANTS_LEG);
-            var2.field_178731_d.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.RIGHT_PANTS_LEG);
-            var2.field_178734_a.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.LEFT_SLEEVE);
-            var2.field_178732_b.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.RIGHT_SLEEVE);
-            var2.heldItemLeft = 0;
-            var2.aimedBow = false;
-            var2.isSneak = p_177137_1_.isSneaking();
-
-            if (var3 == null)
-            {
-                var2.heldItemRight = 0;
-            }
-            else
-            {
-                var2.heldItemRight = 1;
-
-                if (p_177137_1_.getItemInUseCount() > 0)
-                {
-                    EnumAction var4 = var3.getItemUseAction();
-
-                    if (var4 == EnumAction.BLOCK)
-                    {
-                        var2.heldItemRight = 3;
-                    }
-                    else if (var4 == EnumAction.BOW)
-                    {
-                        var2.aimedBow = true;
-                    }
-                }
-            }
-        }
-    }
-
-    protected ResourceLocation func_180594_a(AbstractClientPlayer p_180594_1_)
-    {
-        return p_180594_1_.getLocationSkin();
-    }
-
-    public void func_82422_c()
-    {
-        GlStateManager.translate(0.0F, 0.1875F, 0.0F);
-    }
-
-    /**
-     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
-     * entityLiving, partialTickTime
-     */
-    protected void preRenderCallback(AbstractClientPlayer p_77041_1_, float p_77041_2_)
-    {
-        float var3 = 0.9375F;
-        GlStateManager.scale(var3, var3, var3);
-    }
-
-    protected void renderOffsetLivingLabel(AbstractClientPlayer p_96449_1_, double p_96449_2_, double p_96449_4_, double p_96449_6_, String p_96449_8_, float p_96449_9_, double p_96449_10_)
-    {
-        if (p_96449_10_ < 100.0D)
-        {
-            Scoreboard var12 = p_96449_1_.getWorldScoreboard();
-            ScoreObjective var13 = var12.getObjectiveInDisplaySlot(2);
-
-            if (var13 != null)
-            {
-                Score var14 = var12.getValueFromObjective(p_96449_1_.getName(), var13);
-                this.renderLivingLabel(p_96449_1_, var14.getScorePoints() + " " + var13.getDisplayName(), p_96449_2_, p_96449_4_, p_96449_6_, 64);
-                p_96449_4_ += (double)((float)this.getFontRendererFromRenderManager().FONT_HEIGHT * 1.15F * p_96449_9_);
-            }
-        }
-
-        super.func_177069_a(p_96449_1_, p_96449_2_, p_96449_4_, p_96449_6_, p_96449_8_, p_96449_9_, p_96449_10_);
-    }
-
-    public void func_177138_b(AbstractClientPlayer p_177138_1_)
-    {
-        float var2 = 1.0F;
-        GlStateManager.color(var2, var2, var2);
-        ModelPlayer var3 = this.func_177136_g();
-        this.func_177137_d(p_177138_1_);
-        var3.swingProgress = 0.0F;
-        var3.isSneak = false;
-        var3.setRotationAngles(0.0F, 0.0F, 0.0F, 0.0F, 0.0F, 0.0625F, p_177138_1_);
-        var3.func_178725_a();
-    }
-
-    public void func_177139_c(AbstractClientPlayer p_177139_1_)
-    {
-        float var2 = 1.0F;
-        GlStateManager.color(var2, var2, var2);
-        ModelPlayer var3 = this.func_177136_g();
-        this.func_177137_d(p_177139_1_);
-        var3.isSneak = false;
-        var3.swingProgress = 0.0F;
-        var3.setRotationAngles(0.0F, 0.0F, 0.0F, 0.0F, 0.0F, 0.0625F, p_177139_1_);
-        var3.func_178726_b();
-    }
-
-    /**
-     * Sets a simple glTranslate on a LivingEntity.
-     */
-    protected void renderLivingAt(AbstractClientPlayer p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
-    {
-        if (p_77039_1_.isEntityAlive() && p_77039_1_.isPlayerSleeping())
-        {
-            super.renderLivingAt(p_77039_1_, p_77039_2_ + (double)p_77039_1_.field_71079_bU, p_77039_4_ + (double)p_77039_1_.field_71082_cx, p_77039_6_ + (double)p_77039_1_.field_71089_bV);
-        }
-        else
-        {
-            super.renderLivingAt(p_77039_1_, p_77039_2_, p_77039_4_, p_77039_6_);
-        }
-    }
-
-    protected void func_180595_a(AbstractClientPlayer p_180595_1_, float p_180595_2_, float p_180595_3_, float p_180595_4_)
-    {
-        if (p_180595_1_.isEntityAlive() && p_180595_1_.isPlayerSleeping())
-        {
-            GlStateManager.rotate(p_180595_1_.getBedOrientationInDegrees(), 0.0F, 1.0F, 0.0F);
-            GlStateManager.rotate(this.getDeathMaxRotation(p_180595_1_), 0.0F, 0.0F, 1.0F);
-            GlStateManager.rotate(270.0F, 0.0F, 1.0F, 0.0F);
-        }
-        else
-        {
-            super.rotateCorpse(p_180595_1_, p_180595_2_, p_180595_3_, p_180595_4_);
-        }
-    }
-
-    /**
-     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
-     * entityLiving, partialTickTime
-     */
-    protected void preRenderCallback(EntityLivingBase p_77041_1_, float p_77041_2_)
-    {
-        this.preRenderCallback((AbstractClientPlayer)p_77041_1_, p_77041_2_);
-    }
-
-    protected void rotateCorpse(EntityLivingBase p_77043_1_, float p_77043_2_, float p_77043_3_, float p_77043_4_)
-    {
-        this.func_180595_a((AbstractClientPlayer)p_77043_1_, p_77043_2_, p_77043_3_, p_77043_4_);
-    }
-
-    /**
-     * Sets a simple glTranslate on a LivingEntity.
-     */
-    protected void renderLivingAt(EntityLivingBase p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
-    {
-        this.renderLivingAt((AbstractClientPlayer)p_77039_1_, p_77039_2_, p_77039_4_, p_77039_6_);
-    }
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(EntityLivingBase p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        this.func_180596_a((AbstractClientPlayer)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
-    }
-
-    public ModelBase getMainModel()
-    {
-        return this.func_177136_g();
-    }
-
-    /**
-     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
-     */
-    protected ResourceLocation getEntityTexture(Entity p_110775_1_)
-    {
-        return this.func_180594_a((AbstractClientPlayer)p_110775_1_);
-    }
-
-    protected void func_177069_a(Entity p_177069_1_, double p_177069_2_, double p_177069_4_, double p_177069_6_, String p_177069_8_, float p_177069_9_, double p_177069_10_)
-    {
-        this.renderOffsetLivingLabel((AbstractClientPlayer)p_177069_1_, p_177069_2_, p_177069_4_, p_177069_6_, p_177069_8_, p_177069_9_, p_177069_10_);
-    }
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        this.func_180596_a((AbstractClientPlayer)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
-    }
-}
+package net.minecraft.client.renderer.entity;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.FreecamMod;
+import net.minecraft.client.entity.AbstractClientPlayer;
+import net.minecraft.client.entity.EntityPlayerSP;
+import net.minecraft.client.model.ModelBase;
+import net.minecraft.client.model.ModelPlayer;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.entity.layers.LayerArrow;
+import net.minecraft.client.renderer.entity.layers.LayerBipedArmor;
+import net.minecraft.client.renderer.entity.layers.LayerCape;
+import net.minecraft.client.renderer.entity.layers.LayerCustomHead;
+import net.minecraft.client.renderer.entity.layers.LayerDeadmau5Head;
+import net.minecraft.client.renderer.entity.layers.LayerHeldItem;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.player.EnumPlayerModelParts;
+import net.minecraft.item.EnumAction;
+import net.minecraft.item.ItemStack;
+import net.minecraft.scoreboard.Score;
+import net.minecraft.scoreboard.ScoreObjective;
+import net.minecraft.scoreboard.Scoreboard;
+import net.minecraft.util.ResourceLocation;
+
+public class RenderPlayer extends RendererLivingEntity
+{
+    private boolean field_177140_a;
+    private static final String __OBFID = "CL_00001020";
+
+    public RenderPlayer(RenderManager p_i46102_1_)
+    {
+        this(p_i46102_1_, false);
+    }
+
+    public RenderPlayer(RenderManager p_i46103_1_, boolean p_i46103_2_)
+    {
+        super(p_i46103_1_, new ModelPlayer(0.0F, p_i46103_2_), 0.5F);
+        this.field_177140_a = p_i46103_2_;
+        this.addLayer(new LayerBipedArmor(this));
+        this.addLayer(new LayerHeldItem(this));
+        this.addLayer(new LayerArrow(this));
+        this.addLayer(new LayerDeadmau5Head(this));
+        this.addLayer(new LayerCape(this));
+        this.addLayer(new LayerCustomHead(this.func_177136_g().bipedHead));
+    }
+
+    public ModelPlayer func_177136_g()
+    {
+        return (ModelPlayer)super.getMainModel();
+    }
+
+    public void func_180596_a(AbstractClientPlayer p_180596_1_, double p_180596_2_, double p_180596_4_, double p_180596_6_, float p_180596_8_, float p_180596_9_)
+    {
+        if (!p_180596_1_.func_175144_cb() || this.renderManager.livingPlayer == p_180596_1_)
+        {
+            double var10 = p_180596_4_;
+
+            if (p_180596_1_.isSneaking() && !(p_180596_1_ instanceof EntityPlayerSP))
+            {
+                var10 = p_180596_4_ - 0.125D;
+            }
+
+            this.func_177137_d(p_180596_1_);
+            super.doRender((EntityLivingBase)p_180596_1_, p_180596_2_, var10, p_180596_6_, p_180596_8_, p_180596_9_);
+        }
+    }
+
+    private void func_177137_d(AbstractClientPlayer p_177137_1_)
+    {
+        ModelPlayer var2 = this.func_177136_g();
+
+        //TODO: Client
+        if (p_177137_1_.isSpectator() && !WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled())
+        {
+            var2.func_178719_a(false);
+            var2.bipedHead.showModel = true;
+            var2.bipedHeadwear.showModel = true;
+        }
+        else
+        {
+            ItemStack var3 = p_177137_1_.inventory.getCurrentItem();
+            var2.func_178719_a(true);
+            var2.bipedHeadwear.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.HAT);
+            var2.field_178730_v.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.JACKET);
+            var2.field_178733_c.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.LEFT_PANTS_LEG);
+            var2.field_178731_d.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.RIGHT_PANTS_LEG);
+            var2.field_178734_a.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.LEFT_SLEEVE);
+            var2.field_178732_b.showModel = p_177137_1_.func_175148_a(EnumPlayerModelParts.RIGHT_SLEEVE);
+            var2.heldItemLeft = 0;
+            var2.aimedBow = false;
+            var2.isSneak = p_177137_1_.isSneaking();
+
+            if (var3 == null)
+            {
+                var2.heldItemRight = 0;
+            }
+            else
+            {
+                var2.heldItemRight = 1;
+
+                if (p_177137_1_.getItemInUseCount() > 0)
+                {
+                    EnumAction var4 = var3.getItemUseAction();
+
+                    if (var4 == EnumAction.BLOCK)
+                    {
+                        var2.heldItemRight = 3;
+                    }
+                    else if (var4 == EnumAction.BOW)
+                    {
+                        var2.aimedBow = true;
+                    }
+                }
+            }
+        }
+    }
+
+    protected ResourceLocation func_180594_a(AbstractClientPlayer p_180594_1_)
+    {
+        return p_180594_1_.getLocationSkin();
+    }
+
+    public void func_82422_c()
+    {
+        GlStateManager.translate(0.0F, 0.1875F, 0.0F);
+    }
+
+    /**
+     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
+     * entityLiving, partialTickTime
+     */
+    protected void preRenderCallback(AbstractClientPlayer p_77041_1_, float p_77041_2_)
+    {
+        float var3 = 0.9375F;
+        GlStateManager.scale(var3, var3, var3);
+    }
+
+    protected void renderOffsetLivingLabel(AbstractClientPlayer p_96449_1_, double p_96449_2_, double p_96449_4_, double p_96449_6_, String p_96449_8_, float p_96449_9_, double p_96449_10_)
+    {
+        if (p_96449_10_ < 100.0D)
+        {
+            Scoreboard var12 = p_96449_1_.getWorldScoreboard();
+            ScoreObjective var13 = var12.getObjectiveInDisplaySlot(2);
+
+            if (var13 != null)
+            {
+                Score var14 = var12.getValueFromObjective(p_96449_1_.getName(), var13);
+                this.renderLivingLabel(p_96449_1_, var14.getScorePoints() + " " + var13.getDisplayName(), p_96449_2_, p_96449_4_, p_96449_6_, 64);
+                p_96449_4_ += (double)((float)this.getFontRendererFromRenderManager().FONT_HEIGHT * 1.15F * p_96449_9_);
+            }
+        }
+
+        super.func_177069_a(p_96449_1_, p_96449_2_, p_96449_4_, p_96449_6_, p_96449_8_, p_96449_9_, p_96449_10_);
+    }
+
+    public void func_177138_b(AbstractClientPlayer p_177138_1_)
+    {
+        float var2 = 1.0F;
+        GlStateManager.color(var2, var2, var2);
+        ModelPlayer var3 = this.func_177136_g();
+        this.func_177137_d(p_177138_1_);
+        var3.swingProgress = 0.0F;
+        var3.isSneak = false;
+        var3.setRotationAngles(0.0F, 0.0F, 0.0F, 0.0F, 0.0F, 0.0625F, p_177138_1_);
+        var3.func_178725_a();
+    }
+
+    public void func_177139_c(AbstractClientPlayer p_177139_1_)
+    {
+        float var2 = 1.0F;
+        GlStateManager.color(var2, var2, var2);
+        ModelPlayer var3 = this.func_177136_g();
+        this.func_177137_d(p_177139_1_);
+        var3.isSneak = false;
+        var3.swingProgress = 0.0F;
+        var3.setRotationAngles(0.0F, 0.0F, 0.0F, 0.0F, 0.0F, 0.0625F, p_177139_1_);
+        var3.func_178726_b();
+    }
+
+    /**
+     * Sets a simple glTranslate on a LivingEntity.
+     */
+    protected void renderLivingAt(AbstractClientPlayer p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
+    {
+        if (p_77039_1_.isEntityAlive() && p_77039_1_.isPlayerSleeping())
+        {
+            super.renderLivingAt(p_77039_1_, p_77039_2_ + (double)p_77039_1_.field_71079_bU, p_77039_4_ + (double)p_77039_1_.field_71082_cx, p_77039_6_ + (double)p_77039_1_.field_71089_bV);
+        }
+        else
+        {
+            super.renderLivingAt(p_77039_1_, p_77039_2_, p_77039_4_, p_77039_6_);
+        }
+    }
+
+    protected void func_180595_a(AbstractClientPlayer p_180595_1_, float p_180595_2_, float p_180595_3_, float p_180595_4_)
+    {
+        if (p_180595_1_.isEntityAlive() && p_180595_1_.isPlayerSleeping())
+        {
+            GlStateManager.rotate(p_180595_1_.getBedOrientationInDegrees(), 0.0F, 1.0F, 0.0F);
+            GlStateManager.rotate(this.getDeathMaxRotation(p_180595_1_), 0.0F, 0.0F, 1.0F);
+            GlStateManager.rotate(270.0F, 0.0F, 1.0F, 0.0F);
+        }
+        else
+        {
+            super.rotateCorpse(p_180595_1_, p_180595_2_, p_180595_3_, p_180595_4_);
+        }
+    }
+
+    /**
+     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
+     * entityLiving, partialTickTime
+     */
+    protected void preRenderCallback(EntityLivingBase p_77041_1_, float p_77041_2_)
+    {
+        this.preRenderCallback((AbstractClientPlayer)p_77041_1_, p_77041_2_);
+    }
+
+    protected void rotateCorpse(EntityLivingBase p_77043_1_, float p_77043_2_, float p_77043_3_, float p_77043_4_)
+    {
+        this.func_180595_a((AbstractClientPlayer)p_77043_1_, p_77043_2_, p_77043_3_, p_77043_4_);
+    }
+
+    /**
+     * Sets a simple glTranslate on a LivingEntity.
+     */
+    protected void renderLivingAt(EntityLivingBase p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
+    {
+        this.renderLivingAt((AbstractClientPlayer)p_77039_1_, p_77039_2_, p_77039_4_, p_77039_6_);
+    }
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(EntityLivingBase p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        this.func_180596_a((AbstractClientPlayer)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
+    }
+
+    public ModelBase getMainModel()
+    {
+        return this.func_177136_g();
+    }
+
+    /**
+     * Returns the location of an entity's texture. Doesn't seem to be called unless you call Render.bindEntityTexture.
+     */
+    protected ResourceLocation getEntityTexture(Entity p_110775_1_)
+    {
+        return this.func_180594_a((AbstractClientPlayer)p_110775_1_);
+    }
+
+    protected void func_177069_a(Entity p_177069_1_, double p_177069_2_, double p_177069_4_, double p_177069_6_, String p_177069_8_, float p_177069_9_, double p_177069_10_)
+    {
+        this.renderOffsetLivingLabel((AbstractClientPlayer)p_177069_1_, p_177069_2_, p_177069_4_, p_177069_6_, p_177069_8_, p_177069_9_, p_177069_10_);
+    }
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        this.func_180596_a((AbstractClientPlayer)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
+    }
+}
diff --git a/src/net/minecraft/client/renderer/entity/RenderXPOrb.java b/src/net/minecraft/client/renderer/entity/RenderXPOrb.java
index 7bcac52..fb3ac3e 100644
--- a/src/net/minecraft/client/renderer/entity/RenderXPOrb.java
+++ b/src/net/minecraft/client/renderer/entity/RenderXPOrb.java
@@ -58,7 +58,7 @@ public class RenderXPOrb extends Render
         Tessellator var25 = Tessellator.getInstance();
         WorldRenderer var26 = var25.getWorldRenderer();
         var26.startDrawingQuads();
-        var26.func_178974_a(var23, 128);
+        var26.setColorRGBA_I(var23, 128);
         var26.func_178980_d(0.0F, 1.0F, 0.0F);
         var26.addVertexWithUV((double)(0.0F - var16), (double)(0.0F - var17), 0.0D, (double)var11, (double)var14);
         var26.addVertexWithUV((double)(var15 - var16), (double)(0.0F - var17), 0.0D, (double)var12, (double)var14);
diff --git a/src/net/minecraft/client/renderer/entity/RendererLivingEntity.java b/src/net/minecraft/client/renderer/entity/RendererLivingEntity.java
index 8703f17..072ab7f 100644
--- a/src/net/minecraft/client/renderer/entity/RendererLivingEntity.java
+++ b/src/net/minecraft/client/renderer/entity/RendererLivingEntity.java
@@ -1,678 +1,685 @@
-package net.minecraft.client.renderer.entity;
-
-import com.google.common.collect.Lists;
-import java.nio.FloatBuffer;
-import java.util.Iterator;
-import java.util.List;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.entity.EntityPlayerSP;
-import net.minecraft.client.gui.FontRenderer;
-import net.minecraft.client.model.ModelBase;
-import net.minecraft.client.renderer.GLAllocation;
-import net.minecraft.client.renderer.GlStateManager;
-import net.minecraft.client.renderer.OpenGlHelper;
-import net.minecraft.client.renderer.Tessellator;
-import net.minecraft.client.renderer.WorldRenderer;
-import net.minecraft.client.renderer.entity.layers.LayerRenderer;
-import net.minecraft.client.renderer.texture.DynamicTexture;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.entity.player.EnumPlayerModelParts;
-import net.minecraft.scoreboard.ScorePlayerTeam;
-import net.minecraft.scoreboard.Team;
-import net.minecraft.util.EnumChatFormatting;
-import net.minecraft.util.MathHelper;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.lwjgl.opengl.GL11;
-
-public abstract class RendererLivingEntity extends Render
-{
-    private static final Logger logger = LogManager.getLogger();
-    private static final DynamicTexture field_177096_e = new DynamicTexture(16, 16);
-    protected ModelBase mainModel;
-    protected FloatBuffer field_177095_g = GLAllocation.createDirectFloatBuffer(4);
-    protected List field_177097_h = Lists.newArrayList();
-    protected boolean field_177098_i = false;
-    private static final String __OBFID = "CL_00001012";
-
-    public RendererLivingEntity(RenderManager p_i46156_1_, ModelBase p_i46156_2_, float p_i46156_3_)
-    {
-        super(p_i46156_1_);
-        this.mainModel = p_i46156_2_;
-        this.shadowSize = p_i46156_3_;
-    }
-
-    protected boolean addLayer(LayerRenderer p_177094_1_)
-    {
-        return this.field_177097_h.add(p_177094_1_);
-    }
-
-    protected boolean func_177089_b(LayerRenderer p_177089_1_)
-    {
-        return this.field_177097_h.remove(p_177089_1_);
-    }
-
-    public ModelBase getMainModel()
-    {
-        return this.mainModel;
-    }
-
-    /**
-     * Returns a rotation angle that is inbetween two other rotation angles. par1 and par2 are the angles between which
-     * to interpolate, par3 is probably a float between 0.0 and 1.0 that tells us where "between" the two angles we are.
-     * Example: par1 = 30, par2 = 50, par3 = 0.5, then return = 40
-     */
-    protected float interpolateRotation(float p_77034_1_, float p_77034_2_, float p_77034_3_)
-    {
-        float var4;
-
-        for (var4 = p_77034_2_ - p_77034_1_; var4 < -180.0F; var4 += 360.0F)
-        {
-            ;
-        }
-
-        while (var4 >= 180.0F)
-        {
-            var4 -= 360.0F;
-        }
-
-        return p_77034_1_ + p_77034_3_ * var4;
-    }
-
-    public void func_82422_c() {}
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(EntityLivingBase p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        GlStateManager.pushMatrix();
-        GlStateManager.disableCull();
-        this.mainModel.swingProgress = this.getSwingProgress(p_76986_1_, p_76986_9_);
-        this.mainModel.isRiding = p_76986_1_.isRiding();
-        this.mainModel.isChild = p_76986_1_.isChild();
-
-        try
-        {
-            float var10 = this.interpolateRotation(p_76986_1_.prevRenderYawOffset, p_76986_1_.renderYawOffset, p_76986_9_);
-            float var11 = this.interpolateRotation(p_76986_1_.prevRotationYawHead, p_76986_1_.rotationYawHead, p_76986_9_);
-            float var12 = var11 - var10;
-            float var14;
-
-            if (p_76986_1_.isRiding() && p_76986_1_.ridingEntity instanceof EntityLivingBase)
-            {
-                EntityLivingBase var13 = (EntityLivingBase)p_76986_1_.ridingEntity;
-                var10 = this.interpolateRotation(var13.prevRenderYawOffset, var13.renderYawOffset, p_76986_9_);
-                var12 = var11 - var10;
-                var14 = MathHelper.wrapAngleTo180_float(var12);
-
-                if (var14 < -85.0F)
-                {
-                    var14 = -85.0F;
-                }
-
-                if (var14 >= 85.0F)
-                {
-                    var14 = 85.0F;
-                }
-
-                var10 = var11 - var14;
-
-                if (var14 * var14 > 2500.0F)
-                {
-                    var10 += var14 * 0.2F;
-                }
-            }
-
-            float var20 = p_76986_1_.prevRotationPitch + (p_76986_1_.rotationPitch - p_76986_1_.prevRotationPitch) * p_76986_9_;
-            this.renderLivingAt(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_);
-            var14 = this.handleRotationFloat(p_76986_1_, p_76986_9_);
-            this.rotateCorpse(p_76986_1_, var14, var10, p_76986_9_);
-            GlStateManager.enableRescaleNormal();
-            GlStateManager.scale(-1.0F, -1.0F, 1.0F);
-            this.preRenderCallback(p_76986_1_, p_76986_9_);
-            float var15 = 0.0625F;
-            GlStateManager.translate(0.0F, -1.5078125F, 0.0F);
-            float var16 = p_76986_1_.prevLimbSwingAmount + (p_76986_1_.limbSwingAmount - p_76986_1_.prevLimbSwingAmount) * p_76986_9_;
-            float var17 = p_76986_1_.limbSwing - p_76986_1_.limbSwingAmount * (1.0F - p_76986_9_);
-
-            if (p_76986_1_.isChild())
-            {
-                var17 *= 3.0F;
-            }
-
-            if (var16 > 1.0F)
-            {
-                var16 = 1.0F;
-            }
-
-            GlStateManager.enableAlpha();
-            this.mainModel.setLivingAnimations(p_76986_1_, var17, var16, p_76986_9_);
-            this.mainModel.setRotationAngles(var17, var16, var14, var12, var20, 0.0625F, p_76986_1_);
-            boolean var18;
-
-            if (this.field_177098_i)
-            {
-                var18 = this.func_177088_c(p_76986_1_);
-                this.renderModel(p_76986_1_, var17, var16, var14, var12, var20, 0.0625F);
-
-                if (var18)
-                {
-                    this.func_180565_e();
-                }
-            }
-            else
-            {
-                var18 = this.func_177090_c(p_76986_1_, p_76986_9_);
-                this.renderModel(p_76986_1_, var17, var16, var14, var12, var20, 0.0625F);
-
-                if (var18)
-                {
-                    this.func_177091_f();
-                }
-
-                GlStateManager.depthMask(true);
-
-                if (!(p_76986_1_ instanceof EntityPlayer) || !((EntityPlayer)p_76986_1_).func_175149_v())
-                {
-                    this.func_177093_a(p_76986_1_, var17, var16, p_76986_9_, var14, var12, var20, 0.0625F);
-                }
-            }
-
-            GlStateManager.disableRescaleNormal();
-        }
-        catch (Exception var19)
-        {
-            logger.error("Couldn\'t render entity", var19);
-        }
-
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GlStateManager.func_179098_w();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-        GlStateManager.enableCull();
-        GlStateManager.popMatrix();
-
-        if (!this.field_177098_i)
-        {
-            super.doRender(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
-        }
-    }
-
-    protected boolean func_177088_c(EntityLivingBase p_177088_1_)
-    {
-        int var2 = 16777215;
-
-        if (p_177088_1_ instanceof EntityPlayer)
-        {
-            ScorePlayerTeam var3 = (ScorePlayerTeam)p_177088_1_.getTeam();
-
-            if (var3 != null)
-            {
-                String var4 = FontRenderer.getFormatFromString(var3.getColorPrefix());
-
-                if (var4.length() >= 2)
-                {
-                    var2 = this.getFontRendererFromRenderManager().func_175064_b(var4.charAt(1));
-                }
-            }
-        }
-
-        float var6 = (float)(var2 >> 16 & 255) / 255.0F;
-        float var7 = (float)(var2 >> 8 & 255) / 255.0F;
-        float var5 = (float)(var2 & 255) / 255.0F;
-        GlStateManager.disableLighting();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-        GlStateManager.color(var6, var7, var5, 1.0F);
-        GlStateManager.func_179090_x();
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GlStateManager.func_179090_x();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-        return true;
-    }
-
-    protected void func_180565_e()
-    {
-        GlStateManager.enableLighting();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-        GlStateManager.func_179098_w();
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GlStateManager.func_179098_w();
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-    }
-
-    /**
-     * Renders the model in RenderLiving
-     */
-    protected void renderModel(EntityLivingBase p_77036_1_, float p_77036_2_, float p_77036_3_, float p_77036_4_, float p_77036_5_, float p_77036_6_, float p_77036_7_)
-    {
-        boolean var8 = !p_77036_1_.isInvisible();
-        boolean var9 = !var8 && !p_77036_1_.isInvisibleToPlayer(Minecraft.getMinecraft().thePlayer);
-
-        if (var8 || var9)
-        {
-            if (!this.bindEntityTexture(p_77036_1_))
-            {
-                return;
-            }
-
-            if (var9)
-            {
-                GlStateManager.pushMatrix();
-                GlStateManager.color(1.0F, 1.0F, 1.0F, 0.15F);
-                GlStateManager.depthMask(false);
-                GlStateManager.enableBlend();
-                GlStateManager.blendFunc(770, 771);
-                GlStateManager.alphaFunc(516, 0.003921569F);
-            }
-
-            this.mainModel.render(p_77036_1_, p_77036_2_, p_77036_3_, p_77036_4_, p_77036_5_, p_77036_6_, p_77036_7_);
-
-            if (var9)
-            {
-                GlStateManager.disableBlend();
-                GlStateManager.alphaFunc(516, 0.1F);
-                GlStateManager.popMatrix();
-                GlStateManager.depthMask(true);
-            }
-        }
-    }
-
-    protected boolean func_177090_c(EntityLivingBase p_177090_1_, float p_177090_2_)
-    {
-        return this.func_177092_a(p_177090_1_, p_177090_2_, true);
-    }
-
-    protected boolean func_177092_a(EntityLivingBase p_177092_1_, float p_177092_2_, boolean p_177092_3_)
-    {
-        float var4 = p_177092_1_.getBrightness(p_177092_2_);
-        int var5 = this.getColorMultiplier(p_177092_1_, var4, p_177092_2_);
-        boolean var6 = (var5 >> 24 & 255) > 0;
-        boolean var7 = p_177092_1_.hurtTime > 0 || p_177092_1_.deathTime > 0;
-
-        if (!var6 && !var7)
-        {
-            return false;
-        }
-        else if (!var6 && !p_177092_3_)
-        {
-            return false;
-        }
-        else
-        {
-            GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-            GlStateManager.func_179098_w();
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.defaultTexUnit);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176093_u);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.defaultTexUnit);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-            GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-            GlStateManager.func_179098_w();
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, OpenGlHelper.field_176094_t);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.field_176092_v);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176080_A, OpenGlHelper.field_176092_v);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176076_D, GL11.GL_SRC_ALPHA);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.field_176091_w);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-            this.field_177095_g.position(0);
-
-            if (var7)
-            {
-                this.field_177095_g.put(1.0F);
-                this.field_177095_g.put(0.0F);
-                this.field_177095_g.put(0.0F);
-                this.field_177095_g.put(0.3F);
-            }
-            else
-            {
-                float var8 = (float)(var5 >> 24 & 255) / 255.0F;
-                float var9 = (float)(var5 >> 16 & 255) / 255.0F;
-                float var10 = (float)(var5 >> 8 & 255) / 255.0F;
-                float var11 = (float)(var5 & 255) / 255.0F;
-                this.field_177095_g.put(var9);
-                this.field_177095_g.put(var10);
-                this.field_177095_g.put(var11);
-                this.field_177095_g.put(1.0F - var8);
-            }
-
-            this.field_177095_g.flip();
-            GL11.glTexEnv(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_COLOR, this.field_177095_g);
-            GlStateManager.setActiveTexture(OpenGlHelper.field_176096_r);
-            GlStateManager.func_179098_w();
-            GlStateManager.func_179144_i(field_177096_e.getGlTextureId());
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.field_176091_w);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.lightmapTexUnit);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.field_176091_w);
-            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-            GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-            return true;
-        }
-    }
-
-    protected void func_177091_f()
-    {
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-        GlStateManager.func_179098_w();
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.defaultTexUnit);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176093_u);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.defaultTexUnit);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176079_G, OpenGlHelper.field_176093_u);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176086_J, GL11.GL_SRC_ALPHA);
-        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, GL11.GL_TEXTURE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, GL11.GL_TEXTURE);
-        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-        GlStateManager.setActiveTexture(OpenGlHelper.field_176096_r);
-        GlStateManager.func_179090_x();
-        GlStateManager.func_179144_i(0);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, GL11.GL_TEXTURE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
-        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, GL11.GL_TEXTURE);
-        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
-    }
-
-    /**
-     * Sets a simple glTranslate on a LivingEntity.
-     */
-    protected void renderLivingAt(EntityLivingBase p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
-    {
-        GlStateManager.translate((float)p_77039_2_, (float)p_77039_4_, (float)p_77039_6_);
-    }
-
-    protected void rotateCorpse(EntityLivingBase p_77043_1_, float p_77043_2_, float p_77043_3_, float p_77043_4_)
-    {
-        GlStateManager.rotate(180.0F - p_77043_3_, 0.0F, 1.0F, 0.0F);
-
-        if (p_77043_1_.deathTime > 0)
-        {
-            float var5 = ((float)p_77043_1_.deathTime + p_77043_4_ - 1.0F) / 20.0F * 1.6F;
-            var5 = MathHelper.sqrt_float(var5);
-
-            if (var5 > 1.0F)
-            {
-                var5 = 1.0F;
-            }
-
-            GlStateManager.rotate(var5 * this.getDeathMaxRotation(p_77043_1_), 0.0F, 0.0F, 1.0F);
-        }
-        else
-        {
-            String var6 = EnumChatFormatting.getTextWithoutFormattingCodes(p_77043_1_.getName());
-
-            if (var6 != null && (var6.equals("Dinnerbone") || var6.equals("Grumm")) && (!(p_77043_1_ instanceof EntityPlayer) || ((EntityPlayer)p_77043_1_).func_175148_a(EnumPlayerModelParts.CAPE)))
-            {
-                GlStateManager.translate(0.0F, p_77043_1_.height + 0.1F, 0.0F);
-                GlStateManager.rotate(180.0F, 0.0F, 0.0F, 1.0F);
-            }
-        }
-    }
-
-    /**
-     * Returns where in the swing animation the living entity is (from 0 to 1).  Args : entity, partialTickTime
-     */
-    protected float getSwingProgress(EntityLivingBase p_77040_1_, float p_77040_2_)
-    {
-        return p_77040_1_.getSwingProgress(p_77040_2_);
-    }
-
-    /**
-     * Defines what float the third param in setRotationAngles of ModelBase is
-     */
-    protected float handleRotationFloat(EntityLivingBase p_77044_1_, float p_77044_2_)
-    {
-        return (float)p_77044_1_.ticksExisted + p_77044_2_;
-    }
-
-    protected void func_177093_a(EntityLivingBase p_177093_1_, float p_177093_2_, float p_177093_3_, float p_177093_4_, float p_177093_5_, float p_177093_6_, float p_177093_7_, float p_177093_8_)
-    {
-        Iterator var9 = this.field_177097_h.iterator();
-
-        while (var9.hasNext())
-        {
-            LayerRenderer var10 = (LayerRenderer)var9.next();
-            boolean var11 = this.func_177092_a(p_177093_1_, p_177093_4_, var10.shouldCombineTextures());
-            var10.doRenderLayer(p_177093_1_, p_177093_2_, p_177093_3_, p_177093_4_, p_177093_5_, p_177093_6_, p_177093_7_, p_177093_8_);
-
-            if (var11)
-            {
-                this.func_177091_f();
-            }
-        }
-    }
-
-    protected float getDeathMaxRotation(EntityLivingBase p_77037_1_)
-    {
-        return 90.0F;
-    }
-
-    /**
-     * Returns an ARGB int color back. Args: entityLiving, lightBrightness, partialTickTime
-     */
-    protected int getColorMultiplier(EntityLivingBase p_77030_1_, float p_77030_2_, float p_77030_3_)
-    {
-        return 0;
-    }
-
-    /**
-     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
-     * entityLiving, partialTickTime
-     */
-    protected void preRenderCallback(EntityLivingBase p_77041_1_, float p_77041_2_) {}
-
-    /**
-     * Passes the specialRender and renders it
-     */
-    public void passSpecialRender(EntityLivingBase p_77033_1_, double p_77033_2_, double p_77033_4_, double p_77033_6_)
-    {
-        if (this.canRenderName(p_77033_1_))
-        {
-            double var8 = p_77033_1_.getDistanceSqToEntity(this.renderManager.livingPlayer);
-            float var10 = p_77033_1_.isSneaking() ? 32.0F : 64.0F;
-
-            if (var8 < (double)(var10 * var10))
-            {
-                String var11 = p_77033_1_.getDisplayName().getFormattedText();
-                float var12 = 0.02666667F;
-                GlStateManager.alphaFunc(516, 0.1F);
-
-                if (p_77033_1_.isSneaking())
-                {
-                    FontRenderer var13 = this.getFontRendererFromRenderManager();
-                    GlStateManager.pushMatrix();
-                    GlStateManager.translate((float)p_77033_2_, (float)p_77033_4_ + p_77033_1_.height + 0.5F - (p_77033_1_.isChild() ? p_77033_1_.height / 2.0F : 0.0F), (float)p_77033_6_);
-                    GL11.glNormal3f(0.0F, 1.0F, 0.0F);
-                    GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
-                    GlStateManager.rotate(this.renderManager.playerViewX, 1.0F, 0.0F, 0.0F);
-                    GlStateManager.scale(-0.02666667F, -0.02666667F, 0.02666667F);
-                    GlStateManager.translate(0.0F, 9.374999F, 0.0F);
-                    GlStateManager.disableLighting();
-                    GlStateManager.depthMask(false);
-                    GlStateManager.enableBlend();
-                    GlStateManager.func_179090_x();
-                    GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
-                    Tessellator var14 = Tessellator.getInstance();
-                    WorldRenderer var15 = var14.getWorldRenderer();
-                    var15.startDrawingQuads();
-                    int var16 = var13.getStringWidth(var11) / 2;
-                    var15.func_178960_a(0.0F, 0.0F, 0.0F, 0.25F);
-                    var15.addVertex((double)(-var16 - 1), -1.0D, 0.0D);
-                    var15.addVertex((double)(-var16 - 1), 8.0D, 0.0D);
-                    var15.addVertex((double)(var16 + 1), 8.0D, 0.0D);
-                    var15.addVertex((double)(var16 + 1), -1.0D, 0.0D);
-                    var14.draw();
-                    GlStateManager.func_179098_w();
-                    GlStateManager.depthMask(true);
-                    var13.drawString(var11, -var13.getStringWidth(var11) / 2, 0, 553648127);
-                    GlStateManager.enableLighting();
-                    GlStateManager.disableBlend();
-                    GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
-                    GlStateManager.popMatrix();
-                }
-                else
-                {
-                    this.func_177069_a(p_77033_1_, p_77033_2_, p_77033_4_ - (p_77033_1_.isChild() ? (double)(p_77033_1_.height / 2.0F) : 0.0D), p_77033_6_, var11, 0.02666667F, var8);
-                }
-            }
-        }
-    }
-
-    /**
-     * Test if the entity name must be rendered
-     */
-    protected boolean canRenderName(EntityLivingBase targetEntity)
-    {
-        EntityPlayerSP var2 = Minecraft.getMinecraft().thePlayer;
-
-        if (targetEntity instanceof EntityPlayer && targetEntity != var2)
-        {
-            Team var3 = targetEntity.getTeam();
-            Team var4 = var2.getTeam();
-
-            if (var3 != null)
-            {
-                Team.EnumVisible var5 = var3.func_178770_i();
-
-                switch (RendererLivingEntity.SwitchEnumVisible.field_178679_a[var5.ordinal()])
-                {
-                    case 1:
-                        return true;
-
-                    case 2:
-                        return false;
-
-                    case 3:
-                        return var4 == null || var3.isSameTeam(var4);
-
-                    case 4:
-                        return var4 == null || !var3.isSameTeam(var4);
-
-                    default:
-                        return true;
-                }
-            }
-        }
-
-        return Minecraft.isGuiEnabled() && targetEntity != this.renderManager.livingPlayer && !targetEntity.isInvisibleToPlayer(var2) && targetEntity.riddenByEntity == null;
-    }
-
-    public void func_177086_a(boolean p_177086_1_)
-    {
-        this.field_177098_i = p_177086_1_;
-    }
-
-    protected boolean func_177070_b(Entity p_177070_1_)
-    {
-        return this.canRenderName((EntityLivingBase)p_177070_1_);
-    }
-
-    public void func_177067_a(Entity p_177067_1_, double p_177067_2_, double p_177067_4_, double p_177067_6_)
-    {
-        this.passSpecialRender((EntityLivingBase)p_177067_1_, p_177067_2_, p_177067_4_, p_177067_6_);
-    }
-
-    /**
-     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
-     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
-     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
-     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
-     */
-    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
-    {
-        this.doRender((EntityLivingBase)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
-    }
-
-    static
-    {
-        int[] var0 = field_177096_e.getTextureData();
-
-        for (int var1 = 0; var1 < 256; ++var1)
-        {
-            var0[var1] = -1;
-        }
-
-        field_177096_e.updateDynamicTexture();
-    }
-
-    static final class SwitchEnumVisible
-    {
-        static final int[] field_178679_a = new int[Team.EnumVisible.values().length];
-        private static final String __OBFID = "CL_00002435";
-
-        static
-        {
-            try
-            {
-                field_178679_a[Team.EnumVisible.ALWAYS.ordinal()] = 1;
-            }
-            catch (NoSuchFieldError var4)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178679_a[Team.EnumVisible.NEVER.ordinal()] = 2;
-            }
-            catch (NoSuchFieldError var3)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178679_a[Team.EnumVisible.HIDE_FOR_OTHER_TEAMS.ordinal()] = 3;
-            }
-            catch (NoSuchFieldError var2)
-            {
-                ;
-            }
-
-            try
-            {
-                field_178679_a[Team.EnumVisible.HIDE_FOR_OWN_TEAM.ordinal()] = 4;
-            }
-            catch (NoSuchFieldError var1)
-            {
-                ;
-            }
-        }
-    }
-}
+package net.minecraft.client.renderer.entity;
+
+import com.google.common.collect.Lists;
+
+import java.nio.FloatBuffer;
+import java.util.Iterator;
+import java.util.List;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.entity.EntityPlayerSP;
+import net.minecraft.client.gui.FontRenderer;
+import net.minecraft.client.model.ModelBase;
+import net.minecraft.client.renderer.GLAllocation;
+import net.minecraft.client.renderer.GlStateManager;
+import net.minecraft.client.renderer.OpenGlHelper;
+import net.minecraft.client.renderer.Tessellator;
+import net.minecraft.client.renderer.WorldRenderer;
+import net.minecraft.client.renderer.entity.layers.LayerRenderer;
+import net.minecraft.client.renderer.texture.DynamicTexture;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.EnumPlayerModelParts;
+import net.minecraft.scoreboard.ScorePlayerTeam;
+import net.minecraft.scoreboard.Team;
+import net.minecraft.util.EnumChatFormatting;
+import net.minecraft.util.MathHelper;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.lwjgl.opengl.GL11;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.TrueSightMod;
+
+public abstract class RendererLivingEntity extends Render
+{
+    private static final Logger logger = LogManager.getLogger();
+    private static final DynamicTexture field_177096_e = new DynamicTexture(16, 16);
+    protected ModelBase mainModel;
+    protected FloatBuffer field_177095_g = GLAllocation.createDirectFloatBuffer(4);
+    protected List field_177097_h = Lists.newArrayList();
+    protected boolean field_177098_i = false;
+    private static final String __OBFID = "CL_00001012";
+
+    public RendererLivingEntity(RenderManager p_i46156_1_, ModelBase p_i46156_2_, float p_i46156_3_)
+    {
+        super(p_i46156_1_);
+        this.mainModel = p_i46156_2_;
+        this.shadowSize = p_i46156_3_;
+    }
+
+    protected boolean addLayer(LayerRenderer p_177094_1_)
+    {
+        return this.field_177097_h.add(p_177094_1_);
+    }
+
+    protected boolean func_177089_b(LayerRenderer p_177089_1_)
+    {
+        return this.field_177097_h.remove(p_177089_1_);
+    }
+
+    public ModelBase getMainModel()
+    {
+        return this.mainModel;
+    }
+
+    /**
+     * Returns a rotation angle that is inbetween two other rotation angles. par1 and par2 are the angles between which
+     * to interpolate, par3 is probably a float between 0.0 and 1.0 that tells us where "between" the two angles we are.
+     * Example: par1 = 30, par2 = 50, par3 = 0.5, then return = 40
+     */
+    protected float interpolateRotation(float p_77034_1_, float p_77034_2_, float p_77034_3_)
+    {
+        float var4;
+
+        for (var4 = p_77034_2_ - p_77034_1_; var4 < -180.0F; var4 += 360.0F)
+        {
+            ;
+        }
+
+        while (var4 >= 180.0F)
+        {
+            var4 -= 360.0F;
+        }
+
+        return p_77034_1_ + p_77034_3_ * var4;
+    }
+
+    public void func_82422_c() {}
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(EntityLivingBase p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        GlStateManager.pushMatrix();
+        GlStateManager.disableCull();
+        this.mainModel.swingProgress = this.getSwingProgress(p_76986_1_, p_76986_9_);
+        this.mainModel.isRiding = p_76986_1_.isRiding();
+        this.mainModel.isChild = p_76986_1_.isChild();
+
+        try
+        {
+            float var10 = this.interpolateRotation(p_76986_1_.prevRenderYawOffset, p_76986_1_.renderYawOffset, p_76986_9_);
+            float var11 = this.interpolateRotation(p_76986_1_.prevRotationYawHead, p_76986_1_.rotationYawHead, p_76986_9_);
+            float var12 = var11 - var10;
+            float var14;
+
+            if (p_76986_1_.isRiding() && p_76986_1_.ridingEntity instanceof EntityLivingBase)
+            {
+                EntityLivingBase var13 = (EntityLivingBase)p_76986_1_.ridingEntity;
+                var10 = this.interpolateRotation(var13.prevRenderYawOffset, var13.renderYawOffset, p_76986_9_);
+                var12 = var11 - var10;
+                var14 = MathHelper.wrapAngleTo180_float(var12);
+
+                if (var14 < -85.0F)
+                {
+                    var14 = -85.0F;
+                }
+
+                if (var14 >= 85.0F)
+                {
+                    var14 = 85.0F;
+                }
+
+                var10 = var11 - var14;
+
+                if (var14 * var14 > 2500.0F)
+                {
+                    var10 += var14 * 0.2F;
+                }
+            }
+
+            float var20 = p_76986_1_.prevRotationPitch + (p_76986_1_.rotationPitch - p_76986_1_.prevRotationPitch) * p_76986_9_;
+            this.renderLivingAt(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_);
+            var14 = this.handleRotationFloat(p_76986_1_, p_76986_9_);
+            this.rotateCorpse(p_76986_1_, var14, var10, p_76986_9_);
+            GlStateManager.enableRescaleNormal();
+            GlStateManager.scale(-1.0F, -1.0F, 1.0F);
+            this.preRenderCallback(p_76986_1_, p_76986_9_);
+            float var15 = 0.0625F;
+            GlStateManager.translate(0.0F, -1.5078125F, 0.0F);
+            float var16 = p_76986_1_.prevLimbSwingAmount + (p_76986_1_.limbSwingAmount - p_76986_1_.prevLimbSwingAmount) * p_76986_9_;
+            float var17 = p_76986_1_.limbSwing - p_76986_1_.limbSwingAmount * (1.0F - p_76986_9_);
+
+            if (p_76986_1_.isChild())
+            {
+                var17 *= 3.0F;
+            }
+
+            if (var16 > 1.0F)
+            {
+                var16 = 1.0F;
+            }
+
+            GlStateManager.enableAlpha();
+            this.mainModel.setLivingAnimations(p_76986_1_, var17, var16, p_76986_9_);
+            this.mainModel.setRotationAngles(var17, var16, var14, var12, var20, 0.0625F, p_76986_1_);
+            boolean var18;
+
+            if (this.field_177098_i)
+            {
+                var18 = this.func_177088_c(p_76986_1_);
+                this.renderModel(p_76986_1_, var17, var16, var14, var12, var20, 0.0625F);
+
+                if (var18)
+                {
+                    this.func_180565_e();
+                }
+            }
+            else
+            {
+                var18 = this.func_177090_c(p_76986_1_, p_76986_9_);
+                this.renderModel(p_76986_1_, var17, var16, var14, var12, var20, 0.0625F);
+
+                if (var18)
+                {
+                    this.func_177091_f();
+                }
+
+                GlStateManager.depthMask(true);
+
+                if (!(p_76986_1_ instanceof EntityPlayer) || !((EntityPlayer)p_76986_1_).isSpectator())
+                {
+                    this.func_177093_a(p_76986_1_, var17, var16, p_76986_9_, var14, var12, var20, 0.0625F);
+                }
+            }
+
+            GlStateManager.disableRescaleNormal();
+        }
+        catch (Exception var19)
+        {
+            logger.error("Couldn\'t render entity", var19);
+        }
+
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GlStateManager.func_179098_w();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+        GlStateManager.enableCull();
+        GlStateManager.popMatrix();
+
+        if (!this.field_177098_i)
+        {
+            super.doRender(p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
+        }
+    }
+
+    protected boolean func_177088_c(EntityLivingBase p_177088_1_)
+    {
+        int var2 = 16777215;
+
+        if (p_177088_1_ instanceof EntityPlayer)
+        {
+            ScorePlayerTeam var3 = (ScorePlayerTeam)p_177088_1_.getTeam();
+
+            if (var3 != null)
+            {
+                String var4 = FontRenderer.getFormatFromString(var3.getColorPrefix());
+
+                if (var4.length() >= 2)
+                {
+                    var2 = this.getFontRendererFromRenderManager().func_175064_b(var4.charAt(1));
+                }
+            }
+        }
+
+        float var6 = (float)(var2 >> 16 & 255) / 255.0F;
+        float var7 = (float)(var2 >> 8 & 255) / 255.0F;
+        float var5 = (float)(var2 & 255) / 255.0F;
+        GlStateManager.disableLighting();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+        GlStateManager.color(var6, var7, var5, 1.0F);
+        GlStateManager.func_179090_x();
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GlStateManager.func_179090_x();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+        return true;
+    }
+
+    protected void func_180565_e()
+    {
+        GlStateManager.enableLighting();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+        GlStateManager.func_179098_w();
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GlStateManager.func_179098_w();
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+    }
+
+    /**
+     * Renders the model in RenderLiving
+     */
+    protected void renderModel(EntityLivingBase p_77036_1_, float p_77036_2_, float p_77036_3_, float p_77036_4_, float p_77036_5_, float p_77036_6_, float p_77036_7_)
+    {
+        boolean var8 = !p_77036_1_.isInvisible();
+        //TODO: Client
+        boolean var9 = !var8 && (!p_77036_1_.isInvisibleToPlayer(Minecraft.getMinecraft().thePlayer) || WurstClient.INSTANCE.modManager.getModByClass(TrueSightMod.class).isEnabled());
+
+        if (var8 || var9)
+        {
+            if (!this.bindEntityTexture(p_77036_1_))
+            {
+                return;
+            }
+
+            if (var9)
+            {
+                GlStateManager.pushMatrix();
+                GlStateManager.color(1.0F, 1.0F, 1.0F, 0.15F);
+                GlStateManager.depthMask(false);
+                GlStateManager.enableBlend();
+                GlStateManager.blendFunc(770, 771);
+                GlStateManager.alphaFunc(516, 0.003921569F);
+            }
+
+            this.mainModel.render(p_77036_1_, p_77036_2_, p_77036_3_, p_77036_4_, p_77036_5_, p_77036_6_, p_77036_7_);
+
+            if (var9)
+            {
+                GlStateManager.disableBlend();
+                GlStateManager.alphaFunc(516, 0.1F);
+                GlStateManager.popMatrix();
+                GlStateManager.depthMask(true);
+            }
+        }
+    }
+
+    protected boolean func_177090_c(EntityLivingBase p_177090_1_, float p_177090_2_)
+    {
+        return this.func_177092_a(p_177090_1_, p_177090_2_, true);
+    }
+
+    protected boolean func_177092_a(EntityLivingBase p_177092_1_, float p_177092_2_, boolean p_177092_3_)
+    {
+        float var4 = p_177092_1_.getBrightness(p_177092_2_);
+        int var5 = this.getColorMultiplier(p_177092_1_, var4, p_177092_2_);
+        boolean var6 = (var5 >> 24 & 255) > 0;
+        boolean var7 = p_177092_1_.hurtTime > 0 || p_177092_1_.deathTime > 0;
+
+        if (!var6 && !var7)
+        {
+            return false;
+        }
+        else if (!var6 && !p_177092_3_)
+        {
+            return false;
+        }
+        else
+        {
+            GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+            GlStateManager.func_179098_w();
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.defaultTexUnit);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176093_u);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.defaultTexUnit);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+            GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+            GlStateManager.func_179098_w();
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, OpenGlHelper.field_176094_t);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.field_176092_v);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176080_A, OpenGlHelper.field_176092_v);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176076_D, GL11.GL_SRC_ALPHA);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.field_176091_w);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+            this.field_177095_g.position(0);
+
+            if (var7)
+            {
+                this.field_177095_g.put(1.0F);
+                this.field_177095_g.put(0.0F);
+                this.field_177095_g.put(0.0F);
+                this.field_177095_g.put(0.3F);
+            }
+            else
+            {
+                float var8 = (float)(var5 >> 24 & 255) / 255.0F;
+                float var9 = (float)(var5 >> 16 & 255) / 255.0F;
+                float var10 = (float)(var5 >> 8 & 255) / 255.0F;
+                float var11 = (float)(var5 & 255) / 255.0F;
+                this.field_177095_g.put(var9);
+                this.field_177095_g.put(var10);
+                this.field_177095_g.put(var11);
+                this.field_177095_g.put(1.0F - var8);
+            }
+
+            this.field_177095_g.flip();
+            GL11.glTexEnv(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_COLOR, this.field_177095_g);
+            GlStateManager.setActiveTexture(OpenGlHelper.field_176096_r);
+            GlStateManager.func_179098_w();
+            GlStateManager.func_179144_i(field_177096_e.getGlTextureId());
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.field_176091_w);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.lightmapTexUnit);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_REPLACE);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.field_176091_w);
+            GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+            GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+            return true;
+        }
+    }
+
+    protected void func_177091_f()
+    {
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+        GlStateManager.func_179098_w();
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, OpenGlHelper.defaultTexUnit);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176093_u);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, OpenGlHelper.defaultTexUnit);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176079_G, OpenGlHelper.field_176093_u);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176086_J, GL11.GL_SRC_ALPHA);
+        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, GL11.GL_TEXTURE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, GL11.GL_TEXTURE);
+        GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+        GlStateManager.setActiveTexture(OpenGlHelper.field_176096_r);
+        GlStateManager.func_179090_x();
+        GlStateManager.func_179144_i(0);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, GL11.GL_TEXTURE_ENV_MODE, OpenGlHelper.field_176095_s);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176099_x, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176081_B, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176082_C, GL11.GL_SRC_COLOR);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176098_y, GL11.GL_TEXTURE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176097_z, OpenGlHelper.field_176091_w);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176077_E, GL11.GL_MODULATE);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176085_I, GL11.GL_SRC_ALPHA);
+        GL11.glTexEnvi(GL11.GL_TEXTURE_ENV, OpenGlHelper.field_176078_F, GL11.GL_TEXTURE);
+        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
+    }
+
+    /**
+     * Sets a simple glTranslate on a LivingEntity.
+     */
+    protected void renderLivingAt(EntityLivingBase p_77039_1_, double p_77039_2_, double p_77039_4_, double p_77039_6_)
+    {
+        GlStateManager.translate((float)p_77039_2_, (float)p_77039_4_, (float)p_77039_6_);
+    }
+
+    protected void rotateCorpse(EntityLivingBase p_77043_1_, float p_77043_2_, float p_77043_3_, float p_77043_4_)
+    {
+        GlStateManager.rotate(180.0F - p_77043_3_, 0.0F, 1.0F, 0.0F);
+
+        if (p_77043_1_.deathTime > 0)
+        {
+            float var5 = ((float)p_77043_1_.deathTime + p_77043_4_ - 1.0F) / 20.0F * 1.6F;
+            var5 = MathHelper.sqrt_float(var5);
+
+            if (var5 > 1.0F)
+            {
+                var5 = 1.0F;
+            }
+
+            GlStateManager.rotate(var5 * this.getDeathMaxRotation(p_77043_1_), 0.0F, 0.0F, 1.0F);
+        }
+        else
+        {
+            String var6 = EnumChatFormatting.getTextWithoutFormattingCodes(p_77043_1_.getName());
+
+            if (var6 != null && (var6.equals("Dinnerbone") || var6.equals("Grumm")) && (!(p_77043_1_ instanceof EntityPlayer) || ((EntityPlayer)p_77043_1_).func_175148_a(EnumPlayerModelParts.CAPE)))
+            {
+                GlStateManager.translate(0.0F, p_77043_1_.height + 0.1F, 0.0F);
+                GlStateManager.rotate(180.0F, 0.0F, 0.0F, 1.0F);
+            }
+        }
+    }
+
+    /**
+     * Returns where in the swing animation the living entity is (from 0 to 1).  Args : entity, partialTickTime
+     */
+    protected float getSwingProgress(EntityLivingBase p_77040_1_, float p_77040_2_)
+    {
+        return p_77040_1_.getSwingProgress(p_77040_2_);
+    }
+
+    /**
+     * Defines what float the third param in setRotationAngles of ModelBase is
+     */
+    protected float handleRotationFloat(EntityLivingBase p_77044_1_, float p_77044_2_)
+    {
+        return (float)p_77044_1_.ticksExisted + p_77044_2_;
+    }
+
+    protected void func_177093_a(EntityLivingBase p_177093_1_, float p_177093_2_, float p_177093_3_, float p_177093_4_, float p_177093_5_, float p_177093_6_, float p_177093_7_, float p_177093_8_)
+    {
+        Iterator var9 = this.field_177097_h.iterator();
+
+        while (var9.hasNext())
+        {
+            LayerRenderer var10 = (LayerRenderer)var9.next();
+            boolean var11 = this.func_177092_a(p_177093_1_, p_177093_4_, var10.shouldCombineTextures());
+            var10.doRenderLayer(p_177093_1_, p_177093_2_, p_177093_3_, p_177093_4_, p_177093_5_, p_177093_6_, p_177093_7_, p_177093_8_);
+
+            if (var11)
+            {
+                this.func_177091_f();
+            }
+        }
+    }
+
+    protected float getDeathMaxRotation(EntityLivingBase p_77037_1_)
+    {
+        return 90.0F;
+    }
+
+    /**
+     * Returns an ARGB int color back. Args: entityLiving, lightBrightness, partialTickTime
+     */
+    protected int getColorMultiplier(EntityLivingBase p_77030_1_, float p_77030_2_, float p_77030_3_)
+    {
+        return 0;
+    }
+
+    /**
+     * Allows the render to do any OpenGL state modifications necessary before the model is rendered. Args:
+     * entityLiving, partialTickTime
+     */
+    protected void preRenderCallback(EntityLivingBase p_77041_1_, float p_77041_2_) {}
+
+    /**
+     * Passes the specialRender and renders it
+     */
+    public void passSpecialRender(EntityLivingBase p_77033_1_, double p_77033_2_, double p_77033_4_, double p_77033_6_)
+    {
+        if (this.canRenderName(p_77033_1_))
+        {
+            double var8 = p_77033_1_.getDistanceSqToEntity(this.renderManager.livingPlayer);
+            float var10 = p_77033_1_.isSneaking() ? 32.0F : 64.0F;
+
+            if (var8 < (double)(var10 * var10))
+            {
+                String var11 = p_77033_1_.getDisplayName().getFormattedText();
+                float var12 = 0.02666667F;
+                GlStateManager.alphaFunc(516, 0.1F);
+
+                if (p_77033_1_.isSneaking())
+                {
+                    FontRenderer var13 = this.getFontRendererFromRenderManager();
+                    GlStateManager.pushMatrix();
+                    GlStateManager.translate((float)p_77033_2_, (float)p_77033_4_ + p_77033_1_.height + 0.5F - (p_77033_1_.isChild() ? p_77033_1_.height / 2.0F : 0.0F), (float)p_77033_6_);
+                    GL11.glNormal3f(0.0F, 1.0F, 0.0F);
+                    GlStateManager.rotate(-this.renderManager.playerViewY, 0.0F, 1.0F, 0.0F);
+                    GlStateManager.rotate(this.renderManager.playerViewX, 1.0F, 0.0F, 0.0F);
+                    GlStateManager.scale(-0.02666667F, -0.02666667F, 0.02666667F);
+                    GlStateManager.translate(0.0F, 9.374999F, 0.0F);
+                    GlStateManager.disableLighting();
+                    GlStateManager.depthMask(false);
+                    GlStateManager.enableBlend();
+                    GlStateManager.func_179090_x();
+                    GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
+                    Tessellator var14 = Tessellator.getInstance();
+                    WorldRenderer var15 = var14.getWorldRenderer();
+                    var15.startDrawingQuads();
+                    int var16 = var13.getStringWidth(var11) / 2;
+                    var15.setColorRGBA_F(0.0F, 0.0F, 0.0F, 0.25F);
+                    var15.addVertex((double)(-var16 - 1), -1.0D, 0.0D);
+                    var15.addVertex((double)(-var16 - 1), 8.0D, 0.0D);
+                    var15.addVertex((double)(var16 + 1), 8.0D, 0.0D);
+                    var15.addVertex((double)(var16 + 1), -1.0D, 0.0D);
+                    var14.draw();
+                    GlStateManager.func_179098_w();
+                    GlStateManager.depthMask(true);
+                    var13.drawString(var11, -var13.getStringWidth(var11) / 2, 0, 553648127);
+                    GlStateManager.enableLighting();
+                    GlStateManager.disableBlend();
+                    GlStateManager.color(1.0F, 1.0F, 1.0F, 1.0F);
+                    GlStateManager.popMatrix();
+                }
+                else
+                {
+                    this.func_177069_a(p_77033_1_, p_77033_2_, p_77033_4_ - (p_77033_1_.isChild() ? (double)(p_77033_1_.height / 2.0F) : 0.0D), p_77033_6_, var11, 0.02666667F, var8);
+                }
+            }
+        }
+    }
+
+    /**
+     * Test if the entity name must be rendered
+     */
+    protected boolean canRenderName(EntityLivingBase targetEntity)
+    {
+        EntityPlayerSP var2 = Minecraft.getMinecraft().thePlayer;
+
+        if (targetEntity instanceof EntityPlayer && targetEntity != var2)
+        {
+            Team var3 = targetEntity.getTeam();
+            Team var4 = var2.getTeam();
+
+            if (var3 != null)
+            {
+                Team.EnumVisible var5 = var3.func_178770_i();
+
+                switch (RendererLivingEntity.SwitchEnumVisible.field_178679_a[var5.ordinal()])
+                {
+                    case 1:
+                        return true;
+
+                    case 2:
+                        return false;
+
+                    case 3:
+                        return var4 == null || var3.isSameTeam(var4);
+
+                    case 4:
+                        return var4 == null || !var3.isSameTeam(var4);
+
+                    default:
+                        return true;
+                }
+            }
+        }
+
+        return Minecraft.isGuiEnabled() && targetEntity != this.renderManager.livingPlayer && !targetEntity.isInvisibleToPlayer(var2) && targetEntity.riddenByEntity == null;
+    }
+
+    public void func_177086_a(boolean p_177086_1_)
+    {
+        this.field_177098_i = p_177086_1_;
+    }
+
+    protected boolean func_177070_b(Entity p_177070_1_)
+    {
+        return this.canRenderName((EntityLivingBase)p_177070_1_);
+    }
+
+    public void func_177067_a(Entity p_177067_1_, double p_177067_2_, double p_177067_4_, double p_177067_6_)
+    {
+        this.passSpecialRender((EntityLivingBase)p_177067_1_, p_177067_2_, p_177067_4_, p_177067_6_);
+    }
+
+    /**
+     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
+     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
+     * (Render<T extends Entity) and this method has signature public void doRender(T entity, double d, double d1,
+     * double d2, float f, float f1). But JAD is pre 1.5 so doesn't do that.
+     */
+    public void doRender(Entity p_76986_1_, double p_76986_2_, double p_76986_4_, double p_76986_6_, float p_76986_8_, float p_76986_9_)
+    {
+        this.doRender((EntityLivingBase)p_76986_1_, p_76986_2_, p_76986_4_, p_76986_6_, p_76986_8_, p_76986_9_);
+    }
+
+    static
+    {
+        int[] var0 = field_177096_e.getTextureData();
+
+        for (int var1 = 0; var1 < 256; ++var1)
+        {
+            var0[var1] = -1;
+        }
+
+        field_177096_e.updateDynamicTexture();
+    }
+
+    static final class SwitchEnumVisible
+    {
+        static final int[] field_178679_a = new int[Team.EnumVisible.values().length];
+        private static final String __OBFID = "CL_00002435";
+
+        static
+        {
+            try
+            {
+                field_178679_a[Team.EnumVisible.ALWAYS.ordinal()] = 1;
+            }
+            catch (NoSuchFieldError var4)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178679_a[Team.EnumVisible.NEVER.ordinal()] = 2;
+            }
+            catch (NoSuchFieldError var3)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178679_a[Team.EnumVisible.HIDE_FOR_OTHER_TEAMS.ordinal()] = 3;
+            }
+            catch (NoSuchFieldError var2)
+            {
+                ;
+            }
+
+            try
+            {
+                field_178679_a[Team.EnumVisible.HIDE_FOR_OWN_TEAM.ordinal()] = 4;
+            }
+            catch (NoSuchFieldError var1)
+            {
+                ;
+            }
+        }
+    }
+}
diff --git a/src/net/minecraft/client/renderer/entity/layers/LayerEnderDragonDeath.java b/src/net/minecraft/client/renderer/entity/layers/LayerEnderDragonDeath.java
index 2bb44f9..d221dba 100644
--- a/src/net/minecraft/client/renderer/entity/layers/LayerEnderDragonDeath.java
+++ b/src/net/minecraft/client/renderer/entity/layers/LayerEnderDragonDeath.java
@@ -49,9 +49,9 @@ public class LayerEnderDragonDeath implements LayerRenderer
                 var10.startDrawing(6);
                 float var15 = var13.nextFloat() * 20.0F + 5.0F + var12 * 10.0F;
                 float var16 = var13.nextFloat() * 2.0F + 1.0F + var12 * 2.0F;
-                var10.func_178974_a(16777215, (int)(255.0F * (1.0F - var12)));
+                var10.setColorRGBA_I(16777215, (int)(255.0F * (1.0F - var12)));
                 var10.addVertex(0.0D, 0.0D, 0.0D);
-                var10.func_178974_a(16711935, 0);
+                var10.setColorRGBA_I(16711935, 0);
                 var10.addVertex(-0.866D * (double)var16, (double)var15, (double)(-0.5F * var16));
                 var10.addVertex(0.866D * (double)var16, (double)var15, (double)(-0.5F * var16));
                 var10.addVertex(0.0D, (double)var15, (double)(1.0F * var16));
diff --git a/src/net/minecraft/client/renderer/texture/TextureAtlasSprite.java b/src/net/minecraft/client/renderer/texture/TextureAtlasSprite.java
index 5a4668d..644e109 100644
--- a/src/net/minecraft/client/renderer/texture/TextureAtlasSprite.java
+++ b/src/net/minecraft/client/renderer/texture/TextureAtlasSprite.java
@@ -1,11 +1,13 @@
 package net.minecraft.client.renderer.texture;
 
 import com.google.common.collect.Lists;
+
 import java.awt.image.BufferedImage;
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
 import java.util.concurrent.Callable;
+
 import net.minecraft.client.resources.data.AnimationFrame;
 import net.minecraft.client.resources.data.AnimationMetadataSection;
 import net.minecraft.crash.CrashReport;
diff --git a/src/net/minecraft/client/renderer/texture/TextureManager.java b/src/net/minecraft/client/renderer/texture/TextureManager.java
index cc60332..8c03e9e 100644
--- a/src/net/minecraft/client/renderer/texture/TextureManager.java
+++ b/src/net/minecraft/client/renderer/texture/TextureManager.java
@@ -1,151 +1,162 @@
-package net.minecraft.client.renderer.texture;
-
-import com.google.common.collect.Lists;
-import com.google.common.collect.Maps;
-import java.io.IOException;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Map.Entry;
-import java.util.concurrent.Callable;
-import net.minecraft.client.resources.IResourceManager;
-import net.minecraft.client.resources.IResourceManagerReloadListener;
-import net.minecraft.crash.CrashReport;
-import net.minecraft.crash.CrashReportCategory;
-import net.minecraft.util.ReportedException;
-import net.minecraft.util.ResourceLocation;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-
-public class TextureManager implements ITickable, IResourceManagerReloadListener
-{
-    private static final Logger logger = LogManager.getLogger();
-    private final Map mapTextureObjects = Maps.newHashMap();
-    private final List listTickables = Lists.newArrayList();
-    private final Map mapTextureCounters = Maps.newHashMap();
-    private IResourceManager theResourceManager;
-    private static final String __OBFID = "CL_00001064";
-
-    public TextureManager(IResourceManager p_i1284_1_)
-    {
-        this.theResourceManager = p_i1284_1_;
-    }
-
-    public void bindTexture(ResourceLocation resource)
-    {
-        Object var2 = (ITextureObject)this.mapTextureObjects.get(resource);
-
-        if (var2 == null)
-        {
-            var2 = new SimpleTexture(resource);
-            this.loadTexture(resource, (ITextureObject)var2);
-        }
-
-        TextureUtil.bindTexture(((ITextureObject)var2).getGlTextureId());
-    }
-
-    public boolean loadTickableTexture(ResourceLocation p_110580_1_, ITickableTextureObject p_110580_2_)
-    {
-        if (this.loadTexture(p_110580_1_, p_110580_2_))
-        {
-            this.listTickables.add(p_110580_2_);
-            return true;
-        }
-        else
-        {
-            return false;
-        }
-    }
-
-    public boolean loadTexture(ResourceLocation p_110579_1_, final ITextureObject p_110579_2_)
-    {
-        boolean var3 = true;
-        ITextureObject p_110579_2_2 = p_110579_2_;
-
-        try
-        {
-            ((ITextureObject)p_110579_2_).loadTexture(this.theResourceManager);
-        }
-        catch (IOException var8)
-        {
-            logger.warn("Failed to load texture: " + p_110579_1_, var8);
-            p_110579_2_2 = TextureUtil.missingTexture;
-            this.mapTextureObjects.put(p_110579_1_, p_110579_2_2);
-            var3 = false;
-        }
-        catch (Throwable var9)
-        {
-            CrashReport var5 = CrashReport.makeCrashReport(var9, "Registering texture");
-            CrashReportCategory var6 = var5.makeCategory("Resource location being registered");
-            var6.addCrashSection("Resource location", p_110579_1_);
-            var6.addCrashSectionCallable("Texture object class", new Callable()
-            {
-                private static final String __OBFID = "CL_00001065";
-                public String call()
-                {
-                    return p_110579_2_.getClass().getName();
-                }
-            });
-            throw new ReportedException(var5);
-        }
-
-        this.mapTextureObjects.put(p_110579_1_, p_110579_2_2);
-        return var3;
-    }
-
-    public ITextureObject getTexture(ResourceLocation p_110581_1_)
-    {
-        return (ITextureObject)this.mapTextureObjects.get(p_110581_1_);
-    }
-
-    public ResourceLocation getDynamicTextureLocation(String p_110578_1_, DynamicTexture p_110578_2_)
-    {
-        Integer var3 = (Integer)this.mapTextureCounters.get(p_110578_1_);
-
-        if (var3 == null)
-        {
-            var3 = Integer.valueOf(1);
-        }
-        else
-        {
-            var3 = Integer.valueOf(var3.intValue() + 1);
-        }
-
-        this.mapTextureCounters.put(p_110578_1_, var3);
-        ResourceLocation var4 = new ResourceLocation(String.format("dynamic/%s_%d", new Object[] {p_110578_1_, var3}));
-        this.loadTexture(var4, p_110578_2_);
-        return var4;
-    }
-
-    public void tick()
-    {
-        Iterator var1 = this.listTickables.iterator();
-
-        while (var1.hasNext())
-        {
-            ITickable var2 = (ITickable)var1.next();
-            var2.tick();
-        }
-    }
-
-    public void deleteTexture(ResourceLocation p_147645_1_)
-    {
-        ITextureObject var2 = this.getTexture(p_147645_1_);
-
-        if (var2 != null)
-        {
-            TextureUtil.deleteTexture(var2.getGlTextureId());
-        }
-    }
-
-    public void onResourceManagerReload(IResourceManager p_110549_1_)
-    {
-        Iterator var2 = this.mapTextureObjects.entrySet().iterator();
-
-        while (var2.hasNext())
-        {
-            Entry var3 = (Entry)var2.next();
-            this.loadTexture((ResourceLocation)var3.getKey(), (ITextureObject)var3.getValue());
-        }
-    }
-}
+package net.minecraft.client.renderer.texture;
+
+import com.google.common.collect.Lists;
+import com.google.common.collect.Maps;
+
+import java.io.IOException;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.Map.Entry;
+import java.util.concurrent.Callable;
+
+import net.minecraft.client.resources.IResourceManager;
+import net.minecraft.client.resources.IResourceManagerReloadListener;
+import net.minecraft.crash.CrashReport;
+import net.minecraft.crash.CrashReportCategory;
+import net.minecraft.util.ReportedException;
+import net.minecraft.util.ResourceLocation;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+
+import tk.wurst_client.bot.WurstBot;
+
+public class TextureManager implements ITickable, IResourceManagerReloadListener
+{
+    private static final Logger logger = LogManager.getLogger();
+    private final Map mapTextureObjects = Maps.newHashMap();
+    private final List listTickables = Lists.newArrayList();
+    private final Map mapTextureCounters = Maps.newHashMap();
+    private IResourceManager theResourceManager;
+    private static final String __OBFID = "CL_00001064";
+
+    public TextureManager(IResourceManager p_i1284_1_)
+    {
+        this.theResourceManager = p_i1284_1_;
+    }
+
+    public void bindTexture(ResourceLocation resource)
+    {
+        Object var2 = (ITextureObject)this.mapTextureObjects.get(resource);
+
+        if (var2 == null)
+        {
+            var2 = new SimpleTexture(resource);
+            this.loadTexture(resource, (ITextureObject)var2);
+        }
+
+        TextureUtil.bindTexture(((ITextureObject)var2).getGlTextureId());
+    }
+
+    public boolean loadTickableTexture(ResourceLocation p_110580_1_, ITickableTextureObject p_110580_2_)
+    {
+        if (this.loadTexture(p_110580_1_, p_110580_2_))
+        {
+            this.listTickables.add(p_110580_2_);
+            return true;
+        }
+        else
+        {
+            return false;
+        }
+    }
+
+    public boolean loadTexture(ResourceLocation p_110579_1_, final ITextureObject p_110579_2_)
+    {
+    	//TODO: Client
+    	if(WurstBot.isEnabled())
+    	{
+    		this.mapTextureObjects.put(p_110579_1_, TextureUtil.missingTexture);
+    		return true;
+    	}
+        boolean var3 = true;
+        ITextureObject p_110579_2_2 = p_110579_2_;
+
+        try
+        {
+            ((ITextureObject)p_110579_2_).loadTexture(this.theResourceManager);
+        }
+        catch (IOException var8)
+        {
+            logger.warn("Failed to load texture: " + p_110579_1_, var8);
+            p_110579_2_2 = TextureUtil.missingTexture;
+            this.mapTextureObjects.put(p_110579_1_, p_110579_2_2);
+            var3 = false;
+        }
+        catch (Throwable var9)
+        {
+            CrashReport var5 = CrashReport.makeCrashReport(var9, "Registering texture");
+            CrashReportCategory var6 = var5.makeCategory("Resource location being registered");
+            var6.addCrashSection("Resource location", p_110579_1_);
+            var6.addCrashSectionCallable("Texture object class", new Callable()
+            {
+                private static final String __OBFID = "CL_00001065";
+                public String call()
+                {
+                    return p_110579_2_.getClass().getName();
+                }
+            });
+            throw new ReportedException(var5);
+        }
+
+        this.mapTextureObjects.put(p_110579_1_, p_110579_2_2);
+        return var3;
+    }
+
+    public ITextureObject getTexture(ResourceLocation p_110581_1_)
+    {
+        return (ITextureObject)this.mapTextureObjects.get(p_110581_1_);
+    }
+
+    public ResourceLocation getDynamicTextureLocation(String p_110578_1_, DynamicTexture p_110578_2_)
+    {
+        Integer var3 = (Integer)this.mapTextureCounters.get(p_110578_1_);
+
+        if (var3 == null)
+        {
+            var3 = Integer.valueOf(1);
+        }
+        else
+        {
+            var3 = Integer.valueOf(var3.intValue() + 1);
+        }
+
+        this.mapTextureCounters.put(p_110578_1_, var3);
+        ResourceLocation var4 = new ResourceLocation(String.format("dynamic/%s_%d", new Object[] {p_110578_1_, var3}));
+        this.loadTexture(var4, p_110578_2_);
+        return var4;
+    }
+
+    public void tick()
+    {
+        Iterator var1 = this.listTickables.iterator();
+
+        while (var1.hasNext())
+        {
+            ITickable var2 = (ITickable)var1.next();
+            var2.tick();
+        }
+    }
+
+    public void deleteTexture(ResourceLocation p_147645_1_)
+    {
+        ITextureObject var2 = this.getTexture(p_147645_1_);
+
+        if (var2 != null)
+        {
+            TextureUtil.deleteTexture(var2.getGlTextureId());
+        }
+    }
+
+    public void onResourceManagerReload(IResourceManager p_110549_1_)
+    {
+        Iterator var2 = this.mapTextureObjects.entrySet().iterator();
+
+        while (var2.hasNext())
+        {
+            Entry var3 = (Entry)var2.next();
+            this.loadTexture((ResourceLocation)var3.getKey(), (ITextureObject)var3.getValue());
+        }
+    }
+}
diff --git a/src/net/minecraft/client/renderer/texture/TextureMap.java b/src/net/minecraft/client/renderer/texture/TextureMap.java
index feb0773..2cf8770 100644
--- a/src/net/minecraft/client/renderer/texture/TextureMap.java
+++ b/src/net/minecraft/client/renderer/texture/TextureMap.java
@@ -2,6 +2,7 @@ package net.minecraft.client.renderer.texture;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
 import java.awt.image.BufferedImage;
 import java.io.IOException;
 import java.util.HashMap;
@@ -10,6 +11,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
 import java.util.concurrent.Callable;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.renderer.StitcherException;
 import net.minecraft.client.resources.IResource;
@@ -21,6 +23,7 @@ import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.MathHelper;
 import net.minecraft.util.ReportedException;
 import net.minecraft.util.ResourceLocation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/client/renderer/tileentity/RenderItemFrame.java b/src/net/minecraft/client/renderer/tileentity/RenderItemFrame.java
index 292833f..f4ba412 100644
--- a/src/net/minecraft/client/renderer/tileentity/RenderItemFrame.java
+++ b/src/net/minecraft/client/renderer/tileentity/RenderItemFrame.java
@@ -209,7 +209,7 @@ public class RenderItemFrame extends Render
                     GlStateManager.func_179090_x();
                     var16.startDrawingQuads();
                     int var17 = var14.getStringWidth(var13) / 2;
-                    var16.func_178960_a(0.0F, 0.0F, 0.0F, 0.25F);
+                    var16.setColorRGBA_F(0.0F, 0.0F, 0.0F, 0.25F);
                     var16.addVertex((double)(-var17 - 1), -1.0D, 0.0D);
                     var16.addVertex((double)(-var17 - 1), 8.0D, 0.0D);
                     var16.addVertex((double)(var17 + 1), 8.0D, 0.0D);
diff --git a/src/net/minecraft/client/renderer/tileentity/TileEntityBeaconRenderer.java b/src/net/minecraft/client/renderer/tileentity/TileEntityBeaconRenderer.java
index 7a2fbb9..c9bd21d 100644
--- a/src/net/minecraft/client/renderer/tileentity/TileEntityBeaconRenderer.java
+++ b/src/net/minecraft/client/renderer/tileentity/TileEntityBeaconRenderer.java
@@ -56,7 +56,7 @@ public class TileEntityBeaconRenderer extends TileEntitySpecialRenderer
                 double var42 = 1.0D;
                 double var44 = (double)(-1.0F + var19);
                 double var46 = (double)((float)var16.func_177264_c() * var10) * (0.5D / var22) + var44;
-                var12.func_178960_a(var16.func_177263_b()[0], var16.func_177263_b()[1], var16.func_177263_b()[2], 0.125F);
+                var12.setColorRGBA_F(var16.func_177263_b()[0], var16.func_177263_b()[1], var16.func_177263_b()[2], 0.125F);
                 var12.addVertexWithUV(p_180536_2_ + var24, p_180536_4_ + (double)var17, p_180536_6_ + var26, var42, var46);
                 var12.addVertexWithUV(p_180536_2_ + var24, p_180536_4_ + (double)var14, p_180536_6_ + var26, var42, var44);
                 var12.addVertexWithUV(p_180536_2_ + var28, p_180536_4_ + (double)var14, p_180536_6_ + var30, var40, var44);
@@ -78,7 +78,7 @@ public class TileEntityBeaconRenderer extends TileEntitySpecialRenderer
                 GlStateManager.tryBlendFuncSeparate(770, 771, 1, 0);
                 GlStateManager.depthMask(false);
                 var12.startDrawingQuads();
-                var12.func_178960_a(var16.func_177263_b()[0], var16.func_177263_b()[1], var16.func_177263_b()[2], 0.125F);
+                var12.setColorRGBA_F(var16.func_177263_b()[0], var16.func_177263_b()[1], var16.func_177263_b()[2], 0.125F);
                 var20 = 0.2D;
                 var22 = 0.2D;
                 var24 = 0.8D;
diff --git a/src/net/minecraft/client/renderer/tileentity/TileEntityEndPortalRenderer.java b/src/net/minecraft/client/renderer/tileentity/TileEntityEndPortalRenderer.java
index 1494ae8..1ee3f0b 100644
--- a/src/net/minecraft/client/renderer/tileentity/TileEntityEndPortalRenderer.java
+++ b/src/net/minecraft/client/renderer/tileentity/TileEntityEndPortalRenderer.java
@@ -102,7 +102,7 @@ public class TileEntityEndPortalRenderer extends TileEntitySpecialRenderer
                 var22 = 1.0F;
             }
 
-            var26.func_178960_a(var22 * var17, var23 * var17, var24 * var17, 1.0F);
+            var26.setColorRGBA_F(var22 * var17, var23 * var17, var24 * var17, 1.0F);
             var26.addVertex(p_180544_2_, p_180544_4_ + (double)var13, p_180544_6_);
             var26.addVertex(p_180544_2_, p_180544_4_ + (double)var13, p_180544_6_ + 1.0D);
             var26.addVertex(p_180544_2_ + 1.0D, p_180544_4_ + (double)var13, p_180544_6_ + 1.0D);
diff --git a/src/net/minecraft/client/renderer/tileentity/TileEntityPistonRenderer.java b/src/net/minecraft/client/renderer/tileentity/TileEntityPistonRenderer.java
index ddf542b..9948e5a 100644
--- a/src/net/minecraft/client/renderer/tileentity/TileEntityPistonRenderer.java
+++ b/src/net/minecraft/client/renderer/tileentity/TileEntityPistonRenderer.java
@@ -52,7 +52,7 @@ public class TileEntityPistonRenderer extends TileEntitySpecialRenderer
             var14.startDrawingQuads();
             var14.setVertexFormat(DefaultVertexFormats.field_176600_a);
             var14.setTranslation((double)((float)p_178461_2_ - (float)var10.getX() + p_178461_1_.func_174929_b(p_178461_8_)), (double)((float)p_178461_4_ - (float)var10.getY() + p_178461_1_.func_174928_c(p_178461_8_)), (double)((float)p_178461_6_ - (float)var10.getZ() + p_178461_1_.func_174926_d(p_178461_8_)));
-            var14.func_178986_b(1.0F, 1.0F, 1.0F);
+            var14.setColorOpaque_F(1.0F, 1.0F, 1.0F);
             World var15 = this.getWorld();
 
             if (var12 == Blocks.piston_head && p_178461_1_.func_145860_a(p_178461_8_) < 0.5F)
diff --git a/src/net/minecraft/client/renderer/tileentity/TileEntityRendererDispatcher.java b/src/net/minecraft/client/renderer/tileentity/TileEntityRendererDispatcher.java
index 6e4cd84..697b1f4 100644
--- a/src/net/minecraft/client/renderer/tileentity/TileEntityRendererDispatcher.java
+++ b/src/net/minecraft/client/renderer/tileentity/TileEntityRendererDispatcher.java
@@ -1,8 +1,10 @@
 package net.minecraft.client.renderer.tileentity;
 
 import com.google.common.collect.Maps;
+
 import java.util.Iterator;
 import java.util.Map;
+
 import net.minecraft.client.gui.FontRenderer;
 import net.minecraft.client.renderer.GlStateManager;
 import net.minecraft.client.renderer.OpenGlHelper;
diff --git a/src/net/minecraft/client/renderer/tileentity/TileEntitySkullRenderer.java b/src/net/minecraft/client/renderer/tileentity/TileEntitySkullRenderer.java
index 24f6176..f84f906 100644
--- a/src/net/minecraft/client/renderer/tileentity/TileEntitySkullRenderer.java
+++ b/src/net/minecraft/client/renderer/tileentity/TileEntitySkullRenderer.java
@@ -73,7 +73,7 @@ public class TileEntitySkullRenderer extends TileEntitySpecialRenderer
 
                 case 3:
                     var9 = this.field_178468_i;
-                    ResourceLocation var10 = DefaultPlayerSkin.func_177335_a();
+                    ResourceLocation var10 = DefaultPlayerSkin.getLocationStevePNG();
 
                     if (p_180543_7_ != null)
                     {
@@ -87,7 +87,7 @@ public class TileEntitySkullRenderer extends TileEntitySpecialRenderer
                         else
                         {
                             UUID var13 = EntityPlayer.getUUID(p_180543_7_);
-                            var10 = DefaultPlayerSkin.func_177334_a(var13);
+                            var10 = DefaultPlayerSkin.getLocationFromUUID(var13);
                         }
                     }
 
diff --git a/src/net/minecraft/client/resources/DefaultPlayerSkin.java b/src/net/minecraft/client/resources/DefaultPlayerSkin.java
index 8d1baca..0a612f4 100644
--- a/src/net/minecraft/client/resources/DefaultPlayerSkin.java
+++ b/src/net/minecraft/client/resources/DefaultPlayerSkin.java
@@ -3,29 +3,30 @@ package net.minecraft.client.resources;
 import java.util.UUID;
 import net.minecraft.util.ResourceLocation;
 
+//TODO: Client
 public class DefaultPlayerSkin
 {
-    private static final ResourceLocation field_177337_a = new ResourceLocation("textures/entity/steve.png");
-    private static final ResourceLocation field_177336_b = new ResourceLocation("textures/entity/alex.png");
+    private static final ResourceLocation locationStevePNG = new ResourceLocation("textures/entity/steve.png");
+    private static final ResourceLocation locationAlexPNG = new ResourceLocation("textures/entity/alex.png");
     private static final String __OBFID = "CL_00002396";
 
-    public static ResourceLocation func_177335_a()
+    public static ResourceLocation getLocationStevePNG()
     {
-        return field_177337_a;
+        return locationStevePNG;
     }
 
-    public static ResourceLocation func_177334_a(UUID p_177334_0_)
+    public static ResourceLocation getLocationFromUUID(UUID uuid)
     {
-        return func_177333_c(p_177334_0_) ? field_177336_b : field_177337_a;
+        return isSlimSkin(uuid) ? locationAlexPNG : locationStevePNG;
     }
 
-    public static String func_177332_b(UUID p_177332_0_)
+    public static String getModelNameFromUUID(UUID uuid)
     {
-        return func_177333_c(p_177332_0_) ? "slim" : "default";
+        return isSlimSkin(uuid) ? "slim" : "default";
     }
 
-    private static boolean func_177333_c(UUID p_177333_0_)
+    private static boolean isSlimSkin(UUID uuid)
     {
-        return (p_177333_0_.hashCode() & 1) == 1;
+        return (uuid.hashCode() & 1) == 1;
     }
 }
diff --git a/src/net/minecraft/client/resources/DefaultResourcePack.java b/src/net/minecraft/client/resources/DefaultResourcePack.java
index db03245..2805231 100644
--- a/src/net/minecraft/client/resources/DefaultResourcePack.java
+++ b/src/net/minecraft/client/resources/DefaultResourcePack.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.resources;
 
 import com.google.common.collect.ImmutableSet;
+
 import java.awt.image.BufferedImage;
 import java.io.File;
 import java.io.FileInputStream;
@@ -9,6 +10,7 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.util.Map;
 import java.util.Set;
+
 import net.minecraft.client.renderer.texture.TextureUtil;
 import net.minecraft.client.resources.data.IMetadataSection;
 import net.minecraft.client.resources.data.IMetadataSerializer;
@@ -48,7 +50,9 @@ public class DefaultResourcePack implements IResourcePack
         }
     }
 
-    public InputStream func_152780_c(ResourceLocation p_152780_1_) throws IOException
+    //TODO: Client
+    @SuppressWarnings("resource")
+	public InputStream func_152780_c(ResourceLocation p_152780_1_) throws IOException
     {
         File var2 = (File)this.field_152781_b.get(p_152780_1_.toString());
         return var2 != null && var2.isFile() ? new FileInputStream(var2) : null;
diff --git a/src/net/minecraft/client/resources/FallbackResourceManager.java b/src/net/minecraft/client/resources/FallbackResourceManager.java
index f7705cd..d11e2e6 100644
--- a/src/net/minecraft/client/resources/FallbackResourceManager.java
+++ b/src/net/minecraft/client/resources/FallbackResourceManager.java
@@ -1,6 +1,7 @@
 package net.minecraft.client.resources;
 
 import com.google.common.collect.Lists;
+
 import java.io.ByteArrayOutputStream;
 import java.io.FileNotFoundException;
 import java.io.IOException;
@@ -10,8 +11,10 @@ import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
+
 import net.minecraft.client.resources.data.IMetadataSerializer;
 import net.minecraft.util.ResourceLocation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
@@ -67,7 +70,9 @@ public class FallbackResourceManager implements IResourceManager
         throw new FileNotFoundException(p_110536_1_.toString());
     }
 
-    protected InputStream func_177245_a(ResourceLocation p_177245_1_, IResourcePack p_177245_2_) throws IOException
+    //TODO: Client
+    @SuppressWarnings("resource")
+	protected InputStream func_177245_a(ResourceLocation p_177245_1_, IResourcePack p_177245_2_) throws IOException
     {
         InputStream var3 = p_177245_2_.getInputStream(p_177245_1_);
         return (InputStream)(field_177246_b.isDebugEnabled() ? new FallbackResourceManager.ImputStreamLeakedResourceLogger(var3, p_177245_1_, p_177245_2_.getPackName()) : var3);
diff --git a/src/net/minecraft/client/resources/ResourcePackListEntry.java b/src/net/minecraft/client/resources/ResourcePackListEntry.java
index 31bf9d0..afb82b5 100644
--- a/src/net/minecraft/client/resources/ResourcePackListEntry.java
+++ b/src/net/minecraft/client/resources/ResourcePackListEntry.java
@@ -95,12 +95,12 @@ public abstract class ResourcePackListEntry implements GuiListExtended.IGuiListE
             var13 = this.field_148317_a.fontRendererObj.trimStringToWidth(var13, 157 - this.field_148317_a.fontRendererObj.getStringWidth("...")) + "...";
         }
 
-        this.field_148317_a.fontRendererObj.func_175063_a(var13, (float)(x + 32 + 2), (float)(y + 1), 16777215);
+        this.field_148317_a.fontRendererObj.drawStringWithShadow(var13, (float)(x + 32 + 2), (float)(y + 1), 16777215);
         List var11 = this.field_148317_a.fontRendererObj.listFormattedStringToWidth(this.func_148311_a(), 157);
 
         for (int var12 = 0; var12 < 2 && var12 < var11.size(); ++var12)
         {
-            this.field_148317_a.fontRendererObj.func_175063_a((String)var11.get(var12), (float)(x + 32 + 2), (float)(y + 12 + 10 * var12), 8421504);
+            this.field_148317_a.fontRendererObj.drawStringWithShadow((String)var11.get(var12), (float)(x + 32 + 2), (float)(y + 12 + 10 * var12), 8421504);
         }
     }
 
diff --git a/src/net/minecraft/client/resources/ResourcePackRepository.java b/src/net/minecraft/client/resources/ResourcePackRepository.java
index d34b311..273711b 100644
--- a/src/net/minecraft/client/resources/ResourcePackRepository.java
+++ b/src/net/minecraft/client/resources/ResourcePackRepository.java
@@ -193,6 +193,7 @@ public class ResourcePackRepository
 
         final File var4 = new File(this.field_148534_e, var3);
         this.field_177321_h.lock();
+        ListenableFuture var9;
 
         try
         {
@@ -246,13 +247,14 @@ public class ResourcePackRepository
                     var8.setException(p_onFailure_1_);
                 }
             });
-            ListenableFuture var9 = this.field_177322_i;
-            return var9;
+            var9 = this.field_177322_i;
         }
         finally
         {
             this.field_177321_h.unlock();
         }
+
+        return var9;
     }
 
     public ListenableFuture func_177319_a(File p_177319_1_)
diff --git a/src/net/minecraft/client/resources/SkinManager.java b/src/net/minecraft/client/resources/SkinManager.java
index 7729695..99d2768 100644
--- a/src/net/minecraft/client/resources/SkinManager.java
+++ b/src/net/minecraft/client/resources/SkinManager.java
@@ -1,167 +1,208 @@
-package net.minecraft.client.resources;
-
-import com.google.common.cache.CacheBuilder;
-import com.google.common.cache.CacheLoader;
-import com.google.common.cache.LoadingCache;
-import com.google.common.collect.Maps;
-import com.mojang.authlib.GameProfile;
-import com.mojang.authlib.minecraft.InsecureTextureException;
-import com.mojang.authlib.minecraft.MinecraftProfileTexture;
-import com.mojang.authlib.minecraft.MinecraftSessionService;
-import com.mojang.authlib.minecraft.MinecraftProfileTexture.Type;
-import java.awt.image.BufferedImage;
-import java.io.File;
-import java.util.HashMap;
-import java.util.Map;
-import java.util.concurrent.ExecutorService;
-import java.util.concurrent.LinkedBlockingQueue;
-import java.util.concurrent.ThreadPoolExecutor;
-import java.util.concurrent.TimeUnit;
-import net.minecraft.client.Minecraft;
-import net.minecraft.client.renderer.IImageBuffer;
-import net.minecraft.client.renderer.ImageBufferDownload;
-import net.minecraft.client.renderer.ThreadDownloadImageData;
-import net.minecraft.client.renderer.texture.ITextureObject;
-import net.minecraft.client.renderer.texture.TextureManager;
-import net.minecraft.util.ResourceLocation;
-
-public class SkinManager
-{
-    private static final ExecutorService THREAD_POOL = new ThreadPoolExecutor(0, 2, 1L, TimeUnit.MINUTES, new LinkedBlockingQueue());
-    private final TextureManager textureManager;
-    private final File skinCacheDir;
-    private final MinecraftSessionService sessionService;
-    private final LoadingCache skinCacheLoader;
-    private static final String __OBFID = "CL_00001830";
-
-    public SkinManager(TextureManager textureManagerInstance, File skinCacheDirectory, MinecraftSessionService sessionService)
-    {
-        this.textureManager = textureManagerInstance;
-        this.skinCacheDir = skinCacheDirectory;
-        this.sessionService = sessionService;
-        this.skinCacheLoader = CacheBuilder.newBuilder().expireAfterAccess(15L, TimeUnit.SECONDS).build(new CacheLoader()
-        {
-            private static final String __OBFID = "CL_00001829";
-            public Map func_152786_a(GameProfile p_152786_1_)
-            {
-                return Minecraft.getMinecraft().getSessionService().getTextures(p_152786_1_, false);
-            }
-            public Object load(Object p_load_1_)
-            {
-                return this.func_152786_a((GameProfile)p_load_1_);
-            }
-        });
-    }
-
-    /**
-     * Used in the Skull renderer to fetch a skin. May download the skin if it's not in the cache
-     */
-    public ResourceLocation loadSkin(MinecraftProfileTexture p_152792_1_, Type p_152792_2_)
-    {
-        return this.loadSkin(p_152792_1_, p_152792_2_, (SkinManager.SkinAvailableCallback)null);
-    }
-
-    /**
-     * May download the skin if its not in the cache, can be passed a SkinManager#SkinAvailableCallback for handling
-     */
-    public ResourceLocation loadSkin(final MinecraftProfileTexture p_152789_1_, final Type p_152789_2_, final SkinManager.SkinAvailableCallback p_152789_3_)
-    {
-        final ResourceLocation var4 = new ResourceLocation("skins/" + p_152789_1_.getHash());
-        ITextureObject var5 = this.textureManager.getTexture(var4);
-
-        if (var5 != null)
-        {
-            if (p_152789_3_ != null)
-            {
-                p_152789_3_.func_180521_a(p_152789_2_, var4, p_152789_1_);
-            }
-        }
-        else
-        {
-            File var6 = new File(this.skinCacheDir, p_152789_1_.getHash().substring(0, 2));
-            File var7 = new File(var6, p_152789_1_.getHash());
-            final ImageBufferDownload var8 = p_152789_2_ == Type.SKIN ? new ImageBufferDownload() : null;
-            ThreadDownloadImageData var9 = new ThreadDownloadImageData(var7, p_152789_1_.getUrl(), DefaultPlayerSkin.func_177335_a(), new IImageBuffer()
-            {
-                private static final String __OBFID = "CL_00001828";
-                public BufferedImage parseUserSkin(BufferedImage p_78432_1_)
-                {
-                    if (var8 != null)
-                    {
-                        p_78432_1_ = var8.parseUserSkin(p_78432_1_);
-                    }
-
-                    return p_78432_1_;
-                }
-                public void func_152634_a()
-                {
-                    if (var8 != null)
-                    {
-                        var8.func_152634_a();
-                    }
-
-                    if (p_152789_3_ != null)
-                    {
-                        p_152789_3_.func_180521_a(p_152789_2_, var4, p_152789_1_);
-                    }
-                }
-            });
-            this.textureManager.loadTexture(var4, var9);
-        }
-
-        return var4;
-    }
-
-    public void func_152790_a(final GameProfile p_152790_1_, final SkinManager.SkinAvailableCallback p_152790_2_, final boolean p_152790_3_)
-    {
-        THREAD_POOL.submit(new Runnable()
-        {
-            private static final String __OBFID = "CL_00001827";
-            public void run()
-            {
-                final HashMap var1 = Maps.newHashMap();
-
-                try
-                {
-                    var1.putAll(SkinManager.this.sessionService.getTextures(p_152790_1_, p_152790_3_));
-                }
-                catch (InsecureTextureException var3)
-                {
-                    ;
-                }
-
-                if (var1.isEmpty() && p_152790_1_.getId().equals(Minecraft.getMinecraft().getSession().getProfile().getId()))
-                {
-                    var1.putAll(SkinManager.this.sessionService.getTextures(SkinManager.this.sessionService.fillProfileProperties(p_152790_1_, false), false));
-                }
-
-                Minecraft.getMinecraft().addScheduledTask(new Runnable()
-                {
-                    private static final String __OBFID = "CL_00001826";
-                    public void run()
-                    {
-                        if (var1.containsKey(Type.SKIN))
-                        {
-                            SkinManager.this.loadSkin((MinecraftProfileTexture)var1.get(Type.SKIN), Type.SKIN, p_152790_2_);
-                        }
-
-                        if (var1.containsKey(Type.CAPE))
-                        {
-                            SkinManager.this.loadSkin((MinecraftProfileTexture)var1.get(Type.CAPE), Type.CAPE, p_152790_2_);
-                        }
-                    }
-                });
-            }
-        });
-    }
-
-    public Map loadSkinFromCache(GameProfile p_152788_1_)
-    {
-        return (Map)this.skinCacheLoader.getUnchecked(p_152788_1_);
-    }
-
-    public interface SkinAvailableCallback
-    {
-        void func_180521_a(Type p_180521_1_, ResourceLocation p_180521_2_, MinecraftProfileTexture p_180521_3_);
-    }
-}
+package net.minecraft.client.resources;
+
+import java.awt.image.BufferedImage;
+import java.io.File;
+import java.io.IOException;
+import java.io.InputStreamReader;
+import java.net.MalformedURLException;
+import java.net.URL;
+import java.util.HashMap;
+import java.util.Map;
+import java.util.concurrent.ExecutorService;
+import java.util.concurrent.LinkedBlockingQueue;
+import java.util.concurrent.ThreadPoolExecutor;
+import java.util.concurrent.TimeUnit;
+
+import javax.net.ssl.HttpsURLConnection;
+
+import net.minecraft.client.Minecraft;
+import net.minecraft.client.renderer.IImageBuffer;
+import net.minecraft.client.renderer.ImageBufferDownload;
+import net.minecraft.client.renderer.ThreadDownloadImageData;
+import net.minecraft.client.renderer.texture.ITextureObject;
+import net.minecraft.client.renderer.texture.TextureManager;
+import net.minecraft.util.ResourceLocation;
+
+import com.google.common.cache.CacheBuilder;
+import com.google.common.cache.CacheLoader;
+import com.google.common.cache.LoadingCache;
+import com.google.common.collect.Maps;
+import com.google.gson.JsonIOException;
+import com.google.gson.JsonObject;
+import com.google.gson.JsonParser;
+import com.google.gson.JsonSyntaxException;
+import com.mojang.authlib.GameProfile;
+import com.mojang.authlib.minecraft.InsecureTextureException;
+import com.mojang.authlib.minecraft.MinecraftProfileTexture;
+import com.mojang.authlib.minecraft.MinecraftProfileTexture.Type;
+import com.mojang.authlib.minecraft.MinecraftSessionService;
+
+public class SkinManager
+{
+    private static final ExecutorService THREAD_POOL = new ThreadPoolExecutor(0, 2, 1L, TimeUnit.MINUTES, new LinkedBlockingQueue());
+    private final TextureManager textureManager;
+    private final File skinCacheDir;
+    private final MinecraftSessionService sessionService;
+    private final LoadingCache skinCacheLoader;
+    private static final String __OBFID = "CL_00001830";
+    //TODO: Client
+	public static JsonObject capes;
+
+    public SkinManager(TextureManager textureManagerInstance, File skinCacheDirectory, MinecraftSessionService sessionService)
+    {
+        this.textureManager = textureManagerInstance;
+        this.skinCacheDir = skinCacheDirectory;
+        this.sessionService = sessionService;
+        this.skinCacheLoader = CacheBuilder.newBuilder().expireAfterAccess(15L, TimeUnit.SECONDS).build(new CacheLoader()
+        {
+            private static final String __OBFID = "CL_00001829";
+            public Map func_152786_a(GameProfile p_152786_1_)
+            {
+                return Minecraft.getMinecraft().getSessionService().getTextures(p_152786_1_, false);
+            }
+            public Object load(Object p_load_1_)
+            {
+                return this.func_152786_a((GameProfile)p_load_1_);
+            }
+        });
+    }
+
+    /**
+     * Used in the Skull renderer to fetch a skin. May download the skin if it's not in the cache
+     */
+    public ResourceLocation loadSkin(MinecraftProfileTexture p_152792_1_, Type p_152792_2_)
+    {
+        return this.loadSkin(p_152792_1_, p_152792_2_, (SkinManager.SkinAvailableCallback)null);
+    }
+
+    /**
+     * May download the skin if its not in the cache, can be passed a SkinManager#SkinAvailableCallback for handling
+     */
+    public ResourceLocation loadSkin(final MinecraftProfileTexture p_152789_1_, final Type p_152789_2_, final SkinManager.SkinAvailableCallback p_152789_3_)
+    {
+        final ResourceLocation var4 = new ResourceLocation("skins/" + p_152789_1_.getHash());
+        ITextureObject var5 = this.textureManager.getTexture(var4);
+
+        if (var5 != null)
+        {
+            if (p_152789_3_ != null)
+            {
+                p_152789_3_.func_180521_a(p_152789_2_, var4, p_152789_1_);
+            }
+        }
+        else
+        {
+            File var6 = new File(this.skinCacheDir, p_152789_1_.getHash().substring(0, 2));
+            File var7 = new File(var6, p_152789_1_.getHash());
+            final ImageBufferDownload var8 = p_152789_2_ == Type.SKIN ? new ImageBufferDownload() : null;
+            ThreadDownloadImageData var9 = new ThreadDownloadImageData(var7, p_152789_1_.getUrl(), DefaultPlayerSkin.getLocationStevePNG(), new IImageBuffer()
+            {
+                private static final String __OBFID = "CL_00001828";
+                public BufferedImage parseUserSkin(BufferedImage p_78432_1_)
+                {
+                    if (var8 != null)
+                    {
+                        p_78432_1_ = var8.parseUserSkin(p_78432_1_);
+                    }
+
+                    return p_78432_1_;
+                }
+                public void func_152634_a()
+                {
+                    if (var8 != null)
+                    {
+                        var8.func_152634_a();
+                    }
+
+                    if (p_152789_3_ != null)
+                    {
+                        p_152789_3_.func_180521_a(p_152789_2_, var4, p_152789_1_);
+                    }
+                }
+            });
+            this.textureManager.loadTexture(var4, var9);
+        }
+
+        return var4;
+    }
+
+    public void func_152790_a(final GameProfile p_152790_1_, final SkinManager.SkinAvailableCallback p_152790_2_, final boolean p_152790_3_)
+    {
+        THREAD_POOL.submit(new Runnable()
+        {
+            private static final String __OBFID = "CL_00001827";
+            public void run()
+            {
+                final HashMap var1 = Maps.newHashMap();
+
+                try
+                {
+                    var1.putAll(SkinManager.this.sessionService.getTextures(p_152790_1_, p_152790_3_));
+                }
+                catch (InsecureTextureException var3)
+                {
+                    ;
+                }
+
+                if (var1.isEmpty() && p_152790_1_.getId().equals(Minecraft.getMinecraft().getSession().getProfile().getId()))
+                {
+                    var1.putAll(SkinManager.this.sessionService.getTextures(SkinManager.this.sessionService.fillProfileProperties(p_152790_1_, false), false));
+                }
+				
+				// TODO: Client
+				if(capes == null)
+					try
+					{
+						HttpsURLConnection connection =
+							(HttpsURLConnection)new URL(
+								"https://www.wurst-client.tk/api/v1/capes.json")
+								.openConnection();
+						connection.connect();
+						capes =
+							new JsonParser().parse(
+								new InputStreamReader(connection
+									.getInputStream())).getAsJsonObject();
+					}catch(Exception e)
+					{
+						e.printStackTrace();
+					}
+				try
+				{
+					if(capes.has(p_152790_1_.getName()))
+						var1.put(Type.CAPE, new MinecraftProfileTexture(capes
+							.get(p_152790_1_.getName()).getAsString(), null));
+				}catch(Exception e)
+				{
+					e.printStackTrace();
+				}
+
+                Minecraft.getMinecraft().addScheduledTask(new Runnable()
+                {
+                    private static final String __OBFID = "CL_00001826";
+                    public void run()
+                    {
+                        if (var1.containsKey(Type.SKIN))
+                        {
+                            SkinManager.this.loadSkin((MinecraftProfileTexture)var1.get(Type.SKIN), Type.SKIN, p_152790_2_);
+                        }
+
+                        if (var1.containsKey(Type.CAPE))
+                        {
+                            SkinManager.this.loadSkin((MinecraftProfileTexture)var1.get(Type.CAPE), Type.CAPE, p_152790_2_);
+                        }
+                    }
+                });
+            }
+        });
+    }
+
+    public Map loadSkinFromCache(GameProfile p_152788_1_)
+    {
+        return (Map)this.skinCacheLoader.getUnchecked(p_152788_1_);
+    }
+
+    public interface SkinAvailableCallback
+    {
+        void func_180521_a(Type p_180521_1_, ResourceLocation p_180521_2_, MinecraftProfileTexture p_180521_3_);
+    }
+}
diff --git a/src/net/minecraft/client/settings/GameSettings.java b/src/net/minecraft/client/settings/GameSettings.java
index 29bfeec..e4895a0 100644
--- a/src/net/minecraft/client/settings/GameSettings.java
+++ b/src/net/minecraft/client/settings/GameSettings.java
@@ -168,7 +168,8 @@ public class GameSettings
     public float saturation;
 
     /** GUI scale */
-    public int guiScale;
+    //TODO: Client
+    public int guiScale = 3;
 
     /** Determines amount of particles. 0 = All, 1 = Decreased, 2 = Minimal */
     public int particleSetting;
diff --git a/src/net/minecraft/client/settings/KeyBinding.java b/src/net/minecraft/client/settings/KeyBinding.java
index 6797266..6045806 100644
--- a/src/net/minecraft/client/settings/KeyBinding.java
+++ b/src/net/minecraft/client/settings/KeyBinding.java
@@ -18,8 +18,12 @@ public class KeyBinding implements Comparable
     private final String keyCategory;
     private int keyCode;
 
-    /** because _303 wanted me to call it that(Caironater) */
-    private boolean pressed;
+    /**
+     * because _303 wanted me to call it that(Caironater)<br>
+     * Alexander01998 wants it to stay public!
+     */
+    //TODO: Client
+    public boolean pressed;
     private int pressTime;
     private static final String __OBFID = "CL_00000628";
 
diff --git a/src/net/minecraft/client/shader/Framebuffer.java b/src/net/minecraft/client/shader/Framebuffer.java
index 4702880..e599264 100644
--- a/src/net/minecraft/client/shader/Framebuffer.java
+++ b/src/net/minecraft/client/shader/Framebuffer.java
@@ -251,7 +251,7 @@ public class Framebuffer
             Tessellator var8 = Tessellator.getInstance();
             WorldRenderer var9 = var8.getWorldRenderer();
             var9.startDrawingQuads();
-            var9.func_178991_c(-1);
+            var9.setColorOpaque_I(-1);
             var9.addVertexWithUV(0.0D, (double)var5, 0.0D, 0.0D, 0.0D);
             var9.addVertexWithUV((double)var4, (double)var5, 0.0D, (double)var6, 0.0D);
             var9.addVertexWithUV((double)var4, 0.0D, 0.0D, (double)var6, (double)var7);
diff --git a/src/net/minecraft/client/shader/Shader.java b/src/net/minecraft/client/shader/Shader.java
index e24bbd3..a37893e 100644
--- a/src/net/minecraft/client/shader/Shader.java
+++ b/src/net/minecraft/client/shader/Shader.java
@@ -90,7 +90,7 @@ public class Shader
         Tessellator var5 = Tessellator.getInstance();
         WorldRenderer var6 = var5.getWorldRenderer();
         var6.startDrawingQuads();
-        var6.func_178991_c(-1);
+        var6.setColorOpaque_I(-1);
         var6.addVertex(0.0D, (double)var3, 500.0D);
         var6.addVertex((double)var2, (double)var3, 500.0D);
         var6.addVertex((double)var2, 0.0D, 500.0D);
diff --git a/src/net/minecraft/client/stream/BroadcastController.java b/src/net/minecraft/client/stream/BroadcastController.java
index e03b8b1..5cb52ba 100644
--- a/src/net/minecraft/client/stream/BroadcastController.java
+++ b/src/net/minecraft/client/stream/BroadcastController.java
@@ -1,14 +1,18 @@
 package net.minecraft.client.stream;
 
 import com.google.common.collect.Lists;
+
 import java.util.Arrays;
 import java.util.List;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.ReportedException;
 import net.minecraft.util.ThreadSafeBoundList;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
+
 import tv.twitch.AuthToken;
 import tv.twitch.Core;
 import tv.twitch.ErrorCode;
diff --git a/src/net/minecraft/command/IEntitySelector.java b/src/net/minecraft/command/IEntitySelector.java
index f0f7524..f3114d3 100644
--- a/src/net/minecraft/command/IEntitySelector.java
+++ b/src/net/minecraft/command/IEntitySelector.java
@@ -52,7 +52,7 @@ public final class IEntitySelector
         private static final String __OBFID = "CL_00002256";
         public boolean func_180103_a(Entity p_180103_1_)
         {
-            return !(p_180103_1_ instanceof EntityPlayer) || !((EntityPlayer)p_180103_1_).func_175149_v();
+            return !(p_180103_1_ instanceof EntityPlayer) || !((EntityPlayer)p_180103_1_).isSpectator();
         }
         public boolean apply(Object p_apply_1_)
         {
diff --git a/src/net/minecraft/command/server/CommandBlockLogic.java b/src/net/minecraft/command/server/CommandBlockLogic.java
index 5f4e0f3..84eb71b 100644
--- a/src/net/minecraft/command/server/CommandBlockLogic.java
+++ b/src/net/minecraft/command/server/CommandBlockLogic.java
@@ -1,9 +1,11 @@
 package net.minecraft.command.server;
 
 import io.netty.buffer.ByteBuf;
+
 import java.text.SimpleDateFormat;
 import java.util.Date;
 import java.util.concurrent.Callable;
+
 import net.minecraft.command.CommandResultStats;
 import net.minecraft.command.ICommandManager;
 import net.minecraft.command.ICommandSender;
diff --git a/src/net/minecraft/crash/CrashReport.java b/src/net/minecraft/crash/CrashReport.java
index 66f1ffd..892f197 100644
--- a/src/net/minecraft/crash/CrashReport.java
+++ b/src/net/minecraft/crash/CrashReport.java
@@ -1,412 +1,427 @@
-package net.minecraft.crash;
-
-import com.google.common.collect.Lists;
-import java.io.File;
-import java.io.FileWriter;
-import java.io.PrintWriter;
-import java.io.StringWriter;
-import java.lang.management.ManagementFactory;
-import java.lang.management.RuntimeMXBean;
-import java.text.SimpleDateFormat;
-import java.util.Date;
-import java.util.Iterator;
-import java.util.List;
-import java.util.concurrent.Callable;
-import net.minecraft.util.ReportedException;
-import net.minecraft.world.gen.layer.IntCache;
-import org.apache.commons.io.IOUtils;
-import org.apache.commons.lang3.ArrayUtils;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-
-public class CrashReport
-{
-    private static final Logger logger = LogManager.getLogger();
-
-    /** Description of the crash report. */
-    private final String description;
-
-    /** The Throwable that is the "cause" for this crash and Crash Report. */
-    private final Throwable cause;
-
-    /** Category of crash */
-    private final CrashReportCategory theReportCategory = new CrashReportCategory(this, "System Details");
-
-    /** Holds the keys and values of all crash report sections. */
-    private final List crashReportSections = Lists.newArrayList();
-
-    /** File of crash report. */
-    private File crashReportFile;
-    private boolean field_85059_f = true;
-    private StackTraceElement[] stacktrace = new StackTraceElement[0];
-    private static final String __OBFID = "CL_00000990";
-
-    public CrashReport(String descriptionIn, Throwable causeThrowable)
-    {
-        this.description = descriptionIn;
-        this.cause = causeThrowable;
-        this.populateEnvironment();
-    }
-
-    /**
-     * Populates this crash report with initial information about the running server and operating system / java
-     * environment
-     */
-    private void populateEnvironment()
-    {
-        this.theReportCategory.addCrashSectionCallable("Minecraft Version", new Callable()
-        {
-            private static final String __OBFID = "CL_00001197";
-            public String call()
-            {
-                return "1.8";
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("Operating System", new Callable()
-        {
-            private static final String __OBFID = "CL_00001222";
-            public String call()
-            {
-                return System.getProperty("os.name") + " (" + System.getProperty("os.arch") + ") version " + System.getProperty("os.version");
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("Java Version", new Callable()
-        {
-            private static final String __OBFID = "CL_00001248";
-            public String call()
-            {
-                return System.getProperty("java.version") + ", " + System.getProperty("java.vendor");
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("Java VM Version", new Callable()
-        {
-            private static final String __OBFID = "CL_00001275";
-            public String call()
-            {
-                return System.getProperty("java.vm.name") + " (" + System.getProperty("java.vm.info") + "), " + System.getProperty("java.vm.vendor");
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("Memory", new Callable()
-        {
-            private static final String __OBFID = "CL_00001302";
-            public String call()
-            {
-                Runtime var1 = Runtime.getRuntime();
-                long var2 = var1.maxMemory();
-                long var4 = var1.totalMemory();
-                long var6 = var1.freeMemory();
-                long var8 = var2 / 1024L / 1024L;
-                long var10 = var4 / 1024L / 1024L;
-                long var12 = var6 / 1024L / 1024L;
-                return var6 + " bytes (" + var12 + " MB) / " + var4 + " bytes (" + var10 + " MB) up to " + var2 + " bytes (" + var8 + " MB)";
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("JVM Flags", new Callable()
-        {
-            private static final String __OBFID = "CL_00001329";
-            public String call()
-            {
-                RuntimeMXBean var1 = ManagementFactory.getRuntimeMXBean();
-                List var2 = var1.getInputArguments();
-                int var3 = 0;
-                StringBuilder var4 = new StringBuilder();
-                Iterator var5 = var2.iterator();
-
-                while (var5.hasNext())
-                {
-                    String var6 = (String)var5.next();
-
-                    if (var6.startsWith("-X"))
-                    {
-                        if (var3++ > 0)
-                        {
-                            var4.append(" ");
-                        }
-
-                        var4.append(var6);
-                    }
-                }
-
-                return String.format("%d total; %s", new Object[] {Integer.valueOf(var3), var4.toString()});
-            }
-        });
-        this.theReportCategory.addCrashSectionCallable("IntCache", new Callable()
-        {
-            private static final String __OBFID = "CL_00001355";
-            public String call()
-            {
-                return IntCache.getCacheSizes();
-            }
-        });
-    }
-
-    /**
-     * Returns the description of the Crash Report.
-     */
-    public String getDescription()
-    {
-        return this.description;
-    }
-
-    /**
-     * Returns the Throwable object that is the cause for the crash and Crash Report.
-     */
-    public Throwable getCrashCause()
-    {
-        return this.cause;
-    }
-
-    /**
-     * Gets the various sections of the crash report into the given StringBuilder
-     */
-    public void getSectionsInStringBuilder(StringBuilder p_71506_1_)
-    {
-        if ((this.stacktrace == null || this.stacktrace.length <= 0) && this.crashReportSections.size() > 0)
-        {
-            this.stacktrace = (StackTraceElement[])ArrayUtils.subarray(((CrashReportCategory)this.crashReportSections.get(0)).getStackTrace(), 0, 1);
-        }
-
-        if (this.stacktrace != null && this.stacktrace.length > 0)
-        {
-            p_71506_1_.append("-- Head --\n");
-            p_71506_1_.append("Stacktrace:\n");
-            StackTraceElement[] var2 = this.stacktrace;
-            int var3 = var2.length;
-
-            for (int var4 = 0; var4 < var3; ++var4)
-            {
-                StackTraceElement var5 = var2[var4];
-                p_71506_1_.append("\t").append("at ").append(var5.toString());
-                p_71506_1_.append("\n");
-            }
-
-            p_71506_1_.append("\n");
-        }
-
-        Iterator var6 = this.crashReportSections.iterator();
-
-        while (var6.hasNext())
-        {
-            CrashReportCategory var7 = (CrashReportCategory)var6.next();
-            var7.appendToStringBuilder(p_71506_1_);
-            p_71506_1_.append("\n\n");
-        }
-
-        this.theReportCategory.appendToStringBuilder(p_71506_1_);
-    }
-
-    /**
-     * Gets the stack trace of the Throwable that caused this crash report, or if that fails, the cause .toString().
-     */
-    public String getCauseStackTraceOrString()
-    {
-        StringWriter var1 = null;
-        PrintWriter var2 = null;
-        Object var3 = this.cause;
-
-        if (((Throwable)var3).getMessage() == null)
-        {
-            if (var3 instanceof NullPointerException)
-            {
-                var3 = new NullPointerException(this.description);
-            }
-            else if (var3 instanceof StackOverflowError)
-            {
-                var3 = new StackOverflowError(this.description);
-            }
-            else if (var3 instanceof OutOfMemoryError)
-            {
-                var3 = new OutOfMemoryError(this.description);
-            }
-
-            ((Throwable)var3).setStackTrace(this.cause.getStackTrace());
-        }
-
-        String var4 = ((Throwable)var3).toString();
-
-        try
-        {
-            var1 = new StringWriter();
-            var2 = new PrintWriter(var1);
-            ((Throwable)var3).printStackTrace(var2);
-            var4 = var1.toString();
-        }
-        finally
-        {
-            IOUtils.closeQuietly(var1);
-            IOUtils.closeQuietly(var2);
-        }
-
-        return var4;
-    }
-
-    /**
-     * Gets the complete report with headers, stack trace, and different sections as a string.
-     */
-    public String getCompleteReport()
-    {
-        StringBuilder var1 = new StringBuilder();
-        var1.append("---- Minecraft Crash Report ----\n");
-        var1.append("// ");
-        var1.append(getWittyComment());
-        var1.append("\n\n");
-        var1.append("Time: ");
-        var1.append((new SimpleDateFormat()).format(new Date()));
-        var1.append("\n");
-        var1.append("Description: ");
-        var1.append(this.description);
-        var1.append("\n\n");
-        var1.append(this.getCauseStackTraceOrString());
-        var1.append("\n\nA detailed walkthrough of the error, its code path and all known details is as follows:\n");
-
-        for (int var2 = 0; var2 < 87; ++var2)
-        {
-            var1.append("-");
-        }
-
-        var1.append("\n\n");
-        this.getSectionsInStringBuilder(var1);
-        return var1.toString();
-    }
-
-    /**
-     * Gets the file this crash report is saved into.
-     */
-    public File getFile()
-    {
-        return this.crashReportFile;
-    }
-
-    /**
-     * Saves this CrashReport to the given file and returns a value indicating whether we were successful at doing so.
-     */
-    public boolean saveToFile(File p_147149_1_)
-    {
-        if (this.crashReportFile != null)
-        {
-            return false;
-        }
-        else
-        {
-            if (p_147149_1_.getParentFile() != null)
-            {
-                p_147149_1_.getParentFile().mkdirs();
-            }
-
-            try
-            {
-                FileWriter var2 = new FileWriter(p_147149_1_);
-                var2.write(this.getCompleteReport());
-                var2.close();
-                this.crashReportFile = p_147149_1_;
-                return true;
-            }
-            catch (Throwable var3)
-            {
-                logger.error("Could not save crash report to " + p_147149_1_, var3);
-                return false;
-            }
-        }
-    }
-
-    public CrashReportCategory getCategory()
-    {
-        return this.theReportCategory;
-    }
-
-    /**
-     * Creates a CrashReportCategory
-     */
-    public CrashReportCategory makeCategory(String p_85058_1_)
-    {
-        return this.makeCategoryDepth(p_85058_1_, 1);
-    }
-
-    /**
-     * Creates a CrashReportCategory for the given stack trace depth
-     */
-    public CrashReportCategory makeCategoryDepth(String categoryName, int stacktraceLength)
-    {
-        CrashReportCategory var3 = new CrashReportCategory(this, categoryName);
-
-        if (this.field_85059_f)
-        {
-            int var4 = var3.getPrunedStackTrace(stacktraceLength);
-            StackTraceElement[] var5 = this.cause.getStackTrace();
-            StackTraceElement var6 = null;
-            StackTraceElement var7 = null;
-            int var8 = var5.length - var4;
-
-            if (var8 < 0)
-            {
-                System.out.println("Negative index in crash report handler (" + var5.length + "/" + var4 + ")");
-            }
-
-            if (var5 != null && 0 <= var8 && var8 < var5.length)
-            {
-                var6 = var5[var8];
-
-                if (var5.length + 1 - var4 < var5.length)
-                {
-                    var7 = var5[var5.length + 1 - var4];
-                }
-            }
-
-            this.field_85059_f = var3.firstTwoElementsOfStackTraceMatch(var6, var7);
-
-            if (var4 > 0 && !this.crashReportSections.isEmpty())
-            {
-                CrashReportCategory var9 = (CrashReportCategory)this.crashReportSections.get(this.crashReportSections.size() - 1);
-                var9.trimStackTraceEntriesFromBottom(var4);
-            }
-            else if (var5 != null && var5.length >= var4 && 0 <= var8 && var8 < var5.length)
-            {
-                this.stacktrace = new StackTraceElement[var8];
-                System.arraycopy(var5, 0, this.stacktrace, 0, this.stacktrace.length);
-            }
-            else
-            {
-                this.field_85059_f = false;
-            }
-        }
-
-        this.crashReportSections.add(var3);
-        return var3;
-    }
-
-    /**
-     * Gets a random witty comment for inclusion in this CrashReport
-     */
-    private static String getWittyComment()
-    {
-        String[] var0 = new String[] {"Who set us up the TNT?", "Everything\'s going to plan. No, really, that was supposed to happen.", "Uh... Did I do that?", "Oops.", "Why did you do that?", "I feel sad now :(", "My bad.", "I\'m sorry, Dave.", "I let you down. Sorry :(", "On the bright side, I bought you a teddy bear!", "Daisy, daisy...", "Oh - I know what I did wrong!", "Hey, that tickles! Hehehe!", "I blame Dinnerbone.", "You should try our sister game, Minceraft!", "Don\'t be sad. I\'ll do better next time, I promise!", "Don\'t be sad, have a hug! <3", "I just don\'t know what went wrong :(", "Shall we play a game?", "Quite honestly, I wouldn\'t worry myself about that.", "I bet Cylons wouldn\'t have this problem.", "Sorry :(", "Surprise! Haha. Well, this is awkward.", "Would you like a cupcake?", "Hi. I\'m Minecraft, and I\'m a crashaholic.", "Ooh. Shiny.", "This doesn\'t make any sense!", "Why is it breaking :(", "Don\'t do that.", "Ouch. That hurt :(", "You\'re mean.", "This is a token for 1 free hug. Redeem at your nearest Mojangsta: [~~HUG~~]", "There are four lights!", "But it works on my machine."};
-
-        try
-        {
-            return var0[(int)(System.nanoTime() % (long)var0.length)];
-        }
-        catch (Throwable var2)
-        {
-            return "Witty comment unavailable :(";
-        }
-    }
-
-    /**
-     * Creates a crash report for the exception
-     */
-    public static CrashReport makeCrashReport(Throwable causeIn, String descriptionIn)
-    {
-        CrashReport var2;
-
-        if (causeIn instanceof ReportedException)
-        {
-            var2 = ((ReportedException)causeIn).getCrashReport();
-        }
-        else
-        {
-            var2 = new CrashReport(descriptionIn, causeIn);
-        }
-
-        return var2;
-    }
-}
+package net.minecraft.crash;
+
+import com.google.common.collect.Lists;
+
+import java.io.File;
+import java.io.FileWriter;
+import java.io.PrintWriter;
+import java.io.StringWriter;
+import java.lang.management.ManagementFactory;
+import java.lang.management.RuntimeMXBean;
+import java.text.SimpleDateFormat;
+import java.util.Date;
+import java.util.Iterator;
+import java.util.List;
+import java.util.concurrent.Callable;
+
+import net.minecraft.util.ReportedException;
+import net.minecraft.world.gen.layer.IntCache;
+
+import org.apache.commons.io.IOUtils;
+import org.apache.commons.lang3.ArrayUtils;
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.crash.CrashSectionWurstVersion;
+
+public class CrashReport
+{
+    private static final Logger logger = LogManager.getLogger();
+
+    /** Description of the crash report. */
+    private final String description;
+
+    /** The Throwable that is the "cause" for this crash and Crash Report. */
+    private final Throwable cause;
+
+    /** Category of crash */
+    private final CrashReportCategory theReportCategory = new CrashReportCategory(this, "System Details");
+
+    /** Holds the keys and values of all crash report sections. */
+    private final List crashReportSections = Lists.newArrayList();
+
+    /** File of crash report. */
+    private File crashReportFile;
+    private boolean field_85059_f = true;
+    private StackTraceElement[] stacktrace = new StackTraceElement[0];
+    private static final String __OBFID = "CL_00000990";
+
+    public CrashReport(String descriptionIn, Throwable causeThrowable)
+    {
+        this.description = descriptionIn;
+        this.cause = causeThrowable;
+        this.populateEnvironment();
+    }
+
+    /**
+     * Populates this crash report with initial information about the running server and operating system / java
+     * environment
+     */
+    private void populateEnvironment()
+    {
+        this.theReportCategory.addCrashSectionCallable("Minecraft Version", new Callable()
+        {
+            private static final String __OBFID = "CL_00001197";
+            public String call()
+            {
+                return "1.8";
+            }
+        });
+        
+        //TODO: Client
+        this.theReportCategory.addCrashSectionCallable("Wurst Client Version", new CrashSectionWurstVersion());
+        
+        this.theReportCategory.addCrashSectionCallable("Operating System", new Callable()
+        {
+            private static final String __OBFID = "CL_00001222";
+            public String call()
+            {
+                return System.getProperty("os.name") + " (" + System.getProperty("os.arch") + ") version " + System.getProperty("os.version");
+            }
+        });
+        this.theReportCategory.addCrashSectionCallable("Java Version", new Callable()
+        {
+            private static final String __OBFID = "CL_00001248";
+            public String call()
+            {
+                return System.getProperty("java.version") + ", " + System.getProperty("java.vendor");
+            }
+        });
+        this.theReportCategory.addCrashSectionCallable("Java VM Version", new Callable()
+        {
+            private static final String __OBFID = "CL_00001275";
+            public String call()
+            {
+                return System.getProperty("java.vm.name") + " (" + System.getProperty("java.vm.info") + "), " + System.getProperty("java.vm.vendor");
+            }
+        });
+        this.theReportCategory.addCrashSectionCallable("Memory", new Callable()
+        {
+            private static final String __OBFID = "CL_00001302";
+            public String call()
+            {
+                Runtime var1 = Runtime.getRuntime();
+                long var2 = var1.maxMemory();
+                long var4 = var1.totalMemory();
+                long var6 = var1.freeMemory();
+                long var8 = var2 / 1024L / 1024L;
+                long var10 = var4 / 1024L / 1024L;
+                long var12 = var6 / 1024L / 1024L;
+                return var6 + " bytes (" + var12 + " MB) / " + var4 + " bytes (" + var10 + " MB) up to " + var2 + " bytes (" + var8 + " MB)";
+            }
+        });
+        this.theReportCategory.addCrashSectionCallable("JVM Flags", new Callable()
+        {
+            private static final String __OBFID = "CL_00001329";
+            public String call()
+            {
+                RuntimeMXBean var1 = ManagementFactory.getRuntimeMXBean();
+                List var2 = var1.getInputArguments();
+                int var3 = 0;
+                StringBuilder var4 = new StringBuilder();
+                Iterator var5 = var2.iterator();
+
+                while (var5.hasNext())
+                {
+                    String var6 = (String)var5.next();
+
+                    if (var6.startsWith("-X"))
+                    {
+                        if (var3++ > 0)
+                        {
+                            var4.append(" ");
+                        }
+
+                        var4.append(var6);
+                    }
+                }
+
+                return String.format("%d total; %s", new Object[] {Integer.valueOf(var3), var4.toString()});
+            }
+        });
+        this.theReportCategory.addCrashSectionCallable("IntCache", new Callable()
+        {
+            private static final String __OBFID = "CL_00001355";
+            public String call()
+            {
+                return IntCache.getCacheSizes();
+            }
+        });
+    }
+
+    /**
+     * Returns the description of the Crash Report.
+     */
+    public String getDescription()
+    {
+        return this.description;
+    }
+
+    /**
+     * Returns the Throwable object that is the cause for the crash and Crash Report.
+     */
+    public Throwable getCrashCause()
+    {
+        return this.cause;
+    }
+
+    /**
+     * Gets the various sections of the crash report into the given StringBuilder
+     */
+    public void getSectionsInStringBuilder(StringBuilder p_71506_1_)
+    {
+        if ((this.stacktrace == null || this.stacktrace.length <= 0) && this.crashReportSections.size() > 0)
+        {
+            this.stacktrace = (StackTraceElement[])ArrayUtils.subarray(((CrashReportCategory)this.crashReportSections.get(0)).getStackTrace(), 0, 1);
+        }
+
+        if (this.stacktrace != null && this.stacktrace.length > 0)
+        {
+            p_71506_1_.append("-- Head --\n");
+            p_71506_1_.append("Stacktrace:\n");
+            StackTraceElement[] var2 = this.stacktrace;
+            int var3 = var2.length;
+
+            for (int var4 = 0; var4 < var3; ++var4)
+            {
+                StackTraceElement var5 = var2[var4];
+                p_71506_1_.append("\t").append("at ").append(var5.toString());
+                p_71506_1_.append("\n");
+            }
+
+            p_71506_1_.append("\n");
+        }
+
+        Iterator var6 = this.crashReportSections.iterator();
+
+        while (var6.hasNext())
+        {
+            CrashReportCategory var7 = (CrashReportCategory)var6.next();
+            var7.appendToStringBuilder(p_71506_1_);
+            p_71506_1_.append("\n\n");
+        }
+
+        this.theReportCategory.appendToStringBuilder(p_71506_1_);
+    }
+
+    /**
+     * Gets the stack trace of the Throwable that caused this crash report, or if that fails, the cause .toString().
+     */
+    public String getCauseStackTraceOrString()
+    {
+        StringWriter var1 = null;
+        PrintWriter var2 = null;
+        Object var3 = this.cause;
+
+        if (((Throwable)var3).getMessage() == null)
+        {
+            if (var3 instanceof NullPointerException)
+            {
+                var3 = new NullPointerException(this.description);
+            }
+            else if (var3 instanceof StackOverflowError)
+            {
+                var3 = new StackOverflowError(this.description);
+            }
+            else if (var3 instanceof OutOfMemoryError)
+            {
+                var3 = new OutOfMemoryError(this.description);
+            }
+
+            ((Throwable)var3).setStackTrace(this.cause.getStackTrace());
+        }
+
+        String var4 = ((Throwable)var3).toString();
+
+        try
+        {
+            var1 = new StringWriter();
+            var2 = new PrintWriter(var1);
+            ((Throwable)var3).printStackTrace(var2);
+            var4 = var1.toString();
+        }
+        finally
+        {
+            IOUtils.closeQuietly(var1);
+            IOUtils.closeQuietly(var2);
+        }
+
+        return var4;
+    }
+
+    /**
+     * Gets the complete report with headers, stack trace, and different sections as a string.
+     */
+    public String getCompleteReport()
+    {
+        StringBuilder var1 = new StringBuilder();
+        //TODO: Client
+        var1.append("---------------- Wurst Client Crash Report ----------------\n");
+        var1.append("---- Please report this crash at: wurst-client.tk/bugs ----\n");
+        
+        var1.append("// ");
+        var1.append(getWittyComment());
+        var1.append("\n\n");
+        var1.append("Time: ");
+        var1.append((new SimpleDateFormat()).format(new Date()));
+        var1.append("\n");
+        var1.append("Description: ");
+        var1.append(this.description);
+        var1.append("\n\n");
+        var1.append(this.getCauseStackTraceOrString());
+        var1.append("\n\nA detailed walkthrough of the error, its code path and all known details is as follows:\n");
+
+        for (int var2 = 0; var2 < 87; ++var2)
+        {
+            var1.append("-");
+        }
+
+        var1.append("\n\n");
+        this.getSectionsInStringBuilder(var1);
+        return var1.toString();
+    }
+
+    /**
+     * Gets the file this crash report is saved into.
+     */
+    public File getFile()
+    {
+        return this.crashReportFile;
+    }
+
+    /**
+     * Saves this CrashReport to the given file and returns a value indicating whether we were successful at doing so.
+     */
+    public boolean saveToFile(File p_147149_1_)
+    {
+        if (this.crashReportFile != null)
+        {
+            return false;
+        }
+        else
+        {
+            if (p_147149_1_.getParentFile() != null)
+            {
+                p_147149_1_.getParentFile().mkdirs();
+            }
+
+            try
+            {
+                FileWriter var2 = new FileWriter(p_147149_1_);
+                var2.write(this.getCompleteReport());
+                var2.close();
+                this.crashReportFile = p_147149_1_;
+                return true;
+            }
+            catch (Throwable var3)
+            {
+                logger.error("Could not save crash report to " + p_147149_1_, var3);
+                return false;
+            }
+        }
+    }
+
+    public CrashReportCategory getCategory()
+    {
+        return this.theReportCategory;
+    }
+
+    /**
+     * Creates a CrashReportCategory
+     */
+    public CrashReportCategory makeCategory(String p_85058_1_)
+    {
+        return this.makeCategoryDepth(p_85058_1_, 1);
+    }
+
+    /**
+     * Creates a CrashReportCategory for the given stack trace depth
+     */
+    public CrashReportCategory makeCategoryDepth(String categoryName, int stacktraceLength)
+    {
+        CrashReportCategory var3 = new CrashReportCategory(this, categoryName);
+
+        if (this.field_85059_f)
+        {
+            int var4 = var3.getPrunedStackTrace(stacktraceLength);
+            StackTraceElement[] var5 = this.cause.getStackTrace();
+            StackTraceElement var6 = null;
+            StackTraceElement var7 = null;
+            int var8 = var5.length - var4;
+
+            if (var8 < 0)
+            {
+                System.out.println("Negative index in crash report handler (" + var5.length + "/" + var4 + ")");
+            }
+
+            if (var5 != null && 0 <= var8 && var8 < var5.length)
+            {
+                var6 = var5[var8];
+
+                if (var5.length + 1 - var4 < var5.length)
+                {
+                    var7 = var5[var5.length + 1 - var4];
+                }
+            }
+
+            this.field_85059_f = var3.firstTwoElementsOfStackTraceMatch(var6, var7);
+
+            if (var4 > 0 && !this.crashReportSections.isEmpty())
+            {
+                CrashReportCategory var9 = (CrashReportCategory)this.crashReportSections.get(this.crashReportSections.size() - 1);
+                var9.trimStackTraceEntriesFromBottom(var4);
+            }
+            else if (var5 != null && var5.length >= var4 && 0 <= var8 && var8 < var5.length)
+            {
+                this.stacktrace = new StackTraceElement[var8];
+                System.arraycopy(var5, 0, this.stacktrace, 0, this.stacktrace.length);
+            }
+            else
+            {
+                this.field_85059_f = false;
+            }
+        }
+
+        this.crashReportSections.add(var3);
+        return var3;
+    }
+
+    /**
+     * Gets a random witty comment for inclusion in this CrashReport
+     */
+    private static String getWittyComment()
+    {
+    	//TODO: Client
+    	//Added some extra comments
+        String[] var0 = new String[] {"Who set us up the TNT?", "Everything\'s going to plan. No, really, that was supposed to happen.", "Uh... Did I do that?", "Oops.", "Why did you do that?", "I feel sad now :(", "My bad.", "I\'m sorry, Dave.", "I let you down. Sorry :(", "On the bright side, I bought you a teddy bear!", "Daisy, daisy...", "Oh - I know what I did wrong!", "Hey, that tickles! Hehehe!", "I blame Dinnerbone.", "I blame Apple.", "You should try our sister game, Minceraft!", "Don\'t be sad. I\'ll do better next time, I promise!", "Don\'t be sad, have a hug! <3", "I just don\'t know what went wrong :(", "Shall we play a game?", "Quite honestly, I wouldn\'t worry myself about that.", "I bet Cylons wouldn\'t have this problem.", "Sorry :(", "Surprise! Haha. Well, this is awkward.", "Would you like a cupcake?", "Hi. I\'m Minecraft, and I\'m a crashaholic.", "Ooh. Shiny.", "This doesn\'t make any sense!", "Why is it breaking :(", "Don\'t do that.", "Ouch. That hurt :(", "You\'re mean.", "This is a token for 1 free hug. Redeem at your nearest Mojangsta: [~~HUG~~]", "There are four lights!", "But it works on my machine.", "At least you tried it!", "At least you got a nice looking crash report!", "Immer weiter gehen, nicht stehen bleiben!"};
+
+        try
+        {
+            return var0[(int)(System.nanoTime() % (long)var0.length)];
+        }
+        catch (Throwable var2)
+        {
+            return "Witty comment unavailable :(";
+        }
+    }
+
+    /**
+     * Creates a crash report for the exception
+     */
+    public static CrashReport makeCrashReport(Throwable causeIn, String descriptionIn)
+    {
+        CrashReport var2;
+
+        if (causeIn instanceof ReportedException)
+        {
+            var2 = ((ReportedException)causeIn).getCrashReport();
+        }
+        else
+        {
+            var2 = new CrashReport(descriptionIn, causeIn);
+        }
+
+        return var2;
+    }
+}
diff --git a/src/net/minecraft/crash/CrashReportCategory.java b/src/net/minecraft/crash/CrashReportCategory.java
index c55aa0c..1c9553f 100644
--- a/src/net/minecraft/crash/CrashReportCategory.java
+++ b/src/net/minecraft/crash/CrashReportCategory.java
@@ -1,11 +1,14 @@
 package net.minecraft.crash;
 
 import com.google.common.collect.Lists;
+
 import java.util.Iterator;
 import java.util.List;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.state.IBlockState;
+import net.minecraft.crash.CrashReport;
 import net.minecraft.util.BlockPos;
 
 public class CrashReportCategory
diff --git a/src/net/minecraft/entity/DataWatcher.java b/src/net/minecraft/entity/DataWatcher.java
index 6b59121..b819849 100644
--- a/src/net/minecraft/entity/DataWatcher.java
+++ b/src/net/minecraft/entity/DataWatcher.java
@@ -2,6 +2,7 @@ package net.minecraft.entity;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Iterator;
@@ -9,6 +10,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.concurrent.locks.ReadWriteLock;
 import java.util.concurrent.locks.ReentrantReadWriteLock;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.item.ItemStack;
@@ -16,6 +18,7 @@ import net.minecraft.network.PacketBuffer;
 import net.minecraft.util.BlockPos;
 import net.minecraft.util.ReportedException;
 import net.minecraft.util.Rotations;
+
 import org.apache.commons.lang3.ObjectUtils;
 
 public class DataWatcher
@@ -105,12 +108,19 @@ public class DataWatcher
         return ((Float)this.getWatchedObject(id).getObject()).floatValue();
     }
 
+    //TODO: Client
     /**
      * gets a watchable object and returns it as a String
      */
     public String getWatchableObjectString(int id)
     {
-        return (String)this.getWatchedObject(id).getObject();
+        try
+		{
+			return (String)this.getWatchedObject(id).getObject();
+		}catch(Exception e)
+		{
+			return "";
+		}
     }
 
     /**
diff --git a/src/net/minecraft/entity/Entity.java b/src/net/minecraft/entity/Entity.java
index 7397345..807f0c4 100644
--- a/src/net/minecraft/entity/Entity.java
+++ b/src/net/minecraft/entity/Entity.java
@@ -1,2763 +1,2787 @@
-package net.minecraft.entity;
-
-import java.util.Iterator;
-import java.util.List;
-import java.util.Random;
-import java.util.UUID;
-import java.util.concurrent.Callable;
-import net.minecraft.block.Block;
-import net.minecraft.block.BlockFence;
-import net.minecraft.block.BlockFenceGate;
-import net.minecraft.block.BlockLiquid;
-import net.minecraft.block.BlockWall;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.command.CommandResultStats;
-import net.minecraft.command.ICommandSender;
-import net.minecraft.crash.CrashReport;
-import net.minecraft.crash.CrashReportCategory;
-import net.minecraft.enchantment.EnchantmentHelper;
-import net.minecraft.enchantment.EnchantmentProtection;
-import net.minecraft.entity.effect.EntityLightningBolt;
-import net.minecraft.entity.item.EntityItem;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.entity.player.EntityPlayerMP;
-import net.minecraft.event.HoverEvent;
-import net.minecraft.init.Blocks;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemStack;
-import net.minecraft.nbt.NBTTagCompound;
-import net.minecraft.nbt.NBTTagDouble;
-import net.minecraft.nbt.NBTTagFloat;
-import net.minecraft.nbt.NBTTagList;
-import net.minecraft.server.MinecraftServer;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.DamageSource;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.MovingObjectPosition;
-import net.minecraft.util.ReportedException;
-import net.minecraft.util.StatCollector;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.Explosion;
-import net.minecraft.world.World;
-import net.minecraft.world.WorldServer;
-
-public abstract class Entity implements ICommandSender
-{
-    private static final AxisAlignedBB field_174836_a = new AxisAlignedBB(0.0D, 0.0D, 0.0D, 0.0D, 0.0D, 0.0D);
-    private static int nextEntityID;
-    private int entityId;
-    public double renderDistanceWeight;
-
-    /**
-     * Blocks entities from spawning when they do their AABB check to make sure the spot is clear of entities that can
-     * prevent spawning.
-     */
-    public boolean preventEntitySpawning;
-
-    /** The entity that is riding this entity */
-    public Entity riddenByEntity;
-
-    /** The entity we are currently riding */
-    public Entity ridingEntity;
-    public boolean forceSpawn;
-
-    /** Reference to the World object. */
-    public World worldObj;
-    public double prevPosX;
-    public double prevPosY;
-    public double prevPosZ;
-
-    /** Entity position X */
-    public double posX;
-
-    /** Entity position Y */
-    public double posY;
-
-    /** Entity position Z */
-    public double posZ;
-
-    /** Entity motion X */
-    public double motionX;
-
-    /** Entity motion Y */
-    public double motionY;
-
-    /** Entity motion Z */
-    public double motionZ;
-
-    /** Entity rotation Yaw */
-    public float rotationYaw;
-
-    /** Entity rotation Pitch */
-    public float rotationPitch;
-    public float prevRotationYaw;
-    public float prevRotationPitch;
-
-    /** Axis aligned bounding box. */
-    private AxisAlignedBB boundingBox;
-    public boolean onGround;
-
-    /**
-     * True if after a move this entity has collided with something on X- or Z-axis
-     */
-    public boolean isCollidedHorizontally;
-
-    /**
-     * True if after a move this entity has collided with something on Y-axis
-     */
-    public boolean isCollidedVertically;
-
-    /**
-     * True if after a move this entity has collided with something either vertically or horizontally
-     */
-    public boolean isCollided;
-    public boolean velocityChanged;
-    protected boolean isInWeb;
-    private boolean isOutsideBorder;
-
-    /**
-     * gets set by setEntityDead, so this must be the flag whether an Entity is dead (inactive may be better term)
-     */
-    public boolean isDead;
-
-    /** How wide this entity is considered to be */
-    public float width;
-
-    /** How high this entity is considered to be */
-    public float height;
-
-    /** The previous ticks distance walked multiplied by 0.6 */
-    public float prevDistanceWalkedModified;
-
-    /** The distance walked multiplied by 0.6 */
-    public float distanceWalkedModified;
-    public float distanceWalkedOnStepModified;
-    public float fallDistance;
-
-    /**
-     * The distance that has to be exceeded in order to triger a new step sound and an onEntityWalking event on a block
-     */
-    private int nextStepDistance;
-
-    /**
-     * The entity's X coordinate at the previous tick, used to calculate position during rendering routines
-     */
-    public double lastTickPosX;
-
-    /**
-     * The entity's Y coordinate at the previous tick, used to calculate position during rendering routines
-     */
-    public double lastTickPosY;
-
-    /**
-     * The entity's Z coordinate at the previous tick, used to calculate position during rendering routines
-     */
-    public double lastTickPosZ;
-
-    /**
-     * How high this entity can step up when running into a block to try to get over it (currently make note the entity
-     * will always step up this amount and not just the amount needed)
-     */
-    public float stepHeight;
-
-    /**
-     * Whether this entity won't clip with collision or not (make note it won't disable gravity)
-     */
-    public boolean noClip;
-
-    /**
-     * Reduces the velocity applied by entity collisions by the specified percent.
-     */
-    public float entityCollisionReduction;
-    protected Random rand;
-
-    /** How many ticks has this entity had ran since being alive */
-    public int ticksExisted;
-
-    /**
-     * The amount of ticks you have to stand inside of fire before be set on fire
-     */
-    public int fireResistance;
-    private int fire;
-
-    /**
-     * Whether this entity is currently inside of water (if it handles water movement that is)
-     */
-    protected boolean inWater;
-
-    /**
-     * Remaining time an entity will be "immune" to further damage after being hurt.
-     */
-    public int hurtResistantTime;
-    protected boolean firstUpdate;
-    protected boolean isImmuneToFire;
-    protected DataWatcher dataWatcher;
-    private double entityRiderPitchDelta;
-    private double entityRiderYawDelta;
-
-    /** Has this entity been added to the chunk its within */
-    public boolean addedToChunk;
-    public int chunkCoordX;
-    public int chunkCoordY;
-    public int chunkCoordZ;
-    public int serverPosX;
-    public int serverPosY;
-    public int serverPosZ;
-
-    /**
-     * Render entity even if it is outside the camera frustum. Only true in EntityFish for now. Used in RenderGlobal:
-     * render if ignoreFrustumCheck or in frustum.
-     */
-    public boolean ignoreFrustumCheck;
-    public boolean isAirBorne;
-    public int timeUntilPortal;
-
-    /** Whether the entity is inside a Portal */
-    protected boolean inPortal;
-    protected int portalCounter;
-
-    /** Which dimension the player is in (-1 = the Nether, 0 = normal world) */
-    public int dimension;
-    protected int teleportDirection;
-    private boolean invulnerable;
-    protected UUID entityUniqueID;
-    private final CommandResultStats field_174837_as;
-    private static final String __OBFID = "CL_00001533";
-
-    public int getEntityId()
-    {
-        return this.entityId;
-    }
-
-    public void setEntityId(int id)
-    {
-        this.entityId = id;
-    }
-
-    public void func_174812_G()
-    {
-        this.setDead();
-    }
-
-    public Entity(World worldIn)
-    {
-        this.entityId = nextEntityID++;
-        this.renderDistanceWeight = 1.0D;
-        this.boundingBox = field_174836_a;
-        this.width = 0.6F;
-        this.height = 1.8F;
-        this.nextStepDistance = 1;
-        this.rand = new Random();
-        this.fireResistance = 1;
-        this.firstUpdate = true;
-        this.entityUniqueID = MathHelper.func_180182_a(this.rand);
-        this.field_174837_as = new CommandResultStats();
-        this.worldObj = worldIn;
-        this.setPosition(0.0D, 0.0D, 0.0D);
-
-        if (worldIn != null)
-        {
-            this.dimension = worldIn.provider.getDimensionId();
-        }
-
-        this.dataWatcher = new DataWatcher(this);
-        this.dataWatcher.addObject(0, Byte.valueOf((byte)0));
-        this.dataWatcher.addObject(1, Short.valueOf((short)300));
-        this.dataWatcher.addObject(3, Byte.valueOf((byte)0));
-        this.dataWatcher.addObject(2, "");
-        this.dataWatcher.addObject(4, Byte.valueOf((byte)0));
-        this.entityInit();
-    }
-
-    protected abstract void entityInit();
-
-    public DataWatcher getDataWatcher()
-    {
-        return this.dataWatcher;
-    }
-
-    public boolean equals(Object p_equals_1_)
-    {
-        return p_equals_1_ instanceof Entity ? ((Entity)p_equals_1_).entityId == this.entityId : false;
-    }
-
-    public int hashCode()
-    {
-        return this.entityId;
-    }
-
-    /**
-     * Keeps moving the entity up so it isn't colliding with blocks and other requirements for this entity to be spawned
-     * (only actually used on players though its also on Entity)
-     */
-    protected void preparePlayerToSpawn()
-    {
-        if (this.worldObj != null)
-        {
-            while (this.posY > 0.0D && this.posY < 256.0D)
-            {
-                this.setPosition(this.posX, this.posY, this.posZ);
-
-                if (this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox()).isEmpty())
-                {
-                    break;
-                }
-
-                ++this.posY;
-            }
-
-            this.motionX = this.motionY = this.motionZ = 0.0D;
-            this.rotationPitch = 0.0F;
-        }
-    }
-
-    /**
-     * Will get destroyed next tick.
-     */
-    public void setDead()
-    {
-        this.isDead = true;
-    }
-
-    /**
-     * Sets the width and height of the entity. Args: width, height
-     */
-    protected void setSize(float width, float height)
-    {
-        if (width != this.width || height != this.height)
-        {
-            float var3 = this.width;
-            this.width = width;
-            this.height = height;
-            this.func_174826_a(new AxisAlignedBB(this.getEntityBoundingBox().minX, this.getEntityBoundingBox().minY, this.getEntityBoundingBox().minZ, this.getEntityBoundingBox().minX + (double)this.width, this.getEntityBoundingBox().minY + (double)this.height, this.getEntityBoundingBox().minZ + (double)this.width));
-
-            if (this.width > var3 && !this.firstUpdate && !this.worldObj.isRemote)
-            {
-                this.moveEntity((double)(var3 - this.width), 0.0D, (double)(var3 - this.width));
-            }
-        }
-    }
-
-    /**
-     * Sets the rotation of the entity. Args: yaw, pitch (both in degrees)
-     */
-    protected void setRotation(float yaw, float pitch)
-    {
-        this.rotationYaw = yaw % 360.0F;
-        this.rotationPitch = pitch % 360.0F;
-    }
-
-    /**
-     * Sets the x,y,z of the entity from the given parameters. Also seems to set up a bounding box.
-     */
-    public void setPosition(double x, double y, double z)
-    {
-        this.posX = x;
-        this.posY = y;
-        this.posZ = z;
-        float var7 = this.width / 2.0F;
-        float var8 = this.height;
-        this.func_174826_a(new AxisAlignedBB(x - (double)var7, y, z - (double)var7, x + (double)var7, y + (double)var8, z + (double)var7));
-    }
-
-    /**
-     * Adds 15% to the entity's yaw and subtracts 15% from the pitch. Clamps pitch from -90 to 90. Both arguments in
-     * degrees.
-     */
-    public void setAngles(float yaw, float pitch)
-    {
-        float var3 = this.rotationPitch;
-        float var4 = this.rotationYaw;
-        this.rotationYaw = (float)((double)this.rotationYaw + (double)yaw * 0.15D);
-        this.rotationPitch = (float)((double)this.rotationPitch - (double)pitch * 0.15D);
-        this.rotationPitch = MathHelper.clamp_float(this.rotationPitch, -90.0F, 90.0F);
-        this.prevRotationPitch += this.rotationPitch - var3;
-        this.prevRotationYaw += this.rotationYaw - var4;
-    }
-
-    /**
-     * Called to update the entity's position/logic.
-     */
-    public void onUpdate()
-    {
-        this.onEntityUpdate();
-    }
-
-    /**
-     * Gets called every tick from main Entity class
-     */
-    public void onEntityUpdate()
-    {
-        this.worldObj.theProfiler.startSection("entityBaseTick");
-
-        if (this.ridingEntity != null && this.ridingEntity.isDead)
-        {
-            this.ridingEntity = null;
-        }
-
-        this.prevDistanceWalkedModified = this.distanceWalkedModified;
-        this.prevPosX = this.posX;
-        this.prevPosY = this.posY;
-        this.prevPosZ = this.posZ;
-        this.prevRotationPitch = this.rotationPitch;
-        this.prevRotationYaw = this.rotationYaw;
-
-        if (!this.worldObj.isRemote && this.worldObj instanceof WorldServer)
-        {
-            this.worldObj.theProfiler.startSection("portal");
-            MinecraftServer var1 = ((WorldServer)this.worldObj).func_73046_m();
-            int var2 = this.getMaxInPortalTime();
-
-            if (this.inPortal)
-            {
-                if (var1.getAllowNether())
-                {
-                    if (this.ridingEntity == null && this.portalCounter++ >= var2)
-                    {
-                        this.portalCounter = var2;
-                        this.timeUntilPortal = this.getPortalCooldown();
-                        byte var3;
-
-                        if (this.worldObj.provider.getDimensionId() == -1)
-                        {
-                            var3 = 0;
-                        }
-                        else
-                        {
-                            var3 = -1;
-                        }
-
-                        this.travelToDimension(var3);
-                    }
-
-                    this.inPortal = false;
-                }
-            }
-            else
-            {
-                if (this.portalCounter > 0)
-                {
-                    this.portalCounter -= 4;
-                }
-
-                if (this.portalCounter < 0)
-                {
-                    this.portalCounter = 0;
-                }
-            }
-
-            if (this.timeUntilPortal > 0)
-            {
-                --this.timeUntilPortal;
-            }
-
-            this.worldObj.theProfiler.endSection();
-        }
-
-        this.func_174830_Y();
-        this.handleWaterMovement();
-
-        if (this.worldObj.isRemote)
-        {
-            this.fire = 0;
-        }
-        else if (this.fire > 0)
-        {
-            if (this.isImmuneToFire)
-            {
-                this.fire -= 4;
-
-                if (this.fire < 0)
-                {
-                    this.fire = 0;
-                }
-            }
-            else
-            {
-                if (this.fire % 20 == 0)
-                {
-                    this.attackEntityFrom(DamageSource.onFire, 1.0F);
-                }
-
-                --this.fire;
-            }
-        }
-
-        if (this.func_180799_ab())
-        {
-            this.setOnFireFromLava();
-            this.fallDistance *= 0.5F;
-        }
-
-        if (this.posY < -64.0D)
-        {
-            this.kill();
-        }
-
-        if (!this.worldObj.isRemote)
-        {
-            this.setFlag(0, this.fire > 0);
-        }
-
-        this.firstUpdate = false;
-        this.worldObj.theProfiler.endSection();
-    }
-
-    /**
-     * Return the amount of time this entity should stay in a portal before being transported.
-     */
-    public int getMaxInPortalTime()
-    {
-        return 0;
-    }
-
-    /**
-     * Called whenever the entity is walking inside of lava.
-     */
-    protected void setOnFireFromLava()
-    {
-        if (!this.isImmuneToFire)
-        {
-            this.attackEntityFrom(DamageSource.lava, 4.0F);
-            this.setFire(15);
-        }
-    }
-
-    /**
-     * Sets entity to burn for x amount of seconds, cannot lower amount of existing fire.
-     */
-    public void setFire(int seconds)
-    {
-        int var2 = seconds * 20;
-        var2 = EnchantmentProtection.getFireTimeForEntity(this, var2);
-
-        if (this.fire < var2)
-        {
-            this.fire = var2;
-        }
-    }
-
-    /**
-     * Removes fire from entity.
-     */
-    public void extinguish()
-    {
-        this.fire = 0;
-    }
-
-    /**
-     * sets the dead flag. Used when you fall off the bottom of the world.
-     */
-    protected void kill()
-    {
-        this.setDead();
-    }
-
-    /**
-     * Checks if the offset position from the entity's current position is inside of liquid. Args: x, y, z
-     */
-    public boolean isOffsetPositionInLiquid(double x, double y, double z)
-    {
-        AxisAlignedBB var7 = this.getEntityBoundingBox().offset(x, y, z);
-        return this.func_174809_b(var7);
-    }
-
-    private boolean func_174809_b(AxisAlignedBB p_174809_1_)
-    {
-        return this.worldObj.getCollidingBoundingBoxes(this, p_174809_1_).isEmpty() && !this.worldObj.isAnyLiquid(p_174809_1_);
-    }
-
-    /**
-     * Tries to moves the entity by the passed in displacement. Args: x, y, z
-     */
-    public void moveEntity(double x, double y, double z)
-    {
-        if (this.noClip)
-        {
-            this.func_174826_a(this.getEntityBoundingBox().offset(x, y, z));
-            this.func_174829_m();
-        }
-        else
-        {
-            this.worldObj.theProfiler.startSection("move");
-            double var7 = this.posX;
-            double var9 = this.posY;
-            double var11 = this.posZ;
-
-            if (this.isInWeb)
-            {
-                this.isInWeb = false;
-                x *= 0.25D;
-                y *= 0.05000000074505806D;
-                z *= 0.25D;
-                this.motionX = 0.0D;
-                this.motionY = 0.0D;
-                this.motionZ = 0.0D;
-            }
-
-            double var13 = x;
-            double var15 = y;
-            double var17 = z;
-            boolean var19 = this.onGround && this.isSneaking() && this instanceof EntityPlayer;
-
-            if (var19)
-            {
-                double var20;
-
-                for (var20 = 0.05D; x != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(x, -1.0D, 0.0D)).isEmpty(); var13 = x)
-                {
-                    if (x < var20 && x >= -var20)
-                    {
-                        x = 0.0D;
-                    }
-                    else if (x > 0.0D)
-                    {
-                        x -= var20;
-                    }
-                    else
-                    {
-                        x += var20;
-                    }
-                }
-
-                for (; z != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(0.0D, -1.0D, z)).isEmpty(); var17 = z)
-                {
-                    if (z < var20 && z >= -var20)
-                    {
-                        z = 0.0D;
-                    }
-                    else if (z > 0.0D)
-                    {
-                        z -= var20;
-                    }
-                    else
-                    {
-                        z += var20;
-                    }
-                }
-
-                for (; x != 0.0D && z != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(x, -1.0D, z)).isEmpty(); var17 = z)
-                {
-                    if (x < var20 && x >= -var20)
-                    {
-                        x = 0.0D;
-                    }
-                    else if (x > 0.0D)
-                    {
-                        x -= var20;
-                    }
-                    else
-                    {
-                        x += var20;
-                    }
-
-                    var13 = x;
-
-                    if (z < var20 && z >= -var20)
-                    {
-                        z = 0.0D;
-                    }
-                    else if (z > 0.0D)
-                    {
-                        z -= var20;
-                    }
-                    else
-                    {
-                        z += var20;
-                    }
-                }
-            }
-
-            List var53 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().addCoord(x, y, z));
-            AxisAlignedBB var21 = this.getEntityBoundingBox();
-            AxisAlignedBB var23;
-
-            for (Iterator var22 = var53.iterator(); var22.hasNext(); y = var23.calculateYOffset(this.getEntityBoundingBox(), y))
-            {
-                var23 = (AxisAlignedBB)var22.next();
-            }
-
-            this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, y, 0.0D));
-            boolean var54 = this.onGround || var15 != y && var15 < 0.0D;
-            AxisAlignedBB var24;
-            Iterator var55;
-
-            for (var55 = var53.iterator(); var55.hasNext(); x = var24.calculateXOffset(this.getEntityBoundingBox(), x))
-            {
-                var24 = (AxisAlignedBB)var55.next();
-            }
-
-            this.func_174826_a(this.getEntityBoundingBox().offset(x, 0.0D, 0.0D));
-
-            for (var55 = var53.iterator(); var55.hasNext(); z = var24.calculateZOffset(this.getEntityBoundingBox(), z))
-            {
-                var24 = (AxisAlignedBB)var55.next();
-            }
-
-            this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, 0.0D, z));
-
-            if (this.stepHeight > 0.0F && var54 && (var13 != x || var17 != z))
-            {
-                double var56 = x;
-                double var25 = y;
-                double var27 = z;
-                AxisAlignedBB var29 = this.getEntityBoundingBox();
-                this.func_174826_a(var21);
-                y = (double)this.stepHeight;
-                List var30 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().addCoord(var13, y, var17));
-                AxisAlignedBB var31 = this.getEntityBoundingBox();
-                AxisAlignedBB var32 = var31.addCoord(var13, 0.0D, var17);
-                double var33 = y;
-                AxisAlignedBB var36;
-
-                for (Iterator var35 = var30.iterator(); var35.hasNext(); var33 = var36.calculateYOffset(var32, var33))
-                {
-                    var36 = (AxisAlignedBB)var35.next();
-                }
-
-                var31 = var31.offset(0.0D, var33, 0.0D);
-                double var67 = var13;
-                AxisAlignedBB var38;
-
-                for (Iterator var37 = var30.iterator(); var37.hasNext(); var67 = var38.calculateXOffset(var31, var67))
-                {
-                    var38 = (AxisAlignedBB)var37.next();
-                }
-
-                var31 = var31.offset(var67, 0.0D, 0.0D);
-                double var68 = var17;
-                AxisAlignedBB var40;
-
-                for (Iterator var39 = var30.iterator(); var39.hasNext(); var68 = var40.calculateZOffset(var31, var68))
-                {
-                    var40 = (AxisAlignedBB)var39.next();
-                }
-
-                var31 = var31.offset(0.0D, 0.0D, var68);
-                AxisAlignedBB var69 = this.getEntityBoundingBox();
-                double var70 = y;
-                AxisAlignedBB var43;
-
-                for (Iterator var42 = var30.iterator(); var42.hasNext(); var70 = var43.calculateYOffset(var69, var70))
-                {
-                    var43 = (AxisAlignedBB)var42.next();
-                }
-
-                var69 = var69.offset(0.0D, var70, 0.0D);
-                double var71 = var13;
-                AxisAlignedBB var45;
-
-                for (Iterator var44 = var30.iterator(); var44.hasNext(); var71 = var45.calculateXOffset(var69, var71))
-                {
-                    var45 = (AxisAlignedBB)var44.next();
-                }
-
-                var69 = var69.offset(var71, 0.0D, 0.0D);
-                double var72 = var17;
-                AxisAlignedBB var47;
-
-                for (Iterator var46 = var30.iterator(); var46.hasNext(); var72 = var47.calculateZOffset(var69, var72))
-                {
-                    var47 = (AxisAlignedBB)var46.next();
-                }
-
-                var69 = var69.offset(0.0D, 0.0D, var72);
-                double var73 = var67 * var67 + var68 * var68;
-                double var48 = var71 * var71 + var72 * var72;
-
-                if (var73 > var48)
-                {
-                    x = var67;
-                    z = var68;
-                    this.func_174826_a(var31);
-                }
-                else
-                {
-                    x = var71;
-                    z = var72;
-                    this.func_174826_a(var69);
-                }
-
-                y = (double)(-this.stepHeight);
-                AxisAlignedBB var51;
-
-                for (Iterator var50 = var30.iterator(); var50.hasNext(); y = var51.calculateYOffset(this.getEntityBoundingBox(), y))
-                {
-                    var51 = (AxisAlignedBB)var50.next();
-                }
-
-                this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, y, 0.0D));
-
-                if (var56 * var56 + var27 * var27 >= x * x + z * z)
-                {
-                    x = var56;
-                    y = var25;
-                    z = var27;
-                    this.func_174826_a(var29);
-                }
-            }
-
-            this.worldObj.theProfiler.endSection();
-            this.worldObj.theProfiler.startSection("rest");
-            this.func_174829_m();
-            this.isCollidedHorizontally = var13 != x || var17 != z;
-            this.isCollidedVertically = var15 != y;
-            this.onGround = this.isCollidedVertically && var15 < 0.0D;
-            this.isCollided = this.isCollidedHorizontally || this.isCollidedVertically;
-            int var57 = MathHelper.floor_double(this.posX);
-            int var58 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
-            int var59 = MathHelper.floor_double(this.posZ);
-            BlockPos var26 = new BlockPos(var57, var58, var59);
-            Block var60 = this.worldObj.getBlockState(var26).getBlock();
-
-            if (var60.getMaterial() == Material.air)
-            {
-                Block var28 = this.worldObj.getBlockState(var26.offsetDown()).getBlock();
-
-                if (var28 instanceof BlockFence || var28 instanceof BlockWall || var28 instanceof BlockFenceGate)
-                {
-                    var60 = var28;
-                    var26 = var26.offsetDown();
-                }
-            }
-
-            this.func_180433_a(y, this.onGround, var60, var26);
-
-            if (var13 != x)
-            {
-                this.motionX = 0.0D;
-            }
-
-            if (var17 != z)
-            {
-                this.motionZ = 0.0D;
-            }
-
-            if (var15 != y)
-            {
-                var60.onLanded(this.worldObj, this);
-            }
-
-            if (this.canTriggerWalking() && !var19 && this.ridingEntity == null)
-            {
-                double var61 = this.posX - var7;
-                double var64 = this.posY - var9;
-                double var66 = this.posZ - var11;
-
-                if (var60 != Blocks.ladder)
-                {
-                    var64 = 0.0D;
-                }
-
-                if (var60 != null && this.onGround)
-                {
-                    var60.onEntityCollidedWithBlock(this.worldObj, var26, this);
-                }
-
-                this.distanceWalkedModified = (float)((double)this.distanceWalkedModified + (double)MathHelper.sqrt_double(var61 * var61 + var66 * var66) * 0.6D);
-                this.distanceWalkedOnStepModified = (float)((double)this.distanceWalkedOnStepModified + (double)MathHelper.sqrt_double(var61 * var61 + var64 * var64 + var66 * var66) * 0.6D);
-
-                if (this.distanceWalkedOnStepModified > (float)this.nextStepDistance && var60.getMaterial() != Material.air)
-                {
-                    this.nextStepDistance = (int)this.distanceWalkedOnStepModified + 1;
-
-                    if (this.isInWater())
-                    {
-                        float var34 = MathHelper.sqrt_double(this.motionX * this.motionX * 0.20000000298023224D + this.motionY * this.motionY + this.motionZ * this.motionZ * 0.20000000298023224D) * 0.35F;
-
-                        if (var34 > 1.0F)
-                        {
-                            var34 = 1.0F;
-                        }
-
-                        this.playSound(this.getSwimSound(), var34, 1.0F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
-                    }
-
-                    this.func_180429_a(var26, var60);
-                }
-            }
-
-            try
-            {
-                this.doBlockCollisions();
-            }
-            catch (Throwable var52)
-            {
-                CrashReport var63 = CrashReport.makeCrashReport(var52, "Checking entity block collision");
-                CrashReportCategory var65 = var63.makeCategory("Entity being checked for collision");
-                this.addEntityCrashInfo(var65);
-                throw new ReportedException(var63);
-            }
-
-            boolean var62 = this.isWet();
-
-            if (this.worldObj.func_147470_e(this.getEntityBoundingBox().contract(0.001D, 0.001D, 0.001D)))
-            {
-                this.dealFireDamage(1);
-
-                if (!var62)
-                {
-                    ++this.fire;
-
-                    if (this.fire == 0)
-                    {
-                        this.setFire(8);
-                    }
-                }
-            }
-            else if (this.fire <= 0)
-            {
-                this.fire = -this.fireResistance;
-            }
-
-            if (var62 && this.fire > 0)
-            {
-                this.playSound("random.fizz", 0.7F, 1.6F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
-                this.fire = -this.fireResistance;
-            }
-
-            this.worldObj.theProfiler.endSection();
-        }
-    }
-
-    private void func_174829_m()
-    {
-        this.posX = (this.getEntityBoundingBox().minX + this.getEntityBoundingBox().maxX) / 2.0D;
-        this.posY = this.getEntityBoundingBox().minY;
-        this.posZ = (this.getEntityBoundingBox().minZ + this.getEntityBoundingBox().maxZ) / 2.0D;
-    }
-
-    protected String getSwimSound()
-    {
-        return "game.neutral.swim";
-    }
-
-    protected void doBlockCollisions()
-    {
-        BlockPos var1 = new BlockPos(this.getEntityBoundingBox().minX + 0.001D, this.getEntityBoundingBox().minY + 0.001D, this.getEntityBoundingBox().minZ + 0.001D);
-        BlockPos var2 = new BlockPos(this.getEntityBoundingBox().maxX - 0.001D, this.getEntityBoundingBox().maxY - 0.001D, this.getEntityBoundingBox().maxZ - 0.001D);
-
-        if (this.worldObj.isAreaLoaded(var1, var2))
-        {
-            for (int var3 = var1.getX(); var3 <= var2.getX(); ++var3)
-            {
-                for (int var4 = var1.getY(); var4 <= var2.getY(); ++var4)
-                {
-                    for (int var5 = var1.getZ(); var5 <= var2.getZ(); ++var5)
-                    {
-                        BlockPos var6 = new BlockPos(var3, var4, var5);
-                        IBlockState var7 = this.worldObj.getBlockState(var6);
-
-                        try
-                        {
-                            var7.getBlock().onEntityCollidedWithBlock(this.worldObj, var6, var7, this);
-                        }
-                        catch (Throwable var11)
-                        {
-                            CrashReport var9 = CrashReport.makeCrashReport(var11, "Colliding entity with block");
-                            CrashReportCategory var10 = var9.makeCategory("Block being collided with");
-                            CrashReportCategory.addBlockInfo(var10, var6, var7);
-                            throw new ReportedException(var9);
-                        }
-                    }
-                }
-            }
-        }
-    }
-
-    protected void func_180429_a(BlockPos p_180429_1_, Block p_180429_2_)
-    {
-        Block.SoundType var3 = p_180429_2_.stepSound;
-
-        if (this.worldObj.getBlockState(p_180429_1_.offsetUp()).getBlock() == Blocks.snow_layer)
-        {
-            var3 = Blocks.snow_layer.stepSound;
-            this.playSound(var3.getStepSound(), var3.getVolume() * 0.15F, var3.getFrequency());
-        }
-        else if (!p_180429_2_.getMaterial().isLiquid())
-        {
-            this.playSound(var3.getStepSound(), var3.getVolume() * 0.15F, var3.getFrequency());
-        }
-    }
-
-    public void playSound(String name, float volume, float pitch)
-    {
-        if (!this.isSlient())
-        {
-            this.worldObj.playSoundAtEntity(this, name, volume, pitch);
-        }
-    }
-
-    /**
-     * @return True if this entity will not play sounds
-     */
-    public boolean isSlient()
-    {
-        return this.dataWatcher.getWatchableObjectByte(4) == 1;
-    }
-
-    public void func_174810_b(boolean p_174810_1_)
-    {
-        this.dataWatcher.updateObject(4, Byte.valueOf((byte)(p_174810_1_ ? 1 : 0)));
-    }
-
-    /**
-     * returns if this entity triggers Block.onEntityWalking on the blocks they walk on. used for spiders and wolves to
-     * prevent them from trampling crops
-     */
-    protected boolean canTriggerWalking()
-    {
-        return true;
-    }
-
-    protected void func_180433_a(double p_180433_1_, boolean p_180433_3_, Block p_180433_4_, BlockPos p_180433_5_)
-    {
-        if (p_180433_3_)
-        {
-            if (this.fallDistance > 0.0F)
-            {
-                if (p_180433_4_ != null)
-                {
-                    p_180433_4_.onFallenUpon(this.worldObj, p_180433_5_, this, this.fallDistance);
-                }
-                else
-                {
-                    this.fall(this.fallDistance, 1.0F);
-                }
-
-                this.fallDistance = 0.0F;
-            }
-        }
-        else if (p_180433_1_ < 0.0D)
-        {
-            this.fallDistance = (float)((double)this.fallDistance - p_180433_1_);
-        }
-    }
-
-    /**
-     * returns the bounding box for this entity
-     */
-    public AxisAlignedBB getBoundingBox()
-    {
-        return null;
-    }
-
-    /**
-     * Will deal the specified amount of damage to the entity if the entity isn't immune to fire damage. Args:
-     * amountDamage
-     */
-    protected void dealFireDamage(int amount)
-    {
-        if (!this.isImmuneToFire)
-        {
-            this.attackEntityFrom(DamageSource.inFire, (float)amount);
-        }
-    }
-
-    public final boolean isImmuneToFire()
-    {
-        return this.isImmuneToFire;
-    }
-
-    public void fall(float distance, float damageMultiplier)
-    {
-        if (this.riddenByEntity != null)
-        {
-            this.riddenByEntity.fall(distance, damageMultiplier);
-        }
-    }
-
-    /**
-     * Checks if this entity is either in water or on an open air block in rain (used in wolves).
-     */
-    public boolean isWet()
-    {
-        return this.inWater || this.worldObj.func_175727_C(new BlockPos(this.posX, this.posY, this.posZ)) || this.worldObj.func_175727_C(new BlockPos(this.posX, this.posY + (double)this.height, this.posZ));
-    }
-
-    /**
-     * Checks if this entity is inside water (if inWater field is true as a result of handleWaterMovement() returning
-     * true)
-     */
-    public boolean isInWater()
-    {
-        return this.inWater;
-    }
-
-    /**
-     * Returns if this entity is in water and will end up adding the waters velocity to the entity
-     */
-    public boolean handleWaterMovement()
-    {
-        if (this.worldObj.handleMaterialAcceleration(this.getEntityBoundingBox().expand(0.0D, -0.4000000059604645D, 0.0D).contract(0.001D, 0.001D, 0.001D), Material.water, this))
-        {
-            if (!this.inWater && !this.firstUpdate)
-            {
-                this.resetHeight();
-            }
-
-            this.fallDistance = 0.0F;
-            this.inWater = true;
-            this.fire = 0;
-        }
-        else
-        {
-            this.inWater = false;
-        }
-
-        return this.inWater;
-    }
-
-    /**
-     * sets the players height back to normal after doing things like sleeping and dieing
-     */
-    protected void resetHeight()
-    {
-        float var1 = MathHelper.sqrt_double(this.motionX * this.motionX * 0.20000000298023224D + this.motionY * this.motionY + this.motionZ * this.motionZ * 0.20000000298023224D) * 0.2F;
-
-        if (var1 > 1.0F)
-        {
-            var1 = 1.0F;
-        }
-
-        this.playSound(this.getSplashSound(), var1, 1.0F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
-        float var2 = (float)MathHelper.floor_double(this.getEntityBoundingBox().minY);
-        int var3;
-        float var4;
-        float var5;
-
-        for (var3 = 0; (float)var3 < 1.0F + this.width * 20.0F; ++var3)
-        {
-            var4 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
-            var5 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
-            this.worldObj.spawnParticle(EnumParticleTypes.WATER_BUBBLE, this.posX + (double)var4, (double)(var2 + 1.0F), this.posZ + (double)var5, this.motionX, this.motionY - (double)(this.rand.nextFloat() * 0.2F), this.motionZ, new int[0]);
-        }
-
-        for (var3 = 0; (float)var3 < 1.0F + this.width * 20.0F; ++var3)
-        {
-            var4 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
-            var5 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
-            this.worldObj.spawnParticle(EnumParticleTypes.WATER_SPLASH, this.posX + (double)var4, (double)(var2 + 1.0F), this.posZ + (double)var5, this.motionX, this.motionY, this.motionZ, new int[0]);
-        }
-    }
-
-    public void func_174830_Y()
-    {
-        if (this.isSprinting() && !this.isInWater())
-        {
-            this.func_174808_Z();
-        }
-    }
-
-    protected void func_174808_Z()
-    {
-        int var1 = MathHelper.floor_double(this.posX);
-        int var2 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
-        int var3 = MathHelper.floor_double(this.posZ);
-        BlockPos var4 = new BlockPos(var1, var2, var3);
-        IBlockState var5 = this.worldObj.getBlockState(var4);
-        Block var6 = var5.getBlock();
-
-        if (var6.getRenderType() != -1)
-        {
-            this.worldObj.spawnParticle(EnumParticleTypes.BLOCK_CRACK, this.posX + ((double)this.rand.nextFloat() - 0.5D) * (double)this.width, this.getEntityBoundingBox().minY + 0.1D, this.posZ + ((double)this.rand.nextFloat() - 0.5D) * (double)this.width, -this.motionX * 4.0D, 1.5D, -this.motionZ * 4.0D, new int[] {Block.getStateId(var5)});
-        }
-    }
-
-    protected String getSplashSound()
-    {
-        return "game.neutral.swim.splash";
-    }
-
-    /**
-     * Checks if the current block the entity is within of the specified material type
-     */
-    public boolean isInsideOfMaterial(Material materialIn)
-    {
-        double var2 = this.posY + (double)this.getEyeHeight();
-        BlockPos var4 = new BlockPos(this.posX, var2, this.posZ);
-        IBlockState var5 = this.worldObj.getBlockState(var4);
-        Block var6 = var5.getBlock();
-
-        if (var6.getMaterial() == materialIn)
-        {
-            float var7 = BlockLiquid.getLiquidHeightPercent(var5.getBlock().getMetaFromState(var5)) - 0.11111111F;
-            float var8 = (float)(var4.getY() + 1) - var7;
-            boolean var9 = var2 < (double)var8;
-            return !var9 && this instanceof EntityPlayer ? false : var9;
-        }
-        else
-        {
-            return false;
-        }
-    }
-
-    public boolean func_180799_ab()
-    {
-        return this.worldObj.isMaterialInBB(this.getEntityBoundingBox().expand(-0.10000000149011612D, -0.4000000059604645D, -0.10000000149011612D), Material.lava);
-    }
-
-    /**
-     * Used in both water and by flying objects
-     */
-    public void moveFlying(float strafe, float forward, float friction)
-    {
-        float var4 = strafe * strafe + forward * forward;
-
-        if (var4 >= 1.0E-4F)
-        {
-            var4 = MathHelper.sqrt_float(var4);
-
-            if (var4 < 1.0F)
-            {
-                var4 = 1.0F;
-            }
-
-            var4 = friction / var4;
-            strafe *= var4;
-            forward *= var4;
-            float var5 = MathHelper.sin(this.rotationYaw * (float)Math.PI / 180.0F);
-            float var6 = MathHelper.cos(this.rotationYaw * (float)Math.PI / 180.0F);
-            this.motionX += (double)(strafe * var6 - forward * var5);
-            this.motionZ += (double)(forward * var6 + strafe * var5);
-        }
-    }
-
-    public int getBrightnessForRender(float p_70070_1_)
-    {
-        BlockPos var2 = new BlockPos(this.posX, 0.0D, this.posZ);
-
-        if (this.worldObj.isBlockLoaded(var2))
-        {
-            double var3 = (this.getEntityBoundingBox().maxY - this.getEntityBoundingBox().minY) * 0.66D;
-            int var5 = MathHelper.floor_double(this.posY + var3);
-            return this.worldObj.getCombinedLight(var2.offsetUp(var5), 0);
-        }
-        else
-        {
-            return 0;
-        }
-    }
-
-    /**
-     * Gets how bright this entity is.
-     */
-    public float getBrightness(float p_70013_1_)
-    {
-        BlockPos var2 = new BlockPos(this.posX, 0.0D, this.posZ);
-
-        if (this.worldObj.isBlockLoaded(var2))
-        {
-            double var3 = (this.getEntityBoundingBox().maxY - this.getEntityBoundingBox().minY) * 0.66D;
-            int var5 = MathHelper.floor_double(this.posY + var3);
-            return this.worldObj.getLightBrightness(var2.offsetUp(var5));
-        }
-        else
-        {
-            return 0.0F;
-        }
-    }
-
-    /**
-     * Sets the reference to the World object.
-     */
-    public void setWorld(World worldIn)
-    {
-        this.worldObj = worldIn;
-    }
-
-    /**
-     * Sets the entity's position and rotation.
-     */
-    public void setPositionAndRotation(double x, double y, double z, float yaw, float pitch)
-    {
-        this.prevPosX = this.posX = x;
-        this.prevPosY = this.posY = y;
-        this.prevPosZ = this.posZ = z;
-        this.prevRotationYaw = this.rotationYaw = yaw;
-        this.prevRotationPitch = this.rotationPitch = pitch;
-        double var9 = (double)(this.prevRotationYaw - yaw);
-
-        if (var9 < -180.0D)
-        {
-            this.prevRotationYaw += 360.0F;
-        }
-
-        if (var9 >= 180.0D)
-        {
-            this.prevRotationYaw -= 360.0F;
-        }
-
-        this.setPosition(this.posX, this.posY, this.posZ);
-        this.setRotation(yaw, pitch);
-    }
-
-    public void func_174828_a(BlockPos p_174828_1_, float p_174828_2_, float p_174828_3_)
-    {
-        this.setLocationAndAngles((double)p_174828_1_.getX() + 0.5D, (double)p_174828_1_.getY(), (double)p_174828_1_.getZ() + 0.5D, p_174828_2_, p_174828_3_);
-    }
-
-    /**
-     * Sets the location and Yaw/Pitch of an entity in the world
-     */
-    public void setLocationAndAngles(double x, double y, double z, float yaw, float pitch)
-    {
-        this.lastTickPosX = this.prevPosX = this.posX = x;
-        this.lastTickPosY = this.prevPosY = this.posY = y;
-        this.lastTickPosZ = this.prevPosZ = this.posZ = z;
-        this.rotationYaw = yaw;
-        this.rotationPitch = pitch;
-        this.setPosition(this.posX, this.posY, this.posZ);
-    }
-
-    /**
-     * Returns the distance to the entity. Args: entity
-     */
-    public float getDistanceToEntity(Entity entityIn)
-    {
-        float var2 = (float)(this.posX - entityIn.posX);
-        float var3 = (float)(this.posY - entityIn.posY);
-        float var4 = (float)(this.posZ - entityIn.posZ);
-        return MathHelper.sqrt_float(var2 * var2 + var3 * var3 + var4 * var4);
-    }
-
-    /**
-     * Gets the squared distance to the position. Args: x, y, z
-     */
-    public double getDistanceSq(double x, double y, double z)
-    {
-        double var7 = this.posX - x;
-        double var9 = this.posY - y;
-        double var11 = this.posZ - z;
-        return var7 * var7 + var9 * var9 + var11 * var11;
-    }
-
-    public double getDistanceSq(BlockPos p_174818_1_)
-    {
-        return p_174818_1_.distanceSq(this.posX, this.posY, this.posZ);
-    }
-
-    public double func_174831_c(BlockPos p_174831_1_)
-    {
-        return p_174831_1_.distanceSqToCenter(this.posX, this.posY, this.posZ);
-    }
-
-    /**
-     * Gets the distance to the position. Args: x, y, z
-     */
-    public double getDistance(double x, double y, double z)
-    {
-        double var7 = this.posX - x;
-        double var9 = this.posY - y;
-        double var11 = this.posZ - z;
-        return (double)MathHelper.sqrt_double(var7 * var7 + var9 * var9 + var11 * var11);
-    }
-
-    /**
-     * Returns the squared distance to the entity. Args: entity
-     */
-    public double getDistanceSqToEntity(Entity entityIn)
-    {
-        double var2 = this.posX - entityIn.posX;
-        double var4 = this.posY - entityIn.posY;
-        double var6 = this.posZ - entityIn.posZ;
-        return var2 * var2 + var4 * var4 + var6 * var6;
-    }
-
-    /**
-     * Called by a player entity when they collide with an entity
-     */
-    public void onCollideWithPlayer(EntityPlayer entityIn) {}
-
-    /**
-     * Applies a velocity to each of the entities pushing them away from each other. Args: entity
-     */
-    public void applyEntityCollision(Entity entityIn)
-    {
-        if (entityIn.riddenByEntity != this && entityIn.ridingEntity != this)
-        {
-            if (!entityIn.noClip && !this.noClip)
-            {
-                double var2 = entityIn.posX - this.posX;
-                double var4 = entityIn.posZ - this.posZ;
-                double var6 = MathHelper.abs_max(var2, var4);
-
-                if (var6 >= 0.009999999776482582D)
-                {
-                    var6 = (double)MathHelper.sqrt_double(var6);
-                    var2 /= var6;
-                    var4 /= var6;
-                    double var8 = 1.0D / var6;
-
-                    if (var8 > 1.0D)
-                    {
-                        var8 = 1.0D;
-                    }
-
-                    var2 *= var8;
-                    var4 *= var8;
-                    var2 *= 0.05000000074505806D;
-                    var4 *= 0.05000000074505806D;
-                    var2 *= (double)(1.0F - this.entityCollisionReduction);
-                    var4 *= (double)(1.0F - this.entityCollisionReduction);
-
-                    if (this.riddenByEntity == null)
-                    {
-                        this.addVelocity(-var2, 0.0D, -var4);
-                    }
-
-                    if (entityIn.riddenByEntity == null)
-                    {
-                        entityIn.addVelocity(var2, 0.0D, var4);
-                    }
-                }
-            }
-        }
-    }
-
-    /**
-     * Adds to the current velocity of the entity. Args: x, y, z
-     */
-    public void addVelocity(double x, double y, double z)
-    {
-        this.motionX += x;
-        this.motionY += y;
-        this.motionZ += z;
-        this.isAirBorne = true;
-    }
-
-    /**
-     * Sets that this entity has been attacked.
-     */
-    protected void setBeenAttacked()
-    {
-        this.velocityChanged = true;
-    }
-
-    /**
-     * Called when the entity is attacked.
-     */
-    public boolean attackEntityFrom(DamageSource source, float amount)
-    {
-        if (this.func_180431_b(source))
-        {
-            return false;
-        }
-        else
-        {
-            this.setBeenAttacked();
-            return false;
-        }
-    }
-
-    /**
-     * interpolated look vector
-     */
-    public Vec3 getLook(float p_70676_1_)
-    {
-        if (p_70676_1_ == 1.0F)
-        {
-            return this.func_174806_f(this.rotationPitch, this.rotationYaw);
-        }
-        else
-        {
-            float var2 = this.prevRotationPitch + (this.rotationPitch - this.prevRotationPitch) * p_70676_1_;
-            float var3 = this.prevRotationYaw + (this.rotationYaw - this.prevRotationYaw) * p_70676_1_;
-            return this.func_174806_f(var2, var3);
-        }
-    }
-
-    protected final Vec3 func_174806_f(float p_174806_1_, float p_174806_2_)
-    {
-        float var3 = MathHelper.cos(-p_174806_2_ * 0.017453292F - (float)Math.PI);
-        float var4 = MathHelper.sin(-p_174806_2_ * 0.017453292F - (float)Math.PI);
-        float var5 = -MathHelper.cos(-p_174806_1_ * 0.017453292F);
-        float var6 = MathHelper.sin(-p_174806_1_ * 0.017453292F);
-        return new Vec3((double)(var4 * var5), (double)var6, (double)(var3 * var5));
-    }
-
-    public Vec3 func_174824_e(float p_174824_1_)
-    {
-        if (p_174824_1_ == 1.0F)
-        {
-            return new Vec3(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
-        }
-        else
-        {
-            double var2 = this.prevPosX + (this.posX - this.prevPosX) * (double)p_174824_1_;
-            double var4 = this.prevPosY + (this.posY - this.prevPosY) * (double)p_174824_1_ + (double)this.getEyeHeight();
-            double var6 = this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_174824_1_;
-            return new Vec3(var2, var4, var6);
-        }
-    }
-
-    public MovingObjectPosition func_174822_a(double p_174822_1_, float p_174822_3_)
-    {
-        Vec3 var4 = this.func_174824_e(p_174822_3_);
-        Vec3 var5 = this.getLook(p_174822_3_);
-        Vec3 var6 = var4.addVector(var5.xCoord * p_174822_1_, var5.yCoord * p_174822_1_, var5.zCoord * p_174822_1_);
-        return this.worldObj.rayTraceBlocks(var4, var6, false, false, true);
-    }
-
-    /**
-     * Returns true if other Entities should be prevented from moving through this Entity.
-     */
-    public boolean canBeCollidedWith()
-    {
-        return false;
-    }
-
-    /**
-     * Returns true if this entity should push and be pushed by other entities when colliding.
-     */
-    public boolean canBePushed()
-    {
-        return false;
-    }
-
-    /**
-     * Adds a value to the player score. Currently not actually used and the entity passed in does nothing. Args:
-     * entity, scoreToAdd
-     */
-    public void addToPlayerScore(Entity entityIn, int amount) {}
-
-    public boolean isInRangeToRender3d(double x, double y, double z)
-    {
-        double var7 = this.posX - x;
-        double var9 = this.posY - y;
-        double var11 = this.posZ - z;
-        double var13 = var7 * var7 + var9 * var9 + var11 * var11;
-        return this.isInRangeToRenderDist(var13);
-    }
-
-    /**
-     * Checks if the entity is in range to render by using the past in distance and comparing it to its average edge
-     * length * 64 * renderDistanceWeight Args: distance
-     */
-    public boolean isInRangeToRenderDist(double distance)
-    {
-        double var3 = this.getEntityBoundingBox().getAverageEdgeLength();
-        var3 *= 64.0D * this.renderDistanceWeight;
-        return distance < var3 * var3;
-    }
-
-    /**
-     * Like writeToNBTOptional but does not check if the entity is ridden. Used for saving ridden entities with their
-     * riders.
-     */
-    public boolean writeMountToNBT(NBTTagCompound tagCompund)
-    {
-        String var2 = this.getEntityString();
-
-        if (!this.isDead && var2 != null)
-        {
-            tagCompund.setString("id", var2);
-            this.writeToNBT(tagCompund);
-            return true;
-        }
-        else
-        {
-            return false;
-        }
-    }
-
-    /**
-     * Either write this entity to the NBT tag given and return true, or return false without doing anything. If this
-     * returns false the entity is not saved on disk. Ridden entities return false here as they are saved with their
-     * rider.
-     */
-    public boolean writeToNBTOptional(NBTTagCompound tagCompund)
-    {
-        String var2 = this.getEntityString();
-
-        if (!this.isDead && var2 != null && this.riddenByEntity == null)
-        {
-            tagCompund.setString("id", var2);
-            this.writeToNBT(tagCompund);
-            return true;
-        }
-        else
-        {
-            return false;
-        }
-    }
-
-    /**
-     * Save the entity to NBT (calls an abstract helper method to write extra data)
-     */
-    public void writeToNBT(NBTTagCompound tagCompund)
-    {
-        try
-        {
-            tagCompund.setTag("Pos", this.newDoubleNBTList(new double[] {this.posX, this.posY, this.posZ}));
-            tagCompund.setTag("Motion", this.newDoubleNBTList(new double[] {this.motionX, this.motionY, this.motionZ}));
-            tagCompund.setTag("Rotation", this.newFloatNBTList(new float[] {this.rotationYaw, this.rotationPitch}));
-            tagCompund.setFloat("FallDistance", this.fallDistance);
-            tagCompund.setShort("Fire", (short)this.fire);
-            tagCompund.setShort("Air", (short)this.getAir());
-            tagCompund.setBoolean("OnGround", this.onGround);
-            tagCompund.setInteger("Dimension", this.dimension);
-            tagCompund.setBoolean("Invulnerable", this.invulnerable);
-            tagCompund.setInteger("PortalCooldown", this.timeUntilPortal);
-            tagCompund.setLong("UUIDMost", this.getUniqueID().getMostSignificantBits());
-            tagCompund.setLong("UUIDLeast", this.getUniqueID().getLeastSignificantBits());
-
-            if (this.getCustomNameTag() != null && this.getCustomNameTag().length() > 0)
-            {
-                tagCompund.setString("CustomName", this.getCustomNameTag());
-                tagCompund.setBoolean("CustomNameVisible", this.getAlwaysRenderNameTag());
-            }
-
-            this.field_174837_as.func_179670_b(tagCompund);
-
-            if (this.isSlient())
-            {
-                tagCompund.setBoolean("Silent", this.isSlient());
-            }
-
-            this.writeEntityToNBT(tagCompund);
-
-            if (this.ridingEntity != null)
-            {
-                NBTTagCompound var2 = new NBTTagCompound();
-
-                if (this.ridingEntity.writeMountToNBT(var2))
-                {
-                    tagCompund.setTag("Riding", var2);
-                }
-            }
-        }
-        catch (Throwable var5)
-        {
-            CrashReport var3 = CrashReport.makeCrashReport(var5, "Saving entity NBT");
-            CrashReportCategory var4 = var3.makeCategory("Entity being saved");
-            this.addEntityCrashInfo(var4);
-            throw new ReportedException(var3);
-        }
-    }
-
-    /**
-     * Reads the entity from NBT (calls an abstract helper method to read specialized data)
-     */
-    public void readFromNBT(NBTTagCompound tagCompund)
-    {
-        try
-        {
-            NBTTagList var2 = tagCompund.getTagList("Pos", 6);
-            NBTTagList var6 = tagCompund.getTagList("Motion", 6);
-            NBTTagList var7 = tagCompund.getTagList("Rotation", 5);
-            this.motionX = var6.getDouble(0);
-            this.motionY = var6.getDouble(1);
-            this.motionZ = var6.getDouble(2);
-
-            if (Math.abs(this.motionX) > 10.0D)
-            {
-                this.motionX = 0.0D;
-            }
-
-            if (Math.abs(this.motionY) > 10.0D)
-            {
-                this.motionY = 0.0D;
-            }
-
-            if (Math.abs(this.motionZ) > 10.0D)
-            {
-                this.motionZ = 0.0D;
-            }
-
-            this.prevPosX = this.lastTickPosX = this.posX = var2.getDouble(0);
-            this.prevPosY = this.lastTickPosY = this.posY = var2.getDouble(1);
-            this.prevPosZ = this.lastTickPosZ = this.posZ = var2.getDouble(2);
-            this.prevRotationYaw = this.rotationYaw = var7.getFloat(0);
-            this.prevRotationPitch = this.rotationPitch = var7.getFloat(1);
-            this.fallDistance = tagCompund.getFloat("FallDistance");
-            this.fire = tagCompund.getShort("Fire");
-            this.setAir(tagCompund.getShort("Air"));
-            this.onGround = tagCompund.getBoolean("OnGround");
-            this.dimension = tagCompund.getInteger("Dimension");
-            this.invulnerable = tagCompund.getBoolean("Invulnerable");
-            this.timeUntilPortal = tagCompund.getInteger("PortalCooldown");
-
-            if (tagCompund.hasKey("UUIDMost", 4) && tagCompund.hasKey("UUIDLeast", 4))
-            {
-                this.entityUniqueID = new UUID(tagCompund.getLong("UUIDMost"), tagCompund.getLong("UUIDLeast"));
-            }
-            else if (tagCompund.hasKey("UUID", 8))
-            {
-                this.entityUniqueID = UUID.fromString(tagCompund.getString("UUID"));
-            }
-
-            this.setPosition(this.posX, this.posY, this.posZ);
-            this.setRotation(this.rotationYaw, this.rotationPitch);
-
-            if (tagCompund.hasKey("CustomName", 8) && tagCompund.getString("CustomName").length() > 0)
-            {
-                this.setCustomNameTag(tagCompund.getString("CustomName"));
-            }
-
-            this.setAlwaysRenderNameTag(tagCompund.getBoolean("CustomNameVisible"));
-            this.field_174837_as.func_179668_a(tagCompund);
-            this.func_174810_b(tagCompund.getBoolean("Silent"));
-            this.readEntityFromNBT(tagCompund);
-
-            if (this.shouldSetPosAfterLoading())
-            {
-                this.setPosition(this.posX, this.posY, this.posZ);
-            }
-        }
-        catch (Throwable var5)
-        {
-            CrashReport var3 = CrashReport.makeCrashReport(var5, "Loading entity NBT");
-            CrashReportCategory var4 = var3.makeCategory("Entity being loaded");
-            this.addEntityCrashInfo(var4);
-            throw new ReportedException(var3);
-        }
-    }
-
-    protected boolean shouldSetPosAfterLoading()
-    {
-        return true;
-    }
-
-    /**
-     * Returns the string that identifies this Entity's class
-     */
-    protected final String getEntityString()
-    {
-        return EntityList.getEntityString(this);
-    }
-
-    /**
-     * (abstract) Protected helper method to read subclass entity data from NBT.
-     */
-    protected abstract void readEntityFromNBT(NBTTagCompound tagCompund);
-
-    /**
-     * (abstract) Protected helper method to write subclass entity data to NBT.
-     */
-    protected abstract void writeEntityToNBT(NBTTagCompound tagCompound);
-
-    public void onChunkLoad() {}
-
-    /**
-     * creates a NBT list from the array of doubles passed to this function
-     */
-    protected NBTTagList newDoubleNBTList(double ... numbers)
-    {
-        NBTTagList var2 = new NBTTagList();
-        double[] var3 = numbers;
-        int var4 = numbers.length;
-
-        for (int var5 = 0; var5 < var4; ++var5)
-        {
-            double var6 = var3[var5];
-            var2.appendTag(new NBTTagDouble(var6));
-        }
-
-        return var2;
-    }
-
-    /**
-     * Returns a new NBTTagList filled with the specified floats
-     */
-    protected NBTTagList newFloatNBTList(float ... numbers)
-    {
-        NBTTagList var2 = new NBTTagList();
-        float[] var3 = numbers;
-        int var4 = numbers.length;
-
-        for (int var5 = 0; var5 < var4; ++var5)
-        {
-            float var6 = var3[var5];
-            var2.appendTag(new NBTTagFloat(var6));
-        }
-
-        return var2;
-    }
-
-    public EntityItem dropItem(Item itemIn, int size)
-    {
-        return this.dropItemWithOffset(itemIn, size, 0.0F);
-    }
-
-    public EntityItem dropItemWithOffset(Item itemIn, int size, float p_145778_3_)
-    {
-        return this.entityDropItem(new ItemStack(itemIn, size, 0), p_145778_3_);
-    }
-
-    /**
-     * Drops an item at the position of the entity.
-     */
-    public EntityItem entityDropItem(ItemStack itemStackIn, float offsetY)
-    {
-        if (itemStackIn.stackSize != 0 && itemStackIn.getItem() != null)
-        {
-            EntityItem var3 = new EntityItem(this.worldObj, this.posX, this.posY + (double)offsetY, this.posZ, itemStackIn);
-            var3.setDefaultPickupDelay();
-            this.worldObj.spawnEntityInWorld(var3);
-            return var3;
-        }
-        else
-        {
-            return null;
-        }
-    }
-
-    /**
-     * Checks whether target entity is alive.
-     */
-    public boolean isEntityAlive()
-    {
-        return !this.isDead;
-    }
-
-    /**
-     * Checks if this entity is inside of an opaque block
-     */
-    public boolean isEntityInsideOpaqueBlock()
-    {
-        if (this.noClip)
-        {
-            return false;
-        }
-        else
-        {
-            for (int var1 = 0; var1 < 8; ++var1)
-            {
-                double var2 = this.posX + (double)(((float)((var1 >> 0) % 2) - 0.5F) * this.width * 0.8F);
-                double var4 = this.posY + (double)(((float)((var1 >> 1) % 2) - 0.5F) * 0.1F);
-                double var6 = this.posZ + (double)(((float)((var1 >> 2) % 2) - 0.5F) * this.width * 0.8F);
-
-                if (this.worldObj.getBlockState(new BlockPos(var2, var4 + (double)this.getEyeHeight(), var6)).getBlock().isVisuallyOpaque())
-                {
-                    return true;
-                }
-            }
-
-            return false;
-        }
-    }
-
-    /**
-     * First layer of player interaction
-     */
-    public boolean interactFirst(EntityPlayer playerIn)
-    {
-        return false;
-    }
-
-    /**
-     * Returns a boundingBox used to collide the entity with other entities and blocks. This enables the entity to be
-     * pushable on contact, like boats or minecarts.
-     */
-    public AxisAlignedBB getCollisionBox(Entity entityIn)
-    {
-        return null;
-    }
-
-    /**
-     * Handles updating while being ridden by an entity
-     */
-    public void updateRidden()
-    {
-        if (this.ridingEntity.isDead)
-        {
-            this.ridingEntity = null;
-        }
-        else
-        {
-            this.motionX = 0.0D;
-            this.motionY = 0.0D;
-            this.motionZ = 0.0D;
-            this.onUpdate();
-
-            if (this.ridingEntity != null)
-            {
-                this.ridingEntity.updateRiderPosition();
-                this.entityRiderYawDelta += (double)(this.ridingEntity.rotationYaw - this.ridingEntity.prevRotationYaw);
-
-                for (this.entityRiderPitchDelta += (double)(this.ridingEntity.rotationPitch - this.ridingEntity.prevRotationPitch); this.entityRiderYawDelta >= 180.0D; this.entityRiderYawDelta -= 360.0D)
-                {
-                    ;
-                }
-
-                while (this.entityRiderYawDelta < -180.0D)
-                {
-                    this.entityRiderYawDelta += 360.0D;
-                }
-
-                while (this.entityRiderPitchDelta >= 180.0D)
-                {
-                    this.entityRiderPitchDelta -= 360.0D;
-                }
-
-                while (this.entityRiderPitchDelta < -180.0D)
-                {
-                    this.entityRiderPitchDelta += 360.0D;
-                }
-
-                double var1 = this.entityRiderYawDelta * 0.5D;
-                double var3 = this.entityRiderPitchDelta * 0.5D;
-                float var5 = 10.0F;
-
-                if (var1 > (double)var5)
-                {
-                    var1 = (double)var5;
-                }
-
-                if (var1 < (double)(-var5))
-                {
-                    var1 = (double)(-var5);
-                }
-
-                if (var3 > (double)var5)
-                {
-                    var3 = (double)var5;
-                }
-
-                if (var3 < (double)(-var5))
-                {
-                    var3 = (double)(-var5);
-                }
-
-                this.entityRiderYawDelta -= var1;
-                this.entityRiderPitchDelta -= var3;
-            }
-        }
-    }
-
-    public void updateRiderPosition()
-    {
-        if (this.riddenByEntity != null)
-        {
-            this.riddenByEntity.setPosition(this.posX, this.posY + this.getMountedYOffset() + this.riddenByEntity.getYOffset(), this.posZ);
-        }
-    }
-
-    /**
-     * Returns the Y Offset of this entity.
-     */
-    public double getYOffset()
-    {
-        return 0.0D;
-    }
-
-    /**
-     * Returns the Y offset from the entity's position for any entity riding this one.
-     */
-    public double getMountedYOffset()
-    {
-        return (double)this.height * 0.75D;
-    }
-
-    /**
-     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
-     */
-    public void mountEntity(Entity entityIn)
-    {
-        this.entityRiderPitchDelta = 0.0D;
-        this.entityRiderYawDelta = 0.0D;
-
-        if (entityIn == null)
-        {
-            if (this.ridingEntity != null)
-            {
-                this.setLocationAndAngles(this.ridingEntity.posX, this.ridingEntity.getEntityBoundingBox().minY + (double)this.ridingEntity.height, this.ridingEntity.posZ, this.rotationYaw, this.rotationPitch);
-                this.ridingEntity.riddenByEntity = null;
-            }
-
-            this.ridingEntity = null;
-        }
-        else
-        {
-            if (this.ridingEntity != null)
-            {
-                this.ridingEntity.riddenByEntity = null;
-            }
-
-            if (entityIn != null)
-            {
-                for (Entity var2 = entityIn.ridingEntity; var2 != null; var2 = var2.ridingEntity)
-                {
-                    if (var2 == this)
-                    {
-                        return;
-                    }
-                }
-            }
-
-            this.ridingEntity = entityIn;
-            entityIn.riddenByEntity = this;
-        }
-    }
-
-    public void func_180426_a(double p_180426_1_, double p_180426_3_, double p_180426_5_, float p_180426_7_, float p_180426_8_, int p_180426_9_, boolean p_180426_10_)
-    {
-        this.setPosition(p_180426_1_, p_180426_3_, p_180426_5_);
-        this.setRotation(p_180426_7_, p_180426_8_);
-        List var11 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().contract(0.03125D, 0.0D, 0.03125D));
-
-        if (!var11.isEmpty())
-        {
-            double var12 = 0.0D;
-            Iterator var14 = var11.iterator();
-
-            while (var14.hasNext())
-            {
-                AxisAlignedBB var15 = (AxisAlignedBB)var14.next();
-
-                if (var15.maxY > var12)
-                {
-                    var12 = var15.maxY;
-                }
-            }
-
-            p_180426_3_ += var12 - this.getEntityBoundingBox().minY;
-            this.setPosition(p_180426_1_, p_180426_3_, p_180426_5_);
-        }
-    }
-
-    public float getCollisionBorderSize()
-    {
-        return 0.1F;
-    }
-
-    /**
-     * returns a (normalized) vector of where this entity is looking
-     */
-    public Vec3 getLookVec()
-    {
-        return null;
-    }
-
-    /**
-     * Called by portal blocks when an entity is within it.
-     */
-    public void setInPortal()
-    {
-        if (this.timeUntilPortal > 0)
-        {
-            this.timeUntilPortal = this.getPortalCooldown();
-        }
-        else
-        {
-            double var1 = this.prevPosX - this.posX;
-            double var3 = this.prevPosZ - this.posZ;
-
-            if (!this.worldObj.isRemote && !this.inPortal)
-            {
-                int var5;
-
-                if (MathHelper.abs((float)var1) > MathHelper.abs((float)var3))
-                {
-                    var5 = var1 > 0.0D ? EnumFacing.WEST.getHorizontalIndex() : EnumFacing.EAST.getHorizontalIndex();
-                }
-                else
-                {
-                    var5 = var3 > 0.0D ? EnumFacing.NORTH.getHorizontalIndex() : EnumFacing.SOUTH.getHorizontalIndex();
-                }
-
-                this.teleportDirection = var5;
-            }
-
-            this.inPortal = true;
-        }
-    }
-
-    /**
-     * Return the amount of cooldown before this entity can use a portal again.
-     */
-    public int getPortalCooldown()
-    {
-        return 300;
-    }
-
-    /**
-     * Sets the velocity to the args. Args: x, y, z
-     */
-    public void setVelocity(double x, double y, double z)
-    {
-        this.motionX = x;
-        this.motionY = y;
-        this.motionZ = z;
-    }
-
-    public void handleHealthUpdate(byte p_70103_1_) {}
-
-    /**
-     * Setups the entity to do the hurt animation. Only used by packets in multiplayer.
-     */
-    public void performHurtAnimation() {}
-
-    /**
-     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
-     */
-    public ItemStack[] getInventory()
-    {
-        return null;
-    }
-
-    /**
-     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
-     */
-    public void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn) {}
-
-    /**
-     * Returns true if the entity is on fire. Used by render to add the fire effect on rendering.
-     */
-    public boolean isBurning()
-    {
-        boolean var1 = this.worldObj != null && this.worldObj.isRemote;
-        return !this.isImmuneToFire && (this.fire > 0 || var1 && this.getFlag(0));
-    }
-
-    /**
-     * Returns true if the entity is riding another entity, used by render to rotate the legs to be in 'sit' position
-     * for players.
-     */
-    public boolean isRiding()
-    {
-        return this.ridingEntity != null;
-    }
-
-    /**
-     * Returns if this entity is sneaking.
-     */
-    public boolean isSneaking()
-    {
-        return this.getFlag(1);
-    }
-
-    /**
-     * Sets the sneaking flag.
-     */
-    public void setSneaking(boolean sneaking)
-    {
-        this.setFlag(1, sneaking);
-    }
-
-    /**
-     * Get if the Entity is sprinting.
-     */
-    public boolean isSprinting()
-    {
-        return this.getFlag(3);
-    }
-
-    /**
-     * Set sprinting switch for Entity.
-     */
-    public void setSprinting(boolean sprinting)
-    {
-        this.setFlag(3, sprinting);
-    }
-
-    public boolean isInvisible()
-    {
-        return this.getFlag(5);
-    }
-
-    /**
-     * Only used by renderer in EntityLivingBase subclasses.
-     * Determines if an entity is visible or not to a specfic player, if the entity is normally invisible.
-     * For EntityLivingBase subclasses, returning false when invisible will render the entity semitransparent.
-     */
-    public boolean isInvisibleToPlayer(EntityPlayer playerIn)
-    {
-        return playerIn.func_175149_v() ? false : this.isInvisible();
-    }
-
-    public void setInvisible(boolean invisible)
-    {
-        this.setFlag(5, invisible);
-    }
-
-    public boolean isEating()
-    {
-        return this.getFlag(4);
-    }
-
-    public void setEating(boolean eating)
-    {
-        this.setFlag(4, eating);
-    }
-
-    /**
-     * Returns true if the flag is active for the entity. Known flags: 0) is burning; 1) is sneaking; 2) is riding
-     * something; 3) is sprinting; 4) is eating
-     */
-    protected boolean getFlag(int flag)
-    {
-        return (this.dataWatcher.getWatchableObjectByte(0) & 1 << flag) != 0;
-    }
-
-    /**
-     * Enable or disable a entity flag, see getEntityFlag to read the know flags.
-     */
-    protected void setFlag(int flag, boolean set)
-    {
-        byte var3 = this.dataWatcher.getWatchableObjectByte(0);
-
-        if (set)
-        {
-            this.dataWatcher.updateObject(0, Byte.valueOf((byte)(var3 | 1 << flag)));
-        }
-        else
-        {
-            this.dataWatcher.updateObject(0, Byte.valueOf((byte)(var3 & ~(1 << flag))));
-        }
-    }
-
-    public int getAir()
-    {
-        return this.dataWatcher.getWatchableObjectShort(1);
-    }
-
-    public void setAir(int air)
-    {
-        this.dataWatcher.updateObject(1, Short.valueOf((short)air));
-    }
-
-    /**
-     * Called when a lightning bolt hits the entity.
-     */
-    public void onStruckByLightning(EntityLightningBolt lightningBolt)
-    {
-        this.attackEntityFrom(DamageSource.field_180137_b, 5.0F);
-        ++this.fire;
-
-        if (this.fire == 0)
-        {
-            this.setFire(8);
-        }
-    }
-
-    /**
-     * This method gets called when the entity kills another one.
-     */
-    public void onKillEntity(EntityLivingBase entityLivingIn) {}
-
-    protected boolean pushOutOfBlocks(double x, double y, double z)
-    {
-        BlockPos var7 = new BlockPos(x, y, z);
-        double var8 = x - (double)var7.getX();
-        double var10 = y - (double)var7.getY();
-        double var12 = z - (double)var7.getZ();
-        List var14 = this.worldObj.func_147461_a(this.getEntityBoundingBox());
-
-        if (var14.isEmpty() && !this.worldObj.func_175665_u(var7))
-        {
-            return false;
-        }
-        else
-        {
-            byte var15 = 3;
-            double var16 = 9999.0D;
-
-            if (!this.worldObj.func_175665_u(var7.offsetWest()) && var8 < var16)
-            {
-                var16 = var8;
-                var15 = 0;
-            }
-
-            if (!this.worldObj.func_175665_u(var7.offsetEast()) && 1.0D - var8 < var16)
-            {
-                var16 = 1.0D - var8;
-                var15 = 1;
-            }
-
-            if (!this.worldObj.func_175665_u(var7.offsetUp()) && 1.0D - var10 < var16)
-            {
-                var16 = 1.0D - var10;
-                var15 = 3;
-            }
-
-            if (!this.worldObj.func_175665_u(var7.offsetNorth()) && var12 < var16)
-            {
-                var16 = var12;
-                var15 = 4;
-            }
-
-            if (!this.worldObj.func_175665_u(var7.offsetSouth()) && 1.0D - var12 < var16)
-            {
-                var16 = 1.0D - var12;
-                var15 = 5;
-            }
-
-            float var18 = this.rand.nextFloat() * 0.2F + 0.1F;
-
-            if (var15 == 0)
-            {
-                this.motionX = (double)(-var18);
-            }
-
-            if (var15 == 1)
-            {
-                this.motionX = (double)var18;
-            }
-
-            if (var15 == 3)
-            {
-                this.motionY = (double)var18;
-            }
-
-            if (var15 == 4)
-            {
-                this.motionZ = (double)(-var18);
-            }
-
-            if (var15 == 5)
-            {
-                this.motionZ = (double)var18;
-            }
-
-            return true;
-        }
-    }
-
-    /**
-     * Sets the Entity inside a web block.
-     */
-    public void setInWeb()
-    {
-        this.isInWeb = true;
-        this.fallDistance = 0.0F;
-    }
-
-    /**
-     * Gets the name of this command sender (usually username, but possibly "Rcon")
-     */
-    public String getName()
-    {
-        if (this.hasCustomName())
-        {
-            return this.getCustomNameTag();
-        }
-        else
-        {
-            String var1 = EntityList.getEntityString(this);
-
-            if (var1 == null)
-            {
-                var1 = "generic";
-            }
-
-            return StatCollector.translateToLocal("entity." + var1 + ".name");
-        }
-    }
-
-    /**
-     * Return the Entity parts making up this Entity (currently only for dragons)
-     */
-    public Entity[] getParts()
-    {
-        return null;
-    }
-
-    /**
-     * Returns true if Entity argument is equal to this Entity
-     */
-    public boolean isEntityEqual(Entity entityIn)
-    {
-        return this == entityIn;
-    }
-
-    public float getRotationYawHead()
-    {
-        return 0.0F;
-    }
-
-    /**
-     * Sets the head's yaw rotation of the entity.
-     */
-    public void setRotationYawHead(float rotation) {}
-
-    /**
-     * If returns false, the item will not inflict any damage against entities.
-     */
-    public boolean canAttackWithItem()
-    {
-        return true;
-    }
-
-    /**
-     * Called when a player attacks an entity. If this returns true the attack will not happen.
-     */
-    public boolean hitByEntity(Entity entityIn)
-    {
-        return false;
-    }
-
-    public String toString()
-    {
-        return String.format("%s[\'%s\'/%d, l=\'%s\', x=%.2f, y=%.2f, z=%.2f]", new Object[] {this.getClass().getSimpleName(), this.getName(), Integer.valueOf(this.entityId), this.worldObj == null ? "~NULL~" : this.worldObj.getWorldInfo().getWorldName(), Double.valueOf(this.posX), Double.valueOf(this.posY), Double.valueOf(this.posZ)});
-    }
-
-    public boolean func_180431_b(DamageSource p_180431_1_)
-    {
-        return this.invulnerable && p_180431_1_ != DamageSource.outOfWorld && !p_180431_1_.func_180136_u();
-    }
-
-    /**
-     * Sets this entity's location and angles to the location and angles of the passed in entity.
-     */
-    public void copyLocationAndAnglesFrom(Entity entityIn)
-    {
-        this.setLocationAndAngles(entityIn.posX, entityIn.posY, entityIn.posZ, entityIn.rotationYaw, entityIn.rotationPitch);
-    }
-
-    public void func_180432_n(Entity p_180432_1_)
-    {
-        NBTTagCompound var2 = new NBTTagCompound();
-        p_180432_1_.writeToNBT(var2);
-        this.readFromNBT(var2);
-        this.timeUntilPortal = p_180432_1_.timeUntilPortal;
-        this.teleportDirection = p_180432_1_.teleportDirection;
-    }
-
-    /**
-     * Teleports the entity to another dimension. Params: Dimension number to teleport to
-     */
-    public void travelToDimension(int dimensionId)
-    {
-        if (!this.worldObj.isRemote && !this.isDead)
-        {
-            this.worldObj.theProfiler.startSection("changeDimension");
-            MinecraftServer var2 = MinecraftServer.getServer();
-            int var3 = this.dimension;
-            WorldServer var4 = var2.worldServerForDimension(var3);
-            WorldServer var5 = var2.worldServerForDimension(dimensionId);
-            this.dimension = dimensionId;
-
-            if (var3 == 1 && dimensionId == 1)
-            {
-                var5 = var2.worldServerForDimension(0);
-                this.dimension = 0;
-            }
-
-            this.worldObj.removeEntity(this);
-            this.isDead = false;
-            this.worldObj.theProfiler.startSection("reposition");
-            var2.getConfigurationManager().transferEntityToWorld(this, var3, var4, var5);
-            this.worldObj.theProfiler.endStartSection("reloading");
-            Entity var6 = EntityList.createEntityByName(EntityList.getEntityString(this), var5);
-
-            if (var6 != null)
-            {
-                var6.func_180432_n(this);
-
-                if (var3 == 1 && dimensionId == 1)
-                {
-                    BlockPos var7 = this.worldObj.func_175672_r(var5.getSpawnPoint());
-                    var6.func_174828_a(var7, var6.rotationYaw, var6.rotationPitch);
-                }
-
-                var5.spawnEntityInWorld(var6);
-            }
-
-            this.isDead = true;
-            this.worldObj.theProfiler.endSection();
-            var4.resetUpdateEntityTick();
-            var5.resetUpdateEntityTick();
-            this.worldObj.theProfiler.endSection();
-        }
-    }
-
-    /**
-     * Explosion resistance of a block relative to this entity
-     */
-    public float getExplosionResistance(Explosion p_180428_1_, World worldIn, BlockPos p_180428_3_, IBlockState p_180428_4_)
-    {
-        return p_180428_4_.getBlock().getExplosionResistance(this);
-    }
-
-    public boolean func_174816_a(Explosion p_174816_1_, World worldIn, BlockPos p_174816_3_, IBlockState p_174816_4_, float p_174816_5_)
-    {
-        return true;
-    }
-
-    /**
-     * The maximum height from where the entity is alowed to jump (used in pathfinder)
-     */
-    public int getMaxFallHeight()
-    {
-        return 3;
-    }
-
-    public int getTeleportDirection()
-    {
-        return this.teleportDirection;
-    }
-
-    /**
-     * Return whether this entity should NOT trigger a pressure plate or a tripwire.
-     */
-    public boolean doesEntityNotTriggerPressurePlate()
-    {
-        return false;
-    }
-
-    public void addEntityCrashInfo(CrashReportCategory category)
-    {
-        category.addCrashSectionCallable("Entity Type", new Callable()
-        {
-            private static final String __OBFID = "CL_00001534";
-            public String call()
-            {
-                return EntityList.getEntityString(Entity.this) + " (" + Entity.this.getClass().getCanonicalName() + ")";
-            }
-        });
-        category.addCrashSection("Entity ID", Integer.valueOf(this.entityId));
-        category.addCrashSectionCallable("Entity Name", new Callable()
-        {
-            private static final String __OBFID = "CL_00001535";
-            public String call()
-            {
-                return Entity.this.getName();
-            }
-        });
-        category.addCrashSection("Entity\'s Exact location", String.format("%.2f, %.2f, %.2f", new Object[] {Double.valueOf(this.posX), Double.valueOf(this.posY), Double.valueOf(this.posZ)}));
-        category.addCrashSection("Entity\'s Block location", CrashReportCategory.getCoordinateInfo((double)MathHelper.floor_double(this.posX), (double)MathHelper.floor_double(this.posY), (double)MathHelper.floor_double(this.posZ)));
-        category.addCrashSection("Entity\'s Momentum", String.format("%.2f, %.2f, %.2f", new Object[] {Double.valueOf(this.motionX), Double.valueOf(this.motionY), Double.valueOf(this.motionZ)}));
-        category.addCrashSectionCallable("Entity\'s Rider", new Callable()
-        {
-            private static final String __OBFID = "CL_00002259";
-            public String func_180118_a()
-            {
-                return Entity.this.riddenByEntity.toString();
-            }
-            public Object call()
-            {
-                return this.func_180118_a();
-            }
-        });
-        category.addCrashSectionCallable("Entity\'s Vehicle", new Callable()
-        {
-            private static final String __OBFID = "CL_00002258";
-            public String func_180116_a()
-            {
-                return Entity.this.ridingEntity.toString();
-            }
-            public Object call()
-            {
-                return this.func_180116_a();
-            }
-        });
-    }
-
-    /**
-     * Return whether this entity should be rendered as on fire.
-     */
-    public boolean canRenderOnFire()
-    {
-        return this.isBurning();
-    }
-
-    public UUID getUniqueID()
-    {
-        return this.entityUniqueID;
-    }
-
-    public boolean isPushedByWater()
-    {
-        return true;
-    }
-
-    public IChatComponent getDisplayName()
-    {
-        ChatComponentText var1 = new ChatComponentText(this.getName());
-        var1.getChatStyle().setChatHoverEvent(this.func_174823_aP());
-        var1.getChatStyle().setInsertion(this.getUniqueID().toString());
-        return var1;
-    }
-
-    /**
-     * Sets the custom name tag for this entity
-     */
-    public void setCustomNameTag(String p_96094_1_)
-    {
-        this.dataWatcher.updateObject(2, p_96094_1_);
-    }
-
-    public String getCustomNameTag()
-    {
-        return this.dataWatcher.getWatchableObjectString(2);
-    }
-
-    /**
-     * Returns true if this thing is named
-     */
-    public boolean hasCustomName()
-    {
-        return this.dataWatcher.getWatchableObjectString(2).length() > 0;
-    }
-
-    public void setAlwaysRenderNameTag(boolean p_174805_1_)
-    {
-        this.dataWatcher.updateObject(3, Byte.valueOf((byte)(p_174805_1_ ? 1 : 0)));
-    }
-
-    public boolean getAlwaysRenderNameTag()
-    {
-        return this.dataWatcher.getWatchableObjectByte(3) == 1;
-    }
-
-    /**
-     * Sets the position of the entity and updates the 'last' variables
-     */
-    public void setPositionAndUpdate(double p_70634_1_, double p_70634_3_, double p_70634_5_)
-    {
-        this.setLocationAndAngles(p_70634_1_, p_70634_3_, p_70634_5_, this.rotationYaw, this.rotationPitch);
-    }
-
-    public boolean getAlwaysRenderNameTagForRender()
-    {
-        return this.getAlwaysRenderNameTag();
-    }
-
-    public void func_145781_i(int p_145781_1_) {}
-
-    public EnumFacing func_174811_aO()
-    {
-        return EnumFacing.getHorizontal(MathHelper.floor_double((double)(this.rotationYaw * 4.0F / 360.0F) + 0.5D) & 3);
-    }
-
-    protected HoverEvent func_174823_aP()
-    {
-        NBTTagCompound var1 = new NBTTagCompound();
-        String var2 = EntityList.getEntityString(this);
-        var1.setString("id", this.getUniqueID().toString());
-
-        if (var2 != null)
-        {
-            var1.setString("type", var2);
-        }
-
-        var1.setString("name", this.getName());
-        return new HoverEvent(HoverEvent.Action.SHOW_ENTITY, new ChatComponentText(var1.toString()));
-    }
-
-    public boolean func_174827_a(EntityPlayerMP p_174827_1_)
-    {
-        return true;
-    }
-
-    public AxisAlignedBB getEntityBoundingBox()
-    {
-        return this.boundingBox;
-    }
-
-    public void func_174826_a(AxisAlignedBB p_174826_1_)
-    {
-        this.boundingBox = p_174826_1_;
-    }
-
-    public float getEyeHeight()
-    {
-        return this.height * 0.85F;
-    }
-
-    public boolean isOutsideBorder()
-    {
-        return this.isOutsideBorder;
-    }
-
-    public void setOutsideBorder(boolean p_174821_1_)
-    {
-        this.isOutsideBorder = p_174821_1_;
-    }
-
-    public boolean func_174820_d(int p_174820_1_, ItemStack p_174820_2_)
-    {
-        return false;
-    }
-
-    /**
-     * Notifies this sender of some sort of information.  This is for messages intended to display to the user.  Used
-     * for typical output (like "you asked for whether or not this game rule is set, so here's your answer"), warnings
-     * (like "I fetched this block for you by ID, but I'd like you to know that every time you do this, I die a little
-     * inside"), and errors (like "it's not called iron_pixacke, silly").
-     */
-    public void addChatMessage(IChatComponent message) {}
-
-    /**
-     * Returns true if the command sender is allowed to use the given command.
-     */
-    public boolean canCommandSenderUseCommand(int permissionLevel, String command)
-    {
-        return true;
-    }
-
-    public BlockPos getPosition()
-    {
-        return new BlockPos(this.posX, this.posY + 0.5D, this.posZ);
-    }
-
-    public Vec3 getPositionVector()
-    {
-        return new Vec3(this.posX, this.posY, this.posZ);
-    }
-
-    public World getEntityWorld()
-    {
-        return this.worldObj;
-    }
-
-    public Entity getCommandSenderEntity()
-    {
-        return this;
-    }
-
-    public boolean sendCommandFeedback()
-    {
-        return false;
-    }
-
-    public void func_174794_a(CommandResultStats.Type p_174794_1_, int p_174794_2_)
-    {
-        this.field_174837_as.func_179672_a(this, p_174794_1_, p_174794_2_);
-    }
-
-    public CommandResultStats func_174807_aT()
-    {
-        return this.field_174837_as;
-    }
-
-    public void func_174817_o(Entity p_174817_1_)
-    {
-        this.field_174837_as.func_179671_a(p_174817_1_.func_174807_aT());
-    }
-
-    public NBTTagCompound func_174819_aU()
-    {
-        return null;
-    }
-
-    public void func_174834_g(NBTTagCompound p_174834_1_) {}
-
-    public boolean func_174825_a(EntityPlayer p_174825_1_, Vec3 p_174825_2_)
-    {
-        return false;
-    }
-
-    public boolean func_180427_aV()
-    {
-        return false;
-    }
-
-    protected void func_174815_a(EntityLivingBase p_174815_1_, Entity p_174815_2_)
-    {
-        if (p_174815_2_ instanceof EntityLivingBase)
-        {
-            EnchantmentHelper.func_151384_a((EntityLivingBase)p_174815_2_, p_174815_1_);
-        }
-
-        EnchantmentHelper.func_151385_b(p_174815_1_, p_174815_2_);
-    }
-}
+package net.minecraft.entity;
+
+import java.util.Iterator;
+import java.util.List;
+import java.util.Random;
+import java.util.UUID;
+import java.util.concurrent.Callable;
+
+import net.minecraft.block.Block;
+import net.minecraft.block.BlockFence;
+import net.minecraft.block.BlockFenceGate;
+import net.minecraft.block.BlockLiquid;
+import net.minecraft.block.BlockWall;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.Minecraft;
+import net.minecraft.command.CommandResultStats;
+import net.minecraft.command.ICommandSender;
+import net.minecraft.crash.CrashReport;
+import net.minecraft.crash.CrashReportCategory;
+import net.minecraft.enchantment.EnchantmentHelper;
+import net.minecraft.enchantment.EnchantmentProtection;
+import net.minecraft.entity.effect.EntityLightningBolt;
+import net.minecraft.entity.item.EntityItem;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.EntityPlayerMP;
+import net.minecraft.event.HoverEvent;
+import net.minecraft.init.Blocks;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemStack;
+import net.minecraft.nbt.NBTTagCompound;
+import net.minecraft.nbt.NBTTagDouble;
+import net.minecraft.nbt.NBTTagFloat;
+import net.minecraft.nbt.NBTTagList;
+import net.minecraft.server.MinecraftServer;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.ChatComponentText;
+import net.minecraft.util.DamageSource;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.EnumParticleTypes;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.MovingObjectPosition;
+import net.minecraft.util.ReportedException;
+import net.minecraft.util.StatCollector;
+import net.minecraft.util.Vec3;
+import net.minecraft.world.Explosion;
+import net.minecraft.world.World;
+import net.minecraft.world.WorldServer;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.AntiKnockbackMod;
+import tk.wurst_client.mods.FreecamMod;
+import tk.wurst_client.mods.PhaseMod;
+
+public abstract class Entity implements ICommandSender
+{
+    private static final AxisAlignedBB field_174836_a = new AxisAlignedBB(0.0D, 0.0D, 0.0D, 0.0D, 0.0D, 0.0D);
+    private static int nextEntityID;
+    private int entityId;
+    public double renderDistanceWeight;
+
+    /**
+     * Blocks entities from spawning when they do their AABB check to make sure the spot is clear of entities that can
+     * prevent spawning.
+     */
+    public boolean preventEntitySpawning;
+
+    /** The entity that is riding this entity */
+    public Entity riddenByEntity;
+
+    /** The entity we are currently riding */
+    public Entity ridingEntity;
+    public boolean forceSpawn;
+
+    /** Reference to the World object. */
+    public World worldObj;
+    public double prevPosX;
+    public double prevPosY;
+    public double prevPosZ;
+
+    /** Entity position X */
+    public double posX;
+
+    /** Entity position Y */
+    public double posY;
+
+    /** Entity position Z */
+    public double posZ;
+
+    /** Entity motion X */
+    public double motionX;
+
+    /** Entity motion Y */
+    public double motionY;
+
+    /** Entity motion Z */
+    public double motionZ;
+
+    /** Entity rotation Yaw */
+    public float rotationYaw;
+
+    /** Entity rotation Pitch */
+    public float rotationPitch;
+    public float prevRotationYaw;
+    public float prevRotationPitch;
+
+    /** Axis aligned bounding box. *///TODO: Client
+    public AxisAlignedBB boundingBox;
+    public boolean onGround;
+
+    /**
+     * True if after a move this entity has collided with something on X- or Z-axis
+     */
+    public boolean isCollidedHorizontally;
+
+    /**
+     * True if after a move this entity has collided with something on Y-axis
+     */
+    public boolean isCollidedVertically;
+
+    /**
+     * True if after a move this entity has collided with something either vertically or horizontally
+     */
+    public boolean isCollided;
+    public boolean velocityChanged;
+    //TODO: Client
+    public boolean isInWeb;
+    private boolean isOutsideBorder;
+
+    /**
+     * gets set by setEntityDead, so this must be the flag whether an Entity is dead (inactive may be better term)
+     */
+    public boolean isDead;
+
+    /** How wide this entity is considered to be */
+    public float width;
+
+    /** How high this entity is considered to be */
+    public float height;
+
+    /** The previous ticks distance walked multiplied by 0.6 */
+    public float prevDistanceWalkedModified;
+
+    /** The distance walked multiplied by 0.6 */
+    public float distanceWalkedModified;
+    public float distanceWalkedOnStepModified;
+    public float fallDistance;
+
+    /**
+     * The distance that has to be exceeded in order to triger a new step sound and an onEntityWalking event on a block
+     */
+    private int nextStepDistance;
+
+    /**
+     * The entity's X coordinate at the previous tick, used to calculate position during rendering routines
+     */
+    public double lastTickPosX;
+
+    /**
+     * The entity's Y coordinate at the previous tick, used to calculate position during rendering routines
+     */
+    public double lastTickPosY;
+
+    /**
+     * The entity's Z coordinate at the previous tick, used to calculate position during rendering routines
+     */
+    public double lastTickPosZ;
+
+    /**
+     * How high this entity can step up when running into a block to try to get over it (currently make note the entity
+     * will always step up this amount and not just the amount needed)
+     */
+    public float stepHeight;
+
+    /**
+     * Whether this entity won't clip with collision or not (make note it won't disable gravity)
+     */
+    public boolean noClip;
+
+    /**
+     * Reduces the velocity applied by entity collisions by the specified percent.
+     */
+    public float entityCollisionReduction;
+    protected Random rand;
+
+    /** How many ticks has this entity had ran since being alive */
+    public int ticksExisted;
+
+    /**
+     * The amount of ticks you have to stand inside of fire before be set on fire
+     */
+    public int fireResistance;
+    private int fire;
+
+    /**
+     * Whether this entity is currently inside of water (if it handles water movement that is)
+     */
+    protected boolean inWater;
+
+    /**
+     * Remaining time an entity will be "immune" to further damage after being hurt.
+     */
+    public int hurtResistantTime;
+    protected boolean firstUpdate;
+    protected boolean isImmuneToFire;
+    protected DataWatcher dataWatcher;
+    private double entityRiderPitchDelta;
+    private double entityRiderYawDelta;
+
+    /** Has this entity been added to the chunk its within */
+    public boolean addedToChunk;
+    public int chunkCoordX;
+    public int chunkCoordY;
+    public int chunkCoordZ;
+    public int serverPosX;
+    public int serverPosY;
+    public int serverPosZ;
+
+    /**
+     * Render entity even if it is outside the camera frustum. Only true in EntityFish for now. Used in RenderGlobal:
+     * render if ignoreFrustumCheck or in frustum.
+     */
+    public boolean ignoreFrustumCheck;
+    public boolean isAirBorne;
+    public int timeUntilPortal;
+
+    /** Whether the entity is inside a Portal */
+    protected boolean inPortal;
+    protected int portalCounter;
+
+    /** Which dimension the player is in (-1 = the Nether, 0 = normal world) */
+    public int dimension;
+    protected int teleportDirection;
+    private boolean invulnerable;
+    protected UUID entityUniqueID;
+    private final CommandResultStats field_174837_as;
+    private static final String __OBFID = "CL_00001533";
+
+    public int getEntityId()
+    {
+        return this.entityId;
+    }
+
+    public void setEntityId(int id)
+    {
+        this.entityId = id;
+    }
+
+    public void func_174812_G()
+    {
+        this.setDead();
+    }
+
+    public Entity(World worldIn)
+    {
+        this.entityId = nextEntityID++;
+        this.renderDistanceWeight = 1.0D;
+        this.boundingBox = field_174836_a;
+        this.width = 0.6F;
+        this.height = 1.8F;
+        this.nextStepDistance = 1;
+        this.rand = new Random();
+        this.fireResistance = 1;
+        this.firstUpdate = true;
+        this.entityUniqueID = MathHelper.func_180182_a(this.rand);
+        this.field_174837_as = new CommandResultStats();
+        this.worldObj = worldIn;
+        this.setPosition(0.0D, 0.0D, 0.0D);
+
+        if (worldIn != null)
+        {
+            this.dimension = worldIn.provider.getDimensionId();
+        }
+
+        this.dataWatcher = new DataWatcher(this);
+        this.dataWatcher.addObject(0, Byte.valueOf((byte)0));
+        this.dataWatcher.addObject(1, Short.valueOf((short)300));
+        this.dataWatcher.addObject(3, Byte.valueOf((byte)0));
+        this.dataWatcher.addObject(2, "");
+        this.dataWatcher.addObject(4, Byte.valueOf((byte)0));
+        this.entityInit();
+    }
+
+    protected abstract void entityInit();
+
+    public DataWatcher getDataWatcher()
+    {
+        return this.dataWatcher;
+    }
+
+    public boolean equals(Object p_equals_1_)
+    {
+        return p_equals_1_ instanceof Entity ? ((Entity)p_equals_1_).entityId == this.entityId : false;
+    }
+
+    public int hashCode()
+    {
+        return this.entityId;
+    }
+
+    /**
+     * Keeps moving the entity up so it isn't colliding with blocks and other requirements for this entity to be spawned
+     * (only actually used on players though its also on Entity)
+     */
+    protected void preparePlayerToSpawn()
+    {
+        if (this.worldObj != null)
+        {
+            while (this.posY > 0.0D && this.posY < 256.0D)
+            {
+                this.setPosition(this.posX, this.posY, this.posZ);
+
+                if (this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox()).isEmpty())
+                {
+                    break;
+                }
+
+                ++this.posY;
+            }
+
+            this.motionX = this.motionY = this.motionZ = 0.0D;
+            this.rotationPitch = 0.0F;
+        }
+    }
+
+    /**
+     * Will get destroyed next tick.
+     */
+    public void setDead()
+    {
+        this.isDead = true;
+    }
+
+    /**
+     * Sets the width and height of the entity. Args: width, height
+     */
+    protected void setSize(float width, float height)
+    {
+        if (width != this.width || height != this.height)
+        {
+            float var3 = this.width;
+            this.width = width;
+            this.height = height;
+            this.func_174826_a(new AxisAlignedBB(this.getEntityBoundingBox().minX, this.getEntityBoundingBox().minY, this.getEntityBoundingBox().minZ, this.getEntityBoundingBox().minX + (double)this.width, this.getEntityBoundingBox().minY + (double)this.height, this.getEntityBoundingBox().minZ + (double)this.width));
+
+            if (this.width > var3 && !this.firstUpdate && !this.worldObj.isRemote)
+            {
+                this.moveEntity((double)(var3 - this.width), 0.0D, (double)(var3 - this.width));
+            }
+        }
+    }
+
+    /**
+     * Sets the rotation of the entity. Args: yaw, pitch (both in degrees)
+     */
+    protected void setRotation(float yaw, float pitch)
+    {
+        this.rotationYaw = yaw % 360.0F;
+        this.rotationPitch = pitch % 360.0F;
+    }
+
+    /**
+     * Sets the x,y,z of the entity from the given parameters. Also seems to set up a bounding box.
+     */
+    public void setPosition(double x, double y, double z)
+    {
+        this.posX = x;
+        this.posY = y;
+        this.posZ = z;
+        float var7 = this.width / 2.0F;
+        float var8 = this.height;
+        this.func_174826_a(new AxisAlignedBB(x - (double)var7, y, z - (double)var7, x + (double)var7, y + (double)var8, z + (double)var7));
+    }
+
+    /**
+     * Adds 15% to the entity's yaw and subtracts 15% from the pitch. Clamps pitch from -90 to 90. Both arguments in
+     * degrees.
+     */
+    public void setAngles(float yaw, float pitch)
+    {
+        float var3 = this.rotationPitch;
+        float var4 = this.rotationYaw;
+        this.rotationYaw = (float)((double)this.rotationYaw + (double)yaw * 0.15D);
+        this.rotationPitch = (float)((double)this.rotationPitch - (double)pitch * 0.15D);
+        this.rotationPitch = MathHelper.clamp_float(this.rotationPitch, -90.0F, 90.0F);
+        this.prevRotationPitch += this.rotationPitch - var3;
+        this.prevRotationYaw += this.rotationYaw - var4;
+    }
+
+    /**
+     * Called to update the entity's position/logic.
+     */
+    public void onUpdate()
+    {
+        this.onEntityUpdate();
+    }
+
+    /**
+     * Gets called every tick from main Entity class
+     */
+    public void onEntityUpdate()
+    {
+        this.worldObj.theProfiler.startSection("entityBaseTick");
+
+        if (this.ridingEntity != null && this.ridingEntity.isDead)
+        {
+            this.ridingEntity = null;
+        }
+
+        this.prevDistanceWalkedModified = this.distanceWalkedModified;
+        this.prevPosX = this.posX;
+        this.prevPosY = this.posY;
+        this.prevPosZ = this.posZ;
+        this.prevRotationPitch = this.rotationPitch;
+        this.prevRotationYaw = this.rotationYaw;
+
+        if (!this.worldObj.isRemote && this.worldObj instanceof WorldServer)
+        {
+            this.worldObj.theProfiler.startSection("portal");
+            MinecraftServer var1 = ((WorldServer)this.worldObj).func_73046_m();
+            int var2 = this.getMaxInPortalTime();
+
+            if (this.inPortal)
+            {
+                if (var1.getAllowNether())
+                {
+                    if (this.ridingEntity == null && this.portalCounter++ >= var2)
+                    {
+                        this.portalCounter = var2;
+                        this.timeUntilPortal = this.getPortalCooldown();
+                        byte var3;
+
+                        if (this.worldObj.provider.getDimensionId() == -1)
+                        {
+                            var3 = 0;
+                        }
+                        else
+                        {
+                            var3 = -1;
+                        }
+
+                        this.travelToDimension(var3);
+                    }
+
+                    this.inPortal = false;
+                }
+            }
+            else
+            {
+                if (this.portalCounter > 0)
+                {
+                    this.portalCounter -= 4;
+                }
+
+                if (this.portalCounter < 0)
+                {
+                    this.portalCounter = 0;
+                }
+            }
+
+            if (this.timeUntilPortal > 0)
+            {
+                --this.timeUntilPortal;
+            }
+
+            this.worldObj.theProfiler.endSection();
+        }
+
+        this.func_174830_Y();
+        this.handleWaterMovement();
+
+        if (this.worldObj.isRemote)
+        {
+            this.fire = 0;
+        }
+        else if (this.fire > 0)
+        {
+            if (this.isImmuneToFire)
+            {
+                this.fire -= 4;
+
+                if (this.fire < 0)
+                {
+                    this.fire = 0;
+                }
+            }
+            else
+            {
+                if (this.fire % 20 == 0)
+                {
+                    this.attackEntityFrom(DamageSource.onFire, 1.0F);
+                }
+
+                --this.fire;
+            }
+        }
+
+        if (this.func_180799_ab())
+        {
+            this.setOnFireFromLava();
+            this.fallDistance *= 0.5F;
+        }
+
+        if (this.posY < -64.0D)
+        {
+            this.kill();
+        }
+
+        if (!this.worldObj.isRemote)
+        {
+            this.setFlag(0, this.fire > 0);
+        }
+
+        this.firstUpdate = false;
+        this.worldObj.theProfiler.endSection();
+    }
+
+    /**
+     * Return the amount of time this entity should stay in a portal before being transported.
+     */
+    public int getMaxInPortalTime()
+    {
+        return 0;
+    }
+
+    /**
+     * Called whenever the entity is walking inside of lava.
+     */
+    protected void setOnFireFromLava()
+    {
+        if (!this.isImmuneToFire)
+        {
+            this.attackEntityFrom(DamageSource.lava, 4.0F);
+            this.setFire(15);
+        }
+    }
+
+    /**
+     * Sets entity to burn for x amount of seconds, cannot lower amount of existing fire.
+     */
+    public void setFire(int seconds)
+    {
+        int var2 = seconds * 20;
+        var2 = EnchantmentProtection.getFireTimeForEntity(this, var2);
+
+        if (this.fire < var2)
+        {
+            this.fire = var2;
+        }
+    }
+
+    /**
+     * Removes fire from entity.
+     */
+    public void extinguish()
+    {
+        this.fire = 0;
+    }
+
+    /**
+     * sets the dead flag. Used when you fall off the bottom of the world.
+     */
+    protected void kill()
+    {
+        this.setDead();
+    }
+
+    /**
+     * Checks if the offset position from the entity's current position is inside of liquid. Args: x, y, z
+     */
+    public boolean isOffsetPositionInLiquid(double x, double y, double z)
+    {
+        AxisAlignedBB var7 = this.getEntityBoundingBox().offset(x, y, z);
+        return this.func_174809_b(var7);
+    }
+
+    private boolean func_174809_b(AxisAlignedBB p_174809_1_)
+    {
+        return this.worldObj.getCollidingBoundingBoxes(this, p_174809_1_).isEmpty() && !this.worldObj.isAnyLiquid(p_174809_1_);
+    }
+
+    /**
+     * Tries to moves the entity by the passed in displacement. Args: x, y, z
+     */
+    public void moveEntity(double x, double y, double z)
+    {
+        //TODO: Client
+    	//Enables NoClip.
+        if
+        (
+        	this.noClip
+        	|| WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled()
+        	|| WurstClient.INSTANCE.modManager.getModByClass(PhaseMod.class).isEnabled()
+        )
+        {
+        	//TODO: Client
+        	//Fixes Freecam flight speed
+        	if(this == Minecraft.getMinecraft().thePlayer && WurstClient.INSTANCE.modManager.getModByClass(FreecamMod.class).isEnabled())
+        	{
+        		this.func_174826_a(this.getEntityBoundingBox().offset(x * 10, y, z * 10));
+        	}else
+        		this.func_174826_a(this.getEntityBoundingBox().offset(x, y, z));
+            this.func_174829_m();
+        }
+        else
+        {
+            this.worldObj.theProfiler.startSection("move");
+            double var7 = this.posX;
+            double var9 = this.posY;
+            double var11 = this.posZ;
+
+            if (this.isInWeb)
+            {
+                this.isInWeb = false;
+                x *= 0.25D;
+                y *= 0.05000000074505806D;
+                z *= 0.25D;
+                this.motionX = 0.0D;
+                this.motionY = 0.0D;
+                this.motionZ = 0.0D;
+            }
+
+            double var13 = x;
+            double var15 = y;
+            double var17 = z;
+            boolean var19 = this.onGround && this.isSneaking() && this instanceof EntityPlayer;
+
+            if (var19)
+            {
+                double var20;
+
+                for (var20 = 0.05D; x != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(x, -1.0D, 0.0D)).isEmpty(); var13 = x)
+                {
+                    if (x < var20 && x >= -var20)
+                    {
+                        x = 0.0D;
+                    }
+                    else if (x > 0.0D)
+                    {
+                        x -= var20;
+                    }
+                    else
+                    {
+                        x += var20;
+                    }
+                }
+
+                for (; z != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(0.0D, -1.0D, z)).isEmpty(); var17 = z)
+                {
+                    if (z < var20 && z >= -var20)
+                    {
+                        z = 0.0D;
+                    }
+                    else if (z > 0.0D)
+                    {
+                        z -= var20;
+                    }
+                    else
+                    {
+                        z += var20;
+                    }
+                }
+
+                for (; x != 0.0D && z != 0.0D && this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().offset(x, -1.0D, z)).isEmpty(); var17 = z)
+                {
+                    if (x < var20 && x >= -var20)
+                    {
+                        x = 0.0D;
+                    }
+                    else if (x > 0.0D)
+                    {
+                        x -= var20;
+                    }
+                    else
+                    {
+                        x += var20;
+                    }
+
+                    var13 = x;
+
+                    if (z < var20 && z >= -var20)
+                    {
+                        z = 0.0D;
+                    }
+                    else if (z > 0.0D)
+                    {
+                        z -= var20;
+                    }
+                    else
+                    {
+                        z += var20;
+                    }
+                }
+            }
+
+            List var53 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().addCoord(x, y, z));
+            AxisAlignedBB var21 = this.getEntityBoundingBox();
+            AxisAlignedBB var23;
+
+            for (Iterator var22 = var53.iterator(); var22.hasNext(); y = var23.calculateYOffset(this.getEntityBoundingBox(), y))
+            {
+                var23 = (AxisAlignedBB)var22.next();
+            }
+
+            this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, y, 0.0D));
+            boolean var54 = this.onGround || var15 != y && var15 < 0.0D;
+            AxisAlignedBB var24;
+            Iterator var55;
+
+            for (var55 = var53.iterator(); var55.hasNext(); x = var24.calculateXOffset(this.getEntityBoundingBox(), x))
+            {
+                var24 = (AxisAlignedBB)var55.next();
+            }
+
+            this.func_174826_a(this.getEntityBoundingBox().offset(x, 0.0D, 0.0D));
+
+            for (var55 = var53.iterator(); var55.hasNext(); z = var24.calculateZOffset(this.getEntityBoundingBox(), z))
+            {
+                var24 = (AxisAlignedBB)var55.next();
+            }
+
+            this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, 0.0D, z));
+
+            if (this.stepHeight > 0.0F && var54 && (var13 != x || var17 != z))
+            {
+                double var56 = x;
+                double var25 = y;
+                double var27 = z;
+                AxisAlignedBB var29 = this.getEntityBoundingBox();
+                this.func_174826_a(var21);
+                y = (double)this.stepHeight;
+                List var30 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().addCoord(var13, y, var17));
+                AxisAlignedBB var31 = this.getEntityBoundingBox();
+                AxisAlignedBB var32 = var31.addCoord(var13, 0.0D, var17);
+                double var33 = y;
+                AxisAlignedBB var36;
+
+                for (Iterator var35 = var30.iterator(); var35.hasNext(); var33 = var36.calculateYOffset(var32, var33))
+                {
+                    var36 = (AxisAlignedBB)var35.next();
+                }
+
+                var31 = var31.offset(0.0D, var33, 0.0D);
+                double var67 = var13;
+                AxisAlignedBB var38;
+
+                for (Iterator var37 = var30.iterator(); var37.hasNext(); var67 = var38.calculateXOffset(var31, var67))
+                {
+                    var38 = (AxisAlignedBB)var37.next();
+                }
+
+                var31 = var31.offset(var67, 0.0D, 0.0D);
+                double var68 = var17;
+                AxisAlignedBB var40;
+
+                for (Iterator var39 = var30.iterator(); var39.hasNext(); var68 = var40.calculateZOffset(var31, var68))
+                {
+                    var40 = (AxisAlignedBB)var39.next();
+                }
+
+                var31 = var31.offset(0.0D, 0.0D, var68);
+                AxisAlignedBB var69 = this.getEntityBoundingBox();
+                double var70 = y;
+                AxisAlignedBB var43;
+
+                for (Iterator var42 = var30.iterator(); var42.hasNext(); var70 = var43.calculateYOffset(var69, var70))
+                {
+                    var43 = (AxisAlignedBB)var42.next();
+                }
+
+                var69 = var69.offset(0.0D, var70, 0.0D);
+                double var71 = var13;
+                AxisAlignedBB var45;
+
+                for (Iterator var44 = var30.iterator(); var44.hasNext(); var71 = var45.calculateXOffset(var69, var71))
+                {
+                    var45 = (AxisAlignedBB)var44.next();
+                }
+
+                var69 = var69.offset(var71, 0.0D, 0.0D);
+                double var72 = var17;
+                AxisAlignedBB var47;
+
+                for (Iterator var46 = var30.iterator(); var46.hasNext(); var72 = var47.calculateZOffset(var69, var72))
+                {
+                    var47 = (AxisAlignedBB)var46.next();
+                }
+
+                var69 = var69.offset(0.0D, 0.0D, var72);
+                double var73 = var67 * var67 + var68 * var68;
+                double var48 = var71 * var71 + var72 * var72;
+
+                if (var73 > var48)
+                {
+                    x = var67;
+                    z = var68;
+                    this.func_174826_a(var31);
+                }
+                else
+                {
+                    x = var71;
+                    z = var72;
+                    this.func_174826_a(var69);
+                }
+
+                y = (double)(-this.stepHeight);
+                AxisAlignedBB var51;
+
+                for (Iterator var50 = var30.iterator(); var50.hasNext(); y = var51.calculateYOffset(this.getEntityBoundingBox(), y))
+                {
+                    var51 = (AxisAlignedBB)var50.next();
+                }
+
+                this.func_174826_a(this.getEntityBoundingBox().offset(0.0D, y, 0.0D));
+
+                if (var56 * var56 + var27 * var27 >= x * x + z * z)
+                {
+                    x = var56;
+                    y = var25;
+                    z = var27;
+                    this.func_174826_a(var29);
+                }
+            }
+
+            this.worldObj.theProfiler.endSection();
+            this.worldObj.theProfiler.startSection("rest");
+            this.func_174829_m();
+            this.isCollidedHorizontally = var13 != x || var17 != z;
+            this.isCollidedVertically = var15 != y;
+            this.onGround = this.isCollidedVertically && var15 < 0.0D;
+            this.isCollided = this.isCollidedHorizontally || this.isCollidedVertically;
+            int var57 = MathHelper.floor_double(this.posX);
+            int var58 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
+            int var59 = MathHelper.floor_double(this.posZ);
+            BlockPos var26 = new BlockPos(var57, var58, var59);
+            Block var60 = this.worldObj.getBlockState(var26).getBlock();
+
+            if (var60.getMaterial() == Material.air)
+            {
+                Block var28 = this.worldObj.getBlockState(var26.offsetDown()).getBlock();
+
+                if (var28 instanceof BlockFence || var28 instanceof BlockWall || var28 instanceof BlockFenceGate)
+                {
+                    var60 = var28;
+                    var26 = var26.offsetDown();
+                }
+            }
+
+            this.func_180433_a(y, this.onGround, var60, var26);
+
+            if (var13 != x)
+            {
+                this.motionX = 0.0D;
+            }
+
+            if (var17 != z)
+            {
+                this.motionZ = 0.0D;
+            }
+
+            if (var15 != y)
+            {
+                var60.onLanded(this.worldObj, this);
+            }
+
+            if (this.canTriggerWalking() && !var19 && this.ridingEntity == null)
+            {
+                double var61 = this.posX - var7;
+                double var64 = this.posY - var9;
+                double var66 = this.posZ - var11;
+
+                if (var60 != Blocks.ladder)
+                {
+                    var64 = 0.0D;
+                }
+
+                if (var60 != null && this.onGround)
+                {
+                    var60.onEntityCollidedWithBlock(this.worldObj, var26, this);
+                }
+
+                this.distanceWalkedModified = (float)((double)this.distanceWalkedModified + (double)MathHelper.sqrt_double(var61 * var61 + var66 * var66) * 0.6D);
+                this.distanceWalkedOnStepModified = (float)((double)this.distanceWalkedOnStepModified + (double)MathHelper.sqrt_double(var61 * var61 + var64 * var64 + var66 * var66) * 0.6D);
+
+                if (this.distanceWalkedOnStepModified > (float)this.nextStepDistance && var60.getMaterial() != Material.air)
+                {
+                    this.nextStepDistance = (int)this.distanceWalkedOnStepModified + 1;
+
+                    if (this.isInWater())
+                    {
+                        float var34 = MathHelper.sqrt_double(this.motionX * this.motionX * 0.20000000298023224D + this.motionY * this.motionY + this.motionZ * this.motionZ * 0.20000000298023224D) * 0.35F;
+
+                        if (var34 > 1.0F)
+                        {
+                            var34 = 1.0F;
+                        }
+
+                        this.playSound(this.getSwimSound(), var34, 1.0F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
+                    }
+
+                    this.func_180429_a(var26, var60);
+                }
+            }
+
+            try
+            {
+                this.doBlockCollisions();
+            }
+            catch (Throwable var52)
+            {
+                CrashReport var63 = CrashReport.makeCrashReport(var52, "Checking entity block collision");
+                CrashReportCategory var65 = var63.makeCategory("Entity being checked for collision");
+                this.addEntityCrashInfo(var65);
+                throw new ReportedException(var63);
+            }
+
+            boolean var62 = this.isWet();
+
+            if (this.worldObj.func_147470_e(this.getEntityBoundingBox().contract(0.001D, 0.001D, 0.001D)))
+            {
+                this.dealFireDamage(1);
+
+                if (!var62)
+                {
+                    ++this.fire;
+
+                    if (this.fire == 0)
+                    {
+                        this.setFire(8);
+                    }
+                }
+            }
+            else if (this.fire <= 0)
+            {
+                this.fire = -this.fireResistance;
+            }
+
+            if (var62 && this.fire > 0)
+            {
+                this.playSound("random.fizz", 0.7F, 1.6F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
+                this.fire = -this.fireResistance;
+            }
+
+            this.worldObj.theProfiler.endSection();
+        }
+    }
+
+    private void func_174829_m()
+    {
+        this.posX = (this.getEntityBoundingBox().minX + this.getEntityBoundingBox().maxX) / 2.0D;
+        this.posY = this.getEntityBoundingBox().minY;
+        this.posZ = (this.getEntityBoundingBox().minZ + this.getEntityBoundingBox().maxZ) / 2.0D;
+    }
+
+    protected String getSwimSound()
+    {
+        return "game.neutral.swim";
+    }
+
+    protected void doBlockCollisions()
+    {
+        BlockPos var1 = new BlockPos(this.getEntityBoundingBox().minX + 0.001D, this.getEntityBoundingBox().minY + 0.001D, this.getEntityBoundingBox().minZ + 0.001D);
+        BlockPos var2 = new BlockPos(this.getEntityBoundingBox().maxX - 0.001D, this.getEntityBoundingBox().maxY - 0.001D, this.getEntityBoundingBox().maxZ - 0.001D);
+
+        if (this.worldObj.isAreaLoaded(var1, var2))
+        {
+            for (int var3 = var1.getX(); var3 <= var2.getX(); ++var3)
+            {
+                for (int var4 = var1.getY(); var4 <= var2.getY(); ++var4)
+                {
+                    for (int var5 = var1.getZ(); var5 <= var2.getZ(); ++var5)
+                    {
+                        BlockPos var6 = new BlockPos(var3, var4, var5);
+                        IBlockState var7 = this.worldObj.getBlockState(var6);
+
+                        try
+                        {
+                            var7.getBlock().onEntityCollidedWithBlock(this.worldObj, var6, var7, this);
+                        }
+                        catch (Throwable var11)
+                        {
+                            CrashReport var9 = CrashReport.makeCrashReport(var11, "Colliding entity with block");
+                            CrashReportCategory var10 = var9.makeCategory("Block being collided with");
+                            CrashReportCategory.addBlockInfo(var10, var6, var7);
+                            throw new ReportedException(var9);
+                        }
+                    }
+                }
+            }
+        }
+    }
+
+    protected void func_180429_a(BlockPos p_180429_1_, Block p_180429_2_)
+    {
+        Block.SoundType var3 = p_180429_2_.stepSound;
+
+        if (this.worldObj.getBlockState(p_180429_1_.offsetUp()).getBlock() == Blocks.snow_layer)
+        {
+            var3 = Blocks.snow_layer.stepSound;
+            this.playSound(var3.getStepSound(), var3.getVolume() * 0.15F, var3.getFrequency());
+        }
+        else if (!p_180429_2_.getMaterial().isLiquid())
+        {
+            this.playSound(var3.getStepSound(), var3.getVolume() * 0.15F, var3.getFrequency());
+        }
+    }
+
+    public void playSound(String name, float volume, float pitch)
+    {
+        if (!this.isSlient())
+        {
+            this.worldObj.playSoundAtEntity(this, name, volume, pitch);
+        }
+    }
+
+    /**
+     * @return True if this entity will not play sounds
+     */
+    public boolean isSlient()
+    {
+        return this.dataWatcher.getWatchableObjectByte(4) == 1;
+    }
+
+    public void func_174810_b(boolean p_174810_1_)
+    {
+        this.dataWatcher.updateObject(4, Byte.valueOf((byte)(p_174810_1_ ? 1 : 0)));
+    }
+
+    /**
+     * returns if this entity triggers Block.onEntityWalking on the blocks they walk on. used for spiders and wolves to
+     * prevent them from trampling crops
+     */
+    protected boolean canTriggerWalking()
+    {
+        return true;
+    }
+
+    protected void func_180433_a(double p_180433_1_, boolean p_180433_3_, Block p_180433_4_, BlockPos p_180433_5_)
+    {
+        if (p_180433_3_)
+        {
+            if (this.fallDistance > 0.0F)
+            {
+                if (p_180433_4_ != null)
+                {
+                    p_180433_4_.onFallenUpon(this.worldObj, p_180433_5_, this, this.fallDistance);
+                }
+                else
+                {
+                    this.fall(this.fallDistance, 1.0F);
+                }
+
+                this.fallDistance = 0.0F;
+            }
+        }
+        else if (p_180433_1_ < 0.0D)
+        {
+            this.fallDistance = (float)((double)this.fallDistance - p_180433_1_);
+        }
+    }
+
+    /**
+     * returns the bounding box for this entity
+     */
+    public AxisAlignedBB getBoundingBox()
+    {
+        return null;
+    }
+
+    /**
+     * Will deal the specified amount of damage to the entity if the entity isn't immune to fire damage. Args:
+     * amountDamage
+     */
+    protected void dealFireDamage(int amount)
+    {
+        if (!this.isImmuneToFire)
+        {
+            this.attackEntityFrom(DamageSource.inFire, (float)amount);
+        }
+    }
+
+    public final boolean isImmuneToFire()
+    {
+        return this.isImmuneToFire;
+    }
+
+    public void fall(float distance, float damageMultiplier)
+    {
+        if (this.riddenByEntity != null)
+        {
+            this.riddenByEntity.fall(distance, damageMultiplier);
+        }
+    }
+
+    /**
+     * Checks if this entity is either in water or on an open air block in rain (used in wolves).
+     */
+    public boolean isWet()
+    {
+        return this.inWater || this.worldObj.func_175727_C(new BlockPos(this.posX, this.posY, this.posZ)) || this.worldObj.func_175727_C(new BlockPos(this.posX, this.posY + (double)this.height, this.posZ));
+    }
+
+    /**
+     * Checks if this entity is inside water (if inWater field is true as a result of handleWaterMovement() returning
+     * true)
+     */
+    public boolean isInWater()
+    {
+        return this.inWater;
+    }
+
+    /**
+     * Returns if this entity is in water and will end up adding the waters velocity to the entity
+     */
+    public boolean handleWaterMovement()
+    {
+        if (this.worldObj.handleMaterialAcceleration(this.getEntityBoundingBox().expand(0.0D, -0.4000000059604645D, 0.0D).contract(0.001D, 0.001D, 0.001D), Material.water, this))
+        {
+            if (!this.inWater && !this.firstUpdate)
+            {
+                this.resetHeight();
+            }
+
+            this.fallDistance = 0.0F;
+            this.inWater = true;
+            this.fire = 0;
+        }
+        else
+        {
+            this.inWater = false;
+        }
+
+        return this.inWater;
+    }
+
+    /**
+     * sets the players height back to normal after doing things like sleeping and dieing
+     */
+    protected void resetHeight()
+    {
+        float var1 = MathHelper.sqrt_double(this.motionX * this.motionX * 0.20000000298023224D + this.motionY * this.motionY + this.motionZ * this.motionZ * 0.20000000298023224D) * 0.2F;
+
+        if (var1 > 1.0F)
+        {
+            var1 = 1.0F;
+        }
+
+        this.playSound(this.getSplashSound(), var1, 1.0F + (this.rand.nextFloat() - this.rand.nextFloat()) * 0.4F);
+        float var2 = (float)MathHelper.floor_double(this.getEntityBoundingBox().minY);
+        int var3;
+        float var4;
+        float var5;
+
+        for (var3 = 0; (float)var3 < 1.0F + this.width * 20.0F; ++var3)
+        {
+            var4 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
+            var5 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
+            this.worldObj.spawnParticle(EnumParticleTypes.WATER_BUBBLE, this.posX + (double)var4, (double)(var2 + 1.0F), this.posZ + (double)var5, this.motionX, this.motionY - (double)(this.rand.nextFloat() * 0.2F), this.motionZ, new int[0]);
+        }
+
+        for (var3 = 0; (float)var3 < 1.0F + this.width * 20.0F; ++var3)
+        {
+            var4 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
+            var5 = (this.rand.nextFloat() * 2.0F - 1.0F) * this.width;
+            this.worldObj.spawnParticle(EnumParticleTypes.WATER_SPLASH, this.posX + (double)var4, (double)(var2 + 1.0F), this.posZ + (double)var5, this.motionX, this.motionY, this.motionZ, new int[0]);
+        }
+    }
+
+    public void func_174830_Y()
+    {
+        if (this.isSprinting() && !this.isInWater())
+        {
+            this.func_174808_Z();
+        }
+    }
+
+    protected void func_174808_Z()
+    {
+        int var1 = MathHelper.floor_double(this.posX);
+        int var2 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
+        int var3 = MathHelper.floor_double(this.posZ);
+        BlockPos var4 = new BlockPos(var1, var2, var3);
+        IBlockState var5 = this.worldObj.getBlockState(var4);
+        Block var6 = var5.getBlock();
+
+        if (var6.getRenderType() != -1)
+        {
+            this.worldObj.spawnParticle(EnumParticleTypes.BLOCK_CRACK, this.posX + ((double)this.rand.nextFloat() - 0.5D) * (double)this.width, this.getEntityBoundingBox().minY + 0.1D, this.posZ + ((double)this.rand.nextFloat() - 0.5D) * (double)this.width, -this.motionX * 4.0D, 1.5D, -this.motionZ * 4.0D, new int[] {Block.getStateId(var5)});
+        }
+    }
+
+    protected String getSplashSound()
+    {
+        return "game.neutral.swim.splash";
+    }
+
+    /**
+     * Checks if the current block the entity is within of the specified material type
+     */
+    public boolean isInsideOfMaterial(Material materialIn)
+    {
+        double var2 = this.posY + (double)this.getEyeHeight();
+        BlockPos var4 = new BlockPos(this.posX, var2, this.posZ);
+        IBlockState var5 = this.worldObj.getBlockState(var4);
+        Block var6 = var5.getBlock();
+
+        if (var6.getMaterial() == materialIn)
+        {
+            float var7 = BlockLiquid.getLiquidHeightPercent(var5.getBlock().getMetaFromState(var5)) - 0.11111111F;
+            float var8 = (float)(var4.getY() + 1) - var7;
+            boolean var9 = var2 < (double)var8;
+            return !var9 && this instanceof EntityPlayer ? false : var9;
+        }
+        else
+        {
+            return false;
+        }
+    }
+
+    public boolean func_180799_ab()
+    {
+        return this.worldObj.isMaterialInBB(this.getEntityBoundingBox().expand(-0.10000000149011612D, -0.4000000059604645D, -0.10000000149011612D), Material.lava);
+    }
+
+    /**
+     * Used in both water and by flying objects
+     */
+    public void moveFlying(float strafe, float forward, float friction)
+    {
+        float var4 = strafe * strafe + forward * forward;
+
+        if (var4 >= 1.0E-4F)
+        {
+            var4 = MathHelper.sqrt_float(var4);
+
+            if (var4 < 1.0F)
+            {
+                var4 = 1.0F;
+            }
+
+            var4 = friction / var4;
+            strafe *= var4;
+            forward *= var4;
+            float var5 = MathHelper.sin(this.rotationYaw * (float)Math.PI / 180.0F);
+            float var6 = MathHelper.cos(this.rotationYaw * (float)Math.PI / 180.0F);
+            this.motionX += (double)(strafe * var6 - forward * var5);
+            this.motionZ += (double)(forward * var6 + strafe * var5);
+        }
+    }
+
+    public int getBrightnessForRender(float p_70070_1_)
+    {
+        BlockPos var2 = new BlockPos(this.posX, 0.0D, this.posZ);
+
+        if (this.worldObj.isBlockLoaded(var2))
+        {
+            double var3 = (this.getEntityBoundingBox().maxY - this.getEntityBoundingBox().minY) * 0.66D;
+            int var5 = MathHelper.floor_double(this.posY + var3);
+            return this.worldObj.getCombinedLight(var2.offsetUp(var5), 0);
+        }
+        else
+        {
+            return 0;
+        }
+    }
+
+    /**
+     * Gets how bright this entity is.
+     */
+    public float getBrightness(float p_70013_1_)
+    {
+        BlockPos var2 = new BlockPos(this.posX, 0.0D, this.posZ);
+
+        if (this.worldObj.isBlockLoaded(var2))
+        {
+            double var3 = (this.getEntityBoundingBox().maxY - this.getEntityBoundingBox().minY) * 0.66D;
+            int var5 = MathHelper.floor_double(this.posY + var3);
+            return this.worldObj.getLightBrightness(var2.offsetUp(var5));
+        }
+        else
+        {
+            return 0.0F;
+        }
+    }
+
+    /**
+     * Sets the reference to the World object.
+     */
+    public void setWorld(World worldIn)
+    {
+        this.worldObj = worldIn;
+    }
+
+    /**
+     * Sets the entity's position and rotation.
+     */
+    public void setPositionAndRotation(double x, double y, double z, float yaw, float pitch)
+    {
+        this.prevPosX = this.posX = x;
+        this.prevPosY = this.posY = y;
+        this.prevPosZ = this.posZ = z;
+        this.prevRotationYaw = this.rotationYaw = yaw;
+        this.prevRotationPitch = this.rotationPitch = pitch;
+        double var9 = (double)(this.prevRotationYaw - yaw);
+
+        if (var9 < -180.0D)
+        {
+            this.prevRotationYaw += 360.0F;
+        }
+
+        if (var9 >= 180.0D)
+        {
+            this.prevRotationYaw -= 360.0F;
+        }
+
+        this.setPosition(this.posX, this.posY, this.posZ);
+        this.setRotation(yaw, pitch);
+    }
+
+    public void func_174828_a(BlockPos p_174828_1_, float p_174828_2_, float p_174828_3_)
+    {
+        this.setLocationAndAngles((double)p_174828_1_.getX() + 0.5D, (double)p_174828_1_.getY(), (double)p_174828_1_.getZ() + 0.5D, p_174828_2_, p_174828_3_);
+    }
+
+    /**
+     * Sets the location and Yaw/Pitch of an entity in the world
+     */
+    public void setLocationAndAngles(double x, double y, double z, float yaw, float pitch)
+    {
+        this.lastTickPosX = this.prevPosX = this.posX = x;
+        this.lastTickPosY = this.prevPosY = this.posY = y;
+        this.lastTickPosZ = this.prevPosZ = this.posZ = z;
+        this.rotationYaw = yaw;
+        this.rotationPitch = pitch;
+        this.setPosition(this.posX, this.posY, this.posZ);
+    }
+
+    /**
+     * Returns the distance to the entity. Args: entity
+     */
+    public float getDistanceToEntity(Entity entityIn)
+    {
+        float var2 = (float)(this.posX - entityIn.posX);
+        float var3 = (float)(this.posY - entityIn.posY);
+        float var4 = (float)(this.posZ - entityIn.posZ);
+        return MathHelper.sqrt_float(var2 * var2 + var3 * var3 + var4 * var4);
+    }
+
+    /**
+     * Gets the squared distance to the position. Args: x, y, z
+     */
+    public double getDistanceSq(double x, double y, double z)
+    {
+        double var7 = this.posX - x;
+        double var9 = this.posY - y;
+        double var11 = this.posZ - z;
+        return var7 * var7 + var9 * var9 + var11 * var11;
+    }
+
+    public double getDistanceSq(BlockPos p_174818_1_)
+    {
+        return p_174818_1_.distanceSq(this.posX, this.posY, this.posZ);
+    }
+
+    public double func_174831_c(BlockPos p_174831_1_)
+    {
+        return p_174831_1_.distanceSqToCenter(this.posX, this.posY, this.posZ);
+    }
+
+    /**
+     * Gets the distance to the position. Args: x, y, z
+     */
+    public double getDistance(double x, double y, double z)
+    {
+        double var7 = this.posX - x;
+        double var9 = this.posY - y;
+        double var11 = this.posZ - z;
+        return (double)MathHelper.sqrt_double(var7 * var7 + var9 * var9 + var11 * var11);
+    }
+
+    /**
+     * Returns the squared distance to the entity. Args: entity
+     */
+    public double getDistanceSqToEntity(Entity entityIn)
+    {
+        double var2 = this.posX - entityIn.posX;
+        double var4 = this.posY - entityIn.posY;
+        double var6 = this.posZ - entityIn.posZ;
+        return var2 * var2 + var4 * var4 + var6 * var6;
+    }
+
+    /**
+     * Called by a player entity when they collide with an entity
+     */
+    public void onCollideWithPlayer(EntityPlayer entityIn) {}
+
+    /**
+     * Applies a velocity to each of the entities pushing them away from each other. Args: entity
+     */
+    public void applyEntityCollision(Entity entityIn)
+    {
+        if (entityIn.riddenByEntity != this && entityIn.ridingEntity != this)
+        {
+            if (!entityIn.noClip && !this.noClip)
+            {
+                double var2 = entityIn.posX - this.posX;
+                double var4 = entityIn.posZ - this.posZ;
+                double var6 = MathHelper.abs_max(var2, var4);
+
+                if (var6 >= 0.009999999776482582D)
+                {
+                    var6 = (double)MathHelper.sqrt_double(var6);
+                    var2 /= var6;
+                    var4 /= var6;
+                    double var8 = 1.0D / var6;
+
+                    if (var8 > 1.0D)
+                    {
+                        var8 = 1.0D;
+                    }
+
+                    var2 *= var8;
+                    var4 *= var8;
+                    var2 *= 0.05000000074505806D;
+                    var4 *= 0.05000000074505806D;
+                    var2 *= (double)(1.0F - this.entityCollisionReduction);
+                    var4 *= (double)(1.0F - this.entityCollisionReduction);
+
+                    if (this.riddenByEntity == null)
+                    {
+                        this.addVelocity(-var2, 0.0D, -var4);
+                    }
+
+                    if (entityIn.riddenByEntity == null)
+                    {
+                        entityIn.addVelocity(var2, 0.0D, var4);
+                    }
+                }
+            }
+        }
+    }
+
+    /**
+     * Adds to the current velocity of the entity. Args: x, y, z
+     */
+    public void addVelocity(double x, double y, double z)
+    {
+        this.motionX += x;
+        this.motionY += y;
+        this.motionZ += z;
+        this.isAirBorne = true;
+    }
+
+    /**
+     * Sets that this entity has been attacked.
+     */
+    protected void setBeenAttacked()
+    {
+        this.velocityChanged = true;
+    }
+
+    /**
+     * Called when the entity is attacked.
+     */
+    public boolean attackEntityFrom(DamageSource source, float amount)
+    {
+        if (this.func_180431_b(source))
+        {
+            return false;
+        }
+        else
+        {
+            this.setBeenAttacked();
+            return false;
+        }
+    }
+
+    /**
+     * interpolated look vector
+     */
+    public Vec3 getLook(float p_70676_1_)
+    {
+        if (p_70676_1_ == 1.0F)
+        {
+            return this.func_174806_f(this.rotationPitch, this.rotationYaw);
+        }
+        else
+        {
+            float var2 = this.prevRotationPitch + (this.rotationPitch - this.prevRotationPitch) * p_70676_1_;
+            float var3 = this.prevRotationYaw + (this.rotationYaw - this.prevRotationYaw) * p_70676_1_;
+            return this.func_174806_f(var2, var3);
+        }
+    }
+
+    protected final Vec3 func_174806_f(float p_174806_1_, float p_174806_2_)
+    {
+        float var3 = MathHelper.cos(-p_174806_2_ * 0.017453292F - (float)Math.PI);
+        float var4 = MathHelper.sin(-p_174806_2_ * 0.017453292F - (float)Math.PI);
+        float var5 = -MathHelper.cos(-p_174806_1_ * 0.017453292F);
+        float var6 = MathHelper.sin(-p_174806_1_ * 0.017453292F);
+        return new Vec3((double)(var4 * var5), (double)var6, (double)(var3 * var5));
+    }
+
+    public Vec3 func_174824_e(float p_174824_1_)
+    {
+        if (p_174824_1_ == 1.0F)
+        {
+            return new Vec3(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
+        }
+        else
+        {
+            double var2 = this.prevPosX + (this.posX - this.prevPosX) * (double)p_174824_1_;
+            double var4 = this.prevPosY + (this.posY - this.prevPosY) * (double)p_174824_1_ + (double)this.getEyeHeight();
+            double var6 = this.prevPosZ + (this.posZ - this.prevPosZ) * (double)p_174824_1_;
+            return new Vec3(var2, var4, var6);
+        }
+    }
+
+    public MovingObjectPosition func_174822_a(double p_174822_1_, float p_174822_3_)
+    {
+        Vec3 var4 = this.func_174824_e(p_174822_3_);
+        Vec3 var5 = this.getLook(p_174822_3_);
+        Vec3 var6 = var4.addVector(var5.xCoord * p_174822_1_, var5.yCoord * p_174822_1_, var5.zCoord * p_174822_1_);
+        return this.worldObj.rayTraceBlocks(var4, var6, false, false, true);
+    }
+
+    /**
+     * Returns true if other Entities should be prevented from moving through this Entity.
+     */
+    public boolean canBeCollidedWith()
+    {
+        return false;
+    }
+
+    /**
+     * Returns true if this entity should push and be pushed by other entities when colliding.
+     */
+    public boolean canBePushed()
+    {
+        return false;
+    }
+
+    /**
+     * Adds a value to the player score. Currently not actually used and the entity passed in does nothing. Args:
+     * entity, scoreToAdd
+     */
+    public void addToPlayerScore(Entity entityIn, int amount) {}
+
+    public boolean isInRangeToRender3d(double x, double y, double z)
+    {
+        double var7 = this.posX - x;
+        double var9 = this.posY - y;
+        double var11 = this.posZ - z;
+        double var13 = var7 * var7 + var9 * var9 + var11 * var11;
+        return this.isInRangeToRenderDist(var13);
+    }
+
+    /**
+     * Checks if the entity is in range to render by using the past in distance and comparing it to its average edge
+     * length * 64 * renderDistanceWeight Args: distance
+     */
+    public boolean isInRangeToRenderDist(double distance)
+    {
+        double var3 = this.getEntityBoundingBox().getAverageEdgeLength();
+        var3 *= 64.0D * this.renderDistanceWeight;
+        return distance < var3 * var3;
+    }
+
+    /**
+     * Like writeToNBTOptional but does not check if the entity is ridden. Used for saving ridden entities with their
+     * riders.
+     */
+    public boolean writeMountToNBT(NBTTagCompound tagCompund)
+    {
+        String var2 = this.getEntityString();
+
+        if (!this.isDead && var2 != null)
+        {
+            tagCompund.setString("id", var2);
+            this.writeToNBT(tagCompund);
+            return true;
+        }
+        else
+        {
+            return false;
+        }
+    }
+
+    /**
+     * Either write this entity to the NBT tag given and return true, or return false without doing anything. If this
+     * returns false the entity is not saved on disk. Ridden entities return false here as they are saved with their
+     * rider.
+     */
+    public boolean writeToNBTOptional(NBTTagCompound tagCompund)
+    {
+        String var2 = this.getEntityString();
+
+        if (!this.isDead && var2 != null && this.riddenByEntity == null)
+        {
+            tagCompund.setString("id", var2);
+            this.writeToNBT(tagCompund);
+            return true;
+        }
+        else
+        {
+            return false;
+        }
+    }
+
+    /**
+     * Save the entity to NBT (calls an abstract helper method to write extra data)
+     */
+    public void writeToNBT(NBTTagCompound tagCompund)
+    {
+        try
+        {
+            tagCompund.setTag("Pos", this.newDoubleNBTList(new double[] {this.posX, this.posY, this.posZ}));
+            tagCompund.setTag("Motion", this.newDoubleNBTList(new double[] {this.motionX, this.motionY, this.motionZ}));
+            tagCompund.setTag("Rotation", this.newFloatNBTList(new float[] {this.rotationYaw, this.rotationPitch}));
+            tagCompund.setFloat("FallDistance", this.fallDistance);
+            tagCompund.setShort("Fire", (short)this.fire);
+            tagCompund.setShort("Air", (short)this.getAir());
+            tagCompund.setBoolean("OnGround", this.onGround);
+            tagCompund.setInteger("Dimension", this.dimension);
+            tagCompund.setBoolean("Invulnerable", this.invulnerable);
+            tagCompund.setInteger("PortalCooldown", this.timeUntilPortal);
+            tagCompund.setLong("UUIDMost", this.getUniqueID().getMostSignificantBits());
+            tagCompund.setLong("UUIDLeast", this.getUniqueID().getLeastSignificantBits());
+
+            if (this.getCustomNameTag() != null && this.getCustomNameTag().length() > 0)
+            {
+                tagCompund.setString("CustomName", this.getCustomNameTag());
+                tagCompund.setBoolean("CustomNameVisible", this.getAlwaysRenderNameTag());
+            }
+
+            this.field_174837_as.func_179670_b(tagCompund);
+
+            if (this.isSlient())
+            {
+                tagCompund.setBoolean("Silent", this.isSlient());
+            }
+
+            this.writeEntityToNBT(tagCompund);
+
+            if (this.ridingEntity != null)
+            {
+                NBTTagCompound var2 = new NBTTagCompound();
+
+                if (this.ridingEntity.writeMountToNBT(var2))
+                {
+                    tagCompund.setTag("Riding", var2);
+                }
+            }
+        }
+        catch (Throwable var5)
+        {
+            CrashReport var3 = CrashReport.makeCrashReport(var5, "Saving entity NBT");
+            CrashReportCategory var4 = var3.makeCategory("Entity being saved");
+            this.addEntityCrashInfo(var4);
+            throw new ReportedException(var3);
+        }
+    }
+
+    /**
+     * Reads the entity from NBT (calls an abstract helper method to read specialized data)
+     */
+    public void readFromNBT(NBTTagCompound tagCompund)
+    {
+        try
+        {
+            NBTTagList var2 = tagCompund.getTagList("Pos", 6);
+            NBTTagList var6 = tagCompund.getTagList("Motion", 6);
+            NBTTagList var7 = tagCompund.getTagList("Rotation", 5);
+            this.motionX = var6.getDouble(0);
+            this.motionY = var6.getDouble(1);
+            this.motionZ = var6.getDouble(2);
+
+            if (Math.abs(this.motionX) > 10.0D)
+            {
+                this.motionX = 0.0D;
+            }
+
+            if (Math.abs(this.motionY) > 10.0D)
+            {
+                this.motionY = 0.0D;
+            }
+
+            if (Math.abs(this.motionZ) > 10.0D)
+            {
+                this.motionZ = 0.0D;
+            }
+
+            this.prevPosX = this.lastTickPosX = this.posX = var2.getDouble(0);
+            this.prevPosY = this.lastTickPosY = this.posY = var2.getDouble(1);
+            this.prevPosZ = this.lastTickPosZ = this.posZ = var2.getDouble(2);
+            this.prevRotationYaw = this.rotationYaw = var7.getFloat(0);
+            this.prevRotationPitch = this.rotationPitch = var7.getFloat(1);
+            this.fallDistance = tagCompund.getFloat("FallDistance");
+            this.fire = tagCompund.getShort("Fire");
+            this.setAir(tagCompund.getShort("Air"));
+            this.onGround = tagCompund.getBoolean("OnGround");
+            this.dimension = tagCompund.getInteger("Dimension");
+            this.invulnerable = tagCompund.getBoolean("Invulnerable");
+            this.timeUntilPortal = tagCompund.getInteger("PortalCooldown");
+
+            if (tagCompund.hasKey("UUIDMost", 4) && tagCompund.hasKey("UUIDLeast", 4))
+            {
+                this.entityUniqueID = new UUID(tagCompund.getLong("UUIDMost"), tagCompund.getLong("UUIDLeast"));
+            }
+            else if (tagCompund.hasKey("UUID", 8))
+            {
+                this.entityUniqueID = UUID.fromString(tagCompund.getString("UUID"));
+            }
+
+            this.setPosition(this.posX, this.posY, this.posZ);
+            this.setRotation(this.rotationYaw, this.rotationPitch);
+
+            if (tagCompund.hasKey("CustomName", 8) && tagCompund.getString("CustomName").length() > 0)
+            {
+                this.setCustomNameTag(tagCompund.getString("CustomName"));
+            }
+
+            this.setAlwaysRenderNameTag(tagCompund.getBoolean("CustomNameVisible"));
+            this.field_174837_as.func_179668_a(tagCompund);
+            this.func_174810_b(tagCompund.getBoolean("Silent"));
+            this.readEntityFromNBT(tagCompund);
+
+            if (this.shouldSetPosAfterLoading())
+            {
+                this.setPosition(this.posX, this.posY, this.posZ);
+            }
+        }
+        catch (Throwable var5)
+        {
+            CrashReport var3 = CrashReport.makeCrashReport(var5, "Loading entity NBT");
+            CrashReportCategory var4 = var3.makeCategory("Entity being loaded");
+            this.addEntityCrashInfo(var4);
+            throw new ReportedException(var3);
+        }
+    }
+
+    protected boolean shouldSetPosAfterLoading()
+    {
+        return true;
+    }
+
+    /**
+     * Returns the string that identifies this Entity's class
+     */
+    protected final String getEntityString()
+    {
+        return EntityList.getEntityString(this);
+    }
+
+    /**
+     * (abstract) Protected helper method to read subclass entity data from NBT.
+     */
+    protected abstract void readEntityFromNBT(NBTTagCompound tagCompund);
+
+    /**
+     * (abstract) Protected helper method to write subclass entity data to NBT.
+     */
+    protected abstract void writeEntityToNBT(NBTTagCompound tagCompound);
+
+    public void onChunkLoad() {}
+
+    /**
+     * creates a NBT list from the array of doubles passed to this function
+     */
+    protected NBTTagList newDoubleNBTList(double ... numbers)
+    {
+        NBTTagList var2 = new NBTTagList();
+        double[] var3 = numbers;
+        int var4 = numbers.length;
+
+        for (int var5 = 0; var5 < var4; ++var5)
+        {
+            double var6 = var3[var5];
+            var2.appendTag(new NBTTagDouble(var6));
+        }
+
+        return var2;
+    }
+
+    /**
+     * Returns a new NBTTagList filled with the specified floats
+     */
+    protected NBTTagList newFloatNBTList(float ... numbers)
+    {
+        NBTTagList var2 = new NBTTagList();
+        float[] var3 = numbers;
+        int var4 = numbers.length;
+
+        for (int var5 = 0; var5 < var4; ++var5)
+        {
+            float var6 = var3[var5];
+            var2.appendTag(new NBTTagFloat(var6));
+        }
+
+        return var2;
+    }
+
+    public EntityItem dropItem(Item itemIn, int size)
+    {
+        return this.dropItemWithOffset(itemIn, size, 0.0F);
+    }
+
+    public EntityItem dropItemWithOffset(Item itemIn, int size, float p_145778_3_)
+    {
+        return this.entityDropItem(new ItemStack(itemIn, size, 0), p_145778_3_);
+    }
+
+    /**
+     * Drops an item at the position of the entity.
+     */
+    public EntityItem entityDropItem(ItemStack itemStackIn, float offsetY)
+    {
+        if (itemStackIn.stackSize != 0 && itemStackIn.getItem() != null)
+        {
+            EntityItem var3 = new EntityItem(this.worldObj, this.posX, this.posY + (double)offsetY, this.posZ, itemStackIn);
+            var3.setDefaultPickupDelay();
+            this.worldObj.spawnEntityInWorld(var3);
+            return var3;
+        }
+        else
+        {
+            return null;
+        }
+    }
+
+    /**
+     * Checks whether target entity is alive.
+     */
+    public boolean isEntityAlive()
+    {
+        return !this.isDead;
+    }
+
+    /**
+     * Checks if this entity is inside of an opaque block
+     */
+    public boolean isEntityInsideOpaqueBlock()
+    {
+        if (this.noClip)
+        {
+            return false;
+        }
+        else
+        {
+            for (int var1 = 0; var1 < 8; ++var1)
+            {
+                double var2 = this.posX + (double)(((float)((var1 >> 0) % 2) - 0.5F) * this.width * 0.8F);
+                double var4 = this.posY + (double)(((float)((var1 >> 1) % 2) - 0.5F) * 0.1F);
+                double var6 = this.posZ + (double)(((float)((var1 >> 2) % 2) - 0.5F) * this.width * 0.8F);
+
+                if (this.worldObj.getBlockState(new BlockPos(var2, var4 + (double)this.getEyeHeight(), var6)).getBlock().isVisuallyOpaque())
+                {
+                    return true;
+                }
+            }
+
+            return false;
+        }
+    }
+
+    /**
+     * First layer of player interaction
+     */
+    public boolean interactFirst(EntityPlayer playerIn)
+    {
+        return false;
+    }
+
+    /**
+     * Returns a boundingBox used to collide the entity with other entities and blocks. This enables the entity to be
+     * pushable on contact, like boats or minecarts.
+     */
+    public AxisAlignedBB getCollisionBox(Entity entityIn)
+    {
+        return null;
+    }
+
+    /**
+     * Handles updating while being ridden by an entity
+     */
+    public void updateRidden()
+    {
+        if (this.ridingEntity.isDead)
+        {
+            this.ridingEntity = null;
+        }
+        else
+        {
+            this.motionX = 0.0D;
+            this.motionY = 0.0D;
+            this.motionZ = 0.0D;
+            this.onUpdate();
+
+            if (this.ridingEntity != null)
+            {
+                this.ridingEntity.updateRiderPosition();
+                this.entityRiderYawDelta += (double)(this.ridingEntity.rotationYaw - this.ridingEntity.prevRotationYaw);
+
+                for (this.entityRiderPitchDelta += (double)(this.ridingEntity.rotationPitch - this.ridingEntity.prevRotationPitch); this.entityRiderYawDelta >= 180.0D; this.entityRiderYawDelta -= 360.0D)
+                {
+                    ;
+                }
+
+                while (this.entityRiderYawDelta < -180.0D)
+                {
+                    this.entityRiderYawDelta += 360.0D;
+                }
+
+                while (this.entityRiderPitchDelta >= 180.0D)
+                {
+                    this.entityRiderPitchDelta -= 360.0D;
+                }
+
+                while (this.entityRiderPitchDelta < -180.0D)
+                {
+                    this.entityRiderPitchDelta += 360.0D;
+                }
+
+                double var1 = this.entityRiderYawDelta * 0.5D;
+                double var3 = this.entityRiderPitchDelta * 0.5D;
+                float var5 = 10.0F;
+
+                if (var1 > (double)var5)
+                {
+                    var1 = (double)var5;
+                }
+
+                if (var1 < (double)(-var5))
+                {
+                    var1 = (double)(-var5);
+                }
+
+                if (var3 > (double)var5)
+                {
+                    var3 = (double)var5;
+                }
+
+                if (var3 < (double)(-var5))
+                {
+                    var3 = (double)(-var5);
+                }
+
+                this.entityRiderYawDelta -= var1;
+                this.entityRiderPitchDelta -= var3;
+            }
+        }
+    }
+
+    public void updateRiderPosition()
+    {
+        if (this.riddenByEntity != null)
+        {
+            this.riddenByEntity.setPosition(this.posX, this.posY + this.getMountedYOffset() + this.riddenByEntity.getYOffset(), this.posZ);
+        }
+    }
+
+    /**
+     * Returns the Y Offset of this entity.
+     */
+    public double getYOffset()
+    {
+        return 0.0D;
+    }
+
+    /**
+     * Returns the Y offset from the entity's position for any entity riding this one.
+     */
+    public double getMountedYOffset()
+    {
+        return (double)this.height * 0.75D;
+    }
+
+    /**
+     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
+     */
+    public void mountEntity(Entity entityIn)
+    {
+        this.entityRiderPitchDelta = 0.0D;
+        this.entityRiderYawDelta = 0.0D;
+
+        if (entityIn == null)
+        {
+            if (this.ridingEntity != null)
+            {
+                this.setLocationAndAngles(this.ridingEntity.posX, this.ridingEntity.getEntityBoundingBox().minY + (double)this.ridingEntity.height, this.ridingEntity.posZ, this.rotationYaw, this.rotationPitch);
+                this.ridingEntity.riddenByEntity = null;
+            }
+
+            this.ridingEntity = null;
+        }
+        else
+        {
+            if (this.ridingEntity != null)
+            {
+                this.ridingEntity.riddenByEntity = null;
+            }
+
+            if (entityIn != null)
+            {
+                for (Entity var2 = entityIn.ridingEntity; var2 != null; var2 = var2.ridingEntity)
+                {
+                    if (var2 == this)
+                    {
+                        return;
+                    }
+                }
+            }
+
+            this.ridingEntity = entityIn;
+            entityIn.riddenByEntity = this;
+        }
+    }
+
+    public void func_180426_a(double p_180426_1_, double p_180426_3_, double p_180426_5_, float p_180426_7_, float p_180426_8_, int p_180426_9_, boolean p_180426_10_)
+    {
+        this.setPosition(p_180426_1_, p_180426_3_, p_180426_5_);
+        this.setRotation(p_180426_7_, p_180426_8_);
+        List var11 = this.worldObj.getCollidingBoundingBoxes(this, this.getEntityBoundingBox().contract(0.03125D, 0.0D, 0.03125D));
+
+        if (!var11.isEmpty())
+        {
+            double var12 = 0.0D;
+            Iterator var14 = var11.iterator();
+
+            while (var14.hasNext())
+            {
+                AxisAlignedBB var15 = (AxisAlignedBB)var14.next();
+
+                if (var15.maxY > var12)
+                {
+                    var12 = var15.maxY;
+                }
+            }
+
+            p_180426_3_ += var12 - this.getEntityBoundingBox().minY;
+            this.setPosition(p_180426_1_, p_180426_3_, p_180426_5_);
+        }
+    }
+
+    public float getCollisionBorderSize()
+    {
+        return 0.1F;
+    }
+
+    /**
+     * returns a (normalized) vector of where this entity is looking
+     */
+    public Vec3 getLookVec()
+    {
+        return null;
+    }
+
+    /**
+     * Called by portal blocks when an entity is within it.
+     */
+    public void setInPortal()
+    {
+        if (this.timeUntilPortal > 0)
+        {
+            this.timeUntilPortal = this.getPortalCooldown();
+        }
+        else
+        {
+            double var1 = this.prevPosX - this.posX;
+            double var3 = this.prevPosZ - this.posZ;
+
+            if (!this.worldObj.isRemote && !this.inPortal)
+            {
+                int var5;
+
+                if (MathHelper.abs((float)var1) > MathHelper.abs((float)var3))
+                {
+                    var5 = var1 > 0.0D ? EnumFacing.WEST.getHorizontalIndex() : EnumFacing.EAST.getHorizontalIndex();
+                }
+                else
+                {
+                    var5 = var3 > 0.0D ? EnumFacing.NORTH.getHorizontalIndex() : EnumFacing.SOUTH.getHorizontalIndex();
+                }
+
+                this.teleportDirection = var5;
+            }
+
+            this.inPortal = true;
+        }
+    }
+
+    /**
+     * Return the amount of cooldown before this entity can use a portal again.
+     */
+    public int getPortalCooldown()
+    {
+        return 300;
+    }
+
+    /**
+     * Sets the velocity to the args. Args: x, y, z
+     */
+    public void setVelocity(double x, double y, double z)
+    {
+    	//TODO: Client
+    	if(!WurstClient.INSTANCE.modManager.getModByClass(AntiKnockbackMod.class).isEnabled())
+    	{
+    		this.motionX = x;
+        	this.motionY = y;
+        	this.motionZ = z;
+    	}
+    }
+
+    public void handleHealthUpdate(byte p_70103_1_) {}
+
+    /**
+     * Setups the entity to do the hurt animation. Only used by packets in multiplayer.
+     */
+    public void performHurtAnimation() {}
+
+    /**
+     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
+     */
+    public ItemStack[] getInventory()
+    {
+        return null;
+    }
+
+    /**
+     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
+     */
+    public void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn) {}
+
+    /**
+     * Returns true if the entity is on fire. Used by render to add the fire effect on rendering.
+     */
+    public boolean isBurning()
+    {
+        boolean var1 = this.worldObj != null && this.worldObj.isRemote;
+        return !this.isImmuneToFire && (this.fire > 0 || var1 && this.getFlag(0));
+    }
+
+    /**
+     * Returns true if the entity is riding another entity, used by render to rotate the legs to be in 'sit' position
+     * for players.
+     */
+    public boolean isRiding()
+    {
+        return this.ridingEntity != null;
+    }
+
+    /**
+     * Returns if this entity is sneaking.
+     */
+    public boolean isSneaking()
+    {
+        return this.getFlag(1);
+    }
+
+    /**
+     * Sets the sneaking flag.
+     */
+    public void setSneaking(boolean sneaking)
+    {
+        this.setFlag(1, sneaking);
+    }
+
+    /**
+     * Get if the Entity is sprinting.
+     */
+    public boolean isSprinting()
+    {
+        return this.getFlag(3);
+    }
+
+    /**
+     * Set sprinting switch for Entity.
+     */
+    public void setSprinting(boolean sprinting)
+    {
+        this.setFlag(3, sprinting);
+    }
+
+    public boolean isInvisible()
+    {
+        return this.getFlag(5);
+    }
+
+    /**
+     * Only used by renderer in EntityLivingBase subclasses.
+     * Determines if an entity is visible or not to a specfic player, if the entity is normally invisible.
+     * For EntityLivingBase subclasses, returning false when invisible will render the entity semitransparent.
+     */
+    public boolean isInvisibleToPlayer(EntityPlayer playerIn)
+    {
+        return playerIn.isSpectator() ? false : this.isInvisible();
+    }
+
+    public void setInvisible(boolean invisible)
+    {
+        this.setFlag(5, invisible);
+    }
+
+    public boolean isEating()
+    {
+        return this.getFlag(4);
+    }
+
+    public void setEating(boolean eating)
+    {
+        this.setFlag(4, eating);
+    }
+
+    /**
+     * Returns true if the flag is active for the entity. Known flags: 0) is burning; 1) is sneaking; 2) is riding
+     * something; 3) is sprinting; 4) is eating
+     */
+    protected boolean getFlag(int flag)
+    {
+        return (this.dataWatcher.getWatchableObjectByte(0) & 1 << flag) != 0;
+    }
+
+    /**
+     * Enable or disable a entity flag, see getEntityFlag to read the know flags.
+     */
+    protected void setFlag(int flag, boolean set)
+    {
+        byte var3 = this.dataWatcher.getWatchableObjectByte(0);
+
+        if (set)
+        {
+            this.dataWatcher.updateObject(0, Byte.valueOf((byte)(var3 | 1 << flag)));
+        }
+        else
+        {
+            this.dataWatcher.updateObject(0, Byte.valueOf((byte)(var3 & ~(1 << flag))));
+        }
+    }
+
+    public int getAir()
+    {
+        return this.dataWatcher.getWatchableObjectShort(1);
+    }
+
+    public void setAir(int air)
+    {
+        this.dataWatcher.updateObject(1, Short.valueOf((short)air));
+    }
+
+    /**
+     * Called when a lightning bolt hits the entity.
+     */
+    public void onStruckByLightning(EntityLightningBolt lightningBolt)
+    {
+        this.attackEntityFrom(DamageSource.field_180137_b, 5.0F);
+        ++this.fire;
+
+        if (this.fire == 0)
+        {
+            this.setFire(8);
+        }
+    }
+
+    /**
+     * This method gets called when the entity kills another one.
+     */
+    public void onKillEntity(EntityLivingBase entityLivingIn) {}
+
+    protected boolean pushOutOfBlocks(double x, double y, double z)
+    {
+        BlockPos var7 = new BlockPos(x, y, z);
+        double var8 = x - (double)var7.getX();
+        double var10 = y - (double)var7.getY();
+        double var12 = z - (double)var7.getZ();
+        List var14 = this.worldObj.func_147461_a(this.getEntityBoundingBox());
+
+        if (var14.isEmpty() && !this.worldObj.func_175665_u(var7))
+        {
+            return false;
+        }
+        else
+        {
+            byte var15 = 3;
+            double var16 = 9999.0D;
+
+            if (!this.worldObj.func_175665_u(var7.offsetWest()) && var8 < var16)
+            {
+                var16 = var8;
+                var15 = 0;
+            }
+
+            if (!this.worldObj.func_175665_u(var7.offsetEast()) && 1.0D - var8 < var16)
+            {
+                var16 = 1.0D - var8;
+                var15 = 1;
+            }
+
+            if (!this.worldObj.func_175665_u(var7.offsetUp()) && 1.0D - var10 < var16)
+            {
+                var16 = 1.0D - var10;
+                var15 = 3;
+            }
+
+            if (!this.worldObj.func_175665_u(var7.offsetNorth()) && var12 < var16)
+            {
+                var16 = var12;
+                var15 = 4;
+            }
+
+            if (!this.worldObj.func_175665_u(var7.offsetSouth()) && 1.0D - var12 < var16)
+            {
+                var16 = 1.0D - var12;
+                var15 = 5;
+            }
+
+            float var18 = this.rand.nextFloat() * 0.2F + 0.1F;
+
+            if (var15 == 0)
+            {
+                this.motionX = (double)(-var18);
+            }
+
+            if (var15 == 1)
+            {
+                this.motionX = (double)var18;
+            }
+
+            if (var15 == 3)
+            {
+                this.motionY = (double)var18;
+            }
+
+            if (var15 == 4)
+            {
+                this.motionZ = (double)(-var18);
+            }
+
+            if (var15 == 5)
+            {
+                this.motionZ = (double)var18;
+            }
+
+            return true;
+        }
+    }
+
+    /**
+     * Sets the Entity inside a web block.
+     */
+    public void setInWeb()
+    {
+        this.isInWeb = true;
+        this.fallDistance = 0.0F;
+    }
+
+    /**
+     * Gets the name of this command sender (usually username, but possibly "Rcon")
+     */
+    public String getName()
+    {
+        if (this.hasCustomName())
+        {
+            return this.getCustomNameTag();
+        }
+        else
+        {
+            String var1 = EntityList.getEntityString(this);
+
+            if (var1 == null)
+            {
+                var1 = "generic";
+            }
+
+            return StatCollector.translateToLocal("entity." + var1 + ".name");
+        }
+    }
+
+    /**
+     * Return the Entity parts making up this Entity (currently only for dragons)
+     */
+    public Entity[] getParts()
+    {
+        return null;
+    }
+
+    /**
+     * Returns true if Entity argument is equal to this Entity
+     */
+    public boolean isEntityEqual(Entity entityIn)
+    {
+        return this == entityIn;
+    }
+
+    public float getRotationYawHead()
+    {
+        return 0.0F;
+    }
+
+    /**
+     * Sets the head's yaw rotation of the entity.
+     */
+    public void setRotationYawHead(float rotation) {}
+
+    /**
+     * If returns false, the item will not inflict any damage against entities.
+     */
+    public boolean canAttackWithItem()
+    {
+        return true;
+    }
+
+    /**
+     * Called when a player attacks an entity. If this returns true the attack will not happen.
+     */
+    public boolean hitByEntity(Entity entityIn)
+    {
+        return false;
+    }
+
+    public String toString()
+    {
+        return String.format("%s[\'%s\'/%d, l=\'%s\', x=%.2f, y=%.2f, z=%.2f]", new Object[] {this.getClass().getSimpleName(), this.getName(), Integer.valueOf(this.entityId), this.worldObj == null ? "~NULL~" : this.worldObj.getWorldInfo().getWorldName(), Double.valueOf(this.posX), Double.valueOf(this.posY), Double.valueOf(this.posZ)});
+    }
+
+    public boolean func_180431_b(DamageSource p_180431_1_)
+    {
+        return this.invulnerable && p_180431_1_ != DamageSource.outOfWorld && !p_180431_1_.func_180136_u();
+    }
+
+    /**
+     * Sets this entity's location and angles to the location and angles of the passed in entity.
+     */
+    public void copyLocationAndAnglesFrom(Entity entityIn)
+    {
+        this.setLocationAndAngles(entityIn.posX, entityIn.posY, entityIn.posZ, entityIn.rotationYaw, entityIn.rotationPitch);
+    }
+
+    public void func_180432_n(Entity p_180432_1_)
+    {
+        NBTTagCompound var2 = new NBTTagCompound();
+        p_180432_1_.writeToNBT(var2);
+        this.readFromNBT(var2);
+        this.timeUntilPortal = p_180432_1_.timeUntilPortal;
+        this.teleportDirection = p_180432_1_.teleportDirection;
+    }
+
+    /**
+     * Teleports the entity to another dimension. Params: Dimension number to teleport to
+     */
+    public void travelToDimension(int dimensionId)
+    {
+        if (!this.worldObj.isRemote && !this.isDead)
+        {
+            this.worldObj.theProfiler.startSection("changeDimension");
+            MinecraftServer var2 = MinecraftServer.getServer();
+            int var3 = this.dimension;
+            WorldServer var4 = var2.worldServerForDimension(var3);
+            WorldServer var5 = var2.worldServerForDimension(dimensionId);
+            this.dimension = dimensionId;
+
+            if (var3 == 1 && dimensionId == 1)
+            {
+                var5 = var2.worldServerForDimension(0);
+                this.dimension = 0;
+            }
+
+            this.worldObj.removeEntity(this);
+            this.isDead = false;
+            this.worldObj.theProfiler.startSection("reposition");
+            var2.getConfigurationManager().transferEntityToWorld(this, var3, var4, var5);
+            this.worldObj.theProfiler.endStartSection("reloading");
+            Entity var6 = EntityList.createEntityByName(EntityList.getEntityString(this), var5);
+
+            if (var6 != null)
+            {
+                var6.func_180432_n(this);
+
+                if (var3 == 1 && dimensionId == 1)
+                {
+                    BlockPos var7 = this.worldObj.func_175672_r(var5.getSpawnPoint());
+                    var6.func_174828_a(var7, var6.rotationYaw, var6.rotationPitch);
+                }
+
+                var5.spawnEntityInWorld(var6);
+            }
+
+            this.isDead = true;
+            this.worldObj.theProfiler.endSection();
+            var4.resetUpdateEntityTick();
+            var5.resetUpdateEntityTick();
+            this.worldObj.theProfiler.endSection();
+        }
+    }
+
+    /**
+     * Explosion resistance of a block relative to this entity
+     */
+    public float getExplosionResistance(Explosion p_180428_1_, World worldIn, BlockPos p_180428_3_, IBlockState p_180428_4_)
+    {
+        return p_180428_4_.getBlock().getExplosionResistance(this);
+    }
+
+    public boolean func_174816_a(Explosion p_174816_1_, World worldIn, BlockPos p_174816_3_, IBlockState p_174816_4_, float p_174816_5_)
+    {
+        return true;
+    }
+
+    /**
+     * The maximum height from where the entity is alowed to jump (used in pathfinder)
+     */
+    public int getMaxFallHeight()
+    {
+        return 3;
+    }
+
+    public int getTeleportDirection()
+    {
+        return this.teleportDirection;
+    }
+
+    /**
+     * Return whether this entity should NOT trigger a pressure plate or a tripwire.
+     */
+    public boolean doesEntityNotTriggerPressurePlate()
+    {
+        return false;
+    }
+
+    public void addEntityCrashInfo(CrashReportCategory category)
+    {
+        category.addCrashSectionCallable("Entity Type", new Callable()
+        {
+            private static final String __OBFID = "CL_00001534";
+            public String call()
+            {
+                return EntityList.getEntityString(Entity.this) + " (" + Entity.this.getClass().getCanonicalName() + ")";
+            }
+        });
+        category.addCrashSection("Entity ID", Integer.valueOf(this.entityId));
+        category.addCrashSectionCallable("Entity Name", new Callable()
+        {
+            private static final String __OBFID = "CL_00001535";
+            public String call()
+            {
+                return Entity.this.getName();
+            }
+        });
+        category.addCrashSection("Entity\'s Exact location", String.format("%.2f, %.2f, %.2f", new Object[] {Double.valueOf(this.posX), Double.valueOf(this.posY), Double.valueOf(this.posZ)}));
+        category.addCrashSection("Entity\'s Block location", CrashReportCategory.getCoordinateInfo((double)MathHelper.floor_double(this.posX), (double)MathHelper.floor_double(this.posY), (double)MathHelper.floor_double(this.posZ)));
+        category.addCrashSection("Entity\'s Momentum", String.format("%.2f, %.2f, %.2f", new Object[] {Double.valueOf(this.motionX), Double.valueOf(this.motionY), Double.valueOf(this.motionZ)}));
+        category.addCrashSectionCallable("Entity\'s Rider", new Callable()
+        {
+            private static final String __OBFID = "CL_00002259";
+            public String func_180118_a()
+            {
+                return Entity.this.riddenByEntity.toString();
+            }
+            public Object call()
+            {
+                return this.func_180118_a();
+            }
+        });
+        category.addCrashSectionCallable("Entity\'s Vehicle", new Callable()
+        {
+            private static final String __OBFID = "CL_00002258";
+            public String func_180116_a()
+            {
+                return Entity.this.ridingEntity.toString();
+            }
+            public Object call()
+            {
+                return this.func_180116_a();
+            }
+        });
+    }
+
+    /**
+     * Return whether this entity should be rendered as on fire.
+     */
+    public boolean canRenderOnFire()
+    {
+        return this.isBurning();
+    }
+
+    public UUID getUniqueID()
+    {
+        return this.entityUniqueID;
+    }
+
+    public boolean isPushedByWater()
+    {
+        return true;
+    }
+
+    public IChatComponent getDisplayName()
+    {
+        ChatComponentText var1 = new ChatComponentText(this.getName());
+        var1.getChatStyle().setChatHoverEvent(this.func_174823_aP());
+        var1.getChatStyle().setInsertion(this.getUniqueID().toString());
+        return var1;
+    }
+
+    /**
+     * Sets the custom name tag for this entity
+     */
+    public void setCustomNameTag(String p_96094_1_)
+    {
+        this.dataWatcher.updateObject(2, p_96094_1_);
+    }
+
+    public String getCustomNameTag()
+    {
+        return this.dataWatcher.getWatchableObjectString(2);
+    }
+
+    /**
+     * Returns true if this thing is named
+     */
+    public boolean hasCustomName()
+    {
+        return this.dataWatcher.getWatchableObjectString(2).length() > 0;
+    }
+
+    public void setAlwaysRenderNameTag(boolean p_174805_1_)
+    {
+        this.dataWatcher.updateObject(3, Byte.valueOf((byte)(p_174805_1_ ? 1 : 0)));
+    }
+
+    public boolean getAlwaysRenderNameTag()
+    {
+        return this.dataWatcher.getWatchableObjectByte(3) == 1;
+    }
+
+    /**
+     * Sets the position of the entity and updates the 'last' variables
+     */
+    public void setPositionAndUpdate(double p_70634_1_, double p_70634_3_, double p_70634_5_)
+    {
+        this.setLocationAndAngles(p_70634_1_, p_70634_3_, p_70634_5_, this.rotationYaw, this.rotationPitch);
+    }
+
+    public boolean getAlwaysRenderNameTagForRender()
+    {
+        return this.getAlwaysRenderNameTag();
+    }
+
+    public void func_145781_i(int p_145781_1_) {}
+
+    public EnumFacing func_174811_aO()
+    {
+        return EnumFacing.getHorizontal(MathHelper.floor_double((double)(this.rotationYaw * 4.0F / 360.0F) + 0.5D) & 3);
+    }
+
+    protected HoverEvent func_174823_aP()
+    {
+        NBTTagCompound var1 = new NBTTagCompound();
+        String var2 = EntityList.getEntityString(this);
+        var1.setString("id", this.getUniqueID().toString());
+
+        if (var2 != null)
+        {
+            var1.setString("type", var2);
+        }
+
+        var1.setString("name", this.getName());
+        return new HoverEvent(HoverEvent.Action.SHOW_ENTITY, new ChatComponentText(var1.toString()));
+    }
+
+    public boolean func_174827_a(EntityPlayerMP p_174827_1_)
+    {
+        return true;
+    }
+
+    public AxisAlignedBB getEntityBoundingBox()
+    {
+        return this.boundingBox;
+    }
+
+    public void func_174826_a(AxisAlignedBB p_174826_1_)
+    {
+        this.boundingBox = p_174826_1_;
+    }
+
+    public float getEyeHeight()
+    {
+        return this.height * 0.85F;
+    }
+
+    public boolean isOutsideBorder()
+    {
+        return this.isOutsideBorder;
+    }
+
+    public void setOutsideBorder(boolean p_174821_1_)
+    {
+        this.isOutsideBorder = p_174821_1_;
+    }
+
+    public boolean func_174820_d(int p_174820_1_, ItemStack p_174820_2_)
+    {
+        return false;
+    }
+
+    /**
+     * Notifies this sender of some sort of information.  This is for messages intended to display to the user.  Used
+     * for typical output (like "you asked for whether or not this game rule is set, so here's your answer"), warnings
+     * (like "I fetched this block for you by ID, but I'd like you to know that every time you do this, I die a little
+     * inside"), and errors (like "it's not called iron_pixacke, silly").
+     */
+    public void addChatMessage(IChatComponent message) {}
+
+    /**
+     * Returns true if the command sender is allowed to use the given command.
+     */
+    public boolean canCommandSenderUseCommand(int permissionLevel, String command)
+    {
+        return true;
+    }
+
+    public BlockPos getPosition()
+    {
+        return new BlockPos(this.posX, this.posY + 0.5D, this.posZ);
+    }
+
+    public Vec3 getPositionVector()
+    {
+        return new Vec3(this.posX, this.posY, this.posZ);
+    }
+
+    public World getEntityWorld()
+    {
+        return this.worldObj;
+    }
+
+    public Entity getCommandSenderEntity()
+    {
+        return this;
+    }
+
+    public boolean sendCommandFeedback()
+    {
+        return false;
+    }
+
+    public void func_174794_a(CommandResultStats.Type p_174794_1_, int p_174794_2_)
+    {
+        this.field_174837_as.func_179672_a(this, p_174794_1_, p_174794_2_);
+    }
+
+    public CommandResultStats func_174807_aT()
+    {
+        return this.field_174837_as;
+    }
+
+    public void func_174817_o(Entity p_174817_1_)
+    {
+        this.field_174837_as.func_179671_a(p_174817_1_.func_174807_aT());
+    }
+
+    public NBTTagCompound func_174819_aU()
+    {
+        return null;
+    }
+
+    public void func_174834_g(NBTTagCompound p_174834_1_) {}
+
+    public boolean func_174825_a(EntityPlayer p_174825_1_, Vec3 p_174825_2_)
+    {
+        return false;
+    }
+
+    public boolean func_180427_aV()
+    {
+        return false;
+    }
+
+    protected void func_174815_a(EntityLivingBase p_174815_1_, Entity p_174815_2_)
+    {
+        if (p_174815_2_ instanceof EntityLivingBase)
+        {
+            EnchantmentHelper.func_151384_a((EntityLivingBase)p_174815_2_, p_174815_1_);
+        }
+
+        EnchantmentHelper.func_151385_b(p_174815_1_, p_174815_2_);
+    }
+}
diff --git a/src/net/minecraft/entity/EntityLivingBase.java b/src/net/minecraft/entity/EntityLivingBase.java
index c6f8843..267fb41 100644
--- a/src/net/minecraft/entity/EntityLivingBase.java
+++ b/src/net/minecraft/entity/EntityLivingBase.java
@@ -1,2273 +1,2281 @@
-package net.minecraft.entity;
-
-import com.google.common.collect.Maps;
-import java.util.Collection;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Map;
-import java.util.Random;
-import java.util.UUID;
-import net.minecraft.block.Block;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.enchantment.EnchantmentHelper;
-import net.minecraft.entity.ai.attributes.AttributeModifier;
-import net.minecraft.entity.ai.attributes.BaseAttributeMap;
-import net.minecraft.entity.ai.attributes.IAttribute;
-import net.minecraft.entity.ai.attributes.IAttributeInstance;
-import net.minecraft.entity.ai.attributes.ServersideAttributeMap;
-import net.minecraft.entity.item.EntityItem;
-import net.minecraft.entity.item.EntityXPOrb;
-import net.minecraft.entity.passive.EntityWolf;
-import net.minecraft.entity.player.EntityPlayer;
-import net.minecraft.entity.player.EntityPlayerMP;
-import net.minecraft.entity.projectile.EntityArrow;
-import net.minecraft.init.Blocks;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemArmor;
-import net.minecraft.item.ItemStack;
-import net.minecraft.nbt.NBTBase;
-import net.minecraft.nbt.NBTTagCompound;
-import net.minecraft.nbt.NBTTagFloat;
-import net.minecraft.nbt.NBTTagList;
-import net.minecraft.nbt.NBTTagShort;
-import net.minecraft.network.play.server.S04PacketEntityEquipment;
-import net.minecraft.network.play.server.S0BPacketAnimation;
-import net.minecraft.network.play.server.S0DPacketCollectItem;
-import net.minecraft.potion.Potion;
-import net.minecraft.potion.PotionEffect;
-import net.minecraft.potion.PotionHelper;
-import net.minecraft.scoreboard.Team;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.CombatTracker;
-import net.minecraft.util.DamageSource;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.World;
-import net.minecraft.world.WorldServer;
-
-public abstract class EntityLivingBase extends Entity
-{
-    private static final UUID sprintingSpeedBoostModifierUUID = UUID.fromString("662A6B8D-DA3E-4C1C-8813-96EA6097278D");
-    private static final AttributeModifier sprintingSpeedBoostModifier = (new AttributeModifier(sprintingSpeedBoostModifierUUID, "Sprinting speed boost", 0.30000001192092896D, 2)).setSaved(false);
-    private BaseAttributeMap attributeMap;
-    private final CombatTracker _combatTracker = new CombatTracker(this);
-    private final Map activePotionsMap = Maps.newHashMap();
-
-    /** The equipment this mob was previously wearing, used for syncing. */
-    private final ItemStack[] previousEquipment = new ItemStack[5];
-
-    /** Whether an arm swing is currently in progress. */
-    public boolean isSwingInProgress;
-    public int swingProgressInt;
-    public int arrowHitTimer;
-
-    /**
-     * The amount of time remaining this entity should act 'hurt'. (Visual appearance of red tint)
-     */
-    public int hurtTime;
-
-    /** What the hurt time was max set to last. */
-    public int maxHurtTime;
-
-    /** The yaw at which this entity was last attacked from. */
-    public float attackedAtYaw;
-
-    /**
-     * The amount of time remaining this entity should act 'dead', i.e. have a corpse in the world.
-     */
-    public int deathTime;
-    public float prevSwingProgress;
-    public float swingProgress;
-    public float prevLimbSwingAmount;
-    public float limbSwingAmount;
-
-    /**
-     * Only relevant when limbYaw is not 0(the entity is moving). Influences where in its swing legs and arms currently
-     * are.
-     */
-    public float limbSwing;
-    public int maxHurtResistantTime = 20;
-    public float prevCameraPitch;
-    public float cameraPitch;
-    public float field_70769_ao;
-    public float field_70770_ap;
-    public float renderYawOffset;
-    public float prevRenderYawOffset;
-
-    /** Entity head rotation yaw */
-    public float rotationYawHead;
-
-    /** Entity head rotation yaw at previous tick */
-    public float prevRotationYawHead;
-
-    /**
-     * A factor used to determine how far this entity will move each tick if it is jumping or falling.
-     */
-    public float jumpMovementFactor = 0.02F;
-
-    /** The most recent player that has attacked this entity */
-    protected EntityPlayer attackingPlayer;
-
-    /**
-     * Set to 60 when hit by the player or the player's wolf, then decrements. Used to determine whether the entity
-     * should drop items on death.
-     */
-    protected int recentlyHit;
-
-    /**
-     * This gets set on entity death, but never used. Looks like a duplicate of isDead
-     */
-    protected boolean dead;
-
-    /** The age of this EntityLiving (used to determine when it dies) */
-    protected int entityAge;
-    protected float field_70768_au;
-    protected float field_110154_aX;
-    protected float field_70764_aw;
-    protected float field_70763_ax;
-    protected float field_70741_aB;
-
-    /** The score value of the Mob, the amount of points the mob is worth. */
-    protected int scoreValue;
-
-    /**
-     * Damage taken in the last hit. Mobs are resistant to damage less than this for a short time after taking damage.
-     */
-    protected float lastDamage;
-
-    /** used to check whether entity is jumping. */
-    protected boolean isJumping;
-    public float moveStrafing;
-    public float moveForward;
-    protected float randomYawVelocity;
-
-    /**
-     * The number of updates over which the new position and rotation are to be applied to the entity.
-     */
-    protected int newPosRotationIncrements;
-
-    /** The new X position to be applied to the entity. */
-    protected double newPosX;
-
-    /** The new Y position to be applied to the entity. */
-    protected double newPosY;
-    protected double newPosZ;
-
-    /** The new yaw rotation to be applied to the entity. */
-    protected double newRotationYaw;
-
-    /** The new yaw rotation to be applied to the entity. */
-    protected double newRotationPitch;
-
-    /** Whether the DataWatcher needs to be updated with the active potions */
-    private boolean potionsNeedUpdate = true;
-
-    /** is only being set, has no uses as of MC 1.1 */
-    private EntityLivingBase entityLivingToAttack;
-    private int revengeTimer;
-    private EntityLivingBase lastAttacker;
-
-    /** Holds the value of ticksExisted when setLastAttacker was last called. */
-    private int lastAttackerTime;
-
-    /**
-     * A factor used to determine how far this entity will move each tick if it is walking on land. Adjusted by speed,
-     * and slipperiness of the current block.
-     */
-    private float landMovementFactor;
-
-    /** Number of ticks since last jump */
-    private int jumpTicks;
-    private float field_110151_bq;
-    private static final String __OBFID = "CL_00001549";
-
-    public void func_174812_G()
-    {
-        this.attackEntityFrom(DamageSource.outOfWorld, Float.MAX_VALUE);
-    }
-
-    public EntityLivingBase(World worldIn)
-    {
-        super(worldIn);
-        this.applyEntityAttributes();
-        this.setHealth(this.getMaxHealth());
-        this.preventEntitySpawning = true;
-        this.field_70770_ap = (float)((Math.random() + 1.0D) * 0.009999999776482582D);
-        this.setPosition(this.posX, this.posY, this.posZ);
-        this.field_70769_ao = (float)Math.random() * 12398.0F;
-        this.rotationYaw = (float)(Math.random() * Math.PI * 2.0D);
-        this.rotationYawHead = this.rotationYaw;
-        this.stepHeight = 0.6F;
-    }
-
-    protected void entityInit()
-    {
-        this.dataWatcher.addObject(7, Integer.valueOf(0));
-        this.dataWatcher.addObject(8, Byte.valueOf((byte)0));
-        this.dataWatcher.addObject(9, Byte.valueOf((byte)0));
-        this.dataWatcher.addObject(6, Float.valueOf(1.0F));
-    }
-
-    protected void applyEntityAttributes()
-    {
-        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.maxHealth);
-        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.knockbackResistance);
-        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.movementSpeed);
-    }
-
-    protected void func_180433_a(double p_180433_1_, boolean p_180433_3_, Block p_180433_4_, BlockPos p_180433_5_)
-    {
-        if (!this.isInWater())
-        {
-            this.handleWaterMovement();
-        }
-
-        if (!this.worldObj.isRemote && this.fallDistance > 3.0F && p_180433_3_)
-        {
-            IBlockState var6 = this.worldObj.getBlockState(p_180433_5_);
-            Block var7 = var6.getBlock();
-            float var8 = (float)MathHelper.ceiling_float_int(this.fallDistance - 3.0F);
-
-            if (var7.getMaterial() != Material.air)
-            {
-                double var9 = (double)Math.min(0.2F + var8 / 15.0F, 10.0F);
-
-                if (var9 > 2.5D)
-                {
-                    var9 = 2.5D;
-                }
-
-                int var11 = (int)(150.0D * var9);
-                ((WorldServer)this.worldObj).func_175739_a(EnumParticleTypes.BLOCK_DUST, this.posX, this.posY, this.posZ, var11, 0.0D, 0.0D, 0.0D, 0.15000000596046448D, new int[] {Block.getStateId(var6)});
-            }
-        }
-
-        super.func_180433_a(p_180433_1_, p_180433_3_, p_180433_4_, p_180433_5_);
-    }
-
-    public boolean canBreatheUnderwater()
-    {
-        return false;
-    }
-
-    /**
-     * Gets called every tick from main Entity class
-     */
-    public void onEntityUpdate()
-    {
-        this.prevSwingProgress = this.swingProgress;
-        super.onEntityUpdate();
-        this.worldObj.theProfiler.startSection("livingEntityBaseTick");
-        boolean var1 = this instanceof EntityPlayer;
-
-        if (this.isEntityAlive())
-        {
-            if (this.isEntityInsideOpaqueBlock())
-            {
-                this.attackEntityFrom(DamageSource.inWall, 1.0F);
-            }
-            else if (var1 && !this.worldObj.getWorldBorder().contains(this.getEntityBoundingBox()))
-            {
-                double var2 = this.worldObj.getWorldBorder().getClosestDistance(this) + this.worldObj.getWorldBorder().getDamageBuffer();
-
-                if (var2 < 0.0D)
-                {
-                    this.attackEntityFrom(DamageSource.inWall, (float)Math.max(1, MathHelper.floor_double(-var2 * this.worldObj.getWorldBorder().func_177727_n())));
-                }
-            }
-        }
-
-        if (this.isImmuneToFire() || this.worldObj.isRemote)
-        {
-            this.extinguish();
-        }
-
-        boolean var7 = var1 && ((EntityPlayer)this).capabilities.disableDamage;
-
-        if (this.isEntityAlive() && this.isInsideOfMaterial(Material.water))
-        {
-            if (!this.canBreatheUnderwater() && !this.isPotionActive(Potion.waterBreathing.id) && !var7)
-            {
-                this.setAir(this.decreaseAirSupply(this.getAir()));
-
-                if (this.getAir() == -20)
-                {
-                    this.setAir(0);
-
-                    for (int var3 = 0; var3 < 8; ++var3)
-                    {
-                        float var4 = this.rand.nextFloat() - this.rand.nextFloat();
-                        float var5 = this.rand.nextFloat() - this.rand.nextFloat();
-                        float var6 = this.rand.nextFloat() - this.rand.nextFloat();
-                        this.worldObj.spawnParticle(EnumParticleTypes.WATER_BUBBLE, this.posX + (double)var4, this.posY + (double)var5, this.posZ + (double)var6, this.motionX, this.motionY, this.motionZ, new int[0]);
-                    }
-
-                    this.attackEntityFrom(DamageSource.drown, 2.0F);
-                }
-            }
-
-            if (!this.worldObj.isRemote && this.isRiding() && this.ridingEntity instanceof EntityLivingBase)
-            {
-                this.mountEntity((Entity)null);
-            }
-        }
-        else
-        {
-            this.setAir(300);
-        }
-
-        if (this.isEntityAlive() && this.isWet())
-        {
-            this.extinguish();
-        }
-
-        this.prevCameraPitch = this.cameraPitch;
-
-        if (this.hurtTime > 0)
-        {
-            --this.hurtTime;
-        }
-
-        if (this.hurtResistantTime > 0 && !(this instanceof EntityPlayerMP))
-        {
-            --this.hurtResistantTime;
-        }
-
-        if (this.getHealth() <= 0.0F)
-        {
-            this.onDeathUpdate();
-        }
-
-        if (this.recentlyHit > 0)
-        {
-            --this.recentlyHit;
-        }
-        else
-        {
-            this.attackingPlayer = null;
-        }
-
-        if (this.lastAttacker != null && !this.lastAttacker.isEntityAlive())
-        {
-            this.lastAttacker = null;
-        }
-
-        if (this.entityLivingToAttack != null)
-        {
-            if (!this.entityLivingToAttack.isEntityAlive())
-            {
-                this.setRevengeTarget((EntityLivingBase)null);
-            }
-            else if (this.ticksExisted - this.revengeTimer > 100)
-            {
-                this.setRevengeTarget((EntityLivingBase)null);
-            }
-        }
-
-        this.updatePotionEffects();
-        this.field_70763_ax = this.field_70764_aw;
-        this.prevRenderYawOffset = this.renderYawOffset;
-        this.prevRotationYawHead = this.rotationYawHead;
-        this.prevRotationYaw = this.rotationYaw;
-        this.prevRotationPitch = this.rotationPitch;
-        this.worldObj.theProfiler.endSection();
-    }
-
-    /**
-     * If Animal, checks if the age timer is negative
-     */
-    public boolean isChild()
-    {
-        return false;
-    }
-
-    /**
-     * handles entity death timer, experience orb and particle creation
-     */
-    protected void onDeathUpdate()
-    {
-        ++this.deathTime;
-
-        if (this.deathTime == 20)
-        {
-            int var1;
-
-            if (!this.worldObj.isRemote && (this.recentlyHit > 0 || this.isPlayer()) && this.func_146066_aG() && this.worldObj.getGameRules().getGameRuleBooleanValue("doMobLoot"))
-            {
-                var1 = this.getExperiencePoints(this.attackingPlayer);
-
-                while (var1 > 0)
-                {
-                    int var2 = EntityXPOrb.getXPSplit(var1);
-                    var1 -= var2;
-                    this.worldObj.spawnEntityInWorld(new EntityXPOrb(this.worldObj, this.posX, this.posY, this.posZ, var2));
-                }
-            }
-
-            this.setDead();
-
-            for (var1 = 0; var1 < 20; ++var1)
-            {
-                double var8 = this.rand.nextGaussian() * 0.02D;
-                double var4 = this.rand.nextGaussian() * 0.02D;
-                double var6 = this.rand.nextGaussian() * 0.02D;
-                this.worldObj.spawnParticle(EnumParticleTypes.EXPLOSION_NORMAL, this.posX + (double)(this.rand.nextFloat() * this.width * 2.0F) - (double)this.width, this.posY + (double)(this.rand.nextFloat() * this.height), this.posZ + (double)(this.rand.nextFloat() * this.width * 2.0F) - (double)this.width, var8, var4, var6, new int[0]);
-            }
-        }
-    }
-
-    protected boolean func_146066_aG()
-    {
-        return !this.isChild();
-    }
-
-    /**
-     * Decrements the entity's air supply when underwater
-     */
-    protected int decreaseAirSupply(int p_70682_1_)
-    {
-        int var2 = EnchantmentHelper.func_180319_a(this);
-        return var2 > 0 && this.rand.nextInt(var2 + 1) > 0 ? p_70682_1_ : p_70682_1_ - 1;
-    }
-
-    /**
-     * Get the experience points the entity currently has.
-     */
-    protected int getExperiencePoints(EntityPlayer p_70693_1_)
-    {
-        return 0;
-    }
-
-    /**
-     * Only use is to identify if class is an instance of player for experience dropping
-     */
-    protected boolean isPlayer()
-    {
-        return false;
-    }
-
-    public Random getRNG()
-    {
-        return this.rand;
-    }
-
-    public EntityLivingBase getAITarget()
-    {
-        return this.entityLivingToAttack;
-    }
-
-    public int getRevengeTimer()
-    {
-        return this.revengeTimer;
-    }
-
-    public void setRevengeTarget(EntityLivingBase p_70604_1_)
-    {
-        this.entityLivingToAttack = p_70604_1_;
-        this.revengeTimer = this.ticksExisted;
-    }
-
-    public EntityLivingBase getLastAttacker()
-    {
-        return this.lastAttacker;
-    }
-
-    public int getLastAttackerTime()
-    {
-        return this.lastAttackerTime;
-    }
-
-    public void setLastAttacker(Entity p_130011_1_)
-    {
-        if (p_130011_1_ instanceof EntityLivingBase)
-        {
-            this.lastAttacker = (EntityLivingBase)p_130011_1_;
-        }
-        else
-        {
-            this.lastAttacker = null;
-        }
-
-        this.lastAttackerTime = this.ticksExisted;
-    }
-
-    public int getAge()
-    {
-        return this.entityAge;
-    }
-
-    /**
-     * (abstract) Protected helper method to write subclass entity data to NBT.
-     */
-    public void writeEntityToNBT(NBTTagCompound tagCompound)
-    {
-        tagCompound.setFloat("HealF", this.getHealth());
-        tagCompound.setShort("Health", (short)((int)Math.ceil((double)this.getHealth())));
-        tagCompound.setShort("HurtTime", (short)this.hurtTime);
-        tagCompound.setInteger("HurtByTimestamp", this.revengeTimer);
-        tagCompound.setShort("DeathTime", (short)this.deathTime);
-        tagCompound.setFloat("AbsorptionAmount", this.getAbsorptionAmount());
-        ItemStack[] var2 = this.getInventory();
-        int var3 = var2.length;
-        int var4;
-        ItemStack var5;
-
-        for (var4 = 0; var4 < var3; ++var4)
-        {
-            var5 = var2[var4];
-
-            if (var5 != null)
-            {
-                this.attributeMap.removeAttributeModifiers(var5.getAttributeModifiers());
-            }
-        }
-
-        tagCompound.setTag("Attributes", SharedMonsterAttributes.writeBaseAttributeMapToNBT(this.getAttributeMap()));
-        var2 = this.getInventory();
-        var3 = var2.length;
-
-        for (var4 = 0; var4 < var3; ++var4)
-        {
-            var5 = var2[var4];
-
-            if (var5 != null)
-            {
-                this.attributeMap.applyAttributeModifiers(var5.getAttributeModifiers());
-            }
-        }
-
-        if (!this.activePotionsMap.isEmpty())
-        {
-            NBTTagList var6 = new NBTTagList();
-            Iterator var7 = this.activePotionsMap.values().iterator();
-
-            while (var7.hasNext())
-            {
-                PotionEffect var8 = (PotionEffect)var7.next();
-                var6.appendTag(var8.writeCustomPotionEffectToNBT(new NBTTagCompound()));
-            }
-
-            tagCompound.setTag("ActiveEffects", var6);
-        }
-    }
-
-    /**
-     * (abstract) Protected helper method to read subclass entity data from NBT.
-     */
-    public void readEntityFromNBT(NBTTagCompound tagCompund)
-    {
-        this.setAbsorptionAmount(tagCompund.getFloat("AbsorptionAmount"));
-
-        if (tagCompund.hasKey("Attributes", 9) && this.worldObj != null && !this.worldObj.isRemote)
-        {
-            SharedMonsterAttributes.func_151475_a(this.getAttributeMap(), tagCompund.getTagList("Attributes", 10));
-        }
-
-        if (tagCompund.hasKey("ActiveEffects", 9))
-        {
-            NBTTagList var2 = tagCompund.getTagList("ActiveEffects", 10);
-
-            for (int var3 = 0; var3 < var2.tagCount(); ++var3)
-            {
-                NBTTagCompound var4 = var2.getCompoundTagAt(var3);
-                PotionEffect var5 = PotionEffect.readCustomPotionEffectFromNBT(var4);
-
-                if (var5 != null)
-                {
-                    this.activePotionsMap.put(Integer.valueOf(var5.getPotionID()), var5);
-                }
-            }
-        }
-
-        if (tagCompund.hasKey("HealF", 99))
-        {
-            this.setHealth(tagCompund.getFloat("HealF"));
-        }
-        else
-        {
-            NBTBase var6 = tagCompund.getTag("Health");
-
-            if (var6 == null)
-            {
-                this.setHealth(this.getMaxHealth());
-            }
-            else if (var6.getId() == 5)
-            {
-                this.setHealth(((NBTTagFloat)var6).getFloat());
-            }
-            else if (var6.getId() == 2)
-            {
-                this.setHealth((float)((NBTTagShort)var6).getShort());
-            }
-        }
-
-        this.hurtTime = tagCompund.getShort("HurtTime");
-        this.deathTime = tagCompund.getShort("DeathTime");
-        this.revengeTimer = tagCompund.getInteger("HurtByTimestamp");
-    }
-
-    protected void updatePotionEffects()
-    {
-        Iterator var1 = this.activePotionsMap.keySet().iterator();
-
-        while (var1.hasNext())
-        {
-            Integer var2 = (Integer)var1.next();
-            PotionEffect var3 = (PotionEffect)this.activePotionsMap.get(var2);
-
-            if (!var3.onUpdate(this))
-            {
-                if (!this.worldObj.isRemote)
-                {
-                    var1.remove();
-                    this.onFinishedPotionEffect(var3);
-                }
-            }
-            else if (var3.getDuration() % 600 == 0)
-            {
-                this.onChangedPotionEffect(var3, false);
-            }
-        }
-
-        if (this.potionsNeedUpdate)
-        {
-            if (!this.worldObj.isRemote)
-            {
-                this.func_175135_B();
-            }
-
-            this.potionsNeedUpdate = false;
-        }
-
-        int var11 = this.dataWatcher.getWatchableObjectInt(7);
-        boolean var12 = this.dataWatcher.getWatchableObjectByte(8) > 0;
-
-        if (var11 > 0)
-        {
-            boolean var4 = false;
-
-            if (!this.isInvisible())
-            {
-                var4 = this.rand.nextBoolean();
-            }
-            else
-            {
-                var4 = this.rand.nextInt(15) == 0;
-            }
-
-            if (var12)
-            {
-                var4 &= this.rand.nextInt(5) == 0;
-            }
-
-            if (var4 && var11 > 0)
-            {
-                double var5 = (double)(var11 >> 16 & 255) / 255.0D;
-                double var7 = (double)(var11 >> 8 & 255) / 255.0D;
-                double var9 = (double)(var11 >> 0 & 255) / 255.0D;
-                this.worldObj.spawnParticle(var12 ? EnumParticleTypes.SPELL_MOB_AMBIENT : EnumParticleTypes.SPELL_MOB, this.posX + (this.rand.nextDouble() - 0.5D) * (double)this.width, this.posY + this.rand.nextDouble() * (double)this.height, this.posZ + (this.rand.nextDouble() - 0.5D) * (double)this.width, var5, var7, var9, new int[0]);
-            }
-        }
-    }
-
-    protected void func_175135_B()
-    {
-        if (this.activePotionsMap.isEmpty())
-        {
-            this.func_175133_bi();
-            this.setInvisible(false);
-        }
-        else
-        {
-            int var1 = PotionHelper.calcPotionLiquidColor(this.activePotionsMap.values());
-            this.dataWatcher.updateObject(8, Byte.valueOf((byte)(PotionHelper.func_82817_b(this.activePotionsMap.values()) ? 1 : 0)));
-            this.dataWatcher.updateObject(7, Integer.valueOf(var1));
-            this.setInvisible(this.isPotionActive(Potion.invisibility.id));
-        }
-    }
-
-    protected void func_175133_bi()
-    {
-        this.dataWatcher.updateObject(8, Byte.valueOf((byte)0));
-        this.dataWatcher.updateObject(7, Integer.valueOf(0));
-    }
-
-    public void clearActivePotions()
-    {
-        Iterator var1 = this.activePotionsMap.keySet().iterator();
-
-        while (var1.hasNext())
-        {
-            Integer var2 = (Integer)var1.next();
-            PotionEffect var3 = (PotionEffect)this.activePotionsMap.get(var2);
-
-            if (!this.worldObj.isRemote)
-            {
-                var1.remove();
-                this.onFinishedPotionEffect(var3);
-            }
-        }
-    }
-
-    public Collection getActivePotionEffects()
-    {
-        return this.activePotionsMap.values();
-    }
-
-    public boolean isPotionActive(int p_82165_1_)
-    {
-        return this.activePotionsMap.containsKey(Integer.valueOf(p_82165_1_));
-    }
-
-    public boolean isPotionActive(Potion p_70644_1_)
-    {
-        return this.activePotionsMap.containsKey(Integer.valueOf(p_70644_1_.id));
-    }
-
-    /**
-     * returns the PotionEffect for the supplied Potion if it is active, null otherwise.
-     */
-    public PotionEffect getActivePotionEffect(Potion p_70660_1_)
-    {
-        return (PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70660_1_.id));
-    }
-
-    /**
-     * adds a PotionEffect to the entity
-     */
-    public void addPotionEffect(PotionEffect p_70690_1_)
-    {
-        if (this.isPotionApplicable(p_70690_1_))
-        {
-            if (this.activePotionsMap.containsKey(Integer.valueOf(p_70690_1_.getPotionID())))
-            {
-                ((PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70690_1_.getPotionID()))).combine(p_70690_1_);
-                this.onChangedPotionEffect((PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70690_1_.getPotionID())), true);
-            }
-            else
-            {
-                this.activePotionsMap.put(Integer.valueOf(p_70690_1_.getPotionID()), p_70690_1_);
-                this.onNewPotionEffect(p_70690_1_);
-            }
-        }
-    }
-
-    public boolean isPotionApplicable(PotionEffect p_70687_1_)
-    {
-        if (this.getCreatureAttribute() == EnumCreatureAttribute.UNDEAD)
-        {
-            int var2 = p_70687_1_.getPotionID();
-
-            if (var2 == Potion.regeneration.id || var2 == Potion.poison.id)
-            {
-                return false;
-            }
-        }
-
-        return true;
-    }
-
-    /**
-     * Returns true if this entity is undead.
-     */
-    public boolean isEntityUndead()
-    {
-        return this.getCreatureAttribute() == EnumCreatureAttribute.UNDEAD;
-    }
-
-    /**
-     * Remove the speified potion effect from this entity.
-     */
-    public void removePotionEffectClient(int p_70618_1_)
-    {
-        this.activePotionsMap.remove(Integer.valueOf(p_70618_1_));
-    }
-
-    /**
-     * Remove the specified potion effect from this entity.
-     */
-    public void removePotionEffect(int p_82170_1_)
-    {
-        PotionEffect var2 = (PotionEffect)this.activePotionsMap.remove(Integer.valueOf(p_82170_1_));
-
-        if (var2 != null)
-        {
-            this.onFinishedPotionEffect(var2);
-        }
-    }
-
-    protected void onNewPotionEffect(PotionEffect p_70670_1_)
-    {
-        this.potionsNeedUpdate = true;
-
-        if (!this.worldObj.isRemote)
-        {
-            Potion.potionTypes[p_70670_1_.getPotionID()].applyAttributesModifiersToEntity(this, this.getAttributeMap(), p_70670_1_.getAmplifier());
-        }
-    }
-
-    protected void onChangedPotionEffect(PotionEffect p_70695_1_, boolean p_70695_2_)
-    {
-        this.potionsNeedUpdate = true;
-
-        if (p_70695_2_ && !this.worldObj.isRemote)
-        {
-            Potion.potionTypes[p_70695_1_.getPotionID()].removeAttributesModifiersFromEntity(this, this.getAttributeMap(), p_70695_1_.getAmplifier());
-            Potion.potionTypes[p_70695_1_.getPotionID()].applyAttributesModifiersToEntity(this, this.getAttributeMap(), p_70695_1_.getAmplifier());
-        }
-    }
-
-    protected void onFinishedPotionEffect(PotionEffect p_70688_1_)
-    {
-        this.potionsNeedUpdate = true;
-
-        if (!this.worldObj.isRemote)
-        {
-            Potion.potionTypes[p_70688_1_.getPotionID()].removeAttributesModifiersFromEntity(this, this.getAttributeMap(), p_70688_1_.getAmplifier());
-        }
-    }
-
-    /**
-     * Heal living entity (param: amount of half-hearts)
-     */
-    public void heal(float p_70691_1_)
-    {
-        float var2 = this.getHealth();
-
-        if (var2 > 0.0F)
-        {
-            this.setHealth(var2 + p_70691_1_);
-        }
-    }
-
-    public final float getHealth()
-    {
-        return this.dataWatcher.getWatchableObjectFloat(6);
-    }
-
-    public void setHealth(float p_70606_1_)
-    {
-        this.dataWatcher.updateObject(6, Float.valueOf(MathHelper.clamp_float(p_70606_1_, 0.0F, this.getMaxHealth())));
-    }
-
-    /**
-     * Called when the entity is attacked.
-     */
-    public boolean attackEntityFrom(DamageSource source, float amount)
-    {
-        if (this.func_180431_b(source))
-        {
-            return false;
-        }
-        else if (this.worldObj.isRemote)
-        {
-            return false;
-        }
-        else
-        {
-            this.entityAge = 0;
-
-            if (this.getHealth() <= 0.0F)
-            {
-                return false;
-            }
-            else if (source.isFireDamage() && this.isPotionActive(Potion.fireResistance))
-            {
-                return false;
-            }
-            else
-            {
-                if ((source == DamageSource.anvil || source == DamageSource.fallingBlock) && this.getEquipmentInSlot(4) != null)
-                {
-                    this.getEquipmentInSlot(4).damageItem((int)(amount * 4.0F + this.rand.nextFloat() * amount * 2.0F), this);
-                    amount *= 0.75F;
-                }
-
-                this.limbSwingAmount = 1.5F;
-                boolean var3 = true;
-
-                if ((float)this.hurtResistantTime > (float)this.maxHurtResistantTime / 2.0F)
-                {
-                    if (amount <= this.lastDamage)
-                    {
-                        return false;
-                    }
-
-                    this.damageEntity(source, amount - this.lastDamage);
-                    this.lastDamage = amount;
-                    var3 = false;
-                }
-                else
-                {
-                    this.lastDamage = amount;
-                    this.hurtResistantTime = this.maxHurtResistantTime;
-                    this.damageEntity(source, amount);
-                    this.hurtTime = this.maxHurtTime = 10;
-                }
-
-                this.attackedAtYaw = 0.0F;
-                Entity var4 = source.getEntity();
-
-                if (var4 != null)
-                {
-                    if (var4 instanceof EntityLivingBase)
-                    {
-                        this.setRevengeTarget((EntityLivingBase)var4);
-                    }
-
-                    if (var4 instanceof EntityPlayer)
-                    {
-                        this.recentlyHit = 100;
-                        this.attackingPlayer = (EntityPlayer)var4;
-                    }
-                    else if (var4 instanceof EntityWolf)
-                    {
-                        EntityWolf var5 = (EntityWolf)var4;
-
-                        if (var5.isTamed())
-                        {
-                            this.recentlyHit = 100;
-                            this.attackingPlayer = null;
-                        }
-                    }
-                }
-
-                if (var3)
-                {
-                    this.worldObj.setEntityState(this, (byte)2);
-
-                    if (source != DamageSource.drown)
-                    {
-                        this.setBeenAttacked();
-                    }
-
-                    if (var4 != null)
-                    {
-                        double var9 = var4.posX - this.posX;
-                        double var7;
-
-                        for (var7 = var4.posZ - this.posZ; var9 * var9 + var7 * var7 < 1.0E-4D; var7 = (Math.random() - Math.random()) * 0.01D)
-                        {
-                            var9 = (Math.random() - Math.random()) * 0.01D;
-                        }
-
-                        this.attackedAtYaw = (float)(Math.atan2(var7, var9) * 180.0D / Math.PI - (double)this.rotationYaw);
-                        this.knockBack(var4, amount, var9, var7);
-                    }
-                    else
-                    {
-                        this.attackedAtYaw = (float)((int)(Math.random() * 2.0D) * 180);
-                    }
-                }
-
-                String var10;
-
-                if (this.getHealth() <= 0.0F)
-                {
-                    var10 = this.getDeathSound();
-
-                    if (var3 && var10 != null)
-                    {
-                        this.playSound(var10, this.getSoundVolume(), this.getSoundPitch());
-                    }
-
-                    this.onDeath(source);
-                }
-                else
-                {
-                    var10 = this.getHurtSound();
-
-                    if (var3 && var10 != null)
-                    {
-                        this.playSound(var10, this.getSoundVolume(), this.getSoundPitch());
-                    }
-                }
-
-                return true;
-            }
-        }
-    }
-
-    /**
-     * Renders broken item particles using the given ItemStack
-     */
-    public void renderBrokenItemStack(ItemStack p_70669_1_)
-    {
-        this.playSound("random.break", 0.8F, 0.8F + this.worldObj.rand.nextFloat() * 0.4F);
-
-        for (int var2 = 0; var2 < 5; ++var2)
-        {
-            Vec3 var3 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.1D, Math.random() * 0.1D + 0.1D, 0.0D);
-            var3 = var3.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
-            var3 = var3.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
-            double var4 = (double)(-this.rand.nextFloat()) * 0.6D - 0.3D;
-            Vec3 var6 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.3D, var4, 0.6D);
-            var6 = var6.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
-            var6 = var6.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
-            var6 = var6.addVector(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
-            this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var6.xCoord, var6.yCoord, var6.zCoord, var3.xCoord, var3.yCoord + 0.05D, var3.zCoord, new int[] {Item.getIdFromItem(p_70669_1_.getItem())});
-        }
-    }
-
-    /**
-     * Called when the mob's health reaches 0.
-     */
-    public void onDeath(DamageSource cause)
-    {
-        Entity var2 = cause.getEntity();
-        EntityLivingBase var3 = this.func_94060_bK();
-
-        if (this.scoreValue >= 0 && var3 != null)
-        {
-            var3.addToPlayerScore(this, this.scoreValue);
-        }
-
-        if (var2 != null)
-        {
-            var2.onKillEntity(this);
-        }
-
-        this.dead = true;
-        this.getCombatTracker().func_94549_h();
-
-        if (!this.worldObj.isRemote)
-        {
-            int var4 = 0;
-
-            if (var2 instanceof EntityPlayer)
-            {
-                var4 = EnchantmentHelper.getLootingModifier((EntityLivingBase)var2);
-            }
-
-            if (this.func_146066_aG() && this.worldObj.getGameRules().getGameRuleBooleanValue("doMobLoot"))
-            {
-                this.dropFewItems(this.recentlyHit > 0, var4);
-                this.dropEquipment(this.recentlyHit > 0, var4);
-
-                if (this.recentlyHit > 0 && this.rand.nextFloat() < 0.025F + (float)var4 * 0.01F)
-                {
-                    this.addRandomArmor();
-                }
-            }
-        }
-
-        this.worldObj.setEntityState(this, (byte)3);
-    }
-
-    /**
-     * Drop the equipment for this entity.
-     */
-    protected void dropEquipment(boolean p_82160_1_, int p_82160_2_) {}
-
-    /**
-     * knocks back this entity
-     */
-    public void knockBack(Entity p_70653_1_, float p_70653_2_, double p_70653_3_, double p_70653_5_)
-    {
-        if (this.rand.nextDouble() >= this.getEntityAttribute(SharedMonsterAttributes.knockbackResistance).getAttributeValue())
-        {
-            this.isAirBorne = true;
-            float var7 = MathHelper.sqrt_double(p_70653_3_ * p_70653_3_ + p_70653_5_ * p_70653_5_);
-            float var8 = 0.4F;
-            this.motionX /= 2.0D;
-            this.motionY /= 2.0D;
-            this.motionZ /= 2.0D;
-            this.motionX -= p_70653_3_ / (double)var7 * (double)var8;
-            this.motionY += (double)var8;
-            this.motionZ -= p_70653_5_ / (double)var7 * (double)var8;
-
-            if (this.motionY > 0.4000000059604645D)
-            {
-                this.motionY = 0.4000000059604645D;
-            }
-        }
-    }
-
-    /**
-     * Returns the sound this mob makes when it is hurt.
-     */
-    protected String getHurtSound()
-    {
-        return "game.neutral.hurt";
-    }
-
-    /**
-     * Returns the sound this mob makes on death.
-     */
-    protected String getDeathSound()
-    {
-        return "game.neutral.die";
-    }
-
-    /**
-     * Makes entity wear random armor based on difficulty
-     */
-    protected void addRandomArmor() {}
-
-    /**
-     * Drop 0-2 items of this living's type
-     */
-    protected void dropFewItems(boolean p_70628_1_, int p_70628_2_) {}
-
-    /**
-     * returns true if this entity is by a ladder, false otherwise
-     */
-    public boolean isOnLadder()
-    {
-        int var1 = MathHelper.floor_double(this.posX);
-        int var2 = MathHelper.floor_double(this.getEntityBoundingBox().minY);
-        int var3 = MathHelper.floor_double(this.posZ);
-        Block var4 = this.worldObj.getBlockState(new BlockPos(var1, var2, var3)).getBlock();
-        return (var4 == Blocks.ladder || var4 == Blocks.vine) && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).func_175149_v());
-    }
-
-    /**
-     * Checks whether target entity is alive.
-     */
-    public boolean isEntityAlive()
-    {
-        return !this.isDead && this.getHealth() > 0.0F;
-    }
-
-    public void fall(float distance, float damageMultiplier)
-    {
-        super.fall(distance, damageMultiplier);
-        PotionEffect var3 = this.getActivePotionEffect(Potion.jump);
-        float var4 = var3 != null ? (float)(var3.getAmplifier() + 1) : 0.0F;
-        int var5 = MathHelper.ceiling_float_int((distance - 3.0F - var4) * damageMultiplier);
-
-        if (var5 > 0)
-        {
-            this.playSound(this.func_146067_o(var5), 1.0F, 1.0F);
-            this.attackEntityFrom(DamageSource.fall, (float)var5);
-            int var6 = MathHelper.floor_double(this.posX);
-            int var7 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
-            int var8 = MathHelper.floor_double(this.posZ);
-            Block var9 = this.worldObj.getBlockState(new BlockPos(var6, var7, var8)).getBlock();
-
-            if (var9.getMaterial() != Material.air)
-            {
-                Block.SoundType var10 = var9.stepSound;
-                this.playSound(var10.getStepSound(), var10.getVolume() * 0.5F, var10.getFrequency() * 0.75F);
-            }
-        }
-    }
-
-    protected String func_146067_o(int p_146067_1_)
-    {
-        return p_146067_1_ > 4 ? "game.neutral.hurt.fall.big" : "game.neutral.hurt.fall.small";
-    }
-
-    /**
-     * Setups the entity to do the hurt animation. Only used by packets in multiplayer.
-     */
-    public void performHurtAnimation()
-    {
-        this.hurtTime = this.maxHurtTime = 10;
-        this.attackedAtYaw = 0.0F;
-    }
-
-    /**
-     * Returns the current armor value as determined by a call to InventoryPlayer.getTotalArmorValue
-     */
-    public int getTotalArmorValue()
-    {
-        int var1 = 0;
-        ItemStack[] var2 = this.getInventory();
-        int var3 = var2.length;
-
-        for (int var4 = 0; var4 < var3; ++var4)
-        {
-            ItemStack var5 = var2[var4];
-
-            if (var5 != null && var5.getItem() instanceof ItemArmor)
-            {
-                int var6 = ((ItemArmor)var5.getItem()).damageReduceAmount;
-                var1 += var6;
-            }
-        }
-
-        return var1;
-    }
-
-    protected void damageArmor(float p_70675_1_) {}
-
-    /**
-     * Reduces damage, depending on armor
-     */
-    protected float applyArmorCalculations(DamageSource p_70655_1_, float p_70655_2_)
-    {
-        if (!p_70655_1_.isUnblockable())
-        {
-            int var3 = 25 - this.getTotalArmorValue();
-            float var4 = p_70655_2_ * (float)var3;
-            this.damageArmor(p_70655_2_);
-            p_70655_2_ = var4 / 25.0F;
-        }
-
-        return p_70655_2_;
-    }
-
-    /**
-     * Reduces damage, depending on potions
-     */
-    protected float applyPotionDamageCalculations(DamageSource p_70672_1_, float p_70672_2_)
-    {
-        if (p_70672_1_.isDamageAbsolute())
-        {
-            return p_70672_2_;
-        }
-        else
-        {
-            int var3;
-            int var4;
-            float var5;
-
-            if (this.isPotionActive(Potion.resistance) && p_70672_1_ != DamageSource.outOfWorld)
-            {
-                var3 = (this.getActivePotionEffect(Potion.resistance).getAmplifier() + 1) * 5;
-                var4 = 25 - var3;
-                var5 = p_70672_2_ * (float)var4;
-                p_70672_2_ = var5 / 25.0F;
-            }
-
-            if (p_70672_2_ <= 0.0F)
-            {
-                return 0.0F;
-            }
-            else
-            {
-                var3 = EnchantmentHelper.getEnchantmentModifierDamage(this.getInventory(), p_70672_1_);
-
-                if (var3 > 20)
-                {
-                    var3 = 20;
-                }
-
-                if (var3 > 0 && var3 <= 20)
-                {
-                    var4 = 25 - var3;
-                    var5 = p_70672_2_ * (float)var4;
-                    p_70672_2_ = var5 / 25.0F;
-                }
-
-                return p_70672_2_;
-            }
-        }
-    }
-
-    /**
-     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
-     * second with the reduced value. Args: damageAmount
-     */
-    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
-    {
-        if (!this.func_180431_b(p_70665_1_))
-        {
-            p_70665_2_ = this.applyArmorCalculations(p_70665_1_, p_70665_2_);
-            p_70665_2_ = this.applyPotionDamageCalculations(p_70665_1_, p_70665_2_);
-            float var3 = p_70665_2_;
-            p_70665_2_ = Math.max(p_70665_2_ - this.getAbsorptionAmount(), 0.0F);
-            this.setAbsorptionAmount(this.getAbsorptionAmount() - (var3 - p_70665_2_));
-
-            if (p_70665_2_ != 0.0F)
-            {
-                float var4 = this.getHealth();
-                this.setHealth(var4 - p_70665_2_);
-                this.getCombatTracker().func_94547_a(p_70665_1_, var4, p_70665_2_);
-                this.setAbsorptionAmount(this.getAbsorptionAmount() - p_70665_2_);
-            }
-        }
-    }
-
-    public CombatTracker getCombatTracker()
-    {
-        return this._combatTracker;
-    }
-
-    public EntityLivingBase func_94060_bK()
-    {
-        return (EntityLivingBase)(this._combatTracker.func_94550_c() != null ? this._combatTracker.func_94550_c() : (this.attackingPlayer != null ? this.attackingPlayer : (this.entityLivingToAttack != null ? this.entityLivingToAttack : null)));
-    }
-
-    public final float getMaxHealth()
-    {
-        return (float)this.getEntityAttribute(SharedMonsterAttributes.maxHealth).getAttributeValue();
-    }
-
-    /**
-     * counts the amount of arrows stuck in the entity. getting hit by arrows increases this, used in rendering
-     */
-    public final int getArrowCountInEntity()
-    {
-        return this.dataWatcher.getWatchableObjectByte(9);
-    }
-
-    /**
-     * sets the amount of arrows stuck in the entity. used for rendering those
-     */
-    public final void setArrowCountInEntity(int p_85034_1_)
-    {
-        this.dataWatcher.updateObject(9, Byte.valueOf((byte)p_85034_1_));
-    }
-
-    /**
-     * Returns an integer indicating the end point of the swing animation, used by {@link #swingProgress} to provide a
-     * progress indicator. Takes dig speed enchantments into account.
-     */
-    private int getArmSwingAnimationEnd()
-    {
-        return this.isPotionActive(Potion.digSpeed) ? 6 - (1 + this.getActivePotionEffect(Potion.digSpeed).getAmplifier()) * 1 : (this.isPotionActive(Potion.digSlowdown) ? 6 + (1 + this.getActivePotionEffect(Potion.digSlowdown).getAmplifier()) * 2 : 6);
-    }
-
-    /**
-     * Swings the item the player is holding.
-     */
-    public void swingItem()
-    {
-        if (!this.isSwingInProgress || this.swingProgressInt >= this.getArmSwingAnimationEnd() / 2 || this.swingProgressInt < 0)
-        {
-            this.swingProgressInt = -1;
-            this.isSwingInProgress = true;
-
-            if (this.worldObj instanceof WorldServer)
-            {
-                ((WorldServer)this.worldObj).getEntityTracker().sendToAllTrackingEntity(this, new S0BPacketAnimation(this, 0));
-            }
-        }
-    }
-
-    public void handleHealthUpdate(byte p_70103_1_)
-    {
-        String var2;
-
-        if (p_70103_1_ == 2)
-        {
-            this.limbSwingAmount = 1.5F;
-            this.hurtResistantTime = this.maxHurtResistantTime;
-            this.hurtTime = this.maxHurtTime = 10;
-            this.attackedAtYaw = 0.0F;
-            var2 = this.getHurtSound();
-
-            if (var2 != null)
-            {
-                this.playSound(this.getHurtSound(), this.getSoundVolume(), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
-            }
-
-            this.attackEntityFrom(DamageSource.generic, 0.0F);
-        }
-        else if (p_70103_1_ == 3)
-        {
-            var2 = this.getDeathSound();
-
-            if (var2 != null)
-            {
-                this.playSound(this.getDeathSound(), this.getSoundVolume(), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
-            }
-
-            this.setHealth(0.0F);
-            this.onDeath(DamageSource.generic);
-        }
-        else
-        {
-            super.handleHealthUpdate(p_70103_1_);
-        }
-    }
-
-    /**
-     * sets the dead flag. Used when you fall off the bottom of the world.
-     */
-    protected void kill()
-    {
-        this.attackEntityFrom(DamageSource.outOfWorld, 4.0F);
-    }
-
-    /**
-     * Updates the arm swing progress counters and animation progress
-     */
-    protected void updateArmSwingProgress()
-    {
-        int var1 = this.getArmSwingAnimationEnd();
-
-        if (this.isSwingInProgress)
-        {
-            ++this.swingProgressInt;
-
-            if (this.swingProgressInt >= var1)
-            {
-                this.swingProgressInt = 0;
-                this.isSwingInProgress = false;
-            }
-        }
-        else
-        {
-            this.swingProgressInt = 0;
-        }
-
-        this.swingProgress = (float)this.swingProgressInt / (float)var1;
-    }
-
-    public IAttributeInstance getEntityAttribute(IAttribute p_110148_1_)
-    {
-        return this.getAttributeMap().getAttributeInstance(p_110148_1_);
-    }
-
-    public BaseAttributeMap getAttributeMap()
-    {
-        if (this.attributeMap == null)
-        {
-            this.attributeMap = new ServersideAttributeMap();
-        }
-
-        return this.attributeMap;
-    }
-
-    /**
-     * Get this Entity's EnumCreatureAttribute
-     */
-    public EnumCreatureAttribute getCreatureAttribute()
-    {
-        return EnumCreatureAttribute.UNDEFINED;
-    }
-
-    /**
-     * Returns the item that this EntityLiving is holding, if any.
-     */
-    public abstract ItemStack getHeldItem();
-
-    /**
-     * 0: Tool in Hand; 1-4: Armor
-     */
-    public abstract ItemStack getEquipmentInSlot(int p_71124_1_);
-
-    public abstract ItemStack getCurrentArmor(int p_82169_1_);
-
-    /**
-     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
-     */
-    public abstract void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn);
-
-    /**
-     * Set sprinting switch for Entity.
-     */
-    public void setSprinting(boolean sprinting)
-    {
-        super.setSprinting(sprinting);
-        IAttributeInstance var2 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
-
-        if (var2.getModifier(sprintingSpeedBoostModifierUUID) != null)
-        {
-            var2.removeModifier(sprintingSpeedBoostModifier);
-        }
-
-        if (sprinting)
-        {
-            var2.applyModifier(sprintingSpeedBoostModifier);
-        }
-    }
-
-    /**
-     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
-     */
-    public abstract ItemStack[] getInventory();
-
-    /**
-     * Returns the volume for the sounds this mob makes.
-     */
-    protected float getSoundVolume()
-    {
-        return 1.0F;
-    }
-
-    /**
-     * Gets the pitch of living sounds in living entities.
-     */
-    protected float getSoundPitch()
-    {
-        return this.isChild() ? (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.5F : (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F;
-    }
-
-    /**
-     * Dead and sleeping entities cannot move
-     */
-    protected boolean isMovementBlocked()
-    {
-        return this.getHealth() <= 0.0F;
-    }
-
-    /**
-     * Moves the entity to a position out of the way of its mount.
-     */
-    public void dismountEntity(Entity p_110145_1_)
-    {
-        double var3 = p_110145_1_.posX;
-        double var5 = p_110145_1_.getEntityBoundingBox().minY + (double)p_110145_1_.height;
-        double var7 = p_110145_1_.posZ;
-        byte var9 = 1;
-
-        for (int var10 = -var9; var10 <= var9; ++var10)
-        {
-            for (int var11 = -var9; var11 < var9; ++var11)
-            {
-                if (var10 != 0 || var11 != 0)
-                {
-                    int var12 = (int)(this.posX + (double)var10);
-                    int var13 = (int)(this.posZ + (double)var11);
-                    AxisAlignedBB var2 = this.getEntityBoundingBox().offset((double)var10, 1.0D, (double)var11);
-
-                    if (this.worldObj.func_147461_a(var2).isEmpty())
-                    {
-                        if (World.doesBlockHaveSolidTopSurface(this.worldObj, new BlockPos(var12, (int)this.posY, var13)))
-                        {
-                            this.setPositionAndUpdate(this.posX + (double)var10, this.posY + 1.0D, this.posZ + (double)var11);
-                            return;
-                        }
-
-                        if (World.doesBlockHaveSolidTopSurface(this.worldObj, new BlockPos(var12, (int)this.posY - 1, var13)) || this.worldObj.getBlockState(new BlockPos(var12, (int)this.posY - 1, var13)).getBlock().getMaterial() == Material.water)
-                        {
-                            var3 = this.posX + (double)var10;
-                            var5 = this.posY + 1.0D;
-                            var7 = this.posZ + (double)var11;
-                        }
-                    }
-                }
-            }
-        }
-
-        this.setPositionAndUpdate(var3, var5, var7);
-    }
-
-    public boolean getAlwaysRenderNameTagForRender()
-    {
-        return false;
-    }
-
-    protected float func_175134_bD()
-    {
-        return 0.42F;
-    }
-
-    /**
-     * Causes this entity to do an upwards motion (jumping).
-     */
-    protected void jump()
-    {
-        this.motionY = (double)this.func_175134_bD();
-
-        if (this.isPotionActive(Potion.jump))
-        {
-            this.motionY += (double)((float)(this.getActivePotionEffect(Potion.jump).getAmplifier() + 1) * 0.1F);
-        }
-
-        if (this.isSprinting())
-        {
-            float var1 = this.rotationYaw * 0.017453292F;
-            this.motionX -= (double)(MathHelper.sin(var1) * 0.2F);
-            this.motionZ += (double)(MathHelper.cos(var1) * 0.2F);
-        }
-
-        this.isAirBorne = true;
-    }
-
-    /**
-     * main AI tick function, replaces updateEntityActionState
-     */
-    protected void updateAITick()
-    {
-        this.motionY += 0.03999999910593033D;
-    }
-
-    protected void func_180466_bG()
-    {
-        this.motionY += 0.03999999910593033D;
-    }
-
-    /**
-     * Moves the entity based on the specified heading.  Args: strafe, forward
-     */
-    public void moveEntityWithHeading(float p_70612_1_, float p_70612_2_)
-    {
-        double var8;
-        float var10;
-
-        if (this.isServerWorld())
-        {
-            float var5;
-            float var6;
-
-            if (this.isInWater() && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).capabilities.isFlying))
-            {
-                var8 = this.posY;
-                var5 = 0.8F;
-                var6 = 0.02F;
-                var10 = (float)EnchantmentHelper.func_180318_b(this);
-
-                if (var10 > 3.0F)
-                {
-                    var10 = 3.0F;
-                }
-
-                if (!this.onGround)
-                {
-                    var10 *= 0.5F;
-                }
-
-                if (var10 > 0.0F)
-                {
-                    var5 += (0.54600006F - var5) * var10 / 3.0F;
-                    var6 += (this.getAIMoveSpeed() * 1.0F - var6) * var10 / 3.0F;
-                }
-
-                this.moveFlying(p_70612_1_, p_70612_2_, var6);
-                this.moveEntity(this.motionX, this.motionY, this.motionZ);
-                this.motionX *= (double)var5;
-                this.motionY *= 0.800000011920929D;
-                this.motionZ *= (double)var5;
-                this.motionY -= 0.02D;
-
-                if (this.isCollidedHorizontally && this.isOffsetPositionInLiquid(this.motionX, this.motionY + 0.6000000238418579D - this.posY + var8, this.motionZ))
-                {
-                    this.motionY = 0.30000001192092896D;
-                }
-            }
-            else if (this.func_180799_ab() && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).capabilities.isFlying))
-            {
-                var8 = this.posY;
-                this.moveFlying(p_70612_1_, p_70612_2_, 0.02F);
-                this.moveEntity(this.motionX, this.motionY, this.motionZ);
-                this.motionX *= 0.5D;
-                this.motionY *= 0.5D;
-                this.motionZ *= 0.5D;
-                this.motionY -= 0.02D;
-
-                if (this.isCollidedHorizontally && this.isOffsetPositionInLiquid(this.motionX, this.motionY + 0.6000000238418579D - this.posY + var8, this.motionZ))
-                {
-                    this.motionY = 0.30000001192092896D;
-                }
-            }
-            else
-            {
-                float var3 = 0.91F;
-
-                if (this.onGround)
-                {
-                    var3 = this.worldObj.getBlockState(new BlockPos(MathHelper.floor_double(this.posX), MathHelper.floor_double(this.getEntityBoundingBox().minY) - 1, MathHelper.floor_double(this.posZ))).getBlock().slipperiness * 0.91F;
-                }
-
-                float var4 = 0.16277136F / (var3 * var3 * var3);
-
-                if (this.onGround)
-                {
-                    var5 = this.getAIMoveSpeed() * var4;
-                }
-                else
-                {
-                    var5 = this.jumpMovementFactor;
-                }
-
-                this.moveFlying(p_70612_1_, p_70612_2_, var5);
-                var3 = 0.91F;
-
-                if (this.onGround)
-                {
-                    var3 = this.worldObj.getBlockState(new BlockPos(MathHelper.floor_double(this.posX), MathHelper.floor_double(this.getEntityBoundingBox().minY) - 1, MathHelper.floor_double(this.posZ))).getBlock().slipperiness * 0.91F;
-                }
-
-                if (this.isOnLadder())
-                {
-                    var6 = 0.15F;
-                    this.motionX = MathHelper.clamp_double(this.motionX, (double)(-var6), (double)var6);
-                    this.motionZ = MathHelper.clamp_double(this.motionZ, (double)(-var6), (double)var6);
-                    this.fallDistance = 0.0F;
-
-                    if (this.motionY < -0.15D)
-                    {
-                        this.motionY = -0.15D;
-                    }
-
-                    boolean var7 = this.isSneaking() && this instanceof EntityPlayer;
-
-                    if (var7 && this.motionY < 0.0D)
-                    {
-                        this.motionY = 0.0D;
-                    }
-                }
-
-                this.moveEntity(this.motionX, this.motionY, this.motionZ);
-
-                if (this.isCollidedHorizontally && this.isOnLadder())
-                {
-                    this.motionY = 0.2D;
-                }
-
-                if (this.worldObj.isRemote && (!this.worldObj.isBlockLoaded(new BlockPos((int)this.posX, 0, (int)this.posZ)) || !this.worldObj.getChunkFromBlockCoords(new BlockPos((int)this.posX, 0, (int)this.posZ)).isLoaded()))
-                {
-                    if (this.posY > 0.0D)
-                    {
-                        this.motionY = -0.1D;
-                    }
-                    else
-                    {
-                        this.motionY = 0.0D;
-                    }
-                }
-                else
-                {
-                    this.motionY -= 0.08D;
-                }
-
-                this.motionY *= 0.9800000190734863D;
-                this.motionX *= (double)var3;
-                this.motionZ *= (double)var3;
-            }
-        }
-
-        this.prevLimbSwingAmount = this.limbSwingAmount;
-        var8 = this.posX - this.prevPosX;
-        double var9 = this.posZ - this.prevPosZ;
-        var10 = MathHelper.sqrt_double(var8 * var8 + var9 * var9) * 4.0F;
-
-        if (var10 > 1.0F)
-        {
-            var10 = 1.0F;
-        }
-
-        this.limbSwingAmount += (var10 - this.limbSwingAmount) * 0.4F;
-        this.limbSwing += this.limbSwingAmount;
-    }
-
-    /**
-     * the movespeed used for the new AI system
-     */
-    public float getAIMoveSpeed()
-    {
-        return this.landMovementFactor;
-    }
-
-    /**
-     * set the movespeed used for the new AI system
-     */
-    public void setAIMoveSpeed(float p_70659_1_)
-    {
-        this.landMovementFactor = p_70659_1_;
-    }
-
-    public boolean attackEntityAsMob(Entity p_70652_1_)
-    {
-        this.setLastAttacker(p_70652_1_);
-        return false;
-    }
-
-    /**
-     * Returns whether player is sleeping or not
-     */
-    public boolean isPlayerSleeping()
-    {
-        return false;
-    }
-
-    /**
-     * Called to update the entity's position/logic.
-     */
-    public void onUpdate()
-    {
-        super.onUpdate();
-
-        if (!this.worldObj.isRemote)
-        {
-            int var1 = this.getArrowCountInEntity();
-
-            if (var1 > 0)
-            {
-                if (this.arrowHitTimer <= 0)
-                {
-                    this.arrowHitTimer = 20 * (30 - var1);
-                }
-
-                --this.arrowHitTimer;
-
-                if (this.arrowHitTimer <= 0)
-                {
-                    this.setArrowCountInEntity(var1 - 1);
-                }
-            }
-
-            for (int var2 = 0; var2 < 5; ++var2)
-            {
-                ItemStack var3 = this.previousEquipment[var2];
-                ItemStack var4 = this.getEquipmentInSlot(var2);
-
-                if (!ItemStack.areItemStacksEqual(var4, var3))
-                {
-                    ((WorldServer)this.worldObj).getEntityTracker().sendToAllTrackingEntity(this, new S04PacketEntityEquipment(this.getEntityId(), var2, var4));
-
-                    if (var3 != null)
-                    {
-                        this.attributeMap.removeAttributeModifiers(var3.getAttributeModifiers());
-                    }
-
-                    if (var4 != null)
-                    {
-                        this.attributeMap.applyAttributeModifiers(var4.getAttributeModifiers());
-                    }
-
-                    this.previousEquipment[var2] = var4 == null ? null : var4.copy();
-                }
-            }
-
-            if (this.ticksExisted % 20 == 0)
-            {
-                this.getCombatTracker().func_94549_h();
-            }
-        }
-
-        this.onLivingUpdate();
-        double var9 = this.posX - this.prevPosX;
-        double var10 = this.posZ - this.prevPosZ;
-        float var5 = (float)(var9 * var9 + var10 * var10);
-        float var6 = this.renderYawOffset;
-        float var7 = 0.0F;
-        this.field_70768_au = this.field_110154_aX;
-        float var8 = 0.0F;
-
-        if (var5 > 0.0025000002F)
-        {
-            var8 = 1.0F;
-            var7 = (float)Math.sqrt((double)var5) * 3.0F;
-            var6 = (float)Math.atan2(var10, var9) * 180.0F / (float)Math.PI - 90.0F;
-        }
-
-        if (this.swingProgress > 0.0F)
-        {
-            var6 = this.rotationYaw;
-        }
-
-        if (!this.onGround)
-        {
-            var8 = 0.0F;
-        }
-
-        this.field_110154_aX += (var8 - this.field_110154_aX) * 0.3F;
-        this.worldObj.theProfiler.startSection("headTurn");
-        var7 = this.func_110146_f(var6, var7);
-        this.worldObj.theProfiler.endSection();
-        this.worldObj.theProfiler.startSection("rangeChecks");
-
-        while (this.rotationYaw - this.prevRotationYaw < -180.0F)
-        {
-            this.prevRotationYaw -= 360.0F;
-        }
-
-        while (this.rotationYaw - this.prevRotationYaw >= 180.0F)
-        {
-            this.prevRotationYaw += 360.0F;
-        }
-
-        while (this.renderYawOffset - this.prevRenderYawOffset < -180.0F)
-        {
-            this.prevRenderYawOffset -= 360.0F;
-        }
-
-        while (this.renderYawOffset - this.prevRenderYawOffset >= 180.0F)
-        {
-            this.prevRenderYawOffset += 360.0F;
-        }
-
-        while (this.rotationPitch - this.prevRotationPitch < -180.0F)
-        {
-            this.prevRotationPitch -= 360.0F;
-        }
-
-        while (this.rotationPitch - this.prevRotationPitch >= 180.0F)
-        {
-            this.prevRotationPitch += 360.0F;
-        }
-
-        while (this.rotationYawHead - this.prevRotationYawHead < -180.0F)
-        {
-            this.prevRotationYawHead -= 360.0F;
-        }
-
-        while (this.rotationYawHead - this.prevRotationYawHead >= 180.0F)
-        {
-            this.prevRotationYawHead += 360.0F;
-        }
-
-        this.worldObj.theProfiler.endSection();
-        this.field_70764_aw += var7;
-    }
-
-    protected float func_110146_f(float p_110146_1_, float p_110146_2_)
-    {
-        float var3 = MathHelper.wrapAngleTo180_float(p_110146_1_ - this.renderYawOffset);
-        this.renderYawOffset += var3 * 0.3F;
-        float var4 = MathHelper.wrapAngleTo180_float(this.rotationYaw - this.renderYawOffset);
-        boolean var5 = var4 < -90.0F || var4 >= 90.0F;
-
-        if (var4 < -75.0F)
-        {
-            var4 = -75.0F;
-        }
-
-        if (var4 >= 75.0F)
-        {
-            var4 = 75.0F;
-        }
-
-        this.renderYawOffset = this.rotationYaw - var4;
-
-        if (var4 * var4 > 2500.0F)
-        {
-            this.renderYawOffset += var4 * 0.2F;
-        }
-
-        if (var5)
-        {
-            p_110146_2_ *= -1.0F;
-        }
-
-        return p_110146_2_;
-    }
-
-    /**
-     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
-     * use this to react to sunlight and start to burn.
-     */
-    public void onLivingUpdate()
-    {
-        if (this.jumpTicks > 0)
-        {
-            --this.jumpTicks;
-        }
-
-        if (this.newPosRotationIncrements > 0)
-        {
-            double var1 = this.posX + (this.newPosX - this.posX) / (double)this.newPosRotationIncrements;
-            double var3 = this.posY + (this.newPosY - this.posY) / (double)this.newPosRotationIncrements;
-            double var5 = this.posZ + (this.newPosZ - this.posZ) / (double)this.newPosRotationIncrements;
-            double var7 = MathHelper.wrapAngleTo180_double(this.newRotationYaw - (double)this.rotationYaw);
-            this.rotationYaw = (float)((double)this.rotationYaw + var7 / (double)this.newPosRotationIncrements);
-            this.rotationPitch = (float)((double)this.rotationPitch + (this.newRotationPitch - (double)this.rotationPitch) / (double)this.newPosRotationIncrements);
-            --this.newPosRotationIncrements;
-            this.setPosition(var1, var3, var5);
-            this.setRotation(this.rotationYaw, this.rotationPitch);
-        }
-        else if (!this.isServerWorld())
-        {
-            this.motionX *= 0.98D;
-            this.motionY *= 0.98D;
-            this.motionZ *= 0.98D;
-        }
-
-        if (Math.abs(this.motionX) < 0.005D)
-        {
-            this.motionX = 0.0D;
-        }
-
-        if (Math.abs(this.motionY) < 0.005D)
-        {
-            this.motionY = 0.0D;
-        }
-
-        if (Math.abs(this.motionZ) < 0.005D)
-        {
-            this.motionZ = 0.0D;
-        }
-
-        this.worldObj.theProfiler.startSection("ai");
-
-        if (this.isMovementBlocked())
-        {
-            this.isJumping = false;
-            this.moveStrafing = 0.0F;
-            this.moveForward = 0.0F;
-            this.randomYawVelocity = 0.0F;
-        }
-        else if (this.isServerWorld())
-        {
-            this.worldObj.theProfiler.startSection("newAi");
-            this.updateEntityActionState();
-            this.worldObj.theProfiler.endSection();
-        }
-
-        this.worldObj.theProfiler.endSection();
-        this.worldObj.theProfiler.startSection("jump");
-
-        if (this.isJumping)
-        {
-            if (this.isInWater())
-            {
-                this.updateAITick();
-            }
-            else if (this.func_180799_ab())
-            {
-                this.func_180466_bG();
-            }
-            else if (this.onGround && this.jumpTicks == 0)
-            {
-                this.jump();
-                this.jumpTicks = 10;
-            }
-        }
-        else
-        {
-            this.jumpTicks = 0;
-        }
-
-        this.worldObj.theProfiler.endSection();
-        this.worldObj.theProfiler.startSection("travel");
-        this.moveStrafing *= 0.98F;
-        this.moveForward *= 0.98F;
-        this.randomYawVelocity *= 0.9F;
-        this.moveEntityWithHeading(this.moveStrafing, this.moveForward);
-        this.worldObj.theProfiler.endSection();
-        this.worldObj.theProfiler.startSection("push");
-
-        if (!this.worldObj.isRemote)
-        {
-            this.collideWithNearbyEntities();
-        }
-
-        this.worldObj.theProfiler.endSection();
-    }
-
-    protected void updateEntityActionState() {}
-
-    protected void collideWithNearbyEntities()
-    {
-        List var1 = this.worldObj.getEntitiesWithinAABBExcludingEntity(this, this.getEntityBoundingBox().expand(0.20000000298023224D, 0.0D, 0.20000000298023224D));
-
-        if (var1 != null && !var1.isEmpty())
-        {
-            for (int var2 = 0; var2 < var1.size(); ++var2)
-            {
-                Entity var3 = (Entity)var1.get(var2);
-
-                if (var3.canBePushed())
-                {
-                    this.collideWithEntity(var3);
-                }
-            }
-        }
-    }
-
-    protected void collideWithEntity(Entity p_82167_1_)
-    {
-        p_82167_1_.applyEntityCollision(this);
-    }
-
-    /**
-     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
-     */
-    public void mountEntity(Entity entityIn)
-    {
-        if (this.ridingEntity != null && entityIn == null)
-        {
-            if (!this.worldObj.isRemote)
-            {
-                this.dismountEntity(this.ridingEntity);
-            }
-
-            if (this.ridingEntity != null)
-            {
-                this.ridingEntity.riddenByEntity = null;
-            }
-
-            this.ridingEntity = null;
-        }
-        else
-        {
-            super.mountEntity(entityIn);
-        }
-    }
-
-    /**
-     * Handles updating while being ridden by an entity
-     */
-    public void updateRidden()
-    {
-        super.updateRidden();
-        this.field_70768_au = this.field_110154_aX;
-        this.field_110154_aX = 0.0F;
-        this.fallDistance = 0.0F;
-    }
-
-    public void func_180426_a(double p_180426_1_, double p_180426_3_, double p_180426_5_, float p_180426_7_, float p_180426_8_, int p_180426_9_, boolean p_180426_10_)
-    {
-        this.newPosX = p_180426_1_;
-        this.newPosY = p_180426_3_;
-        this.newPosZ = p_180426_5_;
-        this.newRotationYaw = (double)p_180426_7_;
-        this.newRotationPitch = (double)p_180426_8_;
-        this.newPosRotationIncrements = p_180426_9_;
-    }
-
-    public void setJumping(boolean p_70637_1_)
-    {
-        this.isJumping = p_70637_1_;
-    }
-
-    /**
-     * Called whenever an item is picked up from walking over it. Args: pickedUpEntity, stackSize
-     */
-    public void onItemPickup(Entity p_71001_1_, int p_71001_2_)
-    {
-        if (!p_71001_1_.isDead && !this.worldObj.isRemote)
-        {
-            EntityTracker var3 = ((WorldServer)this.worldObj).getEntityTracker();
-
-            if (p_71001_1_ instanceof EntityItem)
-            {
-                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
-            }
-
-            if (p_71001_1_ instanceof EntityArrow)
-            {
-                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
-            }
-
-            if (p_71001_1_ instanceof EntityXPOrb)
-            {
-                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
-            }
-        }
-    }
-
-    /**
-     * returns true if the entity provided in the argument can be seen. (Raytrace)
-     */
-    public boolean canEntityBeSeen(Entity p_70685_1_)
-    {
-        return this.worldObj.rayTraceBlocks(new Vec3(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ), new Vec3(p_70685_1_.posX, p_70685_1_.posY + (double)p_70685_1_.getEyeHeight(), p_70685_1_.posZ)) == null;
-    }
-
-    /**
-     * returns a (normalized) vector of where this entity is looking
-     */
-    public Vec3 getLookVec()
-    {
-        return this.getLook(1.0F);
-    }
-
-    /**
-     * interpolated look vector
-     */
-    public Vec3 getLook(float p_70676_1_)
-    {
-        if (p_70676_1_ == 1.0F)
-        {
-            return this.func_174806_f(this.rotationPitch, this.rotationYawHead);
-        }
-        else
-        {
-            float var2 = this.prevRotationPitch + (this.rotationPitch - this.prevRotationPitch) * p_70676_1_;
-            float var3 = this.prevRotationYawHead + (this.rotationYawHead - this.prevRotationYawHead) * p_70676_1_;
-            return this.func_174806_f(var2, var3);
-        }
-    }
-
-    /**
-     * Returns where in the swing animation the living entity is (from 0 to 1).  Args: partialTickTime
-     */
-    public float getSwingProgress(float p_70678_1_)
-    {
-        float var2 = this.swingProgress - this.prevSwingProgress;
-
-        if (var2 < 0.0F)
-        {
-            ++var2;
-        }
-
-        return this.prevSwingProgress + var2 * p_70678_1_;
-    }
-
-    /**
-     * Returns whether the entity is in a server world
-     */
-    public boolean isServerWorld()
-    {
-        return !this.worldObj.isRemote;
-    }
-
-    /**
-     * Returns true if other Entities should be prevented from moving through this Entity.
-     */
-    public boolean canBeCollidedWith()
-    {
-        return !this.isDead;
-    }
-
-    /**
-     * Returns true if this entity should push and be pushed by other entities when colliding.
-     */
-    public boolean canBePushed()
-    {
-        return !this.isDead;
-    }
-
-    /**
-     * Sets that this entity has been attacked.
-     */
-    protected void setBeenAttacked()
-    {
-        this.velocityChanged = this.rand.nextDouble() >= this.getEntityAttribute(SharedMonsterAttributes.knockbackResistance).getAttributeValue();
-    }
-
-    public float getRotationYawHead()
-    {
-        return this.rotationYawHead;
-    }
-
-    /**
-     * Sets the head's yaw rotation of the entity.
-     */
-    public void setRotationYawHead(float rotation)
-    {
-        this.rotationYawHead = rotation;
-    }
-
-    public float getAbsorptionAmount()
-    {
-        return this.field_110151_bq;
-    }
-
-    public void setAbsorptionAmount(float p_110149_1_)
-    {
-        if (p_110149_1_ < 0.0F)
-        {
-            p_110149_1_ = 0.0F;
-        }
-
-        this.field_110151_bq = p_110149_1_;
-    }
-
-    public Team getTeam()
-    {
-        return this.worldObj.getScoreboard().getPlayersTeam(this.getUniqueID().toString());
-    }
-
-    public boolean isOnSameTeam(EntityLivingBase p_142014_1_)
-    {
-        return this.isOnTeam(p_142014_1_.getTeam());
-    }
-
-    /**
-     * Returns true if the entity is on a specific team.
-     */
-    public boolean isOnTeam(Team p_142012_1_)
-    {
-        return this.getTeam() != null ? this.getTeam().isSameTeam(p_142012_1_) : false;
-    }
-
-    public void func_152111_bt() {}
-
-    public void func_152112_bu() {}
-
-    protected void func_175136_bO()
-    {
-        this.potionsNeedUpdate = true;
-    }
-}
+package net.minecraft.entity;
+
+import com.google.common.collect.Maps;
+
+import java.util.Collection;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+import java.util.Random;
+import java.util.UUID;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.HighJumpMod;
+import tk.wurst_client.mods.NoSlowdownMod;
+import net.minecraft.block.Block;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.enchantment.EnchantmentHelper;
+import net.minecraft.entity.ai.attributes.AttributeModifier;
+import net.minecraft.entity.ai.attributes.BaseAttributeMap;
+import net.minecraft.entity.ai.attributes.IAttribute;
+import net.minecraft.entity.ai.attributes.IAttributeInstance;
+import net.minecraft.entity.ai.attributes.ServersideAttributeMap;
+import net.minecraft.entity.item.EntityItem;
+import net.minecraft.entity.item.EntityXPOrb;
+import net.minecraft.entity.passive.EntityWolf;
+import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.EntityPlayerMP;
+import net.minecraft.entity.projectile.EntityArrow;
+import net.minecraft.init.Blocks;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemArmor;
+import net.minecraft.item.ItemStack;
+import net.minecraft.nbt.NBTBase;
+import net.minecraft.nbt.NBTTagCompound;
+import net.minecraft.nbt.NBTTagFloat;
+import net.minecraft.nbt.NBTTagList;
+import net.minecraft.nbt.NBTTagShort;
+import net.minecraft.network.play.server.S04PacketEntityEquipment;
+import net.minecraft.network.play.server.S0BPacketAnimation;
+import net.minecraft.network.play.server.S0DPacketCollectItem;
+import net.minecraft.potion.Potion;
+import net.minecraft.potion.PotionEffect;
+import net.minecraft.potion.PotionHelper;
+import net.minecraft.scoreboard.Team;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.CombatTracker;
+import net.minecraft.util.DamageSource;
+import net.minecraft.util.EnumParticleTypes;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.Vec3;
+import net.minecraft.world.World;
+import net.minecraft.world.WorldServer;
+
+public abstract class EntityLivingBase extends Entity
+{
+    private static final UUID sprintingSpeedBoostModifierUUID = UUID.fromString("662A6B8D-DA3E-4C1C-8813-96EA6097278D");
+    private static final AttributeModifier sprintingSpeedBoostModifier = (new AttributeModifier(sprintingSpeedBoostModifierUUID, "Sprinting speed boost", 0.30000001192092896D, 2)).setSaved(false);
+    private BaseAttributeMap attributeMap;
+    private final CombatTracker _combatTracker = new CombatTracker(this);
+    private final Map activePotionsMap = Maps.newHashMap();
+
+    /** The equipment this mob was previously wearing, used for syncing. */
+    private final ItemStack[] previousEquipment = new ItemStack[5];
+
+    /** Whether an arm swing is currently in progress. */
+    public boolean isSwingInProgress;
+    public int swingProgressInt;
+    public int arrowHitTimer;
+
+    /**
+     * The amount of time remaining this entity should act 'hurt'. (Visual appearance of red tint)
+     */
+    public int hurtTime;
+
+    /** What the hurt time was max set to last. */
+    public int maxHurtTime;
+
+    /** The yaw at which this entity was last attacked from. */
+    public float attackedAtYaw;
+
+    /**
+     * The amount of time remaining this entity should act 'dead', i.e. have a corpse in the world.
+     */
+    public int deathTime;
+    public float prevSwingProgress;
+    public float swingProgress;
+    public float prevLimbSwingAmount;
+    public float limbSwingAmount;
+
+    /**
+     * Only relevant when limbYaw is not 0(the entity is moving). Influences where in its swing legs and arms currently
+     * are.
+     */
+    public float limbSwing;
+    public int maxHurtResistantTime = 20;
+    public float prevCameraPitch;
+    public float cameraPitch;
+    public float field_70769_ao;
+    public float field_70770_ap;
+    public float renderYawOffset;
+    public float prevRenderYawOffset;
+
+    /** Entity head rotation yaw */
+    public float rotationYawHead;
+
+    /** Entity head rotation yaw at previous tick */
+    public float prevRotationYawHead;
+
+    /**
+     * A factor used to determine how far this entity will move each tick if it is jumping or falling.
+     */
+    public float jumpMovementFactor = 0.02F;
+
+    /** The most recent player that has attacked this entity */
+    protected EntityPlayer attackingPlayer;
+
+    /**
+     * Set to 60 when hit by the player or the player's wolf, then decrements. Used to determine whether the entity
+     * should drop items on death.
+     */
+    protected int recentlyHit;
+
+    /**
+     * This gets set on entity death, but never used. Looks like a duplicate of isDead
+     */
+    protected boolean dead;
+
+    /** The age of this EntityLiving (used to determine when it dies) */
+    protected int entityAge;
+    protected float field_70768_au;
+    protected float field_110154_aX;
+    protected float field_70764_aw;
+    protected float field_70763_ax;
+    protected float field_70741_aB;
+
+    /** The score value of the Mob, the amount of points the mob is worth. */
+    protected int scoreValue;
+
+    /**
+     * Damage taken in the last hit. Mobs are resistant to damage less than this for a short time after taking damage.
+     */
+    protected float lastDamage;
+
+    /** used to check whether entity is jumping. */
+    protected boolean isJumping;
+    public float moveStrafing;
+    public float moveForward;
+    protected float randomYawVelocity;
+
+    /**
+     * The number of updates over which the new position and rotation are to be applied to the entity.
+     */
+    protected int newPosRotationIncrements;
+
+    /** The new X position to be applied to the entity. */
+    protected double newPosX;
+
+    /** The new Y position to be applied to the entity. */
+    protected double newPosY;
+    protected double newPosZ;
+
+    /** The new yaw rotation to be applied to the entity. */
+    protected double newRotationYaw;
+
+    /** The new yaw rotation to be applied to the entity. */
+    protected double newRotationPitch;
+
+    /** Whether the DataWatcher needs to be updated with the active potions */
+    private boolean potionsNeedUpdate = true;
+
+    /** is only being set, has no uses as of MC 1.1 */
+    private EntityLivingBase entityLivingToAttack;
+    private int revengeTimer;
+    private EntityLivingBase lastAttacker;
+
+    /** Holds the value of ticksExisted when setLastAttacker was last called. */
+    private int lastAttackerTime;
+
+    /**
+     * A factor used to determine how far this entity will move each tick if it is walking on land. Adjusted by speed,
+     * and slipperiness of the current block.
+     */
+    private float landMovementFactor;
+
+    /** Number of ticks since last jump */
+    private int jumpTicks;
+    private float field_110151_bq;
+    private static final String __OBFID = "CL_00001549";
+
+    public void func_174812_G()
+    {
+        this.attackEntityFrom(DamageSource.outOfWorld, Float.MAX_VALUE);
+    }
+
+    public EntityLivingBase(World worldIn)
+    {
+        super(worldIn);
+        this.applyEntityAttributes();
+        this.setHealth(this.getMaxHealth());
+        this.preventEntitySpawning = true;
+        this.field_70770_ap = (float)((Math.random() + 1.0D) * 0.009999999776482582D);
+        this.setPosition(this.posX, this.posY, this.posZ);
+        this.field_70769_ao = (float)Math.random() * 12398.0F;
+        this.rotationYaw = (float)(Math.random() * Math.PI * 2.0D);
+        this.rotationYawHead = this.rotationYaw;
+        this.stepHeight = 0.6F;
+    }
+
+    protected void entityInit()
+    {
+        this.dataWatcher.addObject(7, Integer.valueOf(0));
+        this.dataWatcher.addObject(8, Byte.valueOf((byte)0));
+        this.dataWatcher.addObject(9, Byte.valueOf((byte)0));
+        this.dataWatcher.addObject(6, Float.valueOf(1.0F));
+    }
+
+    protected void applyEntityAttributes()
+    {
+        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.maxHealth);
+        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.knockbackResistance);
+        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.movementSpeed);
+    }
+
+    protected void func_180433_a(double p_180433_1_, boolean p_180433_3_, Block p_180433_4_, BlockPos p_180433_5_)
+    {
+        if (!this.isInWater())
+        {
+            this.handleWaterMovement();
+        }
+
+        if (!this.worldObj.isRemote && this.fallDistance > 3.0F && p_180433_3_)
+        {
+            IBlockState var6 = this.worldObj.getBlockState(p_180433_5_);
+            Block var7 = var6.getBlock();
+            float var8 = (float)MathHelper.ceiling_float_int(this.fallDistance - 3.0F);
+
+            if (var7.getMaterial() != Material.air)
+            {
+                double var9 = (double)Math.min(0.2F + var8 / 15.0F, 10.0F);
+
+                if (var9 > 2.5D)
+                {
+                    var9 = 2.5D;
+                }
+
+                int var11 = (int)(150.0D * var9);
+                ((WorldServer)this.worldObj).func_175739_a(EnumParticleTypes.BLOCK_DUST, this.posX, this.posY, this.posZ, var11, 0.0D, 0.0D, 0.0D, 0.15000000596046448D, new int[] {Block.getStateId(var6)});
+            }
+        }
+
+        super.func_180433_a(p_180433_1_, p_180433_3_, p_180433_4_, p_180433_5_);
+    }
+
+    public boolean canBreatheUnderwater()
+    {
+        return false;
+    }
+
+    /**
+     * Gets called every tick from main Entity class
+     */
+    public void onEntityUpdate()
+    {
+        this.prevSwingProgress = this.swingProgress;
+        super.onEntityUpdate();
+        this.worldObj.theProfiler.startSection("livingEntityBaseTick");
+        boolean var1 = this instanceof EntityPlayer;
+
+        if (this.isEntityAlive())
+        {
+            if (this.isEntityInsideOpaqueBlock())
+            {
+                this.attackEntityFrom(DamageSource.inWall, 1.0F);
+            }
+            else if (var1 && !this.worldObj.getWorldBorder().contains(this.getEntityBoundingBox()))
+            {
+                double var2 = this.worldObj.getWorldBorder().getClosestDistance(this) + this.worldObj.getWorldBorder().getDamageBuffer();
+
+                if (var2 < 0.0D)
+                {
+                    this.attackEntityFrom(DamageSource.inWall, (float)Math.max(1, MathHelper.floor_double(-var2 * this.worldObj.getWorldBorder().func_177727_n())));
+                }
+            }
+        }
+
+        if (this.isImmuneToFire() || this.worldObj.isRemote)
+        {
+            this.extinguish();
+        }
+
+        boolean var7 = var1 && ((EntityPlayer)this).capabilities.disableDamage;
+
+        if (this.isEntityAlive() && this.isInsideOfMaterial(Material.water))
+        {
+            if (!this.canBreatheUnderwater() && !this.isPotionActive(Potion.waterBreathing.id) && !var7)
+            {
+                this.setAir(this.decreaseAirSupply(this.getAir()));
+
+                if (this.getAir() == -20)
+                {
+                    this.setAir(0);
+
+                    for (int var3 = 0; var3 < 8; ++var3)
+                    {
+                        float var4 = this.rand.nextFloat() - this.rand.nextFloat();
+                        float var5 = this.rand.nextFloat() - this.rand.nextFloat();
+                        float var6 = this.rand.nextFloat() - this.rand.nextFloat();
+                        this.worldObj.spawnParticle(EnumParticleTypes.WATER_BUBBLE, this.posX + (double)var4, this.posY + (double)var5, this.posZ + (double)var6, this.motionX, this.motionY, this.motionZ, new int[0]);
+                    }
+
+                    this.attackEntityFrom(DamageSource.drown, 2.0F);
+                }
+            }
+
+            if (!this.worldObj.isRemote && this.isRiding() && this.ridingEntity instanceof EntityLivingBase)
+            {
+                this.mountEntity((Entity)null);
+            }
+        }
+        else
+        {
+            this.setAir(300);
+        }
+
+        if (this.isEntityAlive() && this.isWet())
+        {
+            this.extinguish();
+        }
+
+        this.prevCameraPitch = this.cameraPitch;
+
+        if (this.hurtTime > 0)
+        {
+            --this.hurtTime;
+        }
+
+        if (this.hurtResistantTime > 0 && !(this instanceof EntityPlayerMP))
+        {
+            --this.hurtResistantTime;
+        }
+
+        if (this.getHealth() <= 0.0F)
+        {
+            this.onDeathUpdate();
+        }
+
+        if (this.recentlyHit > 0)
+        {
+            --this.recentlyHit;
+        }
+        else
+        {
+            this.attackingPlayer = null;
+        }
+
+        if (this.lastAttacker != null && !this.lastAttacker.isEntityAlive())
+        {
+            this.lastAttacker = null;
+        }
+
+        if (this.entityLivingToAttack != null)
+        {
+            if (!this.entityLivingToAttack.isEntityAlive())
+            {
+                this.setRevengeTarget((EntityLivingBase)null);
+            }
+            else if (this.ticksExisted - this.revengeTimer > 100)
+            {
+                this.setRevengeTarget((EntityLivingBase)null);
+            }
+        }
+
+        this.updatePotionEffects();
+        this.field_70763_ax = this.field_70764_aw;
+        this.prevRenderYawOffset = this.renderYawOffset;
+        this.prevRotationYawHead = this.rotationYawHead;
+        this.prevRotationYaw = this.rotationYaw;
+        this.prevRotationPitch = this.rotationPitch;
+        this.worldObj.theProfiler.endSection();
+    }
+
+    /**
+     * If Animal, checks if the age timer is negative
+     */
+    public boolean isChild()
+    {
+        return false;
+    }
+
+    /**
+     * handles entity death timer, experience orb and particle creation
+     */
+    protected void onDeathUpdate()
+    {
+        ++this.deathTime;
+
+        if (this.deathTime == 20)
+        {
+            int var1;
+
+            if (!this.worldObj.isRemote && (this.recentlyHit > 0 || this.isPlayer()) && this.func_146066_aG() && this.worldObj.getGameRules().getGameRuleBooleanValue("doMobLoot"))
+            {
+                var1 = this.getExperiencePoints(this.attackingPlayer);
+
+                while (var1 > 0)
+                {
+                    int var2 = EntityXPOrb.getXPSplit(var1);
+                    var1 -= var2;
+                    this.worldObj.spawnEntityInWorld(new EntityXPOrb(this.worldObj, this.posX, this.posY, this.posZ, var2));
+                }
+            }
+
+            this.setDead();
+
+            for (var1 = 0; var1 < 20; ++var1)
+            {
+                double var8 = this.rand.nextGaussian() * 0.02D;
+                double var4 = this.rand.nextGaussian() * 0.02D;
+                double var6 = this.rand.nextGaussian() * 0.02D;
+                this.worldObj.spawnParticle(EnumParticleTypes.EXPLOSION_NORMAL, this.posX + (double)(this.rand.nextFloat() * this.width * 2.0F) - (double)this.width, this.posY + (double)(this.rand.nextFloat() * this.height), this.posZ + (double)(this.rand.nextFloat() * this.width * 2.0F) - (double)this.width, var8, var4, var6, new int[0]);
+            }
+        }
+    }
+
+    protected boolean func_146066_aG()
+    {
+        return !this.isChild();
+    }
+
+    /**
+     * Decrements the entity's air supply when underwater
+     */
+    protected int decreaseAirSupply(int p_70682_1_)
+    {
+        int var2 = EnchantmentHelper.func_180319_a(this);
+        return var2 > 0 && this.rand.nextInt(var2 + 1) > 0 ? p_70682_1_ : p_70682_1_ - 1;
+    }
+
+    /**
+     * Get the experience points the entity currently has.
+     */
+    protected int getExperiencePoints(EntityPlayer p_70693_1_)
+    {
+        return 0;
+    }
+
+    /**
+     * Only use is to identify if class is an instance of player for experience dropping
+     */
+    protected boolean isPlayer()
+    {
+        return false;
+    }
+
+    public Random getRNG()
+    {
+        return this.rand;
+    }
+
+    public EntityLivingBase getAITarget()
+    {
+        return this.entityLivingToAttack;
+    }
+
+    public int getRevengeTimer()
+    {
+        return this.revengeTimer;
+    }
+
+    public void setRevengeTarget(EntityLivingBase p_70604_1_)
+    {
+        this.entityLivingToAttack = p_70604_1_;
+        this.revengeTimer = this.ticksExisted;
+    }
+
+    public EntityLivingBase getLastAttacker()
+    {
+        return this.lastAttacker;
+    }
+
+    public int getLastAttackerTime()
+    {
+        return this.lastAttackerTime;
+    }
+
+    public void setLastAttacker(Entity p_130011_1_)
+    {
+        if (p_130011_1_ instanceof EntityLivingBase)
+        {
+            this.lastAttacker = (EntityLivingBase)p_130011_1_;
+        }
+        else
+        {
+            this.lastAttacker = null;
+        }
+
+        this.lastAttackerTime = this.ticksExisted;
+    }
+
+    public int getAge()
+    {
+        return this.entityAge;
+    }
+
+    /**
+     * (abstract) Protected helper method to write subclass entity data to NBT.
+     */
+    public void writeEntityToNBT(NBTTagCompound tagCompound)
+    {
+        tagCompound.setFloat("HealF", this.getHealth());
+        tagCompound.setShort("Health", (short)((int)Math.ceil((double)this.getHealth())));
+        tagCompound.setShort("HurtTime", (short)this.hurtTime);
+        tagCompound.setInteger("HurtByTimestamp", this.revengeTimer);
+        tagCompound.setShort("DeathTime", (short)this.deathTime);
+        tagCompound.setFloat("AbsorptionAmount", this.getAbsorptionAmount());
+        ItemStack[] var2 = this.getInventory();
+        int var3 = var2.length;
+        int var4;
+        ItemStack var5;
+
+        for (var4 = 0; var4 < var3; ++var4)
+        {
+            var5 = var2[var4];
+
+            if (var5 != null)
+            {
+                this.attributeMap.removeAttributeModifiers(var5.getAttributeModifiers());
+            }
+        }
+
+        tagCompound.setTag("Attributes", SharedMonsterAttributes.writeBaseAttributeMapToNBT(this.getAttributeMap()));
+        var2 = this.getInventory();
+        var3 = var2.length;
+
+        for (var4 = 0; var4 < var3; ++var4)
+        {
+            var5 = var2[var4];
+
+            if (var5 != null)
+            {
+                this.attributeMap.applyAttributeModifiers(var5.getAttributeModifiers());
+            }
+        }
+
+        if (!this.activePotionsMap.isEmpty())
+        {
+            NBTTagList var6 = new NBTTagList();
+            Iterator var7 = this.activePotionsMap.values().iterator();
+
+            while (var7.hasNext())
+            {
+                PotionEffect var8 = (PotionEffect)var7.next();
+                var6.appendTag(var8.writeCustomPotionEffectToNBT(new NBTTagCompound()));
+            }
+
+            tagCompound.setTag("ActiveEffects", var6);
+        }
+    }
+
+    /**
+     * (abstract) Protected helper method to read subclass entity data from NBT.
+     */
+    public void readEntityFromNBT(NBTTagCompound tagCompund)
+    {
+        this.setAbsorptionAmount(tagCompund.getFloat("AbsorptionAmount"));
+
+        if (tagCompund.hasKey("Attributes", 9) && this.worldObj != null && !this.worldObj.isRemote)
+        {
+            SharedMonsterAttributes.func_151475_a(this.getAttributeMap(), tagCompund.getTagList("Attributes", 10));
+        }
+
+        if (tagCompund.hasKey("ActiveEffects", 9))
+        {
+            NBTTagList var2 = tagCompund.getTagList("ActiveEffects", 10);
+
+            for (int var3 = 0; var3 < var2.tagCount(); ++var3)
+            {
+                NBTTagCompound var4 = var2.getCompoundTagAt(var3);
+                PotionEffect var5 = PotionEffect.readCustomPotionEffectFromNBT(var4);
+
+                if (var5 != null)
+                {
+                    this.activePotionsMap.put(Integer.valueOf(var5.getPotionID()), var5);
+                }
+            }
+        }
+
+        if (tagCompund.hasKey("HealF", 99))
+        {
+            this.setHealth(tagCompund.getFloat("HealF"));
+        }
+        else
+        {
+            NBTBase var6 = tagCompund.getTag("Health");
+
+            if (var6 == null)
+            {
+                this.setHealth(this.getMaxHealth());
+            }
+            else if (var6.getId() == 5)
+            {
+                this.setHealth(((NBTTagFloat)var6).getFloat());
+            }
+            else if (var6.getId() == 2)
+            {
+                this.setHealth((float)((NBTTagShort)var6).getShort());
+            }
+        }
+
+        this.hurtTime = tagCompund.getShort("HurtTime");
+        this.deathTime = tagCompund.getShort("DeathTime");
+        this.revengeTimer = tagCompund.getInteger("HurtByTimestamp");
+    }
+
+    protected void updatePotionEffects()
+    {
+        Iterator var1 = this.activePotionsMap.keySet().iterator();
+
+        while (var1.hasNext())
+        {
+            Integer var2 = (Integer)var1.next();
+            PotionEffect var3 = (PotionEffect)this.activePotionsMap.get(var2);
+
+            if (!var3.onUpdate(this))
+            {
+                if (!this.worldObj.isRemote)
+                {
+                    var1.remove();
+                    this.onFinishedPotionEffect(var3);
+                }
+            }
+            else if (var3.getDuration() % 600 == 0)
+            {
+                this.onChangedPotionEffect(var3, false);
+            }
+        }
+
+        if (this.potionsNeedUpdate)
+        {
+            if (!this.worldObj.isRemote)
+            {
+                this.func_175135_B();
+            }
+
+            this.potionsNeedUpdate = false;
+        }
+
+        int var11 = this.dataWatcher.getWatchableObjectInt(7);
+        boolean var12 = this.dataWatcher.getWatchableObjectByte(8) > 0;
+
+        if (var11 > 0)
+        {
+            boolean var4 = false;
+
+            if (!this.isInvisible())
+            {
+                var4 = this.rand.nextBoolean();
+            }
+            else
+            {
+                var4 = this.rand.nextInt(15) == 0;
+            }
+
+            if (var12)
+            {
+                var4 &= this.rand.nextInt(5) == 0;
+            }
+
+            if (var4 && var11 > 0)
+            {
+                double var5 = (double)(var11 >> 16 & 255) / 255.0D;
+                double var7 = (double)(var11 >> 8 & 255) / 255.0D;
+                double var9 = (double)(var11 >> 0 & 255) / 255.0D;
+                this.worldObj.spawnParticle(var12 ? EnumParticleTypes.SPELL_MOB_AMBIENT : EnumParticleTypes.SPELL_MOB, this.posX + (this.rand.nextDouble() - 0.5D) * (double)this.width, this.posY + this.rand.nextDouble() * (double)this.height, this.posZ + (this.rand.nextDouble() - 0.5D) * (double)this.width, var5, var7, var9, new int[0]);
+            }
+        }
+    }
+
+    protected void func_175135_B()
+    {
+        if (this.activePotionsMap.isEmpty())
+        {
+            this.func_175133_bi();
+            this.setInvisible(false);
+        }
+        else
+        {
+            int var1 = PotionHelper.calcPotionLiquidColor(this.activePotionsMap.values());
+            this.dataWatcher.updateObject(8, Byte.valueOf((byte)(PotionHelper.func_82817_b(this.activePotionsMap.values()) ? 1 : 0)));
+            this.dataWatcher.updateObject(7, Integer.valueOf(var1));
+            this.setInvisible(this.isPotionActive(Potion.invisibility.id));
+        }
+    }
+
+    protected void func_175133_bi()
+    {
+        this.dataWatcher.updateObject(8, Byte.valueOf((byte)0));
+        this.dataWatcher.updateObject(7, Integer.valueOf(0));
+    }
+
+    public void clearActivePotions()
+    {
+        Iterator var1 = this.activePotionsMap.keySet().iterator();
+
+        while (var1.hasNext())
+        {
+            Integer var2 = (Integer)var1.next();
+            PotionEffect var3 = (PotionEffect)this.activePotionsMap.get(var2);
+
+            if (!this.worldObj.isRemote)
+            {
+                var1.remove();
+                this.onFinishedPotionEffect(var3);
+            }
+        }
+    }
+
+    public Collection getActivePotionEffects()
+    {
+        return this.activePotionsMap.values();
+    }
+
+    public boolean isPotionActive(int p_82165_1_)
+    {
+        return this.activePotionsMap.containsKey(Integer.valueOf(p_82165_1_));
+    }
+
+    public boolean isPotionActive(Potion p_70644_1_)
+    {
+        return this.activePotionsMap.containsKey(Integer.valueOf(p_70644_1_.id));
+    }
+
+    /**
+     * returns the PotionEffect for the supplied Potion if it is active, null otherwise.
+     */
+    public PotionEffect getActivePotionEffect(Potion p_70660_1_)
+    {
+        return (PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70660_1_.id));
+    }
+
+    /**
+     * adds a PotionEffect to the entity
+     */
+    public void addPotionEffect(PotionEffect p_70690_1_)
+    {
+        if (this.isPotionApplicable(p_70690_1_))
+        {
+            if (this.activePotionsMap.containsKey(Integer.valueOf(p_70690_1_.getPotionID())))
+            {
+                ((PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70690_1_.getPotionID()))).combine(p_70690_1_);
+                this.onChangedPotionEffect((PotionEffect)this.activePotionsMap.get(Integer.valueOf(p_70690_1_.getPotionID())), true);
+            }
+            else
+            {
+                this.activePotionsMap.put(Integer.valueOf(p_70690_1_.getPotionID()), p_70690_1_);
+                this.onNewPotionEffect(p_70690_1_);
+            }
+        }
+    }
+
+    public boolean isPotionApplicable(PotionEffect p_70687_1_)
+    {
+        if (this.getCreatureAttribute() == EnumCreatureAttribute.UNDEAD)
+        {
+            int var2 = p_70687_1_.getPotionID();
+
+            if (var2 == Potion.regeneration.id || var2 == Potion.poison.id)
+            {
+                return false;
+            }
+        }
+
+        return true;
+    }
+
+    /**
+     * Returns true if this entity is undead.
+     */
+    public boolean isEntityUndead()
+    {
+        return this.getCreatureAttribute() == EnumCreatureAttribute.UNDEAD;
+    }
+
+    /**
+     * Remove the speified potion effect from this entity.
+     */
+    public void removePotionEffectClient(int p_70618_1_)
+    {
+        this.activePotionsMap.remove(Integer.valueOf(p_70618_1_));
+    }
+
+    /**
+     * Remove the specified potion effect from this entity.
+     */
+    public void removePotionEffect(int p_82170_1_)
+    {
+        PotionEffect var2 = (PotionEffect)this.activePotionsMap.remove(Integer.valueOf(p_82170_1_));
+
+        if (var2 != null)
+        {
+            this.onFinishedPotionEffect(var2);
+        }
+    }
+
+    protected void onNewPotionEffect(PotionEffect p_70670_1_)
+    {
+        this.potionsNeedUpdate = true;
+
+        if (!this.worldObj.isRemote)
+        {
+            Potion.potionTypes[p_70670_1_.getPotionID()].applyAttributesModifiersToEntity(this, this.getAttributeMap(), p_70670_1_.getAmplifier());
+        }
+    }
+
+    protected void onChangedPotionEffect(PotionEffect p_70695_1_, boolean p_70695_2_)
+    {
+        this.potionsNeedUpdate = true;
+
+        if (p_70695_2_ && !this.worldObj.isRemote)
+        {
+            Potion.potionTypes[p_70695_1_.getPotionID()].removeAttributesModifiersFromEntity(this, this.getAttributeMap(), p_70695_1_.getAmplifier());
+            Potion.potionTypes[p_70695_1_.getPotionID()].applyAttributesModifiersToEntity(this, this.getAttributeMap(), p_70695_1_.getAmplifier());
+        }
+    }
+
+    protected void onFinishedPotionEffect(PotionEffect p_70688_1_)
+    {
+        this.potionsNeedUpdate = true;
+
+        if (!this.worldObj.isRemote)
+        {
+            Potion.potionTypes[p_70688_1_.getPotionID()].removeAttributesModifiersFromEntity(this, this.getAttributeMap(), p_70688_1_.getAmplifier());
+        }
+    }
+
+    /**
+     * Heal living entity (param: amount of half-hearts)
+     */
+    public void heal(float p_70691_1_)
+    {
+        float var2 = this.getHealth();
+
+        if (var2 > 0.0F)
+        {
+            this.setHealth(var2 + p_70691_1_);
+        }
+    }
+
+    public final float getHealth()
+    {
+        return this.dataWatcher.getWatchableObjectFloat(6);
+    }
+
+    public void setHealth(float p_70606_1_)
+    {
+        this.dataWatcher.updateObject(6, Float.valueOf(MathHelper.clamp_float(p_70606_1_, 0.0F, this.getMaxHealth())));
+    }
+
+    /**
+     * Called when the entity is attacked.
+     */
+    public boolean attackEntityFrom(DamageSource source, float amount)
+    {
+        if (this.func_180431_b(source))
+        {
+            return false;
+        }
+        else if (this.worldObj.isRemote)
+        {
+            return false;
+        }
+        else
+        {
+            this.entityAge = 0;
+
+            if (this.getHealth() <= 0.0F)
+            {
+                return false;
+            }
+            else if (source.isFireDamage() && this.isPotionActive(Potion.fireResistance))
+            {
+                return false;
+            }
+            else
+            {
+                if ((source == DamageSource.anvil || source == DamageSource.fallingBlock) && this.getEquipmentInSlot(4) != null)
+                {
+                    this.getEquipmentInSlot(4).damageItem((int)(amount * 4.0F + this.rand.nextFloat() * amount * 2.0F), this);
+                    amount *= 0.75F;
+                }
+
+                this.limbSwingAmount = 1.5F;
+                boolean var3 = true;
+
+                if ((float)this.hurtResistantTime > (float)this.maxHurtResistantTime / 2.0F)
+                {
+                    if (amount <= this.lastDamage)
+                    {
+                        return false;
+                    }
+
+                    this.damageEntity(source, amount - this.lastDamage);
+                    this.lastDamage = amount;
+                    var3 = false;
+                }
+                else
+                {
+                    this.lastDamage = amount;
+                    this.hurtResistantTime = this.maxHurtResistantTime;
+                    this.damageEntity(source, amount);
+                    this.hurtTime = this.maxHurtTime = 10;
+                }
+
+                this.attackedAtYaw = 0.0F;
+                Entity var4 = source.getEntity();
+
+                if (var4 != null)
+                {
+                    if (var4 instanceof EntityLivingBase)
+                    {
+                        this.setRevengeTarget((EntityLivingBase)var4);
+                    }
+
+                    if (var4 instanceof EntityPlayer)
+                    {
+                        this.recentlyHit = 100;
+                        this.attackingPlayer = (EntityPlayer)var4;
+                    }
+                    else if (var4 instanceof EntityWolf)
+                    {
+                        EntityWolf var5 = (EntityWolf)var4;
+
+                        if (var5.isTamed())
+                        {
+                            this.recentlyHit = 100;
+                            this.attackingPlayer = null;
+                        }
+                    }
+                }
+
+                if (var3)
+                {
+                    this.worldObj.setEntityState(this, (byte)2);
+
+                    if (source != DamageSource.drown)
+                    {
+                        this.setBeenAttacked();
+                    }
+
+                    if (var4 != null)
+                    {
+                        double var9 = var4.posX - this.posX;
+                        double var7;
+
+                        for (var7 = var4.posZ - this.posZ; var9 * var9 + var7 * var7 < 1.0E-4D; var7 = (Math.random() - Math.random()) * 0.01D)
+                        {
+                            var9 = (Math.random() - Math.random()) * 0.01D;
+                        }
+
+                        this.attackedAtYaw = (float)(Math.atan2(var7, var9) * 180.0D / Math.PI - (double)this.rotationYaw);
+                        this.knockBack(var4, amount, var9, var7);
+                    }
+                    else
+                    {
+                        this.attackedAtYaw = (float)((int)(Math.random() * 2.0D) * 180);
+                    }
+                }
+
+                String var10;
+
+                if (this.getHealth() <= 0.0F)
+                {
+                    var10 = this.getDeathSound();
+
+                    if (var3 && var10 != null)
+                    {
+                        this.playSound(var10, this.getSoundVolume(), this.getSoundPitch());
+                    }
+
+                    this.onDeath(source);
+                }
+                else
+                {
+                    var10 = this.getHurtSound();
+
+                    if (var3 && var10 != null)
+                    {
+                        this.playSound(var10, this.getSoundVolume(), this.getSoundPitch());
+                    }
+                }
+
+                return true;
+            }
+        }
+    }
+
+    /**
+     * Renders broken item particles using the given ItemStack
+     */
+    public void renderBrokenItemStack(ItemStack p_70669_1_)
+    {
+        this.playSound("random.break", 0.8F, 0.8F + this.worldObj.rand.nextFloat() * 0.4F);
+
+        for (int var2 = 0; var2 < 5; ++var2)
+        {
+            Vec3 var3 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.1D, Math.random() * 0.1D + 0.1D, 0.0D);
+            var3 = var3.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
+            var3 = var3.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
+            double var4 = (double)(-this.rand.nextFloat()) * 0.6D - 0.3D;
+            Vec3 var6 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.3D, var4, 0.6D);
+            var6 = var6.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
+            var6 = var6.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
+            var6 = var6.addVector(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
+            this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var6.xCoord, var6.yCoord, var6.zCoord, var3.xCoord, var3.yCoord + 0.05D, var3.zCoord, new int[] {Item.getIdFromItem(p_70669_1_.getItem())});
+        }
+    }
+
+    /**
+     * Called when the mob's health reaches 0.
+     */
+    public void onDeath(DamageSource cause)
+    {
+        Entity var2 = cause.getEntity();
+        EntityLivingBase var3 = this.func_94060_bK();
+
+        if (this.scoreValue >= 0 && var3 != null)
+        {
+            var3.addToPlayerScore(this, this.scoreValue);
+        }
+
+        if (var2 != null)
+        {
+            var2.onKillEntity(this);
+        }
+
+        this.dead = true;
+        this.getCombatTracker().func_94549_h();
+
+        if (!this.worldObj.isRemote)
+        {
+            int var4 = 0;
+
+            if (var2 instanceof EntityPlayer)
+            {
+                var4 = EnchantmentHelper.getLootingModifier((EntityLivingBase)var2);
+            }
+
+            if (this.func_146066_aG() && this.worldObj.getGameRules().getGameRuleBooleanValue("doMobLoot"))
+            {
+                this.dropFewItems(this.recentlyHit > 0, var4);
+                this.dropEquipment(this.recentlyHit > 0, var4);
+
+                if (this.recentlyHit > 0 && this.rand.nextFloat() < 0.025F + (float)var4 * 0.01F)
+                {
+                    this.addRandomArmor();
+                }
+            }
+        }
+
+        this.worldObj.setEntityState(this, (byte)3);
+    }
+
+    /**
+     * Drop the equipment for this entity.
+     */
+    protected void dropEquipment(boolean p_82160_1_, int p_82160_2_) {}
+
+    /**
+     * knocks back this entity
+     */
+    public void knockBack(Entity p_70653_1_, float p_70653_2_, double p_70653_3_, double p_70653_5_)
+    {
+        if (this.rand.nextDouble() >= this.getEntityAttribute(SharedMonsterAttributes.knockbackResistance).getAttributeValue())
+        {
+            this.isAirBorne = true;
+            float var7 = MathHelper.sqrt_double(p_70653_3_ * p_70653_3_ + p_70653_5_ * p_70653_5_);
+            float var8 = 0.4F;
+            this.motionX /= 2.0D;
+            this.motionY /= 2.0D;
+            this.motionZ /= 2.0D;
+            this.motionX -= p_70653_3_ / (double)var7 * (double)var8;
+            this.motionY += (double)var8;
+            this.motionZ -= p_70653_5_ / (double)var7 * (double)var8;
+
+            if (this.motionY > 0.4000000059604645D)
+            {
+                this.motionY = 0.4000000059604645D;
+            }
+        }
+    }
+
+    /**
+     * Returns the sound this mob makes when it is hurt.
+     */
+    protected String getHurtSound()
+    {
+        return "game.neutral.hurt";
+    }
+
+    /**
+     * Returns the sound this mob makes on death.
+     */
+    protected String getDeathSound()
+    {
+        return "game.neutral.die";
+    }
+
+    /**
+     * Makes entity wear random armor based on difficulty
+     */
+    protected void addRandomArmor() {}
+
+    /**
+     * Drop 0-2 items of this living's type
+     */
+    protected void dropFewItems(boolean p_70628_1_, int p_70628_2_) {}
+
+    /**
+     * returns true if this entity is by a ladder, false otherwise
+     */
+    public boolean isOnLadder()
+    {
+        int var1 = MathHelper.floor_double(this.posX);
+        int var2 = MathHelper.floor_double(this.getEntityBoundingBox().minY);
+        int var3 = MathHelper.floor_double(this.posZ);
+        Block var4 = this.worldObj.getBlockState(new BlockPos(var1, var2, var3)).getBlock();
+        return (var4 == Blocks.ladder || var4 == Blocks.vine) && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).isSpectator());
+    }
+
+    /**
+     * Checks whether target entity is alive.
+     */
+    public boolean isEntityAlive()
+    {
+        return !this.isDead && this.getHealth() > 0.0F;
+    }
+
+    public void fall(float distance, float damageMultiplier)
+    {
+        super.fall(distance, damageMultiplier);
+        PotionEffect var3 = this.getActivePotionEffect(Potion.jump);
+        float var4 = var3 != null ? (float)(var3.getAmplifier() + 1) : 0.0F;
+        int var5 = MathHelper.ceiling_float_int((distance - 3.0F - var4) * damageMultiplier);
+
+        if (var5 > 0)
+        {
+            this.playSound(this.func_146067_o(var5), 1.0F, 1.0F);
+            this.attackEntityFrom(DamageSource.fall, (float)var5);
+            int var6 = MathHelper.floor_double(this.posX);
+            int var7 = MathHelper.floor_double(this.posY - 0.20000000298023224D);
+            int var8 = MathHelper.floor_double(this.posZ);
+            Block var9 = this.worldObj.getBlockState(new BlockPos(var6, var7, var8)).getBlock();
+
+            if (var9.getMaterial() != Material.air)
+            {
+                Block.SoundType var10 = var9.stepSound;
+                this.playSound(var10.getStepSound(), var10.getVolume() * 0.5F, var10.getFrequency() * 0.75F);
+            }
+        }
+    }
+
+    protected String func_146067_o(int p_146067_1_)
+    {
+        return p_146067_1_ > 4 ? "game.neutral.hurt.fall.big" : "game.neutral.hurt.fall.small";
+    }
+
+    /**
+     * Setups the entity to do the hurt animation. Only used by packets in multiplayer.
+     */
+    public void performHurtAnimation()
+    {
+        this.hurtTime = this.maxHurtTime = 10;
+        this.attackedAtYaw = 0.0F;
+    }
+
+    /**
+     * Returns the current armor value as determined by a call to InventoryPlayer.getTotalArmorValue
+     */
+    public int getTotalArmorValue()
+    {
+        int var1 = 0;
+        ItemStack[] var2 = this.getInventory();
+        int var3 = var2.length;
+
+        for (int var4 = 0; var4 < var3; ++var4)
+        {
+            ItemStack var5 = var2[var4];
+
+            if (var5 != null && var5.getItem() instanceof ItemArmor)
+            {
+                int var6 = ((ItemArmor)var5.getItem()).damageReduceAmount;
+                var1 += var6;
+            }
+        }
+
+        return var1;
+    }
+
+    protected void damageArmor(float p_70675_1_) {}
+
+    /**
+     * Reduces damage, depending on armor
+     */
+    protected float applyArmorCalculations(DamageSource p_70655_1_, float p_70655_2_)
+    {
+        if (!p_70655_1_.isUnblockable())
+        {
+            int var3 = 25 - this.getTotalArmorValue();
+            float var4 = p_70655_2_ * (float)var3;
+            this.damageArmor(p_70655_2_);
+            p_70655_2_ = var4 / 25.0F;
+        }
+
+        return p_70655_2_;
+    }
+
+    /**
+     * Reduces damage, depending on potions
+     */
+    protected float applyPotionDamageCalculations(DamageSource p_70672_1_, float p_70672_2_)
+    {
+        if (p_70672_1_.isDamageAbsolute())
+        {
+            return p_70672_2_;
+        }
+        else
+        {
+            int var3;
+            int var4;
+            float var5;
+
+            if (this.isPotionActive(Potion.resistance) && p_70672_1_ != DamageSource.outOfWorld)
+            {
+                var3 = (this.getActivePotionEffect(Potion.resistance).getAmplifier() + 1) * 5;
+                var4 = 25 - var3;
+                var5 = p_70672_2_ * (float)var4;
+                p_70672_2_ = var5 / 25.0F;
+            }
+
+            if (p_70672_2_ <= 0.0F)
+            {
+                return 0.0F;
+            }
+            else
+            {
+                var3 = EnchantmentHelper.getEnchantmentModifierDamage(this.getInventory(), p_70672_1_);
+
+                if (var3 > 20)
+                {
+                    var3 = 20;
+                }
+
+                if (var3 > 0 && var3 <= 20)
+                {
+                    var4 = 25 - var3;
+                    var5 = p_70672_2_ * (float)var4;
+                    p_70672_2_ = var5 / 25.0F;
+                }
+
+                return p_70672_2_;
+            }
+        }
+    }
+
+    /**
+     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
+     * second with the reduced value. Args: damageAmount
+     */
+    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
+    {
+        if (!this.func_180431_b(p_70665_1_))
+        {
+            p_70665_2_ = this.applyArmorCalculations(p_70665_1_, p_70665_2_);
+            p_70665_2_ = this.applyPotionDamageCalculations(p_70665_1_, p_70665_2_);
+            float var3 = p_70665_2_;
+            p_70665_2_ = Math.max(p_70665_2_ - this.getAbsorptionAmount(), 0.0F);
+            this.setAbsorptionAmount(this.getAbsorptionAmount() - (var3 - p_70665_2_));
+
+            if (p_70665_2_ != 0.0F)
+            {
+                float var4 = this.getHealth();
+                this.setHealth(var4 - p_70665_2_);
+                this.getCombatTracker().func_94547_a(p_70665_1_, var4, p_70665_2_);
+                this.setAbsorptionAmount(this.getAbsorptionAmount() - p_70665_2_);
+            }
+        }
+    }
+
+    public CombatTracker getCombatTracker()
+    {
+        return this._combatTracker;
+    }
+
+    public EntityLivingBase func_94060_bK()
+    {
+        return (EntityLivingBase)(this._combatTracker.func_94550_c() != null ? this._combatTracker.func_94550_c() : (this.attackingPlayer != null ? this.attackingPlayer : (this.entityLivingToAttack != null ? this.entityLivingToAttack : null)));
+    }
+
+    public final float getMaxHealth()
+    {
+        return (float)this.getEntityAttribute(SharedMonsterAttributes.maxHealth).getAttributeValue();
+    }
+
+    /**
+     * counts the amount of arrows stuck in the entity. getting hit by arrows increases this, used in rendering
+     */
+    public final int getArrowCountInEntity()
+    {
+        return this.dataWatcher.getWatchableObjectByte(9);
+    }
+
+    /**
+     * sets the amount of arrows stuck in the entity. used for rendering those
+     */
+    public final void setArrowCountInEntity(int p_85034_1_)
+    {
+        this.dataWatcher.updateObject(9, Byte.valueOf((byte)p_85034_1_));
+    }
+
+    /**
+     * Returns an integer indicating the end point of the swing animation, used by {@link #swingProgress} to provide a
+     * progress indicator. Takes dig speed enchantments into account.
+     */
+    private int getArmSwingAnimationEnd()
+    {
+        return this.isPotionActive(Potion.digSpeed) ? 6 - (1 + this.getActivePotionEffect(Potion.digSpeed).getAmplifier()) * 1 : (this.isPotionActive(Potion.digSlowdown) ? 6 + (1 + this.getActivePotionEffect(Potion.digSlowdown).getAmplifier()) * 2 : 6);
+    }
+
+    /**
+     * Swings the item the player is holding.
+     */
+    public void swingItem()
+    {
+        if (!this.isSwingInProgress || this.swingProgressInt >= this.getArmSwingAnimationEnd() / 2 || this.swingProgressInt < 0)
+        {
+            this.swingProgressInt = -1;
+            this.isSwingInProgress = true;
+
+            if (this.worldObj instanceof WorldServer)
+            {
+                ((WorldServer)this.worldObj).getEntityTracker().sendToAllTrackingEntity(this, new S0BPacketAnimation(this, 0));
+            }
+        }
+    }
+
+    public void handleHealthUpdate(byte p_70103_1_)
+    {
+        String var2;
+
+        if (p_70103_1_ == 2)
+        {
+            this.limbSwingAmount = 1.5F;
+            this.hurtResistantTime = this.maxHurtResistantTime;
+            this.hurtTime = this.maxHurtTime = 10;
+            this.attackedAtYaw = 0.0F;
+            var2 = this.getHurtSound();
+
+            if (var2 != null)
+            {
+                this.playSound(this.getHurtSound(), this.getSoundVolume(), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
+            }
+
+            this.attackEntityFrom(DamageSource.generic, 0.0F);
+        }
+        else if (p_70103_1_ == 3)
+        {
+            var2 = this.getDeathSound();
+
+            if (var2 != null)
+            {
+                this.playSound(this.getDeathSound(), this.getSoundVolume(), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
+            }
+
+            this.setHealth(0.0F);
+            this.onDeath(DamageSource.generic);
+        }
+        else
+        {
+            super.handleHealthUpdate(p_70103_1_);
+        }
+    }
+
+    /**
+     * sets the dead flag. Used when you fall off the bottom of the world.
+     */
+    protected void kill()
+    {
+        this.attackEntityFrom(DamageSource.outOfWorld, 4.0F);
+    }
+
+    /**
+     * Updates the arm swing progress counters and animation progress
+     */
+    protected void updateArmSwingProgress()
+    {
+        int var1 = this.getArmSwingAnimationEnd();
+
+        if (this.isSwingInProgress)
+        {
+            ++this.swingProgressInt;
+
+            if (this.swingProgressInt >= var1)
+            {
+                this.swingProgressInt = 0;
+                this.isSwingInProgress = false;
+            }
+        }
+        else
+        {
+            this.swingProgressInt = 0;
+        }
+
+        this.swingProgress = (float)this.swingProgressInt / (float)var1;
+    }
+
+    public IAttributeInstance getEntityAttribute(IAttribute p_110148_1_)
+    {
+        return this.getAttributeMap().getAttributeInstance(p_110148_1_);
+    }
+
+    public BaseAttributeMap getAttributeMap()
+    {
+        if (this.attributeMap == null)
+        {
+            this.attributeMap = new ServersideAttributeMap();
+        }
+
+        return this.attributeMap;
+    }
+
+    /**
+     * Get this Entity's EnumCreatureAttribute
+     */
+    public EnumCreatureAttribute getCreatureAttribute()
+    {
+        return EnumCreatureAttribute.UNDEFINED;
+    }
+
+    /**
+     * Returns the item that this EntityLiving is holding, if any.
+     */
+    public abstract ItemStack getHeldItem();
+
+    /**
+     * 0: Tool in Hand; 1-4: Armor
+     */
+    public abstract ItemStack getEquipmentInSlot(int p_71124_1_);
+
+    public abstract ItemStack getCurrentArmor(int p_82169_1_);
+
+    /**
+     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
+     */
+    public abstract void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn);
+
+    /**
+     * Set sprinting switch for Entity.
+     */
+    public void setSprinting(boolean sprinting)
+    {
+        super.setSprinting(sprinting);
+        IAttributeInstance var2 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
+
+        if (var2.getModifier(sprintingSpeedBoostModifierUUID) != null)
+        {
+            var2.removeModifier(sprintingSpeedBoostModifier);
+        }
+
+        if (sprinting)
+        {
+            var2.applyModifier(sprintingSpeedBoostModifier);
+        }
+    }
+
+    /**
+     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
+     */
+    public abstract ItemStack[] getInventory();
+
+    /**
+     * Returns the volume for the sounds this mob makes.
+     */
+    protected float getSoundVolume()
+    {
+        return 1.0F;
+    }
+
+    /**
+     * Gets the pitch of living sounds in living entities.
+     */
+    protected float getSoundPitch()
+    {
+        return this.isChild() ? (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.5F : (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F;
+    }
+
+    /**
+     * Dead and sleeping entities cannot move
+     */
+    protected boolean isMovementBlocked()
+    {
+        return this.getHealth() <= 0.0F;
+    }
+
+    /**
+     * Moves the entity to a position out of the way of its mount.
+     */
+    public void dismountEntity(Entity p_110145_1_)
+    {
+        double var3 = p_110145_1_.posX;
+        double var5 = p_110145_1_.getEntityBoundingBox().minY + (double)p_110145_1_.height;
+        double var7 = p_110145_1_.posZ;
+        byte var9 = 1;
+
+        for (int var10 = -var9; var10 <= var9; ++var10)
+        {
+            for (int var11 = -var9; var11 < var9; ++var11)
+            {
+                if (var10 != 0 || var11 != 0)
+                {
+                    int var12 = (int)(this.posX + (double)var10);
+                    int var13 = (int)(this.posZ + (double)var11);
+                    AxisAlignedBB var2 = this.getEntityBoundingBox().offset((double)var10, 1.0D, (double)var11);
+
+                    if (this.worldObj.func_147461_a(var2).isEmpty())
+                    {
+                        if (World.doesBlockHaveSolidTopSurface(this.worldObj, new BlockPos(var12, (int)this.posY, var13)))
+                        {
+                            this.setPositionAndUpdate(this.posX + (double)var10, this.posY + 1.0D, this.posZ + (double)var11);
+                            return;
+                        }
+
+                        if (World.doesBlockHaveSolidTopSurface(this.worldObj, new BlockPos(var12, (int)this.posY - 1, var13)) || this.worldObj.getBlockState(new BlockPos(var12, (int)this.posY - 1, var13)).getBlock().getMaterial() == Material.water)
+                        {
+                            var3 = this.posX + (double)var10;
+                            var5 = this.posY + 1.0D;
+                            var7 = this.posZ + (double)var11;
+                        }
+                    }
+                }
+            }
+        }
+
+        this.setPositionAndUpdate(var3, var5, var7);
+    }
+
+    public boolean getAlwaysRenderNameTagForRender()
+    {
+        return false;
+    }
+
+    protected float func_175134_bD()
+    {
+        return 0.42F;
+    }
+
+    /**
+     * Causes this entity to do an upwards motion (jumping).
+     */
+    protected void jump()
+    {
+    	//TODO: Client
+        this.motionY = WurstClient.INSTANCE.modManager.getModByClass(HighJumpMod.class).isEnabled() ? (double)this.func_175134_bD() * HighJumpMod.jumpHeight : (double)this.func_175134_bD();
+
+        if (this.isPotionActive(Potion.jump))
+        {
+            this.motionY += (double)((float)(this.getActivePotionEffect(Potion.jump).getAmplifier() + 1) * 0.1F);
+        }
+
+        if (this.isSprinting())
+        {
+            float var1 = this.rotationYaw * 0.017453292F;
+            this.motionX -= (double)(MathHelper.sin(var1) * 0.2F);
+            this.motionZ += (double)(MathHelper.cos(var1) * 0.2F);
+        }
+
+        this.isAirBorne = true;
+    }
+
+    /**
+     * main AI tick function, replaces updateEntityActionState
+     */
+    protected void updateAITick()
+    {
+        this.motionY += 0.03999999910593033D;
+    }
+
+    protected void func_180466_bG()
+    {
+        this.motionY += 0.03999999910593033D;
+    }
+
+    /**
+     * Moves the entity based on the specified heading.  Args: strafe, forward
+     */
+    public void moveEntityWithHeading(float p_70612_1_, float p_70612_2_)
+    {
+        double var8;
+        float var10;
+
+        if (this.isServerWorld())
+        {
+            float var5;
+            float var6;
+
+            //TODO: Client
+            if (this.isInWater() && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).capabilities.isFlying)
+            	&& !WurstClient.INSTANCE.modManager.getModByClass(NoSlowdownMod.class).isEnabled())
+            {
+                var8 = this.posY;
+                var5 = 0.8F;
+                var6 = 0.02F;
+                var10 = (float)EnchantmentHelper.func_180318_b(this);
+
+                if (var10 > 3.0F)
+                {
+                    var10 = 3.0F;
+                }
+
+                if (!this.onGround)
+                {
+                    var10 *= 0.5F;
+                }
+
+                if (var10 > 0.0F)
+                {
+                    var5 += (0.54600006F - var5) * var10 / 3.0F;
+                    var6 += (this.getAIMoveSpeed() * 1.0F - var6) * var10 / 3.0F;
+                }
+
+                this.moveFlying(p_70612_1_, p_70612_2_, var6);
+                this.moveEntity(this.motionX, this.motionY, this.motionZ);
+                this.motionX *= (double)var5;
+                this.motionY *= 0.800000011920929D;
+                this.motionZ *= (double)var5;
+                this.motionY -= 0.02D;
+
+                if (this.isCollidedHorizontally && this.isOffsetPositionInLiquid(this.motionX, this.motionY + 0.6000000238418579D - this.posY + var8, this.motionZ))
+                {
+                    this.motionY = 0.30000001192092896D;
+                }
+            }
+            else if (this.func_180799_ab() && (!(this instanceof EntityPlayer) || !((EntityPlayer)this).capabilities.isFlying))
+            {
+                var8 = this.posY;
+                this.moveFlying(p_70612_1_, p_70612_2_, 0.02F);
+                this.moveEntity(this.motionX, this.motionY, this.motionZ);
+                this.motionX *= 0.5D;
+                this.motionY *= 0.5D;
+                this.motionZ *= 0.5D;
+                this.motionY -= 0.02D;
+
+                if (this.isCollidedHorizontally && this.isOffsetPositionInLiquid(this.motionX, this.motionY + 0.6000000238418579D - this.posY + var8, this.motionZ))
+                {
+                    this.motionY = 0.30000001192092896D;
+                }
+            }
+            else
+            {
+                float var3 = 0.91F;
+
+                if (this.onGround)
+                {
+                    var3 = this.worldObj.getBlockState(new BlockPos(MathHelper.floor_double(this.posX), MathHelper.floor_double(this.getEntityBoundingBox().minY) - 1, MathHelper.floor_double(this.posZ))).getBlock().slipperiness * 0.91F;
+                }
+
+                float var4 = 0.16277136F / (var3 * var3 * var3);
+
+                if (this.onGround)
+                {
+                    var5 = this.getAIMoveSpeed() * var4;
+                }
+                else
+                {
+                    var5 = this.jumpMovementFactor;
+                }
+
+                this.moveFlying(p_70612_1_, p_70612_2_, var5);
+                var3 = 0.91F;
+
+                if (this.onGround)
+                {
+                    var3 = this.worldObj.getBlockState(new BlockPos(MathHelper.floor_double(this.posX), MathHelper.floor_double(this.getEntityBoundingBox().minY) - 1, MathHelper.floor_double(this.posZ))).getBlock().slipperiness * 0.91F;
+                }
+
+                if (this.isOnLadder())
+                {
+                    var6 = 0.15F;
+                    this.motionX = MathHelper.clamp_double(this.motionX, (double)(-var6), (double)var6);
+                    this.motionZ = MathHelper.clamp_double(this.motionZ, (double)(-var6), (double)var6);
+                    this.fallDistance = 0.0F;
+
+                    if (this.motionY < -0.15D)
+                    {
+                        this.motionY = -0.15D;
+                    }
+
+                    boolean var7 = this.isSneaking() && this instanceof EntityPlayer;
+
+                    if (var7 && this.motionY < 0.0D)
+                    {
+                        this.motionY = 0.0D;
+                    }
+                }
+
+                this.moveEntity(this.motionX, this.motionY, this.motionZ);
+
+                if (this.isCollidedHorizontally && this.isOnLadder())
+                {
+                    this.motionY = 0.2D;
+                }
+
+                if (this.worldObj.isRemote && (!this.worldObj.isBlockLoaded(new BlockPos((int)this.posX, 0, (int)this.posZ)) || !this.worldObj.getChunkFromBlockCoords(new BlockPos((int)this.posX, 0, (int)this.posZ)).isLoaded()))
+                {
+                    if (this.posY > 0.0D)
+                    {
+                        this.motionY = -0.1D;
+                    }
+                    else
+                    {
+                        this.motionY = 0.0D;
+                    }
+                }
+                else
+                {
+                    this.motionY -= 0.08D;
+                }
+
+                this.motionY *= 0.9800000190734863D;
+                this.motionX *= (double)var3;
+                this.motionZ *= (double)var3;
+            }
+        }
+
+        this.prevLimbSwingAmount = this.limbSwingAmount;
+        var8 = this.posX - this.prevPosX;
+        double var9 = this.posZ - this.prevPosZ;
+        var10 = MathHelper.sqrt_double(var8 * var8 + var9 * var9) * 4.0F;
+
+        if (var10 > 1.0F)
+        {
+            var10 = 1.0F;
+        }
+
+        this.limbSwingAmount += (var10 - this.limbSwingAmount) * 0.4F;
+        this.limbSwing += this.limbSwingAmount;
+    }
+
+    /**
+     * the movespeed used for the new AI system
+     */
+    public float getAIMoveSpeed()
+    {
+        return this.landMovementFactor;
+    }
+
+    /**
+     * set the movespeed used for the new AI system
+     */
+    public void setAIMoveSpeed(float p_70659_1_)
+    {
+        this.landMovementFactor = p_70659_1_;
+    }
+
+    public boolean attackEntityAsMob(Entity p_70652_1_)
+    {
+        this.setLastAttacker(p_70652_1_);
+        return false;
+    }
+
+    /**
+     * Returns whether player is sleeping or not
+     */
+    public boolean isPlayerSleeping()
+    {
+        return false;
+    }
+
+    /**
+     * Called to update the entity's position/logic.
+     */
+    public void onUpdate()
+    {
+        super.onUpdate();
+
+        if (!this.worldObj.isRemote)
+        {
+            int var1 = this.getArrowCountInEntity();
+
+            if (var1 > 0)
+            {
+                if (this.arrowHitTimer <= 0)
+                {
+                    this.arrowHitTimer = 20 * (30 - var1);
+                }
+
+                --this.arrowHitTimer;
+
+                if (this.arrowHitTimer <= 0)
+                {
+                    this.setArrowCountInEntity(var1 - 1);
+                }
+            }
+
+            for (int var2 = 0; var2 < 5; ++var2)
+            {
+                ItemStack var3 = this.previousEquipment[var2];
+                ItemStack var4 = this.getEquipmentInSlot(var2);
+
+                if (!ItemStack.areItemStacksEqual(var4, var3))
+                {
+                    ((WorldServer)this.worldObj).getEntityTracker().sendToAllTrackingEntity(this, new S04PacketEntityEquipment(this.getEntityId(), var2, var4));
+
+                    if (var3 != null)
+                    {
+                        this.attributeMap.removeAttributeModifiers(var3.getAttributeModifiers());
+                    }
+
+                    if (var4 != null)
+                    {
+                        this.attributeMap.applyAttributeModifiers(var4.getAttributeModifiers());
+                    }
+
+                    this.previousEquipment[var2] = var4 == null ? null : var4.copy();
+                }
+            }
+
+            if (this.ticksExisted % 20 == 0)
+            {
+                this.getCombatTracker().func_94549_h();
+            }
+        }
+
+        this.onLivingUpdate();
+        double var9 = this.posX - this.prevPosX;
+        double var10 = this.posZ - this.prevPosZ;
+        float var5 = (float)(var9 * var9 + var10 * var10);
+        float var6 = this.renderYawOffset;
+        float var7 = 0.0F;
+        this.field_70768_au = this.field_110154_aX;
+        float var8 = 0.0F;
+
+        if (var5 > 0.0025000002F)
+        {
+            var8 = 1.0F;
+            var7 = (float)Math.sqrt((double)var5) * 3.0F;
+            var6 = (float)Math.atan2(var10, var9) * 180.0F / (float)Math.PI - 90.0F;
+        }
+
+        if (this.swingProgress > 0.0F)
+        {
+            var6 = this.rotationYaw;
+        }
+
+        if (!this.onGround)
+        {
+            var8 = 0.0F;
+        }
+
+        this.field_110154_aX += (var8 - this.field_110154_aX) * 0.3F;
+        this.worldObj.theProfiler.startSection("headTurn");
+        var7 = this.func_110146_f(var6, var7);
+        this.worldObj.theProfiler.endSection();
+        this.worldObj.theProfiler.startSection("rangeChecks");
+
+        while (this.rotationYaw - this.prevRotationYaw < -180.0F)
+        {
+            this.prevRotationYaw -= 360.0F;
+        }
+
+        while (this.rotationYaw - this.prevRotationYaw >= 180.0F)
+        {
+            this.prevRotationYaw += 360.0F;
+        }
+
+        while (this.renderYawOffset - this.prevRenderYawOffset < -180.0F)
+        {
+            this.prevRenderYawOffset -= 360.0F;
+        }
+
+        while (this.renderYawOffset - this.prevRenderYawOffset >= 180.0F)
+        {
+            this.prevRenderYawOffset += 360.0F;
+        }
+
+        while (this.rotationPitch - this.prevRotationPitch < -180.0F)
+        {
+            this.prevRotationPitch -= 360.0F;
+        }
+
+        while (this.rotationPitch - this.prevRotationPitch >= 180.0F)
+        {
+            this.prevRotationPitch += 360.0F;
+        }
+
+        while (this.rotationYawHead - this.prevRotationYawHead < -180.0F)
+        {
+            this.prevRotationYawHead -= 360.0F;
+        }
+
+        while (this.rotationYawHead - this.prevRotationYawHead >= 180.0F)
+        {
+            this.prevRotationYawHead += 360.0F;
+        }
+
+        this.worldObj.theProfiler.endSection();
+        this.field_70764_aw += var7;
+    }
+
+    protected float func_110146_f(float p_110146_1_, float p_110146_2_)
+    {
+        float var3 = MathHelper.wrapAngleTo180_float(p_110146_1_ - this.renderYawOffset);
+        this.renderYawOffset += var3 * 0.3F;
+        float var4 = MathHelper.wrapAngleTo180_float(this.rotationYaw - this.renderYawOffset);
+        boolean var5 = var4 < -90.0F || var4 >= 90.0F;
+
+        if (var4 < -75.0F)
+        {
+            var4 = -75.0F;
+        }
+
+        if (var4 >= 75.0F)
+        {
+            var4 = 75.0F;
+        }
+
+        this.renderYawOffset = this.rotationYaw - var4;
+
+        if (var4 * var4 > 2500.0F)
+        {
+            this.renderYawOffset += var4 * 0.2F;
+        }
+
+        if (var5)
+        {
+            p_110146_2_ *= -1.0F;
+        }
+
+        return p_110146_2_;
+    }
+
+    /**
+     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
+     * use this to react to sunlight and start to burn.
+     */
+    public void onLivingUpdate()
+    {
+        if (this.jumpTicks > 0)
+        {
+            --this.jumpTicks;
+        }
+
+        if (this.newPosRotationIncrements > 0)
+        {
+            double var1 = this.posX + (this.newPosX - this.posX) / (double)this.newPosRotationIncrements;
+            double var3 = this.posY + (this.newPosY - this.posY) / (double)this.newPosRotationIncrements;
+            double var5 = this.posZ + (this.newPosZ - this.posZ) / (double)this.newPosRotationIncrements;
+            double var7 = MathHelper.wrapAngleTo180_double(this.newRotationYaw - (double)this.rotationYaw);
+            this.rotationYaw = (float)((double)this.rotationYaw + var7 / (double)this.newPosRotationIncrements);
+            this.rotationPitch = (float)((double)this.rotationPitch + (this.newRotationPitch - (double)this.rotationPitch) / (double)this.newPosRotationIncrements);
+            --this.newPosRotationIncrements;
+            this.setPosition(var1, var3, var5);
+            this.setRotation(this.rotationYaw, this.rotationPitch);
+        }
+        else if (!this.isServerWorld())
+        {
+            this.motionX *= 0.98D;
+            this.motionY *= 0.98D;
+            this.motionZ *= 0.98D;
+        }
+
+        if (Math.abs(this.motionX) < 0.005D)
+        {
+            this.motionX = 0.0D;
+        }
+
+        if (Math.abs(this.motionY) < 0.005D)
+        {
+            this.motionY = 0.0D;
+        }
+
+        if (Math.abs(this.motionZ) < 0.005D)
+        {
+            this.motionZ = 0.0D;
+        }
+
+        this.worldObj.theProfiler.startSection("ai");
+
+        if (this.isMovementBlocked())
+        {
+            this.isJumping = false;
+            this.moveStrafing = 0.0F;
+            this.moveForward = 0.0F;
+            this.randomYawVelocity = 0.0F;
+        }
+        else if (this.isServerWorld())
+        {
+            this.worldObj.theProfiler.startSection("newAi");
+            this.updateEntityActionState();
+            this.worldObj.theProfiler.endSection();
+        }
+
+        this.worldObj.theProfiler.endSection();
+        this.worldObj.theProfiler.startSection("jump");
+
+        if (this.isJumping)
+        {
+            if (this.isInWater())
+            {
+                this.updateAITick();
+            }
+            else if (this.func_180799_ab())
+            {
+                this.func_180466_bG();
+            }
+            else if (this.onGround && this.jumpTicks == 0)
+            {
+                this.jump();
+                this.jumpTicks = 10;
+            }
+        }
+        else
+        {
+            this.jumpTicks = 0;
+        }
+
+        this.worldObj.theProfiler.endSection();
+        this.worldObj.theProfiler.startSection("travel");
+        this.moveStrafing *= 0.98F;
+        this.moveForward *= 0.98F;
+        this.randomYawVelocity *= 0.9F;
+        this.moveEntityWithHeading(this.moveStrafing, this.moveForward);
+        this.worldObj.theProfiler.endSection();
+        this.worldObj.theProfiler.startSection("push");
+
+        if (!this.worldObj.isRemote)
+        {
+            this.collideWithNearbyEntities();
+        }
+
+        this.worldObj.theProfiler.endSection();
+    }
+
+    protected void updateEntityActionState() {}
+
+    protected void collideWithNearbyEntities()
+    {
+        List var1 = this.worldObj.getEntitiesWithinAABBExcludingEntity(this, this.getEntityBoundingBox().expand(0.20000000298023224D, 0.0D, 0.20000000298023224D));
+
+        if (var1 != null && !var1.isEmpty())
+        {
+            for (int var2 = 0; var2 < var1.size(); ++var2)
+            {
+                Entity var3 = (Entity)var1.get(var2);
+
+                if (var3.canBePushed())
+                {
+                    this.collideWithEntity(var3);
+                }
+            }
+        }
+    }
+
+    protected void collideWithEntity(Entity p_82167_1_)
+    {
+        p_82167_1_.applyEntityCollision(this);
+    }
+
+    /**
+     * Called when a player mounts an entity. e.g. mounts a pig, mounts a boat.
+     */
+    public void mountEntity(Entity entityIn)
+    {
+        if (this.ridingEntity != null && entityIn == null)
+        {
+            if (!this.worldObj.isRemote)
+            {
+                this.dismountEntity(this.ridingEntity);
+            }
+
+            if (this.ridingEntity != null)
+            {
+                this.ridingEntity.riddenByEntity = null;
+            }
+
+            this.ridingEntity = null;
+        }
+        else
+        {
+            super.mountEntity(entityIn);
+        }
+    }
+
+    /**
+     * Handles updating while being ridden by an entity
+     */
+    public void updateRidden()
+    {
+        super.updateRidden();
+        this.field_70768_au = this.field_110154_aX;
+        this.field_110154_aX = 0.0F;
+        this.fallDistance = 0.0F;
+    }
+
+    public void func_180426_a(double p_180426_1_, double p_180426_3_, double p_180426_5_, float p_180426_7_, float p_180426_8_, int p_180426_9_, boolean p_180426_10_)
+    {
+        this.newPosX = p_180426_1_;
+        this.newPosY = p_180426_3_;
+        this.newPosZ = p_180426_5_;
+        this.newRotationYaw = (double)p_180426_7_;
+        this.newRotationPitch = (double)p_180426_8_;
+        this.newPosRotationIncrements = p_180426_9_;
+    }
+
+    public void setJumping(boolean p_70637_1_)
+    {
+        this.isJumping = p_70637_1_;
+    }
+
+    /**
+     * Called whenever an item is picked up from walking over it. Args: pickedUpEntity, stackSize
+     */
+    public void onItemPickup(Entity p_71001_1_, int p_71001_2_)
+    {
+        if (!p_71001_1_.isDead && !this.worldObj.isRemote)
+        {
+            EntityTracker var3 = ((WorldServer)this.worldObj).getEntityTracker();
+
+            if (p_71001_1_ instanceof EntityItem)
+            {
+                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
+            }
+
+            if (p_71001_1_ instanceof EntityArrow)
+            {
+                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
+            }
+
+            if (p_71001_1_ instanceof EntityXPOrb)
+            {
+                var3.sendToAllTrackingEntity(p_71001_1_, new S0DPacketCollectItem(p_71001_1_.getEntityId(), this.getEntityId()));
+            }
+        }
+    }
+
+    /**
+     * returns true if the entity provided in the argument can be seen. (Raytrace)
+     */
+    public boolean canEntityBeSeen(Entity p_70685_1_)
+    {
+        return this.worldObj.rayTraceBlocks(new Vec3(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ), new Vec3(p_70685_1_.posX, p_70685_1_.posY + (double)p_70685_1_.getEyeHeight(), p_70685_1_.posZ)) == null;
+    }
+
+    /**
+     * returns a (normalized) vector of where this entity is looking
+     */
+    public Vec3 getLookVec()
+    {
+        return this.getLook(1.0F);
+    }
+
+    /**
+     * interpolated look vector
+     */
+    public Vec3 getLook(float p_70676_1_)
+    {
+        if (p_70676_1_ == 1.0F)
+        {
+            return this.func_174806_f(this.rotationPitch, this.rotationYawHead);
+        }
+        else
+        {
+            float var2 = this.prevRotationPitch + (this.rotationPitch - this.prevRotationPitch) * p_70676_1_;
+            float var3 = this.prevRotationYawHead + (this.rotationYawHead - this.prevRotationYawHead) * p_70676_1_;
+            return this.func_174806_f(var2, var3);
+        }
+    }
+
+    /**
+     * Returns where in the swing animation the living entity is (from 0 to 1).  Args: partialTickTime
+     */
+    public float getSwingProgress(float p_70678_1_)
+    {
+        float var2 = this.swingProgress - this.prevSwingProgress;
+
+        if (var2 < 0.0F)
+        {
+            ++var2;
+        }
+
+        return this.prevSwingProgress + var2 * p_70678_1_;
+    }
+
+    /**
+     * Returns whether the entity is in a server world
+     */
+    public boolean isServerWorld()
+    {
+        return !this.worldObj.isRemote;
+    }
+
+    /**
+     * Returns true if other Entities should be prevented from moving through this Entity.
+     */
+    public boolean canBeCollidedWith()
+    {
+        return !this.isDead;
+    }
+
+    /**
+     * Returns true if this entity should push and be pushed by other entities when colliding.
+     */
+    public boolean canBePushed()
+    {
+        return !this.isDead;
+    }
+
+    /**
+     * Sets that this entity has been attacked.
+     */
+    protected void setBeenAttacked()
+    {
+        this.velocityChanged = this.rand.nextDouble() >= this.getEntityAttribute(SharedMonsterAttributes.knockbackResistance).getAttributeValue();
+    }
+
+    public float getRotationYawHead()
+    {
+        return this.rotationYawHead;
+    }
+
+    /**
+     * Sets the head's yaw rotation of the entity.
+     */
+    public void setRotationYawHead(float rotation)
+    {
+        this.rotationYawHead = rotation;
+    }
+
+    public float getAbsorptionAmount()
+    {
+        return this.field_110151_bq;
+    }
+
+    public void setAbsorptionAmount(float p_110149_1_)
+    {
+        if (p_110149_1_ < 0.0F)
+        {
+            p_110149_1_ = 0.0F;
+        }
+
+        this.field_110151_bq = p_110149_1_;
+    }
+
+    public Team getTeam()
+    {
+        return this.worldObj.getScoreboard().getPlayersTeam(this.getUniqueID().toString());
+    }
+
+    public boolean isOnSameTeam(EntityLivingBase p_142014_1_)
+    {
+        return this.isOnTeam(p_142014_1_.getTeam());
+    }
+
+    /**
+     * Returns true if the entity is on a specific team.
+     */
+    public boolean isOnTeam(Team p_142012_1_)
+    {
+        return this.getTeam() != null ? this.getTeam().isSameTeam(p_142012_1_) : false;
+    }
+
+    public void func_152111_bt() {}
+
+    public void func_152112_bu() {}
+
+    protected void func_175136_bO()
+    {
+        this.potionsNeedUpdate = true;
+    }
+}
diff --git a/src/net/minecraft/entity/EntityTracker.java b/src/net/minecraft/entity/EntityTracker.java
index e86485f..4b9df96 100644
--- a/src/net/minecraft/entity/EntityTracker.java
+++ b/src/net/minecraft/entity/EntityTracker.java
@@ -2,10 +2,12 @@ package net.minecraft.entity;
 
 import com.google.common.collect.Lists;
 import com.google.common.collect.Sets;
+
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.Set;
 import java.util.concurrent.Callable;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.entity.boss.EntityDragon;
@@ -38,6 +40,7 @@ import net.minecraft.util.IntHashMap;
 import net.minecraft.util.ReportedException;
 import net.minecraft.world.WorldServer;
 import net.minecraft.world.chunk.Chunk;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/entity/boss/EntityDragon.java b/src/net/minecraft/entity/boss/EntityDragon.java
index 21f4488..236d302 100644
--- a/src/net/minecraft/entity/boss/EntityDragon.java
+++ b/src/net/minecraft/entity/boss/EntityDragon.java
@@ -478,7 +478,7 @@ public class EntityDragon extends EntityLiving implements IBossDisplayData, IEnt
 
         while (var2.hasNext())
         {
-            if (((EntityPlayer)var2.next()).func_175149_v())
+            if (((EntityPlayer)var2.next()).isSpectator())
             {
                 var2.remove();
             }
diff --git a/src/net/minecraft/entity/item/EntityArmorStand.java b/src/net/minecraft/entity/item/EntityArmorStand.java
index dbc77e3..60f430f 100644
--- a/src/net/minecraft/entity/item/EntityArmorStand.java
+++ b/src/net/minecraft/entity/item/EntityArmorStand.java
@@ -350,7 +350,7 @@ public class EntityArmorStand extends EntityLivingBase
 
     public boolean func_174825_a(EntityPlayer p_174825_1_, Vec3 p_174825_2_)
     {
-        if (!this.worldObj.isRemote && !p_174825_1_.func_175149_v())
+        if (!this.worldObj.isRemote && !p_174825_1_.isSpectator())
         {
             byte var3 = 0;
             ItemStack var4 = p_174825_1_.getCurrentEquippedItem();
diff --git a/src/net/minecraft/entity/item/EntityXPOrb.java b/src/net/minecraft/entity/item/EntityXPOrb.java
index 9f8f79c..eab2d65 100644
--- a/src/net/minecraft/entity/item/EntityXPOrb.java
+++ b/src/net/minecraft/entity/item/EntityXPOrb.java
@@ -117,7 +117,7 @@ public class EntityXPOrb extends Entity
             this.xpTargetColor = this.xpColor;
         }
 
-        if (this.closestPlayer != null && this.closestPlayer.func_175149_v())
+        if (this.closestPlayer != null && this.closestPlayer.isSpectator())
         {
             this.closestPlayer = null;
         }
diff --git a/src/net/minecraft/entity/player/EntityPlayer.java b/src/net/minecraft/entity/player/EntityPlayer.java
index 8a0a656..6e6abe6 100644
--- a/src/net/minecraft/entity/player/EntityPlayer.java
+++ b/src/net/minecraft/entity/player/EntityPlayer.java
@@ -1,2534 +1,2545 @@
-package net.minecraft.entity.player;
-
-import com.google.common.base.Charsets;
-import com.google.common.collect.Lists;
-import com.mojang.authlib.GameProfile;
-import java.util.Collection;
-import java.util.Iterator;
-import java.util.List;
-import java.util.UUID;
-import net.minecraft.block.Block;
-import net.minecraft.block.BlockBed;
-import net.minecraft.block.BlockDirectional;
-import net.minecraft.block.material.Material;
-import net.minecraft.block.state.IBlockState;
-import net.minecraft.command.server.CommandBlockLogic;
-import net.minecraft.enchantment.EnchantmentHelper;
-import net.minecraft.entity.Entity;
-import net.minecraft.entity.EntityList;
-import net.minecraft.entity.EntityLiving;
-import net.minecraft.entity.EntityLivingBase;
-import net.minecraft.entity.EnumCreatureAttribute;
-import net.minecraft.entity.IEntityMultiPart;
-import net.minecraft.entity.IMerchant;
-import net.minecraft.entity.SharedMonsterAttributes;
-import net.minecraft.entity.ai.attributes.IAttributeInstance;
-import net.minecraft.entity.boss.EntityDragonPart;
-import net.minecraft.entity.item.EntityBoat;
-import net.minecraft.entity.item.EntityItem;
-import net.minecraft.entity.item.EntityMinecart;
-import net.minecraft.entity.monster.EntityMob;
-import net.minecraft.entity.monster.IMob;
-import net.minecraft.entity.passive.EntityHorse;
-import net.minecraft.entity.passive.EntityPig;
-import net.minecraft.entity.projectile.EntityArrow;
-import net.minecraft.entity.projectile.EntityFishHook;
-import net.minecraft.event.ClickEvent;
-import net.minecraft.init.Blocks;
-import net.minecraft.init.Items;
-import net.minecraft.inventory.Container;
-import net.minecraft.inventory.ContainerPlayer;
-import net.minecraft.inventory.IInventory;
-import net.minecraft.inventory.InventoryEnderChest;
-import net.minecraft.item.EnumAction;
-import net.minecraft.item.Item;
-import net.minecraft.item.ItemArmor;
-import net.minecraft.item.ItemBlock;
-import net.minecraft.item.ItemStack;
-import net.minecraft.nbt.NBTTagCompound;
-import net.minecraft.nbt.NBTTagList;
-import net.minecraft.network.play.server.S12PacketEntityVelocity;
-import net.minecraft.potion.Potion;
-import net.minecraft.scoreboard.IScoreObjectiveCriteria;
-import net.minecraft.scoreboard.Score;
-import net.minecraft.scoreboard.ScoreObjective;
-import net.minecraft.scoreboard.ScorePlayerTeam;
-import net.minecraft.scoreboard.Scoreboard;
-import net.minecraft.scoreboard.Team;
-import net.minecraft.server.MinecraftServer;
-import net.minecraft.stats.AchievementList;
-import net.minecraft.stats.StatBase;
-import net.minecraft.stats.StatList;
-import net.minecraft.tileentity.TileEntitySign;
-import net.minecraft.util.AxisAlignedBB;
-import net.minecraft.util.BlockPos;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.DamageSource;
-import net.minecraft.util.EnumFacing;
-import net.minecraft.util.EnumParticleTypes;
-import net.minecraft.util.FoodStats;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.MathHelper;
-import net.minecraft.util.Vec3;
-import net.minecraft.world.EnumDifficulty;
-import net.minecraft.world.IInteractionObject;
-import net.minecraft.world.LockCode;
-import net.minecraft.world.World;
-import net.minecraft.world.WorldSettings;
-
-public abstract class EntityPlayer extends EntityLivingBase
-{
-    /** Inventory of the player */
-    public InventoryPlayer inventory = new InventoryPlayer(this);
-    private InventoryEnderChest theInventoryEnderChest = new InventoryEnderChest();
-
-    /**
-     * The Container for the player's inventory (which opens when they press E)
-     */
-    public Container inventoryContainer;
-
-    /** The Container the player has open. */
-    public Container openContainer;
-
-    /** The food object of the player, the general hunger logic. */
-    protected FoodStats foodStats = new FoodStats();
-
-    /**
-     * Used to tell if the player pressed jump twice. If this is at 0 and it's pressed (And they are allowed to fly, as
-     * defined in the player's movementInput) it sets this to 7. If it's pressed and it's greater than 0 enable fly.
-     */
-    protected int flyToggleTimer;
-    public float prevCameraYaw;
-    public float cameraYaw;
-
-    /**
-     * Used by EntityPlayer to prevent too many xp orbs from getting absorbed at once.
-     */
-    public int xpCooldown;
-    public double field_71091_bM;
-    public double field_71096_bN;
-    public double field_71097_bO;
-    public double field_71094_bP;
-    public double field_71095_bQ;
-    public double field_71085_bR;
-
-    /** Boolean value indicating weather a player is sleeping or not */
-    protected boolean sleeping;
-
-    /** the current location of the player */
-    public BlockPos playerLocation;
-    private int sleepTimer;
-    public float field_71079_bU;
-    public float field_71082_cx;
-    public float field_71089_bV;
-
-    /** holds the spawn chunk of the player */
-    private BlockPos spawnChunk;
-
-    /**
-     * Whether this player's spawn point is forced, preventing execution of bed checks.
-     */
-    private boolean spawnForced;
-
-    /** Holds the coordinate of the player when enter a minecraft to ride. */
-    private BlockPos startMinecartRidingCoordinate;
-
-    /** The player's capabilities. (See class PlayerCapabilities) */
-    public PlayerCapabilities capabilities = new PlayerCapabilities();
-
-    /** The current experience level the player is on. */
-    public int experienceLevel;
-
-    /**
-     * The total amount of experience the player has. This also includes the amount of experience within their
-     * Experience Bar.
-     */
-    public int experienceTotal;
-
-    /**
-     * The current amount of experience the player has within their Experience Bar.
-     */
-    public float experience;
-    private int field_175152_f;
-
-    /**
-     * This is the item that is in use when the player is holding down the useItemButton (e.g., bow, food, sword)
-     */
-    private ItemStack itemInUse;
-
-    /**
-     * This field starts off equal to getMaxItemUseDuration and is decremented on each tick
-     */
-    private int itemInUseCount;
-    protected float speedOnGround = 0.1F;
-    protected float speedInAir = 0.02F;
-    private int field_82249_h;
-
-    /** The player's unique game profile */
-    private final GameProfile gameProfile;
-    private boolean field_175153_bG = false;
-
-    /**
-     * An instance of a fishing rod's hook. If this isn't null, the icon image of the fishing rod is slightly different
-     */
-    public EntityFishHook fishEntity;
-    private static final String __OBFID = "CL_00001711";
-
-    public EntityPlayer(World worldIn, GameProfile p_i45324_2_)
-    {
-        super(worldIn);
-        this.entityUniqueID = getUUID(p_i45324_2_);
-        this.gameProfile = p_i45324_2_;
-        this.inventoryContainer = new ContainerPlayer(this.inventory, !worldIn.isRemote, this);
-        this.openContainer = this.inventoryContainer;
-        BlockPos var3 = worldIn.getSpawnPoint();
-        this.setLocationAndAngles((double)var3.getX() + 0.5D, (double)(var3.getY() + 1), (double)var3.getZ() + 0.5D, 0.0F, 0.0F);
-        this.field_70741_aB = 180.0F;
-        this.fireResistance = 20;
-    }
-
-    protected void applyEntityAttributes()
-    {
-        super.applyEntityAttributes();
-        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.attackDamage).setBaseValue(1.0D);
-        this.getEntityAttribute(SharedMonsterAttributes.movementSpeed).setBaseValue(0.10000000149011612D);
-    }
-
-    protected void entityInit()
-    {
-        super.entityInit();
-        this.dataWatcher.addObject(16, Byte.valueOf((byte)0));
-        this.dataWatcher.addObject(17, Float.valueOf(0.0F));
-        this.dataWatcher.addObject(18, Integer.valueOf(0));
-        this.dataWatcher.addObject(10, Byte.valueOf((byte)0));
-    }
-
-    /**
-     * returns the ItemStack containing the itemInUse
-     */
-    public ItemStack getItemInUse()
-    {
-        return this.itemInUse;
-    }
-
-    /**
-     * Returns the item in use count
-     */
-    public int getItemInUseCount()
-    {
-        return this.itemInUseCount;
-    }
-
-    /**
-     * Checks if the entity is currently using an item (e.g., bow, food, sword) by holding down the useItemButton
-     */
-    public boolean isUsingItem()
-    {
-        return this.itemInUse != null;
-    }
-
-    /**
-     * gets the duration for how long the current itemInUse has been in use
-     */
-    public int getItemInUseDuration()
-    {
-        return this.isUsingItem() ? this.itemInUse.getMaxItemUseDuration() - this.itemInUseCount : 0;
-    }
-
-    public void stopUsingItem()
-    {
-        if (this.itemInUse != null)
-        {
-            this.itemInUse.onPlayerStoppedUsing(this.worldObj, this, this.itemInUseCount);
-        }
-
-        this.clearItemInUse();
-    }
-
-    public void clearItemInUse()
-    {
-        this.itemInUse = null;
-        this.itemInUseCount = 0;
-
-        if (!this.worldObj.isRemote)
-        {
-            this.setEating(false);
-        }
-    }
-
-    public boolean isBlocking()
-    {
-        return this.isUsingItem() && this.itemInUse.getItem().getItemUseAction(this.itemInUse) == EnumAction.BLOCK;
-    }
-
-    /**
-     * Called to update the entity's position/logic.
-     */
-    public void onUpdate()
-    {
-        this.noClip = this.func_175149_v();
-
-        if (this.func_175149_v())
-        {
-            this.onGround = false;
-        }
-
-        if (this.itemInUse != null)
-        {
-            ItemStack var1 = this.inventory.getCurrentItem();
-
-            if (var1 == this.itemInUse)
-            {
-                if (this.itemInUseCount <= 25 && this.itemInUseCount % 4 == 0)
-                {
-                    this.updateItemUse(var1, 5);
-                }
-
-                if (--this.itemInUseCount == 0 && !this.worldObj.isRemote)
-                {
-                    this.onItemUseFinish();
-                }
-            }
-            else
-            {
-                this.clearItemInUse();
-            }
-        }
-
-        if (this.xpCooldown > 0)
-        {
-            --this.xpCooldown;
-        }
-
-        if (this.isPlayerSleeping())
-        {
-            ++this.sleepTimer;
-
-            if (this.sleepTimer > 100)
-            {
-                this.sleepTimer = 100;
-            }
-
-            if (!this.worldObj.isRemote)
-            {
-                if (!this.func_175143_p())
-                {
-                    this.wakeUpPlayer(true, true, false);
-                }
-                else if (this.worldObj.isDaytime())
-                {
-                    this.wakeUpPlayer(false, true, true);
-                }
-            }
-        }
-        else if (this.sleepTimer > 0)
-        {
-            ++this.sleepTimer;
-
-            if (this.sleepTimer >= 110)
-            {
-                this.sleepTimer = 0;
-            }
-        }
-
-        super.onUpdate();
-
-        if (!this.worldObj.isRemote && this.openContainer != null && !this.openContainer.canInteractWith(this))
-        {
-            this.closeScreen();
-            this.openContainer = this.inventoryContainer;
-        }
-
-        if (this.isBurning() && this.capabilities.disableDamage)
-        {
-            this.extinguish();
-        }
-
-        this.field_71091_bM = this.field_71094_bP;
-        this.field_71096_bN = this.field_71095_bQ;
-        this.field_71097_bO = this.field_71085_bR;
-        double var14 = this.posX - this.field_71094_bP;
-        double var3 = this.posY - this.field_71095_bQ;
-        double var5 = this.posZ - this.field_71085_bR;
-        double var7 = 10.0D;
-
-        if (var14 > var7)
-        {
-            this.field_71091_bM = this.field_71094_bP = this.posX;
-        }
-
-        if (var5 > var7)
-        {
-            this.field_71097_bO = this.field_71085_bR = this.posZ;
-        }
-
-        if (var3 > var7)
-        {
-            this.field_71096_bN = this.field_71095_bQ = this.posY;
-        }
-
-        if (var14 < -var7)
-        {
-            this.field_71091_bM = this.field_71094_bP = this.posX;
-        }
-
-        if (var5 < -var7)
-        {
-            this.field_71097_bO = this.field_71085_bR = this.posZ;
-        }
-
-        if (var3 < -var7)
-        {
-            this.field_71096_bN = this.field_71095_bQ = this.posY;
-        }
-
-        this.field_71094_bP += var14 * 0.25D;
-        this.field_71085_bR += var5 * 0.25D;
-        this.field_71095_bQ += var3 * 0.25D;
-
-        if (this.ridingEntity == null)
-        {
-            this.startMinecartRidingCoordinate = null;
-        }
-
-        if (!this.worldObj.isRemote)
-        {
-            this.foodStats.onUpdate(this);
-            this.triggerAchievement(StatList.minutesPlayedStat);
-
-            if (this.isEntityAlive())
-            {
-                this.triggerAchievement(StatList.timeSinceDeathStat);
-            }
-        }
-
-        int var9 = 29999999;
-        double var10 = MathHelper.clamp_double(this.posX, -2.9999999E7D, 2.9999999E7D);
-        double var12 = MathHelper.clamp_double(this.posZ, -2.9999999E7D, 2.9999999E7D);
-
-        if (var10 != this.posX || var12 != this.posZ)
-        {
-            this.setPosition(var10, this.posY, var12);
-        }
-    }
-
-    /**
-     * Return the amount of time this entity should stay in a portal before being transported.
-     */
-    public int getMaxInPortalTime()
-    {
-        return this.capabilities.disableDamage ? 0 : 80;
-    }
-
-    protected String getSwimSound()
-    {
-        return "game.player.swim";
-    }
-
-    protected String getSplashSound()
-    {
-        return "game.player.swim.splash";
-    }
-
-    /**
-     * Return the amount of cooldown before this entity can use a portal again.
-     */
-    public int getPortalCooldown()
-    {
-        return 10;
-    }
-
-    public void playSound(String name, float volume, float pitch)
-    {
-        this.worldObj.playSoundToNearExcept(this, name, volume, pitch);
-    }
-
-    /**
-     * Plays sounds and makes particles for item in use state
-     */
-    protected void updateItemUse(ItemStack itemStackIn, int p_71010_2_)
-    {
-        if (itemStackIn.getItemUseAction() == EnumAction.DRINK)
-        {
-            this.playSound("random.drink", 0.5F, this.worldObj.rand.nextFloat() * 0.1F + 0.9F);
-        }
-
-        if (itemStackIn.getItemUseAction() == EnumAction.EAT)
-        {
-            for (int var3 = 0; var3 < p_71010_2_; ++var3)
-            {
-                Vec3 var4 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.1D, Math.random() * 0.1D + 0.1D, 0.0D);
-                var4 = var4.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
-                var4 = var4.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
-                double var5 = (double)(-this.rand.nextFloat()) * 0.6D - 0.3D;
-                Vec3 var7 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.3D, var5, 0.6D);
-                var7 = var7.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
-                var7 = var7.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
-                var7 = var7.addVector(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
-
-                if (itemStackIn.getHasSubtypes())
-                {
-                    this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var7.xCoord, var7.yCoord, var7.zCoord, var4.xCoord, var4.yCoord + 0.05D, var4.zCoord, new int[] {Item.getIdFromItem(itemStackIn.getItem()), itemStackIn.getMetadata()});
-                }
-                else
-                {
-                    this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var7.xCoord, var7.yCoord, var7.zCoord, var4.xCoord, var4.yCoord + 0.05D, var4.zCoord, new int[] {Item.getIdFromItem(itemStackIn.getItem())});
-                }
-            }
-
-            this.playSound("random.eat", 0.5F + 0.5F * (float)this.rand.nextInt(2), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
-        }
-    }
-
-    /**
-     * Used for when item use count runs out, ie: eating completed
-     */
-    protected void onItemUseFinish()
-    {
-        if (this.itemInUse != null)
-        {
-            this.updateItemUse(this.itemInUse, 16);
-            int var1 = this.itemInUse.stackSize;
-            ItemStack var2 = this.itemInUse.onItemUseFinish(this.worldObj, this);
-
-            if (var2 != this.itemInUse || var2 != null && var2.stackSize != var1)
-            {
-                this.inventory.mainInventory[this.inventory.currentItem] = var2;
-
-                if (var2.stackSize == 0)
-                {
-                    this.inventory.mainInventory[this.inventory.currentItem] = null;
-                }
-            }
-
-            this.clearItemInUse();
-        }
-    }
-
-    public void handleHealthUpdate(byte p_70103_1_)
-    {
-        if (p_70103_1_ == 9)
-        {
-            this.onItemUseFinish();
-        }
-        else if (p_70103_1_ == 23)
-        {
-            this.field_175153_bG = false;
-        }
-        else if (p_70103_1_ == 22)
-        {
-            this.field_175153_bG = true;
-        }
-        else
-        {
-            super.handleHealthUpdate(p_70103_1_);
-        }
-    }
-
-    /**
-     * Dead and sleeping entities cannot move
-     */
-    protected boolean isMovementBlocked()
-    {
-        return this.getHealth() <= 0.0F || this.isPlayerSleeping();
-    }
-
-    /**
-     * set current crafting inventory back to the 2x2 square
-     */
-    protected void closeScreen()
-    {
-        this.openContainer = this.inventoryContainer;
-    }
-
-    /**
-     * Handles updating while being ridden by an entity
-     */
-    public void updateRidden()
-    {
-        if (!this.worldObj.isRemote && this.isSneaking())
-        {
-            this.mountEntity((Entity)null);
-            this.setSneaking(false);
-        }
-        else
-        {
-            double var1 = this.posX;
-            double var3 = this.posY;
-            double var5 = this.posZ;
-            float var7 = this.rotationYaw;
-            float var8 = this.rotationPitch;
-            super.updateRidden();
-            this.prevCameraYaw = this.cameraYaw;
-            this.cameraYaw = 0.0F;
-            this.addMountedMovementStat(this.posX - var1, this.posY - var3, this.posZ - var5);
-
-            if (this.ridingEntity instanceof EntityPig)
-            {
-                this.rotationPitch = var8;
-                this.rotationYaw = var7;
-                this.renderYawOffset = ((EntityPig)this.ridingEntity).renderYawOffset;
-            }
-        }
-    }
-
-    /**
-     * Keeps moving the entity up so it isn't colliding with blocks and other requirements for this entity to be spawned
-     * (only actually used on players though its also on Entity)
-     */
-    public void preparePlayerToSpawn()
-    {
-        this.setSize(0.6F, 1.8F);
-        super.preparePlayerToSpawn();
-        this.setHealth(this.getMaxHealth());
-        this.deathTime = 0;
-    }
-
-    protected void updateEntityActionState()
-    {
-        super.updateEntityActionState();
-        this.updateArmSwingProgress();
-        this.rotationYawHead = this.rotationYaw;
-    }
-
-    /**
-     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
-     * use this to react to sunlight and start to burn.
-     */
-    public void onLivingUpdate()
-    {
-        if (this.flyToggleTimer > 0)
-        {
-            --this.flyToggleTimer;
-        }
-
-        if (this.worldObj.getDifficulty() == EnumDifficulty.PEACEFUL && this.worldObj.getGameRules().getGameRuleBooleanValue("naturalRegeneration"))
-        {
-            if (this.getHealth() < this.getMaxHealth() && this.ticksExisted % 20 == 0)
-            {
-                this.heal(1.0F);
-            }
-
-            if (this.foodStats.needFood() && this.ticksExisted % 10 == 0)
-            {
-                this.foodStats.setFoodLevel(this.foodStats.getFoodLevel() + 1);
-            }
-        }
-
-        this.inventory.decrementAnimations();
-        this.prevCameraYaw = this.cameraYaw;
-        super.onLivingUpdate();
-        IAttributeInstance var1 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
-
-        if (!this.worldObj.isRemote)
-        {
-            var1.setBaseValue((double)this.capabilities.getWalkSpeed());
-        }
-
-        this.jumpMovementFactor = this.speedInAir;
-
-        if (this.isSprinting())
-        {
-            this.jumpMovementFactor = (float)((double)this.jumpMovementFactor + (double)this.speedInAir * 0.3D);
-        }
-
-        this.setAIMoveSpeed((float)var1.getAttributeValue());
-        float var2 = MathHelper.sqrt_double(this.motionX * this.motionX + this.motionZ * this.motionZ);
-        float var3 = (float)(Math.atan(-this.motionY * 0.20000000298023224D) * 15.0D);
-
-        if (var2 > 0.1F)
-        {
-            var2 = 0.1F;
-        }
-
-        if (!this.onGround || this.getHealth() <= 0.0F)
-        {
-            var2 = 0.0F;
-        }
-
-        if (this.onGround || this.getHealth() <= 0.0F)
-        {
-            var3 = 0.0F;
-        }
-
-        this.cameraYaw += (var2 - this.cameraYaw) * 0.4F;
-        this.cameraPitch += (var3 - this.cameraPitch) * 0.8F;
-
-        if (this.getHealth() > 0.0F && !this.func_175149_v())
-        {
-            AxisAlignedBB var4 = null;
-
-            if (this.ridingEntity != null && !this.ridingEntity.isDead)
-            {
-                var4 = this.getEntityBoundingBox().union(this.ridingEntity.getEntityBoundingBox()).expand(1.0D, 0.0D, 1.0D);
-            }
-            else
-            {
-                var4 = this.getEntityBoundingBox().expand(1.0D, 0.5D, 1.0D);
-            }
-
-            List var5 = this.worldObj.getEntitiesWithinAABBExcludingEntity(this, var4);
-
-            for (int var6 = 0; var6 < var5.size(); ++var6)
-            {
-                Entity var7 = (Entity)var5.get(var6);
-
-                if (!var7.isDead)
-                {
-                    this.collideWithPlayer(var7);
-                }
-            }
-        }
-    }
-
-    private void collideWithPlayer(Entity p_71044_1_)
-    {
-        p_71044_1_.onCollideWithPlayer(this);
-    }
-
-    public int getScore()
-    {
-        return this.dataWatcher.getWatchableObjectInt(18);
-    }
-
-    /**
-     * Set player's score
-     */
-    public void setScore(int p_85040_1_)
-    {
-        this.dataWatcher.updateObject(18, Integer.valueOf(p_85040_1_));
-    }
-
-    /**
-     * Add to player's score
-     */
-    public void addScore(int p_85039_1_)
-    {
-        int var2 = this.getScore();
-        this.dataWatcher.updateObject(18, Integer.valueOf(var2 + p_85039_1_));
-    }
-
-    /**
-     * Called when the mob's health reaches 0.
-     */
-    public void onDeath(DamageSource cause)
-    {
-        super.onDeath(cause);
-        this.setSize(0.2F, 0.2F);
-        this.setPosition(this.posX, this.posY, this.posZ);
-        this.motionY = 0.10000000149011612D;
-
-        if (this.getName().equals("Notch"))
-        {
-            this.func_146097_a(new ItemStack(Items.apple, 1), true, false);
-        }
-
-        if (!this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
-        {
-            this.inventory.dropAllItems();
-        }
-
-        if (cause != null)
-        {
-            this.motionX = (double)(-MathHelper.cos((this.attackedAtYaw + this.rotationYaw) * (float)Math.PI / 180.0F) * 0.1F);
-            this.motionZ = (double)(-MathHelper.sin((this.attackedAtYaw + this.rotationYaw) * (float)Math.PI / 180.0F) * 0.1F);
-        }
-        else
-        {
-            this.motionX = this.motionZ = 0.0D;
-        }
-
-        this.triggerAchievement(StatList.deathsStat);
-        this.func_175145_a(StatList.timeSinceDeathStat);
-    }
-
-    /**
-     * Returns the sound this mob makes when it is hurt.
-     */
-    protected String getHurtSound()
-    {
-        return "game.player.hurt";
-    }
-
-    /**
-     * Returns the sound this mob makes on death.
-     */
-    protected String getDeathSound()
-    {
-        return "game.player.die";
-    }
-
-    /**
-     * Adds a value to the player score. Currently not actually used and the entity passed in does nothing. Args:
-     * entity, scoreToAdd
-     */
-    public void addToPlayerScore(Entity entityIn, int amount)
-    {
-        this.addScore(amount);
-        Collection var3 = this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.totalKillCount);
-
-        if (entityIn instanceof EntityPlayer)
-        {
-            this.triggerAchievement(StatList.playerKillsStat);
-            var3.addAll(this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.playerKillCount));
-            var3.addAll(this.func_175137_e(entityIn));
-        }
-        else
-        {
-            this.triggerAchievement(StatList.mobKillsStat);
-        }
-
-        Iterator var4 = var3.iterator();
-
-        while (var4.hasNext())
-        {
-            ScoreObjective var5 = (ScoreObjective)var4.next();
-            Score var6 = this.getWorldScoreboard().getValueFromObjective(this.getName(), var5);
-            var6.func_96648_a();
-        }
-    }
-
-    private Collection func_175137_e(Entity p_175137_1_)
-    {
-        ScorePlayerTeam var2 = this.getWorldScoreboard().getPlayersTeam(this.getName());
-
-        if (var2 != null)
-        {
-            int var3 = var2.func_178775_l().func_175746_b();
-
-            if (var3 >= 0 && var3 < IScoreObjectiveCriteria.field_178793_i.length)
-            {
-                Iterator var4 = this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.field_178793_i[var3]).iterator();
-
-                while (var4.hasNext())
-                {
-                    ScoreObjective var5 = (ScoreObjective)var4.next();
-                    Score var6 = this.getWorldScoreboard().getValueFromObjective(p_175137_1_.getName(), var5);
-                    var6.func_96648_a();
-                }
-            }
-        }
-
-        ScorePlayerTeam var7 = this.getWorldScoreboard().getPlayersTeam(p_175137_1_.getName());
-
-        if (var7 != null)
-        {
-            int var8 = var7.func_178775_l().func_175746_b();
-
-            if (var8 >= 0 && var8 < IScoreObjectiveCriteria.field_178792_h.length)
-            {
-                return this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.field_178792_h[var8]);
-            }
-        }
-
-        return Lists.newArrayList();
-    }
-
-    /**
-     * Called when player presses the drop item key
-     */
-    public EntityItem dropOneItem(boolean p_71040_1_)
-    {
-        return this.func_146097_a(this.inventory.decrStackSize(this.inventory.currentItem, p_71040_1_ && this.inventory.getCurrentItem() != null ? this.inventory.getCurrentItem().stackSize : 1), false, true);
-    }
-
-    /**
-     * Args: itemstack, flag
-     */
-    public EntityItem dropPlayerItemWithRandomChoice(ItemStack itemStackIn, boolean p_71019_2_)
-    {
-        return this.func_146097_a(itemStackIn, false, false);
-    }
-
-    public EntityItem func_146097_a(ItemStack p_146097_1_, boolean p_146097_2_, boolean p_146097_3_)
-    {
-        if (p_146097_1_ == null)
-        {
-            return null;
-        }
-        else if (p_146097_1_.stackSize == 0)
-        {
-            return null;
-        }
-        else
-        {
-            double var4 = this.posY - 0.30000001192092896D + (double)this.getEyeHeight();
-            EntityItem var6 = new EntityItem(this.worldObj, this.posX, var4, this.posZ, p_146097_1_);
-            var6.setPickupDelay(40);
-
-            if (p_146097_3_)
-            {
-                var6.setThrower(this.getName());
-            }
-
-            float var7;
-            float var8;
-
-            if (p_146097_2_)
-            {
-                var7 = this.rand.nextFloat() * 0.5F;
-                var8 = this.rand.nextFloat() * (float)Math.PI * 2.0F;
-                var6.motionX = (double)(-MathHelper.sin(var8) * var7);
-                var6.motionZ = (double)(MathHelper.cos(var8) * var7);
-                var6.motionY = 0.20000000298023224D;
-            }
-            else
-            {
-                var7 = 0.3F;
-                var6.motionX = (double)(-MathHelper.sin(this.rotationYaw / 180.0F * (float)Math.PI) * MathHelper.cos(this.rotationPitch / 180.0F * (float)Math.PI) * var7);
-                var6.motionZ = (double)(MathHelper.cos(this.rotationYaw / 180.0F * (float)Math.PI) * MathHelper.cos(this.rotationPitch / 180.0F * (float)Math.PI) * var7);
-                var6.motionY = (double)(-MathHelper.sin(this.rotationPitch / 180.0F * (float)Math.PI) * var7 + 0.1F);
-                var8 = this.rand.nextFloat() * (float)Math.PI * 2.0F;
-                var7 = 0.02F * this.rand.nextFloat();
-                var6.motionX += Math.cos((double)var8) * (double)var7;
-                var6.motionY += (double)((this.rand.nextFloat() - this.rand.nextFloat()) * 0.1F);
-                var6.motionZ += Math.sin((double)var8) * (double)var7;
-            }
-
-            this.joinEntityItemWithWorld(var6);
-
-            if (p_146097_3_)
-            {
-                this.triggerAchievement(StatList.dropStat);
-            }
-
-            return var6;
-        }
-    }
-
-    /**
-     * Joins the passed in entity item with the world. Args: entityItem
-     */
-    protected void joinEntityItemWithWorld(EntityItem p_71012_1_)
-    {
-        this.worldObj.spawnEntityInWorld(p_71012_1_);
-    }
-
-    public float func_180471_a(Block p_180471_1_)
-    {
-        float var2 = this.inventory.getStrVsBlock(p_180471_1_);
-
-        if (var2 > 1.0F)
-        {
-            int var3 = EnchantmentHelper.getEfficiencyModifier(this);
-            ItemStack var4 = this.inventory.getCurrentItem();
-
-            if (var3 > 0 && var4 != null)
-            {
-                var2 += (float)(var3 * var3 + 1);
-            }
-        }
-
-        if (this.isPotionActive(Potion.digSpeed))
-        {
-            var2 *= 1.0F + (float)(this.getActivePotionEffect(Potion.digSpeed).getAmplifier() + 1) * 0.2F;
-        }
-
-        if (this.isPotionActive(Potion.digSlowdown))
-        {
-            float var5 = 1.0F;
-
-            switch (this.getActivePotionEffect(Potion.digSlowdown).getAmplifier())
-            {
-                case 0:
-                    var5 = 0.3F;
-                    break;
-
-                case 1:
-                    var5 = 0.09F;
-                    break;
-
-                case 2:
-                    var5 = 0.0027F;
-                    break;
-
-                case 3:
-                default:
-                    var5 = 8.1E-4F;
-            }
-
-            var2 *= var5;
-        }
-
-        if (this.isInsideOfMaterial(Material.water) && !EnchantmentHelper.getAquaAffinityModifier(this))
-        {
-            var2 /= 5.0F;
-        }
-
-        if (!this.onGround)
-        {
-            var2 /= 5.0F;
-        }
-
-        return var2;
-    }
-
-    /**
-     * Checks if the player has the ability to harvest a block (checks current inventory item for a tool if necessary)
-     */
-    public boolean canHarvestBlock(Block p_146099_1_)
-    {
-        return this.inventory.func_146025_b(p_146099_1_);
-    }
-
-    /**
-     * (abstract) Protected helper method to read subclass entity data from NBT.
-     */
-    public void readEntityFromNBT(NBTTagCompound tagCompund)
-    {
-        super.readEntityFromNBT(tagCompund);
-        this.entityUniqueID = getUUID(this.gameProfile);
-        NBTTagList var2 = tagCompund.getTagList("Inventory", 10);
-        this.inventory.readFromNBT(var2);
-        this.inventory.currentItem = tagCompund.getInteger("SelectedItemSlot");
-        this.sleeping = tagCompund.getBoolean("Sleeping");
-        this.sleepTimer = tagCompund.getShort("SleepTimer");
-        this.experience = tagCompund.getFloat("XpP");
-        this.experienceLevel = tagCompund.getInteger("XpLevel");
-        this.experienceTotal = tagCompund.getInteger("XpTotal");
-        this.field_175152_f = tagCompund.getInteger("XpSeed");
-
-        if (this.field_175152_f == 0)
-        {
-            this.field_175152_f = this.rand.nextInt();
-        }
-
-        this.setScore(tagCompund.getInteger("Score"));
-
-        if (this.sleeping)
-        {
-            this.playerLocation = new BlockPos(this);
-            this.wakeUpPlayer(true, true, false);
-        }
-
-        if (tagCompund.hasKey("SpawnX", 99) && tagCompund.hasKey("SpawnY", 99) && tagCompund.hasKey("SpawnZ", 99))
-        {
-            this.spawnChunk = new BlockPos(tagCompund.getInteger("SpawnX"), tagCompund.getInteger("SpawnY"), tagCompund.getInteger("SpawnZ"));
-            this.spawnForced = tagCompund.getBoolean("SpawnForced");
-        }
-
-        this.foodStats.readNBT(tagCompund);
-        this.capabilities.readCapabilitiesFromNBT(tagCompund);
-
-        if (tagCompund.hasKey("EnderItems", 9))
-        {
-            NBTTagList var3 = tagCompund.getTagList("EnderItems", 10);
-            this.theInventoryEnderChest.loadInventoryFromNBT(var3);
-        }
-    }
-
-    /**
-     * (abstract) Protected helper method to write subclass entity data to NBT.
-     */
-    public void writeEntityToNBT(NBTTagCompound tagCompound)
-    {
-        super.writeEntityToNBT(tagCompound);
-        tagCompound.setTag("Inventory", this.inventory.writeToNBT(new NBTTagList()));
-        tagCompound.setInteger("SelectedItemSlot", this.inventory.currentItem);
-        tagCompound.setBoolean("Sleeping", this.sleeping);
-        tagCompound.setShort("SleepTimer", (short)this.sleepTimer);
-        tagCompound.setFloat("XpP", this.experience);
-        tagCompound.setInteger("XpLevel", this.experienceLevel);
-        tagCompound.setInteger("XpTotal", this.experienceTotal);
-        tagCompound.setInteger("XpSeed", this.field_175152_f);
-        tagCompound.setInteger("Score", this.getScore());
-
-        if (this.spawnChunk != null)
-        {
-            tagCompound.setInteger("SpawnX", this.spawnChunk.getX());
-            tagCompound.setInteger("SpawnY", this.spawnChunk.getY());
-            tagCompound.setInteger("SpawnZ", this.spawnChunk.getZ());
-            tagCompound.setBoolean("SpawnForced", this.spawnForced);
-        }
-
-        this.foodStats.writeNBT(tagCompound);
-        this.capabilities.writeCapabilitiesToNBT(tagCompound);
-        tagCompound.setTag("EnderItems", this.theInventoryEnderChest.saveInventoryToNBT());
-        ItemStack var2 = this.inventory.getCurrentItem();
-
-        if (var2 != null && var2.getItem() != null)
-        {
-            tagCompound.setTag("SelectedItem", var2.writeToNBT(new NBTTagCompound()));
-        }
-    }
-
-    /**
-     * Called when the entity is attacked.
-     */
-    public boolean attackEntityFrom(DamageSource source, float amount)
-    {
-        if (this.func_180431_b(source))
-        {
-            return false;
-        }
-        else if (this.capabilities.disableDamage && !source.canHarmInCreative())
-        {
-            return false;
-        }
-        else
-        {
-            this.entityAge = 0;
-
-            if (this.getHealth() <= 0.0F)
-            {
-                return false;
-            }
-            else
-            {
-                if (this.isPlayerSleeping() && !this.worldObj.isRemote)
-                {
-                    this.wakeUpPlayer(true, true, false);
-                }
-
-                if (source.isDifficultyScaled())
-                {
-                    if (this.worldObj.getDifficulty() == EnumDifficulty.PEACEFUL)
-                    {
-                        amount = 0.0F;
-                    }
-
-                    if (this.worldObj.getDifficulty() == EnumDifficulty.EASY)
-                    {
-                        amount = amount / 2.0F + 1.0F;
-                    }
-
-                    if (this.worldObj.getDifficulty() == EnumDifficulty.HARD)
-                    {
-                        amount = amount * 3.0F / 2.0F;
-                    }
-                }
-
-                if (amount == 0.0F)
-                {
-                    return false;
-                }
-                else
-                {
-                    Entity var3 = source.getEntity();
-
-                    if (var3 instanceof EntityArrow && ((EntityArrow)var3).shootingEntity != null)
-                    {
-                        var3 = ((EntityArrow)var3).shootingEntity;
-                    }
-
-                    return super.attackEntityFrom(source, amount);
-                }
-            }
-        }
-    }
-
-    public boolean canAttackPlayer(EntityPlayer other)
-    {
-        Team var2 = this.getTeam();
-        Team var3 = other.getTeam();
-        return var2 == null ? true : (!var2.isSameTeam(var3) ? true : var2.getAllowFriendlyFire());
-    }
-
-    protected void damageArmor(float p_70675_1_)
-    {
-        this.inventory.damageArmor(p_70675_1_);
-    }
-
-    /**
-     * Returns the current armor value as determined by a call to InventoryPlayer.getTotalArmorValue
-     */
-    public int getTotalArmorValue()
-    {
-        return this.inventory.getTotalArmorValue();
-    }
-
-    /**
-     * When searching for vulnerable players, if a player is invisible, the return value of this is the chance of seeing
-     * them anyway.
-     */
-    public float getArmorVisibility()
-    {
-        int var1 = 0;
-        ItemStack[] var2 = this.inventory.armorInventory;
-        int var3 = var2.length;
-
-        for (int var4 = 0; var4 < var3; ++var4)
-        {
-            ItemStack var5 = var2[var4];
-
-            if (var5 != null)
-            {
-                ++var1;
-            }
-        }
-
-        return (float)var1 / (float)this.inventory.armorInventory.length;
-    }
-
-    /**
-     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
-     * second with the reduced value. Args: damageAmount
-     */
-    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
-    {
-        if (!this.func_180431_b(p_70665_1_))
-        {
-            if (!p_70665_1_.isUnblockable() && this.isBlocking() && p_70665_2_ > 0.0F)
-            {
-                p_70665_2_ = (1.0F + p_70665_2_) * 0.5F;
-            }
-
-            p_70665_2_ = this.applyArmorCalculations(p_70665_1_, p_70665_2_);
-            p_70665_2_ = this.applyPotionDamageCalculations(p_70665_1_, p_70665_2_);
-            float var3 = p_70665_2_;
-            p_70665_2_ = Math.max(p_70665_2_ - this.getAbsorptionAmount(), 0.0F);
-            this.setAbsorptionAmount(this.getAbsorptionAmount() - (var3 - p_70665_2_));
-
-            if (p_70665_2_ != 0.0F)
-            {
-                this.addExhaustion(p_70665_1_.getHungerDamage());
-                float var4 = this.getHealth();
-                this.setHealth(this.getHealth() - p_70665_2_);
-                this.getCombatTracker().func_94547_a(p_70665_1_, var4, p_70665_2_);
-
-                if (p_70665_2_ < 3.4028235E37F)
-                {
-                    this.addStat(StatList.damageTakenStat, Math.round(p_70665_2_ * 10.0F));
-                }
-            }
-        }
-    }
-
-    public void func_175141_a(TileEntitySign p_175141_1_) {}
-
-    public void func_146095_a(CommandBlockLogic p_146095_1_) {}
-
-    public void displayVillagerTradeGui(IMerchant villager) {}
-
-    /**
-     * Displays the GUI for interacting with a chest inventory. Args: chestInventory
-     */
-    public void displayGUIChest(IInventory chestInventory) {}
-
-    public void displayGUIHorse(EntityHorse p_110298_1_, IInventory p_110298_2_) {}
-
-    public void displayGui(IInteractionObject guiOwner) {}
-
-    /**
-     * Displays the GUI for interacting with a book.
-     */
-    public void displayGUIBook(ItemStack bookStack) {}
-
-    public boolean interactWith(Entity p_70998_1_)
-    {
-        if (this.func_175149_v())
-        {
-            if (p_70998_1_ instanceof IInventory)
-            {
-                this.displayGUIChest((IInventory)p_70998_1_);
-            }
-
-            return false;
-        }
-        else
-        {
-            ItemStack var2 = this.getCurrentEquippedItem();
-            ItemStack var3 = var2 != null ? var2.copy() : null;
-
-            if (!p_70998_1_.interactFirst(this))
-            {
-                if (var2 != null && p_70998_1_ instanceof EntityLivingBase)
-                {
-                    if (this.capabilities.isCreativeMode)
-                    {
-                        var2 = var3;
-                    }
-
-                    if (var2.interactWithEntity(this, (EntityLivingBase)p_70998_1_))
-                    {
-                        if (var2.stackSize <= 0 && !this.capabilities.isCreativeMode)
-                        {
-                            this.destroyCurrentEquippedItem();
-                        }
-
-                        return true;
-                    }
-                }
-
-                return false;
-            }
-            else
-            {
-                if (var2 != null && var2 == this.getCurrentEquippedItem())
-                {
-                    if (var2.stackSize <= 0 && !this.capabilities.isCreativeMode)
-                    {
-                        this.destroyCurrentEquippedItem();
-                    }
-                    else if (var2.stackSize < var3.stackSize && this.capabilities.isCreativeMode)
-                    {
-                        var2.stackSize = var3.stackSize;
-                    }
-                }
-
-                return true;
-            }
-        }
-    }
-
-    /**
-     * Returns the currently being used item by the player.
-     */
-    public ItemStack getCurrentEquippedItem()
-    {
-        return this.inventory.getCurrentItem();
-    }
-
-    /**
-     * Destroys the currently equipped item from the player's inventory.
-     */
-    public void destroyCurrentEquippedItem()
-    {
-        this.inventory.setInventorySlotContents(this.inventory.currentItem, (ItemStack)null);
-    }
-
-    /**
-     * Returns the Y Offset of this entity.
-     */
-    public double getYOffset()
-    {
-        return -0.35D;
-    }
-
-    /**
-     * Attacks for the player the targeted entity with the currently equipped item.  The equipped item has hitEntity
-     * called on it. Args: targetEntity
-     */
-    public void attackTargetEntityWithCurrentItem(Entity targetEntity)
-    {
-        if (targetEntity.canAttackWithItem())
-        {
-            if (!targetEntity.hitByEntity(this))
-            {
-                float var2 = (float)this.getEntityAttribute(SharedMonsterAttributes.attackDamage).getAttributeValue();
-                byte var3 = 0;
-                float var4 = 0.0F;
-
-                if (targetEntity instanceof EntityLivingBase)
-                {
-                    var4 = EnchantmentHelper.func_152377_a(this.getHeldItem(), ((EntityLivingBase)targetEntity).getCreatureAttribute());
-                }
-                else
-                {
-                    var4 = EnchantmentHelper.func_152377_a(this.getHeldItem(), EnumCreatureAttribute.UNDEFINED);
-                }
-
-                int var18 = var3 + EnchantmentHelper.getRespiration(this);
-
-                if (this.isSprinting())
-                {
-                    ++var18;
-                }
-
-                if (var2 > 0.0F || var4 > 0.0F)
-                {
-                    boolean var5 = this.fallDistance > 0.0F && !this.onGround && !this.isOnLadder() && !this.isInWater() && !this.isPotionActive(Potion.blindness) && this.ridingEntity == null && targetEntity instanceof EntityLivingBase;
-
-                    if (var5 && var2 > 0.0F)
-                    {
-                        var2 *= 1.5F;
-                    }
-
-                    var2 += var4;
-                    boolean var6 = false;
-                    int var7 = EnchantmentHelper.getFireAspectModifier(this);
-
-                    if (targetEntity instanceof EntityLivingBase && var7 > 0 && !targetEntity.isBurning())
-                    {
-                        var6 = true;
-                        targetEntity.setFire(1);
-                    }
-
-                    double var8 = targetEntity.motionX;
-                    double var10 = targetEntity.motionY;
-                    double var12 = targetEntity.motionZ;
-                    boolean var14 = targetEntity.attackEntityFrom(DamageSource.causePlayerDamage(this), var2);
-
-                    if (var14)
-                    {
-                        if (var18 > 0)
-                        {
-                            targetEntity.addVelocity((double)(-MathHelper.sin(this.rotationYaw * (float)Math.PI / 180.0F) * (float)var18 * 0.5F), 0.1D, (double)(MathHelper.cos(this.rotationYaw * (float)Math.PI / 180.0F) * (float)var18 * 0.5F));
-                            this.motionX *= 0.6D;
-                            this.motionZ *= 0.6D;
-                            this.setSprinting(false);
-                        }
-
-                        if (targetEntity instanceof EntityPlayerMP && targetEntity.velocityChanged)
-                        {
-                            ((EntityPlayerMP)targetEntity).playerNetServerHandler.sendPacket(new S12PacketEntityVelocity(targetEntity));
-                            targetEntity.velocityChanged = false;
-                            targetEntity.motionX = var8;
-                            targetEntity.motionY = var10;
-                            targetEntity.motionZ = var12;
-                        }
-
-                        if (var5)
-                        {
-                            this.onCriticalHit(targetEntity);
-                        }
-
-                        if (var4 > 0.0F)
-                        {
-                            this.onEnchantmentCritical(targetEntity);
-                        }
-
-                        if (var2 >= 18.0F)
-                        {
-                            this.triggerAchievement(AchievementList.overkill);
-                        }
-
-                        this.setLastAttacker(targetEntity);
-
-                        if (targetEntity instanceof EntityLivingBase)
-                        {
-                            EnchantmentHelper.func_151384_a((EntityLivingBase)targetEntity, this);
-                        }
-
-                        EnchantmentHelper.func_151385_b(this, targetEntity);
-                        ItemStack var15 = this.getCurrentEquippedItem();
-                        Object var16 = targetEntity;
-
-                        if (targetEntity instanceof EntityDragonPart)
-                        {
-                            IEntityMultiPart var17 = ((EntityDragonPart)targetEntity).entityDragonObj;
-
-                            if (var17 instanceof EntityLivingBase)
-                            {
-                                var16 = (EntityLivingBase)var17;
-                            }
-                        }
-
-                        if (var15 != null && var16 instanceof EntityLivingBase)
-                        {
-                            var15.hitEntity((EntityLivingBase)var16, this);
-
-                            if (var15.stackSize <= 0)
-                            {
-                                this.destroyCurrentEquippedItem();
-                            }
-                        }
-
-                        if (targetEntity instanceof EntityLivingBase)
-                        {
-                            this.addStat(StatList.damageDealtStat, Math.round(var2 * 10.0F));
-
-                            if (var7 > 0)
-                            {
-                                targetEntity.setFire(var7 * 4);
-                            }
-                        }
-
-                        this.addExhaustion(0.3F);
-                    }
-                    else if (var6)
-                    {
-                        targetEntity.extinguish();
-                    }
-                }
-            }
-        }
-    }
-
-    /**
-     * Called when the player performs a critical hit on the Entity. Args: entity that was hit critically
-     */
-    public void onCriticalHit(Entity p_71009_1_) {}
-
-    public void onEnchantmentCritical(Entity p_71047_1_) {}
-
-    public void respawnPlayer() {}
-
-    /**
-     * Will get destroyed next tick.
-     */
-    public void setDead()
-    {
-        super.setDead();
-        this.inventoryContainer.onContainerClosed(this);
-
-        if (this.openContainer != null)
-        {
-            this.openContainer.onContainerClosed(this);
-        }
-    }
-
-    /**
-     * Checks if this entity is inside of an opaque block
-     */
-    public boolean isEntityInsideOpaqueBlock()
-    {
-        return !this.sleeping && super.isEntityInsideOpaqueBlock();
-    }
-
-    public boolean func_175144_cb()
-    {
-        return false;
-    }
-
-    /**
-     * Returns the GameProfile for this player
-     */
-    public GameProfile getGameProfile()
-    {
-        return this.gameProfile;
-    }
-
-    public EntityPlayer.EnumStatus func_180469_a(BlockPos p_180469_1_)
-    {
-        if (!this.worldObj.isRemote)
-        {
-            if (this.isPlayerSleeping() || !this.isEntityAlive())
-            {
-                return EntityPlayer.EnumStatus.OTHER_PROBLEM;
-            }
-
-            if (!this.worldObj.provider.isSurfaceWorld())
-            {
-                return EntityPlayer.EnumStatus.NOT_POSSIBLE_HERE;
-            }
-
-            if (this.worldObj.isDaytime())
-            {
-                return EntityPlayer.EnumStatus.NOT_POSSIBLE_NOW;
-            }
-
-            if (Math.abs(this.posX - (double)p_180469_1_.getX()) > 3.0D || Math.abs(this.posY - (double)p_180469_1_.getY()) > 2.0D || Math.abs(this.posZ - (double)p_180469_1_.getZ()) > 3.0D)
-            {
-                return EntityPlayer.EnumStatus.TOO_FAR_AWAY;
-            }
-
-            double var2 = 8.0D;
-            double var4 = 5.0D;
-            List var6 = this.worldObj.getEntitiesWithinAABB(EntityMob.class, new AxisAlignedBB((double)p_180469_1_.getX() - var2, (double)p_180469_1_.getY() - var4, (double)p_180469_1_.getZ() - var2, (double)p_180469_1_.getX() + var2, (double)p_180469_1_.getY() + var4, (double)p_180469_1_.getZ() + var2));
-
-            if (!var6.isEmpty())
-            {
-                return EntityPlayer.EnumStatus.NOT_SAFE;
-            }
-        }
-
-        if (this.isRiding())
-        {
-            this.mountEntity((Entity)null);
-        }
-
-        this.setSize(0.2F, 0.2F);
-
-        if (this.worldObj.isBlockLoaded(p_180469_1_))
-        {
-            EnumFacing var7 = (EnumFacing)this.worldObj.getBlockState(p_180469_1_).getValue(BlockDirectional.AGE);
-            float var3 = 0.5F;
-            float var8 = 0.5F;
-
-            switch (EntityPlayer.SwitchEnumFacing.field_179420_a[var7.ordinal()])
-            {
-                case 1:
-                    var8 = 0.9F;
-                    break;
-
-                case 2:
-                    var8 = 0.1F;
-                    break;
-
-                case 3:
-                    var3 = 0.1F;
-                    break;
-
-                case 4:
-                    var3 = 0.9F;
-            }
-
-            this.func_175139_a(var7);
-            this.setPosition((double)((float)p_180469_1_.getX() + var3), (double)((float)p_180469_1_.getY() + 0.6875F), (double)((float)p_180469_1_.getZ() + var8));
-        }
-        else
-        {
-            this.setPosition((double)((float)p_180469_1_.getX() + 0.5F), (double)((float)p_180469_1_.getY() + 0.6875F), (double)((float)p_180469_1_.getZ() + 0.5F));
-        }
-
-        this.sleeping = true;
-        this.sleepTimer = 0;
-        this.playerLocation = p_180469_1_;
-        this.motionX = this.motionZ = this.motionY = 0.0D;
-
-        if (!this.worldObj.isRemote)
-        {
-            this.worldObj.updateAllPlayersSleepingFlag();
-        }
-
-        return EntityPlayer.EnumStatus.OK;
-    }
-
-    private void func_175139_a(EnumFacing p_175139_1_)
-    {
-        this.field_71079_bU = 0.0F;
-        this.field_71089_bV = 0.0F;
-
-        switch (EntityPlayer.SwitchEnumFacing.field_179420_a[p_175139_1_.ordinal()])
-        {
-            case 1:
-                this.field_71089_bV = -1.8F;
-                break;
-
-            case 2:
-                this.field_71089_bV = 1.8F;
-                break;
-
-            case 3:
-                this.field_71079_bU = 1.8F;
-                break;
-
-            case 4:
-                this.field_71079_bU = -1.8F;
-        }
-    }
-
-    /**
-     * Wake up the player if they're sleeping.
-     */
-    public void wakeUpPlayer(boolean p_70999_1_, boolean updateWorldFlag, boolean setSpawn)
-    {
-        this.setSize(0.6F, 1.8F);
-        IBlockState var4 = this.worldObj.getBlockState(this.playerLocation);
-
-        if (this.playerLocation != null && var4.getBlock() == Blocks.bed)
-        {
-            this.worldObj.setBlockState(this.playerLocation, var4.withProperty(BlockBed.OCCUPIED_PROP, Boolean.valueOf(false)), 4);
-            BlockPos var5 = BlockBed.getSafeExitLocation(this.worldObj, this.playerLocation, 0);
-
-            if (var5 == null)
-            {
-                var5 = this.playerLocation.offsetUp();
-            }
-
-            this.setPosition((double)((float)var5.getX() + 0.5F), (double)((float)var5.getY() + 0.1F), (double)((float)var5.getZ() + 0.5F));
-        }
-
-        this.sleeping = false;
-
-        if (!this.worldObj.isRemote && updateWorldFlag)
-        {
-            this.worldObj.updateAllPlayersSleepingFlag();
-        }
-
-        this.sleepTimer = p_70999_1_ ? 0 : 100;
-
-        if (setSpawn)
-        {
-            this.func_180473_a(this.playerLocation, false);
-        }
-    }
-
-    private boolean func_175143_p()
-    {
-        return this.worldObj.getBlockState(this.playerLocation).getBlock() == Blocks.bed;
-    }
-
-    public static BlockPos func_180467_a(World worldIn, BlockPos p_180467_1_, boolean p_180467_2_)
-    {
-        if (worldIn.getBlockState(p_180467_1_).getBlock() != Blocks.bed)
-        {
-            if (!p_180467_2_)
-            {
-                return null;
-            }
-            else
-            {
-                Material var3 = worldIn.getBlockState(p_180467_1_).getBlock().getMaterial();
-                Material var4 = worldIn.getBlockState(p_180467_1_.offsetUp()).getBlock().getMaterial();
-                boolean var5 = !var3.isSolid() && !var3.isLiquid();
-                boolean var6 = !var4.isSolid() && !var4.isLiquid();
-                return var5 && var6 ? p_180467_1_ : null;
-            }
-        }
-        else
-        {
-            return BlockBed.getSafeExitLocation(worldIn, p_180467_1_, 0);
-        }
-    }
-
-    /**
-     * Returns the orientation of the bed in degrees.
-     */
-    public float getBedOrientationInDegrees()
-    {
-        if (this.playerLocation != null)
-        {
-            EnumFacing var1 = (EnumFacing)this.worldObj.getBlockState(this.playerLocation).getValue(BlockDirectional.AGE);
-
-            switch (EntityPlayer.SwitchEnumFacing.field_179420_a[var1.ordinal()])
-            {
-                case 1:
-                    return 90.0F;
-
-                case 2:
-                    return 270.0F;
-
-                case 3:
-                    return 0.0F;
-
-                case 4:
-                    return 180.0F;
-            }
-        }
-
-        return 0.0F;
-    }
-
-    /**
-     * Returns whether player is sleeping or not
-     */
-    public boolean isPlayerSleeping()
-    {
-        return this.sleeping;
-    }
-
-    /**
-     * Returns whether or not the player is asleep and the screen has fully faded.
-     */
-    public boolean isPlayerFullyAsleep()
-    {
-        return this.sleeping && this.sleepTimer >= 100;
-    }
-
-    public int getSleepTimer()
-    {
-        return this.sleepTimer;
-    }
-
-    public void addChatComponentMessage(IChatComponent p_146105_1_) {}
-
-    public BlockPos func_180470_cg()
-    {
-        return this.spawnChunk;
-    }
-
-    public boolean isSpawnForced()
-    {
-        return this.spawnForced;
-    }
-
-    public void func_180473_a(BlockPos p_180473_1_, boolean p_180473_2_)
-    {
-        if (p_180473_1_ != null)
-        {
-            this.spawnChunk = p_180473_1_;
-            this.spawnForced = p_180473_2_;
-        }
-        else
-        {
-            this.spawnChunk = null;
-            this.spawnForced = false;
-        }
-    }
-
-    /**
-     * Will trigger the specified trigger.
-     */
-    public void triggerAchievement(StatBase p_71029_1_)
-    {
-        this.addStat(p_71029_1_, 1);
-    }
-
-    /**
-     * Adds a value to a statistic field.
-     */
-    public void addStat(StatBase p_71064_1_, int p_71064_2_) {}
-
-    public void func_175145_a(StatBase p_175145_1_) {}
-
-    /**
-     * Causes this entity to do an upwards motion (jumping).
-     */
-    public void jump()
-    {
-        super.jump();
-        this.triggerAchievement(StatList.jumpStat);
-
-        if (this.isSprinting())
-        {
-            this.addExhaustion(0.8F);
-        }
-        else
-        {
-            this.addExhaustion(0.2F);
-        }
-    }
-
-    /**
-     * Moves the entity based on the specified heading.  Args: strafe, forward
-     */
-    public void moveEntityWithHeading(float p_70612_1_, float p_70612_2_)
-    {
-        double var3 = this.posX;
-        double var5 = this.posY;
-        double var7 = this.posZ;
-
-        if (this.capabilities.isFlying && this.ridingEntity == null)
-        {
-            double var9 = this.motionY;
-            float var11 = this.jumpMovementFactor;
-            this.jumpMovementFactor = this.capabilities.getFlySpeed() * (float)(this.isSprinting() ? 2 : 1);
-            super.moveEntityWithHeading(p_70612_1_, p_70612_2_);
-            this.motionY = var9 * 0.6D;
-            this.jumpMovementFactor = var11;
-        }
-        else
-        {
-            super.moveEntityWithHeading(p_70612_1_, p_70612_2_);
-        }
-
-        this.addMovementStat(this.posX - var3, this.posY - var5, this.posZ - var7);
-    }
-
-    /**
-     * the movespeed used for the new AI system
-     */
-    public float getAIMoveSpeed()
-    {
-        return (float)this.getEntityAttribute(SharedMonsterAttributes.movementSpeed).getAttributeValue();
-    }
-
-    /**
-     * Adds a value to a movement statistic field - like run, walk, swin or climb.
-     */
-    public void addMovementStat(double p_71000_1_, double p_71000_3_, double p_71000_5_)
-    {
-        if (this.ridingEntity == null)
-        {
-            int var7;
-
-            if (this.isInsideOfMaterial(Material.water))
-            {
-                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_3_ * p_71000_3_ + p_71000_5_ * p_71000_5_) * 100.0F);
-
-                if (var7 > 0)
-                {
-                    this.addStat(StatList.distanceDoveStat, var7);
-                    this.addExhaustion(0.015F * (float)var7 * 0.01F);
-                }
-            }
-            else if (this.isInWater())
-            {
-                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
-
-                if (var7 > 0)
-                {
-                    this.addStat(StatList.distanceSwumStat, var7);
-                    this.addExhaustion(0.015F * (float)var7 * 0.01F);
-                }
-            }
-            else if (this.isOnLadder())
-            {
-                if (p_71000_3_ > 0.0D)
-                {
-                    this.addStat(StatList.distanceClimbedStat, (int)Math.round(p_71000_3_ * 100.0D));
-                }
-            }
-            else if (this.onGround)
-            {
-                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
-
-                if (var7 > 0)
-                {
-                    this.addStat(StatList.distanceWalkedStat, var7);
-
-                    if (this.isSprinting())
-                    {
-                        this.addStat(StatList.distanceSprintedStat, var7);
-                        this.addExhaustion(0.099999994F * (float)var7 * 0.01F);
-                    }
-                    else
-                    {
-                        if (this.isSneaking())
-                        {
-                            this.addStat(StatList.distanceCrouchedStat, var7);
-                        }
-
-                        this.addExhaustion(0.01F * (float)var7 * 0.01F);
-                    }
-                }
-            }
-            else
-            {
-                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
-
-                if (var7 > 25)
-                {
-                    this.addStat(StatList.distanceFlownStat, var7);
-                }
-            }
-        }
-    }
-
-    /**
-     * Adds a value to a mounted movement statistic field - by minecart, boat, or pig.
-     */
-    private void addMountedMovementStat(double p_71015_1_, double p_71015_3_, double p_71015_5_)
-    {
-        if (this.ridingEntity != null)
-        {
-            int var7 = Math.round(MathHelper.sqrt_double(p_71015_1_ * p_71015_1_ + p_71015_3_ * p_71015_3_ + p_71015_5_ * p_71015_5_) * 100.0F);
-
-            if (var7 > 0)
-            {
-                if (this.ridingEntity instanceof EntityMinecart)
-                {
-                    this.addStat(StatList.distanceByMinecartStat, var7);
-
-                    if (this.startMinecartRidingCoordinate == null)
-                    {
-                        this.startMinecartRidingCoordinate = new BlockPos(this);
-                    }
-                    else if (this.startMinecartRidingCoordinate.distanceSq((double)MathHelper.floor_double(this.posX), (double)MathHelper.floor_double(this.posY), (double)MathHelper.floor_double(this.posZ)) >= 1000000.0D)
-                    {
-                        this.triggerAchievement(AchievementList.onARail);
-                    }
-                }
-                else if (this.ridingEntity instanceof EntityBoat)
-                {
-                    this.addStat(StatList.distanceByBoatStat, var7);
-                }
-                else if (this.ridingEntity instanceof EntityPig)
-                {
-                    this.addStat(StatList.distanceByPigStat, var7);
-                }
-                else if (this.ridingEntity instanceof EntityHorse)
-                {
-                    this.addStat(StatList.distanceByHorseStat, var7);
-                }
-            }
-        }
-    }
-
-    public void fall(float distance, float damageMultiplier)
-    {
-        if (!this.capabilities.allowFlying)
-        {
-            if (distance >= 2.0F)
-            {
-                this.addStat(StatList.distanceFallenStat, (int)Math.round((double)distance * 100.0D));
-            }
-
-            super.fall(distance, damageMultiplier);
-        }
-    }
-
-    /**
-     * sets the players height back to normal after doing things like sleeping and dieing
-     */
-    protected void resetHeight()
-    {
-        if (!this.func_175149_v())
-        {
-            super.resetHeight();
-        }
-    }
-
-    protected String func_146067_o(int p_146067_1_)
-    {
-        return p_146067_1_ > 4 ? "game.player.hurt.fall.big" : "game.player.hurt.fall.small";
-    }
-
-    /**
-     * This method gets called when the entity kills another one.
-     */
-    public void onKillEntity(EntityLivingBase entityLivingIn)
-    {
-        if (entityLivingIn instanceof IMob)
-        {
-            this.triggerAchievement(AchievementList.killEnemy);
-        }
-
-        EntityList.EntityEggInfo var2 = (EntityList.EntityEggInfo)EntityList.entityEggs.get(Integer.valueOf(EntityList.getEntityID(entityLivingIn)));
-
-        if (var2 != null)
-        {
-            this.triggerAchievement(var2.field_151512_d);
-        }
-    }
-
-    /**
-     * Sets the Entity inside a web block.
-     */
-    public void setInWeb()
-    {
-        if (!this.capabilities.isFlying)
-        {
-            super.setInWeb();
-        }
-    }
-
-    public ItemStack getCurrentArmor(int p_82169_1_)
-    {
-        return this.inventory.armorItemInSlot(p_82169_1_);
-    }
-
-    /**
-     * Add experience points to player.
-     */
-    public void addExperience(int p_71023_1_)
-    {
-        this.addScore(p_71023_1_);
-        int var2 = Integer.MAX_VALUE - this.experienceTotal;
-
-        if (p_71023_1_ > var2)
-        {
-            p_71023_1_ = var2;
-        }
-
-        this.experience += (float)p_71023_1_ / (float)this.xpBarCap();
-
-        for (this.experienceTotal += p_71023_1_; this.experience >= 1.0F; this.experience /= (float)this.xpBarCap())
-        {
-            this.experience = (this.experience - 1.0F) * (float)this.xpBarCap();
-            this.addExperienceLevel(1);
-        }
-    }
-
-    public int func_175138_ci()
-    {
-        return this.field_175152_f;
-    }
-
-    public void func_71013_b(int p_71013_1_)
-    {
-        this.experienceLevel -= p_71013_1_;
-
-        if (this.experienceLevel < 0)
-        {
-            this.experienceLevel = 0;
-            this.experience = 0.0F;
-            this.experienceTotal = 0;
-        }
-
-        this.field_175152_f = this.rand.nextInt();
-    }
-
-    /**
-     * Add experience levels to this player.
-     */
-    public void addExperienceLevel(int p_82242_1_)
-    {
-        this.experienceLevel += p_82242_1_;
-
-        if (this.experienceLevel < 0)
-        {
-            this.experienceLevel = 0;
-            this.experience = 0.0F;
-            this.experienceTotal = 0;
-        }
-
-        if (p_82242_1_ > 0 && this.experienceLevel % 5 == 0 && (float)this.field_82249_h < (float)this.ticksExisted - 100.0F)
-        {
-            float var2 = this.experienceLevel > 30 ? 1.0F : (float)this.experienceLevel / 30.0F;
-            this.worldObj.playSoundAtEntity(this, "random.levelup", var2 * 0.75F, 1.0F);
-            this.field_82249_h = this.ticksExisted;
-        }
-    }
-
-    /**
-     * This method returns the cap amount of experience that the experience bar can hold. With each level, the
-     * experience cap on the player's experience bar is raised by 10.
-     */
-    public int xpBarCap()
-    {
-        return this.experienceLevel >= 30 ? 112 + (this.experienceLevel - 30) * 9 : (this.experienceLevel >= 15 ? 37 + (this.experienceLevel - 15) * 5 : 7 + this.experienceLevel * 2);
-    }
-
-    /**
-     * increases exhaustion level by supplied amount
-     */
-    public void addExhaustion(float p_71020_1_)
-    {
-        if (!this.capabilities.disableDamage)
-        {
-            if (!this.worldObj.isRemote)
-            {
-                this.foodStats.addExhaustion(p_71020_1_);
-            }
-        }
-    }
-
-    /**
-     * Returns the player's FoodStats object.
-     */
-    public FoodStats getFoodStats()
-    {
-        return this.foodStats;
-    }
-
-    public boolean canEat(boolean p_71043_1_)
-    {
-        return (p_71043_1_ || this.foodStats.needFood()) && !this.capabilities.disableDamage;
-    }
-
-    /**
-     * Checks if the player's health is not full and not zero.
-     */
-    public boolean shouldHeal()
-    {
-        return this.getHealth() > 0.0F && this.getHealth() < this.getMaxHealth();
-    }
-
-    /**
-     * sets the itemInUse when the use item button is clicked. Args: itemstack, int maxItemUseDuration
-     */
-    public void setItemInUse(ItemStack p_71008_1_, int p_71008_2_)
-    {
-        if (p_71008_1_ != this.itemInUse)
-        {
-            this.itemInUse = p_71008_1_;
-            this.itemInUseCount = p_71008_2_;
-
-            if (!this.worldObj.isRemote)
-            {
-                this.setEating(true);
-            }
-        }
-    }
-
-    public boolean func_175142_cm()
-    {
-        return this.capabilities.allowEdit;
-    }
-
-    public boolean func_175151_a(BlockPos p_175151_1_, EnumFacing p_175151_2_, ItemStack p_175151_3_)
-    {
-        if (this.capabilities.allowEdit)
-        {
-            return true;
-        }
-        else if (p_175151_3_ == null)
-        {
-            return false;
-        }
-        else
-        {
-            BlockPos var4 = p_175151_1_.offset(p_175151_2_.getOpposite());
-            Block var5 = this.worldObj.getBlockState(var4).getBlock();
-            return p_175151_3_.canPlaceOn(var5) || p_175151_3_.canEditBlocks();
-        }
-    }
-
-    /**
-     * Get the experience points the entity currently has.
-     */
-    protected int getExperiencePoints(EntityPlayer p_70693_1_)
-    {
-        if (this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
-        {
-            return 0;
-        }
-        else
-        {
-            int var2 = this.experienceLevel * 7;
-            return var2 > 100 ? 100 : var2;
-        }
-    }
-
-    /**
-     * Only use is to identify if class is an instance of player for experience dropping
-     */
-    protected boolean isPlayer()
-    {
-        return true;
-    }
-
-    public boolean getAlwaysRenderNameTagForRender()
-    {
-        return true;
-    }
-
-    /**
-     * Copies the values from the given player into this player if boolean par2 is true. Always clones Ender Chest
-     * Inventory.
-     */
-    public void clonePlayer(EntityPlayer p_71049_1_, boolean p_71049_2_)
-    {
-        if (p_71049_2_)
-        {
-            this.inventory.copyInventory(p_71049_1_.inventory);
-            this.setHealth(p_71049_1_.getHealth());
-            this.foodStats = p_71049_1_.foodStats;
-            this.experienceLevel = p_71049_1_.experienceLevel;
-            this.experienceTotal = p_71049_1_.experienceTotal;
-            this.experience = p_71049_1_.experience;
-            this.setScore(p_71049_1_.getScore());
-            this.teleportDirection = p_71049_1_.teleportDirection;
-        }
-        else if (this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
-        {
-            this.inventory.copyInventory(p_71049_1_.inventory);
-            this.experienceLevel = p_71049_1_.experienceLevel;
-            this.experienceTotal = p_71049_1_.experienceTotal;
-            this.experience = p_71049_1_.experience;
-            this.setScore(p_71049_1_.getScore());
-        }
-
-        this.theInventoryEnderChest = p_71049_1_.theInventoryEnderChest;
-        this.getDataWatcher().updateObject(10, Byte.valueOf(p_71049_1_.getDataWatcher().getWatchableObjectByte(10)));
-    }
-
-    /**
-     * returns if this entity triggers Block.onEntityWalking on the blocks they walk on. used for spiders and wolves to
-     * prevent them from trampling crops
-     */
-    protected boolean canTriggerWalking()
-    {
-        return !this.capabilities.isFlying;
-    }
-
-    /**
-     * Sends the player's abilities to the server (if there is one).
-     */
-    public void sendPlayerAbilities() {}
-
-    /**
-     * Sets the player's game mode and sends it to them.
-     */
-    public void setGameType(WorldSettings.GameType gameType) {}
-
-    /**
-     * Gets the name of this command sender (usually username, but possibly "Rcon")
-     */
-    public String getName()
-    {
-        return this.gameProfile.getName();
-    }
-
-    /**
-     * Returns the InventoryEnderChest of this player.
-     */
-    public InventoryEnderChest getInventoryEnderChest()
-    {
-        return this.theInventoryEnderChest;
-    }
-
-    /**
-     * 0: Tool in Hand; 1-4: Armor
-     */
-    public ItemStack getEquipmentInSlot(int p_71124_1_)
-    {
-        return p_71124_1_ == 0 ? this.inventory.getCurrentItem() : this.inventory.armorInventory[p_71124_1_ - 1];
-    }
-
-    /**
-     * Returns the item that this EntityLiving is holding, if any.
-     */
-    public ItemStack getHeldItem()
-    {
-        return this.inventory.getCurrentItem();
-    }
-
-    /**
-     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
-     */
-    public void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn)
-    {
-        this.inventory.armorInventory[slotIn] = itemStackIn;
-    }
-
-    /**
-     * Only used by renderer in EntityLivingBase subclasses.
-     * Determines if an entity is visible or not to a specfic player, if the entity is normally invisible.
-     * For EntityLivingBase subclasses, returning false when invisible will render the entity semitransparent.
-     */
-    public boolean isInvisibleToPlayer(EntityPlayer playerIn)
-    {
-        if (!this.isInvisible())
-        {
-            return false;
-        }
-        else if (playerIn.func_175149_v())
-        {
-            return false;
-        }
-        else
-        {
-            Team var2 = this.getTeam();
-            return var2 == null || playerIn == null || playerIn.getTeam() != var2 || !var2.func_98297_h();
-        }
-    }
-
-    public abstract boolean func_175149_v();
-
-    /**
-     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
-     */
-    public ItemStack[] getInventory()
-    {
-        return this.inventory.armorInventory;
-    }
-
-    public boolean isPushedByWater()
-    {
-        return !this.capabilities.isFlying;
-    }
-
-    public Scoreboard getWorldScoreboard()
-    {
-        return this.worldObj.getScoreboard();
-    }
-
-    public Team getTeam()
-    {
-        return this.getWorldScoreboard().getPlayersTeam(this.getName());
-    }
-
-    public IChatComponent getDisplayName()
-    {
-        ChatComponentText var1 = new ChatComponentText(ScorePlayerTeam.formatPlayerName(this.getTeam(), this.getName()));
-        var1.getChatStyle().setChatClickEvent(new ClickEvent(ClickEvent.Action.SUGGEST_COMMAND, "/msg " + this.getName() + " "));
-        var1.getChatStyle().setChatHoverEvent(this.func_174823_aP());
-        var1.getChatStyle().setInsertion(this.getName());
-        return var1;
-    }
-
-    public float getEyeHeight()
-    {
-        float var1 = 1.62F;
-
-        if (this.isPlayerSleeping())
-        {
-            var1 = 0.2F;
-        }
-
-        if (this.isSneaking())
-        {
-            var1 -= 0.08F;
-        }
-
-        return var1;
-    }
-
-    public void setAbsorptionAmount(float p_110149_1_)
-    {
-        if (p_110149_1_ < 0.0F)
-        {
-            p_110149_1_ = 0.0F;
-        }
-
-        this.getDataWatcher().updateObject(17, Float.valueOf(p_110149_1_));
-    }
-
-    public float getAbsorptionAmount()
-    {
-        return this.getDataWatcher().getWatchableObjectFloat(17);
-    }
-
-    /**
-     * Gets a players UUID given their GameProfie
-     */
-    public static UUID getUUID(GameProfile p_146094_0_)
-    {
-        UUID var1 = p_146094_0_.getId();
-
-        if (var1 == null)
-        {
-            var1 = func_175147_b(p_146094_0_.getName());
-        }
-
-        return var1;
-    }
-
-    public static UUID func_175147_b(String p_175147_0_)
-    {
-        return UUID.nameUUIDFromBytes(("OfflinePlayer:" + p_175147_0_).getBytes(Charsets.UTF_8));
-    }
-
-    public boolean func_175146_a(LockCode p_175146_1_)
-    {
-        if (p_175146_1_.isEmpty())
-        {
-            return true;
-        }
-        else
-        {
-            ItemStack var2 = this.getCurrentEquippedItem();
-            return var2 != null && var2.hasDisplayName() ? var2.getDisplayName().equals(p_175146_1_.getLock()) : false;
-        }
-    }
-
-    public boolean func_175148_a(EnumPlayerModelParts p_175148_1_)
-    {
-        return (this.getDataWatcher().getWatchableObjectByte(10) & p_175148_1_.func_179327_a()) == p_175148_1_.func_179327_a();
-    }
-
-    public boolean sendCommandFeedback()
-    {
-        return MinecraftServer.getServer().worldServers[0].getGameRules().getGameRuleBooleanValue("sendCommandFeedback");
-    }
-
-    public boolean func_174820_d(int p_174820_1_, ItemStack p_174820_2_)
-    {
-        if (p_174820_1_ >= 0 && p_174820_1_ < this.inventory.mainInventory.length)
-        {
-            this.inventory.setInventorySlotContents(p_174820_1_, p_174820_2_);
-            return true;
-        }
-        else
-        {
-            int var3 = p_174820_1_ - 100;
-            int var4;
-
-            if (var3 >= 0 && var3 < this.inventory.armorInventory.length)
-            {
-                var4 = var3 + 1;
-
-                if (p_174820_2_ != null && p_174820_2_.getItem() != null)
-                {
-                    if (p_174820_2_.getItem() instanceof ItemArmor)
-                    {
-                        if (EntityLiving.getArmorPosition(p_174820_2_) != var4)
-                        {
-                            return false;
-                        }
-                    }
-                    else if (var4 != 4 || p_174820_2_.getItem() != Items.skull && !(p_174820_2_.getItem() instanceof ItemBlock))
-                    {
-                        return false;
-                    }
-                }
-
-                this.inventory.setInventorySlotContents(var3 + this.inventory.mainInventory.length, p_174820_2_);
-                return true;
-            }
-            else
-            {
-                var4 = p_174820_1_ - 200;
-
-                if (var4 >= 0 && var4 < this.theInventoryEnderChest.getSizeInventory())
-                {
-                    this.theInventoryEnderChest.setInventorySlotContents(var4, p_174820_2_);
-                    return true;
-                }
-                else
-                {
-                    return false;
-                }
-            }
-        }
-    }
-
-    public boolean func_175140_cp()
-    {
-        return this.field_175153_bG;
-    }
-
-    public void func_175150_k(boolean p_175150_1_)
-    {
-        this.field_175153_bG = p_175150_1_;
-    }
-
-    public static enum EnumChatVisibility
-    {
-        FULL("FULL", 0, 0, "options.chat.visibility.full"),
-        SYSTEM("SYSTEM", 1, 1, "options.chat.visibility.system"),
-        HIDDEN("HIDDEN", 2, 2, "options.chat.visibility.hidden");
-        private static final EntityPlayer.EnumChatVisibility[] field_151432_d = new EntityPlayer.EnumChatVisibility[values().length];
-        private final int chatVisibility;
-        private final String resourceKey;
-
-        private static final EntityPlayer.EnumChatVisibility[] $VALUES = new EntityPlayer.EnumChatVisibility[]{FULL, SYSTEM, HIDDEN};
-        private static final String __OBFID = "CL_00001714";
-
-        private EnumChatVisibility(String p_i45323_1_, int p_i45323_2_, int p_i45323_3_, String p_i45323_4_)
-        {
-            this.chatVisibility = p_i45323_3_;
-            this.resourceKey = p_i45323_4_;
-        }
-
-        public int getChatVisibility()
-        {
-            return this.chatVisibility;
-        }
-
-        public static EntityPlayer.EnumChatVisibility getEnumChatVisibility(int p_151426_0_)
-        {
-            return field_151432_d[p_151426_0_ % field_151432_d.length];
-        }
-
-        public String getResourceKey()
-        {
-            return this.resourceKey;
-        }
-
-        static {
-            EntityPlayer.EnumChatVisibility[] var0 = values();
-            int var1 = var0.length;
-
-            for (int var2 = 0; var2 < var1; ++var2)
-            {
-                EntityPlayer.EnumChatVisibility var3 = var0[var2];
-                field_151432_d[var3.chatVisibility] = var3;
-            }
-        }
-    }
-
-    public static enum EnumStatus
-    {
-        OK("OK", 0),
-        NOT_POSSIBLE_HERE("NOT_POSSIBLE_HERE", 1),
-        NOT_POSSIBLE_NOW("NOT_POSSIBLE_NOW", 2),
-        TOO_FAR_AWAY("TOO_FAR_AWAY", 3),
-        OTHER_PROBLEM("OTHER_PROBLEM", 4),
-        NOT_SAFE("NOT_SAFE", 5);
-
-        private static final EntityPlayer.EnumStatus[] $VALUES = new EntityPlayer.EnumStatus[]{OK, NOT_POSSIBLE_HERE, NOT_POSSIBLE_NOW, TOO_FAR_AWAY, OTHER_PROBLEM, NOT_SAFE};
-        private static final String __OBFID = "CL_00001712";
-
-        private EnumStatus(String p_i1751_1_, int p_i1751_2_) {}
-    }
-
-    static final class SwitchEnumFacing
-    {
-        static final int[] field_179420_a = new int[EnumFacing.values().length];
-        private static final String __OBFID = "CL_00002188";
-
-        static
-        {
-            try
-            {
-                field_179420_a[EnumFacing.SOUTH.ordinal()] = 1;
-            }
-            catch (NoSuchFieldError var4)
-            {
-                ;
-            }
-
-            try
-            {
-                field_179420_a[EnumFacing.NORTH.ordinal()] = 2;
-            }
-            catch (NoSuchFieldError var3)
-            {
-                ;
-            }
-
-            try
-            {
-                field_179420_a[EnumFacing.WEST.ordinal()] = 3;
-            }
-            catch (NoSuchFieldError var2)
-            {
-                ;
-            }
-
-            try
-            {
-                field_179420_a[EnumFacing.EAST.ordinal()] = 4;
-            }
-            catch (NoSuchFieldError var1)
-            {
-                ;
-            }
-        }
-    }
-}
+package net.minecraft.entity.player;
+
+import java.util.Collection;
+import java.util.Iterator;
+import java.util.List;
+import java.util.UUID;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.bot.WurstBot;
+import tk.wurst_client.mods.AntiKnockbackMod;
+import net.minecraft.block.Block;
+import net.minecraft.block.BlockBed;
+import net.minecraft.block.BlockDirectional;
+import net.minecraft.block.material.Material;
+import net.minecraft.block.state.IBlockState;
+import net.minecraft.client.Minecraft;
+import net.minecraft.command.server.CommandBlockLogic;
+import net.minecraft.enchantment.EnchantmentHelper;
+import net.minecraft.entity.Entity;
+import net.minecraft.entity.EntityList;
+import net.minecraft.entity.EntityLiving;
+import net.minecraft.entity.EntityLivingBase;
+import net.minecraft.entity.EnumCreatureAttribute;
+import net.minecraft.entity.IEntityMultiPart;
+import net.minecraft.entity.IMerchant;
+import net.minecraft.entity.SharedMonsterAttributes;
+import net.minecraft.entity.ai.attributes.IAttributeInstance;
+import net.minecraft.entity.boss.EntityDragonPart;
+import net.minecraft.entity.item.EntityBoat;
+import net.minecraft.entity.item.EntityItem;
+import net.minecraft.entity.item.EntityMinecart;
+import net.minecraft.entity.monster.EntityMob;
+import net.minecraft.entity.monster.IMob;
+import net.minecraft.entity.passive.EntityHorse;
+import net.minecraft.entity.passive.EntityPig;
+import net.minecraft.entity.projectile.EntityArrow;
+import net.minecraft.entity.projectile.EntityFishHook;
+import net.minecraft.event.ClickEvent;
+import net.minecraft.init.Blocks;
+import net.minecraft.init.Items;
+import net.minecraft.inventory.Container;
+import net.minecraft.inventory.ContainerPlayer;
+import net.minecraft.inventory.IInventory;
+import net.minecraft.inventory.InventoryEnderChest;
+import net.minecraft.item.EnumAction;
+import net.minecraft.item.Item;
+import net.minecraft.item.ItemArmor;
+import net.minecraft.item.ItemBlock;
+import net.minecraft.item.ItemStack;
+import net.minecraft.nbt.NBTTagCompound;
+import net.minecraft.nbt.NBTTagList;
+import net.minecraft.network.play.server.S12PacketEntityVelocity;
+import net.minecraft.potion.Potion;
+import net.minecraft.scoreboard.IScoreObjectiveCriteria;
+import net.minecraft.scoreboard.Score;
+import net.minecraft.scoreboard.ScoreObjective;
+import net.minecraft.scoreboard.ScorePlayerTeam;
+import net.minecraft.scoreboard.Scoreboard;
+import net.minecraft.scoreboard.Team;
+import net.minecraft.server.MinecraftServer;
+import net.minecraft.stats.AchievementList;
+import net.minecraft.stats.StatBase;
+import net.minecraft.stats.StatList;
+import net.minecraft.tileentity.TileEntitySign;
+import net.minecraft.util.AxisAlignedBB;
+import net.minecraft.util.BlockPos;
+import net.minecraft.util.ChatComponentText;
+import net.minecraft.util.DamageSource;
+import net.minecraft.util.EnumFacing;
+import net.minecraft.util.EnumParticleTypes;
+import net.minecraft.util.FoodStats;
+import net.minecraft.util.IChatComponent;
+import net.minecraft.util.MathHelper;
+import net.minecraft.util.Vec3;
+import net.minecraft.world.EnumDifficulty;
+import net.minecraft.world.IInteractionObject;
+import net.minecraft.world.LockCode;
+import net.minecraft.world.World;
+import net.minecraft.world.WorldSettings;
+
+import com.google.common.base.Charsets;
+import com.google.common.collect.Lists;
+import com.mojang.authlib.GameProfile;
+
+public abstract class EntityPlayer extends EntityLivingBase
+{
+    /** Inventory of the player */
+    public InventoryPlayer inventory = new InventoryPlayer(this);
+    private InventoryEnderChest theInventoryEnderChest = new InventoryEnderChest();
+
+    /**
+     * The Container for the player's inventory (which opens when they press E)
+     */
+    public Container inventoryContainer;
+
+    /** The Container the player has open. */
+    public Container openContainer;
+
+    /** The food object of the player, the general hunger logic. */
+    protected FoodStats foodStats = new FoodStats();
+
+    /**
+     * Used to tell if the player pressed jump twice. If this is at 0 and it's pressed (And they are allowed to fly, as
+     * defined in the player's movementInput) it sets this to 7. If it's pressed and it's greater than 0 enable fly.
+     */
+    protected int flyToggleTimer;
+    public float prevCameraYaw;
+    public float cameraYaw;
+
+    /**
+     * Used by EntityPlayer to prevent too many xp orbs from getting absorbed at once.
+     */
+    public int xpCooldown;
+    public double field_71091_bM;
+    public double field_71096_bN;
+    public double field_71097_bO;
+    public double field_71094_bP;
+    public double field_71095_bQ;
+    public double field_71085_bR;
+
+    /** Boolean value indicating weather a player is sleeping or not */
+    protected boolean sleeping;
+
+    /** the current location of the player */
+    public BlockPos playerLocation;
+    private int sleepTimer;
+    public float field_71079_bU;
+    public float field_71082_cx;
+    public float field_71089_bV;
+
+    /** holds the spawn chunk of the player */
+    private BlockPos spawnChunk;
+
+    /**
+     * Whether this player's spawn point is forced, preventing execution of bed checks.
+     */
+    private boolean spawnForced;
+
+    /** Holds the coordinate of the player when enter a minecraft to ride. */
+    private BlockPos startMinecartRidingCoordinate;
+
+    /** The player's capabilities. (See class PlayerCapabilities) */
+    public PlayerCapabilities capabilities = new PlayerCapabilities();
+
+    /** The current experience level the player is on. */
+    public int experienceLevel;
+
+    /**
+     * The total amount of experience the player has. This also includes the amount of experience within their
+     * Experience Bar.
+     */
+    public int experienceTotal;
+
+    /**
+     * The current amount of experience the player has within their Experience Bar.
+     */
+    public float experience;
+    private int field_175152_f;
+
+    /**
+     * This is the item that is in use when the player is holding down the useItemButton (e.g., bow, food, sword)
+     */
+    private ItemStack itemInUse;
+
+    /**
+     * This field starts off equal to getMaxItemUseDuration and is decremented on each tick
+     */
+    private int itemInUseCount;
+    protected float speedOnGround = 0.1F;
+    protected float speedInAir = 0.02F;
+    private int field_82249_h;
+
+    /** The player's unique game profile */
+    private final GameProfile gameProfile;
+    private boolean field_175153_bG = false;
+
+    /**
+     * An instance of a fishing rod's hook. If this isn't null, the icon image of the fishing rod is slightly different
+     */
+    public EntityFishHook fishEntity;
+    private static final String __OBFID = "CL_00001711";
+
+    public EntityPlayer(World worldIn, GameProfile p_i45324_2_)
+    {
+        super(worldIn);
+        this.entityUniqueID = getUUID(p_i45324_2_);
+        this.gameProfile = p_i45324_2_;
+        this.inventoryContainer = new ContainerPlayer(this.inventory, !worldIn.isRemote, this);
+        this.openContainer = this.inventoryContainer;
+        BlockPos var3 = worldIn.getSpawnPoint();
+        this.setLocationAndAngles((double)var3.getX() + 0.5D, (double)(var3.getY() + 1), (double)var3.getZ() + 0.5D, 0.0F, 0.0F);
+        this.field_70741_aB = 180.0F;
+        this.fireResistance = 20;
+    }
+
+    protected void applyEntityAttributes()
+    {
+        super.applyEntityAttributes();
+        this.getAttributeMap().registerAttribute(SharedMonsterAttributes.attackDamage).setBaseValue(1.0D);
+        this.getEntityAttribute(SharedMonsterAttributes.movementSpeed).setBaseValue(0.10000000149011612D);
+    }
+
+    protected void entityInit()
+    {
+        super.entityInit();
+        this.dataWatcher.addObject(16, Byte.valueOf((byte)0));
+        this.dataWatcher.addObject(17, Float.valueOf(0.0F));
+        this.dataWatcher.addObject(18, Integer.valueOf(0));
+        this.dataWatcher.addObject(10, Byte.valueOf((byte)0));
+    }
+
+    /**
+     * returns the ItemStack containing the itemInUse
+     */
+    public ItemStack getItemInUse()
+    {
+        return this.itemInUse;
+    }
+
+    /**
+     * Returns the item in use count
+     */
+    public int getItemInUseCount()
+    {
+        return this.itemInUseCount;
+    }
+
+    /**
+     * Checks if the entity is currently using an item (e.g., bow, food, sword) by holding down the useItemButton
+     */
+    public boolean isUsingItem()
+    {
+        return this.itemInUse != null;
+    }
+
+    /**
+     * gets the duration for how long the current itemInUse has been in use
+     */
+    public int getItemInUseDuration()
+    {
+        return this.isUsingItem() ? this.itemInUse.getMaxItemUseDuration() - this.itemInUseCount : 0;
+    }
+
+    public void stopUsingItem()
+    {
+        if (this.itemInUse != null)
+        {
+            this.itemInUse.onPlayerStoppedUsing(this.worldObj, this, this.itemInUseCount);
+        }
+
+        this.clearItemInUse();
+    }
+
+    public void clearItemInUse()
+    {
+        this.itemInUse = null;
+        this.itemInUseCount = 0;
+
+        if (!this.worldObj.isRemote)
+        {
+            this.setEating(false);
+        }
+    }
+
+    public boolean isBlocking()
+    {
+        return this.isUsingItem() && this.itemInUse.getItem().getItemUseAction(this.itemInUse) == EnumAction.BLOCK;
+    }
+
+    /**
+     * Called to update the entity's position/logic.
+     */
+    public void onUpdate()
+    {
+        this.noClip = this.isSpectator();
+
+        if (this.isSpectator())
+        {
+            this.onGround = false;
+        }
+
+        if (this.itemInUse != null)
+        {
+            ItemStack var1 = this.inventory.getCurrentItem();
+
+            if (var1 == this.itemInUse)
+            {
+                if (this.itemInUseCount <= 25 && this.itemInUseCount % 4 == 0)
+                {
+                    this.updateItemUse(var1, 5);
+                }
+
+                if (--this.itemInUseCount == 0 && !this.worldObj.isRemote)
+                {
+                    this.onItemUseFinish();
+                }
+            }
+            else
+            {
+                this.clearItemInUse();
+            }
+        }
+
+        if (this.xpCooldown > 0)
+        {
+            --this.xpCooldown;
+        }
+
+        if (this.isPlayerSleeping())
+        {
+            ++this.sleepTimer;
+
+            if (this.sleepTimer > 100)
+            {
+                this.sleepTimer = 100;
+            }
+
+            if (!this.worldObj.isRemote)
+            {
+                if (!this.func_175143_p())
+                {
+                    this.wakeUpPlayer(true, true, false);
+                }
+                else if (this.worldObj.isDaytime())
+                {
+                    this.wakeUpPlayer(false, true, true);
+                }
+            }
+        }
+        else if (this.sleepTimer > 0)
+        {
+            ++this.sleepTimer;
+
+            if (this.sleepTimer >= 110)
+            {
+                this.sleepTimer = 0;
+            }
+        }
+
+        super.onUpdate();
+
+        if (!this.worldObj.isRemote && this.openContainer != null && !this.openContainer.canInteractWith(this))
+        {
+            this.closeScreen();
+            this.openContainer = this.inventoryContainer;
+        }
+
+        if (this.isBurning() && this.capabilities.disableDamage)
+        {
+            this.extinguish();
+        }
+
+        this.field_71091_bM = this.field_71094_bP;
+        this.field_71096_bN = this.field_71095_bQ;
+        this.field_71097_bO = this.field_71085_bR;
+        double var14 = this.posX - this.field_71094_bP;
+        double var3 = this.posY - this.field_71095_bQ;
+        double var5 = this.posZ - this.field_71085_bR;
+        double var7 = 10.0D;
+
+        if (var14 > var7)
+        {
+            this.field_71091_bM = this.field_71094_bP = this.posX;
+        }
+
+        if (var5 > var7)
+        {
+            this.field_71097_bO = this.field_71085_bR = this.posZ;
+        }
+
+        if (var3 > var7)
+        {
+            this.field_71096_bN = this.field_71095_bQ = this.posY;
+        }
+
+        if (var14 < -var7)
+        {
+            this.field_71091_bM = this.field_71094_bP = this.posX;
+        }
+
+        if (var5 < -var7)
+        {
+            this.field_71097_bO = this.field_71085_bR = this.posZ;
+        }
+
+        if (var3 < -var7)
+        {
+            this.field_71096_bN = this.field_71095_bQ = this.posY;
+        }
+
+        this.field_71094_bP += var14 * 0.25D;
+        this.field_71085_bR += var5 * 0.25D;
+        this.field_71095_bQ += var3 * 0.25D;
+
+        if (this.ridingEntity == null)
+        {
+            this.startMinecartRidingCoordinate = null;
+        }
+
+        if (!this.worldObj.isRemote)
+        {
+            this.foodStats.onUpdate(this);
+            this.triggerAchievement(StatList.minutesPlayedStat);
+
+            if (this.isEntityAlive())
+            {
+                this.triggerAchievement(StatList.timeSinceDeathStat);
+            }
+        }
+
+        int var9 = 29999999;
+        double var10 = MathHelper.clamp_double(this.posX, -2.9999999E7D, 2.9999999E7D);
+        double var12 = MathHelper.clamp_double(this.posZ, -2.9999999E7D, 2.9999999E7D);
+
+        if (var10 != this.posX || var12 != this.posZ)
+        {
+            this.setPosition(var10, this.posY, var12);
+        }
+    }
+
+    /**
+     * Return the amount of time this entity should stay in a portal before being transported.
+     */
+    public int getMaxInPortalTime()
+    {
+        return this.capabilities.disableDamage ? 0 : 80;
+    }
+
+    protected String getSwimSound()
+    {
+        return "game.player.swim";
+    }
+
+    protected String getSplashSound()
+    {
+        return "game.player.swim.splash";
+    }
+
+    /**
+     * Return the amount of cooldown before this entity can use a portal again.
+     */
+    public int getPortalCooldown()
+    {
+        return 10;
+    }
+
+    public void playSound(String name, float volume, float pitch)
+    {
+        this.worldObj.playSoundToNearExcept(this, name, volume, pitch);
+    }
+
+    /**
+     * Plays sounds and makes particles for item in use state
+     */
+    protected void updateItemUse(ItemStack itemStackIn, int p_71010_2_)
+    {
+        if (itemStackIn.getItemUseAction() == EnumAction.DRINK)
+        {
+            this.playSound("random.drink", 0.5F, this.worldObj.rand.nextFloat() * 0.1F + 0.9F);
+        }
+
+        if (itemStackIn.getItemUseAction() == EnumAction.EAT)
+        {
+            for (int var3 = 0; var3 < p_71010_2_; ++var3)
+            {
+                Vec3 var4 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.1D, Math.random() * 0.1D + 0.1D, 0.0D);
+                var4 = var4.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
+                var4 = var4.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
+                double var5 = (double)(-this.rand.nextFloat()) * 0.6D - 0.3D;
+                Vec3 var7 = new Vec3(((double)this.rand.nextFloat() - 0.5D) * 0.3D, var5, 0.6D);
+                var7 = var7.rotatePitch(-this.rotationPitch * (float)Math.PI / 180.0F);
+                var7 = var7.rotateYaw(-this.rotationYaw * (float)Math.PI / 180.0F);
+                var7 = var7.addVector(this.posX, this.posY + (double)this.getEyeHeight(), this.posZ);
+
+                if (itemStackIn.getHasSubtypes())
+                {
+                    this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var7.xCoord, var7.yCoord, var7.zCoord, var4.xCoord, var4.yCoord + 0.05D, var4.zCoord, new int[] {Item.getIdFromItem(itemStackIn.getItem()), itemStackIn.getMetadata()});
+                }
+                else
+                {
+                    this.worldObj.spawnParticle(EnumParticleTypes.ITEM_CRACK, var7.xCoord, var7.yCoord, var7.zCoord, var4.xCoord, var4.yCoord + 0.05D, var4.zCoord, new int[] {Item.getIdFromItem(itemStackIn.getItem())});
+                }
+            }
+
+            this.playSound("random.eat", 0.5F + 0.5F * (float)this.rand.nextInt(2), (this.rand.nextFloat() - this.rand.nextFloat()) * 0.2F + 1.0F);
+        }
+    }
+
+    /**
+     * Used for when item use count runs out, ie: eating completed
+     */
+    protected void onItemUseFinish()
+    {
+        if (this.itemInUse != null)
+        {
+            this.updateItemUse(this.itemInUse, 16);
+            int var1 = this.itemInUse.stackSize;
+            ItemStack var2 = this.itemInUse.onItemUseFinish(this.worldObj, this);
+
+            if (var2 != this.itemInUse || var2 != null && var2.stackSize != var1)
+            {
+                this.inventory.mainInventory[this.inventory.currentItem] = var2;
+
+                if (var2.stackSize == 0)
+                {
+                    this.inventory.mainInventory[this.inventory.currentItem] = null;
+                }
+            }
+
+            this.clearItemInUse();
+        }
+    }
+
+    public void handleHealthUpdate(byte p_70103_1_)
+    {
+        if (p_70103_1_ == 9)
+        {
+            this.onItemUseFinish();
+        }
+        else if (p_70103_1_ == 23)
+        {
+            this.field_175153_bG = false;
+        }
+        else if (p_70103_1_ == 22)
+        {
+            this.field_175153_bG = true;
+        }
+        else
+        {
+            super.handleHealthUpdate(p_70103_1_);
+        }
+    }
+
+    /**
+     * Dead and sleeping entities cannot move
+     */
+    protected boolean isMovementBlocked()
+    {
+        return this.getHealth() <= 0.0F || this.isPlayerSleeping();
+    }
+
+    /**
+     * set current crafting inventory back to the 2x2 square
+     */
+    protected void closeScreen()
+    {
+        this.openContainer = this.inventoryContainer;
+    }
+
+    /**
+     * Handles updating while being ridden by an entity
+     */
+    public void updateRidden()
+    {
+        if (!this.worldObj.isRemote && this.isSneaking())
+        {
+            this.mountEntity((Entity)null);
+            this.setSneaking(false);
+        }
+        else
+        {
+            double var1 = this.posX;
+            double var3 = this.posY;
+            double var5 = this.posZ;
+            float var7 = this.rotationYaw;
+            float var8 = this.rotationPitch;
+            super.updateRidden();
+            this.prevCameraYaw = this.cameraYaw;
+            this.cameraYaw = 0.0F;
+            this.addMountedMovementStat(this.posX - var1, this.posY - var3, this.posZ - var5);
+
+            if (this.ridingEntity instanceof EntityPig)
+            {
+                this.rotationPitch = var8;
+                this.rotationYaw = var7;
+                this.renderYawOffset = ((EntityPig)this.ridingEntity).renderYawOffset;
+            }
+        }
+    }
+
+    /**
+     * Keeps moving the entity up so it isn't colliding with blocks and other requirements for this entity to be spawned
+     * (only actually used on players though its also on Entity)
+     */
+    public void preparePlayerToSpawn()
+    {
+        this.setSize(0.6F, 1.8F);
+        super.preparePlayerToSpawn();
+        this.setHealth(this.getMaxHealth());
+        this.deathTime = 0;
+    }
+
+    protected void updateEntityActionState()
+    {
+        super.updateEntityActionState();
+        this.updateArmSwingProgress();
+        this.rotationYawHead = this.rotationYaw;
+    }
+
+    /**
+     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
+     * use this to react to sunlight and start to burn.
+     */
+    public void onLivingUpdate()
+    {
+        if (this.flyToggleTimer > 0)
+        {
+            --this.flyToggleTimer;
+        }
+
+        if (this.worldObj.getDifficulty() == EnumDifficulty.PEACEFUL && this.worldObj.getGameRules().getGameRuleBooleanValue("naturalRegeneration"))
+        {
+            if (this.getHealth() < this.getMaxHealth() && this.ticksExisted % 20 == 0)
+            {
+                this.heal(1.0F);
+            }
+
+            if (this.foodStats.needFood() && this.ticksExisted % 10 == 0)
+            {
+                this.foodStats.setFoodLevel(this.foodStats.getFoodLevel() + 1);
+            }
+        }
+
+        this.inventory.decrementAnimations();
+        this.prevCameraYaw = this.cameraYaw;
+        super.onLivingUpdate();
+        IAttributeInstance var1 = this.getEntityAttribute(SharedMonsterAttributes.movementSpeed);
+
+        if (!this.worldObj.isRemote)
+        {
+            var1.setBaseValue((double)this.capabilities.getWalkSpeed());
+        }
+
+        this.jumpMovementFactor = this.speedInAir;
+
+        if (this.isSprinting())
+        {
+            this.jumpMovementFactor = (float)((double)this.jumpMovementFactor + (double)this.speedInAir * 0.3D);
+        }
+
+        this.setAIMoveSpeed((float)var1.getAttributeValue());
+        float var2 = MathHelper.sqrt_double(this.motionX * this.motionX + this.motionZ * this.motionZ);
+        float var3 = (float)(Math.atan(-this.motionY * 0.20000000298023224D) * 15.0D);
+
+        if (var2 > 0.1F)
+        {
+            var2 = 0.1F;
+        }
+
+        if (!this.onGround || this.getHealth() <= 0.0F)
+        {
+            var2 = 0.0F;
+        }
+
+        if (this.onGround || this.getHealth() <= 0.0F)
+        {
+            var3 = 0.0F;
+        }
+
+        this.cameraYaw += (var2 - this.cameraYaw) * 0.4F;
+        this.cameraPitch += (var3 - this.cameraPitch) * 0.8F;
+
+        if (this.getHealth() > 0.0F && !this.isSpectator())
+        {
+            AxisAlignedBB var4 = null;
+
+            if (this.ridingEntity != null && !this.ridingEntity.isDead)
+            {
+                var4 = this.getEntityBoundingBox().union(this.ridingEntity.getEntityBoundingBox()).expand(1.0D, 0.0D, 1.0D);
+            }
+            else
+            {
+                var4 = this.getEntityBoundingBox().expand(1.0D, 0.5D, 1.0D);
+            }
+
+            List var5 = this.worldObj.getEntitiesWithinAABBExcludingEntity(this, var4);
+
+            for (int var6 = 0; var6 < var5.size(); ++var6)
+            {
+                Entity var7 = (Entity)var5.get(var6);
+
+                if (!var7.isDead)
+                {
+                    this.collideWithPlayer(var7);
+                }
+            }
+        }
+    }
+
+    private void collideWithPlayer(Entity p_71044_1_)
+    {
+        p_71044_1_.onCollideWithPlayer(this);
+    }
+
+    public int getScore()
+    {
+        return this.dataWatcher.getWatchableObjectInt(18);
+    }
+
+    /**
+     * Set player's score
+     */
+    public void setScore(int p_85040_1_)
+    {
+        this.dataWatcher.updateObject(18, Integer.valueOf(p_85040_1_));
+    }
+
+    /**
+     * Add to player's score
+     */
+    public void addScore(int p_85039_1_)
+    {
+        int var2 = this.getScore();
+        this.dataWatcher.updateObject(18, Integer.valueOf(var2 + p_85039_1_));
+    }
+
+    /**
+     * Called when the mob's health reaches 0.
+     */
+    public void onDeath(DamageSource cause)
+    {
+    	//TODO: Client
+    	if(this.equals(Minecraft.getMinecraft().thePlayer) && WurstBot.isEnabled())
+			Minecraft.getMinecraft().displayGuiScreen(null);
+    	
+        super.onDeath(cause);
+        this.setSize(0.2F, 0.2F);
+        this.setPosition(this.posX, this.posY, this.posZ);
+        this.motionY = 0.10000000149011612D;
+
+        if (this.getName().equals("Notch"))
+        {
+            this.func_146097_a(new ItemStack(Items.apple, 1), true, false);
+        }
+
+        if (!this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
+        {
+            this.inventory.dropAllItems();
+        }
+
+        if (cause != null)
+        {
+            this.motionX = (double)(-MathHelper.cos((this.attackedAtYaw + this.rotationYaw) * (float)Math.PI / 180.0F) * 0.1F);
+            this.motionZ = (double)(-MathHelper.sin((this.attackedAtYaw + this.rotationYaw) * (float)Math.PI / 180.0F) * 0.1F);
+        }
+        else
+        {
+            this.motionX = this.motionZ = 0.0D;
+        }
+
+        this.triggerAchievement(StatList.deathsStat);
+        this.func_175145_a(StatList.timeSinceDeathStat);
+    }
+
+    /**
+     * Returns the sound this mob makes when it is hurt.
+     */
+    protected String getHurtSound()
+    {
+        return "game.player.hurt";
+    }
+
+    /**
+     * Returns the sound this mob makes on death.
+     */
+    protected String getDeathSound()
+    {
+        return "game.player.die";
+    }
+
+    /**
+     * Adds a value to the player score. Currently not actually used and the entity passed in does nothing. Args:
+     * entity, scoreToAdd
+     */
+    public void addToPlayerScore(Entity entityIn, int amount)
+    {
+        this.addScore(amount);
+        Collection var3 = this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.totalKillCount);
+
+        if (entityIn instanceof EntityPlayer)
+        {
+            this.triggerAchievement(StatList.playerKillsStat);
+            var3.addAll(this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.playerKillCount));
+            var3.addAll(this.func_175137_e(entityIn));
+        }
+        else
+        {
+            this.triggerAchievement(StatList.mobKillsStat);
+        }
+
+        Iterator var4 = var3.iterator();
+
+        while (var4.hasNext())
+        {
+            ScoreObjective var5 = (ScoreObjective)var4.next();
+            Score var6 = this.getWorldScoreboard().getValueFromObjective(this.getName(), var5);
+            var6.func_96648_a();
+        }
+    }
+
+    private Collection func_175137_e(Entity p_175137_1_)
+    {
+        ScorePlayerTeam var2 = this.getWorldScoreboard().getPlayersTeam(this.getName());
+
+        if (var2 != null)
+        {
+            int var3 = var2.func_178775_l().func_175746_b();
+
+            if (var3 >= 0 && var3 < IScoreObjectiveCriteria.field_178793_i.length)
+            {
+                Iterator var4 = this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.field_178793_i[var3]).iterator();
+
+                while (var4.hasNext())
+                {
+                    ScoreObjective var5 = (ScoreObjective)var4.next();
+                    Score var6 = this.getWorldScoreboard().getValueFromObjective(p_175137_1_.getName(), var5);
+                    var6.func_96648_a();
+                }
+            }
+        }
+
+        ScorePlayerTeam var7 = this.getWorldScoreboard().getPlayersTeam(p_175137_1_.getName());
+
+        if (var7 != null)
+        {
+            int var8 = var7.func_178775_l().func_175746_b();
+
+            if (var8 >= 0 && var8 < IScoreObjectiveCriteria.field_178792_h.length)
+            {
+                return this.getWorldScoreboard().func_96520_a(IScoreObjectiveCriteria.field_178792_h[var8]);
+            }
+        }
+
+        return Lists.newArrayList();
+    }
+
+    /**
+     * Called when player presses the drop item key
+     */
+    public EntityItem dropOneItem(boolean p_71040_1_)
+    {
+        return this.func_146097_a(this.inventory.decrStackSize(this.inventory.currentItem, p_71040_1_ && this.inventory.getCurrentItem() != null ? this.inventory.getCurrentItem().stackSize : 1), false, true);
+    }
+
+    /**
+     * Args: itemstack, flag
+     */
+    public EntityItem dropPlayerItemWithRandomChoice(ItemStack itemStackIn, boolean p_71019_2_)
+    {
+        return this.func_146097_a(itemStackIn, false, false);
+    }
+
+    public EntityItem func_146097_a(ItemStack p_146097_1_, boolean p_146097_2_, boolean p_146097_3_)
+    {
+        if (p_146097_1_ == null)
+        {
+            return null;
+        }
+        else if (p_146097_1_.stackSize == 0)
+        {
+            return null;
+        }
+        else
+        {
+            double var4 = this.posY - 0.30000001192092896D + (double)this.getEyeHeight();
+            EntityItem var6 = new EntityItem(this.worldObj, this.posX, var4, this.posZ, p_146097_1_);
+            var6.setPickupDelay(40);
+
+            if (p_146097_3_)
+            {
+                var6.setThrower(this.getName());
+            }
+
+            float var7;
+            float var8;
+
+            if (p_146097_2_)
+            {
+                var7 = this.rand.nextFloat() * 0.5F;
+                var8 = this.rand.nextFloat() * (float)Math.PI * 2.0F;
+                var6.motionX = (double)(-MathHelper.sin(var8) * var7);
+                var6.motionZ = (double)(MathHelper.cos(var8) * var7);
+                var6.motionY = 0.20000000298023224D;
+            }
+            else
+            {
+                var7 = 0.3F;
+                var6.motionX = (double)(-MathHelper.sin(this.rotationYaw / 180.0F * (float)Math.PI) * MathHelper.cos(this.rotationPitch / 180.0F * (float)Math.PI) * var7);
+                var6.motionZ = (double)(MathHelper.cos(this.rotationYaw / 180.0F * (float)Math.PI) * MathHelper.cos(this.rotationPitch / 180.0F * (float)Math.PI) * var7);
+                var6.motionY = (double)(-MathHelper.sin(this.rotationPitch / 180.0F * (float)Math.PI) * var7 + 0.1F);
+                var8 = this.rand.nextFloat() * (float)Math.PI * 2.0F;
+                var7 = 0.02F * this.rand.nextFloat();
+                var6.motionX += Math.cos((double)var8) * (double)var7;
+                var6.motionY += (double)((this.rand.nextFloat() - this.rand.nextFloat()) * 0.1F);
+                var6.motionZ += Math.sin((double)var8) * (double)var7;
+            }
+
+            this.joinEntityItemWithWorld(var6);
+
+            if (p_146097_3_)
+            {
+                this.triggerAchievement(StatList.dropStat);
+            }
+
+            return var6;
+        }
+    }
+
+    /**
+     * Joins the passed in entity item with the world. Args: entityItem
+     */
+    protected void joinEntityItemWithWorld(EntityItem p_71012_1_)
+    {
+        this.worldObj.spawnEntityInWorld(p_71012_1_);
+    }
+
+    public float func_180471_a(Block p_180471_1_)
+    {
+        float var2 = this.inventory.getStrVsBlock(p_180471_1_);
+
+        if (var2 > 1.0F)
+        {
+            int var3 = EnchantmentHelper.getEfficiencyModifier(this);
+            ItemStack var4 = this.inventory.getCurrentItem();
+
+            if (var3 > 0 && var4 != null)
+            {
+                var2 += (float)(var3 * var3 + 1);
+            }
+        }
+
+        if (this.isPotionActive(Potion.digSpeed))
+        {
+            var2 *= 1.0F + (float)(this.getActivePotionEffect(Potion.digSpeed).getAmplifier() + 1) * 0.2F;
+        }
+
+        if (this.isPotionActive(Potion.digSlowdown))
+        {
+            float var5 = 1.0F;
+
+            switch (this.getActivePotionEffect(Potion.digSlowdown).getAmplifier())
+            {
+                case 0:
+                    var5 = 0.3F;
+                    break;
+
+                case 1:
+                    var5 = 0.09F;
+                    break;
+
+                case 2:
+                    var5 = 0.0027F;
+                    break;
+
+                case 3:
+                default:
+                    var5 = 8.1E-4F;
+            }
+
+            var2 *= var5;
+        }
+
+        if (this.isInsideOfMaterial(Material.water) && !EnchantmentHelper.getAquaAffinityModifier(this))
+        {
+            var2 /= 5.0F;
+        }
+
+        if (!this.onGround)
+        {
+            var2 /= 5.0F;
+        }
+
+        return var2;
+    }
+
+    /**
+     * Checks if the player has the ability to harvest a block (checks current inventory item for a tool if necessary)
+     */
+    public boolean canHarvestBlock(Block p_146099_1_)
+    {
+        return this.inventory.func_146025_b(p_146099_1_);
+    }
+
+    /**
+     * (abstract) Protected helper method to read subclass entity data from NBT.
+     */
+    public void readEntityFromNBT(NBTTagCompound tagCompund)
+    {
+        super.readEntityFromNBT(tagCompund);
+        this.entityUniqueID = getUUID(this.gameProfile);
+        NBTTagList var2 = tagCompund.getTagList("Inventory", 10);
+        this.inventory.readFromNBT(var2);
+        this.inventory.currentItem = tagCompund.getInteger("SelectedItemSlot");
+        this.sleeping = tagCompund.getBoolean("Sleeping");
+        this.sleepTimer = tagCompund.getShort("SleepTimer");
+        this.experience = tagCompund.getFloat("XpP");
+        this.experienceLevel = tagCompund.getInteger("XpLevel");
+        this.experienceTotal = tagCompund.getInteger("XpTotal");
+        this.field_175152_f = tagCompund.getInteger("XpSeed");
+
+        if (this.field_175152_f == 0)
+        {
+            this.field_175152_f = this.rand.nextInt();
+        }
+
+        this.setScore(tagCompund.getInteger("Score"));
+
+        if (this.sleeping)
+        {
+            this.playerLocation = new BlockPos(this);
+            this.wakeUpPlayer(true, true, false);
+        }
+
+        if (tagCompund.hasKey("SpawnX", 99) && tagCompund.hasKey("SpawnY", 99) && tagCompund.hasKey("SpawnZ", 99))
+        {
+            this.spawnChunk = new BlockPos(tagCompund.getInteger("SpawnX"), tagCompund.getInteger("SpawnY"), tagCompund.getInteger("SpawnZ"));
+            this.spawnForced = tagCompund.getBoolean("SpawnForced");
+        }
+
+        this.foodStats.readNBT(tagCompund);
+        this.capabilities.readCapabilitiesFromNBT(tagCompund);
+
+        if (tagCompund.hasKey("EnderItems", 9))
+        {
+            NBTTagList var3 = tagCompund.getTagList("EnderItems", 10);
+            this.theInventoryEnderChest.loadInventoryFromNBT(var3);
+        }
+    }
+
+    /**
+     * (abstract) Protected helper method to write subclass entity data to NBT.
+     */
+    public void writeEntityToNBT(NBTTagCompound tagCompound)
+    {
+        super.writeEntityToNBT(tagCompound);
+        tagCompound.setTag("Inventory", this.inventory.writeToNBT(new NBTTagList()));
+        tagCompound.setInteger("SelectedItemSlot", this.inventory.currentItem);
+        tagCompound.setBoolean("Sleeping", this.sleeping);
+        tagCompound.setShort("SleepTimer", (short)this.sleepTimer);
+        tagCompound.setFloat("XpP", this.experience);
+        tagCompound.setInteger("XpLevel", this.experienceLevel);
+        tagCompound.setInteger("XpTotal", this.experienceTotal);
+        tagCompound.setInteger("XpSeed", this.field_175152_f);
+        tagCompound.setInteger("Score", this.getScore());
+
+        if (this.spawnChunk != null)
+        {
+            tagCompound.setInteger("SpawnX", this.spawnChunk.getX());
+            tagCompound.setInteger("SpawnY", this.spawnChunk.getY());
+            tagCompound.setInteger("SpawnZ", this.spawnChunk.getZ());
+            tagCompound.setBoolean("SpawnForced", this.spawnForced);
+        }
+
+        this.foodStats.writeNBT(tagCompound);
+        this.capabilities.writeCapabilitiesToNBT(tagCompound);
+        tagCompound.setTag("EnderItems", this.theInventoryEnderChest.saveInventoryToNBT());
+        ItemStack var2 = this.inventory.getCurrentItem();
+
+        if (var2 != null && var2.getItem() != null)
+        {
+            tagCompound.setTag("SelectedItem", var2.writeToNBT(new NBTTagCompound()));
+        }
+    }
+
+    /**
+     * Called when the entity is attacked.
+     */
+    public boolean attackEntityFrom(DamageSource source, float amount)
+    {
+        if (this.func_180431_b(source))
+        {
+            return false;
+        }
+        else if (this.capabilities.disableDamage && !source.canHarmInCreative())
+        {
+            return false;
+        }
+        else
+        {
+            this.entityAge = 0;
+
+            if (this.getHealth() <= 0.0F)
+            {
+                return false;
+            }
+            else
+            {
+                if (this.isPlayerSleeping() && !this.worldObj.isRemote)
+                {
+                    this.wakeUpPlayer(true, true, false);
+                }
+
+                if (source.isDifficultyScaled())
+                {
+                    if (this.worldObj.getDifficulty() == EnumDifficulty.PEACEFUL)
+                    {
+                        amount = 0.0F;
+                    }
+
+                    if (this.worldObj.getDifficulty() == EnumDifficulty.EASY)
+                    {
+                        amount = amount / 2.0F + 1.0F;
+                    }
+
+                    if (this.worldObj.getDifficulty() == EnumDifficulty.HARD)
+                    {
+                        amount = amount * 3.0F / 2.0F;
+                    }
+                }
+
+                if (amount == 0.0F)
+                {
+                    return false;
+                }
+                else
+                {
+                    Entity var3 = source.getEntity();
+
+                    if (var3 instanceof EntityArrow && ((EntityArrow)var3).shootingEntity != null)
+                    {
+                        var3 = ((EntityArrow)var3).shootingEntity;
+                    }
+
+                    return super.attackEntityFrom(source, amount);
+                }
+            }
+        }
+    }
+
+    public boolean canAttackPlayer(EntityPlayer other)
+    {
+        Team var2 = this.getTeam();
+        Team var3 = other.getTeam();
+        return var2 == null ? true : (!var2.isSameTeam(var3) ? true : var2.getAllowFriendlyFire());
+    }
+
+    protected void damageArmor(float p_70675_1_)
+    {
+        this.inventory.damageArmor(p_70675_1_);
+    }
+
+    /**
+     * Returns the current armor value as determined by a call to InventoryPlayer.getTotalArmorValue
+     */
+    public int getTotalArmorValue()
+    {
+        return this.inventory.getTotalArmorValue();
+    }
+
+    /**
+     * When searching for vulnerable players, if a player is invisible, the return value of this is the chance of seeing
+     * them anyway.
+     */
+    public float getArmorVisibility()
+    {
+        int var1 = 0;
+        ItemStack[] var2 = this.inventory.armorInventory;
+        int var3 = var2.length;
+
+        for (int var4 = 0; var4 < var3; ++var4)
+        {
+            ItemStack var5 = var2[var4];
+
+            if (var5 != null)
+            {
+                ++var1;
+            }
+        }
+
+        return (float)var1 / (float)this.inventory.armorInventory.length;
+    }
+
+    /**
+     * Deals damage to the entity. If its a EntityPlayer then will take damage from the armor first and then health
+     * second with the reduced value. Args: damageAmount
+     */
+    protected void damageEntity(DamageSource p_70665_1_, float p_70665_2_)
+    {
+        if (!this.func_180431_b(p_70665_1_))
+        {
+            if (!p_70665_1_.isUnblockable() && this.isBlocking() && p_70665_2_ > 0.0F)
+            {
+                p_70665_2_ = (1.0F + p_70665_2_) * 0.5F;
+            }
+
+            p_70665_2_ = this.applyArmorCalculations(p_70665_1_, p_70665_2_);
+            p_70665_2_ = this.applyPotionDamageCalculations(p_70665_1_, p_70665_2_);
+            float var3 = p_70665_2_;
+            p_70665_2_ = Math.max(p_70665_2_ - this.getAbsorptionAmount(), 0.0F);
+            this.setAbsorptionAmount(this.getAbsorptionAmount() - (var3 - p_70665_2_));
+
+            if (p_70665_2_ != 0.0F)
+            {
+                this.addExhaustion(p_70665_1_.getHungerDamage());
+                float var4 = this.getHealth();
+                this.setHealth(this.getHealth() - p_70665_2_);
+                this.getCombatTracker().func_94547_a(p_70665_1_, var4, p_70665_2_);
+
+                if (p_70665_2_ < 3.4028235E37F)
+                {
+                    this.addStat(StatList.damageTakenStat, Math.round(p_70665_2_ * 10.0F));
+                }
+            }
+        }
+    }
+
+    public void func_175141_a(TileEntitySign p_175141_1_) {}
+
+    public void func_146095_a(CommandBlockLogic p_146095_1_) {}
+
+    public void displayVillagerTradeGui(IMerchant villager) {}
+
+    /**
+     * Displays the GUI for interacting with a chest inventory. Args: chestInventory
+     */
+    public void displayGUIChest(IInventory chestInventory) {}
+
+    public void displayGUIHorse(EntityHorse p_110298_1_, IInventory p_110298_2_) {}
+
+    public void displayGui(IInteractionObject guiOwner) {}
+
+    /**
+     * Displays the GUI for interacting with a book.
+     */
+    public void displayGUIBook(ItemStack bookStack) {}
+
+    public boolean interactWith(Entity p_70998_1_)
+    {
+        if (this.isSpectator())
+        {
+            if (p_70998_1_ instanceof IInventory)
+            {
+                this.displayGUIChest((IInventory)p_70998_1_);
+            }
+
+            return false;
+        }
+        else
+        {
+            ItemStack var2 = this.getCurrentEquippedItem();
+            ItemStack var3 = var2 != null ? var2.copy() : null;
+
+            if (!p_70998_1_.interactFirst(this))
+            {
+                if (var2 != null && p_70998_1_ instanceof EntityLivingBase)
+                {
+                    if (this.capabilities.isCreativeMode)
+                    {
+                        var2 = var3;
+                    }
+
+                    if (var2.interactWithEntity(this, (EntityLivingBase)p_70998_1_))
+                    {
+                        if (var2.stackSize <= 0 && !this.capabilities.isCreativeMode)
+                        {
+                            this.destroyCurrentEquippedItem();
+                        }
+
+                        return true;
+                    }
+                }
+
+                return false;
+            }
+            else
+            {
+                if (var2 != null && var2 == this.getCurrentEquippedItem())
+                {
+                    if (var2.stackSize <= 0 && !this.capabilities.isCreativeMode)
+                    {
+                        this.destroyCurrentEquippedItem();
+                    }
+                    else if (var2.stackSize < var3.stackSize && this.capabilities.isCreativeMode)
+                    {
+                        var2.stackSize = var3.stackSize;
+                    }
+                }
+
+                return true;
+            }
+        }
+    }
+
+    /**
+     * Returns the currently being used item by the player.
+     */
+    public ItemStack getCurrentEquippedItem()
+    {
+        return this.inventory.getCurrentItem();
+    }
+
+    /**
+     * Destroys the currently equipped item from the player's inventory.
+     */
+    public void destroyCurrentEquippedItem()
+    {
+        this.inventory.setInventorySlotContents(this.inventory.currentItem, (ItemStack)null);
+    }
+
+    /**
+     * Returns the Y Offset of this entity.
+     */
+    public double getYOffset()
+    {
+        return -0.35D;
+    }
+
+    /**
+     * Attacks for the player the targeted entity with the currently equipped item.  The equipped item has hitEntity
+     * called on it. Args: targetEntity
+     */
+    public void attackTargetEntityWithCurrentItem(Entity targetEntity)
+    {
+        if (targetEntity.canAttackWithItem())
+        {
+            if (!targetEntity.hitByEntity(this))
+            {
+                float var2 = (float)this.getEntityAttribute(SharedMonsterAttributes.attackDamage).getAttributeValue();
+                byte var3 = 0;
+                float var4 = 0.0F;
+
+                if (targetEntity instanceof EntityLivingBase)
+                {
+                    var4 = EnchantmentHelper.func_152377_a(this.getHeldItem(), ((EntityLivingBase)targetEntity).getCreatureAttribute());
+                }
+                else
+                {
+                    var4 = EnchantmentHelper.func_152377_a(this.getHeldItem(), EnumCreatureAttribute.UNDEFINED);
+                }
+
+                int var18 = var3 + EnchantmentHelper.getRespiration(this);
+
+                if (this.isSprinting())
+                {
+                    ++var18;
+                }
+
+                if (var2 > 0.0F || var4 > 0.0F)
+                {
+                    boolean var5 = this.fallDistance > 0.0F && !this.onGround && !this.isOnLadder() && !this.isInWater() && !this.isPotionActive(Potion.blindness) && this.ridingEntity == null && targetEntity instanceof EntityLivingBase;
+
+                    if (var5 && var2 > 0.0F)
+                    {
+                        var2 *= 1.5F;
+                    }
+
+                    var2 += var4;
+                    boolean var6 = false;
+                    int var7 = EnchantmentHelper.getFireAspectModifier(this);
+
+                    if (targetEntity instanceof EntityLivingBase && var7 > 0 && !targetEntity.isBurning())
+                    {
+                        var6 = true;
+                        targetEntity.setFire(1);
+                    }
+
+                    double var8 = targetEntity.motionX;
+                    double var10 = targetEntity.motionY;
+                    double var12 = targetEntity.motionZ;
+                    boolean var14 = targetEntity.attackEntityFrom(DamageSource.causePlayerDamage(this), var2);
+
+                    if (var14)
+                    {
+                        if (var18 > 0)
+                        {
+                            targetEntity.addVelocity((double)(-MathHelper.sin(this.rotationYaw * (float)Math.PI / 180.0F) * (float)var18 * 0.5F), 0.1D, (double)(MathHelper.cos(this.rotationYaw * (float)Math.PI / 180.0F) * (float)var18 * 0.5F));
+                            this.motionX *= 0.6D;
+                            this.motionZ *= 0.6D;
+                            this.setSprinting(false);
+                        }
+
+                        if (targetEntity instanceof EntityPlayerMP && targetEntity.velocityChanged)
+                        {
+                            ((EntityPlayerMP)targetEntity).playerNetServerHandler.sendPacket(new S12PacketEntityVelocity(targetEntity));
+                            targetEntity.velocityChanged = false;
+                            targetEntity.motionX = var8;
+                            targetEntity.motionY = var10;
+                            targetEntity.motionZ = var12;
+                        }
+
+                        if (var5)
+                        {
+                            this.onCriticalHit(targetEntity);
+                        }
+
+                        if (var4 > 0.0F)
+                        {
+                            this.onEnchantmentCritical(targetEntity);
+                        }
+
+                        if (var2 >= 18.0F)
+                        {
+                            this.triggerAchievement(AchievementList.overkill);
+                        }
+
+                        this.setLastAttacker(targetEntity);
+
+                        if (targetEntity instanceof EntityLivingBase)
+                        {
+                            EnchantmentHelper.func_151384_a((EntityLivingBase)targetEntity, this);
+                        }
+
+                        EnchantmentHelper.func_151385_b(this, targetEntity);
+                        ItemStack var15 = this.getCurrentEquippedItem();
+                        Object var16 = targetEntity;
+
+                        if (targetEntity instanceof EntityDragonPart)
+                        {
+                            IEntityMultiPart var17 = ((EntityDragonPart)targetEntity).entityDragonObj;
+
+                            if (var17 instanceof EntityLivingBase)
+                            {
+                                var16 = (EntityLivingBase)var17;
+                            }
+                        }
+
+                        if (var15 != null && var16 instanceof EntityLivingBase)
+                        {
+                            var15.hitEntity((EntityLivingBase)var16, this);
+
+                            if (var15.stackSize <= 0)
+                            {
+                                this.destroyCurrentEquippedItem();
+                            }
+                        }
+
+                        if (targetEntity instanceof EntityLivingBase)
+                        {
+                            this.addStat(StatList.damageDealtStat, Math.round(var2 * 10.0F));
+
+                            if (var7 > 0)
+                            {
+                                targetEntity.setFire(var7 * 4);
+                            }
+                        }
+
+                        this.addExhaustion(0.3F);
+                    }
+                    else if (var6)
+                    {
+                        targetEntity.extinguish();
+                    }
+                }
+            }
+        }
+    }
+
+    /**
+     * Called when the player performs a critical hit on the Entity. Args: entity that was hit critically
+     */
+    public void onCriticalHit(Entity p_71009_1_) {}
+
+    public void onEnchantmentCritical(Entity p_71047_1_) {}
+
+    public void respawnPlayer() {}
+
+    /**
+     * Will get destroyed next tick.
+     */
+    public void setDead()
+    {
+        super.setDead();
+        this.inventoryContainer.onContainerClosed(this);
+
+        if (this.openContainer != null)
+        {
+            this.openContainer.onContainerClosed(this);
+        }
+    }
+
+    /**
+     * Checks if this entity is inside of an opaque block
+     */
+    public boolean isEntityInsideOpaqueBlock()
+    {
+        return !this.sleeping && super.isEntityInsideOpaqueBlock();
+    }
+
+    public boolean func_175144_cb()
+    {
+        return false;
+    }
+
+    /**
+     * Returns the GameProfile for this player
+     */
+    public GameProfile getGameProfile()
+    {
+        return this.gameProfile;
+    }
+
+    public EntityPlayer.EnumStatus func_180469_a(BlockPos p_180469_1_)
+    {
+        if (!this.worldObj.isRemote)
+        {
+            if (this.isPlayerSleeping() || !this.isEntityAlive())
+            {
+                return EntityPlayer.EnumStatus.OTHER_PROBLEM;
+            }
+
+            if (!this.worldObj.provider.isSurfaceWorld())
+            {
+                return EntityPlayer.EnumStatus.NOT_POSSIBLE_HERE;
+            }
+
+            if (this.worldObj.isDaytime())
+            {
+                return EntityPlayer.EnumStatus.NOT_POSSIBLE_NOW;
+            }
+
+            if (Math.abs(this.posX - (double)p_180469_1_.getX()) > 3.0D || Math.abs(this.posY - (double)p_180469_1_.getY()) > 2.0D || Math.abs(this.posZ - (double)p_180469_1_.getZ()) > 3.0D)
+            {
+                return EntityPlayer.EnumStatus.TOO_FAR_AWAY;
+            }
+
+            double var2 = 8.0D;
+            double var4 = 5.0D;
+            List var6 = this.worldObj.getEntitiesWithinAABB(EntityMob.class, new AxisAlignedBB((double)p_180469_1_.getX() - var2, (double)p_180469_1_.getY() - var4, (double)p_180469_1_.getZ() - var2, (double)p_180469_1_.getX() + var2, (double)p_180469_1_.getY() + var4, (double)p_180469_1_.getZ() + var2));
+
+            if (!var6.isEmpty())
+            {
+                return EntityPlayer.EnumStatus.NOT_SAFE;
+            }
+        }
+
+        if (this.isRiding())
+        {
+            this.mountEntity((Entity)null);
+        }
+
+        this.setSize(0.2F, 0.2F);
+
+        if (this.worldObj.isBlockLoaded(p_180469_1_))
+        {
+            EnumFacing var7 = (EnumFacing)this.worldObj.getBlockState(p_180469_1_).getValue(BlockDirectional.AGE);
+            float var3 = 0.5F;
+            float var8 = 0.5F;
+
+            switch (EntityPlayer.SwitchEnumFacing.field_179420_a[var7.ordinal()])
+            {
+                case 1:
+                    var8 = 0.9F;
+                    break;
+
+                case 2:
+                    var8 = 0.1F;
+                    break;
+
+                case 3:
+                    var3 = 0.1F;
+                    break;
+
+                case 4:
+                    var3 = 0.9F;
+            }
+
+            this.func_175139_a(var7);
+            this.setPosition((double)((float)p_180469_1_.getX() + var3), (double)((float)p_180469_1_.getY() + 0.6875F), (double)((float)p_180469_1_.getZ() + var8));
+        }
+        else
+        {
+            this.setPosition((double)((float)p_180469_1_.getX() + 0.5F), (double)((float)p_180469_1_.getY() + 0.6875F), (double)((float)p_180469_1_.getZ() + 0.5F));
+        }
+
+        this.sleeping = true;
+        this.sleepTimer = 0;
+        this.playerLocation = p_180469_1_;
+        this.motionX = this.motionZ = this.motionY = 0.0D;
+
+        if (!this.worldObj.isRemote)
+        {
+            this.worldObj.updateAllPlayersSleepingFlag();
+        }
+
+        return EntityPlayer.EnumStatus.OK;
+    }
+
+    private void func_175139_a(EnumFacing p_175139_1_)
+    {
+        this.field_71079_bU = 0.0F;
+        this.field_71089_bV = 0.0F;
+
+        switch (EntityPlayer.SwitchEnumFacing.field_179420_a[p_175139_1_.ordinal()])
+        {
+            case 1:
+                this.field_71089_bV = -1.8F;
+                break;
+
+            case 2:
+                this.field_71089_bV = 1.8F;
+                break;
+
+            case 3:
+                this.field_71079_bU = 1.8F;
+                break;
+
+            case 4:
+                this.field_71079_bU = -1.8F;
+        }
+    }
+
+    /**
+     * Wake up the player if they're sleeping.
+     */
+    public void wakeUpPlayer(boolean p_70999_1_, boolean updateWorldFlag, boolean setSpawn)
+    {
+        this.setSize(0.6F, 1.8F);
+        IBlockState var4 = this.worldObj.getBlockState(this.playerLocation);
+
+        if (this.playerLocation != null && var4.getBlock() == Blocks.bed)
+        {
+            this.worldObj.setBlockState(this.playerLocation, var4.withProperty(BlockBed.OCCUPIED_PROP, Boolean.valueOf(false)), 4);
+            BlockPos var5 = BlockBed.getSafeExitLocation(this.worldObj, this.playerLocation, 0);
+
+            if (var5 == null)
+            {
+                var5 = this.playerLocation.offsetUp();
+            }
+
+            this.setPosition((double)((float)var5.getX() + 0.5F), (double)((float)var5.getY() + 0.1F), (double)((float)var5.getZ() + 0.5F));
+        }
+
+        this.sleeping = false;
+
+        if (!this.worldObj.isRemote && updateWorldFlag)
+        {
+            this.worldObj.updateAllPlayersSleepingFlag();
+        }
+
+        this.sleepTimer = p_70999_1_ ? 0 : 100;
+
+        if (setSpawn)
+        {
+            this.func_180473_a(this.playerLocation, false);
+        }
+    }
+
+    private boolean func_175143_p()
+    {
+        return this.worldObj.getBlockState(this.playerLocation).getBlock() == Blocks.bed;
+    }
+
+    public static BlockPos func_180467_a(World worldIn, BlockPos p_180467_1_, boolean p_180467_2_)
+    {
+        if (worldIn.getBlockState(p_180467_1_).getBlock() != Blocks.bed)
+        {
+            if (!p_180467_2_)
+            {
+                return null;
+            }
+            else
+            {
+                Material var3 = worldIn.getBlockState(p_180467_1_).getBlock().getMaterial();
+                Material var4 = worldIn.getBlockState(p_180467_1_.offsetUp()).getBlock().getMaterial();
+                boolean var5 = !var3.isSolid() && !var3.isLiquid();
+                boolean var6 = !var4.isSolid() && !var4.isLiquid();
+                return var5 && var6 ? p_180467_1_ : null;
+            }
+        }
+        else
+        {
+            return BlockBed.getSafeExitLocation(worldIn, p_180467_1_, 0);
+        }
+    }
+
+    /**
+     * Returns the orientation of the bed in degrees.
+     */
+    public float getBedOrientationInDegrees()
+    {
+        if (this.playerLocation != null)
+        {
+            EnumFacing var1 = (EnumFacing)this.worldObj.getBlockState(this.playerLocation).getValue(BlockDirectional.AGE);
+
+            switch (EntityPlayer.SwitchEnumFacing.field_179420_a[var1.ordinal()])
+            {
+                case 1:
+                    return 90.0F;
+
+                case 2:
+                    return 270.0F;
+
+                case 3:
+                    return 0.0F;
+
+                case 4:
+                    return 180.0F;
+            }
+        }
+
+        return 0.0F;
+    }
+
+    /**
+     * Returns whether player is sleeping or not
+     */
+    public boolean isPlayerSleeping()
+    {
+        return this.sleeping;
+    }
+
+    /**
+     * Returns whether or not the player is asleep and the screen has fully faded.
+     */
+    public boolean isPlayerFullyAsleep()
+    {
+        return this.sleeping && this.sleepTimer >= 100;
+    }
+
+    public int getSleepTimer()
+    {
+        return this.sleepTimer;
+    }
+
+    public void addChatComponentMessage(IChatComponent p_146105_1_) {}
+
+    public BlockPos func_180470_cg()
+    {
+        return this.spawnChunk;
+    }
+
+    public boolean isSpawnForced()
+    {
+        return this.spawnForced;
+    }
+
+    public void func_180473_a(BlockPos p_180473_1_, boolean p_180473_2_)
+    {
+        if (p_180473_1_ != null)
+        {
+            this.spawnChunk = p_180473_1_;
+            this.spawnForced = p_180473_2_;
+        }
+        else
+        {
+            this.spawnChunk = null;
+            this.spawnForced = false;
+        }
+    }
+
+    /**
+     * Will trigger the specified trigger.
+     */
+    public void triggerAchievement(StatBase p_71029_1_)
+    {
+        this.addStat(p_71029_1_, 1);
+    }
+
+    /**
+     * Adds a value to a statistic field.
+     */
+    public void addStat(StatBase p_71064_1_, int p_71064_2_) {}
+
+    public void func_175145_a(StatBase p_175145_1_) {}
+
+    /**
+     * Causes this entity to do an upwards motion (jumping).
+     */
+    public void jump()
+    {
+        super.jump();
+        this.triggerAchievement(StatList.jumpStat);
+
+        if (this.isSprinting())
+        {
+            this.addExhaustion(0.8F);
+        }
+        else
+        {
+            this.addExhaustion(0.2F);
+        }
+    }
+
+    /**
+     * Moves the entity based on the specified heading.  Args: strafe, forward
+     */
+    public void moveEntityWithHeading(float p_70612_1_, float p_70612_2_)
+    {
+        double var3 = this.posX;
+        double var5 = this.posY;
+        double var7 = this.posZ;
+
+        if (this.capabilities.isFlying && this.ridingEntity == null)
+        {
+            double var9 = this.motionY;
+            float var11 = this.jumpMovementFactor;
+            this.jumpMovementFactor = this.capabilities.getFlySpeed() * (float)(this.isSprinting() ? 2 : 1);
+            super.moveEntityWithHeading(p_70612_1_, p_70612_2_);
+            this.motionY = var9 * 0.6D;
+            this.jumpMovementFactor = var11;
+        }
+        else
+        {
+            super.moveEntityWithHeading(p_70612_1_, p_70612_2_);
+        }
+
+        this.addMovementStat(this.posX - var3, this.posY - var5, this.posZ - var7);
+    }
+
+    /**
+     * the movespeed used for the new AI system
+     */
+    public float getAIMoveSpeed()
+    {
+        return (float)this.getEntityAttribute(SharedMonsterAttributes.movementSpeed).getAttributeValue();
+    }
+
+    /**
+     * Adds a value to a movement statistic field - like run, walk, swin or climb.
+     */
+    public void addMovementStat(double p_71000_1_, double p_71000_3_, double p_71000_5_)
+    {
+        if (this.ridingEntity == null)
+        {
+            int var7;
+
+            if (this.isInsideOfMaterial(Material.water))
+            {
+                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_3_ * p_71000_3_ + p_71000_5_ * p_71000_5_) * 100.0F);
+
+                if (var7 > 0)
+                {
+                    this.addStat(StatList.distanceDoveStat, var7);
+                    this.addExhaustion(0.015F * (float)var7 * 0.01F);
+                }
+            }
+            else if (this.isInWater())
+            {
+                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
+
+                if (var7 > 0)
+                {
+                    this.addStat(StatList.distanceSwumStat, var7);
+                    this.addExhaustion(0.015F * (float)var7 * 0.01F);
+                }
+            }
+            else if (this.isOnLadder())
+            {
+                if (p_71000_3_ > 0.0D)
+                {
+                    this.addStat(StatList.distanceClimbedStat, (int)Math.round(p_71000_3_ * 100.0D));
+                }
+            }
+            else if (this.onGround)
+            {
+                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
+
+                if (var7 > 0)
+                {
+                    this.addStat(StatList.distanceWalkedStat, var7);
+
+                    if (this.isSprinting())
+                    {
+                        this.addStat(StatList.distanceSprintedStat, var7);
+                        this.addExhaustion(0.099999994F * (float)var7 * 0.01F);
+                    }
+                    else
+                    {
+                        if (this.isSneaking())
+                        {
+                            this.addStat(StatList.distanceCrouchedStat, var7);
+                        }
+
+                        this.addExhaustion(0.01F * (float)var7 * 0.01F);
+                    }
+                }
+            }
+            else
+            {
+                var7 = Math.round(MathHelper.sqrt_double(p_71000_1_ * p_71000_1_ + p_71000_5_ * p_71000_5_) * 100.0F);
+
+                if (var7 > 25)
+                {
+                    this.addStat(StatList.distanceFlownStat, var7);
+                }
+            }
+        }
+    }
+
+    /**
+     * Adds a value to a mounted movement statistic field - by minecart, boat, or pig.
+     */
+    private void addMountedMovementStat(double p_71015_1_, double p_71015_3_, double p_71015_5_)
+    {
+        if (this.ridingEntity != null)
+        {
+            int var7 = Math.round(MathHelper.sqrt_double(p_71015_1_ * p_71015_1_ + p_71015_3_ * p_71015_3_ + p_71015_5_ * p_71015_5_) * 100.0F);
+
+            if (var7 > 0)
+            {
+                if (this.ridingEntity instanceof EntityMinecart)
+                {
+                    this.addStat(StatList.distanceByMinecartStat, var7);
+
+                    if (this.startMinecartRidingCoordinate == null)
+                    {
+                        this.startMinecartRidingCoordinate = new BlockPos(this);
+                    }
+                    else if (this.startMinecartRidingCoordinate.distanceSq((double)MathHelper.floor_double(this.posX), (double)MathHelper.floor_double(this.posY), (double)MathHelper.floor_double(this.posZ)) >= 1000000.0D)
+                    {
+                        this.triggerAchievement(AchievementList.onARail);
+                    }
+                }
+                else if (this.ridingEntity instanceof EntityBoat)
+                {
+                    this.addStat(StatList.distanceByBoatStat, var7);
+                }
+                else if (this.ridingEntity instanceof EntityPig)
+                {
+                    this.addStat(StatList.distanceByPigStat, var7);
+                }
+                else if (this.ridingEntity instanceof EntityHorse)
+                {
+                    this.addStat(StatList.distanceByHorseStat, var7);
+                }
+            }
+        }
+    }
+
+    public void fall(float distance, float damageMultiplier)
+    {
+        if (!this.capabilities.allowFlying)
+        {
+            if (distance >= 2.0F)
+            {
+                this.addStat(StatList.distanceFallenStat, (int)Math.round((double)distance * 100.0D));
+            }
+
+            super.fall(distance, damageMultiplier);
+        }
+    }
+
+    /**
+     * sets the players height back to normal after doing things like sleeping and dieing
+     */
+    protected void resetHeight()
+    {
+        if (!this.isSpectator())
+        {
+            super.resetHeight();
+        }
+    }
+
+    protected String func_146067_o(int p_146067_1_)
+    {
+        return p_146067_1_ > 4 ? "game.player.hurt.fall.big" : "game.player.hurt.fall.small";
+    }
+
+    /**
+     * This method gets called when the entity kills another one.
+     */
+    public void onKillEntity(EntityLivingBase entityLivingIn)
+    {
+        if (entityLivingIn instanceof IMob)
+        {
+            this.triggerAchievement(AchievementList.killEnemy);
+        }
+
+        EntityList.EntityEggInfo var2 = (EntityList.EntityEggInfo)EntityList.entityEggs.get(Integer.valueOf(EntityList.getEntityID(entityLivingIn)));
+
+        if (var2 != null)
+        {
+            this.triggerAchievement(var2.field_151512_d);
+        }
+    }
+
+    /**
+     * Sets the Entity inside a web block.
+     */
+    public void setInWeb()
+    {
+        if (!this.capabilities.isFlying)
+        {
+            super.setInWeb();
+        }
+    }
+
+    public ItemStack getCurrentArmor(int p_82169_1_)
+    {
+        return this.inventory.armorItemInSlot(p_82169_1_);
+    }
+
+    /**
+     * Add experience points to player.
+     */
+    public void addExperience(int p_71023_1_)
+    {
+        this.addScore(p_71023_1_);
+        int var2 = Integer.MAX_VALUE - this.experienceTotal;
+
+        if (p_71023_1_ > var2)
+        {
+            p_71023_1_ = var2;
+        }
+
+        this.experience += (float)p_71023_1_ / (float)this.xpBarCap();
+
+        for (this.experienceTotal += p_71023_1_; this.experience >= 1.0F; this.experience /= (float)this.xpBarCap())
+        {
+            this.experience = (this.experience - 1.0F) * (float)this.xpBarCap();
+            this.addExperienceLevel(1);
+        }
+    }
+
+    public int func_175138_ci()
+    {
+        return this.field_175152_f;
+    }
+
+    public void func_71013_b(int p_71013_1_)
+    {
+        this.experienceLevel -= p_71013_1_;
+
+        if (this.experienceLevel < 0)
+        {
+            this.experienceLevel = 0;
+            this.experience = 0.0F;
+            this.experienceTotal = 0;
+        }
+
+        this.field_175152_f = this.rand.nextInt();
+    }
+
+    /**
+     * Add experience levels to this player.
+     */
+    public void addExperienceLevel(int p_82242_1_)
+    {
+        this.experienceLevel += p_82242_1_;
+
+        if (this.experienceLevel < 0)
+        {
+            this.experienceLevel = 0;
+            this.experience = 0.0F;
+            this.experienceTotal = 0;
+        }
+
+        if (p_82242_1_ > 0 && this.experienceLevel % 5 == 0 && (float)this.field_82249_h < (float)this.ticksExisted - 100.0F)
+        {
+            float var2 = this.experienceLevel > 30 ? 1.0F : (float)this.experienceLevel / 30.0F;
+            this.worldObj.playSoundAtEntity(this, "random.levelup", var2 * 0.75F, 1.0F);
+            this.field_82249_h = this.ticksExisted;
+        }
+    }
+
+    /**
+     * This method returns the cap amount of experience that the experience bar can hold. With each level, the
+     * experience cap on the player's experience bar is raised by 10.
+     */
+    public int xpBarCap()
+    {
+        return this.experienceLevel >= 30 ? 112 + (this.experienceLevel - 30) * 9 : (this.experienceLevel >= 15 ? 37 + (this.experienceLevel - 15) * 5 : 7 + this.experienceLevel * 2);
+    }
+
+    /**
+     * increases exhaustion level by supplied amount
+     */
+    public void addExhaustion(float p_71020_1_)
+    {
+        if (!this.capabilities.disableDamage)
+        {
+            if (!this.worldObj.isRemote)
+            {
+                this.foodStats.addExhaustion(p_71020_1_);
+            }
+        }
+    }
+
+    /**
+     * Returns the player's FoodStats object.
+     */
+    public FoodStats getFoodStats()
+    {
+        return this.foodStats;
+    }
+
+    public boolean canEat(boolean p_71043_1_)
+    {
+        return (p_71043_1_ || this.foodStats.needFood()) && !this.capabilities.disableDamage;
+    }
+
+    /**
+     * Checks if the player's health is not full and not zero.
+     */
+    public boolean shouldHeal()
+    {
+        return this.getHealth() > 0.0F && this.getHealth() < this.getMaxHealth();
+    }
+
+    /**
+     * sets the itemInUse when the use item button is clicked. Args: itemstack, int maxItemUseDuration
+     */
+    public void setItemInUse(ItemStack p_71008_1_, int p_71008_2_)
+    {
+        if (p_71008_1_ != this.itemInUse)
+        {
+            this.itemInUse = p_71008_1_;
+            this.itemInUseCount = p_71008_2_;
+
+            if (!this.worldObj.isRemote)
+            {
+                this.setEating(true);
+            }
+        }
+    }
+
+    public boolean func_175142_cm()
+    {
+        return this.capabilities.allowEdit;
+    }
+
+    public boolean func_175151_a(BlockPos p_175151_1_, EnumFacing p_175151_2_, ItemStack p_175151_3_)
+    {
+        if (this.capabilities.allowEdit)
+        {
+            return true;
+        }
+        else if (p_175151_3_ == null)
+        {
+            return false;
+        }
+        else
+        {
+            BlockPos var4 = p_175151_1_.offset(p_175151_2_.getOpposite());
+            Block var5 = this.worldObj.getBlockState(var4).getBlock();
+            return p_175151_3_.canPlaceOn(var5) || p_175151_3_.canEditBlocks();
+        }
+    }
+
+    /**
+     * Get the experience points the entity currently has.
+     */
+    protected int getExperiencePoints(EntityPlayer p_70693_1_)
+    {
+        if (this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
+        {
+            return 0;
+        }
+        else
+        {
+            int var2 = this.experienceLevel * 7;
+            return var2 > 100 ? 100 : var2;
+        }
+    }
+
+    /**
+     * Only use is to identify if class is an instance of player for experience dropping
+     */
+    protected boolean isPlayer()
+    {
+        return true;
+    }
+
+    public boolean getAlwaysRenderNameTagForRender()
+    {
+        return true;
+    }
+
+    /**
+     * Copies the values from the given player into this player if boolean par2 is true. Always clones Ender Chest
+     * Inventory.
+     */
+    public void clonePlayer(EntityPlayer p_71049_1_, boolean p_71049_2_)
+    {
+        if (p_71049_2_)
+        {
+            this.inventory.copyInventory(p_71049_1_.inventory);
+            this.setHealth(p_71049_1_.getHealth());
+            this.foodStats = p_71049_1_.foodStats;
+            this.experienceLevel = p_71049_1_.experienceLevel;
+            this.experienceTotal = p_71049_1_.experienceTotal;
+            this.experience = p_71049_1_.experience;
+            this.setScore(p_71049_1_.getScore());
+            this.teleportDirection = p_71049_1_.teleportDirection;
+        }
+        else if (this.worldObj.getGameRules().getGameRuleBooleanValue("keepInventory"))
+        {
+            this.inventory.copyInventory(p_71049_1_.inventory);
+            this.experienceLevel = p_71049_1_.experienceLevel;
+            this.experienceTotal = p_71049_1_.experienceTotal;
+            this.experience = p_71049_1_.experience;
+            this.setScore(p_71049_1_.getScore());
+        }
+
+        this.theInventoryEnderChest = p_71049_1_.theInventoryEnderChest;
+        this.getDataWatcher().updateObject(10, Byte.valueOf(p_71049_1_.getDataWatcher().getWatchableObjectByte(10)));
+    }
+
+    /**
+     * returns if this entity triggers Block.onEntityWalking on the blocks they walk on. used for spiders and wolves to
+     * prevent them from trampling crops
+     */
+    protected boolean canTriggerWalking()
+    {
+        return !this.capabilities.isFlying;
+    }
+
+    /**
+     * Sends the player's abilities to the server (if there is one).
+     */
+    public void sendPlayerAbilities() {}
+
+    /**
+     * Sets the player's game mode and sends it to them.
+     */
+    public void setGameType(WorldSettings.GameType gameType) {}
+
+    /**
+     * Gets the name of this command sender (usually username, but possibly "Rcon")
+     */
+    public String getName()
+    {
+        return this.gameProfile.getName();
+    }
+
+    /**
+     * Returns the InventoryEnderChest of this player.
+     */
+    public InventoryEnderChest getInventoryEnderChest()
+    {
+        return this.theInventoryEnderChest;
+    }
+
+    /**
+     * 0: Tool in Hand; 1-4: Armor
+     */
+    public ItemStack getEquipmentInSlot(int p_71124_1_)
+    {
+        return p_71124_1_ == 0 ? this.inventory.getCurrentItem() : this.inventory.armorInventory[p_71124_1_ - 1];
+    }
+
+    /**
+     * Returns the item that this EntityLiving is holding, if any.
+     */
+    public ItemStack getHeldItem()
+    {
+        return this.inventory.getCurrentItem();
+    }
+
+    /**
+     * Sets the held item, or an armor slot. Slot 0 is held item. Slot 1-4 is armor. Params: Item, slot
+     */
+    public void setCurrentItemOrArmor(int slotIn, ItemStack itemStackIn)
+    {
+        this.inventory.armorInventory[slotIn] = itemStackIn;
+    }
+
+    /**
+     * Only used by renderer in EntityLivingBase subclasses.
+     * Determines if an entity is visible or not to a specfic player, if the entity is normally invisible.
+     * For EntityLivingBase subclasses, returning false when invisible will render the entity semitransparent.
+     */
+    public boolean isInvisibleToPlayer(EntityPlayer playerIn)
+    {
+        if (!this.isInvisible())
+        {
+            return false;
+        }
+        else if (playerIn.isSpectator())
+        {
+            return false;
+        }
+        else
+        {
+            Team var2 = this.getTeam();
+            return var2 == null || playerIn == null || playerIn.getTeam() != var2 || !var2.func_98297_h();
+        }
+    }
+
+    public abstract boolean isSpectator();
+
+    /**
+     * returns the inventory of this entity (only used in EntityPlayerMP it seems)
+     */
+    public ItemStack[] getInventory()
+    {
+        return this.inventory.armorInventory;
+    }
+
+    public boolean isPushedByWater()
+    {
+    	//TODO: Client
+        return !WurstClient.INSTANCE.modManager.getModByClass(AntiKnockbackMod.class).isEnabled() && !this.capabilities.isFlying;
+    }
+
+    public Scoreboard getWorldScoreboard()
+    {
+        return this.worldObj.getScoreboard();
+    }
+
+    public Team getTeam()
+    {
+        return this.getWorldScoreboard().getPlayersTeam(this.getName());
+    }
+
+    public IChatComponent getDisplayName()
+    {
+        ChatComponentText var1 = new ChatComponentText(ScorePlayerTeam.formatPlayerName(this.getTeam(), this.getName()));
+        var1.getChatStyle().setChatClickEvent(new ClickEvent(ClickEvent.Action.SUGGEST_COMMAND, "/msg " + this.getName() + " "));
+        var1.getChatStyle().setChatHoverEvent(this.func_174823_aP());
+        var1.getChatStyle().setInsertion(this.getName());
+        return var1;
+    }
+
+    public float getEyeHeight()
+    {
+        float var1 = 1.62F;
+
+        if (this.isPlayerSleeping())
+        {
+            var1 = 0.2F;
+        }
+
+        if (this.isSneaking())
+        {
+            var1 -= 0.08F;
+        }
+
+        return var1;
+    }
+
+    public void setAbsorptionAmount(float p_110149_1_)
+    {
+        if (p_110149_1_ < 0.0F)
+        {
+            p_110149_1_ = 0.0F;
+        }
+
+        this.getDataWatcher().updateObject(17, Float.valueOf(p_110149_1_));
+    }
+
+    public float getAbsorptionAmount()
+    {
+        return this.getDataWatcher().getWatchableObjectFloat(17);
+    }
+
+    /**
+     * Gets a players UUID given their GameProfie
+     */
+    public static UUID getUUID(GameProfile p_146094_0_)
+    {
+        UUID var1 = p_146094_0_.getId();
+
+        if (var1 == null)
+        {
+            var1 = getUUIDFromPlayerName(p_146094_0_.getName());
+        }
+
+        return var1;
+    }
+
+    public static UUID getUUIDFromPlayerName(String name)
+    {
+        return UUID.nameUUIDFromBytes(("OfflinePlayer:" + name).getBytes(Charsets.UTF_8));
+    }
+
+    public boolean func_175146_a(LockCode p_175146_1_)
+    {
+        if (p_175146_1_.isEmpty())
+        {
+            return true;
+        }
+        else
+        {
+            ItemStack var2 = this.getCurrentEquippedItem();
+            return var2 != null && var2.hasDisplayName() ? var2.getDisplayName().equals(p_175146_1_.getLock()) : false;
+        }
+    }
+
+    public boolean func_175148_a(EnumPlayerModelParts p_175148_1_)
+    {
+        return (this.getDataWatcher().getWatchableObjectByte(10) & p_175148_1_.func_179327_a()) == p_175148_1_.func_179327_a();
+    }
+
+    public boolean sendCommandFeedback()
+    {
+        return MinecraftServer.getServer().worldServers[0].getGameRules().getGameRuleBooleanValue("sendCommandFeedback");
+    }
+
+    public boolean func_174820_d(int p_174820_1_, ItemStack p_174820_2_)
+    {
+        if (p_174820_1_ >= 0 && p_174820_1_ < this.inventory.mainInventory.length)
+        {
+            this.inventory.setInventorySlotContents(p_174820_1_, p_174820_2_);
+            return true;
+        }
+        else
+        {
+            int var3 = p_174820_1_ - 100;
+            int var4;
+
+            if (var3 >= 0 && var3 < this.inventory.armorInventory.length)
+            {
+                var4 = var3 + 1;
+
+                if (p_174820_2_ != null && p_174820_2_.getItem() != null)
+                {
+                    if (p_174820_2_.getItem() instanceof ItemArmor)
+                    {
+                        if (EntityLiving.getArmorPosition(p_174820_2_) != var4)
+                        {
+                            return false;
+                        }
+                    }
+                    else if (var4 != 4 || p_174820_2_.getItem() != Items.skull && !(p_174820_2_.getItem() instanceof ItemBlock))
+                    {
+                        return false;
+                    }
+                }
+
+                this.inventory.setInventorySlotContents(var3 + this.inventory.mainInventory.length, p_174820_2_);
+                return true;
+            }
+            else
+            {
+                var4 = p_174820_1_ - 200;
+
+                if (var4 >= 0 && var4 < this.theInventoryEnderChest.getSizeInventory())
+                {
+                    this.theInventoryEnderChest.setInventorySlotContents(var4, p_174820_2_);
+                    return true;
+                }
+                else
+                {
+                    return false;
+                }
+            }
+        }
+    }
+
+    public boolean func_175140_cp()
+    {
+        return this.field_175153_bG;
+    }
+
+    public void func_175150_k(boolean p_175150_1_)
+    {
+        this.field_175153_bG = p_175150_1_;
+    }
+
+    public static enum EnumChatVisibility
+    {
+        FULL("FULL", 0, 0, "options.chat.visibility.full"),
+        SYSTEM("SYSTEM", 1, 1, "options.chat.visibility.system"),
+        HIDDEN("HIDDEN", 2, 2, "options.chat.visibility.hidden");
+        private static final EntityPlayer.EnumChatVisibility[] field_151432_d = new EntityPlayer.EnumChatVisibility[values().length];
+        private final int chatVisibility;
+        private final String resourceKey;
+
+        private static final EntityPlayer.EnumChatVisibility[] $VALUES = new EntityPlayer.EnumChatVisibility[]{FULL, SYSTEM, HIDDEN};
+        private static final String __OBFID = "CL_00001714";
+
+        private EnumChatVisibility(String p_i45323_1_, int p_i45323_2_, int p_i45323_3_, String p_i45323_4_)
+        {
+            this.chatVisibility = p_i45323_3_;
+            this.resourceKey = p_i45323_4_;
+        }
+
+        public int getChatVisibility()
+        {
+            return this.chatVisibility;
+        }
+
+        public static EntityPlayer.EnumChatVisibility getEnumChatVisibility(int p_151426_0_)
+        {
+            return field_151432_d[p_151426_0_ % field_151432_d.length];
+        }
+
+        public String getResourceKey()
+        {
+            return this.resourceKey;
+        }
+
+        static {
+            EntityPlayer.EnumChatVisibility[] var0 = values();
+            int var1 = var0.length;
+
+            for (int var2 = 0; var2 < var1; ++var2)
+            {
+                EntityPlayer.EnumChatVisibility var3 = var0[var2];
+                field_151432_d[var3.chatVisibility] = var3;
+            }
+        }
+    }
+
+    public static enum EnumStatus
+    {
+        OK("OK", 0),
+        NOT_POSSIBLE_HERE("NOT_POSSIBLE_HERE", 1),
+        NOT_POSSIBLE_NOW("NOT_POSSIBLE_NOW", 2),
+        TOO_FAR_AWAY("TOO_FAR_AWAY", 3),
+        OTHER_PROBLEM("OTHER_PROBLEM", 4),
+        NOT_SAFE("NOT_SAFE", 5);
+
+        private static final EntityPlayer.EnumStatus[] $VALUES = new EntityPlayer.EnumStatus[]{OK, NOT_POSSIBLE_HERE, NOT_POSSIBLE_NOW, TOO_FAR_AWAY, OTHER_PROBLEM, NOT_SAFE};
+        private static final String __OBFID = "CL_00001712";
+
+        private EnumStatus(String p_i1751_1_, int p_i1751_2_) {}
+    }
+
+    static final class SwitchEnumFacing
+    {
+        static final int[] field_179420_a = new int[EnumFacing.values().length];
+        private static final String __OBFID = "CL_00002188";
+
+        static
+        {
+            try
+            {
+                field_179420_a[EnumFacing.SOUTH.ordinal()] = 1;
+            }
+            catch (NoSuchFieldError var4)
+            {
+                ;
+            }
+
+            try
+            {
+                field_179420_a[EnumFacing.NORTH.ordinal()] = 2;
+            }
+            catch (NoSuchFieldError var3)
+            {
+                ;
+            }
+
+            try
+            {
+                field_179420_a[EnumFacing.WEST.ordinal()] = 3;
+            }
+            catch (NoSuchFieldError var2)
+            {
+                ;
+            }
+
+            try
+            {
+                field_179420_a[EnumFacing.EAST.ordinal()] = 4;
+            }
+            catch (NoSuchFieldError var1)
+            {
+                ;
+            }
+        }
+    }
+}
diff --git a/src/net/minecraft/entity/player/EntityPlayerMP.java b/src/net/minecraft/entity/player/EntityPlayerMP.java
index edb94d6..398598b 100644
--- a/src/net/minecraft/entity/player/EntityPlayerMP.java
+++ b/src/net/minecraft/entity/player/EntityPlayerMP.java
@@ -3,13 +3,16 @@ package net.minecraft.entity.player;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Sets;
 import com.mojang.authlib.GameProfile;
+
 import io.netty.buffer.Unpooled;
+
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collection;
 import java.util.HashSet;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockFence;
 import net.minecraft.block.BlockFenceGate;
@@ -96,6 +99,7 @@ import net.minecraft.world.WorldServer;
 import net.minecraft.world.WorldSettings;
 import net.minecraft.world.biome.BiomeGenBase;
 import net.minecraft.world.chunk.Chunk;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
@@ -642,7 +646,7 @@ public class EntityPlayerMP extends EntityPlayer implements ICrafting
 
     public boolean func_174827_a(EntityPlayerMP p_174827_1_)
     {
-        return p_174827_1_.func_175149_v() ? this.func_175398_C() == this : (this.func_175149_v() ? false : super.func_174827_a(p_174827_1_));
+        return p_174827_1_.isSpectator() ? this.func_175398_C() == this : (this.isSpectator() ? false : super.func_174827_a(p_174827_1_));
     }
 
     private void sendTileEntityUpdate(TileEntity p_147097_1_)
@@ -779,7 +783,7 @@ public class EntityPlayerMP extends EntityPlayer implements ICrafting
         {
             ILockableContainer var2 = (ILockableContainer)chestInventory;
 
-            if (var2.isLocked() && !this.func_175146_a(var2.getLockCode()) && !this.func_175149_v())
+            if (var2.isLocked() && !this.func_175146_a(var2.getLockCode()) && !this.isSpectator())
             {
                 this.playerNetServerHandler.sendPacket(new S02PacketChat(new ChatComponentTranslation("container.isLocked", new Object[] {chestInventory.getDisplayName()}), (byte)2));
                 this.playerNetServerHandler.sendPacket(new S29PacketSoundEffect("random.door_close", this.posX, this.posY, this.posZ, 1.0F, 1.0F));
@@ -1128,7 +1132,7 @@ public class EntityPlayerMP extends EntityPlayer implements ICrafting
         this.func_175136_bO();
     }
 
-    public boolean func_175149_v()
+    public boolean isSpectator()
     {
         return this.theItemInWorldManager.getGameType() == WorldSettings.GameType.SPECTATOR;
     }
@@ -1232,7 +1236,7 @@ public class EntityPlayerMP extends EntityPlayer implements ICrafting
 
     protected void func_175135_B()
     {
-        if (this.func_175149_v())
+        if (this.isSpectator())
         {
             this.func_175133_bi();
             this.setInvisible(true);
diff --git a/src/net/minecraft/entity/player/InventoryPlayer.java b/src/net/minecraft/entity/player/InventoryPlayer.java
index 691d6f6..317558a 100644
--- a/src/net/minecraft/entity/player/InventoryPlayer.java
+++ b/src/net/minecraft/entity/player/InventoryPlayer.java
@@ -1,6 +1,7 @@
 package net.minecraft.entity.player;
 
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.command.server.CommandTestForBlock;
 import net.minecraft.crash.CrashReport;
diff --git a/src/net/minecraft/entity/projectile/EntityArrow.java b/src/net/minecraft/entity/projectile/EntityArrow.java
index ff39a27..0e92581 100644
--- a/src/net/minecraft/entity/projectile/EntityArrow.java
+++ b/src/net/minecraft/entity/projectile/EntityArrow.java
@@ -372,7 +372,7 @@ public class EntityArrow extends Entity implements IProjectile
                 }
                 else
                 {
-                    BlockPos var23 = var6.func_178782_a();
+                    BlockPos var23 = var6.getBlockPos();
                     this.field_145791_d = var23.getX();
                     this.field_145792_e = var23.getY();
                     this.field_145789_f = var23.getZ();
diff --git a/src/net/minecraft/entity/projectile/EntitySmallFireball.java b/src/net/minecraft/entity/projectile/EntitySmallFireball.java
index 55181ad..988a480 100644
--- a/src/net/minecraft/entity/projectile/EntitySmallFireball.java
+++ b/src/net/minecraft/entity/projectile/EntitySmallFireball.java
@@ -64,7 +64,7 @@ public class EntitySmallFireball extends EntityFireball
 
                 if (var2)
                 {
-                    BlockPos var3 = p_70227_1_.func_178782_a().offset(p_70227_1_.field_178784_b);
+                    BlockPos var3 = p_70227_1_.getBlockPos().offset(p_70227_1_.sideHit);
 
                     if (this.worldObj.isAirBlock(var3))
                     {
diff --git a/src/net/minecraft/entity/projectile/EntityThrowable.java b/src/net/minecraft/entity/projectile/EntityThrowable.java
index 3286135..a809806 100644
--- a/src/net/minecraft/entity/projectile/EntityThrowable.java
+++ b/src/net/minecraft/entity/projectile/EntityThrowable.java
@@ -218,7 +218,7 @@ public abstract class EntityThrowable extends Entity implements IProjectile
 
         if (var3 != null)
         {
-            if (var3.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.worldObj.getBlockState(var3.func_178782_a()).getBlock() == Blocks.portal)
+            if (var3.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && this.worldObj.getBlockState(var3.getBlockPos()).getBlock() == Blocks.portal)
             {
                 this.setInPortal();
             }
diff --git a/src/net/minecraft/inventory/ContainerPlayer.java b/src/net/minecraft/inventory/ContainerPlayer.java
index f990268..4358a9d 100644
--- a/src/net/minecraft/inventory/ContainerPlayer.java
+++ b/src/net/minecraft/inventory/ContainerPlayer.java
@@ -50,7 +50,7 @@ public class ContainerPlayer extends Container
                 {
                     return stack == null ? false : (stack.getItem() instanceof ItemArmor ? ((ItemArmor)stack.getItem()).armorType == var44 : (stack.getItem() != Item.getItemFromBlock(Blocks.pumpkin) && stack.getItem() != Items.skull ? false : var44 == 0));
                 }
-                public String func_178171_c()
+                public String getNull()
                 {
                     return ItemArmor.EMPTY_SLOT_NAMES[var44];
                 }
diff --git a/src/net/minecraft/inventory/Slot.java b/src/net/minecraft/inventory/Slot.java
index c9a68cf..d02858e 100644
--- a/src/net/minecraft/inventory/Slot.java
+++ b/src/net/minecraft/inventory/Slot.java
@@ -119,7 +119,12 @@ public class Slot
         return this.getSlotStackLimit();
     }
 
-    public String func_178171_c()
+    //TODO: Client
+    /**
+     * WTF, null?!
+     * @return null
+     */
+    public String getNull()
     {
         return null;
     }
diff --git a/src/net/minecraft/item/ItemBoat.java b/src/net/minecraft/item/ItemBoat.java
index fc9d038..1d5b91a 100644
--- a/src/net/minecraft/item/ItemBoat.java
+++ b/src/net/minecraft/item/ItemBoat.java
@@ -81,7 +81,7 @@ public class ItemBoat extends Item
             {
                 if (var24.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
                 {
-                    BlockPos var33 = var24.func_178782_a();
+                    BlockPos var33 = var24.getBlockPos();
 
                     if (worldIn.getBlockState(var33).getBlock() == Blocks.snow_layer)
                     {
diff --git a/src/net/minecraft/item/ItemBucket.java b/src/net/minecraft/item/ItemBucket.java
index c354da4..4b73532 100644
--- a/src/net/minecraft/item/ItemBucket.java
+++ b/src/net/minecraft/item/ItemBucket.java
@@ -43,7 +43,7 @@ public class ItemBucket extends Item
         {
             if (var5.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
             {
-                BlockPos var6 = var5.func_178782_a();
+                BlockPos var6 = var5.getBlockPos();
 
                 if (!worldIn.isBlockModifiable(playerIn, var6))
                 {
@@ -52,7 +52,7 @@ public class ItemBucket extends Item
 
                 if (var4)
                 {
-                    if (!playerIn.func_175151_a(var6.offset(var5.field_178784_b), var5.field_178784_b, itemStackIn))
+                    if (!playerIn.func_175151_a(var6.offset(var5.sideHit), var5.sideHit, itemStackIn))
                     {
                         return itemStackIn;
                     }
@@ -81,9 +81,9 @@ public class ItemBucket extends Item
                         return new ItemStack(Items.bucket);
                     }
 
-                    BlockPos var9 = var6.offset(var5.field_178784_b);
+                    BlockPos var9 = var6.offset(var5.sideHit);
 
-                    if (!playerIn.func_175151_a(var9, var5.field_178784_b, itemStackIn))
+                    if (!playerIn.func_175151_a(var9, var5.sideHit, itemStackIn))
                     {
                         return itemStackIn;
                     }
diff --git a/src/net/minecraft/item/ItemEnderEye.java b/src/net/minecraft/item/ItemEnderEye.java
index 72f64fc..2e74207 100644
--- a/src/net/minecraft/item/ItemEnderEye.java
+++ b/src/net/minecraft/item/ItemEnderEye.java
@@ -153,7 +153,7 @@ public class ItemEnderEye extends Item
     {
         MovingObjectPosition var4 = this.getMovingObjectPositionFromPlayer(worldIn, playerIn, false);
 
-        if (var4 != null && var4.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && worldIn.getBlockState(var4.func_178782_a()).getBlock() == Blocks.end_portal_frame)
+        if (var4 != null && var4.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK && worldIn.getBlockState(var4.getBlockPos()).getBlock() == Blocks.end_portal_frame)
         {
             return itemStackIn;
         }
diff --git a/src/net/minecraft/item/ItemGlassBottle.java b/src/net/minecraft/item/ItemGlassBottle.java
index 03aaa1f..4fe573b 100644
--- a/src/net/minecraft/item/ItemGlassBottle.java
+++ b/src/net/minecraft/item/ItemGlassBottle.java
@@ -33,14 +33,14 @@ public class ItemGlassBottle extends Item
         {
             if (var4.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
             {
-                BlockPos var5 = var4.func_178782_a();
+                BlockPos var5 = var4.getBlockPos();
 
                 if (!worldIn.isBlockModifiable(playerIn, var5))
                 {
                     return itemStackIn;
                 }
 
-                if (!playerIn.func_175151_a(var5.offset(var4.field_178784_b), var4.field_178784_b, itemStackIn))
+                if (!playerIn.func_175151_a(var5.offset(var4.sideHit), var4.sideHit, itemStackIn))
                 {
                     return itemStackIn;
                 }
diff --git a/src/net/minecraft/item/ItemLilyPad.java b/src/net/minecraft/item/ItemLilyPad.java
index 44467ae..1149c5e 100644
--- a/src/net/minecraft/item/ItemLilyPad.java
+++ b/src/net/minecraft/item/ItemLilyPad.java
@@ -35,14 +35,14 @@ public class ItemLilyPad extends ItemColored
         {
             if (var4.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
             {
-                BlockPos var5 = var4.func_178782_a();
+                BlockPos var5 = var4.getBlockPos();
 
                 if (!worldIn.isBlockModifiable(playerIn, var5))
                 {
                     return itemStackIn;
                 }
 
-                if (!playerIn.func_175151_a(var5.offset(var4.field_178784_b), var4.field_178784_b, itemStackIn))
+                if (!playerIn.func_175151_a(var5.offset(var4.sideHit), var4.sideHit, itemStackIn))
                 {
                     return itemStackIn;
                 }
diff --git a/src/net/minecraft/item/ItemMonsterPlacer.java b/src/net/minecraft/item/ItemMonsterPlacer.java
index bb47501..254173e 100644
--- a/src/net/minecraft/item/ItemMonsterPlacer.java
+++ b/src/net/minecraft/item/ItemMonsterPlacer.java
@@ -141,14 +141,14 @@ public class ItemMonsterPlacer extends Item
             {
                 if (var4.typeOfHit == MovingObjectPosition.MovingObjectType.BLOCK)
                 {
-                    BlockPos var5 = var4.func_178782_a();
+                    BlockPos var5 = var4.getBlockPos();
 
                     if (!worldIn.isBlockModifiable(playerIn, var5))
                     {
                         return itemStackIn;
                     }
 
-                    if (!playerIn.func_175151_a(var5, var4.field_178784_b, itemStackIn))
+                    if (!playerIn.func_175151_a(var5, var4.sideHit, itemStackIn))
                     {
                         return itemStackIn;
                     }
diff --git a/src/net/minecraft/nbt/CompressedStreamTools.java b/src/net/minecraft/nbt/CompressedStreamTools.java
index f82a045..f54bb62 100644
--- a/src/net/minecraft/nbt/CompressedStreamTools.java
+++ b/src/net/minecraft/nbt/CompressedStreamTools.java
@@ -14,6 +14,7 @@ import java.io.InputStream;
 import java.io.OutputStream;
 import java.util.zip.GZIPInputStream;
 import java.util.zip.GZIPOutputStream;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.ReportedException;
diff --git a/src/net/minecraft/nbt/NBTTagCompound.java b/src/net/minecraft/nbt/NBTTagCompound.java
index b5f305a..c4bee40 100644
--- a/src/net/minecraft/nbt/NBTTagCompound.java
+++ b/src/net/minecraft/nbt/NBTTagCompound.java
@@ -1,6 +1,7 @@
 package net.minecraft.nbt;
 
 import com.google.common.collect.Maps;
+
 import java.io.DataInput;
 import java.io.DataOutput;
 import java.io.IOException;
@@ -8,9 +9,11 @@ import java.util.Iterator;
 import java.util.Map;
 import java.util.Set;
 import java.util.concurrent.Callable;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.ReportedException;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/network/NetHandlerPlayServer.java b/src/net/minecraft/network/NetHandlerPlayServer.java
index 38b9ecd..f64dc7e 100644
--- a/src/net/minecraft/network/NetHandlerPlayServer.java
+++ b/src/net/minecraft/network/NetHandlerPlayServer.java
@@ -2,9 +2,11 @@ package net.minecraft.network;
 
 import com.google.common.collect.Lists;
 import com.google.common.util.concurrent.Futures;
+
 import io.netty.buffer.Unpooled;
 import io.netty.util.concurrent.Future;
 import io.netty.util.concurrent.GenericFutureListener;
+
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Collections;
@@ -12,6 +14,7 @@ import java.util.Date;
 import java.util.Iterator;
 import java.util.Set;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.material.Material;
 import net.minecraft.command.server.CommandBlockLogic;
 import net.minecraft.crash.CrashReport;
@@ -37,6 +40,7 @@ import net.minecraft.item.ItemStack;
 import net.minecraft.item.ItemWritableBook;
 import net.minecraft.nbt.NBTTagCompound;
 import net.minecraft.nbt.NBTTagString;
+import net.minecraft.network.NetworkManager;
 import net.minecraft.network.play.INetHandlerPlayServer;
 import net.minecraft.network.play.client.C00PacketKeepAlive;
 import net.minecraft.network.play.client.C01PacketChatMessage;
@@ -89,6 +93,7 @@ import net.minecraft.util.IChatComponent;
 import net.minecraft.util.IntHashMap;
 import net.minecraft.util.ReportedException;
 import net.minecraft.world.WorldServer;
+
 import org.apache.commons.lang3.StringUtils;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
@@ -493,7 +498,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
         switch (NetHandlerPlayServer.SwitchAction.field_180224_a[packetIn.func_180762_c().ordinal()])
         {
             case 1:
-                if (!this.playerEntity.func_175149_v())
+                if (!this.playerEntity.isSpectator())
                 {
                     this.playerEntity.dropOneItem(false);
                 }
@@ -501,7 +506,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
                 return;
 
             case 2:
-                if (!this.playerEntity.func_175149_v())
+                if (!this.playerEntity.isSpectator())
                 {
                     this.playerEntity.dropOneItem(true);
                 }
@@ -638,7 +643,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
     {
         PacketThreadUtil.func_180031_a(p_175088_1_, this, this.playerEntity.getServerForPlayer());
 
-        if (this.playerEntity.func_175149_v())
+        if (this.playerEntity.isSpectator())
         {
             Entity var2 = null;
             WorldServer[] var3 = this.serverController.worldServers;
@@ -1012,7 +1017,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
 
         if (this.playerEntity.openContainer.windowId == packetIn.getWindowId() && this.playerEntity.openContainer.getCanCraft(this.playerEntity))
         {
-            if (this.playerEntity.func_175149_v())
+            if (this.playerEntity.isSpectator())
             {
                 ArrayList var2 = Lists.newArrayList();
 
@@ -1062,7 +1067,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
         PacketThreadUtil.func_180031_a(packetIn, this, this.playerEntity.getServerForPlayer());
         this.playerEntity.markPlayerActive();
 
-        if (this.playerEntity.openContainer.windowId == packetIn.getId() && this.playerEntity.openContainer.getCanCraft(this.playerEntity) && !this.playerEntity.func_175149_v())
+        if (this.playerEntity.openContainer.windowId == packetIn.getId() && this.playerEntity.openContainer.getCanCraft(this.playerEntity) && !this.playerEntity.isSpectator())
         {
             this.playerEntity.openContainer.enchantItem(this.playerEntity, packetIn.getButton());
             this.playerEntity.openContainer.detectAndSendChanges();
@@ -1142,7 +1147,7 @@ public class NetHandlerPlayServer implements INetHandlerPlayServer, IUpdatePlaye
         PacketThreadUtil.func_180031_a(packetIn, this, this.playerEntity.getServerForPlayer());
         Short var2 = (Short)this.field_147372_n.lookup(this.playerEntity.openContainer.windowId);
 
-        if (var2 != null && packetIn.getUid() == var2.shortValue() && this.playerEntity.openContainer.windowId == packetIn.getId() && !this.playerEntity.openContainer.getCanCraft(this.playerEntity) && !this.playerEntity.func_175149_v())
+        if (var2 != null && packetIn.getUid() == var2.shortValue() && this.playerEntity.openContainer.windowId == packetIn.getId() && !this.playerEntity.openContainer.getCanCraft(this.playerEntity) && !this.playerEntity.isSpectator())
         {
             this.playerEntity.openContainer.setCanCraft(this.playerEntity, true);
         }
diff --git a/src/net/minecraft/network/NetworkManager.java b/src/net/minecraft/network/NetworkManager.java
index f05dadf..3fedcdd 100644
--- a/src/net/minecraft/network/NetworkManager.java
+++ b/src/net/minecraft/network/NetworkManager.java
@@ -1,479 +1,464 @@
-package net.minecraft.network;
-
-import com.google.common.collect.Queues;
-import com.google.common.util.concurrent.ThreadFactoryBuilder;
-import io.netty.bootstrap.Bootstrap;
-import io.netty.channel.Channel;
-import io.netty.channel.ChannelException;
-import io.netty.channel.ChannelFuture;
-import io.netty.channel.ChannelFutureListener;
-import io.netty.channel.ChannelHandlerContext;
-import io.netty.channel.ChannelInitializer;
-import io.netty.channel.ChannelOption;
-import io.netty.channel.EventLoopGroup;
-import io.netty.channel.SimpleChannelInboundHandler;
-import io.netty.channel.local.LocalChannel;
-import io.netty.channel.local.LocalEventLoopGroup;
-import io.netty.channel.local.LocalServerChannel;
-import io.netty.channel.nio.NioEventLoopGroup;
-import io.netty.channel.socket.nio.NioSocketChannel;
-import io.netty.handler.timeout.ReadTimeoutHandler;
-import io.netty.util.AttributeKey;
-import io.netty.util.concurrent.GenericFutureListener;
-import java.net.InetAddress;
-import java.net.SocketAddress;
-import java.util.Queue;
-import javax.crypto.SecretKey;
-import net.minecraft.server.gui.IUpdatePlayerListBox;
-import net.minecraft.util.ChatComponentText;
-import net.minecraft.util.ChatComponentTranslation;
-import net.minecraft.util.CryptManager;
-import net.minecraft.util.IChatComponent;
-import net.minecraft.util.LazyLoadBase;
-import net.minecraft.util.MessageDeserializer;
-import net.minecraft.util.MessageDeserializer2;
-import net.minecraft.util.MessageSerializer;
-import net.minecraft.util.MessageSerializer2;
-import org.apache.commons.lang3.ArrayUtils;
-import org.apache.commons.lang3.Validate;
-import org.apache.logging.log4j.LogManager;
-import org.apache.logging.log4j.Logger;
-import org.apache.logging.log4j.Marker;
-import org.apache.logging.log4j.MarkerManager;
-
-public class NetworkManager extends SimpleChannelInboundHandler
-{
-    private static final Logger logger = LogManager.getLogger();
-    public static final Marker logMarkerNetwork = MarkerManager.getMarker("NETWORK");
-    public static final Marker logMarkerPackets = MarkerManager.getMarker("NETWORK_PACKETS", logMarkerNetwork);
-    public static final AttributeKey attrKeyConnectionState = AttributeKey.valueOf("protocol");
-    public static final LazyLoadBase CLIENT_NIO_EVENTLOOP = new LazyLoadBase()
-    {
-        private static final String __OBFID = "CL_00001241";
-        protected NioEventLoopGroup genericLoad()
-        {
-            return new NioEventLoopGroup(0, (new ThreadFactoryBuilder()).setNameFormat("Netty Client IO #%d").setDaemon(true).build());
-        }
-        protected Object load()
-        {
-            return this.genericLoad();
-        }
-    };
-    public static final LazyLoadBase CLIENT_LOCAL_EVENTLOOP = new LazyLoadBase()
-    {
-        private static final String __OBFID = "CL_00001242";
-        protected LocalEventLoopGroup genericLoad()
-        {
-            return new LocalEventLoopGroup(0, (new ThreadFactoryBuilder()).setNameFormat("Netty Local Client IO #%d").setDaemon(true).build());
-        }
-        protected Object load()
-        {
-            return this.genericLoad();
-        }
-    };
-    private final EnumPacketDirection direction;
-
-    /** The queue for packets that require transmission */
-    private final Queue outboundPacketsQueue = Queues.newConcurrentLinkedQueue();
-
-    /** The active channel */
-    private Channel channel;
-
-    /** The address of the remote party */
-    private SocketAddress socketAddress;
-
-    /** The INetHandler instance responsible for processing received packets */
-    private INetHandler packetListener;
-
-    /** A String indicating why the network has shutdown. */
-    private IChatComponent terminationReason;
-    private boolean isEncrypted;
-    private boolean disconnected;
-    private static final String __OBFID = "CL_00001240";
-
-    public NetworkManager(EnumPacketDirection packetDirection)
-    {
-        this.direction = packetDirection;
-    }
-
-    public void channelActive(ChannelHandlerContext p_channelActive_1_) throws Exception
-    {
-        super.channelActive(p_channelActive_1_);
-        this.channel = p_channelActive_1_.channel();
-        this.socketAddress = this.channel.remoteAddress();
-
-        try
-        {
-            this.setConnectionState(EnumConnectionState.HANDSHAKING);
-        }
-        catch (Throwable var3)
-        {
-            logger.fatal(var3);
-        }
-    }
-
-    /**
-     * Sets the new connection state and registers which packets this channel may send and receive
-     */
-    public void setConnectionState(EnumConnectionState newState)
-    {
-        this.channel.attr(attrKeyConnectionState).set(newState);
-        this.channel.config().setAutoRead(true);
-        logger.debug("Enabled auto read");
-    }
-
-    public void channelInactive(ChannelHandlerContext p_channelInactive_1_)
-    {
-        this.closeChannel(new ChatComponentTranslation("disconnect.endOfStream", new Object[0]));
-    }
-
-    public void exceptionCaught(ChannelHandlerContext p_exceptionCaught_1_, Throwable p_exceptionCaught_2_)
-    {
-        logger.debug("Disconnecting " + this.getRemoteAddress(), p_exceptionCaught_2_);
-        this.closeChannel(new ChatComponentTranslation("disconnect.genericReason", new Object[] {"Internal Exception: " + p_exceptionCaught_2_}));
-    }
-
-    protected void channelRead0(ChannelHandlerContext p_channelRead0_1_, Packet p_channelRead0_2_)
-    {
-        if (this.channel.isOpen())
-        {
-            try
-            {
-                p_channelRead0_2_.processPacket(this.packetListener);
-            }
-            catch (ThreadQuickExitException var4)
-            {
-                ;
-            }
-        }
-    }
-
-    /**
-     * Sets the NetHandler for this NetworkManager, no checks are made if this handler is suitable for the particular
-     * connection state (protocol)
-     */
-    public void setNetHandler(INetHandler handler)
-    {
-        Validate.notNull(handler, "packetListener", new Object[0]);
-        logger.debug("Set listener of {} to {}", new Object[] {this, handler});
-        this.packetListener = handler;
-    }
-
-    public void sendPacket(Packet packetIn)
-    {
-        if (this.channel != null && this.channel.isOpen())
-        {
-            this.flushOutboundQueue();
-            this.dispatchPacket(packetIn, (GenericFutureListener[])null);
-        }
-        else
-        {
-            this.outboundPacketsQueue.add(new NetworkManager.InboundHandlerTuplePacketListener(packetIn, (GenericFutureListener[])null));
-        }
-    }
-
-    public void sendPacket(Packet packetIn, GenericFutureListener listener, GenericFutureListener ... listeners)
-    {
-        if (this.channel != null && this.channel.isOpen())
-        {
-            this.flushOutboundQueue();
-            this.dispatchPacket(packetIn, (GenericFutureListener[])ArrayUtils.add(listeners, 0, listener));
-        }
-        else
-        {
-            this.outboundPacketsQueue.add(new NetworkManager.InboundHandlerTuplePacketListener(packetIn, (GenericFutureListener[])ArrayUtils.add(listeners, 0, listener)));
-        }
-    }
-
-    /**
-     * Will commit the packet to the channel. If the current thread 'owns' the channel it will write and flush the
-     * packet, otherwise it will add a task for the channel eventloop thread to do that.
-     */
-    private void dispatchPacket(final Packet inPacket, final GenericFutureListener[] futureListeners)
-    {
-        final EnumConnectionState var3 = EnumConnectionState.getFromPacket(inPacket);
-        final EnumConnectionState var4 = (EnumConnectionState)this.channel.attr(attrKeyConnectionState).get();
-
-        if (var4 != var3)
-        {
-            logger.debug("Disabled auto read");
-            this.channel.config().setAutoRead(false);
-        }
-
-        if (this.channel.eventLoop().inEventLoop())
-        {
-            if (var3 != var4)
-            {
-                this.setConnectionState(var3);
-            }
-
-            ChannelFuture var5 = this.channel.writeAndFlush(inPacket);
-
-            if (futureListeners != null)
-            {
-                var5.addListeners(futureListeners);
-            }
-
-            var5.addListener(ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE);
-        }
-        else
-        {
-            this.channel.eventLoop().execute(new Runnable()
-            {
-                private static final String __OBFID = "CL_00001243";
-                public void run()
-                {
-                    if (var3 != var4)
-                    {
-                        NetworkManager.this.setConnectionState(var3);
-                    }
-
-                    ChannelFuture var1 = NetworkManager.this.channel.writeAndFlush(inPacket);
-
-                    if (futureListeners != null)
-                    {
-                        var1.addListeners(futureListeners);
-                    }
-
-                    var1.addListener(ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE);
-                }
-            });
-        }
-    }
-
-    /**
-     * Will iterate through the outboundPacketQueue and dispatch all Packets
-     */
-    private void flushOutboundQueue()
-    {
-        if (this.channel != null && this.channel.isOpen())
-        {
-            while (!this.outboundPacketsQueue.isEmpty())
-            {
-                NetworkManager.InboundHandlerTuplePacketListener var1 = (NetworkManager.InboundHandlerTuplePacketListener)this.outboundPacketsQueue.poll();
-                this.dispatchPacket(var1.packet, var1.futureListeners);
-            }
-        }
-    }
-
-    /**
-     * Checks timeouts and processes all packets received
-     */
-    public void processReceivedPackets()
-    {
-        this.flushOutboundQueue();
-
-        if (this.packetListener instanceof IUpdatePlayerListBox)
-        {
-            ((IUpdatePlayerListBox)this.packetListener).update();
-        }
-
-        this.channel.flush();
-    }
-
-    /**
-     * Returns the socket address of the remote side. Server-only.
-     */
-    public SocketAddress getRemoteAddress()
-    {
-        return this.socketAddress;
-    }
-
-    /**
-     * Closes the channel, the parameter can be used for an exit message (not certain how it gets sent)
-     */
-    public void closeChannel(IChatComponent message)
-    {
-        if (this.channel.isOpen())
-        {
-            this.channel.close().awaitUninterruptibly();
-            this.terminationReason = message;
-        }
-    }
-
-    /**
-     * True if this NetworkManager uses a memory connection (single player game). False may imply both an active TCP
-     * connection or simply no active connection at all
-     */
-    public boolean isLocalChannel()
-    {
-        return this.channel instanceof LocalChannel || this.channel instanceof LocalServerChannel;
-    }
-
-    /**
-     * Prepares a clientside NetworkManager: establishes a connection to the address and port supplied and configures
-     * the channel pipeline. Returns the newly created instance.
-     */
-    public static NetworkManager provideLanClient(InetAddress p_150726_0_, int p_150726_1_)
-    {
-        final NetworkManager var2 = new NetworkManager(EnumPacketDirection.CLIENTBOUND);
-        ((Bootstrap)((Bootstrap)((Bootstrap)(new Bootstrap()).group((EventLoopGroup)CLIENT_NIO_EVENTLOOP.getValue())).handler(new ChannelInitializer()
-        {
-            private static final String __OBFID = "CL_00002312";
-            protected void initChannel(Channel p_initChannel_1_)
-            {
-                try
-                {
-                    p_initChannel_1_.config().setOption(ChannelOption.IP_TOS, Integer.valueOf(24));
-                }
-                catch (ChannelException var4)
-                {
-                    ;
-                }
-
-                try
-                {
-                    p_initChannel_1_.config().setOption(ChannelOption.TCP_NODELAY, Boolean.valueOf(false));
-                }
-                catch (ChannelException var3)
-                {
-                    ;
-                }
-
-                p_initChannel_1_.pipeline().addLast("timeout", new ReadTimeoutHandler(20)).addLast("splitter", new MessageDeserializer2()).addLast("decoder", new MessageDeserializer(EnumPacketDirection.CLIENTBOUND)).addLast("prepender", new MessageSerializer2()).addLast("encoder", new MessageSerializer(EnumPacketDirection.SERVERBOUND)).addLast("packet_handler", var2);
-            }
-        })).channel(NioSocketChannel.class)).connect(p_150726_0_, p_150726_1_).syncUninterruptibly();
-        return var2;
-    }
-
-    /**
-     * Prepares a clientside NetworkManager: establishes a connection to the socket supplied and configures the channel
-     * pipeline. Returns the newly created instance.
-     */
-    public static NetworkManager provideLocalClient(SocketAddress p_150722_0_)
-    {
-        final NetworkManager var1 = new NetworkManager(EnumPacketDirection.CLIENTBOUND);
-        ((Bootstrap)((Bootstrap)((Bootstrap)(new Bootstrap()).group((EventLoopGroup)CLIENT_LOCAL_EVENTLOOP.getValue())).handler(new ChannelInitializer()
-        {
-            private static final String __OBFID = "CL_00002311";
-            protected void initChannel(Channel p_initChannel_1_)
-            {
-                p_initChannel_1_.pipeline().addLast("packet_handler", var1);
-            }
-        })).channel(LocalChannel.class)).connect(p_150722_0_).syncUninterruptibly();
-        return var1;
-    }
-
-    /**
-     * Adds an encoder+decoder to the channel pipeline. The parameter is the secret key used for encrypted communication
-     */
-    public void enableEncryption(SecretKey key)
-    {
-        this.isEncrypted = true;
-        this.channel.pipeline().addBefore("splitter", "decrypt", new NettyEncryptingDecoder(CryptManager.func_151229_a(2, key)));
-        this.channel.pipeline().addBefore("prepender", "encrypt", new NettyEncryptingEncoder(CryptManager.func_151229_a(1, key)));
-    }
-
-    public boolean func_179292_f()
-    {
-        return this.isEncrypted;
-    }
-
-    /**
-     * Returns true if this NetworkManager has an active channel, false otherwise
-     */
-    public boolean isChannelOpen()
-    {
-        return this.channel != null && this.channel.isOpen();
-    }
-
-    public boolean hasNoChannel()
-    {
-        return this.channel == null;
-    }
-
-    /**
-     * Gets the current handler for processing packets
-     */
-    public INetHandler getNetHandler()
-    {
-        return this.packetListener;
-    }
-
-    /**
-     * If this channel is closed, returns the exit message, null otherwise.
-     */
-    public IChatComponent getExitMessage()
-    {
-        return this.terminationReason;
-    }
-
-    /**
-     * Switches the channel to manual reading modus
-     */
-    public void disableAutoRead()
-    {
-        this.channel.config().setAutoRead(false);
-    }
-
-    public void setCompressionTreshold(int treshold)
-    {
-        if (treshold >= 0)
-        {
-            if (this.channel.pipeline().get("decompress") instanceof NettyCompressionDecoder)
-            {
-                ((NettyCompressionDecoder)this.channel.pipeline().get("decompress")).setCompressionTreshold(treshold);
-            }
-            else
-            {
-                this.channel.pipeline().addBefore("decoder", "decompress", new NettyCompressionDecoder(treshold));
-            }
-
-            if (this.channel.pipeline().get("compress") instanceof NettyCompressionEncoder)
-            {
-                ((NettyCompressionEncoder)this.channel.pipeline().get("decompress")).setCompressionTreshold(treshold);
-            }
-            else
-            {
-                this.channel.pipeline().addBefore("encoder", "compress", new NettyCompressionEncoder(treshold));
-            }
-        }
-        else
-        {
-            if (this.channel.pipeline().get("decompress") instanceof NettyCompressionDecoder)
-            {
-                this.channel.pipeline().remove("decompress");
-            }
-
-            if (this.channel.pipeline().get("compress") instanceof NettyCompressionEncoder)
-            {
-                this.channel.pipeline().remove("compress");
-            }
-        }
-    }
-
-    public void checkDisconnected()
-    {
-        if (!this.hasNoChannel() && !this.isChannelOpen() && !this.disconnected)
-        {
-            this.disconnected = true;
-
-            if (this.getExitMessage() != null)
-            {
-                this.getNetHandler().onDisconnect(this.getExitMessage());
-            }
-            else if (this.getNetHandler() != null)
-            {
-                this.getNetHandler().onDisconnect(new ChatComponentText("Disconnected"));
-            }
-        }
-    }
-
-    protected void channelRead0(ChannelHandlerContext p_channelRead0_1_, Object p_channelRead0_2_)
-    {
-        this.channelRead0(p_channelRead0_1_, (Packet)p_channelRead0_2_);
-    }
-
-    static class InboundHandlerTuplePacketListener
-    {
-        private final Packet packet;
-        private final GenericFutureListener[] futureListeners;
-        private static final String __OBFID = "CL_00001244";
-
-        public InboundHandlerTuplePacketListener(Packet inPacket, GenericFutureListener ... inFutureListeners)
-        {
-            this.packet = inPacket;
-            this.futureListeners = inFutureListeners;
-        }
-    }
-}
+package net.minecraft.network;
+
+import io.netty.bootstrap.Bootstrap;
+import io.netty.channel.*;
+import io.netty.channel.local.LocalChannel;
+import io.netty.channel.local.LocalEventLoopGroup;
+import io.netty.channel.local.LocalServerChannel;
+import io.netty.channel.nio.NioEventLoopGroup;
+import io.netty.channel.socket.nio.NioSocketChannel;
+import io.netty.handler.timeout.ReadTimeoutHandler;
+import io.netty.util.AttributeKey;
+import io.netty.util.concurrent.GenericFutureListener;
+
+import java.net.InetAddress;
+import java.net.SocketAddress;
+import java.util.Queue;
+
+import javax.crypto.SecretKey;
+
+import net.minecraft.server.gui.IUpdatePlayerListBox;
+import net.minecraft.util.*;
+
+import org.apache.commons.lang3.ArrayUtils;
+import org.apache.commons.lang3.Validate;
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.Logger;
+import org.apache.logging.log4j.Marker;
+import org.apache.logging.log4j.MarkerManager;
+
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.events.EventManager;
+import tk.wurst_client.events.PacketInputEvent;
+import tk.wurst_client.mods.Mod;
+
+import com.google.common.collect.Queues;
+import com.google.common.util.concurrent.ThreadFactoryBuilder;
+
+public class NetworkManager extends SimpleChannelInboundHandler
+{
+	private static final String __OBFID = "CL_00000668";
+	private static final Logger logger = LogManager.getLogger();
+	public static final Marker logMarkerNetwork = MarkerManager.getMarker("NETWORK");
+	public static final Marker logMarkerPackets = MarkerManager.getMarker("NETWORK_PACKETS", logMarkerNetwork);
+	public static final AttributeKey attrKeyConnectionState = AttributeKey.valueOf("protocol");
+	public static final LazyLoadBase CLIENT_NIO_EVENTLOOP = new LazyLoadBase()
+	{
+		protected NioEventLoopGroup genericLoad()
+		{
+			return new NioEventLoopGroup(0, new ThreadFactoryBuilder().setNameFormat("Netty Client IO #%d").setDaemon(true).build());
+		}
+
+		@Override
+		protected Object load()
+		{
+			return genericLoad();
+		}
+	};
+	public static final LazyLoadBase CLIENT_LOCAL_EVENTLOOP = new LazyLoadBase()
+	{
+		protected LocalEventLoopGroup genericLoad()
+		{
+			return new LocalEventLoopGroup(0, new ThreadFactoryBuilder().setNameFormat("Netty Local Client IO #%d").setDaemon(true).build());
+		}
+
+		@Override
+		protected Object load()
+		{
+			return genericLoad();
+		}
+	};
+	/** The queue for packets that require transmission */
+	private final Queue outboundPacketsQueue = Queues.newConcurrentLinkedQueue();
+
+	/** The active channel */
+	private Channel channel;
+
+	/** The address of the remote party */
+	private SocketAddress socketAddress;
+
+	/** The INetHandler instance responsible for processing received packets */
+	private INetHandler packetListener;
+
+	/** A String indicating why the network has shutdown. */
+	private IChatComponent terminationReason;
+	private boolean isEncrypted;
+	private boolean disconnected;
+
+	public NetworkManager(EnumPacketDirection packetDirection)
+	{}
+
+	@Override
+	public void channelActive(ChannelHandlerContext p_channelActive_1_) throws Exception
+	{
+		super.channelActive(p_channelActive_1_);
+		channel = p_channelActive_1_.channel();
+		socketAddress = channel.remoteAddress();
+
+		try
+		{
+			setConnectionState(EnumConnectionState.HANDSHAKING);
+		}catch(Throwable var3)
+		{
+			logger.fatal(var3);
+		}
+	}
+
+	/**
+	 * Sets the new connection state and registers which packets this channel
+	 * may send and receive
+	 */
+	@SuppressWarnings("unchecked")
+	public void setConnectionState(EnumConnectionState newState)
+	{
+		channel.attr(attrKeyConnectionState).set(newState);
+		channel.config().setAutoRead(true);
+		logger.debug("Enabled auto read");
+	}
+
+	@Override
+	public void channelInactive(ChannelHandlerContext p_channelInactive_1_)
+	{
+		closeChannel(new ChatComponentTranslation("disconnect.endOfStream", new Object[0]));
+	}
+
+	@Override
+	public void exceptionCaught(ChannelHandlerContext p_exceptionCaught_1_, Throwable p_exceptionCaught_2_)
+	{
+		logger.debug("Disconnecting " + getRemoteAddress(), p_exceptionCaught_2_);
+
+		// TODO: Client
+		if(p_exceptionCaught_2_ instanceof NullPointerException)
+			closeChannel(new ChatComponentTranslation(
+				"disconnect.genericReason",
+				"c[6Wurstc]r\n"
+					+ "You are using a lcrackedr alt on a lpremiumr server."
+					+ "\ncDon't do this!"));
+		else
+			closeChannel(new ChatComponentTranslation("disconnect.genericReason", new Object[]{"Internal Exception: " + p_exceptionCaught_2_}));
+	}
+
+	protected void channelRead0(ChannelHandlerContext p_channelRead0_1_, Packet p_channelRead0_2_)
+	{
+		if(channel.isOpen())
+		{
+			//TODO: Client
+			PacketInputEvent event = new PacketInputEvent(p_channelRead0_2_);
+			WurstClient.INSTANCE.eventManager.fireEvent(PacketInputEvent.class, event);
+			if(event.isCancelled())
+				return;
+			
+			try
+			{
+				p_channelRead0_2_.processPacket(packetListener);
+			}catch(ThreadQuickExitException var4)
+			{
+				;
+			}
+		}
+	}
+
+	/**
+	 * Sets the NetHandler for this NetworkManager, no checks are made if this
+	 * handler is suitable for the particular
+	 * connection state (protocol)
+	 */
+	public void setNetHandler(INetHandler handler)
+	{
+		Validate.notNull(handler, "packetListener", new Object[0]);
+		logger.debug("Set listener of {} to {}", new Object[]{this, handler});
+		packetListener = handler;
+	}
+
+	@SuppressWarnings("unchecked")
+	public void sendPacket(Packet packetIn)
+	{
+		if(channel != null && channel.isOpen())
+		{
+			flushOutboundQueue();
+			dispatchPacket(packetIn, (GenericFutureListener[])null);
+		}else
+			outboundPacketsQueue.add(new NetworkManager.InboundHandlerTuplePacketListener(packetIn, (GenericFutureListener[])null));
+	}
+
+	@SuppressWarnings("unchecked")
+	public void sendPacket(Packet packetIn, GenericFutureListener listener, GenericFutureListener... listeners)
+	{
+		if(channel != null && channel.isOpen())
+		{
+			flushOutboundQueue();
+			dispatchPacket(packetIn, ArrayUtils.add(listeners, 0, listener));
+		}else
+			outboundPacketsQueue.add(new NetworkManager.InboundHandlerTuplePacketListener(packetIn, ArrayUtils.add(listeners, 0, listener)));
+	}
+
+	/**
+	 * Will commit the packet to the channel. If the current thread 'owns' the
+	 * channel it will write and flush the
+	 * packet, otherwise it will add a task for the channel eventloop thread to
+	 * do that.
+	 */
+	@SuppressWarnings("unchecked")
+	private void dispatchPacket(final Packet inPacket, final GenericFutureListener[] futureListeners)
+	{
+		final EnumConnectionState var3 = EnumConnectionState.getFromPacket(inPacket);
+		final EnumConnectionState var4 = (EnumConnectionState)channel.attr(attrKeyConnectionState).get();
+
+		if(var4 != var3)
+		{
+			logger.debug("Disabled auto read");
+			channel.config().setAutoRead(false);
+		}
+
+		if(channel.eventLoop().inEventLoop())
+		{
+			if(var3 != var4)
+				setConnectionState(var3);
+
+			ChannelFuture var5 = channel.writeAndFlush(inPacket);
+
+			if(futureListeners != null)
+				var5.addListeners(futureListeners);
+
+			var5.addListener(ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE);
+		}else
+			channel.eventLoop().execute(new Runnable()
+			{
+				@Override
+				public void run()
+				{
+					if(var3 != var4)
+						NetworkManager.this.setConnectionState(var3);
+
+					ChannelFuture var1 = channel.writeAndFlush(inPacket);
+
+					if(futureListeners != null)
+						var1.addListeners(futureListeners);
+
+					var1.addListener(ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE);
+				}
+			});
+	}
+
+	/**
+	 * Will iterate through the outboundPacketQueue and dispatch all Packets
+	 */
+	private void flushOutboundQueue()
+	{
+		if(channel != null && channel.isOpen())
+			while(!outboundPacketsQueue.isEmpty())
+			{
+				NetworkManager.InboundHandlerTuplePacketListener var1 = (NetworkManager.InboundHandlerTuplePacketListener)outboundPacketsQueue.poll();
+				dispatchPacket(var1.packet, var1.futureListeners);
+			}
+	}
+
+	/**
+	 * Checks timeouts and processes all packets received
+	 */
+	public void processReceivedPackets()
+	{
+		flushOutboundQueue();
+
+		if(packetListener instanceof IUpdatePlayerListBox)
+			((IUpdatePlayerListBox)packetListener).update();
+
+		channel.flush();
+	}
+
+	/**
+	 * Returns the socket address of the remote side. Server-only.
+	 */
+	public SocketAddress getRemoteAddress()
+	{
+		return socketAddress;
+	}
+
+	/**
+	 * Closes the channel, the parameter can be used for an exit message (not
+	 * certain how it gets sent)
+	 */
+	public void closeChannel(IChatComponent message)
+	{
+		if(channel.isOpen())
+		{
+			channel.close().awaitUninterruptibly();
+			terminationReason = message;
+		}
+	}
+
+	/**
+	 * True if this NetworkManager uses a memory connection (single player
+	 * game). False may imply both an active TCP
+	 * connection or simply no active connection at all
+	 */
+	public boolean isLocalChannel()
+	{
+		return channel instanceof LocalChannel || channel instanceof LocalServerChannel;
+	}
+
+	/**
+	 * Prepares a clientside NetworkManager: establishes a connection to the
+	 * address and port supplied and configures
+	 * the channel pipeline. Returns the newly created instance.
+	 */
+	public static NetworkManager provideLanClient(InetAddress p_150726_0_, int p_150726_1_)
+	{
+		final NetworkManager var2 = new NetworkManager(EnumPacketDirection.CLIENTBOUND);
+		new Bootstrap().group((EventLoopGroup)CLIENT_NIO_EVENTLOOP.getValue()).handler(new ChannelInitializer()
+		{
+			@Override
+			protected void initChannel(Channel p_initChannel_1_)
+			{
+				try
+				{
+					p_initChannel_1_.config().setOption(ChannelOption.IP_TOS, Integer.valueOf(24));
+				}
+				catch(ChannelException var4)
+				{
+					;
+				}
+
+				try
+				{
+					p_initChannel_1_.config().setOption(ChannelOption.TCP_NODELAY, Boolean.valueOf(false));
+				}
+				catch(ChannelException var3)
+				{
+					;
+				}
+
+				p_initChannel_1_.pipeline().addLast("timeout", new ReadTimeoutHandler(20)).addLast("splitter", new MessageDeserializer2()).addLast("decoder", new MessageDeserializer(EnumPacketDirection.CLIENTBOUND)).addLast("prepender", new MessageSerializer2()).addLast("encoder", new MessageSerializer(EnumPacketDirection.SERVERBOUND)).addLast("packet_handler", var2);
+			}
+		}).channel(NioSocketChannel.class).connect(p_150726_0_, p_150726_1_).syncUninterruptibly();
+		return var2;
+	}
+
+	/**
+	 * Prepares a clientside NetworkManager: establishes a connection to the
+	 * socket supplied and configures the channel
+	 * pipeline. Returns the newly created instance.
+	 */
+	public static NetworkManager provideLocalClient(SocketAddress p_150722_0_)
+	{
+		final NetworkManager var1 = new NetworkManager(EnumPacketDirection.CLIENTBOUND);
+		new Bootstrap().group((EventLoopGroup)CLIENT_LOCAL_EVENTLOOP.getValue()).handler(new ChannelInitializer()
+		{
+			@Override
+			protected void initChannel(Channel p_initChannel_1_)
+			{
+				p_initChannel_1_.pipeline().addLast("packet_handler", var1);
+			}
+		}).channel(LocalChannel.class).connect(p_150722_0_).syncUninterruptibly();
+		return var1;
+	}
+
+	/**
+	 * Adds an encoder+decoder to the channel pipeline. The parameter is the
+	 * secret key used for encrypted communication
+	 */
+	public void enableEncryption(SecretKey key)
+	{
+		isEncrypted = true;
+		channel.pipeline().addBefore("splitter", "decrypt", new NettyEncryptingDecoder(CryptManager.getAESCipher(2, key)));
+		channel.pipeline().addBefore("prepender", "encrypt", new NettyEncryptingEncoder(CryptManager.getAESCipher(1, key)));
+	}
+
+	public boolean isEncrypted()
+	{
+		return isEncrypted;
+	}
+
+	/**
+	 * Returns true if this NetworkManager has an active channel, false
+	 * otherwise
+	 */
+	public boolean isChannelOpen()
+	{
+		return channel != null && channel.isOpen();
+	}
+
+	public boolean hasNoChannel()
+	{
+		return channel == null;
+	}
+
+	/**
+	 * Gets the current handler for processing packets
+	 */
+	public INetHandler getNetHandler()
+	{
+		return packetListener;
+	}
+
+	/**
+	 * If this channel is closed, returns the exit message, null otherwise.
+	 */
+	public IChatComponent getExitMessage()
+	{
+		return terminationReason;
+	}
+
+	/**
+	 * Switches the channel to manual reading modus
+	 */
+	public void disableAutoRead()
+	{
+		channel.config().setAutoRead(false);
+	}
+
+	public void setCompressionTreshold(int treshold)
+	{
+		if(treshold >= 0)
+		{
+			if(channel.pipeline().get("decompress") instanceof NettyCompressionDecoder)
+				((NettyCompressionDecoder)channel.pipeline().get("decompress")).setCompressionTreshold(treshold);
+			else
+				channel.pipeline().addBefore("decoder", "decompress", new NettyCompressionDecoder(treshold));
+
+			if(channel.pipeline().get("compress") instanceof NettyCompressionEncoder)
+				((NettyCompressionEncoder)channel.pipeline().get("decompress")).setCompressionTreshold(treshold);
+			else
+				channel.pipeline().addBefore("encoder", "compress", new NettyCompressionEncoder(treshold));
+		}
+		else
+		{
+			if(channel.pipeline().get("decompress") instanceof NettyCompressionDecoder)
+				channel.pipeline().remove("decompress");
+
+			if(channel.pipeline().get("compress") instanceof NettyCompressionEncoder)
+				channel.pipeline().remove("compress");
+		}
+	}
+
+	public void checkDisconnected()
+	{
+		if(!hasNoChannel() && !isChannelOpen() && !disconnected)
+		{
+			disconnected = true;
+
+			if(getExitMessage() != null)
+				getNetHandler().onDisconnect(getExitMessage());
+			else if(getNetHandler() != null)
+				getNetHandler().onDisconnect(new ChatComponentText("Disconnected"));
+		}
+	}
+
+	@Override
+	protected void channelRead0(ChannelHandlerContext p_channelRead0_1_, Object p_channelRead0_2_)
+	{
+		this.channelRead0(p_channelRead0_1_, (Packet)p_channelRead0_2_);
+	}
+
+	static class InboundHandlerTuplePacketListener
+	{
+		private final Packet packet;
+		private final GenericFutureListener[] futureListeners;
+
+		public InboundHandlerTuplePacketListener(Packet inPacket, GenericFutureListener... inFutureListeners)
+		{
+			packet = inPacket;
+			futureListeners = inFutureListeners;
+		}
+	}
+}
diff --git a/src/net/minecraft/network/NetworkSystem.java b/src/net/minecraft/network/NetworkSystem.java
index f713c5d..e30c636 100644
--- a/src/net/minecraft/network/NetworkSystem.java
+++ b/src/net/minecraft/network/NetworkSystem.java
@@ -2,6 +2,7 @@ package net.minecraft.network;
 
 import com.google.common.collect.Lists;
 import com.google.common.util.concurrent.ThreadFactoryBuilder;
+
 import io.netty.bootstrap.ServerBootstrap;
 import io.netty.channel.Channel;
 import io.netty.channel.ChannelException;
@@ -17,6 +18,7 @@ import io.netty.channel.socket.nio.NioServerSocketChannel;
 import io.netty.handler.timeout.ReadTimeoutHandler;
 import io.netty.util.concurrent.Future;
 import io.netty.util.concurrent.GenericFutureListener;
+
 import java.io.IOException;
 import java.net.InetAddress;
 import java.net.SocketAddress;
@@ -24,9 +26,11 @@ import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
 import java.util.concurrent.Callable;
+
 import net.minecraft.client.network.NetHandlerHandshakeMemory;
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
+import net.minecraft.network.NetworkManager;
 import net.minecraft.network.play.server.S40PacketDisconnect;
 import net.minecraft.server.MinecraftServer;
 import net.minecraft.server.network.NetHandlerHandshakeTCP;
@@ -37,6 +41,7 @@ import net.minecraft.util.MessageDeserializer2;
 import net.minecraft.util.MessageSerializer;
 import net.minecraft.util.MessageSerializer2;
 import net.minecraft.util.ReportedException;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/network/PacketBuffer.java b/src/net/minecraft/network/PacketBuffer.java
index c9f2a49..67440f9 100644
--- a/src/net/minecraft/network/PacketBuffer.java
+++ b/src/net/minecraft/network/PacketBuffer.java
@@ -1,6 +1,5 @@
 package net.minecraft.network;
 
-import com.google.common.base.Charsets;
 import io.netty.buffer.ByteBuf;
 import io.netty.buffer.ByteBufAllocator;
 import io.netty.buffer.ByteBufInputStream;
@@ -8,7 +7,7 @@ import io.netty.buffer.ByteBufOutputStream;
 import io.netty.buffer.ByteBufProcessor;
 import io.netty.handler.codec.DecoderException;
 import io.netty.handler.codec.EncoderException;
-import io.netty.util.ReferenceCounted;
+
 import java.io.IOException;
 import java.io.InputStream;
 import java.io.OutputStream;
@@ -18,6 +17,7 @@ import java.nio.channels.GatheringByteChannel;
 import java.nio.channels.ScatteringByteChannel;
 import java.nio.charset.Charset;
 import java.util.UUID;
+
 import net.minecraft.item.Item;
 import net.minecraft.item.ItemStack;
 import net.minecraft.nbt.CompressedStreamTools;
@@ -26,6 +26,8 @@ import net.minecraft.nbt.NBTTagCompound;
 import net.minecraft.util.BlockPos;
 import net.minecraft.util.IChatComponent;
 
+import com.google.common.base.Charsets;
+
 public class PacketBuffer extends ByteBuf
 {
     private final ByteBuf buf;
diff --git a/src/net/minecraft/realms/RealmsConnect.java b/src/net/minecraft/realms/RealmsConnect.java
index 1702bc1..737d0e9 100644
--- a/src/net/minecraft/realms/RealmsConnect.java
+++ b/src/net/minecraft/realms/RealmsConnect.java
@@ -2,6 +2,7 @@ package net.minecraft.realms;
 
 import java.net.InetAddress;
 import java.net.UnknownHostException;
+
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.network.NetHandlerLoginClient;
 import net.minecraft.network.EnumConnectionState;
@@ -9,6 +10,7 @@ import net.minecraft.network.NetworkManager;
 import net.minecraft.network.handshake.client.C00Handshake;
 import net.minecraft.network.login.client.C00PacketLoginStart;
 import net.minecraft.util.ChatComponentTranslation;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/realms/RealmsScreen.java b/src/net/minecraft/realms/RealmsScreen.java
index 62e3405..cfa9311 100644
--- a/src/net/minecraft/realms/RealmsScreen.java
+++ b/src/net/minecraft/realms/RealmsScreen.java
@@ -112,7 +112,7 @@ public class RealmsScreen
 
         if (var2 == null)
         {
-            var2 = DefaultPlayerSkin.func_177334_a(UUIDTypeAdapter.fromString(p_bindFace_0_));
+            var2 = DefaultPlayerSkin.getLocationFromUUID(UUIDTypeAdapter.fromString(p_bindFace_0_));
         }
 
         AbstractClientPlayer.getDownloadImageSkin(var2, p_bindFace_1_);
diff --git a/src/net/minecraft/realms/RealmsServerStatusPinger.java b/src/net/minecraft/realms/RealmsServerStatusPinger.java
index d3363ff..f88a2eb 100644
--- a/src/net/minecraft/realms/RealmsServerStatusPinger.java
+++ b/src/net/minecraft/realms/RealmsServerStatusPinger.java
@@ -1,11 +1,13 @@
 package net.minecraft.realms;
 
 import com.google.common.collect.Lists;
+
 import java.net.InetAddress;
 import java.net.UnknownHostException;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
+
 import net.minecraft.network.EnumConnectionState;
 import net.minecraft.network.NetworkManager;
 import net.minecraft.network.ServerStatusResponse;
@@ -17,6 +19,7 @@ import net.minecraft.network.status.server.S00PacketServerInfo;
 import net.minecraft.network.status.server.S01PacketPong;
 import net.minecraft.util.ChatComponentText;
 import net.minecraft.util.IChatComponent;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/realms/Tezzelator.java b/src/net/minecraft/realms/Tezzelator.java
index a2b17d6..5566e2c 100644
--- a/src/net/minecraft/realms/Tezzelator.java
+++ b/src/net/minecraft/realms/Tezzelator.java
@@ -21,12 +21,12 @@ public class Tezzelator
 
     public void color(float p_color_1_, float p_color_2_, float p_color_3_, float p_color_4_)
     {
-        t.getWorldRenderer().func_178960_a(p_color_1_, p_color_2_, p_color_3_, p_color_4_);
+        t.getWorldRenderer().setColorRGBA_F(p_color_1_, p_color_2_, p_color_3_, p_color_4_);
     }
 
     public void color(int p_color_1_, int p_color_2_, int p_color_3_)
     {
-        t.getWorldRenderer().setPosition(p_color_1_, p_color_2_, p_color_3_);
+        t.getWorldRenderer().setColorOpaque(p_color_1_, p_color_2_, p_color_3_);
     }
 
     public void tex2(int p_tex2_1_)
@@ -46,12 +46,12 @@ public class Tezzelator
 
     public void color(int p_color_1_)
     {
-        t.getWorldRenderer().func_178991_c(p_color_1_);
+        t.getWorldRenderer().setColorOpaque_I(p_color_1_);
     }
 
     public void color(float p_color_1_, float p_color_2_, float p_color_3_)
     {
-        t.getWorldRenderer().func_178986_b(p_color_1_, p_color_2_, p_color_3_);
+        t.getWorldRenderer().setColorOpaque_F(p_color_1_, p_color_2_, p_color_3_);
     }
 
     public WorldRenderer.State sortQuads(float p_sortQuads_1_, float p_sortQuads_2_, float p_sortQuads_3_)
@@ -81,7 +81,7 @@ public class Tezzelator
 
     public void color(int p_color_1_, int p_color_2_)
     {
-        t.getWorldRenderer().func_178974_a(p_color_1_, p_color_2_);
+        t.getWorldRenderer().setColorRGBA_I(p_color_1_, p_color_2_);
     }
 
     public void offset(double p_offset_1_, double p_offset_3_, double p_offset_5_)
@@ -91,7 +91,7 @@ public class Tezzelator
 
     public void color(int p_color_1_, int p_color_2_, int p_color_3_, int p_color_4_)
     {
-        t.getWorldRenderer().func_178961_b(p_color_1_, p_color_2_, p_color_3_, p_color_4_);
+        t.getWorldRenderer().setColorRGBA(p_color_1_, p_color_2_, p_color_3_, p_color_4_);
     }
 
     public void tex(double p_tex_1_, double p_tex_3_)
@@ -101,6 +101,6 @@ public class Tezzelator
 
     public void color(byte p_color_1_, byte p_color_2_, byte p_color_3_)
     {
-        t.getWorldRenderer().func_178982_a(p_color_1_, p_color_2_, p_color_3_);
+        t.getWorldRenderer().setColorOpaque_B(p_color_1_, p_color_2_, p_color_3_);
     }
 }
diff --git a/src/net/minecraft/server/MinecraftServer.java b/src/net/minecraft/server/MinecraftServer.java
index f1e3bf8..a0e3566 100644
--- a/src/net/minecraft/server/MinecraftServer.java
+++ b/src/net/minecraft/server/MinecraftServer.java
@@ -10,10 +10,12 @@ import com.mojang.authlib.GameProfile;
 import com.mojang.authlib.GameProfileRepository;
 import com.mojang.authlib.minecraft.MinecraftSessionService;
 import com.mojang.authlib.yggdrasil.YggdrasilAuthenticationService;
+
 import io.netty.buffer.ByteBuf;
 import io.netty.buffer.ByteBufOutputStream;
 import io.netty.buffer.Unpooled;
 import io.netty.handler.codec.base64.Base64;
+
 import java.awt.GraphicsEnvironment;
 import java.awt.image.BufferedImage;
 import java.io.File;
@@ -33,7 +35,9 @@ import java.util.UUID;
 import java.util.concurrent.Callable;
 import java.util.concurrent.Executors;
 import java.util.concurrent.FutureTask;
+
 import javax.imageio.ImageIO;
+
 import net.minecraft.command.CommandBase;
 import net.minecraft.command.CommandResultStats;
 import net.minecraft.command.ICommandManager;
@@ -73,6 +77,7 @@ import net.minecraft.world.demo.DemoWorldServer;
 import net.minecraft.world.storage.ISaveFormat;
 import net.minecraft.world.storage.ISaveHandler;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.apache.commons.lang3.Validate;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
diff --git a/src/net/minecraft/server/integrated/IntegratedServer.java b/src/net/minecraft/server/integrated/IntegratedServer.java
index cf310a1..1caa8de 100644
--- a/src/net/minecraft/server/integrated/IntegratedServer.java
+++ b/src/net/minecraft/server/integrated/IntegratedServer.java
@@ -2,6 +2,7 @@ package net.minecraft.server.integrated;
 
 import com.google.common.collect.Lists;
 import com.google.common.util.concurrent.Futures;
+
 import java.io.File;
 import java.io.IOException;
 import java.net.InetAddress;
@@ -10,6 +11,7 @@ import java.util.Iterator;
 import java.util.Queue;
 import java.util.concurrent.Callable;
 import java.util.concurrent.FutureTask;
+
 import net.minecraft.client.ClientBrandRetriever;
 import net.minecraft.client.Minecraft;
 import net.minecraft.client.multiplayer.ThreadLanServerPing;
@@ -29,6 +31,7 @@ import net.minecraft.world.WorldType;
 import net.minecraft.world.demo.DemoWorldServer;
 import net.minecraft.world.storage.ISaveHandler;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/server/management/LowerStringMap.java b/src/net/minecraft/server/management/LowerStringMap.java
index 7a6a859..6456795 100644
--- a/src/net/minecraft/server/management/LowerStringMap.java
+++ b/src/net/minecraft/server/management/LowerStringMap.java
@@ -1,11 +1,11 @@
 package net.minecraft.server.management;
 
-import com.google.common.collect.Maps;
 import java.util.Collection;
 import java.util.Iterator;
 import java.util.Map;
 import java.util.Set;
-import java.util.Map.Entry;
+
+import com.google.common.collect.Maps;
 
 public class LowerStringMap implements Map
 {
diff --git a/src/net/minecraft/server/management/PlayerProfileCache.java b/src/net/minecraft/server/management/PlayerProfileCache.java
index 9154c32..8d568a4 100644
--- a/src/net/minecraft/server/management/PlayerProfileCache.java
+++ b/src/net/minecraft/server/management/PlayerProfileCache.java
@@ -257,11 +257,11 @@ public class PlayerProfileCache
         }
         catch (FileNotFoundException var8)
         {
-            return;
+            ;
         }
         catch (IOException var9)
         {
-            ;
+            return;
         }
         finally
         {
diff --git a/src/net/minecraft/server/management/ServerConfigurationManager.java b/src/net/minecraft/server/management/ServerConfigurationManager.java
index a9aff21..f94f085 100644
--- a/src/net/minecraft/server/management/ServerConfigurationManager.java
+++ b/src/net/minecraft/server/management/ServerConfigurationManager.java
@@ -4,7 +4,9 @@ import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
 import com.google.common.collect.Sets;
 import com.mojang.authlib.GameProfile;
+
 import io.netty.buffer.Unpooled;
+
 import java.io.File;
 import java.net.SocketAddress;
 import java.text.SimpleDateFormat;
@@ -15,6 +17,7 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 import java.util.UUID;
+
 import net.minecraft.entity.Entity;
 import net.minecraft.entity.EntityList;
 import net.minecraft.entity.player.EntityPlayer;
@@ -60,6 +63,7 @@ import net.minecraft.world.border.WorldBorder;
 import net.minecraft.world.demo.DemoWorldManager;
 import net.minecraft.world.storage.IPlayerFileData;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/server/network/NetHandlerLoginServer.java b/src/net/minecraft/server/network/NetHandlerLoginServer.java
index 5169593..fbc501d 100644
--- a/src/net/minecraft/server/network/NetHandlerLoginServer.java
+++ b/src/net/minecraft/server/network/NetHandlerLoginServer.java
@@ -1,19 +1,18 @@
 package net.minecraft.server.network;
 
-import com.google.common.base.Charsets;
-import com.mojang.authlib.GameProfile;
-import com.mojang.authlib.exceptions.AuthenticationUnavailableException;
 import io.netty.channel.ChannelFuture;
 import io.netty.channel.ChannelFutureListener;
-import io.netty.util.concurrent.Future;
 import io.netty.util.concurrent.GenericFutureListener;
+
 import java.math.BigInteger;
 import java.security.PrivateKey;
 import java.util.Arrays;
 import java.util.Random;
 import java.util.UUID;
 import java.util.concurrent.atomic.AtomicInteger;
+
 import javax.crypto.SecretKey;
+
 import net.minecraft.network.NetworkManager;
 import net.minecraft.network.login.INetHandlerLoginServer;
 import net.minecraft.network.login.client.C00PacketLoginStart;
@@ -27,10 +26,15 @@ import net.minecraft.server.gui.IUpdatePlayerListBox;
 import net.minecraft.util.ChatComponentText;
 import net.minecraft.util.CryptManager;
 import net.minecraft.util.IChatComponent;
+
 import org.apache.commons.lang3.Validate;
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
+import com.google.common.base.Charsets;
+import com.mojang.authlib.GameProfile;
+import com.mojang.authlib.exceptions.AuthenticationUnavailableException;
+
 public class NetHandlerLoginServer implements INetHandlerLoginServer, IUpdatePlayerListBox
 {
     private static final AtomicInteger AUTHENTICATOR_THREAD_ID = new AtomicInteger(0);
diff --git a/src/net/minecraft/tileentity/TileEntityChest.java b/src/net/minecraft/tileentity/TileEntityChest.java
index 7b1a14c..9cabdd9 100644
--- a/src/net/minecraft/tileentity/TileEntityChest.java
+++ b/src/net/minecraft/tileentity/TileEntityChest.java
@@ -445,7 +445,7 @@ public class TileEntityChest extends TileEntityLockable implements IUpdatePlayer
 
     public void openInventory(EntityPlayer playerIn)
     {
-        if (!playerIn.func_175149_v())
+        if (!playerIn.isSpectator())
         {
             if (this.numPlayersUsing < 0)
             {
@@ -461,7 +461,7 @@ public class TileEntityChest extends TileEntityLockable implements IUpdatePlayer
 
     public void closeInventory(EntityPlayer playerIn)
     {
-        if (!playerIn.func_175149_v() && this.getBlockType() instanceof BlockChest)
+        if (!playerIn.isSpectator() && this.getBlockType() instanceof BlockChest)
         {
             --this.numPlayersUsing;
             this.worldObj.addBlockEvent(this.pos, this.getBlockType(), 1, this.numPlayersUsing);
diff --git a/src/net/minecraft/tileentity/TileEntitySign.java b/src/net/minecraft/tileentity/TileEntitySign.java
index cf74f0e..0f11068 100644
--- a/src/net/minecraft/tileentity/TileEntitySign.java
+++ b/src/net/minecraft/tileentity/TileEntitySign.java
@@ -21,7 +21,8 @@ import net.minecraft.world.World;
 
 public class TileEntitySign extends TileEntity
 {
-    public final IChatComponent[] signText = new IChatComponent[] {new ChatComponentText(""), new ChatComponentText(""), new ChatComponentText(""), new ChatComponentText("")};
+	//TODO: Client
+    public IChatComponent[] signText = new IChatComponent[] {new ChatComponentText(""), new ChatComponentText(""), new ChatComponentText(""), new ChatComponentText("")};
 
     /**
      * The index of the line currently being edited. Only used on client side, but defined on both. Note this is only
diff --git a/src/net/minecraft/util/CryptManager.java b/src/net/minecraft/util/CryptManager.java
index 0a87cd0..54de080 100644
--- a/src/net/minecraft/util/CryptManager.java
+++ b/src/net/minecraft/util/CryptManager.java
@@ -68,11 +68,11 @@ public class CryptManager
     /**
      * Compute a serverId hash for use by sendSessionRequest()
      */
-    public static byte[] getServerIdHash(String p_75895_0_, PublicKey p_75895_1_, SecretKey p_75895_2_)
+    public static byte[] getServerIdHash(String input, PublicKey publicKey, SecretKey secretKey)
     {
         try
         {
-            return digestOperation("SHA-1", new byte[][] {p_75895_0_.getBytes("ISO_8859_1"), p_75895_2_.getEncoded(), p_75895_1_.getEncoded()});
+            return digestOperation("SHA-1", new byte[][] {input.getBytes("ISO_8859_1"), secretKey.getEncoded(), publicKey.getEncoded()});
         }
         catch (UnsupportedEncodingException var4)
         {
@@ -84,11 +84,11 @@ public class CryptManager
     /**
      * Compute a message digest on arbitrary byte[] data
      */
-    private static byte[] digestOperation(String p_75893_0_, byte[] ... p_75893_1_)
+    private static byte[] digestOperation(String algorithm, byte[] ... p_75893_1_)
     {
         try
         {
-            MessageDigest var2 = MessageDigest.getInstance(p_75893_0_);
+            MessageDigest var2 = MessageDigest.getInstance(algorithm);
             byte[][] var3 = p_75893_1_;
             int var4 = p_75893_1_.length;
 
@@ -134,9 +134,9 @@ public class CryptManager
     /**
      * Decrypt shared secret AES key using RSA private key
      */
-    public static SecretKey decryptSharedKey(PrivateKey p_75887_0_, byte[] p_75887_1_)
+    public static SecretKey decryptSharedKey(PrivateKey privateKey, byte[] input)
     {
-        return new SecretKeySpec(decryptData(p_75887_0_, p_75887_1_), "AES");
+        return new SecretKeySpec(decryptData(privateKey, input), "AES");
     }
 
     /**
@@ -150,19 +150,19 @@ public class CryptManager
     /**
      * Decrypt byte[] data with RSA private key
      */
-    public static byte[] decryptData(Key p_75889_0_, byte[] p_75889_1_)
+    public static byte[] decryptData(Key privateKey, byte[] input)
     {
-        return cipherOperation(2, p_75889_0_, p_75889_1_);
+        return cipherOperation(2, privateKey, input);
     }
 
     /**
      * Encrypt or decrypt byte[] data using the specified key
      */
-    private static byte[] cipherOperation(int p_75885_0_, Key p_75885_1_, byte[] p_75885_2_)
+    private static byte[] cipherOperation(int opmode, Key key, byte[] input)
     {
         try
         {
-            return createTheCipherInstance(p_75885_0_, p_75885_1_.getAlgorithm(), p_75885_1_).doFinal(p_75885_2_);
+            return createTheCipherInstance(opmode, key.getAlgorithm(), key).doFinal(input);
         }
         catch (IllegalBlockSizeException var4)
         {
@@ -180,12 +180,12 @@ public class CryptManager
     /**
      * Creates the Cipher Instance.
      */
-    private static Cipher createTheCipherInstance(int p_75886_0_, String p_75886_1_, Key p_75886_2_)
+    private static Cipher createTheCipherInstance(int opmode, String transformation, Key key)
     {
         try
         {
-            Cipher var3 = Cipher.getInstance(p_75886_1_);
-            var3.init(p_75886_0_, p_75886_2_);
+            Cipher var3 = Cipher.getInstance(transformation);
+            var3.init(opmode, key);
             return var3;
         }
         catch (InvalidKeyException var4)
@@ -205,12 +205,12 @@ public class CryptManager
         return null;
     }
 
-    public static Cipher func_151229_a(int p_151229_0_, Key p_151229_1_)
+    public static Cipher getAESCipher(int opmode, Key sharedKey)
     {
         try
         {
             Cipher var2 = Cipher.getInstance("AES/CFB8/NoPadding");
-            var2.init(p_151229_0_, p_151229_1_, new IvParameterSpec(p_151229_1_.getEncoded()));
+            var2.init(opmode, sharedKey, new IvParameterSpec(sharedKey.getEncoded()));
             return var2;
         }
         catch (GeneralSecurityException var3)
diff --git a/src/net/minecraft/util/JsonSerializableSet.java b/src/net/minecraft/util/JsonSerializableSet.java
index a85bf86..cb9746b 100644
--- a/src/net/minecraft/util/JsonSerializableSet.java
+++ b/src/net/minecraft/util/JsonSerializableSet.java
@@ -1,13 +1,13 @@
 package net.minecraft.util;
 
+import java.util.Iterator;
+import java.util.Set;
+
 import com.google.common.collect.ForwardingSet;
 import com.google.common.collect.Sets;
 import com.google.gson.JsonArray;
 import com.google.gson.JsonElement;
 import com.google.gson.JsonPrimitive;
-import java.util.Collection;
-import java.util.Iterator;
-import java.util.Set;
 
 public class JsonSerializableSet extends ForwardingSet implements IJsonSerializable
 {
diff --git a/src/net/minecraft/util/MessageDeserializer.java b/src/net/minecraft/util/MessageDeserializer.java
index f18aa09..8760db1 100644
--- a/src/net/minecraft/util/MessageDeserializer.java
+++ b/src/net/minecraft/util/MessageDeserializer.java
@@ -3,13 +3,16 @@ package net.minecraft.util;
 import io.netty.buffer.ByteBuf;
 import io.netty.channel.ChannelHandlerContext;
 import io.netty.handler.codec.ByteToMessageDecoder;
+
 import java.io.IOException;
 import java.util.List;
+
 import net.minecraft.network.EnumConnectionState;
 import net.minecraft.network.EnumPacketDirection;
 import net.minecraft.network.NetworkManager;
 import net.minecraft.network.Packet;
 import net.minecraft.network.PacketBuffer;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.Marker;
diff --git a/src/net/minecraft/util/MessageDeserializer2.java b/src/net/minecraft/util/MessageDeserializer2.java
index 8846c7a..ef48d22 100644
--- a/src/net/minecraft/util/MessageDeserializer2.java
+++ b/src/net/minecraft/util/MessageDeserializer2.java
@@ -35,13 +35,13 @@ public class MessageDeserializer2 extends ByteToMessageDecoder
                 {
                     int var7 = var6.readVarIntFromBuffer();
 
-                    if (p_decode_2_.readableBytes() < var7)
+                    if (p_decode_2_.readableBytes() >= var7)
                     {
-                        p_decode_2_.resetReaderIndex();
+                        p_decode_3_.add(p_decode_2_.readBytes(var7));
                         return;
                     }
 
-                    p_decode_3_.add(p_decode_2_.readBytes(var7));
+                    p_decode_2_.resetReaderIndex();
                 }
                 finally
                 {
diff --git a/src/net/minecraft/util/MessageSerializer.java b/src/net/minecraft/util/MessageSerializer.java
index a8d891b..77ae20d 100644
--- a/src/net/minecraft/util/MessageSerializer.java
+++ b/src/net/minecraft/util/MessageSerializer.java
@@ -3,13 +3,16 @@ package net.minecraft.util;
 import io.netty.buffer.ByteBuf;
 import io.netty.channel.ChannelHandlerContext;
 import io.netty.handler.codec.MessageToByteEncoder;
+
 import java.io.IOException;
+
 import net.minecraft.network.EnumConnectionState;
 import net.minecraft.network.EnumPacketDirection;
 import net.minecraft.network.NetworkManager;
 import net.minecraft.network.Packet;
 import net.minecraft.network.PacketBuffer;
 import net.minecraft.network.play.server.S0CPacketSpawnPlayer;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.Marker;
@@ -49,7 +52,8 @@ public class MessageSerializer extends MessageToByteEncoder
             {
                 if (p_encode_2_ instanceof S0CPacketSpawnPlayer)
                 {
-                    p_encode_2_ = p_encode_2_;
+                	//TODO: Client
+                    //p_encode_2_ = p_encode_2_;
                 }
 
                 p_encode_2_.writePacketData(var5);
diff --git a/src/net/minecraft/util/MovingObjectPosition.java b/src/net/minecraft/util/MovingObjectPosition.java
index a682077..381c34c 100644
--- a/src/net/minecraft/util/MovingObjectPosition.java
+++ b/src/net/minecraft/util/MovingObjectPosition.java
@@ -4,11 +4,11 @@ import net.minecraft.entity.Entity;
 
 public class MovingObjectPosition
 {
-    private BlockPos field_178783_e;
+    private BlockPos blockPos;
 
     /** What type of ray trace hit was this? 0 = block, 1 = entity */
     public MovingObjectPosition.MovingObjectType typeOfHit;
-    public EnumFacing field_178784_b;
+    public EnumFacing sideHit;
 
     /** The vector position of the hit */
     public Vec3 hitVec;
@@ -35,8 +35,8 @@ public class MovingObjectPosition
     public MovingObjectPosition(MovingObjectPosition.MovingObjectType p_i45553_1_, Vec3 p_i45553_2_, EnumFacing p_i45553_3_, BlockPos p_i45553_4_)
     {
         this.typeOfHit = p_i45553_1_;
-        this.field_178783_e = p_i45553_4_;
-        this.field_178784_b = p_i45553_3_;
+        this.blockPos = p_i45553_4_;
+        this.sideHit = p_i45553_3_;
         this.hitVec = new Vec3(p_i45553_2_.xCoord, p_i45553_2_.yCoord, p_i45553_2_.zCoord);
     }
 
@@ -47,14 +47,20 @@ public class MovingObjectPosition
         this.hitVec = p_i45482_2_;
     }
 
-    public BlockPos func_178782_a()
+    public BlockPos getBlockPos()
     {
-        return this.field_178783_e;
+        return this.blockPos;
+    }
+    
+    //TODO: Client
+    public void setBlockPos(BlockPos blockPos)
+    {
+    	this.blockPos = blockPos;
     }
 
     public String toString()
     {
-        return "HitResult{type=" + this.typeOfHit + ", blockpos=" + this.field_178783_e + ", f=" + this.field_178784_b + ", pos=" + this.hitVec + ", entity=" + this.entityHit + '}';
+        return "HitResult{type=" + this.typeOfHit + ", blockpos=" + this.blockPos + ", f=" + this.sideHit + ", pos=" + this.hitVec + ", entity=" + this.entityHit + '}';
     }
 
     public static enum MovingObjectType
diff --git a/src/net/minecraft/util/Timer.java b/src/net/minecraft/util/Timer.java
index 7d59775..f013b5d 100644
--- a/src/net/minecraft/util/Timer.java
+++ b/src/net/minecraft/util/Timer.java
@@ -1,109 +1,118 @@
-package net.minecraft.util;
-
-import net.minecraft.client.Minecraft;
-
-public class Timer
-{
-    /** The number of timer ticks per second of real time */
-    float ticksPerSecond;
-
-    /**
-     * The time reported by the high-resolution clock at the last call of updateTimer(), in seconds
-     */
-    private double lastHRTime;
-
-    /**
-     * How many full ticks have turned over since the last call to updateTimer(), capped at 10.
-     */
-    public int elapsedTicks;
-
-    /**
-     * How much time has elapsed since the last tick, in ticks, for use by display rendering routines (range: 0.0 -
-     * 1.0).  This field is frozen if the display is paused to eliminate jitter.
-     */
-    public float renderPartialTicks;
-
-    /**
-     * A multiplier to make the timer (and therefore the game) go faster or slower.  0.5 makes the game run at half-
-     * speed.
-     */
-    public float timerSpeed = 1.0F;
-
-    /**
-     * How much time has elapsed since the last tick, in ticks (range: 0.0 - 1.0).
-     */
-    public float elapsedPartialTicks;
-
-    /**
-     * The time reported by the system clock at the last sync, in milliseconds
-     */
-    private long lastSyncSysClock;
-
-    /**
-     * The time reported by the high-resolution clock at the last sync, in milliseconds
-     */
-    private long lastSyncHRClock;
-    private long field_74285_i;
-
-    /**
-     * A ratio used to sync the high-resolution clock to the system clock, updated once per second
-     */
-    private double timeSyncAdjustment = 1.0D;
-    private static final String __OBFID = "CL_00000658";
-
-    public Timer(float p_i1018_1_)
-    {
-        this.ticksPerSecond = p_i1018_1_;
-        this.lastSyncSysClock = Minecraft.getSystemTime();
-        this.lastSyncHRClock = System.nanoTime() / 1000000L;
-    }
-
-    /**
-     * Updates all fields of the Timer using the current time
-     */
-    public void updateTimer()
-    {
-        long var1 = Minecraft.getSystemTime();
-        long var3 = var1 - this.lastSyncSysClock;
-        long var5 = System.nanoTime() / 1000000L;
-        double var7 = (double)var5 / 1000.0D;
-
-        if (var3 <= 1000L && var3 >= 0L)
-        {
-            this.field_74285_i += var3;
-
-            if (this.field_74285_i > 1000L)
-            {
-                long var9 = var5 - this.lastSyncHRClock;
-                double var11 = (double)this.field_74285_i / (double)var9;
-                this.timeSyncAdjustment += (var11 - this.timeSyncAdjustment) * 0.20000000298023224D;
-                this.lastSyncHRClock = var5;
-                this.field_74285_i = 0L;
-            }
-
-            if (this.field_74285_i < 0L)
-            {
-                this.lastSyncHRClock = var5;
-            }
-        }
-        else
-        {
-            this.lastHRTime = var7;
-        }
-
-        this.lastSyncSysClock = var1;
-        double var13 = (var7 - this.lastHRTime) * this.timeSyncAdjustment;
-        this.lastHRTime = var7;
-        var13 = MathHelper.clamp_double(var13, 0.0D, 1.0D);
-        this.elapsedPartialTicks = (float)((double)this.elapsedPartialTicks + var13 * (double)this.timerSpeed * (double)this.ticksPerSecond);
-        this.elapsedTicks = (int)this.elapsedPartialTicks;
-        this.elapsedPartialTicks -= (float)this.elapsedTicks;
-
-        if (this.elapsedTicks > 10)
-        {
-            this.elapsedTicks = 10;
-        }
-
-        this.renderPartialTicks = this.elapsedPartialTicks;
-    }
-}
+package net.minecraft.util;
+
+import net.minecraft.client.Minecraft;
+import tk.wurst_client.WurstClient;
+import tk.wurst_client.mods.TimerMod;
+
+public class Timer
+{
+    /** The number of timer ticks per second of real time */
+    float ticksPerSecond;
+
+    /**
+     * The time reported by the high-resolution clock at the last call of updateTimer(), in seconds
+     */
+    private double lastHRTime;
+
+    /**
+     * How many full ticks have turned over since the last call to updateTimer(), capped at 10.
+     */
+    public int elapsedTicks;
+
+    /**
+     * How much time has elapsed since the last tick, in ticks, for use by display rendering routines (range: 0.0 -
+     * 1.0).  This field is frozen if the display is paused to eliminate jitter.
+     */
+    public float renderPartialTicks;
+
+    /**
+     * A multiplier to make the timer (and therefore the game) go faster or slower.  0.5 makes the game run at half-
+     * speed.
+     */
+    public float timerSpeed = 1.0F;
+
+    /**
+     * How much time has elapsed since the last tick, in ticks (range: 0.0 - 1.0).
+     */
+    public float elapsedPartialTicks;
+
+    /**
+     * The time reported by the system clock at the last sync, in milliseconds
+     */
+    private long lastSyncSysClock;
+
+    /**
+     * The time reported by the high-resolution clock at the last sync, in milliseconds
+     */
+    private long lastSyncHRClock;
+    private long field_74285_i;
+
+    /**
+     * A ratio used to sync the high-resolution clock to the system clock, updated once per second
+     */
+    private double timeSyncAdjustment = 1.0D;
+    private static final String __OBFID = "CL_00000658";
+
+    public Timer(float p_i1018_1_)
+    {
+        this.ticksPerSecond = p_i1018_1_;
+        this.lastSyncSysClock = Minecraft.getSystemTime();
+        this.lastSyncHRClock = System.nanoTime() / 1000000L;
+    }
+
+    /**
+     * Updates all fields of the Timer using the current time
+     */
+    public void updateTimer()
+    {
+    	//TODO: Client
+    	TimerMod timerMod = (TimerMod)WurstClient.INSTANCE.modManager.getModByClass(TimerMod.class);
+    	if(timerMod.isEnabled())
+    		timerSpeed = timerMod.speed;
+    	else
+    		timerSpeed = 1.0F;
+    	
+        long var1 = Minecraft.getSystemTime();
+        long var3 = var1 - this.lastSyncSysClock;
+        long var5 = System.nanoTime() / 1000000L;
+        double var7 = (double)var5 / 1000.0D;
+
+        if (var3 <= 1000L && var3 >= 0L)
+        {
+            this.field_74285_i += var3;
+
+            if (this.field_74285_i > 1000L)
+            {
+                long var9 = var5 - this.lastSyncHRClock;
+                double var11 = (double)this.field_74285_i / (double)var9;
+                this.timeSyncAdjustment += (var11 - this.timeSyncAdjustment) * 0.20000000298023224D;
+                this.lastSyncHRClock = var5;
+                this.field_74285_i = 0L;
+            }
+
+            if (this.field_74285_i < 0L)
+            {
+                this.lastSyncHRClock = var5;
+            }
+        }
+        else
+        {
+            this.lastHRTime = var7;
+        }
+
+        this.lastSyncSysClock = var1;
+        double var13 = (var7 - this.lastHRTime) * this.timeSyncAdjustment;
+        this.lastHRTime = var7;
+        var13 = MathHelper.clamp_double(var13, 0.0D, 1.0D);
+        this.elapsedPartialTicks = (float)((double)this.elapsedPartialTicks + var13 * (double)this.timerSpeed * (double)this.ticksPerSecond);
+        this.elapsedTicks = (int)this.elapsedPartialTicks;
+        this.elapsedPartialTicks -= (float)this.elapsedTicks;
+
+        if (this.elapsedTicks > 10)
+        {
+            this.elapsedTicks = 10;
+        }
+
+        this.renderPartialTicks = this.elapsedPartialTicks;
+    }
+}
diff --git a/src/net/minecraft/village/VillageSiege.java b/src/net/minecraft/village/VillageSiege.java
index 45f7cde..d413115 100644
--- a/src/net/minecraft/village/VillageSiege.java
+++ b/src/net/minecraft/village/VillageSiege.java
@@ -104,7 +104,7 @@ public class VillageSiege
         {
             EntityPlayer var3 = (EntityPlayer)var2.next();
 
-            if (!var3.func_175149_v())
+            if (!var3.isSpectator())
             {
                 this.theVillage = this.worldObj.getVillageCollection().func_176056_a(new BlockPos(var3), 1);
 
diff --git a/src/net/minecraft/world/SpawnerAnimals.java b/src/net/minecraft/world/SpawnerAnimals.java
index 9cd6216..b045277 100644
--- a/src/net/minecraft/world/SpawnerAnimals.java
+++ b/src/net/minecraft/world/SpawnerAnimals.java
@@ -1,10 +1,12 @@
 package net.minecraft.world;
 
 import com.google.common.collect.Sets;
+
 import java.util.Iterator;
 import java.util.List;
 import java.util.Random;
 import java.util.Set;
+
 import net.minecraft.block.Block;
 import net.minecraft.entity.EntityLiving;
 import net.minecraft.entity.EntitySpawnPlacementRegistry;
@@ -48,7 +50,7 @@ public final class SpawnerAnimals
             {
                 EntityPlayer var7 = (EntityPlayer)var6.next();
 
-                if (!var7.func_175149_v())
+                if (!var7.isSpectator())
                 {
                     int var8 = MathHelper.floor_double(var7.posX / 16.0D);
                     var9 = MathHelper.floor_double(var7.posZ / 16.0D);
@@ -226,16 +228,23 @@ public final class SpawnerAnimals
             {
                 BlockPos var4 = p_180267_2_.offsetDown();
 
-                if (!World.doesBlockHaveSolidTopSurface(worldIn, var4))
-                {
-                    return false;
-                }
-                else
-                {
-                    Block var5 = worldIn.getBlockState(var4).getBlock();
-                    boolean var6 = var5 != Blocks.bedrock && var5 != Blocks.barrier;
-                    return var6 && !var3.isNormalCube() && !var3.getMaterial().isLiquid() && !worldIn.getBlockState(p_180267_2_.offsetUp()).getBlock().isNormalCube();
-                }
+                //TODO: Client
+                try
+				{
+					if (!World.doesBlockHaveSolidTopSurface(worldIn, var4))
+					{
+					    return false;
+					}
+					else
+					{
+					    Block var5 = worldIn.getBlockState(var4).getBlock();
+					    boolean var6 = var5 != Blocks.bedrock && var5 != Blocks.barrier;
+					    return var6 && !var3.isNormalCube() && !var3.getMaterial().isLiquid() && !worldIn.getBlockState(p_180267_2_.offsetUp()).getBlock().isNormalCube();
+					}
+				}catch(IllegalArgumentException e)
+				{
+					return false;
+				}
             }
         }
     }
diff --git a/src/net/minecraft/world/World.java b/src/net/minecraft/world/World.java
index fa8c3f0..3183b0a 100644
--- a/src/net/minecraft/world/World.java
+++ b/src/net/minecraft/world/World.java
@@ -3,6 +3,7 @@ package net.minecraft.world;
 import com.google.common.base.Predicate;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Sets;
+
 import java.util.ArrayList;
 import java.util.Calendar;
 import java.util.Collection;
@@ -12,6 +13,7 @@ import java.util.Random;
 import java.util.Set;
 import java.util.UUID;
 import java.util.concurrent.Callable;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockHopper;
 import net.minecraft.block.BlockLiquid;
diff --git a/src/net/minecraft/world/WorldServer.java b/src/net/minecraft/world/WorldServer.java
index 6dbf889..70011aa 100644
--- a/src/net/minecraft/world/WorldServer.java
+++ b/src/net/minecraft/world/WorldServer.java
@@ -5,6 +5,7 @@ import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
 import com.google.common.collect.Sets;
 import com.google.common.util.concurrent.ListenableFuture;
+
 import java.util.ArrayList;
 import java.util.Iterator;
 import java.util.List;
@@ -13,6 +14,7 @@ import java.util.Random;
 import java.util.Set;
 import java.util.TreeSet;
 import java.util.UUID;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.BlockEventData;
 import net.minecraft.block.material.Material;
@@ -67,6 +69,7 @@ import net.minecraft.world.gen.structure.StructureBoundingBox;
 import net.minecraft.world.storage.ISaveHandler;
 import net.minecraft.world.storage.MapStorage;
 import net.minecraft.world.storage.WorldInfo;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
@@ -254,7 +257,7 @@ public class WorldServer extends World implements IThreadListener
             {
                 EntityPlayer var4 = (EntityPlayer)var3.next();
 
-                if (var4.func_175149_v())
+                if (var4.isSpectator())
                 {
                     ++var1;
                 }
@@ -310,7 +313,7 @@ public class WorldServer extends World implements IThreadListener
 
                 var2 = (EntityPlayer)var1.next();
             }
-            while (!var2.func_175149_v() && var2.isPlayerFullyAsleep());
+            while (!var2.isSpectator() && var2.isPlayerFullyAsleep());
 
             return false;
         }
diff --git a/src/net/minecraft/world/biome/WorldChunkManager.java b/src/net/minecraft/world/biome/WorldChunkManager.java
index 1b5f683..dd1bfce 100644
--- a/src/net/minecraft/world/biome/WorldChunkManager.java
+++ b/src/net/minecraft/world/biome/WorldChunkManager.java
@@ -1,8 +1,10 @@
 package net.minecraft.world.biome;
 
 import com.google.common.collect.Lists;
+
 import java.util.List;
 import java.util.Random;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.BlockPos;
diff --git a/src/net/minecraft/world/chunk/Chunk.java b/src/net/minecraft/world/chunk/Chunk.java
index fb26ace..3fb2e80 100644
--- a/src/net/minecraft/world/chunk/Chunk.java
+++ b/src/net/minecraft/world/chunk/Chunk.java
@@ -3,6 +3,7 @@ package net.minecraft.world.chunk;
 import com.google.common.base.Predicate;
 import com.google.common.collect.Maps;
 import com.google.common.collect.Queues;
+
 import java.util.Arrays;
 import java.util.Iterator;
 import java.util.List;
@@ -10,6 +11,7 @@ import java.util.Map;
 import java.util.Random;
 import java.util.concurrent.Callable;
 import java.util.concurrent.ConcurrentLinkedQueue;
+
 import net.minecraft.block.Block;
 import net.minecraft.block.ITileEntityProvider;
 import net.minecraft.block.material.Material;
@@ -33,6 +35,7 @@ import net.minecraft.world.biome.BiomeGenBase;
 import net.minecraft.world.biome.WorldChunkManager;
 import net.minecraft.world.chunk.storage.ExtendedBlockStorage;
 import net.minecraft.world.gen.ChunkProviderDebug;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/world/chunk/storage/RegionFile.java b/src/net/minecraft/world/chunk/storage/RegionFile.java
index 65c7029..96c9f69 100644
--- a/src/net/minecraft/world/chunk/storage/RegionFile.java
+++ b/src/net/minecraft/world/chunk/storage/RegionFile.java
@@ -1,6 +1,7 @@
 package net.minecraft.world.chunk.storage;
 
 import com.google.common.collect.Lists;
+
 import java.io.BufferedInputStream;
 import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
@@ -13,6 +14,7 @@ import java.util.List;
 import java.util.zip.DeflaterOutputStream;
 import java.util.zip.GZIPInputStream;
 import java.util.zip.InflaterInputStream;
+
 import net.minecraft.server.MinecraftServer;
 
 public class RegionFile
@@ -183,7 +185,9 @@ public class RegionFile
     /**
      * args: x, z - get an output stream used to write chunk data, data is on disk when the returned stream is closed
      */
-    public DataOutputStream getChunkDataOutputStream(int p_76710_1_, int p_76710_2_)
+    //TODO: Client
+    @SuppressWarnings("resource")
+	public DataOutputStream getChunkDataOutputStream(int p_76710_1_, int p_76710_2_)
     {
         return this.outOfBounds(p_76710_1_, p_76710_2_) ? null : new DataOutputStream(new DeflaterOutputStream(new RegionFile.ChunkBuffer(p_76710_1_, p_76710_2_)));
     }
diff --git a/src/net/minecraft/world/gen/ChunkProviderServer.java b/src/net/minecraft/world/gen/ChunkProviderServer.java
index dd93e4c..bf19430 100644
--- a/src/net/minecraft/world/gen/ChunkProviderServer.java
+++ b/src/net/minecraft/world/gen/ChunkProviderServer.java
@@ -1,12 +1,14 @@
 package net.minecraft.world.gen;
 
 import com.google.common.collect.Lists;
+
 import java.io.IOException;
 import java.util.Collections;
 import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
 import java.util.concurrent.ConcurrentHashMap;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.entity.EnumCreatureType;
@@ -22,6 +24,7 @@ import net.minecraft.world.chunk.Chunk;
 import net.minecraft.world.chunk.EmptyChunk;
 import net.minecraft.world.chunk.IChunkProvider;
 import net.minecraft.world.chunk.storage.IChunkLoader;
+
 import org.apache.logging.log4j.LogManager;
 import org.apache.logging.log4j.Logger;
 
diff --git a/src/net/minecraft/world/gen/layer/GenLayer.java b/src/net/minecraft/world/gen/layer/GenLayer.java
index 39aac4e..05e9199 100644
--- a/src/net/minecraft/world/gen/layer/GenLayer.java
+++ b/src/net/minecraft/world/gen/layer/GenLayer.java
@@ -1,6 +1,7 @@
 package net.minecraft.world.gen.layer;
 
 import java.util.concurrent.Callable;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.util.ReportedException;
diff --git a/src/net/minecraft/world/gen/structure/MapGenStructure.java b/src/net/minecraft/world/gen/structure/MapGenStructure.java
index 89e46e6..7c964ae 100644
--- a/src/net/minecraft/world/gen/structure/MapGenStructure.java
+++ b/src/net/minecraft/world/gen/structure/MapGenStructure.java
@@ -1,11 +1,13 @@
 package net.minecraft.world.gen.structure;
 
 import com.google.common.collect.Maps;
+
 import java.util.Iterator;
 import java.util.List;
 import java.util.Map;
 import java.util.Random;
 import java.util.concurrent.Callable;
+
 import net.minecraft.crash.CrashReport;
 import net.minecraft.crash.CrashReportCategory;
 import net.minecraft.nbt.NBTBase;
-- 
1.9.5.github.0

